"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4582],{38441:(oe,L,s)=>{s.d(L,{F:()=>ee});var e=s(74848),m=s(22803),o=s(96540),u=s(54148),y=s(25356),g=s(54594),T=s(11817),H=s(32027);const ee=({confirmRedirect:P,onDiscard:C,onLocationChange:R})=>{const[r,d]=(0,o.useState)(!1),[B,w]=(0,o.useState)(null),[F,U]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const j=N=>{P&&(N.preventDefault(),N.returnValue="")};return window.addEventListener("beforeunload",j),()=>{window.removeEventListener("beforeunload",j)}},[P]);const te=j=>{const N=window.location.pathname,ce=j.pathname;if(N===ce)return!0;const G=R?.(j);let V=P&&!F;return G!==void 0&&(V=V&&G),V?(d(!0),w(j),!1):(G&&C(),!0)},b=()=>{d(!1),w(null)},de=()=>{d(!1),U(!0),C()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(H.X,{when:!0,message:te}),B&&F&&(0,e.jsx)(u.C5,{replace:!0,to:B}),(0,e.jsx)(M,{isOpen:r,onDiscard:de,onBackToForm:b})]})},M=({onDiscard:P,onBackToForm:C,isOpen:R})=>(0,e.jsxs)(y.a,{isOpen:R,title:"Leave page?",onDismiss:C,icon:"exclamation-triangle",className:(0,m.css)({width:"500px"}),children:[(0,e.jsx)("h5",{children:(0,e.jsx)(T.x6,{i18nKey:"form-prompt.description",children:"Changes that you made may not be saved."})}),(0,e.jsxs)(y.a.ButtonRow,{children:[(0,e.jsx)(g.$n,{variant:"secondary",onClick:C,fill:"outline",children:(0,e.jsx)(T.x6,{i18nKey:"form-prompt.continue-button",children:"Continue editing"})}),(0,e.jsx)(g.$n,{variant:"destructive",onClick:P,children:(0,e.jsx)(T.x6,{i18nKey:"form-prompt.discard-button",children:"Discard unsaved changes"})})]})]})},32027:(oe,L,s)=>{s.d(L,{X:()=>o});var e=s(96540),m=s(53027);const o=({message:u,when:y=!0})=>{const g=m.Ny.getHistory();return(0,e.useEffect)(()=>{if(!y)return;const T=g.block(u);return()=>{T()}},[y,u,g]),null}},66242:(oe,L,s)=>{s.r(L),s.d(L,{LdapSettingsPage:()=>xe,default:()=>Re});var e=s(74848),m=s(22803),o=s(96540),u=s(49785),y=s(71468),g=s(52718),T=s(86833),H=s(28082),ee=s(53027),M=s(56276),P=s(29675),C=s(37e3),R=s(54731),r=s(86489),d=s(34128),B=s(79232),w=s(44826),F=s(90231),U=s(48583),te=s(45565),b=s(54594),de=s(60232),j=s(19224),N=s(99764),ce=s(38441),G=s(54122),V=s(88023),t=s(11817),ve=s(2e3),me=s(40271),ye=s(58528),se=s(91036),X=s(29010),be=s(76080),je=s(6736),De=s(79784),fe=s(60641),Se=s(87638),Le=s(61491);const Pe=Object.keys(Le.OrgRole).map(a=>({label:a,value:a})),Ce=({groupMappingIndex:a,onRemove:x})=>{const{getValues:W,register:v,setValue:z}=(0,u.xW)();return(0,e.jsxs)(F.a,{borderColor:"strong",borderStyle:"solid",padding:2,marginBottom:2,children:[(0,e.jsx)(r.D,{htmlFor:"group-dn",label:(0,t.t)("ldap-drawer.group-mapping.group-dn.label","Group DN"),description:(0,t.t)("ldap-drawer.group-mapping.group-dn.description","The name of the key used to extract the ID token from the returned OAuth2 token."),children:(0,e.jsx)(d.p,{id:"group-dn",...v(`settings.config.servers.0.group_mappings.${a}.group_dn`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.group-mapping.org-role.label","Org role *"),children:(0,e.jsx)(fe.z,{id:`org-role-${a}`,options:Pe,value:W(`settings.config.servers.0.group_mappings.${a}.org_role`),onChange:f=>z(`settings.config.servers.0.group_mappings.${a}.org_role`,f)})}),(0,e.jsx)(r.D,{htmlFor:"org-id",label:(0,t.t)("ldap-drawer.group-mapping.org-id.label","Org ID"),description:(0,t.t)("ldap-drawer.group-mapping.org-id.description","The Grafana organization database id. Default org (ID 1) will be used if left out"),children:(0,e.jsx)(d.p,{id:"org-id",type:"number",...v(`settings.config.servers.0.group_mappings.${a}.org_id`,{valueAsNumber:!0})})}),Se.TP.isGrafanaAdmin&&(0,e.jsx)(r.D,{htmlFor:"grafana-admin",label:(0,t.t)("ldap-drawer.group-mapping.grafana-admin.label","Grafana Admin"),description:(0,t.t)("ldap-drawer.group-mapping.grafana-admin.description","If enabled, all users from this group will be Grafana Admins"),children:(0,e.jsx)(X.d,{id:"grafana-admin",...v(`settings.config.servers.0.group_mappings.${a}.grafana_admin`)})}),(0,e.jsx)(b.$n,{variant:"secondary",fill:"outline",icon:"trash-alt",onClick:x,children:(0,e.jsx)(t.x6,{i18nKey:"ldap-drawer.group-mapping.remove.button",children:"Remove group mapping"})})]})},n="settings.config.servers.0",we=["TLS1.2","TLS1.3"].map(a=>({label:a,value:a}));var Ae=(a=>(a.Base64="base64",a.FilePath="path",a))(Ae||{});const Ee=({onClose:a,mapKeyCertConfigured:x,setMapKeyCertConfigured:W})=>{const[v,z]=(0,o.useState)("base64"),f=(0,P.of)(Te),{control:Q,getValues:I,register:c,setValue:E,watch:J}=(0,u.xW)(),ue=(0,o.useId)(),ge=(0,o.useId)(),ae=(0,o.useId)(),ne=(0,o.useId)(),Z=(0,o.useId)();(0,o.useEffect)(()=>{const{client_cert:i,client_key:h,root_ca_cert:D}=I(n);z(!i?.length&&!h?.length&&!D?.length?"base64":"path")},[I]);const Y=i=>i.length>=5?`${i.slice(0,2)}...${i.slice(-2)}`:i,k=(0,e.jsx)(me.J,{className:f.sectionLabel,description:(0,t.t)("ldap-drawer.attributes-section.description","Specify the LDAP attributes that map to the user's given name, surname, and email address, ensuring the application correctly retrieves and displays user information."),children:(0,e.jsx)(t.x6,{i18nKey:"ldap-drawer.attributes-section.label",children:"Attributes"})}),ie=(0,e.jsx)(me.J,{className:f.sectionLabel,description:(0,t.t)("ldap-drawer.group-mapping-section.description","Map LDAP groups to Grafana org roles"),children:(0,e.jsx)(t.x6,{i18nKey:"ldap-drawer.group-mapping-section.label",children:"Group mapping"})}),q=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.x6,{i18nKey:"ldap-drawer.extra-security-section.use-ssl-tooltip",children:"For a complete list of supported ciphers and TLS versions, refer to:"})," ",(0,e.jsx)(R.Y,{style:{fontSize:"inherit"},href:"https://go.dev/src/crypto/tls/cipher_suites.go",external:!0,children:"https://go.dev/src/crypto/tls/cipher_suites.go"})]}),le=()=>{const i=I(`${n}.group_mappings`)||[];E(`${n}.group_mappings`,[...i,{group_dn:"",org_id:1,org_role:"Viewer",grafana_admin:!1}])},he=i=>{const h=I(`${n}.group_mappings`);E(`${n}.group_mappings`,[...h.slice(0,i),...h.slice(i+1)])};return(0,e.jsxs)(ye._,{title:(0,t.t)("ldap-drawer.title","Advanced settings"),onClose:a,children:[(0,e.jsxs)(se.M,{label:(0,t.t)("ldap-drawer.misc-section.label","Misc"),isOpen:!0,children:[(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.misc-section.allow-sign-up-label","Allow sign-up"),description:(0,t.t)("ldap-drawer.misc-section.allow-sign-up-descrition","If not enabled, only existing Grafana users can log in using LDAP"),children:(0,e.jsx)(X.d,{id:"allow-sign-up",...c("settings.allowSignUp")})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.misc-section.port-label","Port"),description:(0,t.t)("ldap-drawer.misc-section.port-description","Default port is 389 without SSL or 636 with SSL"),children:(0,e.jsx)(d.p,{id:"port",placeholder:"389",type:"number",...c(`${n}.port`,{valueAsNumber:!0})})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.misc-section.timeout-label","Timeout"),description:(0,t.t)("ldap-drawer.misc-section.timeout-description","Timeout in seconds for the connection to the LDAP server"),children:(0,e.jsx)(d.p,{id:"timeout",placeholder:"10",type:"number",...c(`${n}.timeout`,{valueAsNumber:!0})})})]}),(0,e.jsxs)(se.M,{label:k,isOpen:!0,children:[(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.attributes-section.name-label","Name"),children:(0,e.jsx)(d.p,{id:ue,...c(`${n}.attributes.name`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.attributes-section.surname-label","Surname"),children:(0,e.jsx)(d.p,{id:ge,...c(`${n}.attributes.surname`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.attributes-section.username-label","Username"),children:(0,e.jsx)(d.p,{id:ae,...c(`${n}.attributes.username`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.attributes-section.member-of-label","Member Of"),children:(0,e.jsx)(d.p,{id:ne,...c(`${n}.attributes.member_of`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.attributes-section.email-label","Email"),children:(0,e.jsx)(d.p,{id:Z,...c(`${n}.attributes.email`)})})]}),(0,e.jsxs)(se.M,{label:ie,isOpen:!0,children:[(0,e.jsx)(r.D,{htmlFor:"skip-org-role-sync",label:(0,t.t)("ldap-drawer.group-mapping-section.skip-org-role-sync-label","Skip organization role sync"),description:(0,t.t)("ldap-drawer.group-mapping-section.skip-org-role-sync-description","Prevent synchronizing users\u2019 organization roles from your IdP"),children:(0,e.jsx)(X.d,{id:"skip-org-role-sync",...c(`${n}.skip_org_role_sync`)})}),(0,e.jsx)(r.D,{htmlFor:"group-search-filter",label:(0,t.t)("ldap-drawer.group-mapping-section.group-search-filter-label","Group search filter"),description:(0,t.t)("ldap-drawer.group-mapping-section.group-search-filter-description","Used to filter and identify group entries within the directory"),children:(0,e.jsx)(d.p,{id:"group-search-filter",...c(`${n}.group_search_filter`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.group-mapping-section.group-search-base-dns-label","Group search base DNS"),children:(0,e.jsx)(u.xI,{name:`${n}.group_search_base_dns`,control:Q,render:({field:{onChange:i,ref:h,value:D,...K}})=>(0,e.jsx)(w.KF,{...K,allowCustomValue:!0,className:f.multiSelect,noOptionsMessage:"",placeholder:(0,t.t)("ldap-drawer.group-mapping-section.group-search-base-dns-placeholder","example: ou=groups,dc=example,dc=com"),onChange:p=>i(p.map(({value:O})=>String(O))),value:D?.map(p=>({label:p,value:p}))})})}),(0,e.jsx)(r.D,{htmlFor:"group-search-filter-user-attribute",label:(0,t.t)("ldap-drawer.group-mapping-section.group-search-filter-user-attribute-label","Group name attribute"),description:(0,t.t)("ldap-drawer.group-mapping-section.group-search-filter-user-attribute-description","Identifies users within group entries for filtering purposes"),children:(0,e.jsx)(d.p,{id:"group-search-filter-user-attribute",...c(`${n}.group_search_filter_user_attribute`)})}),J("settings.config.servers.0.group_mappings")?.map((i,h)=>(0,e.jsx)(Ce,{groupMappingIndex:h,onRemove:()=>he(h)},h)),(0,e.jsx)(be.c,{}),(0,e.jsx)(b.$n,{className:f.button,variant:"secondary",icon:"plus",onClick:()=>le(),children:(0,e.jsx)(t.x6,{i18nKey:"ldap-drawer.group-mapping-section.add.button",children:"Add group mapping"})})]}),(0,e.jsxs)(se.M,{label:(0,t.t)("ldap-drawer.extra-security-section.label","Extra security measures"),isOpen:!0,children:[(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.use-ssl-label","Use SSL"),description:(0,t.t)("ldap-drawer.extra-security-section.use-ssl-description","Set to true if LDAP server should use TLS connection (either with STARTTLS or LDAPS)"),children:(0,e.jsxs)(U.B,{children:[(0,e.jsx)(X.d,{id:"use-ssl",...c(`${n}.use_ssl`)}),(0,e.jsx)(je.m,{content:q,interactive:!0,children:(0,e.jsx)(De.I,{name:"info-circle"})})]})}),J(`${n}.use_ssl`)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.start-tls-label","Start TLS"),description:(0,t.t)("ldap-drawer.extra-security-section.start-tls-description","If set to true, use LDAP with STARTTLS instead of LDAPS"),children:(0,e.jsx)(X.d,{id:"start-tls",...c(`${n}.start_tls`)})}),(0,e.jsx)(r.D,{htmlFor:"min-tls-version",label:(0,t.t)("ldap-drawer.extra-security-section.min-tls-version-label","Min TLS version"),description:(0,t.t)("ldap-drawer.extra-security-section.min-tls-version-description","This is the minimum TLS version allowed. Accepted values are: TLS1.2, TLS1.3."),children:(0,e.jsx)(w.l6,{id:"min-tls-version",options:we,value:J(`${n}.min_tls_version`),onChange:({value:i})=>E(`${n}.min_tls_version`,i)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.tls-ciphers-label","TLS ciphers"),children:(0,e.jsx)(u.xI,{name:`${n}.tls_ciphers`,control:Q,render:({field:{onChange:i,ref:h,value:D,...K}})=>(0,e.jsx)(w.KF,{...K,allowCustomValue:!0,className:f.multiSelect,noOptionsMessage:"",placeholder:(0,t.t)("ldap-drawer.extra-security-section.tls-ciphers-placeholder","example: TLS_AES_256_GCM_SHA384"),onChange:p=>i(p.map(({value:O})=>String(O))),value:D?.map(p=>({label:p,value:p}))})})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.encryption-provider-label","Encryption key and certificate provision specification."),description:(0,t.t)("ldap-drawer.extra-security-section.encryption-provider-description","X.509 certificate provides the public part, while the private key issued in a PKCS#8 format provides the private part of the asymmetric encryption."),children:(0,e.jsx)(fe.z,{id:"encryption-provider",options:[{label:(0,t.t)("ldap-drawer.extra-security-section.encryption-provider-base-64","Base64-encoded content"),value:"base64"},{label:(0,t.t)("ldap-drawer.extra-security-section.encryption-provider-file-path","Path to files"),value:"path"}],value:v,onChange:z})}),v==="base64"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.root-ca-cert-value-label","Root CA certificate content"),children:(0,e.jsx)(u.xI,{name:`${n}.root_ca_cert_value`,control:Q,render:({field:{onChange:i,ref:h,value:D,...K}})=>(0,e.jsx)(w.KF,{...K,allowCustomValue:!0,className:f.multiSelect,noOptionsMessage:"",placeholder:(0,t.t)("ldap-drawer.extra-security-section.root-ca-cert-value-placeholder","example: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0t"),onChange:p=>i(p.map(({value:O})=>String(O))),value:D?.map(p=>({label:Y(p),value:p}))})})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.client-cert-value-label","Client certificate content"),children:(0,e.jsx)(d.p,{id:"client-cert",placeholder:(0,t.t)("ldap-drawer.extra-security-section.client-cert-value-placeholder","Client certificate content in base64"),type:"text",...c(`${n}.client_cert_value`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.client-key-value-label","Client key content"),children:(0,e.jsx)(B.L4,{id:"client-key",placeholder:(0,t.t)("ldap-drawer.extra-security-section.client-key-value-placeholder","Client key content in base64"),isConfigured:x.clientKeyCertValue,onReset:()=>{E(`${n}.client_key_value`,""),W({...x,clientKeyCertValue:!1})}})})]}),v==="path"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.root-ca-cert-label","Root CA certificate path"),children:(0,e.jsx)(d.p,{id:"root-ca-cert",placeholder:(0,t.t)("ldap-drawer.extra-security-section.root-ca-cert-placeholder","/path/to/root_ca_cert.pem"),type:"text",...c(`${n}.root_ca_cert`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.client-cert-label","Client certificate path"),children:(0,e.jsx)(d.p,{id:"client-cert",placeholder:(0,t.t)("ldap-drawer.extra-security-section.client-cert-placeholder","/path/to/client_cert.pem"),type:"text",...c(`${n}.client_cert`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-drawer.extra-security-section.client-key-label","Client key path"),children:(0,e.jsx)(B.L4,{id:"client-key",placeholder:(0,t.t)("ldap-drawer.extra-security-section.client-key-placeholder","/path/to/client_key.pem"),isConfigured:x.clientKeyCertPath,onReset:()=>{E(`${n}.client_key`,""),W({...x,clientKeyCertPath:!1})},value:J(`${n}.client_key`),onChange:({currentTarget:{value:i}})=>E(`${n}.client_key`,i)})})]})]})]})]})};function Te(a){return{sectionLabel:(0,m.css)({fontSize:a.typography.size.lg}),button:(0,m.css)({marginBottom:a.spacing(4)}),multiSelect:(0,m.css)({"div:last-of-type > svg":{display:"none"}})}}const A=(0,T.J7)(),$e=a=>({ldapSsoSettings:a.ldap.ldapSsoSettings}),Ie={},Ke=(0,y.connect)($e,Ie),Oe={text:"LDAP",icon:"shield",id:"LDAP"},$="settings.config.servers.0",pe=a=>a!==void 0&&a!=="",re={id:"",provider:"",source:"",settings:{activeSyncEnabled:!1,allowSignUp:!1,config:{servers:[{attributes:{},bind_dn:"",bind_password:"",client_cert:"",client_cert_value:"",client_key:"",client_key_value:"",group_mappings:[],group_search_base_dns:[],group_search_filter:"",group_search_filter_user_attribute:"",host:"",min_tls_version:"",port:389,root_ca_cert:"",root_ca_cert_value:[],search_base_dns:[],search_filter:"",skip_org_role_sync:!1,ssl_skip_verify:!1,start_tls:!1,timeout:10,tls_ciphers:[],tls_skip_verify:!1,use_ssl:!1}]},enabled:!1,skipOrgRoleSync:!1,syncCron:""}},xe=()=>{const[a,x]=(0,o.useState)(!0),[W,v]=(0,o.useState)(!1),[z,f]=(0,o.useState)(!1),[Q,I]=(0,o.useState)({clientKeyCertValue:!1,clientKeyCertPath:!1}),c=(0,u.mN)({defaultValues:re}),{control:E,formState:{isDirty:J,errors:ue},getValues:ge,setValue:ae,handleSubmit:ne,register:Z,reset:Y,watch:k}=c,ie=(0,P.of)(Me);if((0,o.useEffect)(()=>{async function l(){const S=await q();let _=re.settings.config.servers[0];S.settings.config.servers?.length>0&&(_=S.settings.config.servers[0]),I({clientKeyCertValue:pe(_.client_key_value),clientKeyCertPath:pe(_.client_key)}),f(pe(_.bind_password)),Y(S),x(!1)}l()},[Y]),!V.Ay.featureToggles.ssoSettingsLDAP)return(0,e.jsx)(C.F,{title:"invalid configuration",children:(0,e.jsxs)(t.x6,{i18nKey:"ldap-settings-page.alert.feature-flag-disabled",children:["This page is only accessible by enabling the ",(0,e.jsx)("strong",{children:"ssoSettingsLDAP"})," feature flag."]})});const q=async()=>{try{const l=await(0,H.AI)().get("/api/v1/sso-settings/ldap");return!l||!l.settings||!l.settings.config?(A.publish({type:g.r1.alertError.name,payload:[(0,t.t)("ldap-settings-page.alert.error-fetching","Error fetching LDAP settings")]}),re):l}catch{return A.publish({type:g.r1.alertError.name,payload:[(0,t.t)("ldap-settings-page.alert.error-fetching","Error fetching LDAP settings")]}),re}},le=async l=>{try{await(0,H.AI)().put("/api/v1/sso-settings/ldap",l)&&A.publish({type:g.r1.alertError.name,payload:[(0,t.t)("ldap-settings-page.alert.error-saving","Error saving LDAP settings")]}),A.publish({type:g.r1.alertSuccess.name,payload:[(0,t.t)("ldap-settings-page.alert.saved","LDAP settings saved")]}),Y(await q()),setTimeout(()=>{ee.Ny.push("/admin/authentication")},300)}catch{A.publish({type:g.r1.alertError.name,payload:[(0,t.t)("ldap-settings-page.alert.error-saving","Error saving LDAP settings")]})}},he=()=>{A.publish({type:g.r1.alertError.name,payload:[(0,t.t)("ldap-settings-page.alert.error-validate-form","Error validating LDAP settings")]})},i=async l=>{l.settings.enabled=!l.settings.enabled,await le(l),(0,M.rR)("authentication_ldap_enabled")},h=async()=>{await le(ge()),(0,M.rR)("authentication_ldap_saved")},D=async()=>{try{x(!0),await(0,H.AI)().delete("/api/v1/sso-settings/ldap");const l=await q();A.publish({type:g.r1.alertSuccess.name,payload:[(0,t.t)("ldap-settings-page.alert.discard-success","LDAP settings discarded")]}),Y(l),(0,M.rR)("authentication_ldap_deleted"),setTimeout(()=>{ee.Ny.push("/admin/authentication")},300)}catch{A.publish({type:g.r1.alertError.name,payload:[(0,t.t)("ldap-settings-page.alert.error-saving","Error saving LDAP settings")]})}finally{x(!1)}},K=()=>{(0,M.rR)("authentication_ldap_abandoned")},p=l=>{const S=ue?.settings?.config?.servers?.[0];return typeof S=="object"&&l in S},O=(0,e.jsxs)(t.x6,{i18nKey:"ldap-settings-page.subtitle",children:["The LDAP integration in Grafana allows your Grafana users to log in with their LDAP credentials. Find out more in our"," ",(0,e.jsx)(R.Y,{href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/ldap/",external:!0,children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.documentation",children:"documentation"})}),"."]}),Be=(0,e.jsx)(C.F,{title:(0,t.t)("ldap-settings-page.login-form-alert.title","Basic login disabled"),children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.login-form-alert.description",children:"Your LDAP configuration is not working because the basic login form is currently disabled. Please enable the login form to use LDAP authentication. You can enable it on the Authentication page under \u201CAuth settings\u201D."})});return(0,e.jsx)(G.Y,{navId:"authentication",pageNav:Oe,subTitle:O,children:(0,e.jsxs)(G.Y.Contents,{children:[V.Ay.disableLoginForm&&Be,(0,e.jsx)(u.Op,{...c,children:(0,e.jsxs)("form",{onSubmit:ne(i,he),children:[(0,e.jsx)(ce.F,{confirmRedirect:J,onDiscard:K}),a&&(0,e.jsx)(ve.a,{}),!a&&(0,e.jsxs)("section",{className:ie.form,children:[(0,e.jsx)("h3",{children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.title",children:"Basic Settings"})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-settings-page.host.label","Server host"),required:!0,error:(0,t.t)("ldap-settings-page.host.error","Server host is a required field"),invalid:p("host"),description:(0,t.t)("ldap-settings-page.host.description","Hostname or IP address of the LDAP server you wish to connect to."),children:(0,e.jsx)(d.p,{id:"host",placeholder:(0,t.t)("ldap-settings-page.host.placeholder","example: 127.0.0.1"),type:"text",...Z(`${$}.host`,{required:!0})})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-settings-page.bind-dn.label","Bind DN"),description:(0,t.t)("ldap-settings-page.bind-dn.description","Distinguished name of the account used to bind and authenticate to the LDAP server."),children:(0,e.jsx)(d.p,{id:"bind-dn",placeholder:(0,t.t)("ldap-settings-page.bind-dn.placeholder","example: cn=admin,dc=grafana,dc=org"),type:"text",...Z(`${$}.bind_dn`)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-settings-page.bind-password.label","Bind password"),children:(0,e.jsx)(B.L4,{id:"bind-password",isConfigured:z,onReset:()=>{ae(`${$}.bind_password`,""),f(!1)},value:k(`${$}.bind_password`),onChange:({currentTarget:{value:l}})=>ae(`${$}.bind_password`,l)})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-settings-page.search_filter.label","Search filter"),required:!0,invalid:p("search_filter"),error:(0,t.t)("ldap-settings-page.search_filter.error","Search filter is a required field"),description:(0,t.t)("ldap-settings-page.search_filter.description","LDAP search filter used to locate specific entries within the directory."),children:(0,e.jsx)(d.p,{id:"search_filter",placeholder:(0,t.t)("ldap-settings-page.search_filter.placeholder","example: cn=%s"),type:"text",...Z(`${$}.search_filter`,{required:!0})})}),(0,e.jsx)(r.D,{label:(0,t.t)("ldap-settings-page.search-base-dns.label","Search base DNS"),required:!0,invalid:p("search_base_dns"),error:(0,t.t)("ldap-settings-page.search-base-dns.error","Search base DNS is a required field"),description:(0,t.t)("ldap-settings-page.search-base-dns.description","An array of base dns to search through."),children:(0,e.jsx)(u.xI,{rules:{required:!0,validate:l=>!!l?.length},name:`${$}.search_base_dns`,control:E,render:({field:{onChange:l,ref:S,..._}})=>(0,e.jsx)(w.KF,{..._,allowCustomValue:!0,className:ie.multiSelect,noOptionsMessage:"",placeholder:(0,t.t)("ldap-settings-page.search-base-dns.placeholder","example: dc=grafana,dc=org"),onChange:Fe=>l(Fe.map(({value:Ue})=>String(Ue)))})})}),(0,e.jsx)(F.a,{borderColor:"strong",borderStyle:"solid",padding:2,width:68,children:(0,e.jsxs)(U.B,{alignItems:"center",direction:"row",gap:2,justifyContent:"space-between",children:[(0,e.jsxs)(U.B,{alignItems:"start",direction:"column",children:[(0,e.jsx)(te.E,{element:"h2",children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.advanced-settings-section.title",children:"Advanced Settings"})}),(0,e.jsx)(te.E,{children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.advanced-settings-section.subtitle",children:"Mappings, extra security measures, and more."})})]}),(0,e.jsx)(b.$n,{variant:"secondary",onClick:()=>v(!0),children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.advanced-settings-section.edit-button",children:"Edit"})})]})}),(0,e.jsx)(F.a,{display:"flex",gap:2,marginTop:5,children:(0,e.jsxs)(U.B,{alignItems:"center",gap:2,children:[!k("settings.enabled")&&(0,e.jsx)(b.$n,{type:"submit",children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.buttons-section.save-and-enable-button",children:"Save and enable"})}),k("settings.enabled")&&(0,e.jsx)(b.$n,{variant:"secondary",type:"submit",children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.buttons-section.disable-button",children:"Disable"})}),(0,e.jsx)(b.$n,{variant:"secondary",onClick:ne(h),children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.buttons-section.save-button",children:"Save"})}),(0,e.jsx)(b.z9,{href:"/admin/authentication",variant:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"ldap-settings-page.buttons-section.discard-button",children:"Discard"})}),(0,e.jsx)(de.m,{overlay:(0,e.jsx)(j.W,{children:(0,e.jsx)(j.W.Item,{label:"Reset to default values",icon:"history-alt",onClick:D})}),placement:"bottom-start",children:(0,e.jsx)(N.K,{tooltip:"More actions",title:"More actions",size:"md",variant:"secondary",name:"ellipsis-v",hidden:k("source")==="system"})})]})})]}),W&&(0,e.jsx)(Ee,{onClose:()=>v(!1),mapKeyCertConfigured:Q,setMapKeyCertConfigured:I})]})})]})})};function Me(a){return{form:(0,m.css)({width:a.spacing(68)}),multiSelect:(0,m.css)({"div:last-of-type > svg":{display:"none"}})}}const Re=Ke(xe)},2e3:(oe,L,s)=>{s.d(L,{a:()=>u});var e=s(74848),m=s(90231),o=s(81876);const u=({text:y="Loading..."})=>(0,e.jsx)(m.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,e.jsx)(o._,{text:y})})}}]);

//# sourceMappingURL=LdapSettingsPage.8aec55755f8453753f2a.js.map