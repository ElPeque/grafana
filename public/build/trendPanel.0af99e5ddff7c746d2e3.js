"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2666],{69921:(X,U,e)=>{e.d(U,{i:()=>C});var r=e(74848),y=e(22803),O=e(29675);const C=({children:c,className:S})=>{const T=(0,O.of)(D);return(0,r.jsx)("div",{className:(0,y.cx)(T.wrapper,S),children:c})},D=c=>({wrapper:(0,y.css)({display:"flex",flexDirection:"column",fontSize:c.typography.bodySmall.fontSize})})},16725:(X,U,e)=>{e.d(U,{B_:()=>j,Fg:()=>V,O2:()=>L,T5:()=>F});var r=e(63739),y=e(23570),O=e(59141),C=e(16869),D=e(17177),c=e(66380),S=e(54430),T=e(7500),W=e(24415);function K(t){let o=new Map;return t.map(u=>({...u,fields:u.fields.map(l=>{if(l.type===r.PU.enum){let i=(0,W.M)(l.config,l.type),s=o.get(i);s||(s=[],o.set(i,s));let d=l.values.toArray().slice(),P=l.config.type.enum.text;if(s.length>0)for(let a=0;a<d.length;a++)d[a]+=s.length;return s.push(...P),l.config.type.enum.text=s,{...l,values:d}}return l})}))}function j(t,o,v,u){if(!t?.length)return null;(0,y.Fm)(t);let l=u!=null;u!=null&&u>0&&(t=[{...t[0],fields:[t[0].fields[u],...t[0].fields.filter((P,a)=>a!==u)]}]);for(let P of t)for(let a of P.fields)a.type===r.PU.time&&typeof a.values[0]!="number"&&(a.values=(0,D.s7)(a,{destinationType:r.PU.time}).values);let i=0;e:for(let P of t)for(let a of P.fields)if(a.type===r.PU.enum&&++i>1){t=K(t);break e}let s;const d=[];for(let P of t){const a=[];let f=!1,h=!1,x=l?P:(0,c.M)({frame:P,refFieldPseudoMin:v?.from.valueOf(),refFieldPseudoMax:v?.to.valueOf()});const B=(0,S.C)(x).fields;for(let p=0;p<(B?.length||0);p++){const n=B[p];switch(n.type){case r.PU.time:f=!0,a.push(n);break;case r.PU.number:h=l?p>0:!0,s={...n,values:n.values.map(E=>Number.isFinite(E)||E==null?E:null)},a.push(s);break;case r.PU.enum:h=!0;case r.PU.string:s={...n,values:n.values},a.push(s);break;case r.PU.boolean:h=!0;const A=n.config?.custom??{},I={...n.config,max:1,min:0,custom:A};A.lineInterpolation!==T.dx.StepBefore&&(A.lineInterpolation=T.dx.StepAfter),s={...n,config:I,type:r.PU.number,values:n.values.map(E=>E==null?E:E?1:0)},(0,O.j9)(I.unit)||(I.unit="bool",s.display=(0,C.J)({field:s,theme:o})),a.push(s);break}}(l||f)&&h&&d.push({...P,length:x.length,fields:a})}return d.length?(L(d,o,0),N(d,o),d):null}const N=(t,o)=>{const{palette:v}=o.visualization;for(const u of t)for(const l of u.fields)if(l.type===r.PU.enum){const i=v[l.state?.seriesIndex%v.length],s=o.visualization.getColorByName(i),d=l.config.type.enum;d.color=Array(d.text.length).fill(s),l.display=(0,C.J)({field:l,theme:o})}},L=(t,o,v)=>{let u=0;t.forEach(l=>{l.fields.forEach((i,s)=>{s!==v&&(i.type===r.PU.number||i.type===r.PU.boolean||i.type===r.PU.enum)&&(i.state={...i.state,seriesIndex:u++},i.display=(0,C.J)({field:i,theme:o}))})})};function V(t,o){return!t||!t.length?[o]:t.map(v=>v?.length?v:o)}const F=t=>t.mode===T.$N.Multi&&t.maxHeight!=null},89181:(X,U,e)=>{e.r(U),e.d(U,{plugin:()=>a});var r=e(68256),y=e(63739),O=e(30040),C=e(13678),D=e(38928),c=e(74848),S=e(96540),T=e(40462),W=e(38075),K=e(77230),j=e(32370),N=e(350),L=e(90415),V=e(40923),F=e(7500),t=e(12963),o=e(6248),v=e(29519),u=e(73528),l=e(70561),i=e(16725);const s=({data:f,timeRange:h,timeZone:x,width:B,height:p,options:n,fieldConfig:A,replaceVariables:I,id:E})=>{const{dataLinkPostProcessor:J}=(0,L.d2)(),Z=n.xField??f.series[0]?.fields.find(m=>m.type===y.PU.number)?.name,$=(m,g,M)=>(g={...g,x:T.sJ.get(W.Ct.byName).get(Z)},(0,o.m)(m,g)),R=(0,S.useMemo)(()=>{if(f.series.length>1)return{warning:"Only one frame is supported, consider adding a join transformation",frames:f.series};let m=f.series,g;if(n.xField){if(g=(0,u.findFieldIndex)(n.xField,m[0]),g==null)return{warning:"Unable to find field: "+n.xField,frames:f.series}}else if(g=m[0]?m[0].fields.findIndex(M=>M.type===y.PU.number):-1,g===-1)return{warning:"No numeric fields found for X axis",frames:m};if(g!=null){const M=m[0].fields[g];if(M.type===y.PU.number&&!(0,K.g2)(M.values))return{warning:"Values must be in ascending order",frames:m}}return{frames:(0,i.B_)(m,j.$.theme2,void 0,g)}},[f.series,n.xField]);return R.warning||!R.frames?(0,c.jsx)(N.a,{panelId:E,fieldConfig:A,data:f,message:R.warning,needsNumberField:!0}):(0,c.jsx)(v.Z,{frames:R.frames,structureRev:f.structureRev,timeRange:h,timeZone:x,width:B,height:p,legend:n.legend,options:n,preparePlotFrame:$,replaceVariables:I,dataLinkPostProcessor:J,children:(m,g)=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(V.Z,{config:m}),n.tooltip.mode!==F.$N.None&&(0,c.jsx)(t.xl,{config:m,hoverMode:n.tooltip.mode===F.$N.Single?t.b3.xOne:t.b3.xAll,getDataLinks:(M,H)=>g.fields[M].getLinks?.({valueRowIndex:H})??[],render:(M,H,z,G=!1,Y,b,w,Q)=>(0,c.jsx)(l.k,{series:g,dataIdxs:H,seriesIdx:z,mode:n.tooltip.mode,sortOrder:n.tooltip.sort,isPinned:G,maxHeight:n.tooltip.maxHeight,replaceVariables:I,dataLinks:Q,hideZeros:n.tooltip.hideZeros}),maxWidth:n.tooltip.maxWidth})]})})};var d=e(18550);class P{getSuggestionsForData(h){const{dataSummary:x}=h;return x.numberFieldCount<2||x.rowCountTotal<2||x.rowCountTotal<2?void 0:h.getListAppender({name:d.m.LineChart,pluginId:"trend",options:{legend:{calcs:[],displayMode:F.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:p=>{p.fieldConfig?.defaults.custom?.drawStyle!==F.GR.Bars&&(p.fieldConfig.defaults.custom.lineWidth=Math.max(p.fieldConfig.defaults.custom.lineWidth??1,2))}}})}}const a=new r.m(s).useFieldConfig((0,D.V)(D.S,!1)).setPanelOptions(f=>{const h=["X axis"];f.addFieldNamePicker({path:"xField",name:"X field",description:"An increasing numeric value",category:h,defaultValue:void 0,settings:{isClearable:!0,placeholderText:"First numeric value",filter:x=>x.type===y.PU.number}}),O.D(f,!1,!0,O.U),C.H(f)}).setSuggestionsSupplier(new P)}}]);

//# sourceMappingURL=trendPanel.0af99e5ddff7c746d2e3.js.map