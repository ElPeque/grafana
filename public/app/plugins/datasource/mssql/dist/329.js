(globalThis.webpackChunkmssql=globalThis.webpackChunkmssql||[]).push([[329],{2932:(e,t,r)=>{"use strict";r.d(t,{d$:()=>Um,M$:()=>im,XK:()=>Hg,Aq:()=>Xm});var n={};r.r(n),r.d(n,{applyToJS:()=>co,cleanJSX:()=>go,deepEqual:()=>io,deepFreeze:()=>Oo,escapeRegExp:()=>po,getFirstDefined:()=>wo,getLogger:()=>So,getOpCardinality:()=>oo,isDirtyJSX:()=>vo,isImmutable:()=>lo,isImmutableList:()=>so,isJSX:()=>ho,isJsonCompatible:()=>_o,isJsonLogic:()=>yo,isObject:()=>to,logger:()=>Ao,mergeArraysSmart:()=>bo,mergeCustomizerNoArrays:()=>fo,omit:()=>no,opDefKeysToOmit:()=>eo,shallowCopy:()=>ro,shallowEqual:()=>ao,sleep:()=>mo,toImmutableList:()=>uo,uuid:()=>Yn,widgetDefKeysToOmit:()=>Zn});var o={};r.r(o),r.d(o,{getItemInListValues:()=>Mo,getListValue:()=>Uo,getTitleInListValues:()=>qo,getValueInListValues:()=>Wo,listValuesToArray:()=>zo,makeCustomListValue:()=>Vo,mapListValues:()=>Bo,searchListValue:()=>$o,toListValue:()=>Do});var i={};r.r(i),r.d(i,{_fixImmutableValue:()=>ai,expandTreePath:()=>Ko,expandTreeSubpath:()=>Go,fixEmptyGroupsInTree:()=>Qo,fixPathsInTree:()=>Yo,getAncestorRuleGroups:()=>Jo,getFlatTree:()=>Zo,getItemByPath:()=>Ho,getLightTree:()=>ri,getSwitchValues:()=>ni,getTotalReordableNodesCountInTree:()=>ei,getTotalRulesCountInTree:()=>ti,hasChildren:()=>ii,immutableToJs:()=>co,isEmptyTree:()=>oi,isImmutable:()=>lo,jsToImmutable:()=>pi,removeIsLockedInTree:()=>Xo,toImmutableList:()=>uo});var a={};r.r(a),r.d(a,{SqlString:()=>Hi,mongoEmptyValue:()=>Xi,spelEscape:()=>Qi,spelFixList:()=>Yi,spelFormatConcat:()=>Zi,spelImportConcat:()=>ea,sqlEmptyValue:()=>Ji,stringifyForDisplay:()=>ta,wrapWithBrackets:()=>ra});var l={};r.r(l),r.d(l,{_loadFromJsonLogic:()=>Li,_loadFromSpel:()=>xa,getTree:()=>li,isImmutableTree:()=>ui,isJsonLogic:()=>yo,isTree:()=>ci,jsToImmutable:()=>pi,loadFromJsonLogic:()=>Ci,loadFromSpel:()=>La,loadTree:()=>si});var s={};r.r(s),r.d(s,{createListFromArray:()=>dl,createListWithOneElement:()=>pl,defaultConjunction:()=>al,defaultGroupConjunction:()=>il,defaultGroupProperties:()=>ll,defaultItemProperties:()=>sl,defaultOperatorOptions:()=>nl,defaultRoot:()=>cl,defaultRule:()=>ul,defaultRuleProperties:()=>ol,emptyProperties:()=>fl,getDefaultField:()=>Za,getDefaultFieldSrc:()=>tl,getDefaultOperator:()=>rl,getDefaultSubField:()=>el});var u={};r.r(u),r.d(u,{_validateTree:()=>du,checkTree:()=>su,getNewValueForFieldOp:()=>Su,getTreeBadFields:()=>lu,isValidTree:()=>au,sanitizeTree:()=>cu,translateValidation:()=>tu,validateAndFixTree:()=>pu,validateRange:()=>_u,validateTree:()=>uu,validateValue:()=>yu});var c={};r.r(c),r.d(c,{completeFuncValue:()=>Au,getCompatibleArgsOnFuncChange:()=>xu,setArgValue:()=>Cu,setArgValueSrc:()=>Lu,setFunc:()=>Fu,setFuncDefaultArg:()=>Eu});var p={};r.r(p),r.d(p,{calculateValueType:()=>Nu,completeValue:()=>rc,filterValueSourcesForField:()=>Bu,formatFieldName:()=>Ku,getFieldPartsConfigs:()=>zu,getFieldPathLabels:()=>Vu,getFirstOperator:()=>Ru,getFuncPathLabels:()=>Du,getOneChildOrDescendant:()=>nc,getOperatorsForField:()=>Pu,getOperatorsForType:()=>Tu,getValueLabel:()=>Mu,getValueSourcesForFieldOp:()=>$u,getWidgetForFieldOp:()=>Uu,getWidgetsForFieldOp:()=>Wu,isEmptyGroupChildren:()=>Yu,isEmptyItem:()=>Gu,isEmptyRuleGroupExtPropertiesAndChildren:()=>Ju,isEmptyRuleProperties:()=>Zu,selectTypes:()=>Iu,whatRulePropertiesAreCompleted:()=>ec});var d={};r.r(d),r.d(d,{_getFromConfigCache:()=>_p,_saveToConfigCache:()=>Sp,_widgetDefKeysToOmit:()=>lp,applyJsonLogic:()=>dc,cleanJSX:()=>go,compileConfig:()=>xc,compressConfig:()=>Cc,configKeys:()=>bc,createConfigMemo:()=>Gc,decompressConfig:()=>Lc,extendConfig:()=>Qc,findExtendedConfigInAllMemos:()=>Kc,getCommonMemo:()=>Uc,getFieldConfig:()=>Ap,getFieldId:()=>Op,getFieldParts:()=>mp,getFieldPath:()=>yp,getFieldPathParts:()=>bp,getFieldRawConfig:()=>pp,getFieldSrc:()=>wp,getFieldWidgetConfig:()=>jp,getFirstField:()=>Ep,getFuncArgConfig:()=>vp,getFuncConfig:()=>gp,getFuncSignature:()=>fp,getOperatorConfig:()=>Fp,isDirtyJSX:()=>vo,isFieldDescendantOfField:()=>hp,isJSX:()=>ho,iterateFields:()=>up,iterateFuncs:()=>sp,normalizeField:()=>dp});var f={};r.r(f),r.d(f,{_mongodbFormat:()=>td,_spelFormat:()=>ca,_sqlFormat:()=>fd,elasticSearchFormat:()=>Fd,jsonLogicFormat:()=>Vp,mongodbFormat:()=>ed,queryBuilderFormat:()=>Lp,queryString:()=>ml,spelFormat:()=>ua,sqlFormat:()=>dd});var g={};r.r(g),r.d(g,{fixListValuesGroupOrder:()=>Dd,getListValue:()=>Uo,listValueToOption:()=>Nd,mergeListValues:()=>Td,optionToListValue:()=>Pd,optionsToListValues:()=>Rd,simulateAsyncFetch:()=>Id});var v={};r.r(v),r.d(v,{Autocomplete:()=>g,ConfigUtils:()=>d,DefaultUtils:()=>s,ExportUtils:()=>a,FuncUtils:()=>c,ListUtils:()=>o,OtherUtils:()=>n,RuleUtils:()=>p,TreeUtils:()=>i,Validation:()=>u,checkTree:()=>su,clone:()=>lc(),compressConfig:()=>Cc,decompressConfig:()=>Lc,getSwitchValues:()=>ni,i18n:()=>ru,isValidTree:()=>au,moment:()=>mi(),sanitizeTree:()=>cu,uuid:()=>Yn,validateAndFixTree:()=>pu,validateTree:()=>uu});var h={};r.r(h),r.d(h,{LINEAR_REGRESSION:()=>Wd,LOWER:()=>Md,NOW:()=>Vd,RELATIVE_DATETIME:()=>zd,UPPER:()=>qd});var y={};r.r(y),r.d(y,{addCaseGroup:()=>Jf,addDefaultCaseGroup:()=>Hf,addGroup:()=>Xf,addRule:()=>Kf,moveItem:()=>Qf,removeGroup:()=>Yf,removeRule:()=>Gf,setTree:()=>Uf});var m={};r.r(m),r.d(m,{setConjunction:()=>Zf,setLock:()=>tg,setNot:()=>eg});var b={};r.r(b),r.d(b,{setField:()=>rg,setFieldSrc:()=>ng,setFuncValue:()=>lg,setOperator:()=>og,setOperatorOption:()=>sg,setValue:()=>ig,setValueSrc:()=>ag});var O={};r.r(O),r.d(O,{bindActionCreators:()=>Vg,isUsingLegacyReactDomRender:()=>Pg,liteShouldComponentUpdate:()=>Rg,pureShouldComponentUpdate:()=>Ng,useOnPropsChanged:()=>Dg});var _={};r.r(_),r.d(_,{FuncWidget:()=>Ah,ValueFieldWidget:()=>hm,VanillaBooleanWidget:()=>ym,VanillaButton:()=>Tm,VanillaButtonGroup:()=>Rm,VanillaConjs:()=>xm,VanillaDateTimeWidget:()=>wm,VanillaDateWidget:()=>Om,VanillaFieldSelect:()=>Lm,VanillaIcon:()=>Pm,VanillaMultiSelectWidget:()=>Fm,VanillaNumberWidget:()=>km,VanillaProvider:()=>zm,VanillaSelectWidget:()=>Em,VanillaSliderWidget:()=>Cm,VanillaSwitch:()=>Dm,VanillaTextAreaWidget:()=>bm,VanillaTextWidget:()=>mm,VanillaTimeWidget:()=>_m,VanillaValueSources:()=>Nm,vanillaConfirm:()=>Vm});var S={};r.r(S),r.d(S,{ProximityOperator:()=>qm});var w=r(6655),A=r(9195),F=r(3836),j=r(2296),E=r(1167),k=r(5959),C=r.n(k),L=r(7493),x=r(894),I=r(7218),T=r(5650),P="delete",R=32,N=31,D={};function V(e){e&&(e.value=!0)}function z(){}function M(e){return void 0===e.size&&(e.size=e.__iterate(W)),e.size}function q(e,t){if("number"!=typeof t){var r=t>>>0;if(""+r!==t||4294967295===r)return NaN;t=r}return t<0?M(e)+t:t}function W(){return!0}function B(e,t,r){return(0===e&&!G(e)||void 0!==r&&e<=-r)&&(void 0===t||void 0!==r&&t>=r)}function $(e,t){return K(e,t,0)}function U(e,t){return K(e,t,t)}function K(e,t,r){return void 0===e?r:G(e)?t===1/0?t:0|Math.max(0,t+e):void 0===t||t===e?e:0|Math.min(t,e)}function G(e){return e<0||0===e&&1/e==-1/0}var H="@@__IMMUTABLE_ITERABLE__@@";function J(e){return Boolean(e&&e[H])}var X="@@__IMMUTABLE_KEYED__@@";function Y(e){return Boolean(e&&e[X])}var Q="@@__IMMUTABLE_INDEXED__@@";function Z(e){return Boolean(e&&e[Q])}function ee(e){return Y(e)||Z(e)}var te=function(e){return J(e)?e:Ae(e)},re=function(e){function t(e){return Y(e)?e:Fe(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(te),ne=function(e){function t(e){return Z(e)?e:je(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(te),oe=function(e){function t(e){return J(e)&&!ee(e)?e:Ee(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(te);te.Keyed=re,te.Indexed=ne,te.Set=oe;var ie="@@__IMMUTABLE_SEQ__@@";function ae(e){return Boolean(e&&e[ie])}var le="@@__IMMUTABLE_RECORD__@@";function se(e){return Boolean(e&&e[le])}function ue(e){return J(e)||se(e)}var ce="@@__IMMUTABLE_ORDERED__@@";function pe(e){return Boolean(e&&e[ce])}var de="function"==typeof Symbol&&Symbol.iterator,fe="@@iterator",ge=de||fe,ve=function(e){this.next=e};function he(e,t,r,n){var o=0===e?t:1===e?r:[t,r];return n?n.value=o:n={value:o,done:!1},n}function ye(){return{value:void 0,done:!0}}function me(e){return!!Array.isArray(e)||!!_e(e)}function be(e){return e&&"function"==typeof e.next}function Oe(e){var t=_e(e);return t&&t.call(e)}function _e(e){var t=e&&(de&&e[de]||e[fe]);if("function"==typeof t)return t}ve.prototype.toString=function(){return"[Iterator]"},ve.KEYS=0,ve.VALUES=1,ve.ENTRIES=2,ve.prototype.inspect=ve.prototype.toSource=function(){return this.toString()},ve.prototype[ge]=function(){return this};var Se=Object.prototype.hasOwnProperty;function we(e){return!(!Array.isArray(e)&&"string"!=typeof e)||e&&"object"==typeof e&&Number.isInteger(e.length)&&e.length>=0&&(0===e.length?1===Object.keys(e).length:e.hasOwnProperty(e.length-1))}var Ae=function(e){function t(e){return null==e?Ie():ue(e)?e.toSeq():function(e){var t,r,n=Re(e);if(n)return(r=_e(t=e))&&r===t.entries?n.fromEntrySeq():function(e){var t=_e(e);return t&&t===e.keys}(e)?n.toSetSeq():n;if("object"==typeof e)return new Ce(e);throw new TypeError("Expected Array or collection object of values, or keyed object: "+e)}(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(e,t){var r=this._cache;if(r){for(var n=r.length,o=0;o!==n;){var i=r[t?n-++o:o++];if(!1===e(i[1],i[0],this))break}return o}return this.__iterateUncached(e,t)},t.prototype.__iterator=function(e,t){var r=this._cache;if(r){var n=r.length,o=0;return new ve((function(){if(o===n)return{value:void 0,done:!0};var i=r[t?n-++o:o++];return he(e,i[0],i[1])}))}return this.__iteratorUncached(e,t)},t}(te),Fe=function(e){function t(e){return null==e?Ie().toKeyedSeq():J(e)?Y(e)?e.toSeq():e.fromEntrySeq():se(e)?e.toSeq():Te(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(Ae),je=function(e){function t(e){return null==e?Ie():J(e)?Y(e)?e.entrySeq():e.toIndexedSeq():se(e)?e.toSeq().entrySeq():Pe(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(Ae),Ee=function(e){function t(e){return(J(e)&&!ee(e)?e:je(e)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(Ae);Ae.isSeq=ae,Ae.Keyed=Fe,Ae.Set=Ee,Ae.Indexed=je,Ae.prototype[ie]=!0;var ke=function(e){function t(e){this._array=e,this.size=e.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this.has(e)?this._array[q(this,e)]:t},t.prototype.__iterate=function(e,t){for(var r=this._array,n=r.length,o=0;o!==n;){var i=t?n-++o:o++;if(!1===e(r[i],i,this))break}return o},t.prototype.__iterator=function(e,t){var r=this._array,n=r.length,o=0;return new ve((function(){if(o===n)return{value:void 0,done:!0};var i=t?n-++o:o++;return he(e,i,r[i])}))},t}(je),Ce=function(e){function t(e){var t=Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]);this._object=e,this._keys=t,this.size=t.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},t.prototype.has=function(e){return Se.call(this._object,e)},t.prototype.__iterate=function(e,t){for(var r=this._object,n=this._keys,o=n.length,i=0;i!==o;){var a=n[t?o-++i:i++];if(!1===e(r[a],a,this))break}return i},t.prototype.__iterator=function(e,t){var r=this._object,n=this._keys,o=n.length,i=0;return new ve((function(){if(i===o)return{value:void 0,done:!0};var a=n[t?o-++i:i++];return he(e,a,r[a])}))},t}(Fe);Ce.prototype[ce]=!0;var Le,xe=function(e){function t(e){this._collection=e,this.size=e.length||e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var r=Oe(this._collection),n=0;if(be(r))for(var o;!(o=r.next()).done&&!1!==e(o.value,n++,this););return n},t.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=Oe(this._collection);if(!be(r))return new ve(ye);var n=0;return new ve((function(){var t=r.next();return t.done?t:he(e,n++,t.value)}))},t}(je);function Ie(){return Le||(Le=new ke([]))}function Te(e){var t=Re(e);if(t)return t.fromEntrySeq();if("object"==typeof e)return new Ce(e);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function Pe(e){var t=Re(e);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+e)}function Re(e){return we(e)?new ke(e):me(e)?new xe(e):void 0}var Ne="@@__IMMUTABLE_MAP__@@";function De(e){return Boolean(e&&e[Ne])}function Ve(e){return De(e)&&pe(e)}function ze(e){return Boolean(e&&"function"==typeof e.equals&&"function"==typeof e.hashCode)}function Me(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!!(ze(e)&&ze(t)&&e.equals(t))}var qe="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var r=65535&(e|=0),n=65535&(t|=0);return r*n+((e>>>16)*n+r*(t>>>16)<<16>>>0)|0};function We(e){return e>>>1&1073741824|3221225471&e}var Be=Object.prototype.valueOf;function $e(e){if(null==e)return Ue(e);if("function"==typeof e.hashCode)return We(e.hashCode(e));var t,r,n,o=(t=e).valueOf!==Be&&"function"==typeof t.valueOf?t.valueOf(t):t;if(null==o)return Ue(o);switch(typeof o){case"boolean":return o?1108378657:1108378656;case"number":return function(e){if(e!=e||e===1/0)return 0;var t=0|e;for(t!==e&&(t^=4294967295*e);e>4294967295;)t^=e/=4294967295;return We(t)}(o);case"string":return o.length>tt?(void 0===(n=ot[r=o])&&(n=Ke(r),nt===rt&&(nt=0,ot={}),nt++,ot[r]=n),n):Ke(o);case"object":case"function":return function(e){var t;if(Ye&&void 0!==(t=Xe.get(e)))return t;if(void 0!==(t=e[et]))return t;if(!He){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[et]))return t;if(void 0!==(t=function(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}(e)))return t}if(t=Je(),Ye)Xe.set(e,t);else{if(void 0!==Ge&&!1===Ge(e))throw new Error("Non-extensible objects are not allowed as keys.");if(He)Object.defineProperty(e,et,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[et]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[et]=t}}return t}(o);case"symbol":return function(e){var t=Qe[e];return void 0!==t||(t=Je(),Qe[e]=t),t}(o);default:if("function"==typeof o.toString)return Ke(o.toString());throw new Error("Value type "+typeof o+" cannot be hashed.")}}function Ue(e){return null===e?1108378658:1108378659}function Ke(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return We(t)}var Ge=Object.isExtensible,He=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}();function Je(){var e=++Ze;return 1073741824&Ze&&(Ze=0),e}var Xe,Ye="function"==typeof WeakMap;Ye&&(Xe=new WeakMap);var Qe=Object.create(null),Ze=0,et="__immutablehash__";"function"==typeof Symbol&&(et=Symbol(et));var tt=16,rt=255,nt=0,ot={},it=function(e){function t(e,t){this._iter=e,this._useKeys=t,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this._iter.get(e,t)},t.prototype.has=function(e){return this._iter.has(e)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var e=this,t=pt(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},t.prototype.map=function(e,t){var r=this,n=ct(this,e,t);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(e,t)}),n},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t,n){return e(t,n,r)}),t)},t.prototype.__iterator=function(e,t){return this._iter.__iterator(e,t)},t}(Fe);it.prototype[ce]=!0;var at=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this,n=0;return t&&M(this),this._iter.__iterate((function(o){return e(o,t?r.size-++n:n++,r)}),t)},t.prototype.__iterator=function(e,t){var r=this,n=this._iter.__iterator(1,t),o=0;return t&&M(this),new ve((function(){var i=n.next();return i.done?i:he(e,t?r.size-++o:o++,i.value,i)}))},t}(je),lt=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t){return e(t,t,r)}),t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(1,t);return new ve((function(){var t=r.next();return t.done?t:he(e,t.value,t.value,t)}))},t}(Ee),st=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t){if(t){_t(t);var n=J(t);return e(n?t.get(1):t[1],n?t.get(0):t[0],r)}}),t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(1,t);return new ve((function(){for(;;){var t=r.next();if(t.done)return t;var n=t.value;if(n){_t(n);var o=J(n);return he(e,o?n.get(0):n[0],o?n.get(1):n[1],t)}}}))},t}(Fe);function ut(e){var t=wt(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=At,t.__iterateUncached=function(t,r){var n=this;return e.__iterate((function(e,r){return!1!==t(r,e,n)}),r)},t.__iteratorUncached=function(t,r){if(2===t){var n=e.__iterator(t,r);return new ve((function(){var e=n.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e}))}return e.__iterator(1===t?0:1,r)},t}function ct(e,t,r){var n=wt(e);return n.size=e.size,n.has=function(t){return e.has(t)},n.get=function(n,o){var i=e.get(n,D);return i===D?o:t.call(r,i,n,e)},n.__iterateUncached=function(n,o){var i=this;return e.__iterate((function(e,o,a){return!1!==n(t.call(r,e,o,a),o,i)}),o)},n.__iteratorUncached=function(n,o){var i=e.__iterator(2,o);return new ve((function(){var o=i.next();if(o.done)return o;var a=o.value,l=a[0];return he(n,l,t.call(r,a[1],l,e),o)}))},n}function pt(e,t){var r=this,n=wt(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var t=ut(e);return t.reverse=function(){return e.flip()},t}),n.get=function(r,n){return e.get(t?r:-1-r,n)},n.has=function(r){return e.has(t?r:-1-r)},n.includes=function(t){return e.includes(t)},n.cacheResult=At,n.__iterate=function(r,n){var o=this,i=0;return n&&M(e),e.__iterate((function(e,a){return r(e,t?a:n?o.size-++i:i++,o)}),!n)},n.__iterator=function(n,o){var i=0;o&&M(e);var a=e.__iterator(2,!o);return new ve((function(){var e=a.next();if(e.done)return e;var l=e.value;return he(n,t?l[0]:o?r.size-++i:i++,l[1],e)}))},n}function dt(e,t,r,n){var o=wt(e);return n&&(o.has=function(n){var o=e.get(n,D);return o!==D&&!!t.call(r,o,n,e)},o.get=function(n,o){var i=e.get(n,D);return i!==D&&t.call(r,i,n,e)?i:o}),o.__iterateUncached=function(o,i){var a=this,l=0;return e.__iterate((function(e,i,s){if(t.call(r,e,i,s))return l++,o(e,n?i:l-1,a)}),i),l},o.__iteratorUncached=function(o,i){var a=e.__iterator(2,i),l=0;return new ve((function(){for(;;){var i=a.next();if(i.done)return i;var s=i.value,u=s[0],c=s[1];if(t.call(r,c,u,e))return he(o,n?u:l++,c,i)}}))},o}function ft(e,t,r,n){var o=e.size;if(B(t,r,o))return e;if(void 0===o&&(t<0||r<0))return ft(e.toSeq().cacheResult(),t,r,n);var i,a=$(t,o),l=U(r,o)-a;l==l&&(i=l<0?0:l);var s=wt(e);return s.size=0===i?i:e.size&&i||void 0,!n&&ae(e)&&i>=0&&(s.get=function(t,r){return(t=q(this,t))>=0&&t<i?e.get(t+a,r):r}),s.__iterateUncached=function(t,r){var o=this;if(0===i)return 0;if(r)return this.cacheResult().__iterate(t,r);var l=0,s=!0,u=0;return e.__iterate((function(e,r){if(!s||!(s=l++<a))return u++,!1!==t(e,n?r:u-1,o)&&u!==i})),u},s.__iteratorUncached=function(t,r){if(0!==i&&r)return this.cacheResult().__iterator(t,r);if(0===i)return new ve(ye);var o=e.__iterator(t,r),l=0,s=0;return new ve((function(){for(;l++<a;)o.next();if(++s>i)return{value:void 0,done:!0};var e=o.next();return n||1===t||e.done?e:he(t,s-1,0===t?void 0:e.value[1],e)}))},s}function gt(e,t,r,n){var o=wt(e);return o.__iterateUncached=function(o,i){var a=this;if(i)return this.cacheResult().__iterate(o,i);var l=!0,s=0;return e.__iterate((function(e,i,u){if(!l||!(l=t.call(r,e,i,u)))return s++,o(e,n?i:s-1,a)})),s},o.__iteratorUncached=function(o,i){var a=this;if(i)return this.cacheResult().__iterator(o,i);var l=e.__iterator(2,i),s=!0,u=0;return new ve((function(){var e,i,c;do{if((e=l.next()).done)return n||1===o?e:he(o,u++,0===o?void 0:e.value[1],e);var p=e.value;i=p[0],c=p[1],s&&(s=t.call(r,c,i,a))}while(s);return 2===o?e:he(o,i,c,e)}))},o}function vt(e,t,r){var n=wt(e);return n.__iterateUncached=function(o,i){if(i)return this.cacheResult().__iterate(o,i);var a=0,l=!1;return function e(s,u){s.__iterate((function(i,s){return(!t||u<t)&&J(i)?e(i,u+1):(a++,!1===o(i,r?s:a-1,n)&&(l=!0)),!l}),i)}(e,0),a},n.__iteratorUncached=function(n,o){if(o)return this.cacheResult().__iterator(n,o);var i=e.__iterator(n,o),a=[],l=0;return new ve((function(){for(;i;){var e=i.next();if(!1===e.done){var s=e.value;if(2===n&&(s=s[1]),t&&!(a.length<t)||!J(s))return r?e:he(n,l++,s,e);a.push(i),i=s.__iterator(n,o)}else i=a.pop()}return{value:void 0,done:!0}}))},n}function ht(e,t,r){t||(t=Ft);var n=Y(e),o=0,i=e.toSeq().map((function(t,n){return[n,t,o++,r?r(t,n,e):t]})).valueSeq().toArray();return i.sort((function(e,r){return t(e[3],r[3])||e[2]-r[2]})).forEach(n?function(e,t){i[t].length=2}:function(e,t){i[t]=e[1]}),n?Fe(i):Z(e)?je(i):Ee(i)}function yt(e,t,r){if(t||(t=Ft),r){var n=e.toSeq().map((function(t,n){return[t,r(t,n,e)]})).reduce((function(e,r){return mt(t,e[1],r[1])?r:e}));return n&&n[0]}return e.reduce((function(e,r){return mt(t,e,r)?r:e}))}function mt(e,t,r){var n=e(r,t);return 0===n&&r!==t&&(null==r||r!=r)||n>0}function bt(e,t,r,n){var o=wt(e),i=new ke(r).map((function(e){return e.size}));return o.size=n?i.max():i.min(),o.__iterate=function(e,t){for(var r,n=this.__iterator(1,t),o=0;!(r=n.next()).done&&!1!==e(r.value,o++,this););return o},o.__iteratorUncached=function(e,o){var i=r.map((function(e){return e=te(e),Oe(o?e.reverse():e)})),a=0,l=!1;return new ve((function(){var r;return l||(r=i.map((function(e){return e.next()})),l=n?r.every((function(e){return e.done})):r.some((function(e){return e.done}))),l?{value:void 0,done:!0}:he(e,a++,t.apply(null,r.map((function(e){return e.value}))))}))},o}function Ot(e,t){return e===t?e:ae(e)?t:e.constructor(t)}function _t(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function St(e){return Y(e)?re:Z(e)?ne:oe}function wt(e){return Object.create((Y(e)?Fe:Z(e)?je:Ee).prototype)}function At(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Ae.prototype.cacheResult.call(this)}function Ft(e,t){return void 0===e&&void 0===t?0:void 0===e?1:void 0===t?-1:e>t?1:e<t?-1:0}function jt(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),o=0;o<r;o++)n[o]=e[o+t];return n}function Et(e,t){if(!e)throw new Error(t)}function kt(e){Et(e!==1/0,"Cannot perform this action with an infinite size.")}function Ct(e){if(we(e)&&"string"!=typeof e)return e;if(pe(e))return e.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}at.prototype.cacheResult=it.prototype.cacheResult=lt.prototype.cacheResult=st.prototype.cacheResult=At;var Lt=Object.prototype.toString;function xt(e){if(!e||"object"!=typeof e||"[object Object]"!==Lt.call(e))return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t,n=Object.getPrototypeOf(t);null!==n;)r=n,n=Object.getPrototypeOf(r);return r===t}function It(e){return"object"==typeof e&&(ue(e)||Array.isArray(e)||xt(e))}function Tt(e){try{return"string"==typeof e?JSON.stringify(e):String(e)}catch(t){return JSON.stringify(e)}}function Pt(e,t){return ue(e)?e.has(t):It(e)&&Se.call(e,t)}function Rt(e,t,r){return ue(e)?e.get(t,r):Pt(e,t)?"function"==typeof e.get?e.get(t):e[t]:r}function Nt(e){if(Array.isArray(e))return jt(e);var t={};for(var r in e)Se.call(e,r)&&(t[r]=e[r]);return t}function Dt(e,t){if(!It(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(ue(e)){if(!e.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!Se.call(e,t))return e;var r=Nt(e);return Array.isArray(r)?r.splice(t,1):delete r[t],r}function Vt(e,t,r){if(!It(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(ue(e)){if(!e.set)throw new TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,r)}if(Se.call(e,t)&&r===e[t])return e;var n=Nt(e);return n[t]=r,n}function zt(e,t,r,n){n||(n=r,r=void 0);var o=Mt(ue(e),e,Ct(t),0,r,n);return o===D?r:o}function Mt(e,t,r,n,o,i){var a=t===D;if(n===r.length){var l=a?o:t,s=i(l);return s===l?t:s}if(!a&&!It(t))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(Tt)+"]: "+t);var u=r[n],c=a?D:Rt(t,u,D),p=Mt(c===D?e:ue(c),c,r,n+1,o,i);return p===c?t:p===D?Dt(t,u):Vt(a?e?br():{}:t,u,p)}function qt(e,t,r){return zt(e,t,D,(function(){return r}))}function Wt(e,t){return qt(this,e,t)}function Bt(e,t){return zt(e,t,(function(){return D}))}function $t(e){return Bt(this,e)}function Ut(e,t,r,n){return zt(e,[t],r,n)}function Kt(e,t,r){return 1===arguments.length?e(this):Ut(this,e,t,r)}function Gt(e,t,r){return zt(this,e,t,r)}function Ht(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Xt(this,e)}function Jt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if("function"!=typeof e)throw new TypeError("Invalid merger function: "+e);return Xt(this,t,e)}function Xt(e,t,r){for(var n=[],o=0;o<t.length;o++){var i=re(t[o]);0!==i.size&&n.push(i)}return 0===n.length?e:0!==e.toSeq().size||e.__ownerID||1!==n.length?e.withMutations((function(e){for(var t=r?function(t,n){Ut(e,n,D,(function(e){return e===D?t:r(e,t,n)}))}:function(t,r){e.set(r,t)},o=0;o<n.length;o++)n[o].forEach(t)})):e.constructor(n[0])}function Yt(e,t,r){return Qt(e,t,function(e){return function t(r,n,o){return It(r)&&It(n)&&(i=n,a=Ae(r),l=Ae(i),Z(a)===Z(l)&&Y(a)===Y(l))?Qt(r,[n],t):e?e(r,n,o):n;var i,a,l}}(r))}function Qt(e,t,r){if(!It(e))throw new TypeError("Cannot merge into non-data-structure value: "+e);if(ue(e))return"function"==typeof r&&e.mergeWith?e.mergeWith.apply(e,[r].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var n=Array.isArray(e),o=e,i=n?ne:re,a=n?function(t){o===e&&(o=Nt(o)),o.push(t)}:function(t,n){var i=Se.call(o,n),a=i&&r?r(o[n],t,n):t;i&&a===o[n]||(o===e&&(o=Nt(o)),o[n]=a)},l=0;l<t.length;l++)i(t[l]).forEach(a);return o}function Zt(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Yt(this,e)}function er(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return Yt(this,t,e)}function tr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return zt(this,e,br(),(function(e){return Qt(e,t)}))}function rr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return zt(this,e,br(),(function(e){return Yt(e,t)}))}function nr(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function or(){return this.__ownerID?this:this.__ensureOwner(new z)}function ir(){return this.__ensureOwner()}function ar(){return this.__altered}var lr=function(e){function t(t){return null==t?br():De(t)&&!pe(t)?t:br().withMutations((function(r){var n=e(t);kt(n.size),n.forEach((function(e,t){return r.set(t,e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return br().withMutations((function(t){for(var r=0;r<e.length;r+=2){if(r+1>=e.length)throw new Error("Missing value for key: "+e[r]);t.set(e[r],e[r+1])}}))},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},t.prototype.set=function(e,t){return Or(this,e,t)},t.prototype.remove=function(e){return Or(this,e,D)},t.prototype.deleteAll=function(e){var t=te(e);return 0===t.size?this:this.withMutations((function(e){t.forEach((function(t){return e.remove(t)}))}))},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):br()},t.prototype.sort=function(e){return Ur(ht(this,e))},t.prototype.sortBy=function(e,t){return Ur(ht(this,t,e))},t.prototype.map=function(e,t){var r=this;return this.withMutations((function(n){n.forEach((function(o,i){n.set(i,e.call(t,o,i,r))}))}))},t.prototype.__iterator=function(e,t){return new vr(this,e,t)},t.prototype.__iterate=function(e,t){var r=this,n=0;return this._root&&this._root.iterate((function(t){return n++,e(t[1],t[0],r)}),t),n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?mr(this.size,this._root,e,this.__hash):0===this.size?br():(this.__ownerID=e,this.__altered=!1,this)},t}(re);lr.isMap=De;var sr=lr.prototype;sr[Ne]=!0,sr[P]=sr.remove,sr.removeAll=sr.deleteAll,sr.setIn=Wt,sr.removeIn=sr.deleteIn=$t,sr.update=Kt,sr.updateIn=Gt,sr.merge=sr.concat=Ht,sr.mergeWith=Jt,sr.mergeDeep=Zt,sr.mergeDeepWith=er,sr.mergeIn=tr,sr.mergeDeepIn=rr,sr.withMutations=nr,sr.wasAltered=ar,sr.asImmutable=ir,sr["@@transducer/init"]=sr.asMutable=or,sr["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},sr["@@transducer/result"]=function(e){return e.asImmutable()};var ur=function(e,t){this.ownerID=e,this.entries=t};ur.prototype.get=function(e,t,r,n){for(var o=this.entries,i=0,a=o.length;i<a;i++)if(Me(r,o[i][0]))return o[i][1];return n},ur.prototype.update=function(e,t,r,n,o,i,a){for(var l=o===D,s=this.entries,u=0,c=s.length;u<c&&!Me(n,s[u][0]);u++);var p=u<c;if(p?s[u][1]===o:l)return this;if(V(a),(l||!p)&&V(i),!l||1!==s.length){if(!p&&!l&&s.length>=jr)return function(e,t,r,n){e||(e=new z);for(var o=new fr(e,$e(r),[r,n]),i=0;i<t.length;i++){var a=t[i];o=o.update(e,0,void 0,a[0],a[1])}return o}(e,s,n,o);var d=e&&e===this.ownerID,f=d?s:jt(s);return p?l?u===c-1?f.pop():f[u]=f.pop():f[u]=[n,o]:f.push([n,o]),d?(this.entries=f,this):new ur(e,f)}};var cr=function(e,t,r){this.ownerID=e,this.bitmap=t,this.nodes=r};cr.prototype.get=function(e,t,r,n){void 0===t&&(t=$e(r));var o=1<<((0===e?t:t>>>e)&N),i=this.bitmap;return i&o?this.nodes[Ar(i&o-1)].get(e+5,t,r,n):n},cr.prototype.update=function(e,t,r,n,o,i,a){void 0===r&&(r=$e(n));var l=(0===t?r:r>>>t)&N,s=1<<l,u=this.bitmap,c=!!(u&s);if(!c&&o===D)return this;var p=Ar(u&s-1),d=this.nodes,f=c?d[p]:void 0,g=_r(f,e,t+5,r,n,o,i,a);if(g===f)return this;if(!c&&g&&d.length>=Er)return function(e,t,r,n,o){for(var i=0,a=new Array(R),l=0;0!==r;l++,r>>>=1)a[l]=1&r?t[i++]:void 0;return a[n]=o,new pr(e,i+1,a)}(e,d,u,l,g);if(c&&!g&&2===d.length&&Sr(d[1^p]))return d[1^p];if(c&&g&&1===d.length&&Sr(g))return g;var v=e&&e===this.ownerID,h=c?g?u:u^s:u|s,y=c?g?Fr(d,p,g,v):function(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var o=new Array(n),i=0,a=0;a<n;a++)a===t&&(i=1),o[a]=e[a+i];return o}(d,p,v):function(e,t,r,n){var o=e.length+1;if(n&&t+1===o)return e[t]=r,e;for(var i=new Array(o),a=0,l=0;l<o;l++)l===t?(i[l]=r,a=-1):i[l]=e[l+a];return i}(d,p,g,v);return v?(this.bitmap=h,this.nodes=y,this):new cr(e,h,y)};var pr=function(e,t,r){this.ownerID=e,this.count=t,this.nodes=r};pr.prototype.get=function(e,t,r,n){void 0===t&&(t=$e(r));var o=(0===e?t:t>>>e)&N,i=this.nodes[o];return i?i.get(e+5,t,r,n):n},pr.prototype.update=function(e,t,r,n,o,i,a){void 0===r&&(r=$e(n));var l=(0===t?r:r>>>t)&N,s=o===D,u=this.nodes,c=u[l];if(s&&!c)return this;var p=_r(c,e,t+5,r,n,o,i,a);if(p===c)return this;var d=this.count;if(c){if(!p&&--d<kr)return function(e,t,r,n){for(var o=0,i=0,a=new Array(r),l=0,s=1,u=t.length;l<u;l++,s<<=1){var c=t[l];void 0!==c&&l!==n&&(o|=s,a[i++]=c)}return new cr(e,o,a)}(e,u,d,l)}else d++;var f=e&&e===this.ownerID,g=Fr(u,l,p,f);return f?(this.count=d,this.nodes=g,this):new pr(e,d,g)};var dr=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entries=r};dr.prototype.get=function(e,t,r,n){for(var o=this.entries,i=0,a=o.length;i<a;i++)if(Me(r,o[i][0]))return o[i][1];return n},dr.prototype.update=function(e,t,r,n,o,i,a){void 0===r&&(r=$e(n));var l=o===D;if(r!==this.keyHash)return l?this:(V(a),V(i),wr(this,e,t,r,[n,o]));for(var s=this.entries,u=0,c=s.length;u<c&&!Me(n,s[u][0]);u++);var p=u<c;if(p?s[u][1]===o:l)return this;if(V(a),(l||!p)&&V(i),l&&2===c)return new fr(e,this.keyHash,s[1^u]);var d=e&&e===this.ownerID,f=d?s:jt(s);return p?l?u===c-1?f.pop():f[u]=f.pop():f[u]=[n,o]:f.push([n,o]),d?(this.entries=f,this):new dr(e,this.keyHash,f)};var fr=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entry=r};fr.prototype.get=function(e,t,r,n){return Me(r,this.entry[0])?this.entry[1]:n},fr.prototype.update=function(e,t,r,n,o,i,a){var l=o===D,s=Me(n,this.entry[0]);return(s?o===this.entry[1]:l)?this:(V(a),l?void V(i):s?e&&e===this.ownerID?(this.entry[1]=o,this):new fr(e,this.keyHash,[n,o]):(V(i),wr(this,e,t,$e(n),[n,o])))},ur.prototype.iterate=dr.prototype.iterate=function(e,t){for(var r=this.entries,n=0,o=r.length-1;n<=o;n++)if(!1===e(r[t?o-n:n]))return!1},cr.prototype.iterate=pr.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,o=r.length-1;n<=o;n++){var i=r[t?o-n:n];if(i&&!1===i.iterate(e,t))return!1}},fr.prototype.iterate=function(e,t){return e(this.entry)};var gr,vr=function(e){function t(e,t,r){this._type=t,this._reverse=r,this._stack=e._root&&yr(e._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var r=t.node,n=t.index++,o=void 0;if(r.entry){if(0===n)return hr(e,r.entry)}else if(r.entries){if(n<=(o=r.entries.length-1))return hr(e,r.entries[this._reverse?o-n:n])}else if(n<=(o=r.nodes.length-1)){var i=r.nodes[this._reverse?o-n:n];if(i){if(i.entry)return hr(e,i.entry);t=this._stack=yr(i,t)}continue}t=this._stack=this._stack.__prev}return{value:void 0,done:!0}},t}(ve);function hr(e,t){return he(e,t[0],t[1])}function yr(e,t){return{node:e,index:0,__prev:t}}function mr(e,t,r,n){var o=Object.create(sr);return o.size=e,o._root=t,o.__ownerID=r,o.__hash=n,o.__altered=!1,o}function br(){return gr||(gr=mr(0))}function Or(e,t,r){var n,o;if(e._root){var i={value:!1},a={value:!1};if(n=_r(e._root,e.__ownerID,0,void 0,t,r,i,a),!a.value)return e;o=e.size+(i.value?r===D?-1:1:0)}else{if(r===D)return e;o=1,n=new ur(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=o,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?mr(o,n):br()}function _r(e,t,r,n,o,i,a,l){return e?e.update(t,r,n,o,i,a,l):i===D?e:(V(l),V(a),new fr(t,n,[o,i]))}function Sr(e){return e.constructor===fr||e.constructor===dr}function wr(e,t,r,n,o){if(e.keyHash===n)return new dr(t,n,[e.entry,o]);var i,a=(0===r?e.keyHash:e.keyHash>>>r)&N,l=(0===r?n:n>>>r)&N,s=a===l?[wr(e,t,r+5,n,o)]:(i=new fr(t,n,o),a<l?[e,i]:[i,e]);return new cr(t,1<<a|1<<l,s)}function Ar(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,127&(e+=e>>8)+(e>>16)}function Fr(e,t,r,n){var o=n?e:jt(e);return o[t]=r,o}var jr=8,Er=16,kr=8,Cr="@@__IMMUTABLE_LIST__@@";function Lr(e){return Boolean(e&&e[Cr])}var xr=function(e){function t(t){var r=Vr();if(null==t)return r;if(Lr(t))return t;var n=e(t),o=n.size;return 0===o?r:(kt(o),o>0&&o<R?Dr(0,o,5,null,new Tr(n.toArray())):r.withMutations((function(e){e.setSize(o),n.forEach((function(t,r){return e.set(r,t)}))})))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(e,t){if((e=q(this,e))>=0&&e<this.size){var r=qr(this,e+=this._origin);return r&&r.array[e&N]}return t},t.prototype.set=function(e,t){return function(e,t,r){if((t=q(e,t))!=t)return e;if(t>=e.size||t<0)return e.withMutations((function(e){t<0?Wr(e,t).set(0,r):Wr(e,0,t+1).set(t,r)}));t+=e._origin;var n=e._tail,o=e._root,i={value:!1};return t>=Br(e._capacity)?n=zr(n,e.__ownerID,0,t,r,i):o=zr(o,e.__ownerID,e._level,t,r,i),i.value?e.__ownerID?(e._root=o,e._tail=n,e.__hash=void 0,e.__altered=!0,e):Dr(e._origin,e._capacity,e._level,o,n):e}(this,e,t)},t.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},t.prototype.insert=function(e,t){return this.splice(e,0,t)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):Vr()},t.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations((function(r){Wr(r,0,t+e.length);for(var n=0;n<e.length;n++)r.set(t+n,e[n])}))},t.prototype.pop=function(){return Wr(this,0,-1)},t.prototype.unshift=function(){var e=arguments;return this.withMutations((function(t){Wr(t,-e.length);for(var r=0;r<e.length;r++)t.set(r,e[r])}))},t.prototype.shift=function(){return Wr(this,1)},t.prototype.concat=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++){var o=t[n],i=e("string"!=typeof o&&me(o)?o:[o]);0!==i.size&&r.push(i)}return 0===r.length?this:0!==this.size||this.__ownerID||1!==r.length?this.withMutations((function(e){r.forEach((function(t){return t.forEach((function(t){return e.push(t)}))}))})):this.constructor(r[0])},t.prototype.setSize=function(e){return Wr(this,0,e)},t.prototype.map=function(e,t){var r=this;return this.withMutations((function(n){for(var o=0;o<r.size;o++)n.set(o,e.call(t,n.get(o),o,r))}))},t.prototype.slice=function(e,t){var r=this.size;return B(e,t,r)?this:Wr(this,$(e,r),U(t,r))},t.prototype.__iterator=function(e,t){var r=t?this.size:0,n=Nr(this,t);return new ve((function(){var o=n();return o===Rr?{value:void 0,done:!0}:he(e,t?--r:r++,o)}))},t.prototype.__iterate=function(e,t){for(var r,n=t?this.size:0,o=Nr(this,t);(r=o())!==Rr&&!1!==e(r,t?--n:n++,this););return n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Dr(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):0===this.size?Vr():(this.__ownerID=e,this.__altered=!1,this)},t}(ne);xr.isList=Lr;var Ir=xr.prototype;Ir[Cr]=!0,Ir[P]=Ir.remove,Ir.merge=Ir.concat,Ir.setIn=Wt,Ir.deleteIn=Ir.removeIn=$t,Ir.update=Kt,Ir.updateIn=Gt,Ir.mergeIn=tr,Ir.mergeDeepIn=rr,Ir.withMutations=nr,Ir.wasAltered=ar,Ir.asImmutable=ir,Ir["@@transducer/init"]=Ir.asMutable=or,Ir["@@transducer/step"]=function(e,t){return e.push(t)},Ir["@@transducer/result"]=function(e){return e.asImmutable()};var Tr=function(e,t){this.array=e,this.ownerID=t};Tr.prototype.removeBefore=function(e,t,r){if(r===t?1<<t:0===this.array.length)return this;var n=r>>>t&N;if(n>=this.array.length)return new Tr([],e);var o,i=0===n;if(t>0){var a=this.array[n];if((o=a&&a.removeBefore(e,t-5,r))===a&&i)return this}if(i&&!o)return this;var l=Mr(this,e);if(!i)for(var s=0;s<n;s++)l.array[s]=void 0;return o&&(l.array[n]=o),l},Tr.prototype.removeAfter=function(e,t,r){if(r===(t?1<<t:0)||0===this.array.length)return this;var n,o=r-1>>>t&N;if(o>=this.array.length)return this;if(t>0){var i=this.array[o];if((n=i&&i.removeAfter(e,t-5,r))===i&&o===this.array.length-1)return this}var a=Mr(this,e);return a.array.splice(o+1),n&&(a.array[o]=n),a};var Pr,Rr={};function Nr(e,t){var r=e._origin,n=e._capacity,o=Br(n),i=e._tail;return function e(a,l,s){return 0===l?function(e,a){var l=a===o?i&&i.array:e&&e.array,s=a>r?0:r-a,u=n-a;return u>R&&(u=R),function(){if(s===u)return Rr;var e=t?--u:s++;return l&&l[e]}}(a,s):function(o,i,a){var l,s=o&&o.array,u=a>r?0:r-a>>i,c=1+(n-a>>i);return c>R&&(c=R),function(){for(;;){if(l){var r=l();if(r!==Rr)return r;l=null}if(u===c)return Rr;var n=t?--c:u++;l=e(s&&s[n],i-5,a+(n<<i))}}}(a,l,s)}(e._root,e._level,0)}function Dr(e,t,r,n,o,i,a){var l=Object.create(Ir);return l.size=t-e,l._origin=e,l._capacity=t,l._level=r,l._root=n,l._tail=o,l.__ownerID=i,l.__hash=a,l.__altered=!1,l}function Vr(){return Pr||(Pr=Dr(0,0,5))}function zr(e,t,r,n,o,i){var a,l=n>>>r&N,s=e&&l<e.array.length;if(!s&&void 0===o)return e;if(r>0){var u=e&&e.array[l],c=zr(u,t,r-5,n,o,i);return c===u?e:((a=Mr(e,t)).array[l]=c,a)}return s&&e.array[l]===o?e:(i&&V(i),a=Mr(e,t),void 0===o&&l===a.array.length-1?a.array.pop():a.array[l]=o,a)}function Mr(e,t){return t&&e&&t===e.ownerID?e:new Tr(e?e.array.slice():[],t)}function qr(e,t){if(t>=Br(e._capacity))return e._tail;if(t<1<<e._level+5){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&N],n-=5;return r}}function Wr(e,t,r){void 0!==t&&(t|=0),void 0!==r&&(r|=0);var n=e.__ownerID||new z,o=e._origin,i=e._capacity,a=o+t,l=void 0===r?i:r<0?i+r:o+r;if(a===o&&l===i)return e;if(a>=l)return e.clear();for(var s=e._level,u=e._root,c=0;a+c<0;)u=new Tr(u&&u.array.length?[void 0,u]:[],n),c+=1<<(s+=5);c&&(a+=c,o+=c,l+=c,i+=c);for(var p=Br(i),d=Br(l);d>=1<<s+5;)u=new Tr(u&&u.array.length?[u]:[],n),s+=5;var f=e._tail,g=d<p?qr(e,l-1):d>p?new Tr([],n):f;if(f&&d>p&&a<i&&f.array.length){for(var v=u=Mr(u,n),h=s;h>5;h-=5){var y=p>>>h&N;v=v.array[y]=Mr(v.array[y],n)}v.array[p>>>5&N]=f}if(l<i&&(g=g&&g.removeAfter(n,0,l)),a>=d)a-=d,l-=d,s=5,u=null,g=g&&g.removeBefore(n,0,a);else if(a>o||d<p){for(c=0;u;){var m=a>>>s&N;if(m!==d>>>s&N)break;m&&(c+=(1<<s)*m),s-=5,u=u.array[m]}u&&a>o&&(u=u.removeBefore(n,s,a-c)),u&&d<p&&(u=u.removeAfter(n,s,d-c)),c&&(a-=c,l-=c)}return e.__ownerID?(e.size=l-a,e._origin=a,e._capacity=l,e._level=s,e._root=u,e._tail=g,e.__hash=void 0,e.__altered=!0,e):Dr(a,l,s,u,g)}function Br(e){return e<R?0:e-1>>>5<<5}var $r,Ur=function(e){function t(e){return null==e?Gr():Ve(e)?e:Gr().withMutations((function(t){var r=re(e);kt(r.size),r.forEach((function(e,r){return t.set(r,e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(e,t){var r=this._map.get(e);return void 0!==r?this._list.get(r)[1]:t},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):Gr()},t.prototype.set=function(e,t){return Hr(this,e,t)},t.prototype.remove=function(e){return Hr(this,e,D)},t.prototype.__iterate=function(e,t){var r=this;return this._list.__iterate((function(t){return t&&e(t[1],t[0],r)}),t)},t.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),r=this._list.__ensureOwner(e);return e?Kr(t,r,e,this.__hash):0===this.size?Gr():(this.__ownerID=e,this.__altered=!1,this._map=t,this._list=r,this)},t}(lr);function Kr(e,t,r,n){var o=Object.create(Ur.prototype);return o.size=e?e.size:0,o._map=e,o._list=t,o.__ownerID=r,o.__hash=n,o.__altered=!1,o}function Gr(){return $r||($r=Kr(br(),Vr()))}function Hr(e,t,r){var n,o,i=e._map,a=e._list,l=i.get(t),s=void 0!==l;if(r===D){if(!s)return e;a.size>=R&&a.size>=2*i.size?(n=(o=a.filter((function(e,t){return void 0!==e&&l!==t}))).toKeyedSeq().map((function(e){return e[0]})).flip().toMap(),e.__ownerID&&(n.__ownerID=o.__ownerID=e.__ownerID)):(n=i.remove(t),o=l===a.size-1?a.pop():a.set(l,void 0))}else if(s){if(r===a.get(l)[1])return e;n=i,o=a.set(l,[t,r])}else n=i.set(t,a.size),o=a.set(a.size,[t,r]);return e.__ownerID?(e.size=n.size,e._map=n,e._list=o,e.__hash=void 0,e.__altered=!0,e):Kr(n,o)}Ur.isOrderedMap=Ve,Ur.prototype[ce]=!0,Ur.prototype[P]=Ur.prototype.remove;var Jr="@@__IMMUTABLE_STACK__@@";function Xr(e){return Boolean(e&&e[Jr])}var Yr=function(e){function t(e){return null==e?tn():Xr(e)?e:tn().pushAll(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(e,t){var r=this._head;for(e=q(this,e);r&&e--;)r=r.next;return r?r.value:t},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var e=arguments;if(0===arguments.length)return this;for(var t=this.size+arguments.length,r=this._head,n=arguments.length-1;n>=0;n--)r={value:e[n],next:r};return this.__ownerID?(this.size=t,this._head=r,this.__hash=void 0,this.__altered=!0,this):en(t,r)},t.prototype.pushAll=function(t){if(0===(t=e(t)).size)return this;if(0===this.size&&Xr(t))return t;kt(t.size);var r=this.size,n=this._head;return t.__iterate((function(e){r++,n={value:e,next:n}}),!0),this.__ownerID?(this.size=r,this._head=n,this.__hash=void 0,this.__altered=!0,this):en(r,n)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):tn()},t.prototype.slice=function(t,r){if(B(t,r,this.size))return this;var n=$(t,this.size);if(U(r,this.size)!==this.size)return e.prototype.slice.call(this,t,r);for(var o=this.size-n,i=this._head;n--;)i=i.next;return this.__ownerID?(this.size=o,this._head=i,this.__hash=void 0,this.__altered=!0,this):en(o,i)},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?en(this.size,this._head,e,this.__hash):0===this.size?tn():(this.__ownerID=e,this.__altered=!1,this)},t.prototype.__iterate=function(e,t){var r=this;if(t)return new ke(this.toArray()).__iterate((function(t,n){return e(t,n,r)}),t);for(var n=0,o=this._head;o&&!1!==e(o.value,n++,this);)o=o.next;return n},t.prototype.__iterator=function(e,t){if(t)return new ke(this.toArray()).__iterator(e,t);var r=0,n=this._head;return new ve((function(){if(n){var t=n.value;return n=n.next,he(e,r++,t)}return{value:void 0,done:!0}}))},t}(ne);Yr.isStack=Xr;var Qr,Zr=Yr.prototype;function en(e,t,r,n){var o=Object.create(Zr);return o.size=e,o._head=t,o.__ownerID=r,o.__hash=n,o.__altered=!1,o}function tn(){return Qr||(Qr=en(0))}Zr[Jr]=!0,Zr.shift=Zr.pop,Zr.unshift=Zr.push,Zr.unshiftAll=Zr.pushAll,Zr.withMutations=nr,Zr.wasAltered=ar,Zr.asImmutable=ir,Zr["@@transducer/init"]=Zr.asMutable=or,Zr["@@transducer/step"]=function(e,t){return e.unshift(t)},Zr["@@transducer/result"]=function(e){return e.asImmutable()};var rn="@@__IMMUTABLE_SET__@@";function nn(e){return Boolean(e&&e[rn])}function on(e){return nn(e)&&pe(e)}function an(e,t){if(e===t)return!0;if(!J(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||Y(e)!==Y(t)||Z(e)!==Z(t)||pe(e)!==pe(t))return!1;if(0===e.size&&0===t.size)return!0;var r=!ee(e);if(pe(e)){var n=e.entries();return t.every((function(e,t){var o=n.next().value;return o&&Me(o[1],e)&&(r||Me(o[0],t))}))&&n.next().done}var o=!1;if(void 0===e.size)if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{o=!0;var i=e;e=t,t=i}var a=!0,l=t.__iterate((function(t,n){if(r?!e.has(t):o?!Me(t,e.get(n,D)):!Me(e.get(n,D),t))return a=!1,!1}));return a&&e.size===l}function ln(e,t){var r=function(r){e.prototype[r]=t[r]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}function sn(e){if(!e||"object"!=typeof e)return e;if(!J(e)){if(!It(e))return e;e=Ae(e)}if(Y(e)){var t={};return e.__iterate((function(e,r){t[r]=sn(e)})),t}var r=[];return e.__iterate((function(e){r.push(sn(e))})),r}var un=function(e){function t(t){return null==t?gn():nn(t)&&!pe(t)?t:gn().withMutations((function(r){var n=e(t);kt(n.size),n.forEach((function(e){return r.add(e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(re(e).keySeq())},t.intersect=function(e){return(e=te(e).toArray()).length?pn.intersect.apply(t(e.pop()),e):gn()},t.union=function(e){return(e=te(e).toArray()).length?pn.union.apply(t(e.pop()),e):gn()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(e){return this._map.has(e)},t.prototype.add=function(e){return dn(this,this._map.set(e,e))},t.prototype.remove=function(e){return dn(this,this._map.remove(e))},t.prototype.clear=function(){return dn(this,this._map.clear())},t.prototype.map=function(e,t){var r=this,n=!1,o=dn(this,this._map.mapEntries((function(o){var i=o[1],a=e.call(t,i,i,r);return a!==i&&(n=!0),[a,a]}),t));return n?o:this},t.prototype.union=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return 0===(t=t.filter((function(e){return 0!==e.size}))).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations((function(r){for(var n=0;n<t.length;n++)"string"==typeof t[n]?r.add(t[n]):e(t[n]).forEach((function(e){return r.add(e)}))})):this.constructor(t[0])},t.prototype.intersect=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map((function(t){return e(t)}));var n=[];return this.forEach((function(e){t.every((function(t){return t.includes(e)}))||n.push(e)})),this.withMutations((function(e){n.forEach((function(t){e.remove(t)}))}))},t.prototype.subtract=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map((function(t){return e(t)}));var n=[];return this.forEach((function(e){t.some((function(t){return t.includes(e)}))&&n.push(e)})),this.withMutations((function(e){n.forEach((function(t){e.remove(t)}))}))},t.prototype.sort=function(e){return Tn(ht(this,e))},t.prototype.sortBy=function(e,t){return Tn(ht(this,t,e))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(e,t){var r=this;return this._map.__iterate((function(t){return e(t,t,r)}),t)},t.prototype.__iterator=function(e,t){return this._map.__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):0===this.size?this.__empty():(this.__ownerID=e,this._map=t,this)},t}(oe);un.isSet=nn;var cn,pn=un.prototype;function dn(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function fn(e,t){var r=Object.create(pn);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function gn(){return cn||(cn=fn(br()))}pn[rn]=!0,pn[P]=pn.remove,pn.merge=pn.concat=pn.union,pn.withMutations=nr,pn.asImmutable=ir,pn["@@transducer/init"]=pn.asMutable=or,pn["@@transducer/step"]=function(e,t){return e.add(t)},pn["@@transducer/result"]=function(e){return e.asImmutable()},pn.__empty=gn,pn.__make=fn;var vn,hn=function(e){function t(e,r,n){if(!(this instanceof t))return new t(e,r,n);if(Et(0!==n,"Cannot step a Range by 0"),e=e||0,void 0===r&&(r=1/0),n=void 0===n?1:Math.abs(n),r<e&&(n=-n),this._start=e,this._end=r,this._step=n,this.size=Math.max(0,Math.ceil((r-e)/n-1)+1),0===this.size){if(vn)return vn;vn=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},t.prototype.get=function(e,t){return this.has(e)?this._start+q(this,e)*this._step:t},t.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},t.prototype.slice=function(e,r){return B(e,r,this.size)?this:(e=$(e,this.size),(r=U(r,this.size))<=e?new t(0,0):new t(this.get(e,this._end),this.get(r,this._end),this._step))},t.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var r=t/this._step;if(r>=0&&r<this.size)return r}return-1},t.prototype.lastIndexOf=function(e){return this.indexOf(e)},t.prototype.__iterate=function(e,t){for(var r=this.size,n=this._step,o=t?this._start+(r-1)*n:this._start,i=0;i!==r&&!1!==e(o,t?r-++i:i++,this);)o+=t?-n:n;return i},t.prototype.__iterator=function(e,t){var r=this.size,n=this._step,o=t?this._start+(r-1)*n:this._start,i=0;return new ve((function(){if(i===r)return{value:void 0,done:!0};var a=o;return o+=t?-n:n,he(e,t?r-++i:i++,a)}))},t.prototype.equals=function(e){return e instanceof t?this._start===e._start&&this._end===e._end&&this._step===e._step:an(this,e)},t}(je);function yn(e,t,r){for(var n=Ct(t),o=0;o!==n.length;)if((e=Rt(e,n[o++],D))===D)return r;return e}function mn(e,t){return yn(this,e,t)}function bn(e,t){return yn(e,t,D)!==D}function On(){kt(this.size);var e={};return this.__iterate((function(t,r){e[r]=t})),e}te.isIterable=J,te.isKeyed=Y,te.isIndexed=Z,te.isAssociative=ee,te.isOrdered=pe,te.Iterator=ve,ln(te,{toArray:function(){kt(this.size);var e=new Array(this.size||0),t=Y(this),r=0;return this.__iterate((function(n,o){e[r++]=t?[o,n]:n})),e},toIndexedSeq:function(){return new at(this)},toJS:function(){return sn(this)},toKeyedSeq:function(){return new it(this,!0)},toMap:function(){return lr(this.toKeyedSeq())},toObject:On,toOrderedMap:function(){return Ur(this.toKeyedSeq())},toOrderedSet:function(){return Tn(Y(this)?this.valueSeq():this)},toSet:function(){return un(Y(this)?this.valueSeq():this)},toSetSeq:function(){return new lt(this)},toSeq:function(){return Z(this)?this.toIndexedSeq():Y(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Yr(Y(this)?this.valueSeq():this)},toList:function(){return xr(Y(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Ot(this,function(e,t){var r=Y(e),n=[e].concat(t).map((function(e){return J(e)?r&&(e=re(e)):e=r?Te(e):Pe(Array.isArray(e)?e:[e]),e})).filter((function(e){return 0!==e.size}));if(0===n.length)return e;if(1===n.length){var o=n[0];if(o===e||r&&Y(o)||Z(e)&&Z(o))return o}var i=new ke(n);return r?i=i.toKeyedSeq():Z(e)||(i=i.toSetSeq()),(i=i.flatten(!0)).size=n.reduce((function(e,t){if(void 0!==e){var r=t.size;if(void 0!==r)return e+r}}),0),i}(this,e))},includes:function(e){return this.some((function(t){return Me(t,e)}))},entries:function(){return this.__iterator(2)},every:function(e,t){kt(this.size);var r=!0;return this.__iterate((function(n,o,i){if(!e.call(t,n,o,i))return r=!1,!1})),r},filter:function(e,t){return Ot(this,dt(this,e,t,!0))},partition:function(e,t){return function(e,t,r){var n=Y(e),o=[[],[]];e.__iterate((function(i,a){o[t.call(r,i,a,e)?1:0].push(n?[a,i]:i)}));var i=St(e);return o.map((function(t){return Ot(e,i(t))}))}(this,e,t)},find:function(e,t,r){var n=this.findEntry(e,t);return n?n[1]:r},forEach:function(e,t){return kt(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){kt(this.size),e=void 0!==e?""+e:",";var t="",r=!0;return this.__iterate((function(n){r?r=!1:t+=e,t+=null!=n?n.toString():""})),t},keys:function(){return this.__iterator(0)},map:function(e,t){return Ot(this,ct(this,e,t))},reduce:function(e,t,r){return Fn(this,e,t,r,arguments.length<2,!1)},reduceRight:function(e,t,r){return Fn(this,e,t,r,arguments.length<2,!0)},reverse:function(){return Ot(this,pt(this,!0))},slice:function(e,t){return Ot(this,ft(this,e,t,!0))},some:function(e,t){kt(this.size);var r=!1;return this.__iterate((function(n,o,i){if(e.call(t,n,o,i))return r=!0,!1})),r},sort:function(e){return Ot(this,ht(this,e))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(e,t){return M(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return function(e,t,r){var n=lr().asMutable();return e.__iterate((function(o,i){n.update(t.call(r,o,i,e),0,(function(e){return e+1}))})),n.asImmutable()}(this,e,t)},equals:function(e){return an(this,e)},entrySeq:function(){var e=this;if(e._cache)return new ke(e._cache);var t=e.toSeq().map(En).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(kn(e),t)},findEntry:function(e,t,r){var n=r;return this.__iterate((function(r,o,i){if(e.call(t,r,o,i))return n=[o,r],!1})),n},findKey:function(e,t){var r=this.findEntry(e,t);return r&&r[0]},findLast:function(e,t,r){return this.toKeyedSeq().reverse().find(e,t,r)},findLastEntry:function(e,t,r){return this.toKeyedSeq().reverse().findEntry(e,t,r)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(e){return this.find(W,null,e)},flatMap:function(e,t){return Ot(this,function(e,t,r){var n=St(e);return e.toSeq().map((function(o,i){return n(t.call(r,o,i,e))})).flatten(!0)}(this,e,t))},flatten:function(e){return Ot(this,vt(this,e,!0))},fromEntrySeq:function(){return new st(this)},get:function(e,t){return this.find((function(t,r){return Me(r,e)}),void 0,t)},getIn:mn,groupBy:function(e,t){return function(e,t,r){var n=Y(e),o=(pe(e)?Ur():lr()).asMutable();e.__iterate((function(i,a){o.update(t.call(r,i,a,e),(function(e){return(e=e||[]).push(n?[a,i]:i),e}))}));var i=St(e);return o.map((function(t){return Ot(e,i(t))})).asImmutable()}(this,e,t)},has:function(e){return this.get(e,D)!==D},hasIn:function(e){return bn(this,e)},isSubset:function(e){return e="function"==typeof e.includes?e:te(e),this.every((function(t){return e.includes(t)}))},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:te(e)).isSubset(this)},keyOf:function(e){return this.findKey((function(t){return Me(t,e)}))},keySeq:function(){return this.toSeq().map(jn).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return yt(this,e)},maxBy:function(e,t){return yt(this,t,e)},min:function(e){return yt(this,e?Cn(e):xn)},minBy:function(e,t){return yt(this,t?Cn(t):xn,e)},rest:function(){return this.slice(1)},skip:function(e){return 0===e?this:this.slice(Math.max(0,e))},skipLast:function(e){return 0===e?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,t){return Ot(this,gt(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(kn(e),t)},sortBy:function(e,t){return Ot(this,ht(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,t){return Ot(this,function(e,t,r){var n=wt(e);return n.__iterateUncached=function(n,o){var i=this;if(o)return this.cacheResult().__iterate(n,o);var a=0;return e.__iterate((function(e,o,l){return t.call(r,e,o,l)&&++a&&n(e,o,i)})),a},n.__iteratorUncached=function(n,o){var i=this;if(o)return this.cacheResult().__iterator(n,o);var a=e.__iterator(2,o),l=!0;return new ve((function(){if(!l)return{value:void 0,done:!0};var e=a.next();if(e.done)return e;var o=e.value,s=o[0],u=o[1];return t.call(r,u,s,i)?2===n?e:he(n,s,u,e):(l=!1,{value:void 0,done:!0})}))},n}(this,e,t))},takeUntil:function(e,t){return this.takeWhile(kn(e),t)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(e){if(e.size===1/0)return 0;var t=pe(e),r=Y(e),n=t?1:0;return function(e,t){return t=qe(t,3432918353),t=qe(t<<15|t>>>-15,461845907),t=qe(t<<13|t>>>-13,5),t=qe((t=t+3864292196^e)^t>>>16,2246822507),t=We((t=qe(t^t>>>13,3266489909))^t>>>16)}(e.__iterate(r?t?function(e,t){n=31*n+In($e(e),$e(t))|0}:function(e,t){n=n+In($e(e),$e(t))|0}:t?function(e){n=31*n+$e(e)|0}:function(e){n=n+$e(e)|0}),n)}(this))}});var _n=te.prototype;_n[H]=!0,_n[ge]=_n.values,_n.toJSON=_n.toArray,_n.__toStringMapper=Tt,_n.inspect=_n.toSource=function(){return this.toString()},_n.chain=_n.flatMap,_n.contains=_n.includes,ln(re,{flip:function(){return Ot(this,ut(this))},mapEntries:function(e,t){var r=this,n=0;return Ot(this,this.toSeq().map((function(o,i){return e.call(t,[i,o],n++,r)})).fromEntrySeq())},mapKeys:function(e,t){var r=this;return Ot(this,this.toSeq().flip().map((function(n,o){return e.call(t,n,o,r)})).flip())}});var Sn=re.prototype;Sn[X]=!0,Sn[ge]=_n.entries,Sn.toJSON=On,Sn.__toStringMapper=function(e,t){return Tt(t)+": "+Tt(e)},ln(ne,{toKeyedSeq:function(){return new it(this,!1)},filter:function(e,t){return Ot(this,dt(this,e,t,!1))},findIndex:function(e,t){var r=this.findEntry(e,t);return r?r[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return Ot(this,pt(this,!1))},slice:function(e,t){return Ot(this,ft(this,e,t,!1))},splice:function(e,t){var r=arguments.length;if(t=Math.max(t||0,0),0===r||2===r&&!t)return this;e=$(e,e<0?this.count():this.size);var n=this.slice(0,e);return Ot(this,1===r?n:n.concat(jt(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var r=this.findLastEntry(e,t);return r?r[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return Ot(this,vt(this,e,!1))},get:function(e,t){return(e=q(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find((function(t,r){return r===e}),void 0,t)},has:function(e){return(e=q(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return Ot(this,function(e,t){var r=wt(e);return r.size=e.size&&2*e.size-1,r.__iterateUncached=function(r,n){var o=this,i=0;return e.__iterate((function(e){return(!i||!1!==r(t,i++,o))&&!1!==r(e,i++,o)}),n),i},r.__iteratorUncached=function(r,n){var o,i=e.__iterator(1,n),a=0;return new ve((function(){return(!o||a%2)&&(o=i.next()).done?o:a%2?he(r,a++,t):he(r,a++,o.value,o)}))},r}(this,e))},interleave:function(){var e=[this].concat(jt(arguments)),t=bt(this.toSeq(),je.of,e),r=t.flatten(!0);return t.size&&(r.size=t.size*e.length),Ot(this,r)},keySeq:function(){return hn(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,t){return Ot(this,gt(this,e,t,!1))},zip:function(){return Ot(this,bt(this,Ln,[this].concat(jt(arguments))))},zipAll:function(){return Ot(this,bt(this,Ln,[this].concat(jt(arguments)),!0))},zipWith:function(e){var t=jt(arguments);return t[0]=this,Ot(this,bt(this,e,t))}});var wn=ne.prototype;wn[Q]=!0,wn[ce]=!0,ln(oe,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}});var An=oe.prototype;function Fn(e,t,r,n,o,i){return kt(e.size),e.__iterate((function(e,i,a){o?(o=!1,r=e):r=t.call(n,r,e,i,a)}),i),r}function jn(e,t){return t}function En(e,t){return[t,e]}function kn(e){return function(){return!e.apply(this,arguments)}}function Cn(e){return function(){return-e.apply(this,arguments)}}function Ln(){return jt(arguments)}function xn(e,t){return e<t?1:e>t?-1:0}function In(e,t){return e^t+2654435769+(e<<6)+(e>>2)}An.has=_n.includes,An.contains=An.includes,An.keys=An.values,ln(Fe,Sn),ln(je,wn),ln(Ee,An);var Tn=function(e){function t(e){return null==e?Dn():on(e)?e:Dn().withMutations((function(t){var r=oe(e);kt(r.size),r.forEach((function(e){return t.add(e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(re(e).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(un);Tn.isOrderedSet=on;var Pn,Rn=Tn.prototype;function Nn(e,t){var r=Object.create(Rn);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function Dn(){return Pn||(Pn=Nn(Gr()))}Rn[ce]=!0,Rn.zip=wn.zip,Rn.zipWith=wn.zipWith,Rn.zipAll=wn.zipAll,Rn.__empty=Dn,Rn.__make=Nn;var Vn=function(e,t){var r;!function(e){if(se(e))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(ue(e))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(null===e||"object"!=typeof e)throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}(e);var n=function(i){var a=this;if(i instanceof n)return i;if(!(this instanceof n))return new n(i);if(!r){r=!0;var l=Object.keys(e),s=o._indices={};o._name=t,o._keys=l,o._defaultValues=e;for(var u=0;u<l.length;u++){var c=l[u];s[c]=u,o[c]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+qn(this)+' with property "'+c+'" since that property name is part of the Record API.'):Bn(o,c)}}return this.__ownerID=void 0,this._values=xr().withMutations((function(e){e.setSize(a._keys.length),re(i).forEach((function(t,r){e.set(a._indices[r],t===a._defaultValues[r]?void 0:t)}))})),this},o=n.prototype=Object.create(zn);return o.constructor=n,t&&(n.displayName=t),n};Vn.prototype.toString=function(){for(var e,t=qn(this)+" { ",r=this._keys,n=0,o=r.length;n!==o;n++)t+=(n?", ":"")+(e=r[n])+": "+Tt(this.get(e));return t+" }"},Vn.prototype.equals=function(e){return this===e||se(e)&&Wn(this).equals(Wn(e))},Vn.prototype.hashCode=function(){return Wn(this).hashCode()},Vn.prototype.has=function(e){return this._indices.hasOwnProperty(e)},Vn.prototype.get=function(e,t){if(!this.has(e))return t;var r=this._indices[e],n=this._values.get(r);return void 0===n?this._defaultValues[e]:n},Vn.prototype.set=function(e,t){if(this.has(e)){var r=this._values.set(this._indices[e],t===this._defaultValues[e]?void 0:t);if(r!==this._values&&!this.__ownerID)return Mn(this,r)}return this},Vn.prototype.remove=function(e){return this.set(e)},Vn.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:Mn(this,e)},Vn.prototype.wasAltered=function(){return this._values.wasAltered()},Vn.prototype.toSeq=function(){return Wn(this)},Vn.prototype.toJS=function(){return sn(this)},Vn.prototype.entries=function(){return this.__iterator(2)},Vn.prototype.__iterator=function(e,t){return Wn(this).__iterator(e,t)},Vn.prototype.__iterate=function(e,t){return Wn(this).__iterate(e,t)},Vn.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._values.__ensureOwner(e);return e?Mn(this,t,e):(this.__ownerID=e,this._values=t,this)},Vn.isRecord=se,Vn.getDescriptiveName=qn;var zn=Vn.prototype;function Mn(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._values=t,n.__ownerID=r,n}function qn(e){return e.constructor.displayName||e.constructor.name||"Record"}function Wn(e){return Te(e._keys.map((function(t){return[t,e.get(t)]})))}function Bn(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){Et(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch(e){}}zn[le]=!0,zn[P]=zn.remove,zn.deleteIn=zn.removeIn=$t,zn.getIn=mn,zn.hasIn=_n.hasIn,zn.merge=Ht,zn.mergeWith=Jt,zn.mergeIn=tr,zn.mergeDeep=Zt,zn.mergeDeepWith=er,zn.mergeDeepIn=rr,zn.setIn=Wt,zn.update=Kt,zn.updateIn=Gt,zn.withMutations=nr,zn.asMutable=or,zn.asImmutable=ir,zn[ge]=zn.entries,zn.toJSON=zn.toObject=_n.toObject,zn.inspect=zn.toSource=function(){return this.toString()};var $n,Un=function(e){function t(e,r){if(!(this instanceof t))return new t(e,r);if(this._value=e,this.size=void 0===r?1/0:Math.max(0,r),0===this.size){if($n)return $n;$n=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},t.prototype.get=function(e,t){return this.has(e)?this._value:t},t.prototype.includes=function(e){return Me(this._value,e)},t.prototype.slice=function(e,r){var n=this.size;return B(e,r,n)?this:new t(this._value,U(r,n)-$(e,n))},t.prototype.reverse=function(){return this},t.prototype.indexOf=function(e){return Me(this._value,e)?0:-1},t.prototype.lastIndexOf=function(e){return Me(this._value,e)?this.size:-1},t.prototype.__iterate=function(e,t){for(var r=this.size,n=0;n!==r&&!1!==e(this._value,t?r-++n:n++,this););return n},t.prototype.__iterator=function(e,t){var r=this,n=this.size,o=0;return new ve((function(){return o===n?{value:void 0,done:!0}:he(e,t?n-++o:o++,r._value)}))},t.prototype.equals=function(e){return e instanceof t?Me(this._value,e._value):an(this,e)},t}(je);function Kn(e,t){return Gn([],t||Hn,e,"",t&&t.length>2?[]:void 0,{"":e})}function Gn(e,t,r,n,o,i){if("string"!=typeof r&&!ue(r)&&(we(r)||me(r)||xt(r))){if(~e.indexOf(r))throw new TypeError("Cannot convert circular structure to Immutable");e.push(r),o&&""!==n&&o.push(n);var a=t.call(i,n,Ae(r).map((function(n,i){return Gn(e,t,n,i,o,r)})),o&&o.slice());return e.pop(),o&&o.pop(),a}return r}function Hn(e,t){return Z(t)?t.toList():Y(t)?t.toMap():t.toSet()}const Jn={version:"4.3.7",Collection:te,Iterable:te,Seq:Ae,Map:lr,OrderedMap:Ur,List:xr,Stack:Yr,Set:un,OrderedSet:Tn,PairSorting:{LeftThenRight:-1,RightThenLeft:1},Record:Vn,Range:hn,Repeat:Un,is:Me,fromJS:Kn,hash:$e,isImmutable:ue,isCollection:J,isKeyed:Y,isIndexed:Z,isAssociative:ee,isOrdered:pe,isValueObject:ze,isPlainObject:xt,isSeq:ae,isList:Lr,isMap:De,isOrderedMap:Ve,isStack:Xr,isSet:nn,isOrderedSet:on,isRecord:se,get:Rt,getIn:yn,has:Pt,hasIn:bn,merge:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return Qt(e,t)},mergeDeep:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return Yt(e,t)},mergeWith:function(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return Qt(t,r,e)},mergeDeepWith:function(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return Yt(t,r,e)},remove:Dt,removeIn:Bt,set:Vt,setIn:qt,update:Ut,updateIn:zt};var Xn=0;const Yn=function(){var e=((new Date).getTime().toString(16)+"FF").substr(0,11);return"ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,(function(e){var t="s"===e?Math.floor(16*Math.random()):15&Xn++;return("x"===e?t:3&t|8).toString(16)}))+e};function Qn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Zn=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],eo=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],to=function(e){return"object"===(0,T.A)(e)&&null!==e&&"[object Object]"===Object.prototype.toString.call(e)},ro=function(e){if("object"===(0,T.A)(e)&&null!==e){if(Array.isArray(e))return(0,I.A)(e);if(to(e))return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e)}return e},no=function(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var r=(0,x.A)(e,1)[0];return!t.includes(r)})))},oo=function(e){var t;return null!==(t=null==e?void 0:e.cardinality)&&void 0!==t?t:1},io=function(e,t){return e===t||(lr.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t))},ao=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?ao(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):lr.isMap(e)?e.equals(t):"object"==(0,T.A)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var a=0;a<i;a++){var l=n[a];if(!(r?ao(e[l],t[l],r):e[l]===t[l]))return!1}return!0}(e,t,r):e===t)};var lo=function(e){return"object"===(0,T.A)(e)&&null!==e&&"function"==typeof e.toJS},so=function(e){return lo(e)&&Jn.isList(e)};function uo(e){return so(e)?e:new Jn.List(e)}function co(e){return lo(e)?e.toJS():e}var po=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},fo=function(e,t,r,n,o,i){if(Array.isArray(e))return t},go=function e(t){var r;if(t instanceof Array)return t.map((function(t,r){return e(t)}));if("object"===(0,T.A)(t)&&null!==t&&vo(t)){var n,o=no(t,["$$typeof","_owner","_store","ref","key"]);return o.type&&(o.type="string"==typeof(r=o.type)?r:"function"==typeof r?r.name:r),null!=o&&null!==(n=o.props)&&void 0!==n&&n.children&&(o.props.children=e(o.props.children)),o}return t},vo=function(e){return"object"===(0,T.A)(e)&&null!==e&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},ho=function(e){return"object"===(0,T.A)(e)&&null!==e&&!Array.isArray(e)&&"string"==typeof e.type&&Object.keys(e).includes("props")},yo=function(e){return"object"===(0,T.A)(e)&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length};function mo(e){return new Promise((function(t){setTimeout(t,e)}))}function bo(e,t){return e||(e=[]),t||(t=[]),t.map((function(t){return[t,e.indexOf(t)]})).map((function(e,t,r){var n=(0,x.A)(e,2),o=n[0];if(-1==n[1]){var i=r.slice(t+1),a=r.slice(0,t).reverse().find((function(e){var t=(0,x.A)(e,2);return t[0],-1!=t[1]})),l=i.find((function(e){var t=(0,x.A)(e,2);return t[0],-1!=t[1]}));return l?[o,"before",l[0]]:a?[o,"after",a[0]]:[o,"append",null]}return null})).filter((function(e){return null!==e})).reduce((function(e,t){var r=(0,x.A)(t,3),n=r[0],o=r[1],i=r[2],a=e.indexOf(i);return-1==e.indexOf(n)&&(a>-1?e.splice(a+("after"==o?1:0),0,n):e.splice("append"==o?1/0:0,0,n)),e}),e.slice())}var Oo=function e(t){"object"!==(0,T.A)(t)||null===t||vo(t)||(Object.keys(t).forEach((function(r){"__cache"!==r&&e(t[r])})),Object.freeze(t))},_o=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(to(t)){if(t.var)return n[t.var]=r,!0;if(!to(r))return!1;for(var i in t)if(!e(t[i],r[i],n,[].concat((0,I.A)(o),[i])))return!1;return!0}if(Array.isArray(t)){if(!Array.isArray(r))return!1;for(var a=0;a<t.length;a++)if(!e(t[a],r[a],n,[].concat((0,I.A)(o),[a])))return!1;return!0}return t===r},So=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(null!=e?e:("undefined"!=typeof process&&process.env,0))?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},wo=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0;r<t.length;r++){var n=t[r];if(void 0!==n){e=n;break}}return e},Ao=So(),Fo=r(6834),jo=r.n(Fo),Eo=r(8831),ko=r.n(Eo),Co=r(8906),Lo=r.n(Co),xo=r(7027),Io=r.n(xo);function To(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Po(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Po(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Po(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var No=function(e){return"object"==(0,T.A)(e)&&null!==e&&!Array.isArray(e)},Do=function(e,t){return null==e||""==e?void 0:No(e)?Ro(Ro({},e),{},{title:e.title||e.value}):{value:e,title:void 0!==t?t:""+e}},Vo=function(e){var t=Do(e);return No(t)?Ro(Ro({},Do(e)),{},{isCustom:!0}):t},zo=function(e){if(Array.isArray(e))return e.map((function(e){return Do(e)}));if(!No(e))return e;var t=[];for(var r in e){var n=e[r];t.push(Do(r,n))}return t},Mo=function(e,t){return Array.isArray(e)?e.map((function(e){return Do(e)})).find((function(e){return""+e.value==""+t})):void 0!==e[t]?Do(t,e[t]):void 0},qo=function(e,t){if(null==e)return t;var r=Mo(e,t);return void 0!==r?r.title:t},Wo=function(e,t){if(null==e)return t;var r=Mo(e,t);return void 0!==r?r.value:t},Bo=function(e,t){var r=[];if(Array.isArray(e)){var n,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return To(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?To(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=t(Do(i));null!=a&&r.push(a)}}catch(e){o.e(e)}finally{o.f()}}else for(var l in e){var s=t(Do(l,e[l]));null!=s&&r.push(s)}return r},$o=function(e,t){return Bo(t,(function(t){return-1!="".concat(t.value).indexOf(e)||-1!=t.title.indexOf(e)?t:null})).filter((function(e){return null!==e})).shift()},Uo=function(e,t){return Bo(t,(function(t){return""+t.value==""+e?t:null})).filter((function(e){return null!==e})).shift()},Ko=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.skip(1),e.push.apply(e,r),e}))},Go=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.push.apply(e,r),e}))},Ho=function(e,t){var r=new Jn.OrderedMap((0,L.A)({},e.get("id"),e)),n=e;return t.forEach((function(e){var t,o;n=null===(t=r)||void 0===t?void 0:t.get(e),r=null===(o=n)||void 0===o?void 0:o.get("children1")})),n},Jo=function(e,t){var r=t.map((function(e,r){return t.take(r+1)})).reverse().toJS().map((function(t){return{item:Ho(e,t),path:t}})).filter((function(e){var t=e.item;return"rule_group"===(null==t?void 0:t.get("type"))}));return r.length?r.map((function(e){var t=e.item;return{path:e.path,field:t.get("properties").get("field")}})):[]},Xo=function(e){var t=e;return function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.push(r.get("id")),a=r.getIn(["properties","isLocked"]);o&&a&&(t=t.deleteIn(Ko(i,"properties","isLocked")));var l=r.get("children1");l&&l.map((function(t,r){e(t,i,a||o)}))}(e,new Jn.List),t},Yo=function(e){var t=e;return function e(r,n,o,i){if(r){var a=r.get("path"),l=r.get("id"),s=l||i||Yn(),u=n.push(s);a&&a.equals(u)||(t=t.setIn(Ko(u,"path"),u)),l||(t=t.setIn(Ko(u,"id"),s));var c=r.get("children1");c&&("Map"===c.constructor.name&&(t=t.setIn(Ko(u,"children1"),new Jn.OrderedMap(c))),c.map((function(t,r){e(t,u,o+1,r)})))}}(e,new Jn.List,0),t},Qo=function(e){var t=e;return function e(r,n,o,i){if(!r)return!1;var a=r.get("id")||i,l=n.push(a),s=r.get("children1");if(s){var u=s.map((function(t,r){return e(t,l,o+1,r)})).reduce((function(e,t){return e&&t}),!0);if((0==s.size||u)&&o>0)return t=t.deleteIn(Ko(l)),!0}return!1}(e,new Jn.List,0),t},Zo=function(e,t){var r=[],n={},o=[],i=0,a=0,l=0,s={};!function u(c,p,d,f,g,v,h,y,m){var b,O,_,S=c===e,w=c.get("type"),A=c.get("collapsed"),F=c.get("id"),j=c.get("children1"),E=c.getIn(["properties","isLocked"]),k=j?j.map((function(e,t){return t})).valueSeq().toArray():null,C="rule_group"===w,L="rule"===w,x="group"===w,T="case_group"===w,P=!g&&(!j||C),R=(null==k?void 0:k.length)>0,N=p.length?p[p.length-1]:null,D=(0,I.A)(p).reverse().find((function(e){return"rule_group"==n[e].type})),V=c.getIn(["properties","field"]),z=V&&t&&Ap(t,V),M=z?!1!==(null==z?void 0:z.canRegroup):void 0,q=null==z?void 0:z.maxNesting,W=null==n||null===(b=n[D])||void 0===b?void 0:b.canRegroup,B=null==n||null===(O=n[D])||void 0===O?void 0:O.maxNesting,$=null==n||null===(_=n[D])||void 0===_?void 0:_.lev,U=T?F:y;T&&(o.push(F),a=0,l=0,s={});var K,G=U?o.indexOf(U):null,H=r.length,J=i;S||((K={}).caseNo=G,K.globalNoByType=T?G:s[w]||0,K.indexPath=[].concat((0,I.A)(p.slice(1).map((function(e){return n[e].childNo}))),[m]),L?K.globalLeafNo=a:x&&(K.globalGroupNo=l));var X=g||C?h:h+1;r.push(F),n[F]={node:c,index:H,id:F,type:w,parent:N,children:k,childNo:m,caseId:U,caseNo:G,closestRuleGroupId:D,closestRuleGroupLev:$,closestRuleGroupMaxNesting:B,closestRuleGroupCanRegroup:W,maxNesting:q,canRegroup:M,path:p.concat(F),lev:v,atomicLev:h,nextAtomicLev:X,isLeaf:!j,isAtomicRule:P,isLocked:E||f,top:d?null:J,isDefaultCase:T?!j:void 0,atomicRulesCountInCase:T?0:void 0,position:K,collapsed:A,_top:H,parentType:N?n[N].type:null,leaf:!j};var Y=0,Q=0;d||(i+=1,Y+=1,!R||A||C||(Q+=1),S||T||(x&&l++,L&&a++,s[w]=(s[w]||0)+1)),y&&P&&n[y].atomicRulesCountInCase++;var Z=0,ee=0;if(R){var te=0;j.map((function(e,t){if(e){u(e,p.concat(F),d||A,f||E,g||C,v+1,X,U,te);var r=n[t];Z=Math.max(Z,r.depth||0),ee+=r.height,te++}}))}Y+=ee,Q+=Z;var re=r.length-H,ne=d?null:J+Y;Object.assign(n[F],{depth:j?Q:void 0,_height:re,height:Y,bottom:ne})}(e,[],!1,!1,!1,0,0,null,null);for(var u=0;u<r.length;u++){var c=u>0?r[u-1]:null,p=u<r.length-1?r[u+1]:null,d=n[r[u]];d.prev=c,d.next=p}return{flat:r,items:n,cases:o}},ei=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,a,l;"function"==typeof r.get?(i=r.get("id"),a=r.get("children1"),l=r.get("type")):(i=r.id,a=r.children1,l=r.type),t++,"rule_group"==l&&o>0||a&&a.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t-1},ti=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,a,l;"function"==typeof r.get?(i=r.get("id"),a=r.get("children1"),l=r.get("type")):(i=r.id,a=r.children1,l=r.type),"rule"==l||"rule_group"==l&&o>0?t++:a&&a.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t},ri=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return function e(n,o){t&&n.path&&delete n.path,t&&!r&&o&&delete n.id;var i=n.properties;i&&null==i.operatorOptions&&delete i.operatorOptions;var a=n.children1;if(a){for(var l in a)a[l]&&e(a[l],l);r&&(n.children1=Object.values(a))}}(e,null),n},ni=function(e){var t=[],r=e.get("children1");return r&&r.map((function(e){var r,n=e.getIn(["properties","value"]);n&&1==n.size?(r=n.get(0),Array.isArray(r)&&0==r.length&&(r=null)):r=null,t=[].concat((0,I.A)(t),[r])})),t},oi=function(e){return!e.get("children1")||0==e.get("children1").size},ii=function(e,t){return e.getIn(Ko(t,"children1")).size>0},ai=function(e){if(null!=e&&e.toJS){var t,r=null==e||null===(t=e.toJS)||void 0===t?void 0:t.call(e);return null!=r&&r.func?e.toOrderedMap():r}return e},li=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e;return n=n.toJS(),ri(n,t,r)}},si=function(e){if(ui(e))return e;if(ci(e))return Yo(pi(e));if("string"==typeof e&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if("string"==typeof e)return Yo(pi(JSON.parse(e)));throw new Error("Can't load tree!")},ui=function(e){return lr.isMap(e)},ci=function(e){return"object"==(0,T.A)(e)&&("group"==e.type||"switch_group"==e.type)};function pi(e){return Kn(e,(function(e,t,r){var n,o=r&&r.length>3&&"value"===r[r.length-1]&&"args"===r[r.length-3],i=r&&r.length>3&&"value"===r[r.length-1]&&"properties"===r[r.length-2];if("properties"==e){n=t.toOrderedMap();for(var a=0;a<2;a++){var l,s,u;null===(null===(l=n.get("value"))||void 0===l||null===(s=(u=l).get)||void 0===s?void 0:s.call(u,a))&&(n=n.setIn(["value",a],void 0))}}else n=o?ai(t):(r?i:"value"==e)&&Jn.Iterable.isIndexed(t)?t.map(ai).toList():"asyncListValues"==e?t.toJS():"children1"==e&&Jn.Iterable.isIndexed(t)?new Jn.OrderedMap(t.map((function(e){return[(null==e?void 0:e.get("id"))||Yn(),e]}))):Jn.Iterable.isIndexed(t)?t.toList():t.toOrderedMap();return n}))}var di=r(1667),fi=r(9523),gi=r(5626),vi=r(272);function hi(e){return(0,di.A)(e)||(0,fi.A)(e)||(0,gi.A)(e)||(0,vi.A)()}var yi=r(2468),mi=r.n(yi);function bi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bi(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Si(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Si(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Si(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wi="jlField",Ai="jlArgs",Fi=["==","!="],ji=["<","<=",">",">="],Ei=["multiselect_equals","multiselect_not_equals","multiselect_contains","multiselect_not_contains"],ki=function(e){return{errors:[],settings:null==e?void 0:e.settings}},Ci=function(e,t){return Li(e,t,!1)},Li=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=ki();n.settings={allowUnknownFields:!1,returnErrors:r};var o=Qc(t,void 0,!1),i=xi(o),a=e?Pi(e,i,o,["rule","group","switch"],n):void 0,l=a?si(a):void 0;return r?[l,n.errors]:(n.errors.length&&console.warn("Errors while importing from JsonLogic:",n.errors),l)},xi=function(e){var t={},r={};for(var n in e.operators){var o=e.operators[n];if("string"==typeof o.jsonLogic){var i=o.jsonLogic+"/"+oo(o);t[i]||(t[i]=[]),t[i].push(n)}else if("string"==typeof o.jsonLogic2){var a=o.jsonLogic2+"/"+oo(o);t[a]||(t[a]=[]),t[a].push(n),r[n]||(r[n]={}),r[n]={template:o.jsonLogic(wi,n,Ai),jsonLogic2:o.jsonLogic2,_jsonLogicIsExclamationOp:!!o._jsonLogicIsExclamationOp}}}var l={};for(var s in e.conjunctions)l[e.conjunctions[s].jsonLogicConj||s.toLowerCase()]=s;var u,c={},p=_i(sp(e));try{for(p.s();!(u=p.n()).done;){var d=(0,x.A)(u.value,2),f=d[0],g=d[1],v=void 0;g.jsonLogicIsMethod?v="#"+g.jsonLogic:"string"==typeof g.jsonLogic&&(v=g.jsonLogic),v&&(c[v]||(c[v]=[]),c[v].push(f))}}catch(e){p.e(e)}finally{p.f()}var h=e.settings.jsonLogic;return{operators:t,conjunctions:l,funcs:c,varKeys:["var",h.groupVarKey,h.altVarKey],combinationOperators:r}},Ii=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!=t&&t.combinationOperators)for(var i=0,a=Object.entries(t.combinationOperators);i<a.length;i++){var l=(0,x.A)(a[i],2),s=l[0],u=l[1];if(null==o||o.includes(s)){var c=Ti(u.template,e);c.match&&(n?r.errors.push("Operator matched against 2 templates: ".concat(n.newOp," and ").concat(s)):n=c,n.newOp=u.jsonLogic2)}}return n},Ti=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{match:!0,jlField:null,jlArgs:[]};if(null==t||null==r)return n.match=!1,n;var o=Object.keys(t),i=Object.keys(r);if(o.length!==i.length)return n.match=!1,n;for(var a=0;a<o.length;a++){var l=o[a],s=t[l];if(l!==i[a])return n.match=!1,n;if(s===wi&&yo(r[l]))n.jlField=r[l];else if(s===Ai)n.jlArgs.push(r[l]);else if("object"===(0,T.A)(s)&&null!==s||Array.isArray(s))n=e(s,r[l],n);else if(s!==r[l])return n.match=!1,n}return n},Pi=function e(t,r,n,o,i){var a,l,s,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;yo(t)&&(a=Object.keys(t)[0],l=t[a],Array.isArray(l)||(l=[l]));var f=i.errors.length,g=n.settings.jsonLogic.lockedOp,v="!"==a&&1==l.length&&l[0]&&yo(l[0])&&r.varKeys.includes(Object.keys(l[0])[0]),h=Ii(t,r,i);h&&((l=[])[0]=h.jlField,h.jlArgs.forEach((function(e){return l.push(e)})),a=h.newOp);var y="!"==a&&!v,m=g&&a==g,b=o.includes("switch");m?s=e(l[0],r,n,o,i,u,c,p,d,!0):y?s=e(l[0],r,n,o,i,!u,c,p,d):o.includes("val")?s=Ni(a,l,r,n,u,i,d)||Di(a,l,r,n,u,c,i,d)||Ri(t,c,p,n,i):(o.includes("switch")&&(s=Wi(a,l,r,n,u,i,d)),null==s&&o.includes("group")&&(s=Vi(a,l,r,n,u,i,d,!1)),null==s&&o.includes("rule")&&(s=qi(a,l,r,n,u,i,d)),s&&b&&!["group","switch_group"].includes(s.type)&&(s=zi(s,n)));var O=i.errors.length;return"!"!=a&&void 0===s&&O==f&&i.errors.push("Can't parse logic ".concat(JSON.stringify(t))),m&&(s.properties.isLocked=!0),s},Ri=function(e,t,r,n,o){var i;if(void 0===e&&(e=null==t?void 0:t.defaultValue),void 0!==e){r=r||(null==t?void 0:t.mainWidget);var a=n.widgets[r],l=null==t?void 0:t.type;if(!l||a){if(!yo(e)){if("time"===l&&"number"==typeof e){var s=Math.floor(e/60/60)%24,u=Math.floor(e/60)%60,c=e%60,p=a.valueFormat;if(p){var d=new Date(e);d.setMilliseconds(0),d.setHours(s),d.setMinutes(u),d.setSeconds(c),e=mi()(d).format(p)}else e="".concat(s,":").concat(u,":").concat(c)}if(["date","datetime"].includes(l)&&e&&!(e instanceof Date))try{var f=new Date(e);f instanceof Date&&f.toISOString()===e&&(e=f)}catch(t){o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var g=a.valueFormat;g&&(e=mi()(e).format(g))}var v;if(e&&null!=t&&null!==(i=t.fieldSettings)&&void 0!==i&&i.asyncFetch&&(v=Array.isArray(e)?e:[e]),null!=a&&a.jsonLogicImport)try{e=a.jsonLogicImport.call(n.ctx,e)}catch(t){var h;o.errors.push("Can't import value ".concat(e," using import func of widget ").concat(r,": ").concat(null!==(h=null==t?void 0:t.message)&&void 0!==h?h:t)),e=void 0}return{valueSrc:"value",value:e,valueType:null==a?void 0:a.type,asyncListValues:v}}o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)))}else o.errors.push("No widget for type ".concat(l))}},Ni=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(r.varKeys.includes(e)&&"string"==typeof t[0]){var l,s=dp(n,t[0],a),u=Ap(n,s);return u||null!==(l=i.settings)&&void 0!==l&&l.allowUnknownFields?{valueSrc:"field",value:s,valueType:null==u?void 0:u.type}:void i.errors.push("No config for field ".concat(s))}},Di=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(e){var s,u,c,p="method"==e;if(p){var d,f,g=hi(t);d=g[0],s=g[1],f=g.slice(2),u=[d].concat((0,I.A)(f))}else s=e,u=t;var v=(p?"#":"")+s,h=(null==i?void 0:i.type)||(null==i?void 0:i.returnType),y=(r.funcs[v]||[]).filter((function(e){return!i||gp(n,e).returnType==h}));if(y.length)c=y[0];else{var m,b=(0,L.A)({},e,t),O=_i(sp(n));try{for(O.s();!(m=O.n()).done;){var _=(0,x.A)(m.value,2),S=_[0],w=_[1];if(w.jsonLogicImport&&(!h||w.returnType==h)){var A=void 0;try{A=w.jsonLogicImport(b)}catch(e){}A&&(c=S,u=A)}}}catch(e){O.e(e)}finally{O.f()}}if(c&&c){var F=gp(n,c),j=Object.keys(F.args||{}),E=u.reduce((function(e,t,o){var i,s=j[o],u=F.args[s];return u&&(i=Pi(t,r,n,["val"],a,!1,u,null,l)),void 0!==i?Oi(Oi({},e),{},(0,L.A)({},s,i)):e}),{});for(var k in F.args){var C,T=F.args[k],P=E[k];if(void 0===P)if(void 0!==(P=null==T?void 0:T.defaultValue)&&(P={value:P,valueSrc:null!==(C=P)&&void 0!==C&&C.func?"func":"value",valueType:T.type}),void 0===P){if(null==T||!T.isOptional)return void a.errors.push("No value for arg ".concat(k," of func ").concat(c))}else E[k]=P}return{valueSrc:"func",value:{func:c,args:E},valueType:F.returnType}}}},Vi=function(e,t,r,n,o,i){var a,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=r.conjunctions[e],u=n.settings.fieldSeparator;if(s){var c=t.map((function(e){return Pi(e,r,n,["rule","group"],i,!1,null,null,l)})).filter((function(e){return void 0!==e})).reduce((function(e,t){return Oi(Oi({},e),{},(0,L.A)({},t.id,t))}),{}),p=Object.values(c).map((function(e){var t,r;return"field"==(null==e||null===(t=e.properties)||void 0===t?void 0:t.fieldSrc)&&(null==e||null===(r=e.properties)||void 0===r?void 0:r.field)})).filter((function(e){var t;return null==e||null===(t=e.includes)||void 0===t?void 0:t.call(e,u)})),d=Object.fromEntries((a=p,Array.from(new Set(a))).map((function(e){var t=e.split(u),r=Object.fromEntries(t.slice(0,-1).map((function(e,t,r){return[].concat((0,I.A)(r.slice(0,t)),[e])})).map((function(e){return[e.join(u),Ap(n,e)]})).filter((function(e){var t=(0,x.A)(e,2),r=(t[0],t[1]);return"!group"==(null==r?void 0:r.type)})));return[e,Object.keys(r)]}))),f={conjunction:s,not:o},g=Yn(),v={},h={};return Object.entries(c).map((function(e){var t=(0,x.A)(e,2),r=t[0],o=t[1];if("group"==(null==o?void 0:o.type)||"rule_group"==(null==o?void 0:o.type))v[r]=o;else{var i,a=null==o||null===(i=o.properties)||void 0===i?void 0:i.field,c=d[a]||[],p=c[c.length-1];if(p){var f=v,g=mp(l,n),y=mp(p,n);ao(g,y.slice(0,g.length))||(g=[]),p.split(u).slice(g.length).map((function(e,t,r){return[].concat((0,I.A)(g),(0,I.A)(r.slice(0,t)),[e]).join(u)})).map((function(e){return{f:e,fc:Ap(n,e)||{}}})).filter((function(e){return"!struct"!=e.fc.type})).map((function(e,t){var r=e.f,n=e.fc,o=h[r];o||(o=Yn(),h[r]=o,f[o]={type:"rule_group",id:o,children1:{},properties:{conjunction:s,not:!1,field:r,fieldSrc:"field",mode:n.mode}}),f=f[o].children1})),f[r]=o}else o&&(v[r]=o)}})),{type:"group",id:g,children1:v,properties:f}}},zi=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:Yn(),children1:(0,L.A)({},e.id,e),properties:{conjunction:il(t),not:r}}},Mi=function(e,t,r,n,o,i,a){var l,s=Ei.map((function(e){var t;return null===(t=i.operators[e])||void 0===t?void 0:t.jsonLogic2})).includes(e),u=i.settings.groupOperators.includes(e)&&!s,c=u?0:t-1;u?c=0:Fi.includes(e)&&1==c&&null===r[1]&&(t=1,c=0,r=[r[0]]);var p=e+"/"+c,d=o.operators[p];if(d){var f,g=[];if(ji.includes(e)&&3==t)f=r[1],g=[r[0],r[2]];else{var v=hi(r);f=v[0],g=v.slice(1)}if(yo(f)){var h=function(e,t,r,n,o){var i,a,l,s,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,p=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,f=Object.keys(t)[0],g=Object.values(t)[0],v=function(e,t){return function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Array.isArray(t)||(t=[t]);var l=Ni(e,t,r,n,o,i,a);if(l)return{fieldSrc:"field",field:l.value}}(e,t,n,o,u,p,d)||function(e,t,r,n,o){var i=Di(e,t,r,n,o,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6?arguments[6]:void 0,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null);if(i)return{fieldSrc:"func",field:i.value}}(e,t,n,o,u,c,p,d)},h=p.errors.length,y=v(f,g);if(y&&(i=y.field,a=y.fieldSrc),e&&(s=!0,l=r[0],r=[]),"reduce"==f&&Array.isArray(g)&&3==g.length){var m=g,b=(0,x.A)(m,3),O=b[0],_=b[1],S=b[2];if(yo(O)&&0==S&&yo(_)&&Array.isArray(_["+"])&&1==_["+"][0]&&yo(_["+"][1])&&"accumulator"==_["+"][1].var)if(f=Object.keys(O)[0],g=Object.values(O)[0],"filter"==f){var w=g,A=(0,x.A)(w,2),F=A[0],j=A[1];if(yo(F)){var E=v(f=Object.keys(F)[0],g=Object.values(F)[0]);E&&(i=E.field,a=E.fieldSrc,l=j,s=!0)}}else{var k=v(f,g);k&&(i=k.field,a=k.fieldSrc,s=!0)}}var C=p.errors.length;if(i||C!=h||p.errors.push("Unknown LHS ".concat(JSON.stringify(t))),i)return{field:i,fieldSrc:a,having:l,isGroup:s,args:r}}(u,f,g,o,i,null,null,a,n);if(h){var y=h.field,m=h.fieldSrc,b=h.having,O=(h.isGroup,h.args),_=Ap(i,y);if(_||null!==(l=a.settings)&&void 0!==l&&l.allowUnknownFields){var S=d[0];if(d.length>1&&_&&_.operators){if(0==(d=d.filter((function(e){return _.operators.includes(e)}))).length)return void a.errors.push("No corresponding ops for LHS ".concat(y));S=d[0]}return{field:y,fieldSrc:m,fieldConfig:_,opKey:S,args:O,having:b}}a.errors.push("No config for LHS ".concat(y))}}else a.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)))}},qi=function e(t,r,n,o,i,a){var l,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(t){var c=Object.values(o.conjunctions).map((function(e){return e.jsonLogicConj})),p=function(e,t,r,n,o,i,a){var l=ki(a),s=Mi(e,t,r,n,o,i,l);if(s)return s;a.errors.push(l.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t))}(t,r.length,r,s,n,o,a);if(p){var d,f,g=p.field,v=p.fieldSrc,h=p.fieldConfig,y=p.opKey,m=p.args,b=p.having,O=Ap(o,s),_=o.operators[y],S=!!o.operators[null===(l=_)||void 0===l?void 0:l.reversedOp],w="!group"==h.type,A="!group"==(null==O?void 0:O.type),F=S&&(!!o.settings.reverseOperatorsForNot||w&&!b||!w&&A&&!u),j=i&&F||!1,E=!1,k=!!o.settings.reverseOperatorsForNot;if("!group"==(null==h?void 0:h.type)&&b){d=Object.keys(b)[0],f=b[d],Array.isArray(f)||(f=[f]);for(var C=Ii(b,n,a);"!"==d&&!C&&!("!"==d&&1==f.length&&f[0]&&yo(f[0])&&n.varKeys.includes(Object.keys(f[0])[0]));){E=!E,b=b["!"],d=Object.keys(b)[0],f=b[d],k&&c.includes(d)&&1==f.length&&(b=b[d][0],d=Object.keys(b)[0],f=b[d]),C=Ii(b,n,a)||C}Array.isArray(f)||(f=[f]),C&&((f=[])[0]=C.jlField,C.jlArgs.forEach((function(e){return f.push(e)})),d=C.newOp)}j&&(i=!i,y=_.reversedOp,_=o.operators[y]);var x=Uu(o,g,y,null),I=m.map((function(e){return Pi(e,n,o,["val"],a,!1,h,x,s)}));if(!I.filter((function(e){return void 0===e})).length){var T,P=null==h?void 0:h.type;if("!group"!==P&&"!struct"!==P||(P=null),"!group"==(null==h?void 0:h.type)&&b){var R;if(void 0!==n.conjunctions[d]?T=Vi(d,f,n,o,E,a,g,!0):(T=e(d,f,n,o,E,a,g,!0))&&("rule_group"===T.type&&(null===(R=T.properties)||void 0===R?void 0:R.field)!==g&&(T=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e)return{type:"rule_group",id:Yn(),children1:(0,L.A)({},e.id,e),properties:{conjunction:o||il(n,r),not:i,field:t}}}(T,g,h,o)),Object.assign(T.properties,{conjunction:il(o,h)})),!T)return;T.type="rule_group",Object.assign(T.properties,{field:g,mode:h.mode,operator:y}),"array"==h.mode&&Object.assign(T.properties,{value:I.map((function(e){return e.value})),valueSrc:I.map((function(e){return e.valueSrc})),valueType:I.map((function(e){return e.valueType}))}),i&&(T=zi(T,o,i))}else if("!group"!=(null==h?void 0:h.type)||b){var N=I.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),D=N.length?N[0]:void 0;T={type:"rule",id:Yn(),properties:Oi({field:g,fieldSrc:v,operator:y,value:I.map((function(e){return e.value})),valueSrc:I.map((function(e){return e.valueSrc})),valueType:I.map((function(e){return e.valueType}))},D?{asyncListValues:D}:{})},(i||u)&&(T=zi(T,o,i))}else T={type:"rule_group",id:Yn(),children1:{},properties:{conjunction:il(o,h),not:!1,mode:h.mode,field:g,operator:y}},"array"===h.mode&&Object.assign(T.properties,{value:I.map((function(e){return e.value})),valueSrc:I.map((function(e){return e.valueSrc})),valueType:I.map((function(e){return e.valueType}))}),i&&(T=zi(T,o,i));return T}}}},Wi=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("if"===(null==e?void 0:e.toLowerCase())){var l=Bi(t).map((function(e){var t=(0,x.A)(e,2),o=t[0],l=t[1];return[o?Pi(o,r,n,["rule","group"],i,!1,null,null,a):null,Ui(n,i,r,l)]})).map((function(e){var t=(0,x.A)(e,2),r=t[0],o=t[1];return $i(r,o,n,i)}));return{type:"switch_group",id:Yn(),children1:l,properties:{}}}},Bi=function(e){var t=[];return function e(r){var n=(0,x.A)(r,3),o=n[0],i=n[1],a=n[2];t.push([o,i]);var l=yo(a)?Object.keys(a)[0]:null;"if"===(null==l?void 0:l.toLowerCase())?e(a[l]):t.push([void 0,a])}(e),t},$i=function(e,t,r,n){var o;return e?(o=Oi({},e)).type?("group"!=o.type&&(o=zi(o,r)),o.type="case_group"):(n.errors.push("Unexpected case: ".concat(JSON.stringify(o))),o=void 0):o={id:Yn(),type:"case_group",properties:{}},o&&(o.properties=Oi(Oi({},o.properties),t)),o},Ui=function(e,t,r,n){var o=Ap(e,"!case_value");if(o){var i=o.mainWidget,a=e.widgets[i];if(a){var l=Pi(n,r,e,["val","case_val"],t,!1,o,i);if(null!=l){var s=l.value,u=l.valueSrc,c=l.valueType;return{value:[s],valueSrc:[null!=u?u:"value"],valueType:[null!=c?c:null==a?void 0:a.type],field:"!case_value"}}}else t.errors.push("No widget ".concat(i," for case value"))}else t.errors.push("Missing caseValueField in settings")},Ki=r(138),Gi=r(358),Hi=r.n(Gi)();Hi.trim=function(e){return"'"==e.charAt(0)?e.substring(1,e.length-1):e},Hi.escapeLike=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Hi.escape(e);return"'"+(n=(t?"%":"")+(n=(n=Hi.trim(n)).replace(/[%_]/g,"\\$&"))+(r?"%":""))+"'"};var Ji=function(e){var t="''",r=null==e?void 0:e.type;return"date"==r?t="'0000-00-00'":"datetime"==r?t="'0000-00-00 00:00'":"time"==r?t="'00:00'":"number"==r&&(t="0"),t},Xi=function(e){var t="";return"number"==(null==e?void 0:e.type)&&(t=0),t},Yi=function(e){return"".concat(e,".?[true]")},Qi=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return"null";switch((0,T.A)(e)){case"boolean":return e?"true":"false";case"number":if(!Number.isFinite(e)||isNaN(e))return;return e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=["int","float"];return e.map((function(e){if(null!=e){if("string"==typeof e)r="String";else{if("number"!=typeof e)throw new Error("spelEscape: Can't use value ".concat(e," in array"));r=Number.isInteger(e)?"int":"float"}if(t){if(t!=r){if(!i.includes(t)||!i.includes(r))throw new Error("spelEscape: Can't use different types in array: found ".concat(t," and ").concat(r));t="float"}}else t=r}})),t||(t="String"),n="float"==t?e.map((function(e){return Qi(e,!0)})):e.map((function(e){return Qi(e)})),o?"new ".concat(t,"[]{").concat(n.join(", "),"}"):"{".concat(n.join(", "),"}")}(e,r);throw new Error("spelEscape: Object is not supported");default:return function(e){return"'"+e.replace(/'/g,"''")+"'"}(e)}},Zi=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){return"const"==e.type?Qi(e.value):"property"==e.type?""+e.value:"variable"==e.type?"#"+e.value:void 0})).filter((function(e){return null!=e})).join(" + "):"null"},ea=function(e){if(null==e)return[void 0,[]];var t=[],r="case_value"==e.valueType?e.value:e;return[(Array.isArray(r)?r:[r]).map((function(e){return"value"===e.valueSrc?null===e.value?void 0:{type:"const",value:e.value}:"field"===e.valueSrc?{type:e.isVariable?"variable":"property",value:e.value}:void t.push("Unsupported valueSrc ".concat(e.valueSrc," in concatenation"))})).filter((function(e){return null!=e})),t]},ta=function(e){return null==e?"NULL":e.toString()},ra=function(e){return null==e||"("===(null==e?void 0:e[0])&&")"===(null==e?void 0:e[(null==e?void 0:e.length)-1])?e:"("+e+")"};function na(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return oa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function oa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ia(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function aa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ia(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ia(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var la="${0}.compareTo(${1})",sa={datetime:!0,time:!0,date:!0},ua=function(e,t){return ca(e,t,!1)},ca=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=Qc(t,void 0,!1),i=pa(e,o,n,null);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SpEL:",n.errors),i)},pa=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return"group"===o||"rule_group"===o?ga(e,t,r,n):"rule"===o?ya(e,t,r,n):"switch_group"==o?fa(e,t,r,n):"case_group"==o?da(e,t,r,n):void 0}},da=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type");if("case_group"==o){var i=e.get("properties")||new lr,a=ba(t,i,r,null,n,"!case_value"),l=(0,x.A)(a,3),s=l[0];return l[1],l[2],[ga(e,t,r,n),s]}r.errors.push("Unexpected child of type ".concat(o," inside switch"))},fa=function(e,t,r){e.get("properties")||new lr;var n=e.get("children1");if(n){var o=n.map((function(e){return da(e,t,r,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray();if(o.length){if(1==o.length&&!o[0][0])return o[0][1];for(var i=[],a=0;a<o.length;a++)a==o.length-1||o[a][0]?(i.push(o[a]),a==o.length-1&&o[a][0]&&i.push([void 0,null])):r.errors.push("No condition for case ".concat(a));for(var l="",s="",u=0;u<i.length;u++){var c=(0,x.A)(i[u],2),p=c[0],d=c[1];null==d&&(d="null"),null==p&&(p="true"),u!=i.length-1?(l+="(".concat(p," ? ").concat(d," : "),s+=")"):l+="".concat(d)}return l+s}}},ga=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type"),i=e.get("properties")||new lr,a=i.get("mode"),l=e.get("children1")||new xr,s=i.get("field"),u=i.get("conjunction");u||(u=al(t));var c=t.conjunctions[u],p=i.get("not"),d="rule_group"===o,f=d&&"struct"!=a,g=f?s:n,v=(Ap(t,g)||{}).isSpelArray,h=t.settings.fieldSeparator,y=i.get("operator");y||a&&"some"!=a||(y="some");var m=ha(t,y,s),b=m!=y,O=y&&Fp(t,m,s)||null,_=d&&(!m||0==O.cardinality),S=ba(t,i,r,m,n,null),w=(0,x.A)(S,3),A=w[0],F=w[1],j=w[2],E=l.map((function(e){return pa(e,t,r,g)})).filter((function(e){return void 0!==e}));if(f&&!_){if(null==A)return}else if(!E.size)return;var k,C=d,L=E.size?c.spelFormatConj.call(t.ctx,E,u,p,C):null;if(f){var I=_a(r,t,s,n),T=(h||".")+(v?"length":"size()"),P="".concat(I).concat(T),R=L?"".concat(I,".?[").concat(L,"]").concat(T):P;k=va(r,t,i,R,_?P:A,m,F,j,b)}else k=L;return k},va=function(e,t,r,n,o,i,a,l){var s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=r.get("field"),c=Fp(t,i,u)||{},p=Ap(t,u)||{},d=r.get("operatorOptions"),f=c.spelFormatOp||function(e,t,r){var n=t.spelOp;if(n){var o,i=n.includes("${0}"),a=sa[r],l=n,s=oo(t);return a?o=function(e,t,r,n,o,i,a,u){var c=la.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:s>1?r[n-1]:r}));return"".concat(c," ").concat(l," 0")}:i?o=function(e,t,r,o,i,a,l,u){return n.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:s>1?r[n-1]:r}))}:0==s?o=function(e,t,r,n,o,i,a,s){return"".concat(e," ").concat(l)}:1==s&&(o=function(e,t,r,n,o,i,a,s){return"".concat(e," ").concat(l," ").concat(r)}),o}}(0,c,l);if(f){var g,v=[n,i,o,a,l,no(c,eo),d,p];return g=f.call.apply(f,[t.ctx].concat(v)),s&&(g=t.settings.spelFormatReverse.call(t.ctx,g)),void 0===g&&e.errors.push("Operator ".concat(i," is not supported for value source ").concat(a)),g}e.errors.push("Operator ".concat(i," is not supported"))},ha=function(e,t,r){if(t){var n=Fp(e,t,r)||{},o=n.reversedOp,i=Fp(e,o,r)||{},a=n.spelOp||n.spelFormatOp,l=i.spelOp||i.spelFormatOp;if(a||l){if(!a&&l){var s=[o,t];t=s[0],o=s[1];var u=[i,n];n=u[0],i=u[1]}return t}}},ya=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("properties")||new lr,i=o.get("field"),a=o.get("fieldSrc"),l=o.get("operator");if(null!=i&&null!=l){var s=ha(t,l,i);if(s){var u=s!=l,c=ba(t,o,r,s,n,null),p=(0,x.A)(c,3),d=p[0],f=p[1],g=p[2];if(void 0!==d){var v=ma(r,t,i,a,n);if(void 0!==v)return va(r,t,o,v,d,s,f,g,u)}}else r.errors.push("Operator ".concat(l," is not supported"))}},ma=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"func"===n?Sa(e,t,r,o):_a(e,t,r,o)},ba=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");("!case_value"==i||s&&"case_value"==s.get(0))&&(a="!case_value");var u,c=Ap(e,a)||{},p=Fp(e,n,a)||{},d=oo(p),f=t.get("value"),g=t.get("asyncListValues"),v=[],h=[];if(null!=f){var y=f.map((function(t,i){var u=l?l.get(i):null,d=s?s.get(i):null,f=rc(t,u,e),y=Uu(e,a,n,u),m=jp(e,a,n,y,u,{forExport:!0}),b=Oa(r,e,f,u,d,m,c,n,p,o,g);return void 0!==b&&(v.push(u),h.push(d)),b})),m=y.filter((function(e){return void 0===e})).size>0;y.size<d||m||(u=d>1?y.toArray():1==d?y.first():null)}return[u,v.length>1?v:v[0],h.length>1?h:h[0]]},Oa=function(e,t,r,n,o,i,a,l,s){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"===n)p=_a(e,t,r,u);else if("func"===n)p=Sa(e,t,r,u);else if("function"==typeof(null==i?void 0:i.spelFormatValue)){var d=i.spelFormatValue,f=[r,aa(aa({},ko()(a,["fieldSettings","listValues"])),{},{asyncListValues:c}),no(i,Zn)];if(l&&(f.push(l),f.push(s)),"field"==n){var g=Ap(t,r)||{};f.push(g)}p=d.call.apply(d,[t.ctx].concat(f))}else p=Qi(r);return p}},_a=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,i=Ap(t,r)||{},a=mp(r,t),l=zu(r,t,n),s=t.settings.formatSpelField,u=Ku(r,t,e,n),c=l.map((function(e){var t,r=(0,x.A)(e,3),n=r[0],i=r[1],a=r[2];return a&&(t="!struct"==a.type||"!group"==a.type&&"struct"==a.mode?i.isSpelMap?"map":"class":"!group"==a.type?i.isSpelItemMap?"[map]":"[class]":"class"),{key:n,parent:t,isSpelVariable:null==i?void 0:i.isSpelVariable,fieldSeparator:o}}));return s.call(t.ctx,u,n,a,c,i,t)}},Sa=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),l=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),s=gp(t,a);if(s){var u={},c=[],p=[];for(var d in s.args){var f,g,v=s.args[d],h=Ap(t,v),y=v.defaultValue,m=v.isOptional,b=null!=y&&y.func?"func":"value",O=l?l.get(d):void 0,_=O?O.get("value"):void 0,S=O?O.get("valueSrc"):void 0;"func"!==S&&null!==(f=_)&&void 0!==f&&f.toJS&&(_=_.toJS());var w=O?O.get("asyncListValues"):void 0,A=null===(g=v.spelEscapeForFormat)||void 0===g||g,F=null,j=Uu(t,v,F,S),E=jp(t,v,F,j,S,{forExport:!0}),k=Oa(e,t,_,S,v.type,E,h,null,null,i,w);if(null!=_&&void 0===k)return void("func"!=S&&e.errors.push("Can't format value of arg ".concat(d," for func ").concat(a)));var C=void 0;if(void 0===k&&!m&&null!=y){var L=Uu(t,v,F,b),x=jp(t,v,F,L,b,{forExport:!0});if(void 0===(C=Oa(e,t,y,b,v.type,x,h,null,null,i,w)))return void("func"!=b&&e.errors.push("Can't format default value of arg ".concat(d," for func ").concat(a)))}var I=null!=k?k:C;if(void 0!==I){var T;if(c.length){var P,R=na(c);try{for(R.s();!(P=R.n()).done;){var N=P.value;u[N]=void 0}}catch(e){R.e(e)}finally{R.f()}c=[]}u[d]=A?I:null!==(T=_)&&void 0!==T?T:y}else m||p.push(d),c.push(d)}if(!p.length){var D;if("function"==typeof s.spelFormatFunc){var V=s.spelFormatFunc,z=[u];D=V.call.apply(V,[t.ctx].concat(z))}else if(s.spelFunc){D=s.spelFunc.replace(/\${(\w+)}/g,(function(e,t){var r;return null!==(r=u[t])&&void 0!==r?r:e}));var M,q=Object.keys(s.args||{}).reverse().filter((function(e){return!!s.args[e].isOptional})),W=na(q);try{for(W.s();!(M=W.n()).done;){var B=M.value;if(null!=u[B])break;D=D.replace(new RegExp("(, )?\\${"+B+"}","g"),"")}}catch(e){W.e(e)}finally{W.f()}D=D.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(a," is not supported"));return D}}else e.errors.push("Func ".concat(a," is not defined in config"))};function wa(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Aa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Aa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ja(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fa(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ea={number:"number",string:"text",boolean:"boolean",null:"null"},ka={String:"text"},Ca=function(e){return"object"==(0,T.A)(e)&&null!==e&&!Array.isArray(e)},La=function(e,t){return xa(e,t,!0)},xa=function(e,t){var r,n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={errors:[]},a=Qc(t,void 0,!1),l=Pa(a),s=void 0;try{r=Ki.SpelExpressionEvaluator.compile(e)._compiledExpression}catch(e){i.errors.push(e)}r&&(n=Ia(r,i),Ao.debug("convertedObj:",n,i),(s=Ra(n,l,a,i))&&"group"!=s.type&&"switch_group"!=s.type&&(s=Xa(s,a,n.not)),Ao.debug("jsTree:",s));var u=s?si(s):void 0;return o?[u,i.errors]:(i.errors.length&&console.warn("Errors while importing from SpEL:",i.errors),u)},Ia=function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.getType(),a=t.getChildren().map((function(n){return e(n,r,t)}));if("op-or"!=i&&"op-and"!=i||(a=a.reduce((function(e,t){var r=t.type!=i||t.not?[t]:t.children;return[].concat((0,I.A)(e),(0,I.A)(r))}),[])),"op-not"==i)return 1!=a.length&&r.errors.push("Operator NOT should have 1 child, but got ".concat(a.length,"}")),ja(ja({},a[0]),{},{not:!a[0].not});if("compound"==i){var l=(a=a.filter((function(e){return!("selection"==e.type&&1==e.children.length&&"boolean"==e.children[0].type&&1==e.children[0].val)}))).find((function(e){return"selection"==e.type}));l&&1!=l.children.length&&r.errors.push("Selection should have 1 child, but got ".concat(l.children.length));var s=l?l.children[0]:null,u=a[a.length-1],c="method"==u.type&&"size"==u.val.methodName||"!func"==u.type&&"size"==u.methodName,p="property"==u.type&&"length"==u.val,d=a.filter((function(e){return e!==l&&e!==u})),f={type:"compound",children:d};if((c||p)&&null!=Da(d))return{type:"!aggr",filter:s,source:f};if(a=(a=a.filter((function(e){var t="variable"==e.type&&"this"==e.val,r="variable"==e.type&&"root"==e.val;return!(t||r)}))).map((function(e){return"indexer"==e.type&&1==e.children.length?{type:"indexer",val:e.children[0].val,itype:e.children[0].type}:e})),"!func"==u.type){var g={},v=g;do{var h,y;Object.assign(v,u),a=a.filter((function(e){return e!==u})),"!func"==(null===(y=u=a[a.length-1])||void 0===y?void 0:y.type)?(v.obj={},v=v.obj):a.length>1?v.obj={type:"compound",children:a}:v.obj=u}while("!func"==(null===(h=u)||void 0===h?void 0:h.type));return g}}try{t.getRaw?n=t.getRaw():0==t.getValue.length&&(n=t.getValue())}catch(e){Ao.error("[spel2js] Error in getValue()",e)}if("ternary"==i&&(n=Ta(a)),"object"===(0,T.A)(n)&&null!==n&&(n.methodName||n.functionName)&&(n.args=n.args.map((function(n){return e(n,r,t)}))),"list"==i&&(n=n.map((function(n){return e(n,r,t)})),!o&&1==n.length))return n[0];if("constructorref"==i){var m=a.find((function(e){return"qualifiedidentifier"==e.type})),b=null==m?void 0:m.val;return b?{type:"!new",cls:b,args:a.filter((function(e){return"qualifiedidentifier"!=e.type}))}:void r.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(a)))}if("typeref"==i){var O=a.find((function(e){return"qualifiedidentifier"==e.type})),_=null==O?void 0:O.val;return _?(a.filter((function(e){return"qualifiedidentifier"!=e.type})),{type:"!type",cls:_}):void r.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(a)))}if("function"==i||"method"==i){var S=n,w=S.functionName,A=S.methodName,F=S.args;return{type:"!func",methodName:w||A,isVar:"function"==i,args:F}}return{type:i,children:a,val:n}},Ta=function(e){var t=[];return function e(r){var n=(0,x.A)(r,3),o=n[0],i=n[1],a=n[2];t.push([o,i]),"ternary"==(null==a?void 0:a.type)?e(a.children):t.push([void 0,a])}(e),t},Pa=function(e){var t={},r=function(r){var n=e.operators[r];if(n.spelOps)n.spelOps.forEach((function(e){var n=e;t[n]||(t[n]=[]),t[n].push(r)}));else if(n.spelOp){var o=n.spelOp;t[o]||(t[o]=[]),t[o].push(r)}else Ao.log("[spel] No spelOp for operator ".concat(r))};for(var n in e.operators)r(n);var o={};for(var i in e.conjunctions)o[e.conjunctions[i].spelConj||i.toLowerCase()]=i;var a,l={},s=wa(sp(e));try{var u=function(){var e=(0,x.A)(a.value,2),t=e[0],r=e[1],n=[],o=r.spelFunc;if("string"==typeof o){var i=Object.keys(r.args||{}).reverse().filter((function(e){return!!r.args[e].isOptional||null!=r.args[e].defaultValue})),s=o.replace(/\${(\w+)}/g,(function(e,t){return"?"})),u=i.reduce((function(e,t){return[].concat((0,I.A)(e),[[t].concat((0,I.A)(e[e.length-1]||[]))])}),[]).map((function(e){return o.replace(/(?:, )?\${(\w+)}/g,(function(t,r){return e.includes(r)?"":t})).replace(/\${(\w+)}/g,(function(e,t){return"?"}))}));n=[s].concat((0,I.A)(u))}var c,p=wa(n);try{for(p.s();!(c=p.n()).done;){var d=c.value;l[d]||(l[d]=[]),l[d].push(t)}}catch(e){p.e(e)}finally{p.f()}};for(s.s();!(a=s.n()).done;)u()}catch(e){s.e(e)}finally{s.f()}var c={};for(var p in e.widgets){var d=e.widgets[p],f=d.spelImportFuncs;if(d.type,f){var g,v=wa(f);try{for(v.s();!(g=v.n()).done;){var h=g.value;if("string"==typeof h){var y=h.replace(/\${(\w+)}/g,(function(e,t){return"?"})),m=(0,I.A)(h.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,x.A)(e,2);return t[0],t[1]}));c[y]||(c[y]=[]),c[y].push({w:p,argsOrder:m})}}}catch(e){v.e(e)}finally{v.f()}}}var b={};for(var O in e.operators){var _=e.operators[O].spelOp;if(null!=_&&_.includes("${0}")){var S=_.replace(/\${(\w+)}/g,(function(e,t){return"?"})),w=(0,I.A)(_.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,x.A)(e,2);return t[0],t[1]}));b[S]||(b[S]=[]),b[S].push({op:O,argsOrder:w})}}return b[la.replace(/\${(\w+)}/g,(function(e,t){return"?"}))]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:l,valueFuncs:c,opFuncs:b}},Ra=function e(t,r,n,o){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(t){t._groupField=null!==(i=t._groupField)&&void 0!==i?i:null==a?void 0:a._groupField;var l,s=!0;if(0===t.type.indexOf("op-")||"matches"===t.type)l=Na(t,r,n,o,a);else if("!aggr"==t.type){var u,c=e(t.source,r,n,o,t);t._groupField=null==c?void 0:c.value;var p=e(t.filter,r,n,o,t);"rule"==(null===(u=p)||void 0===u?void 0:u.type)&&(p=Xa(p,n,t.filter.not)),l={groupFilter:p,groupFieldValue:c},a||(l=void 0,o.errors.push("Unexpected !aggr in root"),s=!1)}else if("ternary"==t.type){var d={};t.val.forEach((function(e){var i=(0,x.A)(e,2),a=i[0],l=i[1],s=Ga(a,l,r,n,o,t);s&&(d[s.id]=s)})),l={type:"switch_group",id:Yn(),children1:d,properties:{}}}if(!l&&s&&(l=Va(t,r,n,o,a)),l&&!l.type&&!a){var f=Ka(t,r,n,o);f?l=f:(l=void 0,o.errors.push("Can't convert rule of type ".concat(t.type,", it looks like var/literal")))}return l}},Na=function e(t,r,n,o){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=t.type.startsWith("op-")?t.type.slice(3):t.type;if(("minus"==l||"plus"==l)&&1==t.children.length){var s=t.negative;return"minus"==l&&(s=!s),t.children[0].negative=s,Ra(t.children[0],r,n,o,a)}var u="and"==l&&2==t.children.length&&"op-ge"==t.children[0].type&&"op-le"==t.children[1].type,c="or"==l&&2==t.children.length&&"op-lt"==t.children[0].type&&"op-gt"==t.children[1].type;if(u||c){var p=(0,x.A)(t.children[0].children,2),d=p[0],f=p[1],g=(0,x.A)(t.children[1].children,2),v=g[0],h=g[1];if(Ua(d,v,t,r,n,o,a)){f.val,h.val;var y={type:"op-between",children:[d,f,h],not:c};return y._groupField=null==a?void 0:a._groupField,e(y,r,n,o,a)}}var m=r.operators[l];"eq"==l&&"null"==t.children[1].type?m=["is_null"]:"ne"==l&&"null"==t.children[1].type?m=["is_not_null"]:"le"==l&&"string"==t.children[1].type&&""==t.children[1].val?m=["is_empty"]:"gt"==l&&"string"==t.children[1].type&&""==t.children[1].val?m=["is_not_empty"]:"between"==l&&(m=["between"]);var b=function(){var e,i=t.children.map((function(e){return Ra(e,r,n,o,t)}));return i.length>=2&&"!compare"==(null===(e=i)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.type)&&(i=i[0].children),i};if("and"==l||"or"==l){var O={};b().forEach((function(e){if(e){var t=Yn();e.id=t,null!=e.type?O[t]=e:o.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(e)))}})),i={type:"group",id:Yn(),children1:O,properties:{conjunction:r.conjunctions[l],not:t.not}}}else if(m){var _,S,w,A=b(),F=A[0],j=A.slice(1),E=null==F||null===(_=F.groupFieldValue)||void 0===_?void 0:_.value,k=null===(S=j)||void 0===S?void 0:S[0],C=m[0];if(m.length>1){var L,I,T=(null===(L=A[0])||void 0===L?void 0:L.valueType)||(null===(I=A[1])||void 0===I?void 0:I.valueType),P=null==F?void 0:F.value,R=m.map((function(e){return{op:e,widget:Uu(n,P,e)}}));if(Ao.warn("[spel] Spel operator ".concat(l," can be mapped to ").concat(m,"."),"widgets:",R,"vals:",A,"valueType=",T),"eq"==l||"ne"==l){var N=R.find((function(e){e.op;var t=e.widget;return t&&"field"!=t}));N&&(C=N.op)}}null!=F&&F.groupFieldValue&&(k&&k.groupFieldValue&&"field"==k.groupFieldValue.valueSrc&&k.groupFieldValue.value==E?(C="all",j=[]):"equal"==C&&"value"==k.valueSrc&&"number"==k.valueType&&0==k.value?(C="none",j=[]):"greater"==C&&"value"==k.valueSrc&&"number"==k.valueType&&0==k.value&&(C="some",j=[]));var D=n.operators[C],V=n.operators[null===(w=D)||void 0===w?void 0:w.reversedOp],z=t.not&&["between"].includes(C),M=!!V&&(!!n.settings.reverseOperatorsForNot||z);(t.not&&M||z)&&(C=D.reversedOp,D=n.operators[C],t.not=!t.not);var q=!!t.not;if(t.not=!1,F)if(F.groupFieldValue)"field"!=F.groupFieldValue.valueSrc&&o.errors.push("Expected group field ".concat(JSON.stringify(F))),i=$a(F,C,j,n,o);else{"field"!=F.valueSrc&&"func"!=F.valueSrc&&o.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(F)));var W=F.value;i=Ba(n,o,W,C,j,t)}q&&("group"!==i.type?i=Xa(i,n,!0):i.properties.not=!i.properties.not)}else a||(i=Ka(t,r,n,o));return i},Da=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=e.map((function(e){if("variable"==e.type||"property"==e.type||"indexer"==e.type&&"string"==e.itype)return e.val;var o,i;n=!0,r&&(null==t||null===(o=t.errors)||void 0===o||null===(i=o.push)||void 0===i||i.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(e))))}));return n?void 0:o},Va=function e(t,r,n,o){var i,a,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null!=t){var s=n.settings.fieldSeparator;if(t._groupField=null!==(i=t._groupField)&&void 0!==i?i:null==l?void 0:l._groupField,"variable"==t.type||"property"==t.type){var u=dp(n,t.val,t._groupField),c=Ap(n,u),p="variable"==t.type;return{valueSrc:"field",valueType:null==c?void 0:c.type,isVariable:p,value:u}}if("compound"==t.type){var d=Da(t.children,o);if(d){var f,g=dp(n,d.join(s),t._groupField),v=Ap(n,g),h="variable"==(null===(f=t.children)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.type);return{valueSrc:"field",valueType:null==v?void 0:v.type,isVariable:h,value:g}}}else{if(Ea[t.type]){var y=t.val,m=Ea[t.type];return t.negative&&(y=-y),{valueSrc:"value",valueType:m,value:y}}if("!new"==t.type&&ka[t.cls.at(-1)]){var b=t.args.map((function(i){return e(i,r,n,o,t)})),O=null==b?void 0:b[0],_=ka[t.cls.at(-1)];return ja(ja({},O),{},{valueType:_})}if("list"==t.type){var S,w=t.val.map((function(i){return e(i,r,n,o,t)}));return w.length&&(null===(S=w[0])||void 0===S||S.valueType),{valueSrc:"value",valueType:"multiselect",value:w.map((function(e){return null==e?void 0:e.value}))}}if("op-plus"===t.type&&"ternary"===(null==l?void 0:l.type)&&"case_value"===(null===(a=n.settings.caseValueField)||void 0===a?void 0:a.type))return Ha(t,r,n,o)}var A=Ma(t,r,n,o,l);if(void 0!==A)return A;o.errors.push("Can't convert arg of type ".concat(t.type))}},za=function e(t,r){var n,o=[],i="",a=t.type,l=t.methodName,s=(t.val,t.obj),u=t.args,c=t.isVar,p=t.cls,d=t.children,f=null==d?void 0:d[d.length-1],g=r[r.length-1];if("!func"===a){for(var v=s;v;){var h,y=e(ja(ja({},v),{},{obj:null}),[{}]),m=(0,x.A)(y,2),b=m[0],O=m[1];if("?"!==b){var _={s:g.s,params:(0,I.A)(g.params),objs:(0,I.A)(g.objs)};g.objs.unshift("?"),g.params.unshift(v),r.push(_),g=r[r.length-1]}g.objs.unshift(b),(h=g.params).unshift.apply(h,(0,I.A)(O)),v="!func"===v.type?v.obj:null}var S,w=wa(r);try{for(w.s();!(S=w.n()).done;){var A,F=S.value;o=[].concat((0,I.A)((null==F?void 0:F.params)||[]),(0,I.A)(u||[])),i="",null!=F&&null!==(A=F.objs)&&void 0!==A&&A.length&&(i+=F.objs.join(".")+"."),i+=(c?"#":"")+l,i+="("+(u||[]).map((function(e){return"?"})).join(", ")+")",F.s=i,F.params=o}}catch(e){w.e(e)}finally{w.f()}}else"!new"===a?(o=u||[],i="new ".concat(p.join("."),"(").concat(o.map((function(e){return"?"})).join(", "),")")):"!type"===a?i="T(".concat(p.join("."),")"):"compound"===a&&"property"===f.type&&(n=f.val,["length"].includes(n))?i=d.map((function(t){var r;if(t===f)return t.val;var n=e(ja(ja({},t),{},{obj:null}),[{}]),i=(0,x.A)(n,2),a=i[0],l=i[1];return(r=o).push.apply(r,(0,I.A)(l)),a})).join("."):(o=[t],i="?");return g&&(g.s=i,g.params=o),[i,o]},Ma=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=function(o){return Ra(o,t,r,n,e)},l=function(e){var t=[{s:"",params:[],objs:[]}];return za(e,t),t.map((function(e){return{s:e.s,params:e.params}})).reverse().filter((function(e){var t=e.s;return""!==t&&"?"!==t}))}(e),s=null==l||null===(o=l[0])||void 0===o?void 0:o.s;l.length&&Ao.debug("Signatures for ",e,":",s,l);var u=qa(e,t,r,n,i,l,a);if(void 0!==u)return u;var c,p,d,f=Wa(e,t,r,n,i,l,a);if(void 0!==f)return f;var g,v=wa(l);try{var h=function(){var e=g.value,n=e.s,o=e.params,i=t.funcs[n];if(i){c=i[0];var l=(p=gp(r,c)).spelFunc,s=o.map(a),u=(0,I.A)(l.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,x.A)(e,2);return t[0],t[1]}));return d=Object.fromEntries(u.map((function(e,t){return[e,s[t]]}))),1}};for(v.s();!(g=v.n()).done&&!h(););}catch(e){v.e(e)}finally{v.f()}if(!c){var y,m=wa(sp(r));try{for(m.s();!(y=m.n()).done;){var b=(0,x.A)(y.value,2),O=b[0],_=b[1];if(_.spelImport){var S=void 0;try{S=_.spelImport(e)}catch(e){}if(S)for(var w in p=gp(r,c=O),d={},S)d[w]=a(S[w])}}}catch(e){m.e(e)}finally{m.f()}}if(c){var A={};for(var F in p.args){var j,E=p.args[F],k=d[F];if(void 0===k)if(void 0===(k=null==E?void 0:E.defaultValue)){if(null==E||!E.isOptional)return void n.errors.push("No value for arg ".concat(F," of func ").concat(c))}else k={value:k,valueSrc:null!==(j=k)&&void 0!==j&&j.func?"func":"value",valueType:E.type};k&&(A[F]=k)}return{valueSrc:"func",value:{func:c,args:A},valueType:p.returnType}}e.methodName&&n.errors.push("Signature ".concat(s," - failed to convert"))},qa=function(e,t,r,n,o,i,a){var l,s,u,c=[];for(var p in r.widgets){var d=r.widgets[p].spelImportFuncs;if(d)for(var f=0;f<d.length;f++){var g=d[f];if(Ca(g)){var v={};if(_o(g,e,v)){for(var h in v)v[h]=a(v[h]);c.push({s:"widgets.".concat(p,".spelImportFuncs[").concat(f,"]"),w:p,argsObj:v})}}}}var y,m=wa(i);try{for(m.s();!(y=m.n()).done;){var b,O=y.value,_=O.s,S=O.params,w=wa(t.valueFuncs[_]||[]);try{var A=function(){var e=b.value,t=e.w,r=e.argsOrder,n=S.map(a),o=Object.fromEntries(r.map((function(e,t){return[e,n[t]]})));c.push({s:_,w:t,argsObj:o})};for(w.s();!(b=w.n()).done;)A()}catch(e){w.e(e)}finally{w.f()}}}catch(e){m.e(e)}finally{m.f()}for(var F=0,j=c;F<j.length;F++){var E=j[F],k=E.s,C=E.w,L=E.argsObj,I=r.widgets[C],T=I.spelImportValue,P=I.type;for(var R in u=C,s=k,l=[],L)["value"].includes(L[R].valueSrc)||l.push("".concat(R," has unsupported value src ").concat(L[R].valueSrc));var N=L.v.value;if(T&&!l.length){var D=T.call(r.ctx,L.v,I,L),V=(0,x.A)(D,2);N=V[0],(l=V[1])&&!Array.isArray(l)&&(l=[l])}if(!l.length)return{valueSrc:"value",valueType:P,value:N}}u&&l.length&&n.errors.push("Signature ".concat(s," - looks like convertable to ").concat(u,", but: ").concat(l.join("; ")))},Wa=function(e,t,r,n,o,i,a){var l,s,u,c,p=wa(i);try{for(p.s();!(c=p.n()).done;){var d,f=c.value,g=f.s,v=f.params,h=wa(t.opFuncs[g]||[]);try{var y,m=function(){var t,i=d.value,c=i.op,p=i.argsOrder,f=v.map(a);if(s=c,"!compare"===c){if(o.type.startsWith("op-")&&2==o.children.length&&"number"==o.children[1].type&&0===o.children[1].val)return{v:{type:"!compare",children:f}};l.push("Result of compareTo() should be compared to 0")}u=g,l=[];var h=r.operators[s],y=(h.spelOp,h.valueTypes),m=Object.fromEntries(p.map((function(e,t){return[e,f[t]]}))),b=m[0],O=Object.keys(m).filter((function(e){return parseInt(e)>0})).map((function(e){return m[e]})),_=null===(t=f.filter((function(e){return!!e})).find((function(e){return"value"===e.valueSrc})))||void 0===t?void 0:t.valueType;if(y&&_&&!y.includes(_)&&l.push("Op supports types ".concat(y,", but got ").concat(_)),!l.length)return{v:Ba(r,n,b,s,O,e)}};for(h.s();!(d=h.n()).done;)if(y=m())return y.v}catch(e){h.e(e)}finally{h.f()}}}catch(e){p.e(e)}finally{p.f()}s&&l.length&&n.errors.push("Signature ".concat(u," - looks like convertable to ").concat(s,", but: ").concat(l.join("; ")))},Ba=function(e,t,r,n,o,i){var a,l;if(!o.filter((function(e){return void 0===e})).length){var s=null!==(a=r)&&void 0!==a&&a.func?"func":"field";Ca(r)&&r.valueSrc&&(s=r.valueSrc,r=r.value);var u=Ap(e,r);if(u){var c=Ap(e,null==i?void 0:i._groupField),p="!group"==u.type,d=(p&&u.mode,"!group"==(null==c?void 0:c.type)),f=e.operators[n],g=e.operators[null===(l=f)||void 0===l?void 0:l.reversedOp],v=(null==i?void 0:i.not)&&["between"].includes(n),h=!!g&&(!!e.settings.reverseOperatorsForNot||v||!p&&d);((null==i?void 0:i.not)&&h||v)&&(n=f.reversedOp,f=e.operators[n],i.not=!i.not);var y=!(null==i||!i.not),m=Uu(e,r,n),b=e.widgets[m||u.mainWidget],O=o.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),_=O.length?O[0]:void 0,S={type:"rule",id:Yn(),properties:ja({field:r,fieldSrc:s,operator:n,value:o.map((function(e){return e.value})),valueSrc:o.map((function(e){return e.valueSrc})),valueType:o.map((function(e){return"value"==e.valueSrc&&((null==b?void 0:b.type)||(null==u?void 0:u.type))||e.valueType}))},_?{asyncListValues:_}:{})};return y&&(S=Xa(S,e,i.not)),S}t.errors.push("No config for field ".concat(r))}},$a=function(e,t,r,n,o){var i=e.groupFilter,a=e.groupFieldValue;if("field"!=a.valueSrc)throw"Bad groupFieldValue: ".concat(JSON.stringify(a));var l=a.value,s=Ba(n,o,l,t,r);if(s){var u,c=Ap(n,l),p=null==c?void 0:c.mode;return(u="group"===(null==i?void 0:i.type)?ja(ja({},i||{}),{},{type:"rule_group",properties:ja(ja(ja({},s.properties),(null==i?void 0:i.properties)||{}),{},{mode:p})}):ja(ja({},s||{}),{},i?{type:"rule_group",children1:[i],properties:ja(ja({},s.properties),{},{mode:p})}:{type:"rule_group",properties:ja(ja({},s.properties),{},{mode:p})})).id||(u.id=Yn()),u}},Ua=function(e,t,r,n,o,i){if(e.type==t.type){if("!aggr"==e.type){var a=[e.source,t.source].map((function(e){return Va(e,n,o,i,r)})),l=(0,x.A)(a,2),s=l[0],u=l[1];return s.value==u.value}var c=[e,t].map((function(e){return Va(e,n,o,i,r)})),p=(0,x.A)(c,2),d=p[0],f=p[1];return d.value==f.value}return!1},Ka=function(e,t,r,n){var o={},i=Ga(null,e,t,r,n);return i&&(o[i.id]=i),{type:"switch_group",id:Yn(),children1:o,properties:{}}},Ga=function(e,t,r,n,o){var i,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=Ja(n,o,r,t,a);return e?(i=Ra(e,r,n,o,a))&&i.type?("group"!=i.type&&(i=Xa(i,n)),i.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(i))),i=void 0):i={id:Yn(),type:"case_group",properties:{}},i&&(i.properties=ja(ja({},i.properties),l)),i},Ha=function(e,t,r,n){var o=[];return function i(a){a.map((function(a){if("op-plus"===a.type)i(a.children);else{var l=Va(a,t,r,n,e);l?o.push(l):n.errors.push("Can't convert ".concat(a.type," in concatenation"))}}))}(e.children),{valueSrc:"value",valueType:"case_value",value:o}},Ja=function(e,t,r,n){var o,i,a,l,s,u,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p={},d=Ap(e,"!case_value");"op-plus"===(null==n?void 0:n.type)&&"case_value"===(null===(o=e.settings.caseValueField)||void 0===o?void 0:o.type)?(l="case_value",a=Ha(n,r,e,t)):(l=null==d?void 0:d.mainWidget,s=e.widgets[l],(a=Va(n,r,e,t,c))&&"value"===a.valueSrc&&(a.valueType=(null===(u=s)||void 0===u?void 0:u.type)||(null==d?void 0:d.type)||a.valueType));var f=e.widgets[l];if("case_value"===l){var g=null==f?void 0:f.spelImportValue;if(g){var v,h=g.call(e.ctx,a),y=(0,x.A)(h,2),m=y[0];y[1].map((function(e){return t.errors.push(e)})),null!=m&&(p={value:[m],valueSrc:["value"],valueType:[null!==(v=null==f?void 0:f.type)&&void 0!==v?v:"case_value"],field:"!case_value"})}}else null!=a&&null!=(null===(i=a)||void 0===i?void 0:i.value)&&(p={value:[a.value],valueSrc:[a.valueSrc],valueType:[a.valueType],field:"!case_value"});return p},Xa=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:Yn(),children1:(0,L.A)({},e.id,e),properties:{conjunction:il(t),not:r||!1}}};function Ya(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ya(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ya(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Za=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.settings.defaultField,o=(r?el(e,r):n)||t&&Ep(e,r)||null;return null==o||"string"==typeof o||lo(o)||(o=pi(o)),o},el=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r)return null;var n=(null==e||null===(t=e.settings)||void 0===t?void 0:t.fieldSeparator)||".",o=Ap(e,r),i=null==o?void 0:o.defaultField;return i&&(i=[].concat((0,I.A)(mp(r)),[i]).join(n)),i},tl=function(e){var t;return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=e.settings.fieldSources)||void 0===t?void 0:t[0])||"field"},rl=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Ap(e,t),o=(null==n?void 0:n.operators)||[],i=e.settings.defaultOperator;i&&!o.includes(i)&&(i=null);var a=null==n?void 0:n.defaultOperator,l=null==n?void 0:n.ownDefaultOperator,s=r?Ru(e,t):null;return l||i||a||s},nl=function(e,t,r){var n=t?Fp(e,t,r):null;return n&&n.options?new Jn.Map(n.options&&n.options.defaults||{}):null},ol=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=null,u=null,c=null,p=e.settings.showErrorMessage;i?(c=null==i||null===(t=i.properties)||void 0===t?void 0:t.fieldSrc,s=null==i||null===(r=i.properties)||void 0===r?void 0:r.field,u=null==i||null===(n=i.properties)||void 0===n?void 0:n.operator):a?(c=(s=Za(e,l,o))?lo(s)?"func":"field":tl(e),u=rl(e,s,!0)):c=tl(e);var d=new Jn.Map({fieldSrc:c,field:s,operator:u,value:new Jn.List,valueSrc:new Jn.List,operatorOptions:nl(e,u,s)});if(p&&(d=d.set("valueError",new Jn.List)),s&&u){var f=Su(e,e,d,s,u,"operator",!1),g=f.newValue,v=f.newValueSrc,h=f.newValueType,y=f.newValueError,m=f.newFieldError;d=d.set("value",g).set("valueSrc",v).set("valueType",h),p&&(d=d.set("valueError",y).set("fieldError",m))}var b=Ap(e,s);if("!group"===(null==b?void 0:b.type)){var O=il(e,b);d=d.set("conjunction",O)}return d},il=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=(null===(t=n=Ap(e,n))||void 0===t?void 0:t.conjunctions)||Object.keys(e.conjunctions);return 1==o.length?o[0]:(null===(r=n)||void 0===r?void 0:r.defaultConjunction)||e.settings.defaultConjunction||e.settings.defaultGroupConjunction||o[0]},al=function(e){return il(e)},ll=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Jn.Map({conjunction:il(e,t),not:!1})},sl=function(e,t){return"group"==(null==t?void 0:t.type)?ll(e):ol(e,null,t)},ul=function(e,t){return(0,L.A)({},e,new Jn.Map({type:"rule",id:e,properties:ol(t)}))},cl=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Jn.Map({type:"group",id:Yn(),children1:new Jn.OrderedMap(t?Qa({},ul(Yn(),e)):{}),properties:ll(e)})},pl=function(e){return so(e)?e:dl([e])},dl=function(e){return so(e)?e:new Jn.List(e)},fl=function(){return new Jn.Map};function gl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return vl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function vl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hl(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ml=function(e,t){var r={errors:[],settings:{isForDisplay:arguments.length>2&&void 0!==arguments[2]&&arguments[2],isDebugMode:arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},n=Qc(t,void 0,!1),o=bl(e,n,r,null);return r.errors.length&&console.warn("Errors while exporting to string:",r.errors),o},bl=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return e.get("children1"),"group"===o||"rule_group"===o?Ol(e,t,r,n):"rule"===o?_l(e,t,r,n):void 0}},Ol=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=r.settings,l=a.isForDisplay,s=a.isDebugMode,u=e.get("type"),c=e.get("properties")||new lr,p=c.get("mode"),d=e.get("children1")||new xr,f="rule_group"===u,g=f&&"array"==p?c.get("field"):null,v="rule_group"===u?c.get("operator"):null,h=v?null!==(n=null===(o=t.operators[v])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1:void 0,y=f&&"array"===p&&h>=1,m=c.get("not"),b=d.map((function(e){return bl(e,t,r,g)})).filter((function(e){return void 0!==e}));if(y||b.size||s){var O=c.get("conjunction");O||(O=al(t));var _,S=t.conjunctions[O],w=b.size?S.formatConj.call(t.ctx,b,O,m,l):null;if(g){var A=_l(e,t,r,i,!0);if(A){var F,j=A.pop(),E=[w].concat((0,I.A)(A));_=(F=t.settings.formatAggr).call.apply(F,[t.ctx].concat((0,I.A)(E))),j&&(_=t.settings.formatReverse.call(t.ctx,_,null,null,null,null,l))}}else _=w;return s&&null==_&&(_="?"),_}},_l=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=r.settings,a=i.isForDisplay,l=i.isDebugMode,s=e.get("properties")||new lr,u=s.get("field"),c=s.get("fieldSrc"),p=s.get("operator"),d=s.get("operatorOptions");if(null!=u&&null!=p||l){var f=Ap(t,u)||{},g=Fp(t,p,u)||{},v=g.reversedOp,h=Fp(t,v,u)||{},y=!1,m=g.formatOp;if(!m&&v&&(m=h.formatOp)){y=!0;var b=[v,p];p=b[0],v=b[1];var O=[h,g];g=O[0],h=O[1]}if(l&&!p&&(p="?"),m||(m=function(e,t,r){var n,o=r.settings.isDebugMode,i=(null==t?void 0:t.labelForFormat)||e,a=oo(t);return 0==a?n=function(e,t,r,n,o,a,l,s){return"".concat(e," ").concat(i)}:1==a?n=function(e,t,r,n,a,l,s,u){return o&&"?"===t&&"?"===r?e&&"?"!==e?"".concat(e," ?"):"?":"".concat(e," ").concat(i," ").concat(r)}:2==a&&(n=function(e,t,r,n,o,a,l,s){var u,c,p=null==r||null===(u=r.first)||void 0===u?void 0:u.call(r),d=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(i," ").concat(p," AND ").concat(d)}),n}(p,g,r)),m){var _="func"===c?Al(t,r,u,n):wl(t,r,u,n);if(null!=_){var S=function(e,t,r,n,o){var i,a,l=r.settings,s=(l.isForDisplay,l.isDebugMode),u=t.get("field"),c=t.get("valueSrc"),p=t.get("valueType"),d=Ap(e,u)||{},f=n||t.get("operator"),g=Fp(e,f,u)||{},v=oo(g),h=t.get("value"),y=t.get("asyncListValues"),m=[],b=[];return null!=h&&!((a=h.map((function(t,n){var i=c?c.get(n):null,a=p?p.get(n):null,l=s?t:rc(t,i,e),v=Uu(e,u,f,i),h=jp(e,u,f,v,i,{forExport:!0}),O=Sl(e,r,l,i,a,h,d,f,g,o,y);return void 0!==O&&(m.push(i),b.push(a)),O}))).filter((function(e){return void 0===e})).size>0)&&a.size===v&&(i=1==v?a.first():a),s&&!i&&(i=v>1?new xr(Array.from({length:v}).map((function(e,t){var r,n;return null!==(r=null===(n=a)||void 0===n?void 0:n.get(t))&&void 0!==r?r:"?"}))):"?"),[i,m.length>1?m:m[0],b.length>1?b:b[0]]}(t,s,r,p,n),w=(0,x.A)(S,3),A=w[0],F=w[1],j=w[2];if(void 0!==A){var E=[_,p,A,F,j,no(g,eo),d,a,f,y];if(o)return E;var k,C=(k=m).call.apply(k,[t.ctx].concat(E));return y&&(C=t.settings.formatReverse.call(t.ctx,C,p,v,g,h,a)),C}}}}},Sl=function(e,t,r,n,o,i,a,l,s){var u,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,p=arguments.length>10?arguments[10]:void 0,d=t.settings,f=d.isForDisplay,g=d.isDebugMode;if(void 0===r)return g?"array"===(null==i?void 0:i.jsType)?[]:"?":void 0;if("field"==n)u=wl(e,t,r,c);else if("func"==n)u=Al(e,t,r,c);else if("function"==typeof(null==i?void 0:i.formatValue)){var v=i.formatValue,h=[r,yl(yl({},ko()(a,["fieldSettings","listValues"])),{},{asyncListValues:p}),no(i,Zn),f];if(l&&(h.push(l),h.push(s)),"field"==n){var y=Ap(e,r)||{};h.push(y)}u=v.call.apply(v,[e.ctx].concat(h))}else u=r;return u},wl=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=t.settings,a=i.isForDisplay,l=i.isDebugMode,s=e.settings,u=(s.fieldSeparator,s.fieldSeparatorDisplay),c=null;if(r){var p=Ap(e,r)||{},d=mp(r,e),f=Vu(r,e,o?n:null),g=f?f.join(u):null,v=p.label2||g;c=(0,e.settings.formatField)(Ku(r,e,t,o?n:null,{useTableName:!0}),d,v,p,e,a)}else l&&(c="?");return c},Al=function(e,t,r){var n,o,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=t.settings,s=l.isForDisplay,u=l.isDebugMode,c=null==r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func");if(!c)return u?"?()":void 0;var p=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),d=gp(e,c);if(d||u){var f,g=mp(c,e),v=g[g.length-1],h=s&&(null==d?void 0:d.label)||v,y={},m=[],b=[],O={},_=gl(d?Object.keys(d.args||{}):(null==p||null===(i=p.keySeq)||void 0===i?void 0:i.call(p).toArray())||[]);try{for(_.s();!(f=_.n()).done;){var S,w=f.value,A=null==d?void 0:d.args[w],F=Ap(e,A),j=A||{},E=j.defaultValue,k=j.isOptional,C=null!=E&&E.func?"func":"value",L=s&&(null==A?void 0:A.label)||w,I=p?p.get(w):void 0,T=I?I.get("value"):void 0,P=I?I.get("valueSrc"):void 0;"func"!==P&&null!==(S=T)&&void 0!==S&&S.toJS&&(T=T.toJS());var R=I?I.get("asyncListValues"):void 0,N=Sl(e,t,T,P,null==A?void 0:A.type,F,A,null,null,a,R);null!=T&&void 0===N&&"func"!=P&&t.errors.push("Can't format value of arg ".concat(w," for func ").concat(c));var D=void 0;if(void 0===N&&!k&&null!=E&&void 0===(D=Sl(e,t,E,C,null==A?void 0:A.type,F,A,null,null,a,R)))return void("func"!=C&&t.errors.push("Can't format default value of arg ".concat(w," for func ").concat(c)));var V=null!=N?N:D;if(void 0!==V){if(m.length){var z,M=gl(w);try{for(M.s();!(z=M.n()).done;){var q=(0,x.A)(z.value,2),W=q[0];q[1],y[W]=void 0}}catch(e){M.e(e)}finally{M.f()}m=[]}y[w]=V,O[L]=V}else k||b.push(w),m.push([w,L])}}catch(e){_.e(e)}finally{_.f()}if(!b.length||u){var B=null;if("function"==typeof(null==d?void 0:d.formatFunc)){var $=d.formatFunc,U=[y,s];B=$.call.apply($,[e.ctx].concat(U))}else{var K=Object.entries(s?O:y).map((function(e){var t=(0,x.A)(e,2),r=t[0],n=t[1];return s?"".concat(r,": ").concat(n):"".concat(n)})).join(", ");B="".concat(h,"(").concat(K,")")}return B}}else t.errors.push("Func ".concat(c," is not defined in config"))},Fl="EMPTY_GROUP",jl="EMPTY_RULE_GROUP",El="EMPTY_QUERY",kl="EMPTY_CASE",Cl="NO_CONFIG_FOR_FIELD",Ll="NO_CONFIG_FOR_OPERATOR",xl="NO_CONFIG_FOR_FUNCTION",Il="INVALID_VALUE",Tl="INVALID_FUNC_ARG_VALUE",Pl="UNSUPPORTED_FIELD_TYPE",Rl="UNSUPPORTED_OPERATOR_FOR_FIELD",Nl="INVALID_VALUE_SRC",Dl="INCOMPLETE_RULE",Vl="INCOMPLETE_LHS",zl="INCOMPLETE_RHS",Ml="BAD_MULTISELECT_VALUES",ql="BAD_SELECT_VALUE",Wl="INCORRECT_VALUE_TYPE",Bl="INCORRECT_VALUE_JS_TYPE",$l="VALUE_LENGTH_CONSTRAINT_FAIL",Ul="VALUE_MIN_CONSTRAINT_FAIL",Kl="VALUE_MAX_CONSTRAINT_FAIL",Gl="NO_CONFIG_FOR_FIELD_VALUE",Hl="CANT_COMPARE_FIELD_WITH_ITSELF",Jl="CANT_COMPARE_FIELD_WITH_FIELD",Xl="INCORRECT_FIELD_TYPE",Yl="UNSUPPORTED_FUNCTION_FOR_FIELD",Ql="REQUIRED_FUNCTION_ARG",Zl="INCORRECT_FUNCTION_RETURN_TYPE",es="INVALID_RANGE",ts="ITEM_POSITION",rs="ITEM_POSITION_ROOT",ns="ITEM_POSITION_WITH_INDEX_PATH",os="ITEM_POSITION_IN_CASE",is="range";const as=e=>"string"==typeof e,ls=()=>{let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r},ss=e=>null==e?"":""+e,us=/###/g,cs=e=>e&&e.indexOf("###")>-1?e.replace(us,"."):e,ps=e=>!e||as(e),ds=(e,t,r)=>{const n=as(t)?t.split("."):t;let o=0;for(;o<n.length-1;){if(ps(e))return{};const t=cs(n[o]);!e[t]&&r&&(e[t]=new r),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++o}return ps(e)?{}:{obj:e,k:cs(n[o])}},fs=(e,t,r)=>{const{obj:n,k:o}=ds(e,t,Object);if(void 0!==n||1===t.length)return void(n[o]=r);let i=t[t.length-1],a=t.slice(0,t.length-1),l=ds(e,a,Object);for(;void 0===l.obj&&a.length;)i=`${a[a.length-1]}.${i}`,a=a.slice(0,a.length-1),l=ds(e,a,Object),l&&l.obj&&void 0!==l.obj[`${l.k}.${i}`]&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=r},gs=(e,t)=>{const{obj:r,k:n}=ds(e,t);if(r)return r[n]},vs=(e,t,r)=>{for(const n in t)"__proto__"!==n&&"constructor"!==n&&(n in e?as(e[n])||e[n]instanceof String||as(t[n])||t[n]instanceof String?r&&(e[n]=t[n]):vs(e[n],t[n],r):e[n]=t[n]);return e},hs=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var ys={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const ms=e=>as(e)?e.replace(/[&<>"'\/]/g,(e=>ys[e])):e,bs=[" ",",","?","!",";"],Os=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}(20),_s=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t])return e[t];const n=t.split(r);let o=e;for(let e=0;e<n.length;){if(!o||"object"!=typeof o)return;let t,i="";for(let a=e;a<n.length;++a)if(a!==e&&(i+=r),i+=n[a],t=o[i],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<n.length-1)continue;e+=a-e+1;break}o=t}return o},Ss=e=>e&&e.replace("_","-"),ws={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class As{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||ws,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,n){return n&&!this.debug?null:(as(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new As(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new As(this.logger,e)}}var Fs=new As;class js{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const r=this.observers[e].get(t)||0;this.observers[e].set(t,r+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.observers[e]&&Array.from(this.observers[e].entries()).forEach((e=>{let[t,n]=e;for(let e=0;e<n;e++)t(...r)})),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach((t=>{let[n,o]=t;for(let t=0;t<o;t++)n.apply(n,[e,...r])}))}}class Es extends js{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,i=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],r&&(Array.isArray(r)?a.push(...r):as(r)&&o?a.push(...r.split(o)):a.push(r)));const l=gs(this.data,a);return!l&&!t&&!r&&e.indexOf(".")>-1&&(e=a[0],t=a[1],r=a.slice(2).join(".")),!l&&i&&as(r)?_s(this.data&&this.data[e]&&this.data[e][t],r,o):l}addResource(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const i=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let a=[e,t];r&&(a=a.concat(i?r.split(i):r)),e.indexOf(".")>-1&&(a=e.split("."),n=t,t=a[1]),this.addNamespaces(t),fs(this.data,a,n),o.silent||this.emit("added",e,t,r,n)}addResources(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const n in r)(as(r[n])||Array.isArray(r[n]))&&this.addResource(e,t,n,r[n],{silent:!0});n.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,n,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),n=r,r=t,t=a[1]),this.addNamespaces(t);let l=gs(this.data,a)||{};i.skipCopy||(r=JSON.parse(JSON.stringify(r))),n?vs(l,r,o):l={...l,...r},fs(this.data,a,l),i.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var ks={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,o){return e.forEach((e=>{this.processors[e]&&(t=this.processors[e].process(t,r,n,o))})),t}};const Cs={};class Ls extends js{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,n;super(),r=e,n=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((e=>{r[e]&&(n[e]=r[e])})),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=Fs.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;const r=this.resolve(e,t);return r&&void 0!==r.res}extractFromKey(e,t){let r=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===r&&(r=":");const n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const i=r&&e.indexOf(r)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,r)=>{t=t||"",r=r||"";const n=bs.filter((e=>t.indexOf(e)<0&&r.indexOf(e)<0));if(0===n.length)return!0;const o=Os.getRegExp(`(${n.map((e=>"?"===e?"\\?":e)).join("|")})`);let i=!o.test(e);if(!i){const t=e.indexOf(r);t>0&&!o.test(e.substring(0,t))&&(i=!0)}return i})(e,r,n));if(i&&!a){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:as(o)?[o]:o};const i=e.split(r);(r!==n||r===n&&this.options.ns.indexOf(i[0])>-1)&&(o=i.shift()),e=i.join(n)}return{key:e,namespaces:as(o)?[o]:o}}translate(e,t,r){if("object"!=typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof t&&(t={...t}),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const n=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,o=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:i,namespaces:a}=this.extractFromKey(e[e.length-1],t),l=a[a.length-1],s=t.lng||this.language,u=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(s&&"cimode"===s.toLowerCase()){if(u){const e=t.nsSeparator||this.options.nsSeparator;return n?{res:`${l}${e}${i}`,usedKey:i,exactUsedKey:i,usedLng:s,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:`${l}${e}${i}`}return n?{res:i,usedKey:i,exactUsedKey:i,usedLng:s,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:i}const c=this.resolve(e,t);let p=c&&c.res;const d=c&&c.usedKey||i,f=c&&c.exactUsedKey||i,g=Object.prototype.toString.apply(p),v=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,h=!this.i18nFormat||this.i18nFormat.handleAsObject,y=!as(p)&&"boolean"!=typeof p&&"number"!=typeof p;if(!(h&&p&&y&&["[object Number]","[object Function]","[object RegExp]"].indexOf(g)<0)||as(v)&&Array.isArray(p))if(h&&as(v)&&Array.isArray(p))p=p.join(v),p&&(p=this.extendTranslation(p,e,t,r));else{let n=!1,a=!1;const u=void 0!==t.count&&!as(t.count),d=Ls.hasDefaultValue(t),f=u?this.pluralResolver.getSuffix(s,t.count,t):"",g=t.ordinal&&u?this.pluralResolver.getSuffix(s,t.count,{ordinal:!1}):"",v=u&&!t.ordinal&&0===t.count&&this.pluralResolver.shouldUseIntlApi(),h=v&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${f}`]||t[`defaultValue${g}`]||t.defaultValue;!this.isValidLookup(p)&&d&&(n=!0,p=h),this.isValidLookup(p)||(a=!0,p=i);const y=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:p,m=d&&h!==p&&this.options.updateMissing;if(a||n||m){if(this.logger.log(m?"updateKey":"missingKey",s,l,i,m?h:p),o){const e=this.resolve(i,{...t,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const r=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&r&&r[0])for(let t=0;t<r.length;t++)e.push(r[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);const n=(e,r,n)=>{const o=d&&n!==p?n:y;this.options.missingKeyHandler?this.options.missingKeyHandler(e,l,r,o,m,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(e,l,r,o,m,t),this.emit("missingKey",e,l,r,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&u?e.forEach((e=>{const r=this.pluralResolver.getSuffixes(e,t);v&&t[`defaultValue${this.options.pluralSeparator}zero`]&&r.indexOf(`${this.options.pluralSeparator}zero`)<0&&r.push(`${this.options.pluralSeparator}zero`),r.forEach((r=>{n([e],i+r,t[`defaultValue${r}`]||h)}))})):n(e,i,h))}p=this.extendTranslation(p,e,t,c,r),a&&p===i&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${i}`),(a||n)&&this.options.parseMissingKeyHandler&&(p="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${i}`:i,n?p:void 0):this.options.parseMissingKeyHandler(p))}else{if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(d,p,{...t,ns:a}):`key '${i} (${this.language})' returned an object instead of string.`;return n?(c.res=e,c.usedParams=this.getUsedParamsDetails(t),c):e}if(o){const e=Array.isArray(p),r=e?[]:{},n=e?f:d;for(const e in p)if(Object.prototype.hasOwnProperty.call(p,e)){const i=`${n}${o}${e}`;r[e]=this.translate(i,{...t,joinArrays:!1,ns:a}),r[e]===i&&(r[e]=p[e])}p=r}}return n?(c.res=p,c.usedParams=this.getUsedParamsDetails(t),c):p}extendTranslation(e,t,r,n,o){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const a=as(e)&&(r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let l;if(a){const t=e.match(this.interpolator.nestingRegexp);l=t&&t.length}let s=r.replace&&!as(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),e=this.interpolator.interpolate(e,s,r.lng||this.language||n.usedLng,r),a){const t=e.match(this.interpolator.nestingRegexp);l<(t&&t.length)&&(r.nest=!1)}!r.lng&&"v1"!==this.options.compatibilityAPI&&n&&n.res&&(r.lng=this.language||n.usedLng),!1!==r.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return o&&o[0]===n[0]&&!r.context?(i.logger.warn(`It seems you are nesting recursively key: ${n[0]} in key: ${t[0]}`),null):i.translate(...n,t)}),r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,l=as(a)?[a]:a;return null!=e&&l&&l.length&&!1!==r.applyPostProcessor&&(e=ks.handle(l,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let t,r,n,o,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return as(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(t))return;const l=this.extractFromKey(e,a),s=l.key;r=s;let u=l.namespaces;this.options.fallbackNS&&(u=u.concat(this.options.fallbackNS));const c=void 0!==a.count&&!as(a.count),p=c&&!a.ordinal&&0===a.count&&this.pluralResolver.shouldUseIntlApi(),d=void 0!==a.context&&(as(a.context)||"number"==typeof a.context)&&""!==a.context,f=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);u.forEach((e=>{this.isValidLookup(t)||(i=e,!Cs[`${f[0]}-${e}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(i)&&(Cs[`${f[0]}-${e}`]=!0,this.logger.warn(`key "${r}" for languages "${f.join(", ")}" won't get resolved as namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((r=>{if(this.isValidLookup(t))return;o=r;const i=[s];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(i,s,r,e,a);else{let e;c&&(e=this.pluralResolver.getSuffix(r,a.count,a));const t=`${this.options.pluralSeparator}zero`,n=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(i.push(s+e),a.ordinal&&0===e.indexOf(n)&&i.push(s+e.replace(n,this.options.pluralSeparator)),p&&i.push(s+t)),d){const r=`${s}${this.options.contextSeparator}${a.context}`;i.push(r),c&&(i.push(r+e),a.ordinal&&0===e.indexOf(n)&&i.push(r+e.replace(n,this.options.pluralSeparator)),p&&i.push(r+t))}}let l;for(;l=i.pop();)this.isValidLookup(t)||(n=l,t=this.getResource(r,e,l,a))})))}))})),{res:t,usedKey:r,exactUsedKey:n,usedLng:o,usedNS:i}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,r,n):this.resourceStore.getResource(e,t,r,n)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!as(e.replace);let n=r?e.replace:e;if(r&&void 0!==e.count&&(n.count=e.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!r){n={...n};for(const e of t)delete n[e]}return n}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}const xs=e=>e.charAt(0).toUpperCase()+e.slice(1);class Is{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Fs.create("languageUtils")}getScriptPartFromCode(e){if(!(e=Ss(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=Ss(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(as(e)&&e.indexOf("-")>-1){if("undefined"!=typeof Intl&&void 0!==Intl.getCanonicalLocales)try{let t=Intl.getCanonicalLocales(e)[0];if(t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t)return t}catch(e){}const t=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map((e=>e.toLowerCase())):2===r.length?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=xs(r[1].toLowerCase()))):3===r.length&&(r[0]=r[0].toLowerCase(),2===r[1].length&&(r[1]=r[1].toUpperCase()),"sgn"!==r[0]&&2===r[2].length&&(r[2]=r[2].toUpperCase()),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=xs(r[1].toLowerCase())),t.indexOf(r[2].toLowerCase())>-1&&(r[2]=xs(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const r=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(r)||(t=r)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const r=this.getLanguagePartFromCode(e);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find((e=>e===r?e:e.indexOf("-")<0&&r.indexOf("-")<0?void 0:e.indexOf("-")>0&&r.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===r||0===e.indexOf(r)&&r.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),as(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),n=[],o=e=>{e&&(this.isSupportedCode(e)?n.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return as(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):as(e)&&o(this.formatLanguageCode(e)),r.forEach((e=>{n.indexOf(e)<0&&o(this.formatLanguageCode(e))})),n}}let Ts=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Ps={1:e=>Number(e>1),2:e=>Number(1!=e),3:e=>0,4:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2),5:e=>Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5),6:e=>Number(1==e?0:e>=2&&e<=4?1:2),7:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2),8:e=>Number(1==e?0:2==e?1:8!=e&&11!=e?2:3),9:e=>Number(e>=2),10:e=>Number(1==e?0:2==e?1:e<7?2:e<11?3:4),11:e=>Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3),12:e=>Number(e%10!=1||e%100==11),13:e=>Number(0!==e),14:e=>Number(1==e?0:2==e?1:3==e?2:3),15:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2),16:e=>Number(e%10==1&&e%100!=11?0:0!==e?1:2),17:e=>Number(1==e||e%10==1&&e%100!=11?0:1),18:e=>Number(0==e?0:1==e?1:2),19:e=>Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3),20:e=>Number(1==e?0:0==e||e%100>0&&e%100<20?1:2),21:e=>Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0),22:e=>Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)};const Rs=["v1","v2","v3"],Ns=["v4"],Ds={zero:0,one:1,two:2,few:3,many:4,other:5};class Vs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=Fs.create("pluralResolver"),this.options.compatibilityJSON&&!Ns.includes(this.options.compatibilityJSON)||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(()=>{const e={};return Ts.forEach((t=>{t.lngs.forEach((r=>{e[r]={numbers:t.nr,plurals:Ps[t.fc]}}))})),e})(),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi()){const r=Ss("dev"===e?"en":e),n=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:r,type:n});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let i;try{i=new Intl.PluralRules(r,{type:n})}catch(r){if(!e.match(/-|_/))return;const n=this.languageUtils.getLanguagePartFromCode(e);i=this.getRule(n,t)}return this.pluralRulesCache[o]=i,i}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this.getRule(e,t);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,r).map((e=>`${t}${e}`))}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this.getRule(e,t);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort(((e,t)=>Ds[e]-Ds[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):r.numbers.map((r=>this.getSuffix(e,r,t))):[]}getSuffix(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getRule(e,r);return n?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n.select(t)}`:this.getSuffixRetroCompatible(n,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let n=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===n?n="plural":1===n&&(n=""));const o=()=>this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString();return"v1"===this.options.compatibilityJSON?1===n?"":"number"==typeof n?`_plural_${n.toString()}`:o():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?o():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!Rs.includes(this.options.compatibilityJSON)}}const zs=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=((e,t,r)=>{const n=gs(e,r);return void 0!==n?n:gs(t,r)})(e,t,r);return!i&&o&&as(r)&&(i=_s(e,r,n),void 0===i&&(i=_s(t,r,n))),i},Ms=e=>e.replace(/\$/g,"$$$$");class qs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=Fs.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(e=>e),this.init(e)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:n,prefix:o,prefixEscaped:i,suffix:a,suffixEscaped:l,formatSeparator:s,unescapeSuffix:u,unescapePrefix:c,nestingPrefix:p,nestingPrefixEscaped:d,nestingSuffix:f,nestingSuffixEscaped:g,nestingOptionsSeparator:v,maxReplaces:h,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:ms,this.escapeValue=void 0===r||r,this.useRawValueToEscape=void 0!==n&&n,this.prefix=o?hs(o):i||"{{",this.suffix=a?hs(a):l||"}}",this.formatSeparator=s||",",this.unescapePrefix=u?"":c||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=p?hs(p):d||hs("$t("),this.nestingSuffix=f?hs(f):g||hs(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=h||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e&&e.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,n){let o,i,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},s=e=>{if(e.indexOf(this.formatSeparator)<0){const o=zs(t,l,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(o,void 0,r,{...n,...t,interpolationkey:e}):o}const o=e.split(this.formatSeparator),i=o.shift().trim(),a=o.join(this.formatSeparator).trim();return this.format(zs(t,l,i,this.options.keySeparator,this.options.ignoreJSONStructure),a,r,{...n,...t,interpolationkey:i})};this.resetRegExp();const u=n&&n.missingInterpolationHandler||this.options.missingInterpolationHandler,c=n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>Ms(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?Ms(this.escape(e)):Ms(e)}].forEach((t=>{for(a=0;o=t.regex.exec(e);){const r=o[1].trim();if(i=s(r),void 0===i)if("function"==typeof u){const t=u(e,o,n);i=as(t)?t:""}else if(n&&Object.prototype.hasOwnProperty.call(n,r))i="";else{if(c){i=o[0];continue}this.logger.warn(`missed to pass in variable ${r} for interpolating ${e}`),i=""}else as(i)||this.useRawValueToEscape||(i=ss(i));const l=t.safeValue(i);if(e=e.replace(o[0],l),c?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,a++,a>=this.maxReplaces)break}})),e}nest(e,t){let r,n,o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=(e,t)=>{const r=this.nestingOptionsSeparator;if(e.indexOf(r)<0)return e;const n=e.split(new RegExp(`${r}[ ]*{`));let i=`{${n[1]}`;e=n[0],i=this.interpolate(i,o);const a=i.match(/'/g),l=i.match(/"/g);(a&&a.length%2==0&&!l||l.length%2!=0)&&(i=i.replace(/'/g,'"'));try{o=JSON.parse(i),t&&(o={...t,...o})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${r}${i}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,e};for(;r=this.nestingRegexp.exec(e);){let l=[];o={...i},o=o.replace&&!as(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let s=!1;if(-1!==r[0].indexOf(this.formatSeparator)&&!/{.*}/.test(r[1])){const e=r[1].split(this.formatSeparator).map((e=>e.trim()));r[1]=e.shift(),l=e,s=!0}if(n=t(a.call(this,r[1].trim(),o),o),n&&r[0]===e&&!as(n))return n;as(n)||(n=ss(n)),n||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),n=""),s&&(n=l.reduce(((e,t)=>this.format(e,t,i.lng,{...i,interpolationkey:r[1].trim()})),n.trim())),e=e.replace(r[0],n),this.regexp.lastIndex=0}return e}}const Ws=e=>{const t={};return(r,n,o)=>{let i=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(i={...i,[o.interpolationkey]:void 0});const a=n+JSON.stringify(i);let l=t[a];return l||(l=e(Ss(n),o),t[a]=l),l(r)}};class Bs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=Fs.create("formatter"),this.options=e,this.formats={number:Ws(((e,t)=>{const r=new Intl.NumberFormat(e,{...t});return e=>r.format(e)})),currency:Ws(((e,t)=>{const r=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>r.format(e)})),datetime:Ws(((e,t)=>{const r=new Intl.DateTimeFormat(e,{...t});return e=>r.format(e)})),relativetime:Ws(((e,t)=>{const r=new Intl.RelativeTimeFormat(e,{...t});return e=>r.format(e,t.range||"day")})),list:Ws(((e,t)=>{const r=new Intl.ListFormat(e,{...t});return e=>r.format(e)}))},this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=Ws(t)}format(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find((e=>e.indexOf(")")>-1))){const e=o.findIndex((e=>e.indexOf(")")>-1));o[0]=[o[0],...o.splice(1,e)].join(this.formatSeparator)}return o.reduce(((e,t)=>{const{formatName:o,formatOptions:i}=(e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const o=n[1].substring(0,n[1].length-1);"currency"===t&&o.indexOf(":")<0?r.currency||(r.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?r.range||(r.range=o.trim()):o.split(";").forEach((e=>{if(e){const[t,...n]=e.split(":"),o=n.join(":").trim().replace(/^'+|'+$/g,""),i=t.trim();r[i]||(r[i]=o),"false"===o&&(r[i]=!1),"true"===o&&(r[i]=!0),isNaN(o)||(r[i]=parseInt(o,10))}}))}return{formatName:t,formatOptions:r}})(t);if(this.formats[o]){let t=e;try{const a=n&&n.formatParams&&n.formatParams[n.interpolationkey]||{},l=a.locale||a.lng||n.locale||n.lng||r;t=this.formats[o](e,l,{...i,...n,...a})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${o}`),e}),e)}}class $s extends js{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=n,this.logger=Fs.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,n.backend,n)}queueLoad(e,t,r,n){const o={},i={},a={},l={};return e.forEach((e=>{let n=!0;t.forEach((t=>{const a=`${e}|${t}`;!r.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===i[a]&&(i[a]=!0):(this.state[a]=1,n=!1,void 0===i[a]&&(i[a]=!0),void 0===o[a]&&(o[a]=!0),void 0===l[t]&&(l[t]=!0)))})),n||(a[e]=!0)})),(Object.keys(o).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(o),pending:Object.keys(i),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(e,t,r){const n=e.split("|"),o=n[0],i=n[1];t&&this.emit("failedLoading",o,i,t),!t&&r&&this.store.addResourceBundle(o,i,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const a={};this.queue.forEach((r=>{((e,t,r)=>{const{obj:n,k:o}=ds(e,t,Object);n[o]=n[o]||[],n[o].push(r)})(r.loaded,[o],i),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(r,e),t&&r.errors.push(t),0!==r.pendingCount||r.done||(Object.keys(r.loaded).forEach((e=>{a[e]||(a[e]={});const t=r.loaded[e];t.length&&t.forEach((t=>{void 0===a[e][t]&&(a[e][t]=!0)}))})),r.done=!0,r.errors.length?r.callback(r.errors):r.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((e=>!e.done))}read(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,i=arguments.length>5?arguments[5]:void 0;if(!e.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:r,tried:n,wait:o,callback:i});this.readingCalls++;const a=(a,l)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}a&&l&&n<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,r,n+1,2*o,i)}),o):i(a,l)},l=this.backend[r].bind(this.backend);if(2!==l.length)return l(e,t,a);try{const r=l(e,t);r&&"function"==typeof r.then?r.then((e=>a(null,e))).catch(a):a(null,r)}catch(e){a(e)}}prepareLoading(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();as(e)&&(e=this.languageUtils.toResolveHierarchy(e)),as(t)&&(t=[t]);const o=this.queueLoad(e,t,r,n);if(!o.toLoad.length)return o.pending.length||n(),null;o.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=e.split("|"),n=r[0],o=r[1];this.read(n,o,"read",void 0,void 0,((r,i)=>{r&&this.logger.warn(`${t}loading namespace ${o} for language ${n} failed`,r),!r&&i&&this.logger.log(`${t}loaded namespace ${o} for language ${n}`,i),this.loaded(e,r,i)}))}saveMissing(e,t,r,n,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=r&&""!==r){if(this.backend&&this.backend.create){const l={...i,isUpdate:o},s=this.backend.create.bind(this.backend);if(s.length<6)try{let o;o=5===s.length?s(e,t,r,n,l):s(e,t,r,n),o&&"function"==typeof o.then?o.then((e=>a(null,e))).catch(a):a(null,o)}catch(e){a(e)}else s(e,t,r,n,a,l)}e&&e[0]&&this.store.addResource(e[0],t,r,n)}}}const Us=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),as(e[1])&&(t.defaultValue=e[1]),as(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const r=e[3]||e[2];Object.keys(r).forEach((e=>{t[e]=r[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Ks=e=>(as(e.ns)&&(e.ns=[e.ns]),as(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),as(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),Gs=()=>{};class Hs extends js{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var r;if(super(),this.options=Ks(e),this.services={},this.logger=Fs,this.modules={external:[]},r=this,Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach((e=>{"function"==typeof r[e]&&(r[e]=r[e].bind(r))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof t&&(r=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&(as(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const n=Us();this.options={...n,...this.options,...Ks(t)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...n.interpolation,...this.options.interpolation}),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);const o=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?Fs.init(o(this.modules.logger),this.options):Fs.init(null,this.options),this.modules.formatter?t=this.modules.formatter:"undefined"!=typeof Intl&&(t=Bs);const r=new Is(this.options);this.store=new Es(this.options.resources,this.options);const i=this.services;i.logger=Fs,i.resourceStore=this.store,i.languageUtils=r,i.pluralResolver=new Vs(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!t||this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format||(i.formatter=o(t),i.formatter.init(i,this.options),this.options.interpolation.format=i.formatter.format.bind(i.formatter)),i.interpolator=new qs(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=new $s(o(this.modules.backend),i.resourceStore,i,this.options),i.backendConnector.on("*",(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.emit(t,...n)})),this.modules.languageDetector&&(i.languageDetector=o(this.modules.languageDetector),i.languageDetector.init&&i.languageDetector.init(i,this.options.detection,this.options)),this.modules.i18nFormat&&(i.i18nFormat=o(this.modules.i18nFormat),i.i18nFormat.init&&i.i18nFormat.init(this)),this.translator=new Ls(this.services,this.options),this.translator.on("*",(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.emit(t,...n)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,r||(r=Gs),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((t=>{this[t]=function(){return e.store[t](...arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((t=>{this[t]=function(){return e.store[t](...arguments),e}}));const i=ls(),a=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),i.resolve(t),r(e,t)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initImmediate?a():setTimeout(a,0),i}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gs;const r=as(e)?e:this.language;if("function"==typeof e&&(t=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return t();const e=[],n=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};r?n(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>n(e))),this.options.preload&&this.options.preload.forEach((e=>n(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),t(e)}))}else t(null)}reloadResources(e,t,r){const n=ls();return"function"==typeof e&&(r=e,e=void 0),"function"==typeof t&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=Gs),this.services.backendConnector.reload(e,t,(e=>{n.resolve(),r(e)})),n}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&ks.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(e,t){var r=this;this.isLanguageChangingTo=e;const n=ls();this.emit("languageChanging",e);const o=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},i=(e,i)=>{i?(o(i),this.translator.changeLanguage(i),this.isLanguageChangingTo=void 0,this.emit("languageChanged",i),this.logger.log("languageChanged",i)):this.isLanguageChangingTo=void 0,n.resolve((function(){return r.t(...arguments)})),t&&t(e,(function(){return r.t(...arguments)}))},a=t=>{e||t||!this.services.languageDetector||(t=[]);const r=as(t)?t:this.services.languageUtils.getBestMatchFromCodes(t);r&&(this.language||o(r),this.translator.language||this.translator.changeLanguage(r),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(r)),this.loadResources(r,(e=>{i(e,r)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),n}getFixedT(e,t,r){var n=this;const o=function(e,t){let i;if("object"!=typeof t){for(var a=arguments.length,l=new Array(a>2?a-2:0),s=2;s<a;s++)l[s-2]=arguments[s];i=n.options.overloadTranslationOptionHandler([e,t].concat(l))}else i={...t};i.lng=i.lng||o.lng,i.lngs=i.lngs||o.lngs,i.ns=i.ns||o.ns,""!==i.keyPrefix&&(i.keyPrefix=i.keyPrefix||r||o.keyPrefix);const u=n.options.keySeparator||".";let c;return c=i.keyPrefix&&Array.isArray(e)?e.map((e=>`${i.keyPrefix}${u}${e}`)):i.keyPrefix?`${i.keyPrefix}${u}${e}`:e,n.t(c,i)};return as(e)?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=r,o}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],n=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;const i=(e,t)=>{const r=this.services.backendConnector.state[`${e}|${t}`];return-1===r||0===r||2===r};if(t.precheck){const e=t.precheck(this,i);if(void 0!==e)return e}return!(!this.hasResourceBundle(r,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!i(r,e)||n&&!i(o,e)))}loadNamespaces(e,t){const r=ls();return this.options.ns?(as(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=ls();as(e)&&(e=[e]);const n=this.options.preload||[],o=e.filter((e=>n.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return o.length?(this.options.preload=n.concat(o),this.loadResources((e=>{r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services&&this.services.languageUtils||new Is(Us());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new Hs(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gs;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const n={...this.options,...e,isClone:!0},o=new Hs(n);return void 0===e.debug&&void 0===e.prefix||(o.logger=o.logger.clone(e)),["store","services","language"].forEach((e=>{o[e]=this[e]})),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},r&&(o.store=new Es(this.store.data,n),o.services.resourceStore=o.store),o.translator=new Ls(o.services,n),o.translator.on("*",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o.emit(e,...r)})),o.init(n,t),o.translator.options=n,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Js=Hs.createInstance();Js.createInstance=Hs.createInstance,Js.createInstance,Js.dir,Js.init,Js.loadResources,Js.reloadResources,Js.use,Js.changeLanguage,Js.getFixedT,Js.t,Js.exists,Js.setDefaultNamespace,Js.hasLoadedNamespace,Js.loadNamespaces,Js.loadLanguages;var Xs,Ys=(Xs={},(0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)(Xs,Fl,"Empty group"),jl,"No conditions for group field {{field}}"),El,"Empty query"),kl,"Empty case"),Cl,"No config for field {{field}}"),"FIXED_OPERATOR","Fixed operator {{from}} to {{to}} for field {{field}}"),Ll,"No config for operator {{operator}}"),xl,"No config for function {{funcKey}}"),Il,"Invalid value"),Tl,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)(Xs,Pl,"Type of field {{field}} is not supported"),Rl,"Operator {{operator}} is not supported for field {{field}}"),Dl,"Incomplete rule"),Vl,"Incomplete LHS"),zl,"Incomplete RHS"),Nl,"Invalid value src {{valueSrcs, list}}"),Ml+"_one","Value {{badValues, list}} is not in the list of allowed values"),Ml+"_other","Values {{badValues, list}} are not in the list of allowed values"),ql,"Value {{value}} is not in the list of allowed values"),Wl,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)(Xs,Bl,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),$l,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),Ul,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),Ul+"_"+is,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Kl,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),Kl+"_"+is,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Gl,"No config for field {{field}}"),Hl,"Can't compare field {{field}} with itself"),Jl,"Can't compare field {{leftField}} with {{rightField}}"),Xl,"Field {{field}} is of type {{type}}, but expected {{expected}}"),(0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)(Xs,Yl,"Unsupported function {{funcKey}} for field {{field}}"),Ql,"Value of arg {{argName}} for func {{funcName}} is required"),Zl,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),es,"Invalid range"),rs,"Root"),ts+"__rule","Leaf #{{globalLeafNo}}"),ts+"__group","Group #{{globalGroupNo}}"),ts+"__rule_group","Rule-group #{{globalNoByType}}"),ts+"__case_group","Case #{{globalNoByType}}"),ts+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),(0,L.A)((0,L.A)((0,L.A)((0,L.A)((0,L.A)(Xs,ts+"__group__deleted","Deleted group #{{globalGroupNo}}"),ts+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),ts+"__case_group__deleted","Deleted case #{{globalNoByType}}"),os,"{{str}} in case #{{caseNo}}"),ns,"{{str}} (index path: {{indexPath, list}})")),Qs="raqbvalidation",Zs="".concat(Qs,":"),eu=Js.createInstance();eu.init({fallbackLng:"en"}),eu.addResources("en",Qs,Ys);var tu=function e(t,r){return null!=t&&t.str?t.str:null!=t&&t.key?e(t.key,t.args):null===r?t:eu.t(t.includes(":")?t:Zs+t,r)};const ru=eu;function nu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ou(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nu(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var iu=function(e){return"object"===(0,T.A)(e)&&null!==e&&Array.isArray(e)?"array":(0,T.A)(e)},au=function(e,t){return 0===lu(e,t).length},lu=function(e,t){var r=t.settings.showErrorMessage,n=[];return e&&function e(t,o,i){var a,l,s=t.get("id"),u=t.get("children1"),c=t.getIn(["properties","valueError"]),p=t.getIn(["properties","fieldError"]),d=t.getIn(["properties","field"]),f=null!==(a=null==d||null===(l=d.get)||void 0===l?void 0:l.call(d,"func"))&&void 0!==a?a:d;((null==c?void 0:c.size)>0&&c.filter((function(e){return null!=e})).size>0||!!p)&&r&&n.push(f),u&&u.map((function(t,r){t&&e(t,o.concat(s),i+1)}))}(e,[],0),Array.from(new Set(n))},su=function(e,t){var r=Qc(t,void 0,!0),n={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=du(e,null,r,r,n),i=o.fixedTree,a=o.allErrors;return o.isSanitized&&a.length&&console.warn("Tree check errors: ",a),i},uu=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Qc(t,void 0,!0),o=ou(ou({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1});return du(e,null,n,n,o).allErrors},cu=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Qc(t,void 0,!0),o=ou({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),i=du(e,null,n,n,o);return{fixedTree:i.fixedTree,fixedErrors:i.fixedErrors,nonFixedErrors:i.nonFixedErrors,allErrors:i.allErrors}},pu=function(e,t,r,n,o,i,a){void 0===o&&(o=r.settings.removeEmptyGroupsOnLoad),void 0===i&&(i=r.settings.removeEmptyRulesOnLoad),void 0===a&&(a=r.settings.removeIncompleteRulesOnLoad);var l=du(e,t,r,n,{removeEmptyGroups:o,removeEmptyRules:i,removeIncompleteRules:a,forceFix:!1}),s=l.fixedTree,u=(l.allErrors,l.fixedErrors);return l.nonFixedErrors,l.isSanitized&&u.length&&console.warn("Fixed tree errors: ",u),Yo(s)},du=function(e,t,r,n,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var i,a,l=o||{},s=l.removeEmptyGroups,u=l.removeEmptyRules,c=l.removeIncompleteRules,p=l.forceFix,d=l.translateErrors,f=void 0===d||d,g=l.includeStringifiedItems,v=void 0===g||g,h=l.stringifyFixedItems,y=void 0!==h&&h,m=l.stringifyItemsUserFriendly,b=void 0===m||m,O=l.includeItemsPositions,_=void 0===O||O,S={errors:{}},w=vu(e,[],null,S,{config:r,oldConfig:n,removeEmptyGroups:s,removeEmptyRules:u,removeIncompleteRules:c,forceFix:p}),A=S.sanitized,F=[];for(var j in _&&(i=Zo(w,r).items),S.errors){var E=S.errors[j],k=E.path,C=E.errors;f&&(C=C.map((function(e){return ou(ou({},e),{},{str:tu(e)})})));var L={path:k,errors:C};if(v){var x=Ho(y?w:e,k);if(1!==k.length&&"group"!==x.get("type")){var I=ml(x,r,b,!0);L.itemStr=I}}if(_){var T=i[j],P=!T;if(P&&(a||(a=Zo(e,r).items),T=a[j]),T){var R=ou(ou({},T.position),{},{index:T.index,type:T.type,isDeleted:P});L.itemPosition=R;var N=T.index?ts+"__"+T.type+(P?"__deleted":""):rs,D=ou({},R);if(b){for(var V,z=0,M=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];z<M.length;z++){var q=M[z];null!=D[q]&&(D[q]=D[q]+1)}D.indexPath=null===(V=R.indexPath)||void 0===V?void 0:V.map((function(e){return e+1}))}L.itemPositionStr=tu(N,D),T.index&&(T.caseId&&"case_group"!==T.type&&(L.itemPositionStr=tu(os,ou(ou({},D),{},{str:L.itemPositionStr}))),"case_group"!==T.type&&(L.itemPositionStr=tu(ns,ou(ou({},D),{},{str:L.itemPositionStr}))))}}F.push(L)}for(var W=[],B=[],$=0,U=F;$<U.length;$++){var K=U[$],G=K.errors.filter((function(e){return!!e.fixed})),H=K.errors.filter((function(e){return!e.fixed&&"EMPTY_QUERY"!==e.key}));G.length&&W.push(ou(ou({},K),{},{errors:G})),H.length&&B.push(ou(ou({},K),{},{errors:H}))}return{fixedTree:w,allErrors:F,fixedErrors:W,nonFixedErrors:B,isSanitized:A}};function fu(e,t,r,n){var o=t.get("id");e.errors[o]||(e.errors[o]={path:[].concat((0,I.A)(r),[o]),errors:[]}),e.errors[o].errors.push(n)}function gu(e,t){var r=t.get("id");e.errors[r]&&e.errors[r].errors.map((function(e){e.fixed=!0}))}function vu(e,t,r,n,o){var i=null==e?void 0:e.get("type");return"group"===i||"rule_group"===i||"case_group"==i||"switch_group"==i?function(e,t,r,n,o){var i,a,l,s,u,c,p=o.removeEmptyGroups,d=o.removeIncompleteRules,f=(o.forceFix,o.config),g=(f.settings.showErrorMessage,e.get("id")),v=e.get("children1"),h=!t.length,y=v,m=e.get("type"),b=e.get("properties"),O=null==b?void 0:b.get("field"),_=null==b?void 0:b.get("mode"),S=null==b||null===(i=b.get)||void 0===i?void 0:i.call(b,"operator"),w="rule_group"===m&&"array"===_,A="case_group"===m,F=A&&null==v,j=S?null!==(a=null===(l=f.operators[S])||void 0===l?void 0:l.cardinality)&&void 0!==a?a:1:void 0,E=A?!F:w?0==j:p,k=w||A;!g&&r&&(g=r,e=e.set("id",g),n.sanitized=!0),k&&(e=hu(e,t,r,n,o));var C={errors:{}},L=null===(u=v=null===(s=v)||void 0===s?void 0:s.map((function(e,r){return vu(e,t.concat(g),r,C,o)})))||void 0===u?void 0:u.filter((function(e){return null!=e}));p&&(v=L);var x=C.sanitized||(null==y?void 0:y.size)!=(null===(c=v)||void 0===c?void 0:c.size),I=p&&!h;return w&&O&&(I=d),!(null!=L&&L.size)&&E&&(fu(n,e,t,{key:h?El:A?kl:w?jl:Fl,args:{field:O},fixed:I}),I&&(gu(n,e),e=void 0)),x&&(n.sanitized=!0),x&&e&&(e=e.set("children1",v)),n.errors=ou(ou({},n.errors),(null==C?void 0:C.errors)||{}),e}(e,t,r,n,o):"rule"===i?hu(e,t,r,n,o):e}function hu(e,t,r,n,o){var i=o.removeIncompleteRules,a=o.removeEmptyRules,l=o.forceFix,s=o.config,u=o.oldConfig,c=s.settings.showErrorMessage,p=!c||l,d=e.get("id"),f="case_group"===e.get("type"),g=e.get("properties");if(!g){if(!f)return void fu(n,e,t,{key:Dl,args:{},fixed:i||a});g=new Jn.Map}var v=g.get("field")||null;f&&(v="!case_value");var h=g.get("fieldSrc")||null,y=g.get("operator")||null,m=g.get("operatorOptions"),b=g.get("valueSrc"),O=g.get("value"),_=g.get("valueError"),S=g.get("fieldError"),w=function(){var e,t;return{field:(null===(e=v)||void 0===e||null===(t=e.toJS)||void 0===t?void 0:t.call(e))||v,fieldSrc:h,operator:y,operatorOptions:m?m.toJS():{},valueSrc:b?b.toJS():null,value:O?O.toJS():null,valueError:_?_.toJS():null,fieldError:S||null}},A=w();!d&&r&&(d=r,e=e.set("id",d),n.sanitized=!0);var F=v?Ap(s,v):null;v&&!F&&(fu(n,e,t,{key:Cl,args:{field:v},side:"lhs",fixed:i||a}),v=null),null!=v||f||(g=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce((function(e,t){return e.delete(t)}),g),y=null),h||!v||f||(h=wp(v),g=g.set("fieldSrc",h)),"range_between"!==y&&"range_not_between"!==y||(y="range_between"===y?"between":"not_between",g=g.set("operator",y));var j=y?Fp(s,y,v):null;y&&!j&&(fu(n,e,t,{key:Ll,args:{operator:y},side:"op",fixed:i||a}),y=null);var E=v?Pu(s,v):[];v&&!f&&(null!=E&&E.length?y&&-1==E.indexOf(y)&&("is_empty"===y||"is_not_empty"===y?(y="is_empty"===y?"is_null":"is_not_null",g=g.set("operator",y)):(fu(n,e,t,{key:Rl,args:{operator:y,field:v},side:"lhs",fixed:i||a}),y=null)):(fu(n,e,t,{key:Pl,args:{field:v},side:"lhs",fixed:i||a}),y=null)),null!=y||f||(g=["operatorOptions","valueSrc","value","valueError"].reduce((function(e,t){return e.delete(t)}),g)),m=g.get("operatorOptions"),!y||m&&!j.options?(m=null,g=g.delete("operatorOptions")):y&&!m&&j.options&&(m=nl(s,y,v),g=g.set("operatorOptions",m)),b=g.get("valueSrc"),O=g.get("value");var k=Su(s,u,g,v,y,null,p,!0),C=k.newValue,L=k.newValueSrc,x=k.newValueError,I=k.validationErrors,T=k.newFieldError,P=k.fixedField;O=C,b=L,_=x,S=T,v=P,g=(g=(g=g.set("field",v)).set("value",O)).set("valueSrc",b),g=c?g.set("valueError",_).set("fieldError",S):g.delete("valueError").delete("fieldError");var R=w(),N=!io(A,R),D=ec(g.toObject(),s),V=f?D.parts.value:D.score>=3;if(N&&(n.sanitized=!0,e=e.set("properties",g)),null==I||I.map((function(r){return fu(n,e,t,r)})),!V)if(f);else{var z=D.score?i:a,M={key:Dl,args:{}};if(D.parts.field){if(!D.parts.value){var q,W,B,$;M.key=zl,M.side="rhs",null!==(q=R.valueSrc)&&void 0!==q&&q[0]&&(null===(W=R.valueSrc)||void 0===W?void 0:W[0])!=(null===(B=A.valueSrc)||void 0===B?void 0:B[0])&&null!=(null===($=R.value)||void 0===$?void 0:$[0])&&(M.key=Nl,M.args={valueSrcs:R.valueSrc})}}else M.key=Vl,M.side="lhs";M.fixed=z,fu(n,e,t,M),z&&(gu(n,e),e=void 0)}return e}var yu=function(e,t,r,n,o,i,a,l){var s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=arguments.length>9&&void 0!==arguments[9]&&arguments[9],c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=[],d=o;if(null!=o){var f,g,v,h;if("field"===a){var y=bu(t,r,o,a,i,l,e,n,s,u),m=(0,x.A)(y,2);d=m[0],p=m[1]}else if("func"===a){var b=Ou(t,r,o,a,i,l,e,n,s,u,c),O=(0,x.A)(b,2);d=O[0],p=O[1]}else if("value"===a||!a){var _=mu(r,o,a,i,l,e,n,s,u),S=(0,x.A)(_,2);d=S[0],p=S[1]}var w=!(null!==(f=p)&&void 0!==f&&f.find((function(e){return!e.fixed})));if(r&&!["field","func"].includes(a)&&(null===(g=p)||void 0===g||!g.length||w)){var A=Uu(e,r,n,a),F=n?Fp(e,n,r):null,j=jp(e,r,n,A,a,{forExport:!0}),E="field"===a?Ap(e,o):null,k=j,C=j.validateValue;if("function"==typeof C){var L=[d,k,n,F];"field"===a&&L.push(E);var I,P,R=C.call.apply(C,[e.ctx].concat(L));"object"!==(0,T.A)(R)||null===R||Array.isArray(R)?"boolean"==typeof R?0==R&&p.push({key:Il,args:{}}):"string"==typeof R&&p.push({key:R,args:null}):(P=null!==(I=R.error)&&void 0!==I&&I.key?ou({},R.error):{key:R.error,args:null},void 0!==R.fixedValue&&s&&(P.fixed=!0,P.fixedFrom=d,P.fixedTo=R.fixedValue,d=R.fixedValue),p.push(P))}}if(w=!(null!==(v=p)&&void 0!==v&&v.find((function(e){return!e.fixed}))),null!==(h=p)&&void 0!==h&&h.length&&!w&&s){var N=Ap(e,r),D=null==N?void 0:N.fieldSettings,V=null==D?void 0:D.defaultValue;if(void 0!==V){var z=p[p.length-1];z.fixed=!0,z.fixedFrom=d,z.fixedTo=V,d=V,p.map((function(e){e.fixed=!0}))}}}return[d,p]},mu=function(e,t,r,n,o,i){var a,l,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=[],p=t;if(e){var d=Ap(i,e),f=Uu(i,e,s,r),g=i.widgets[f],v=null==g?void 0:g.type,h=null==g?void 0:g.jsType,y=null==d?void 0:d.fieldSettings,m=(null==y?void 0:y.treeValues)||(null==y?void 0:y.listValues),b=!(null==y||!y.asyncFetch),O=m||b;if(n&&v&&n!=v)return c.push({key:Wl,args:{wType:v,valueType:n}}),[t,c];if(h&&(l=h,iu(a=t)!==l&&("number"!==l||isNaN(a)))&&!O)return c.push({key:Bl,args:{jsType:h,valueTypeof:iu(t)}}),[t,c];if(y){var _=o||m;if(_&&!y.allowCustomValues&&"case_value"!==f){var S=function(e,t,r,n,o){var i=Jn.List.isList(e)?e.toJS():e instanceof Array?(0,I.A)(e):void 0,a=e,l=[];if(i){var s=i.reduce((function(e,r){var n=(0,x.A)(e,2),o=n[0],i=n[1],a=Mo(t,r);return null==a?[o,[].concat((0,I.A)(i),[r])]:[[].concat((0,I.A)(o),[a.value]),i]}),[[],[]]),u=(0,x.A)(s,2),c=u[0],p=u[1],d=p.length>0;if(a=(r=r||!0===o)&&d?c:e,p.length){var f=r&&d;l.push({key:Ml,args:{badValues:p,count:p.length},fixed:f,fixedFrom:f?i:void 0,fixedTo:f?a:void 0})}return[a,l]}var g=Mo(t,e);return null==g?(a=r?null:e,l.push({key:ql,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?a:void 0})):a=g.value,[a,l]}(t,_,u,0,i.settings.removeInvalidMultiSelectValuesOnLoad),w=(0,x.A)(S,2);p=w[0],c=w[1]}y.maxLength>0&&null!=t&&String(t).length>y.maxLength&&(p=u?String(t).substring(0,y.maxLength):t,c.push({key:$l,args:{value:t,length:String(t).length,fieldSettings:y},fixed:u,fixedFrom:u?t:void 0,fixedTo:u?p:void 0}));var A=null!=y.min&&null!=y.max?is:void 0;null!=y.min&&t<y.min&&(p=u?y.min:t,c.push({key:Ul,args:{value:t,fieldSettings:y,context:A},fixed:u,fixedFrom:u?t:void 0,fixedTo:u?p:void 0})),null!=y.max&&t>y.max&&(p=u?y.max:t,c.push({key:Kl,args:{value:t,fieldSettings:y,context:A},fixed:u,fixedFrom:u?t:void 0,fixedTo:u?p:void 0}))}}return[p,c]},bu=function(e,t,r,n,o,i,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,s=[],u=a.settings,c=u.fieldSeparator,p=u.canCompareFieldWithField,d="object"==(0,T.A)(t)&&(null==t?void 0:t._isFuncArg),f=Array.isArray(e)?e.join(c):e,g=Ap(a,e),v=Array.isArray(r)?r.join(c):r,h=Ap(a,r);return h?e&&v===f&&!d?(s.push({key:Hl,args:{field:f}}),[r,s]):o&&o!=h.type?(s.push({key:Xl,args:{field:v,type:h.type,expected:o}}),[r,s]):e&&!d&&p&&!p(f,g,v,h,l)?(s.push({key:Jl,args:{leftField:f,rightField:v}}),[r,s]):[r]:(s.push({key:Gl,args:{field:v}}),[r,s])},Ou=function(e,t,r,n,o,i,a){var l,s,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=r,g=[];if(!r)return[r];var v=null===(l=r.get)||void 0===l?void 0:l.call(r,"func");if(!v)return[r];var h=Ap(a,t);if(null!=h&&h.funcs&&!h.funcs.includes(v))return g.push({key:Yl,args:{funcKey:v,field:t}}),[r,g];var y=gp(a,v);if(!y)return g.push({key:xl,args:{funcKey:v}}),[r,g];var m=null!==(s=y.label)&&void 0!==s?s:v;if(o&&y.returnType!=o)return g.push({key:Zl,args:{funcKey:v,funcName:m,returnType:y.returnType,valueType:o}}),[r,g];for(var b in c=c||d,y.args){var O,_=y.args[b],S=f.get("args"),w=S?S.get(b):void 0,A=Ap(a,_),F=null!==(O=null==A?void 0:A.label)&&void 0!==O?O:b,j=w?w.get("value"):void 0,E=w?w.get("valueSrc"):void 0;if(void 0!==j){var k=yu(a,e,A,u,j,_.type,E,i,c,p,d),C=(0,x.A)(k,2),L=C[0],I=C[1],T=!(null!=I&&I.length),P=c&&L!==j,R=c&&!T&&!P&&(p||d);if(P&&(f=f.setIn(["args",b,"value"],L)),R&&(f=f.deleteIn(["args",b]),f=Eu(a,f,y,b)),!T){var N,D,V=null!==(N=null!==(D=I.find((function(e){return!e.fixed&&!e.ignore})))&&void 0!==D?D:I.find((function(e){return!e.fixed})))&&void 0!==N?N:I[0],z=P||R,M=0===I.filter((function(e){return!e.ignore})).length;if(V){var q=tu(V);g.push({key:Tl,args:{funcKey:v,funcName:m,argKey:b,argName:F,argValidationError:q,argErrors:I},ignore:M,fixed:z,fixedFrom:z?j:void 0,fixedTo:z?P?L:_.defaultValue:void 0})}}}else if(!_.isOptional&&(p||d)){var W=c&&void 0!==_.defaultValue&&(p||d);p&&g.push({key:Ql,args:{funcKey:v,funcName:m,argKey:b,argName:F},fixed:W,fixedTo:W?_.defaultValue:void 0,ignore:!W}),W&&(f=f.deleteIn(["args",b]),f=Eu(a,f,y,b))}}return[f,g]},_u=function(e,t,r,n,o){var i,a=Fp(e,r,t),l=r?oo(a):null,s=o.toJS?o.toJS():o,u=n.toJS?n.toJS():n,c=s.filter((function(e){return"value"==e||null==e})).length==l;if(null!=a&&a.validateValues&&c){var p=s[0],d=Uu(e,t,r,p),f=jp(e,t,r,d,p),g=null!=f&&f.toJS?u.map((function(t){var r=f.toJS.call(e.ctx,t,f);return r instanceof Date&&(r=r.getTime()),r})):u,v=a.validateValues(g);"boolean"==typeof v&&0==v&&(i={key:es,args:{jsValues:g,values:u}})}return i},Su=function(e){var t,r,n,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],p=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d=arguments.length>8&&void 0!==arguments[8]&&arguments[8];i||(i=e);var f=e.settings,g=f.keepInputOnChangeFieldSrc,v=f.convertableWidgets,h=f.clearValueOnChangeField,y=f.clearValueOnChangeOp,m="!case_value"==l,b=a.get("field");!b&&m&&(b=l);var O,_=a.get("fieldType"),S=a.get("fieldSrc"),w=a.get("operator"),A=a.get("value"),F=a.get("valueSrc",new Jn.List),j=a.get("valueType",new Jn.List),E=a.get("valueError",new Jn.List),k=a.get("asyncListValues"),C=m,L=Fp(i,w),I=Fp(e,s,l),T=m?1:w?oo(L):null,P=m?1:s?oo(I):null,R=Ap(i,b),N=Ap(e,l),D=!b&&_&&g,V=(null==R?void 0:R.type)||_,z=(null==N?void 0:N.type)||!l&&D&&V,M=null==R?void 0:R.listValuesType,q=null==N?void 0:N.listValuesType,W=(null===(t=b)||void 0===t||null===(r=t.get)||void 0===r?void 0:r.call(t,"func"))||b,B=((null===(n=l)||void 0===n||null===(o=n.get)||void 0===o?void 0:o.call(n,"func"))||l)!=W,$=[],U=(b||D)&&(w&&s||C)&&null!=A;if((!V||!z||V!=z||"field"===u&&B&&h||"operator"===u&&y)&&(U=!1),B&&Iu.includes(z)&&(q&&q===M||(U=!1)),C||(null!=A&&A.size||!P)&&(null==A||!A.size||P)||(U=!1),"func"===S&&l){var K=yu(e,null,null,s,l,z,S,k,c,p,d),G=(0,x.A)(K,2),H=G[0],J=G[1],X=!(null!=J&&J.length),Y=H!==l,Q=!X&&Y&&!J.find((function(e){return!e.fixed})),Z=c&&!X&&!Q&&!!u&&l!==b;if(Z?l=b:Y&&(l=H),!X){var ee=!X&&!Q&&!Z,te=J.find((function(e){return!e.fixed&&!e.ignore}));ee&&te&&(O=tu(te)),J.map((function(e){return $.push(ou(ou({side:"lhs"},e),{},{fixed:e.fixed||Z||false}))}))}}for(var re=0;re<P;re++){var ne=F.get(re)||null,oe=Uu(i,b,w,ne),ie=Uu(e,l,s,ne),ae="value"===ne?oe:Uu(i,b,w,"value"),le="value"===ne?ie:Uu(e,l,s,"value");le==ae||(v[ae]||[]).includes(le)||!ae&&D||(U=!1)}w!=s&&[w,s].includes("proximity")&&(U=!1);var se=F.first(),ue=jp(e,l,s,null,se),ce=$u(e,l,s,null);!l&&D&&(ce=Object.keys(e.settings.valueSourcesInfo));var pe,de=ce[0];1===P&&ue&&void 0!==ue.type?pe=ue.type:1===P&&N&&void 0!==N.type&&(pe="!group"===N.type?"number":N.type);var fe=U&&"operator"===u&&1===T&&2===P,ge=[],ve=[],he=[],ye=Array.from({length:P},(function(){return null}));if(U)for(var me=function(t){var r=A.get(t),n=j.get(t)||null,o=F.get(t)||null;fe&&1===t&&(r=void 0!==ge[0]?ge[0]:A.get(0),ge[t]=r,n=j.get(0)||null,o=F.get(0)||null);var i=!o||void 0!==ce.find((function(e){return e==o})),a=yu(e,l,l,s,r,n,o,k,c,p,d),u=(0,x.A)(a,2),f=u[0],g=u[1],v=!(null!=g&&g.length),h=f!==r,y=!v&&h&&!(null!=g&&g.find((function(e){return!e.fixed}))),m=!(null!=g&&g.find((function(e){return!e.fixed&&!e.ignore}))),b=!i||c&&!v&&!y&&(!m||B);v||null==g||g.map((function(e){return $.push(ou(ou({side:"rhs",delta:t},e),{},{fixed:e.fixed||b}))})),b&&(ge[t]=null,0===t&&delete ge[1]);var O=!v&&!h,_=null==g?void 0:g.find((function(e){return!e.fixed&&!e.ignore}));O&&_&&(ye[t]=tu(_)),h&&(ge[t]=f),!fe||0!==t||v||h||(fe=!1),fe&&0===t&&["func","field"].includes(o)&&(fe=!1)},be=0;be<P;be++)me(be);if(!U)for(var Oe=0;Oe<P;Oe++)if(1===P){var _e,Se=wo([null==N?void 0:N.defaultValue,null==N||null===(_e=N.fieldSettings)||void 0===_e?void 0:_e.defaultValue,null==ue?void 0:ue.defaultValue]);ge[Oe]=Se,null!=Se&&Se.func&&(ve[Oe]="func")}for(var we=0;we<P;we++){var Ae,Fe,je=U&&F.get(we)||null,Ee=U&&j.get(we)||null;U&&fe&&1===we&&(je=null!==(Ae=ve[we])&&void 0!==Ae?Ae:F.get(0),Ee=null!==(Fe=he[we])&&void 0!==Fe?Fe:j.get(0),ve[we]=je,he[we]=Ee),ce.includes(je)||(ve[we]=de),Ee||(he[we]=pe)}var ke=A;(ge.length>0||!U||P<T)&&(ke=new Jn.List(Array.from({length:P},(function(e,t){return void 0!==ge[t]?ge[t]:U?A.get(t):void 0}))));var Ce=F;(ve.length>0||!U||P<T)&&(Ce=new Jn.List(Array.from({length:P},(function(e,t){var r;return null!==(r=ve[t])&&void 0!==r?r:U&&F.get(t)||null}))));var Le=j;(he.length>0||!U||P<T)&&(Le=new Jn.List(Array.from({length:P},(function(e,t){var r;return null!==(r=he[t])&&void 0!==r?r:U&&j.get(t)||null}))));var xe=_u(e,l,s,ke,Ce);if(xe){var Ie=tu(xe),Te=c&&P>=2,Pe=ke;Te&&(ge[1]=ke.get(0),ke=ke.set(1,ge[1]),ye[1]=ye[0]),!Te&&ye.push(Ie),$.push(ou(ou({side:"rhs",delta:-1},xe),{},{fixed:Te,fixedFrom:Te?[Pe.get(0),Pe.get(1)]:void 0,fixedTo:Te?[ke.get(0),ke.get(1)]:void 0}))}var Re=E,Ne=(null==E?void 0:E.size)!==ye.length||ye.filter((function(e,t){return e!=E.get(t)})).length>0;return Ne&&(Re=new Jn.List(ye)),{canReuseValue:U,newValue:ke,newValueSrc:Ce,newValueType:Le,operatorCardinality:P,fixedField:l,newValueError:Re,newFieldError:O,validationErrors:$}},wu=function(e){return"object"==(0,T.A)(e)&&null!==e&&!Array.isArray(e)},Au=function(e,t){if(e){var r=e.get("func"),n=r&&gp(t,r);if(n){var o=e,i=!1;for(var a in n.args){var l=n.args[a],s=l.valueSources,u=l.isOptional,c=l.defaultValue,p=Bu(t,s,l),d=o.get("args"),f=1==p.length?p[0]:void 0,g=d?d.get(a):void 0,v=g?g.get("value"):void 0,h=(g?g.get("valueSrc"):void 0)||f;if(void 0!==v){var y=rc(v,h,t);if(void 0===y)return;if(y!==v&&(o=o.setIn(["args",a,"value"],y)),i)return}else if(void 0===c||wu(c)){if(!u)return;i=!0}else o=(o=o.setIn(["args",a,"value"],ku(l))).setIn(["args",a,"valueSrc"],"value")}return o}}},Fu=function(e,t,r,n){var o=r.settings.fieldSeparator;e=e||new Jn.Map,Array.isArray(t)&&(t=t.join(o));var i=e.get("func"),a=e.get("args");e=e.set("func",t);var l=t&&gp(r,t),s=t&&fp(r,t),u=i&&fp(r,i),c=xu(u,s,a,r,n);return e=c.length?Object.keys(s.args).filter((function(e){return!c.includes(e)})).reduce((function(e,t){return e.deleteIn(["args",t])}),e):e.set("args",new Jn.Map),ju(r,e,l)},ju=function(e,t,r){if(r)for(var n in r.args)t=Eu(e,t,r,n);return t},Eu=function(e,t,r,n){var o=r.args[n],i=o.valueSources,a=o.defaultValue,l=Bu(e,i,o),s=l.length?l[0]:void 0,u=(a?wu(a)&&a.func?"func":"value":void 0)||s;return t.getIn(["args",n])||(void 0!==a&&(t=t.setIn(["args",n,"value"],ku(o))),u&&(t=t.setIn(["args",n,"valueSrc"],u))),t},ku=function(e){var t=e.defaultValue;return wu(t)&&!Jn.Map.isMap(t)&&t.func?Jn.fromJS(t,(function(e,t){return Jn.Iterable.isIndexed(t)?t.toList():t.toOrderedMap()})):t},Cu=function(e,t,r,n,o){if(e&&e.get("func")){var i=(e=e.setIn(["args",t,"value"],r)).getIn(["args",t,"valueSrc"]),a=n.valueSources,l=Bu(o,a,n),s=1==l.length?l[0]:void 0;!s&&l.includes("value")&&(s="value"),!i&&s&&(e=e.setIn(["args",t,"valueSrc"],s))}return e},Lu=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new Jn.Map({valueSrc:r}))),e},xu=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(null==e?void 0:e.returnType)!=(null==t?void 0:t.returnType)?[]:Object.keys(t.args).filter((function(i,a){var l=t.args[i],s=e.args[i];if(Object.keys(e.args).indexOf(i),!s&&(void 0!==l.defaultValue||l.isOptional))return!0;if((null==s?void 0:s.type)!=l.type)return!1;if(Iu.includes(l.type)&&(!s.listValuesType||s.listValuesType!==l.listValuesType))return!1;if(r){var u,c=r.get(i),p=null==c?void 0:c.get("value"),d=null==c?void 0:c.get("valueSrc");if(d&&l.valueSources&&!l.valueSources.includes(d))return!1;var f=yu(n,null,l,null,p,l.type,d,null,o,!0),g=(0,x.A)(f,2),v=(g[0],g[1]);if(null!=v&&null!==(u=v.filter((function(e){return!e.fixed})))&&void 0!==u&&u.length)return!1}return!0}))},Iu=["select","multiselect","treeselect","treemultiselect"],Tu=function(e,t){var r;return(null===(r=e.types[t])||void 0===r?void 0:r.operators)||null},Pu=function(e,t){var r=Ap(e,t);return r?r.operators:[]},Ru=function(e,t){var r,n=Pu(e,t);return null!==(r=null==n?void 0:n[0])&&void 0!==r?r:null},Nu=function(e,t,r){var n=null;if(e)if("field"===t){var o=Ap(r,e);o&&(n=o.type)}else if("func"===t){var i=e.get("func");if(i){var a=gp(r,i);a&&(n=a.returnType||a.type)}}return n},Du=function(e,t){return Vu(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,"funcs","subfields")},Vu=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fields",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"subfields";if(!e)return null;var i=t.settings.fieldSeparator,a=mp(e,t),l=mp(r,t);return a.slice(l.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return[].concat((0,I.A)(l),(0,I.A)(e)).join(i)})).map((function(e){var r=pp(t,e,n,o);return r&&r.label||Lo()(e.split(i))})).filter((function(e){return null!=e}))},zu=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;var n=r&&pp(t,r)||null,o=t.settings.fieldSeparator,i=mp(e,t),a=hp(e,r,t)?mp(r,t):[];return i.slice(a.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return{part:[].concat((0,I.A)(a),(0,I.A)(e)).join(o),key:e[e.length-1]}})).map((function(e){var r=e.part;return{key:e.key,cnf:pp(t,r)}})).map((function(e,t,r){return[e.key,e.cnf,t>0?r[t-1].cnf:n]}))},Mu=function(e,t,r,n){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=jp(e,t,r,null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:null)||{},a=Fp(e,r,t)||{},l=null;if((o?1:a.cardinality)>1){var s=i.valueLabels||a.valueLabels;s&&(l=s[n]),l&&"object"!==(0,T.A)(l)&&(l={label:l,placeholder:l}),l||(l={label:e.settings.valueLabel+" "+(n+1),placeholder:e.settings.valuePlaceholder+" "+(n+1)})}else{var u=i.valueLabel,c=i.valuePlaceholder;l={label:u||e.settings.valueLabel,placeholder:c||e.settings.valuePlaceholder}}return l};function qu(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],i=[];if(!t)return{widgets:o,valueSrcs:i};var a=Op(t),l=a?"".concat(a,"__").concat(r,"__").concat(n):null,s=_p(e,"_getWidgetsAndSrcsForFieldOp",l);if(s)return s;var u="object"===(0,T.A)(t)&&(!!t.func&&!!t.arg||t._isFuncArg),c=Ap(e,t),p=r?e.operators[r]:null;if(null!=c&&c.widgets){var d=function(){var a=c.widgets[f];if(!e.widgets[f])return 1;var l=e.widgets[f].valueSrc||"value",s=!0;if("field"===f&&(s=s&&Bu(e,["field"],c).length>0),"func"===f&&(s=s&&Bu(e,["func"],c).length>0),"value"!==n||a.operators||u||"!case_value"===t||(s=!1),a.operators&&r&&(s=s&&-1!=a.operators.indexOf(r)),n&&n!=l&&"const"!==n&&(s=!1),p&&0==p.cardinality&&"value"!==l&&(s=!1),s){var d,g;o.push(f);var v=-1!=(null===(d=c.valueSources)||void 0===d?void 0:d.indexOf(l));-1==(null==p||null===(g=p.valueSources)||void 0===g?void 0:g.indexOf(l))&&(v=!1),v&&!i.find((function(e){return e==l}))&&i.push(l)}};for(var f in c.widgets)d()}var g=function(e){var t=0;return c.preferWidgets?c.preferWidgets.includes(e)&&(t+=10-c.preferWidgets.indexOf(e)):e==c.mainWidget&&(t+=100),"field"===e&&(t-=1),"func"===e&&(t-=2),t};o.sort((function(e,t){return g(t)-g(e)}));var v={widgets:o,valueSrcs:i};return Sp(e,"_getWidgetsAndSrcsForFieldOp",l,v),v}var Wu=function(e,t,r){return qu(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets},Bu=function(e,t,r){var n;if(!r)return t;var o=null!==(n=r.type)&&void 0!==n?n:r.returnType;return"!group"===o&&(o="number"),t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter((function(t){var n=!0;if("field"===t&&e.__fieldsCntByType){var i=r._isFuncArg?0:1;n=n&&e.__fieldsCntByType[o]>i}return"func"===t&&(r.funcs&&(n=n&&r.funcs.length>0),e.__funcsCntByType&&(n=n&&e.__funcsCntByType[o]>0)),n}))},$u=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=qu(e,t,r,null).valueSrcs;return Bu(e,o,n)},Uu=function(e,t,r){var n=qu(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets,o=null;return n.length&&(o=n[0]),o},Ku=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(e){var i=Ap(t,e)||{},a=t.settings.fieldSeparator,l=mp(e,t),s=Array.isArray(e)?e.join(a):e;if(null!=o&&o.useTableName&&i.tableName){var u=(0,I.A)(l);u[0]=i.tableName,s=u.join(a)}if(i.fieldName&&(s=i.fieldName),n){Ap(t,n);var c=n;0==s.indexOf(c+a)?s=s.slice((c+a).length):i.fieldName||r.errors.push("Can't cut group ".concat(c," from field ").concat(s))}return s}},Gu=function(e,t){var r=e.get("type"),n=e.getIn(["properties","mode"]);return"rule_group"==r&&"array"==n?Hu(e,t):"group"==r||"rule_group"==r?Xu(e,t):Qu(e,t)},Hu=function(e,t){var r=e.get("children1"),n=e.get("properties");return Ju(n.toObject(),r,t)},Ju=function(e,t,r){var n,o,i=e.operator,a=0==(null!==(n=null===(o=r.operators[i])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1),l=!Zu(e,r),s=!Yu(t,r);return!(l&&(!a||s))},Xu=function(e,t){var r=e.get("children1");return Yu(r,t)},Yu=function(e,t){return!((null==e?void 0:e.size)>0&&e.filter((function(e){return!Gu(e,t)})).size>0)},Qu=function(e,t){var r=e.get("properties");return Zu((null==r?void 0:r.toObject())||{},t)},Zu=function(e,t){return!(ec(e,t,!0).score>=3)},ec=function(e,t){var r,n,o,i=e.field,a=e.fieldSrc,l=(e.fieldType,e.operator),s=e.value,u=e.valueSrc,c=(e.valueType,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),p=null!==(r=null===(n=t.operators[l])||void 0===n?void 0:n.cardinality)&&void 0!==r?r:1,d=null!=u&&u.get?u.toJS():u,f={parts:{},score:0};if(f.parts.field=c?null!=i:tc(i,a,t),f.parts.operator=!!l,f.parts.value=(null==s||null===(o=s.filter((function(e,r){return tc(e,null==d?void 0:d[r],t,c)})))||void 0===o?void 0:o.size)>=(c?Math.min(p,1):p),f.score=Object.keys(f.parts).filter((function(e){return!!f.parts[e]})).length,c&&f.score<3){var g=!0;!f.parts.value&&"func"===a&&tc(i,a,t,!1,g)&&f.score++,f.parts.field||null==s||s.map((function(e,r){"func"===(null==d?void 0:d[r])&&tc(e,null==d?void 0:d[r],t,!1,g)&&f.score++}))}return f},tc=function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(!o&&"func"==r&&t){var a,l=null===(a=t.get)||void 0===a?void 0:a.call(t,"func"),s=gp(n,l);if(s){var u=t.get("args");for(var c in s.args){var p=s.args[c],d=u?u.get(c):void 0,f=d?d.get("value"):void 0,g=d?d.get("valueSrc"):void 0;if(null==f&&void 0===(null==p?void 0:p.defaultValue)&&(null==p||!p.isOptional))return!1;if(null!=f&&!e(f,g,n,!i||o))return!1}return!0}}return null!=t},rc=function(e,t,r){return"func"==t?Au(e,r):e},nc=function e(t){var r=t.get("children1");if(1==(null==r?void 0:r.size)){var n=r.first();return"group"===n.get("type")?e(n):n}return null},oc=r(4308),ic=r.n(oc),ac=r(3523),lc=r.n(ac),sc=r(502),uc=r.n(sc);function cc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function dc(e,t){return uc().apply(e,t)}var fc={CALL:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return e.call.apply(e,[t].concat(n))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return pc(pc({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return(null==e?void 0:e.length)||0},regexTest:function(e,t,r){return null!=(null==e?void 0:e.match(new RegExp(t,r)))},now:function(){return new Date},date_add:function(e,t,r){return mi()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function gc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vc(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function yc(e,t,r){var n;try{n=uc().apply(e,t)}catch(e){throw e.message="".concat(r.join(".")," :: ").concat(e.message),e}return n}function mc(e,t,r,n){var o;try{o=t.call.apply(t,[e].concat((0,I.A)(r)))}catch(e){throw e.message="".concat(n.join(".")," :: ").concat(e.message),e}return o}!function(){for(var e in fc)t=e,r=fc[e],uc().add_operation(t,r);var t,r}();var bc=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],Oc={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},_c=hc(hc({},Oc),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Sc={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},wc={widgetProps:_c,opProps:Sc},Ac=hc(hc({},Oc),{},{fieldSettings:Oc}),Fc=hc(hc({},Oc),{},{fieldSettings:Oc,widgets:{x:wc},mainWidgetProps:_c}),jc={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},caseValueField:Fc,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},Ec={fields:{x:Fc},widgets:{x:_c},conjunctions:{x:{formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}}},operators:{x:Sc},types:{x:{widgets:{x:wc}}},funcs:{x:hc(hc(hc({},Ac),{renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}}),{},{args:{x:hc({},Ac)}})},settings:jc},kc=function(e){return"object"==(0,T.A)(e)&&null!==e&&!Array.isArray(e)},Cc=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=ko()(e,bc);delete r.ctx;for(var n=function e(t,r,n,o){if(kc(t)){if(vo(t)&&(t=go(t)),"funcs"===n[0]&&!r){var i=n[n.length-1];(r=pp({funcs:o.BasicFuncs},i,"funcs","subfields")||void 0)&&(t.$$key=i)}if(void 0!==r&&kc(r))for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(!Object.keys(t).includes(a)||void 0===t[a]&&void 0!==r[a]?t[a]="$$deleted":(t[a]=e(t[a],r[a],[].concat((0,I.A)(n),[a]),o),void 0===t[a]&&delete t[a]));for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var s;r&&Object.keys(r).includes(l)||(t[l]=e(t[l],null===(s=r)||void 0===s?void 0:s[l],[].concat((0,I.A)(n),[l]),o)),void 0===t[l]&&delete t[l]}0===Object.keys(t).length&&(t=void 0)}else Array.isArray(t)&&t.forEach((function(r,i){t[i]=e(t[i],void 0,[].concat((0,I.A)(n),[i]),o)}));if(void 0===r||!ao(t,r,!0)){if("function"==typeof t)throw new Error("compressConfig: function at ".concat(n.join(".")," should be converted to JsonLogic"));return t}},o=0,i=bc;o<i.length;o++){var a=i[o];if("ctx"===a);else if("fields"===a)r[a]=lc()(r[a]),n(r[a],{},[a]);else if("funcs"===a)for(var l in r[a]=lc()(r[a]||{}),r[a])n(r[a][l],null,[a,l],{BasicFuncs:h});else r[a]=lc()(r[a]),n(r[a],t[a],[a])}return r},Lc=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var n={},o=function e(t,r,n){if(kc(r))for(var o in kc(t)||(t={}),r)Object.prototype.hasOwnProperty.call(r,o)&&("$$deleted"===r[o]?delete t[o]:t[o]=e(t[o],r[o],[].concat((0,I.A)(n),[o])));else t=Array.isArray(r)?lc()(r):r;return t},i=function e(t,r,n){var i=!1;if(kc(t)&&Object.prototype.hasOwnProperty.call(t,"$$key")&&t.$$key){var a=pp({funcs:n.BasicFuncs},t.$$key,"funcs","subfields");if(!a)throw new Error("decompressConfig: basic function not found by key ".concat(t.$$key," at ").concat(r.join(".")));delete t.$$key,t=o(lc()(a),t,r),i=!0}if(!i)if(kc(t))for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(t[l]=e(t[l],[].concat((0,I.A)(r),[l]),n));else if(Array.isArray(t)){var s,u=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return gc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(u.s();!(s=u.n()).done;){var c=s.value;t[c]=e(t[c],[].concat((0,I.A)(r),[c]),n)}}catch(e){u.e(e)}finally{u.f()}}return t},a=0,l=bc;a<l.length;a++){var s=l[a];"ctx"===s?n[s]=ic()({},t.ctx||{},r||{}):"funcs"===s?(n[s]=lc()(e[s]||{}),i(n[s],[s],{BasicFuncs:h})):"fields"===s?n[s]=lc()(e[s]||{}):(n[s]=lc()(t[s]||{}),o(n[s],e[s]||{},[s]))}return n},xc=function(e){return e.__compliled||(Ic(e=lc()(e),e,{ctx:e.ctx},Ec,[]),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0})),e};function Ic(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(t)for(var a in i.length,n){var l=n[a],s="x"===a?i:[].concat((0,I.A)(i),[a]);if("r"===l.type){var u=t,c=u[a];if(l.isArr)for(var p in c){var d=Rc(c[p],r,[].concat((0,I.A)(s),[p]));d!==c[p]&&(o.push("Compiled ".concat(s.join("."),"[").concat(p,"]")),c[p]=d)}else{var f=Rc(c,r,s,void 0);f!==c&&(o.push("Compiled R ".concat(s.join("."))),u[a]=f)}}else if("rf"===l.type){var g=t,v=g[a],h=Tc(v,r,s,l.ignore);h!==v&&(o.push("Compiled JL-RF ".concat(s.join("."))),g[a]=h)}else if("f"===l.type){var y,m=t,b=m[a],O=Pc(b,r,s,l.args,l.ignore);l.invokeWith&&O&&"function"==typeof O&&(O=(y=O).call.apply(y,[null].concat((0,I.A)(l.invokeWith)))),O!==b&&(o.push("Compiled JL-F ".concat(s.join("."))),m[a]=O)}else if("x"===a)for(var _ in t){s=[].concat((0,I.A)(i),[_]);var S=t[_];Ic(e,S,r,l,o,s),S.subfields&&Ic(e,S.subfields,r,n,o,s)}else Ic(e,t[a],r,l,o,s)}}function Tc(e,t,r){return yo(e)?function(n,o){o=o||(null==t?void 0:t.ctx);var i=yc(e,{props:n,ctx:o},r);return"string"==typeof i&&(i={type:i,props:n}),Rc(i,{ctx:o},r)}:"string"==typeof e?function(n,o){o=o||(null==t?void 0:t.ctx);var i=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),o);return i?mc(this,i,[n,o],r):Rc({type:e,props:n},{ctx:o},r)}:e}function Pc(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return yo(e)&&"jl"!==o?function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=this||(null==t?void 0:t.ctx),s=(n||[]).reduce((function(e,t,r){return hc(hc({},e),{},(0,L.A)({},t,i[r]))}),{args:i,ctx:l});return yc(e,s,r)}.bind(null==t?void 0:t.ctx):"string"==typeof e&&"string"!==o?function(){var n=this||(null==t?void 0:t.ctx),o=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),n);if(o){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return mc(this,o,a,r)}throw new Error("".concat(r.join(".")," :: Function ").concat(e," is not found in ctx"))}.bind(null==t?void 0:t.ctx):e}function Rc(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(ho(e)){var o,i=e.type,a=e.props;if("string"!=typeof i)throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var l,s=function(e,t){var r;return(null==t||null===(r=t.components)||void 0===r?void 0:r[e])||t.W[e]||t.O[e]}(i,t.ctx)||i.toLowerCase();return void 0!==n&&(a=hc(hc({},a),{},{key:n})),null!==(o=a)&&void 0!==o&&o.children&&(l=Rc(a.children,t,r),a=hc(hc({},a),{},{children:l})),t.ctx.RCE(s,a)}return e instanceof Array?e.map((function(e,n){return Rc(e,t,r,""+n)})):e}var Nc=r(2815),Dc=r.n(Nc),Vc={reverseOperatorsForNot:!1,canShortMongoQuery:!0,formatField:function(e,t,r,n,o,i){return i?r:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultConjunction:"AND",defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",addSubGroupLabel:"Add sub group",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function zc(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Mc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Mc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qc,Wc=0,Bc=0,$c={},Uc=function(){return qc||(qc=Gc({reactIndex:void 0,maxSize:3,canCompile:void 0})),qc},Kc=function(e,t){var r;for(var n in $c){var o=$c[n].findExtendedConfig(e,t);if(o){r=o;break}}return r},Gc=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0},r=new Map,n=t.maxSize||2,o=++Wc,i=function(e,t){r.size+1>n&&r.delete(r.keys().next().value),r.set(e,t)},a=function(e,t){var n,o=zc(r.keys());try{var i,a=function(){var o=n.value;if(bc.filter((function(t){return o[t]===e[t]})).length===bc.length&&(!t||o.__compliled))return{v:r.get(o)}};for(o.s();!(n=o.n()).done;)if(i=a())return i.v}catch(e){o.e(e)}finally{o.f()}var l,s=zc(r.values());try{var u,c=function(){var r=l.value;if(bc.filter((function(t){return r[t]===e[t]})).length===bc.length&&(!t||r.__compliled))return{v:r}};for(s.s();!(l=s.n()).done;)if(u=c())return u.v}catch(e){s.e(e)}finally{s.f()}return null};return e={getExtendedConfig:function(e){return function(e){return a(e)||function(e){var r=Qc(e,++Bc,t.canCompile);return i(e,r),r}(e)}(function(e){return ko()(e,bc)}(e))},findExtendedConfig:a,getBasicConfig:function(e){var t,n=zc(r.keys());try{var o,i=function(){var n=t.value,o=r.get(n);if(0===bc.map((function(t){return o[t]===e[t]})).filter((function(e){return!e})).length)return{v:n}};for(n.s();!(t=n.n()).done;)if(o=i())return o.v}catch(e){n.e(e)}finally{n.f()}return e},clearConfigMemo:function(){r.clear(),delete $c[o],qc===e&&(qc=void 0)},configId:Bc,storeConfigPair:i,getSize:function(){return r.size},configStore:r,memoId:o,meta:t},void 0===t.reactIndex&&(qc=e),$c[o]=e,e};function Hc(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Jc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Jc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xc(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qc=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(r=r&&e.settings.useConfigCompress,e.__configId)return e;var n=Kc(e,r);if(n)return n;var o=e;(e=r?e.__compliled?lc()(e):xc(e):lc()(e)).settings=Dc()({},Vc,e.settings,fo),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},function(e,t){for(var r in e)Zc(0,e[r],t)}(e.types,e),ep(e.fields,e),tp(e.funcs,e);var i=e.settings.caseValueField;i&&rp(i,e,[],!1,!0);var a=e.settings.locale.moment;return a&&mi().locale(a),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||Yn()}),e.__cache={},Oo(e),Uc().storeConfigPair(o,e),e};function Zc(e,t,r){var n=null,o=null;t.mainWidget=t.mainWidget||Object.keys(t.widgets).filter((function(e){return"field"!=e&&"func"!=e}))[0];var i=t.excludeOperators||[];for(var a in t.widgets){var l=t.widgets[a],s=l.defaultOperator;l.operators&&(n=bo(n,l.operators.filter((function(e){return!i.includes(e)})))),s&&!i.includes(s)&&(o&&a!==t.mainWidget||(o=s)),a==t.mainWidget&&(l.widgetProps=Yc(Yc({},t.mainWidgetProps||{}),l.widgetProps||{})),t.widgets[a]=l}t.valueSources||(t.valueSources=Object.keys(r.settings.valueSourcesInfo));var u,c=Hc(t.valueSources);try{for(c.s();!(u=c.n()).done;){var p=u.value;"value"==p||t.widgets[p]||(t.widgets[p]={})}}catch(e){c.e(e)}finally{c.f()}!t.operators&&n&&(t.operators=Array.from(new Set(n))),!t.defaultOperator&&o&&(t.defaultOperator=o)}function ep(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var n in e){var o=[].concat((0,I.A)(r),[n]);rp(e[n],t,o),e[n].subfields&&ep(e[n].subfields,t,o)}}function tp(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var o=(null==t||null===(r=t.settings)||void 0===r?void 0:r.fieldSeparator)||".";for(var i in e){var a=[].concat((0,I.A)(n),[i]),l=a.join(o),s=e[i];if(s.returnType&&(s.type=s.returnType,t.__funcsCntByType[s.returnType]||(t.__funcsCntByType[s.returnType]=0),t.__funcsCntByType[s.returnType]++),rp(s,t,a,!1),s.args){for(var u in s.args)rp(s.args[u],t,[].concat((0,I.A)(a),[u]),!0);var c,p=!0,d=Hc(Object.keys(s.args).reverse());try{for(d.s();!(c=d.n()).done;){var f=c.value,g=s.args[f];!p&&g.isOptional&&(Ao.info("Arg ".concat(f," for func ").concat(l," can't be optional")),delete g.isOptional),g.isOptional||(p=!1)}}catch(e){d.e(e)}finally{d.f()}}s.subfields&&tp(s.subfields,t,[].concat((0,I.A)(n),[i]))}}}function rp(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.settings,l=a.showLabels,s=a.fieldSeparator;s=null!==(r=s)&&void 0!==r?r:".";var u=n[n.length-1],c=o?n.slice(0,n.length-1).join(s):n.join(s),p=!!e.returnType,d=e.type||e.returnType,f=t.types[d],g=e.excludeOperators||[],v=(e.operators||(null==f?void 0:f.operators)||[]).filter((function(e){return!g.includes(e)})),h=e.defaultOperator||(null==f?void 0:f.defaultOperator);g.includes(h)&&(h=void 0);var y=!!h&&h==e.defaultOperator;if(y&&(e.ownDefaultOperator=e.defaultOperator),f){o||p||i||(t.__fieldsCntByType[d]||(t.__fieldsCntByType[d]=0),t.__fieldsCntByType[d]++),o&&(e._isFuncArg=!0,e._argKey=u,e._funcKey=c),p&&(e._isFunc=!0,e._funcKey=c),i&&(e._isCaseValue=!0),function(e,t,r){for(var n,o,i=0,a=["listValues","treeValues","allowCustomValues","validateValue"];i<a.length;i++){var l=a[i];e[l]&&(e.fieldSettings||(e.fieldSettings={}),e.fieldSettings[l]=e[l],delete e[l])}null!==(n=e.fieldSettings)&&void 0!==n&&n.listValues&&t.settings.normalizeListValues&&(e.fieldSettings.listValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.listValues,r,e.fieldSettings)),null!==(o=e.fieldSettings)&&void 0!==o&&o.treeValues&&t.settings.normalizeListValues&&(e.fieldSettings.treeValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.treeValues,r,e.fieldSettings))}(e,t,d);var m=["widgets","operators","defaultOperator"];Object.keys(f).filter((function(e){return!m.includes(e)})).map((function(t){e[t]||(e[t]=ro(f[t]))}));var b=f.excludeOperators||[];e.operators&&(b=b.filter((function(t){return!e.operators.includes(t)}))),e.widgets||(e.widgets={});var O=function(){var t=Yc({},e.widgets[_]||{}),r=f.widgets[_]||{};if(!o){var n=t.defaultOperator,i=[].concat((0,I.A)(g),(0,I.A)(b)),a=e.preferWidgets&&("field"===_||e.preferWidgets.includes(_))||i.length>0;if(t.operators){var s=t.operators.filter((function(e){return!i.includes(e)}));t.operators=s,v=bo(v,s)}else if(a&&r.operators){var c=r.operators.filter((function(e){return!i.includes(e)}));t.operators=c,v=bo(v,c)}n&&!i.includes(n)&&(h&&(y||_!==e.mainWidget)||(h=n))}_===e.mainWidget?t.widgetProps=Yc(Yc(Yc({},r.widgetProps||{}),e.mainWidgetProps||{}),t.widgetProps||{}):t.widgetProps=Yc(Yc({},r.widgetProps||{}),t.widgetProps||{});var p=Array.from(new Set([].concat((0,I.A)(Object.keys(r.opProps||{})),(0,I.A)(Object.keys(t.opProps||{})))));if(p.length){var d,m={},O=Hc(p);try{for(O.s();!(d=O.n()).done;){var S,w,A=d.value;m[A]=Yc(Yc({},(null===(S=r.opProps)||void 0===S?void 0:S[A])||{}),(null===(w=t.opProps)||void 0===w?void 0:w[A])||{})}}catch(e){O.e(e)}finally{O.f()}t.opProps=m}var F=t,j=F.valueLabel,E=F.valuePlaceholder;o&&(j||(t.valueLabel=e.label||u),E||l||(t.valuePlaceholder=e.label||u)),t=Yc(Yc({},r),t),e.widgets[_]=t};for(var _ in f.widgets)O();if(o||(e.operators||(e.operators=Array.from(new Set(v))),e.defaultOperator||(e.defaultOperator=h)),!o&&!p&&!i){var S=function(e,t){if(!t)return{};var r=e.settings.fieldSeparator,n=(0,I.A)(t).reduce((function(t,n,o,i){var a=t.computedPath,l=t.computed,s=t.inGroup,u=[].concat((0,I.A)(i.slice(0,o)),[n]),c=pp(e,u);return"!group"===(null==c?void 0:c.type)&&o<i.length-1?(s=u.join(r),a=[]):null!=c&&c.fieldName?(l=!0,a=[c.fieldName]):a=[].concat((0,I.A)(a),[n]),{computedPath:a,computed:l,inGroup:s}}),{computedPath:[],computed:!1,inGroup:void 0}),o=n.computedPath,i=n.computed,a=n.inGroup;return i?{fieldName:o.join(r),inGroup:a}:{}}(t,n),w=S.fieldName,A=S.inGroup;w&&(e.fieldName=w,t.__fieldNames[w]||(t.__fieldNames[w]=[]),t.__fieldNames[w].push({fullPath:n,inGroup:A}))}}else e.disabled=!0}function np(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function op(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?np(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):np(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ip=jo().mark(sp),ap=jo().mark(up),lp=Zn;function sp(e){return jo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(cp(e,e.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}}),ip)}function up(e){return jo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(cp(e,e.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}}),ap)}function cp(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";return jo().mark((function o(i){var a,l,s;return jo().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:a=(null==e||null===(i=e.settings)||void 0===i?void 0:i.fieldSeparator)||".",o.t0=jo().keys(t);case 2:if((o.t1=o.t0()).done){o.next=13;break}if(l=o.t1.value,!(s=t[l])[n]){o.next=9;break}return o.delegateYield(cp(e,s[n],[].concat((0,I.A)(r),[l]),n),"t2",7);case 7:o.next=11;break;case 9:return o.next=11,[[].concat((0,I.A)(r),[l]).join(a),s];case 11:o.next=2;break;case 13:case"end":return o.stop()}}),o)}))()}var pp=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fields",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";if(!t)return null;if("!case_value"===t)return null==e||null===(n=e.settings)||void 0===n?void 0:n.caseValueField;var a=(null==e||null===(r=e.settings)||void 0===r?void 0:r.fieldSeparator)||".",l=mp(t,e),s=e[o];if(!s)return null;for(var u=s,c=null,p=[],d=0;d<l.length;d++){var f=l[d];p.push(f),c=u[p.join(a)],d<l.length-1&&(c&&c[i]?(u=c[i],p=[]):c=null)}return c},dp=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.settings.fieldSeparator,a=[o].concat((0,I.A)(t.split(i))).filter((function(e){return null!=e})),l=t;return((null===(r=e.__fieldNames[l])||void 0===r||null===(n=r.find)||void 0===n||null===(n=n.call(r,(function(e){var t=e.inGroup;return!t||(null==o?void 0:o.startsWith(t))})))||void 0===n?void 0:n.fullPath)||a).join(i)},fp=function(e,t){if(!t)return null;var r=pp(e,t,"funcs","subfields");if(!r)return null;var n=r.returnType,o=r.args;return{returnType:n,args:Object.fromEntries(Object.entries(o||{}).map((function(e){var t=(0,x.A)(e,2),r=t[0],n=t[1];return[r,ko()(n,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"])]})))}},gp=function(e,t){return t&&pp(e,t,"funcs","subfields")||null},vp=function(e,t,r){var n=gp(e,t);return n&&(n.args&&n.args[r]||null)||null},hp=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;var o=(null==n||null===(r=n.settings)||void 0===r?void 0:r.fieldSeparator)||".",i=yp(e,n),a=yp(t,n);return i.startsWith(a+o)},yp=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)return e;var n=(null==r||null===(t=r.settings)||void 0===t?void 0:t.fieldSeparator)||".";return mp(e,r).join(n)},mp=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var i,a=(null==o||null===(t=o.settings)||void 0===t?void 0:t.fieldSeparator)||".";return null!=e&&e.func?Array.isArray(e.func)?e.func:e.func.split(a):null!=e&&null!==(r=e.get)&&void 0!==r&&r.call(e,"func")?null==e||null===(i=e.get)||void 0===i?void 0:i.call(e,"func").split(a):(null==e||null===(n=e.split)||void 0===n?void 0:n.call(e,a))||[]},bp=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var n=t.settings.fieldSeparator,o=mp(e,t);return r?o:o.map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return e.join(n)}))},Op=function(e){var t;if("string"==typeof e||Array.isArray(e))return"field:".concat(yp(e));if("object"===(0,T.A)(e)&&e){if(e._funcKey&&e._argKey)return"arg:".concat(yp(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(yp(e._funcKey));if(e.func&&e.arg)return"arg:".concat(yp(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(yp(e.func));if(e.type)return null}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?"arg:".concat(yp(e.get("func")),"__").concat(e.get("arg")):"func:".concat(yp(e.get("func"))):null},_p=function(e,t,r){var n;return null===(n=e.__cache)||void 0===n||null===(n=n[t])||void 0===n?void 0:n[r]},Sp=function(e,t,r,n){e.__cache&&r&&(e.__cache[t]||(e.__cache[t]={}),e.__cache[t][r]=n)},wp=function(e){var t;if(!e)return null;if("object"===(0,T.A)(e)){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?null:"func":"field"},Ap=function(e,t){var r;if(!t)return null;if("object"==(0,T.A)(t)){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?vp(e,t.func,t.arg):gp(e,t.func)}return null!=t&&null!==(r=t.get)&&void 0!==r&&r.call(t,"func")?null!=t&&t.get("arg")?vp(e,t.get("func"),t.get("arg")):gp(e,t.get("func")):pp(e,t)||null},Fp=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;var n=e.operators[t];if(r){var o,i,a=Op(r),l=a?"".concat(a,"__").concat(t):null,s=_p(e,"getOperatorConfig",l);if(s)return s;var u=Ap(e,r),c=Uu(e,r,t,null),p=e.widgets[c]||{},d=(u&&u.widgets?u.widgets[c]:{})||{},f=(null===(o=p.opProps)||void 0===o?void 0:o[t])||{},g=(null===(i=d.opProps)||void 0===i?void 0:i[t])||{},v=op(op(op({},n),f),g);return Sp(e,"getOperatorConfig",l,v),v}return n},jp=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!t)return null;var l=Ap(e,t),s=Op(t);o||(o=Uu(e,t,n,i));var u=s?"".concat(s,"__").concat(n,"__").concat(o,"__").concat(i):null,c=_p(e,"getFieldWidgetConfig",u);if(c)return c;var p=e.widgets[o]||{},d=(null==l||null===(r=l.widgets)||void 0===r?void 0:r[o])||{},f=d.widgetProps||{},g="value"!==i&&i?{}:null==l?void 0:l.fieldSettings,v=op(op(op(op({},p),d),f),g);return Sp(e,"getFieldWidgetConfig",u,v),a.forExport&&(v=no(v,"factory")),v},Ep=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.settings.fieldSeparator,n=mp(t,e),o=t?pp(e,t):e,i=null,a=[];do{var l,s=o===e?e.fields:null===(l=o)||void 0===l?void 0:l.subfields;if(!s||!Object.keys(s).length){o=i=null;break}i=Object.keys(s)[0],a.push(i),o=s[i]}while("!struct"==o.type||"!group"==o.type);return(n||[]).concat(a).join(r)};function kp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kp(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Lp=function(e,t){var r={usedFields:[]},n=xp(e,t,r);if(n)return Cp(Cp({},n),r)},xp=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?Ip(e,t,r):"rule"===n?Tp(e,t,r):void 0}},Ip=function(e,t,r){var n=e.get("properties")||new lr,o=e.get("children1"),i=e.get("id"),a=o.map((function(e){return xp(e,t,r)})).filter((function(e){return void 0!==e}));if(a.size){var l=n.get("conjunction");l||(l=al(t));var s=n.get("not");return{id:i,rules:a.toList(),condition:l.toUpperCase(),not:s}}},Tp=function(e,t,r){var n,o=e.get("properties")||new lr,i=e.get("id"),a=o.get("operator"),l=o.get("operatorOptions"),s=o.get("field"),u=o.get("value"),c=o.get("valueSrc"),p=o.get("valueType"),d=u.filter((function(e){return void 0===e})).size>0;if(null!=s&&null!=a&&!d){var f=Ap(t,s)||{},g=Fp(t,a,s)||{},v=f.type||"undefined",h=oo(g),y=t.types[f.type]||{},m=Ku(s,t,r);if(!(u.size<h)){-1==r.usedFields.indexOf(s)&&r.usedFields.push(s),u=u.toArray(),c=c.toArray(),p=(null===(n=p)||void 0===n?void 0:n.toArray())||[];for(var b=[],O=0;O<u.length;O++){var _={type:p[O],value:u[O]};if(b.push(_),"field"==c[O]){var S=u[O];-1==r.usedFields.indexOf(S)&&r.usedFields.push(S)}}var w=l?l.toJS():null;w&&!Object.keys(w).length&&(w=null);var A={id:i,fieldName:m,type:v,input:y.mainWidget,operator:a};return w&&(A.operatorOptions=w),A.values=b,A}}};function Pp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pp(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Np(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Dp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dp(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Dp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vp=function(e,t){var r,n={usedFields:[],errors:[]},o=Qc(t,void 0,!1),i=zp(e,o,n,!1,!0),a=n.errors,l=n.usedFields,s=(o.settings.fieldSeparator,{}),u=Np(l);try{for(u.s();!(r=u.n()).done;)for(var c=r.value,p=mp(c,t),d=(Ap(o,c),s),f=0;f<p.length;f++){var g=p[f],v=Ap(o,p.slice(0,f+1))||{};f!=p.length-1?"!group"==v.type&&"struct"!=v.mode?(d[g]||(d[g]=[{}]),d=d[g][0]):(d[g]||(d[g]={}),d=d[g]):d[g]||(d[g]=null)}}catch(e){u.e(e)}finally{u.f()}return{errors:a,logic:i,data:s}},zp=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(e){var a,l=e.get("type"),s=(e.get("properties")||new lr).get("isLocked"),u=t.settings.jsonLogic.lockedOp;return"group"===l||"rule_group"===l?a=Mp(e,t,r,n,o,i):"rule"===l?a=qp(e,t,r,n,i):"switch_group"==l?a=Wp(e,t,r,n):"case_group"==l&&(a=Bp(e,t,r,n,i)),s&&a&&u&&(a=(0,L.A)({},u,a)),a}},Mp=function(e,t,r){var n,o,i,a,l,s,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,d=e.get("type"),f=e.get("properties")||new lr,g=f.get("mode"),v=e.get("children1")||new xr,h=f.get("field"),y=Ap(t,h),m=f.get("conjunction");m||(m=al(t));var b=t.conjunctions[m],O=(null==b?void 0:b.jsonLogicConj)||m.toLowerCase(),_=!!f.get("not"),S="rule_group"===d&&!c,w=S&&"struct"!=g,A=w?h:p,F=f.get("operator"),j=F&&Fp(t,F,h)||null,E=$p(t,f,r,F,p),k=S&&(!F||0==(null===(n=j)||void 0===n?void 0:n.cardinality)),C=S&&(null==v?void 0:v.size)>0,x=(S&&null!=v&&v.size,_),I=!1;C?(I=_,x=u):u&&(x=!x);var T=!1,P=null===(o=j)||void 0===o?void 0:o.reversedOp,R=Fp(t,P,h),N=!(null!==(i=j)&&void 0!==i&&i.jsonLogic||null===(a=R)||void 0===a||!a.jsonLogic),D=!(null===(l=R)||void 0===l||!l.jsonLogic),V=null===(s=nc(e))||void 0===s?void 0:s.get("type");if(!!t.settings.reverseOperatorsForNot&&(!S&&x&&"rule"===V||I&&1===(null==v?void 0:v.size))&&(C?I=!I:x=!x,T=!0),x&&S&&D&&(t.settings.reverseOperatorsForNot||N)){x=!x;var z=[P,F];F=z[0],P=z[1];var M=[R,j];j=M[0],R=M[1]}var q=v.map((function(e){return zp(e,t,r,T,!1,A)})).filter((function(e){return void 0!==e})),W=!!t.settings.exportPreserveGroups;if(w&&!k){if(null==E)return}else if(!q.size&&!W)return;var B=c||W||1!=q.size;B||!_||T||(B=v.some((function(e){var r,n,o,i,a=null===(r=e.get("properties"))||void 0===r?void 0:r.get("operator"),l=null===(n=t.operators)||void 0===n||null===(n=n[a])||void 0===n?void 0:n.reversedOp;return null!==(o=null===(i=t.operators)||void 0===i||null===(i=i[l])||void 0===i?void 0:i._jsonLogicIsExclamationOp)&&void 0!==o&&o})));var $={};if(B?$[O]=q.toList().toJS():$=q.first(),I&&($={"!":$}),w){var U=Gp(r,t,h,p);if(k){var K=F||"some";$=(0,L.A)({},K,[U,$])}else{var G=q.size?{filter:[U,$]}:U;$=Hp(t,f,{reduce:[G,{"+":[1,{var:"accumulator"}]},0]},E,F,null,y)}}return x&&($={"!":$}),$},qp=function(e,t,r){var n,o,i,a,l,s,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=e.get("properties")||new lr,d=p.get("field"),f=p.get("fieldSrc"),g=p.get("operator"),v=p.get("operatorOptions");if((v=v?v.toJS():null)&&!Object.keys(v).length&&(v=null),null!=d&&null!=g){var h=Ap(t,d),y=Fp(t,g,d),m=null===(n=y)||void 0===n?void 0:n.reversedOp,b=Fp(t,m,d);if(null!==(o=y)&&void 0!==o&&o.jsonLogic||null!==(i=b)&&void 0!==i&&i.jsonLogic){var O=u,_=!(null!==(a=y)&&void 0!==a&&a.jsonLogic||null===(l=b)||void 0===l||!l.jsonLogic),S=!(null===(s=b)||void 0===s||!s.jsonLogic)&&(!!t.settings.reverseOperatorsForNot||_);if(O&&S||_){O=!O;var w=[m,g];g=w[0],m=w[1];var A=[b,y];y=A[0],b=A[1]}var F=$p(t,p,r,g,c);if(void 0!==F){var j="func"===f?Kp(r,t,d,c):Gp(r,t,d,c);if(void 0!==j)return Hp(t,p,j,F,g,v,h,O)}}else r.errors.push("Operator ".concat(g," is not supported"))}},Wp=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.get("children1");if(o){for(var i=o.map((function(e){return Bp(e,t,r,n,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray(),a=[],l=0;l<i.length;l++)l===i.length-1||i[l][0]?(a.push(i[l]),l===i.length-1&&i[l][0]&&a.push([void 0,null])):r.errors.push("No condition for case ".concat(l));if(a.length){if(1===a.length){var s=(0,x.A)(a[0],2),u=(s[0],s[1]);return null==u&&(u=null),u}for(var c={if:[]},p=c.if,d=(0,x.A)(a[a.length-1],2),f=(d[0],d[1]),g=0;g<a.length-1;g++){var v=g===a.length-2,h=(0,x.A)(a[g],2),y=h[0],m=h[1];null==m&&(m=null),null==y&&(y=!0),p.push(y),p.push(m),v?p.push(f):(p.push({if:[]}),p=p[p.length-1].if)}return c}}},Bp=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.get("type");if("case_group"==i){var a=e.get("properties")||new lr;return[Mp(e,t,r,n,o),$p(t,a,r,null,o,"!case_value")]}r.errors.push("Unexpected child of type ".concat(i," inside switch"))},$p=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");("!case_value"==i||s&&"case_value"==s.get(0))&&(a="!case_value");var u=Ap(e,a),c=Fp(e,n,a),p=oo(c),d=t.get("value"),f=t.get("asyncListValues");if(null!=d){var g=[],v=[],h=r.usedFields,y=d.map((function(t,i){var p=l?l.get(i):null,d=s?s.get(i):null,h=rc(t,p,e),y=Uu(e,a,n,p),m=jp(e,a,n,y,p,{forExport:!0}),b=Up(r,e,h,p,d,m,u,n,c,o,f);return void 0!==b&&(g.push(p),v.push(d)),b})),m=y.filter((function(e){return void 0===e})).size>0;if(!(y.size<p||m))return p>1?y.toArray():1==p?y.first():null;r.usedFields=h}},Up=function(e,t,r,n,o,i,a,l,s){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"==n)p=Gp(e,t,r,u);else if("func"==n)p=Kp(e,t,r,u);else if("function"==typeof(null==i?void 0:i.jsonLogic)){var d=i.jsonLogic,f=[r,Rp(Rp({},a?ko()(a,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),no(i,Zn)];l&&(f.push(l),f.push(s)),p=d.call.apply(d,[t.ctx].concat(f))}else p=r;return p}},Kp=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),l=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),s=gp(t,a),u=mp(a,t),c=u[u.length-1];if(s)if(null!=s&&s.jsonLogic){var p={},d=[],f=[];for(var g in s.args){var v,h=s.args[g],y=Ap(t,h),m=h.defaultValue,b=h.isOptional,O=null!=m&&m.func?"func":"value",_=l?l.get(g):void 0,S=_?_.get("value"):void 0,w=_?_.get("valueSrc"):void 0;"func"!==w&&null!==(v=S)&&void 0!==v&&v.toJS&&(S=S.toJS());var A=null,F=Uu(t,h,A,w),j=jp(t,h,A,F,w,{forExport:!0}),E=Up(e,t,S,w,h.type,j,y,null,null,i);if(null!=S&&void 0===E)return void("func"!=w&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(a)));var k=void 0;if(void 0===E&&!b&&null!=m){var C=Uu(t,h,A,O),x=jp(t,h,A,C,O,{forExport:!0});if(void 0===(k=Up(e,t,m,O,h.type,x,y,null,null,i)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(a)))}var I=null!=E?E:k;if(void 0!==I){if(d.length){var T,P=Np(d);try{for(P.s();!(T=P.n()).done;)p[T.value]=void 0}catch(e){P.e(e)}finally{P.f()}d=[]}p[g]=I}else b||f.push(g),d.push(g)}if(!f.length){var R,N=Object.values(p);if("function"==typeof s.jsonLogic){var D=s.jsonLogic,V=[p];R=D.call.apply(D,[t.ctx].concat(V))}else{var z=s.jsonLogic||c;if(s.jsonLogicIsMethod){var M=N[0],q=N.slice(1);R=q.length?{method:[M,z,q]}:{method:[M,z]}}else R=(0,L.A)({},z,N)}return R}}else e.errors.push("Func ".concat(a," is not supported"));else e.errors.push("Func ".concat(a," is not defined in config"))},Gp=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.settings,a=i.fieldSeparator,l=i.jsonLogic;if(r){Array.isArray(r)&&(r=r.join(a));var s=Ap(t,r)||{},u=Ku(r,t,e,o),c=s.jsonLogicVar||("!group"==s.type?l.groupVarKey:"var");n=(0,L.A)({},c,u),-1==e.usedFields.indexOf(r)&&e.usedFields.push(r)}return n},Hp=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=t.get("field"),u=Fp(e,o,s)||{},c="function"==typeof u.jsonLogic?u.jsonLogic:function(e,t,r,n){var o=e,i=oo(t);"string"==typeof t.jsonLogic&&(o=t.jsonLogic);var a=["<","<=",">",">="],l=["==","!="];return function(e,t,s,u,c){return 0==i&&l.includes(o)?(0,L.A)({},o,[r,null]):0==i?(0,L.A)({},o,r):1==i?(0,L.A)({},o,[r,n]):2==i&&a.includes(o)?(0,L.A)({},o,[n[0],r,n[1]]):(0,L.A)({},o,[r].concat((0,I.A)(n)))}}(o,u,r,n),p=[r,o,n,no(u,eo),i,a],d=c.call.apply(c,[e.ctx].concat(p));return l&&(d={"!":d}),d};function Jp(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Xp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xp(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Xp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yp(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Zp=function(e){return"object"==(0,T.A)(e)&&null!==e&&!Array.isArray(e)},ed=function(e,t){return td(e,t,!1)},td=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=Qc(t,void 0,!1),i=rd([],e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to MongoDb:",n.errors),i)},rd=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;if(t){var s=t.get("type");return"group"===s||"rule_group"===s?nd(e,t,r,n,o,i,a,l):"rule"===s?od(e,t,r,n,o,i,a,l):void 0}},nd=function(e,t,r,n){var o,i,a,l,s,u,c,p,d=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=t.get("type"),g=t.get("properties")||new lr,v=!!g.get("not"),h=t.get("children1")||new xr,y=r.settings,m=y.canShortMongoQuery,b=y.fieldSeparator,O=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,_=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),S=O&&_,w="rule_group"===f,A=w?g.get("field"):null,F=w?g.get("operator"):null,j=F&&Fp(r,F,A)||null,E=F?null!==(o=null===(i=j)||void 0===i?void 0:i.cardinality)&&void 0!==o?o:1:void 0,k=Ku(A,r,n,S),C=(Ap(r,A)||{}).mode,x=A&&"array"===C&&E>=1,T=w&&(null==h?void 0:h.size)>0,P=(w&&null!=h&&h.size,!1),R=v,N=!1;T?(N=v,R=d):d&&(R=!R);var D=null===(a=j)||void 0===a?void 0:a.reversedOp,V=Fp(r,D,A),z=!(null!==(l=j)&&void 0!==l&&l.mongoFormatOp||null===(s=V)||void 0===s||!s.mongoFormatOp),M=!(null===(u=V)||void 0===u||!u.mongoFormatOp),q=null===(c=nc(t))||void 0===c?void 0:c.get("type");if(!!r.settings.reverseOperatorsForNot&&(!w&&R&&"rule"===q||N&&1===(null==h?void 0:h.size))&&(T?N=!N:R=!R,P=!0),R&&w&&M&&(r.settings.reverseOperatorsForNot||z)){R=!R;var W=[D,F];F=W[0],D=W[1];var B=[V,j];j=B[0],V=B[1]}var $=g.get("conjunction");$||($=al(r));var U=r.conjunctions[$];if(U){var K=U.reversedConj;R&&"or"===(null===(p=$)||void 0===p?void 0:p.toLowerCase())&&K&&!w&&r.settings.canShortMongoQuery&&r.settings.reverseOperatorsForNot&&($=K,U=r.conjunctions[$],R=!R,P=!0);var G=U.mongoConj,H=h.map((function(o){return rd([].concat((0,I.A)(e),[t]),o,r,n,P,"array"!=C,"array"==C?function(e){return"$$el".concat(b).concat(e)}:void 0)})).filter((function(e){return void 0!==e}));if(x||H.size){var J;if(1==H.size)J=H.first();else if(H.size>1){var X=H.toList().toJS();m&&"$and"==G&&(J=X.reduce((function(e,t){if(e){for(var r in t){if("$"==r[0]){e=void 0;break}if(null==e[r])e[r]=t[r];else{var n=e[r],o=t[r];if(Zp(n)||(n={$eq:n}),Zp(o)||(o={$eq:o}),Object.keys(n)[0]==Object.keys(o)[0]){e=void 0;break}e[r]=Object.assign({},n,o)}}return e}}),{})),J||(J=(0,L.A)({},G,X))}if(A)if("array"==C){var Y={$size:{$ifNull:["$"+k,[]]}},Q=J?{$size:{$ifNull:[{$filter:{input:"$"+k,as:"el",cond:J}},[]]}}:Y;J={$expr:J=rd(e,t.set("type","rule"),r,n,N,!1,(function(e){return Q}),Y)}}else J=(0,L.A)({},k,{$elemMatch:J});return R&&(J={$not:J}),J}}},od=function(e,t,r,n){var o,i,a,l,s,u,c,p=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,g=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,v=t.get("properties")||new lr,h=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,y=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),m=h&&y,b=v.get("operator"),O=v.get("operatorOptions"),_=v.get("field"),S=v.get("fieldSrc"),w=v.get("value"),A=v.get("valueSrc"),F=v.get("valueType"),j=v.get("asyncListValues");if(null!=_&&null!=b&&void 0!==w){var E=Ap(r,_),k=Fp(r,b,_),C=null===(o=k)||void 0===o?void 0:o.reversedOp,L=Fp(r,C,_),I=oo(k);if(null!==(i=k)&&void 0!==i&&i.mongoFormatOp||null!==(a=L)&&void 0!==a&&a.mongoFormatOp){var T,P=p,R=!(null!==(l=k)&&void 0!==l&&l.mongoFormatOp||null===(s=L)||void 0===s||!s.mongoFormatOp);if(null!==(u=L)&&void 0!==u&&u.mongoFormatOp&&(r.settings.reverseOperatorsForNot||R)&&P||R){var N=[C,b];b=N[0],C=N[1];var D=[L,k];k=D[0],L=D[1],P=!P}var V=!1;if("func"==S){var z=ld(n,r,_,m),M=(0,x.A)(z,2);T=M[0],V=M[1]}else T=Ku(_,r,n,m),f&&(V=!0,T=f(T));if(null!=T){var q,W=[],B=[];if(null!=w){var $=w.map((function(e,t){var o=A?A.get(t):null,i=F?F.get(t):null,a=rc(e,o,r),l=Uu(r,_,b,o),s=jp(r,_,b,l,o,{forExport:!0}),u=id(n,r,a,o,i,s,E,m,b,k,j),c=(0,x.A)(u,2),p=c[0],d=c[1];return void 0!==p&&(V=V||d,W.push(o),B.push(i)),p})),U=$.filter((function(e){return void 0===e})).size>0;if($.size<I||U)return;q=I>1?$.toArray():1==I?$.first():null}var K=V&&d,G=null===(c=k)||void 0===c?void 0:c.mongoFormatOp,H=[T,b,void 0!==g&&null==q?g:q,V,W.length>1?W:W[0],B.length>1?B:B[0],no(k,eo),O,E],J=G.call.apply(G,[r.ctx].concat(H));return K&&(J={$expr:J}),P&&(J={$not:J}),J}}else n.errors.push("Operator ".concat(b," is not supported"))}},id=function(e,t,r,n,o,i,a,l,s,u,c){if(void 0===r)return[void 0,!1];var p,d=!1;if("field"==n){var f=ad(e,t,r,l),g=(0,x.A)(f,2);p=g[0],d=g[1]}else if("func"==n){var v=ld(e,t,r,l),h=(0,x.A)(v,2);p=h[0],d=h[1]}else if("function"==typeof(null==i?void 0:i.mongoFormatValue)){var y=i.mongoFormatValue,m=[r,Qp(Qp({},a?ko()(a,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),no(i,Zn)];s&&(m.push(s),m.push(u)),p=y.call.apply(y,[t.ctx].concat(m))}else p=r;return[p,d]},ad=function(e,t,r,n){var o,i=t.settings.fieldSeparator;if(r){var a=Ap(t,r)||{},l=mp(r,t),s=Vu(r,t),u=s?s.join(i):null;o="$"+(0,t.settings.formatField)(Ku(r,t,e,n),l,u,a,t,!1)}return[o,!0]},ld=function(e,t,r,n){var o,i,a,l=null===(o=r.get)||void 0===o?void 0:o.call(r,"func"),s=null===(i=r.get)||void 0===i?void 0:i.call(r,"args"),u=gp(t,l);if(!u)return e.errors.push("Func ".concat(l," is not defined in config")),[void 0,!1];var c=mp(l,t),p=c[c.length-1],d=u.mongoFunc||p,f=u.mongoArgsAsObject,g={},v=0,h=void 0,y=[],m=[];for(var b in u.args){var O;v++;var _=u.args[b],S=Ap(t,_),w=_.defaultValue,A=_.isOptional,F=null!=w&&w.func?"func":"value",j=s?s.get(b):void 0,E=j?j.get("value"):void 0,k=j?j.get("valueSrc"):void 0;"func"!==k&&null!==(O=E)&&void 0!==O&&O.toJS&&(E=E.toJS());var C=j?j.get("asyncListValues"):void 0,I=null,T=Uu(t,_,I,k),P=jp(t,_,I,T,k,{forExport:!0}),R=id(e,t,E,k,_.type,P,S,n,null,null,C),N=(0,x.A)(R,2),D=N[0];if(N[1],null!=E&&void 0===D)return"func"!=k&&e.errors.push("Can't format value of arg ".concat(b," for func ").concat(l)),[void 0,!1];var V=void 0;if(void 0===D&&!A&&null!=w){var z=Uu(t,_,I,F),M=jp(t,_,I,z,F,{forExport:!0}),q=id(e,t,w,F,_.type,M,S,n,null,null,C),W=(0,x.A)(q,2);if(V=W[0],W[1],void 0===V)return"func"!=F&&e.errors.push("Can't format default value of arg ".concat(b," for func ").concat(l)),[void 0,!1]}var B=null!=D?D:V;if(void 0!==B){if(y.length){var $,U=Jp(y);try{for(U.s();!($=U.n()).done;)g[$.value]=void 0}catch(e){U.e(e)}finally{U.f()}y=[]}g[b]=B,h=B}else A||m.push(b),y.push(b)}if(m.length)return[void 0,!1];if("function"==typeof u.mongoFormatFunc){var K=u.mongoFormatFunc,G=[g];a=K.call.apply(K,[t.ctx].concat(G))}else{if(null===u.mongoFormatFunc)return e.errors.push("Functon ".concat(d," is not supported")),[void 0,!1];a=f?(0,L.A)({},d,g):1==v&&void 0!==h?(0,L.A)({},d,h):(0,L.A)({},d,Object.values(g))}return[a,!0]};function sd(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ud(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ud(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function ud(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var dd=function(e,t){return fd(e,t,!1)},fd=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=Qc(t,void 0,!1),i=gd(e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SQL:",n.errors),i)},gd=function(e,t,r){if(e){var n=e.get("type");return e.get("children1"),"group"===n||"rule_group"===n?vd(e,t,r):"rule"===n?hd(e,t,r):void 0}},vd=function(e,t,r){var n=e.get("type"),o=e.get("properties")||new lr,i=e.get("children1")||new xr,a="rule_group"===n?o.get("field"):null;"array"==(Ap(t,a)||{}).mode&&r.errors.push("Aggregation is not supported for ".concat(a));var l=o.get("not"),s=i.map((function(e){return gd(e,t,r)})).filter((function(e){return void 0!==e}));if(s.size){var u=o.get("conjunction");return u||(u=al(t)),t.conjunctions[u].sqlFormatConj.call(t.ctx,s,u,l)}},hd=function(e,t,r){var n=e.get("properties")||new lr,o=n.get("field"),i=n.get("fieldSrc"),a=n.get("operator"),l=n.get("operatorOptions"),s=n.get("valueSrc"),u=n.get("valueType"),c=n.get("value"),p=n.get("asyncListValues");if(null!=o&&null!=a){var d=Ap(t,o)||{},f=Fp(t,a,o)||{},g=f.reversedOp,v=Fp(t,g,o)||{},h=oo(f),y=!1,m=f.sqlOp||f.sqlFormatOp,b=v.sqlOp||v.sqlFormatOp;if(m||b){if(!m&&b){y=!0;var O=[g,a];a=O[0],g=O[1];var _=[v,f];f=_[0],v=_[1]}var S,w=[],A=[];if(null!=c){var F=c.map((function(e,n){var i=s?s.get(n):null,l=u?u.get(n):null,c=rc(e,i,t),g=Uu(t,o,a,i),v=jp(t,o,a,g,i,{forExport:!0}),h=yd(r,t,c,i,l,v,d,a,f,p);return void 0!==h&&(w.push(i),A.push(l)),h}));if(F.filter((function(e){return void 0===e})).size>0||F.size<h)return;S=1==h?F.first():F}var j=f.sqlFormatOp||function(e,t){var r,n=t.sqlOp||e,o=oo(t);return 0==o?r=function(e,t,r,o,i,a,l,s){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,i,a,l,s){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,i,a,l,s){var u,c,p=null==r||null===(u=r.first)||void 0===u?void 0:u.call(r),d=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(n," ").concat(p," AND ").concat(d)}),r}(a,f);if(j){var E="func"==i?bd(r,t,o):md(r,t,o);if(null!=E){var k,C=[E,a,S,w.length>1?w:w[0],A.length>1?A:A[0],no(f,eo),l,d];if(k=j.call.apply(j,[t.ctx].concat(C)),y&&(k=t.settings.sqlFormatReverse.call(t.ctx,k)),void 0!==k)return k;r.errors.push("Operator ".concat(a," is not supported for value source ").concat(w.join(", ")))}}else r.errors.push("Operator ".concat(a," is not supported"))}else r.errors.push("Operator ".concat(a," is not supported"))}},yd=function(e,t,r,n,o,i,a,l,s,u){if(void 0!==r){var c;if("field"==n)c=md(e,t,r);else if("func"==n)c=bd(e,t,r);else if("function"==typeof(null==i?void 0:i.sqlFormatValue)){var p=i.sqlFormatValue,d=[r,pd(pd({},ko()(a,["fieldSettings","listValues"])),{},{asyncListValues:u}),no(i,Zn)];if(l&&(d.push(l),d.push(s)),"field"==n){var f=Ap(t,r)||{};d.push(f)}c=p.call.apply(p,[t.ctx].concat(d))}else c=Array.isArray(r)?r.map((function(e){return Hi.escape(e)})):Hi.escape(r);return c}},md=function(e,t,r){if(r){var n=t.settings.fieldSeparator,o=Ap(t,r)||{},i=mp(r,t),a=Vu(r,t),l=a?a.join(n):null;return(0,t.settings.formatField)(Ku(r,t,e,null,{useTableName:!0}),i,l,o,t)}},bd=function(e,t,r){var n,o,i=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),l=gp(t,i);if(l){var s=mp(i,t),u=s[s.length-1],c=l.sqlFunc||u,p={},d=[],f=[];for(var g in l.args){var v,h=l.args[g],y=Ap(t,h),m=h.defaultValue,b=h.isOptional,O=null!=m&&m.func?"func":"value",_=a?a.get(g):void 0,S=_?_.get("value"):void 0,w=_?_.get("valueSrc"):void 0;"func"!==w&&null!==(v=S)&&void 0!==v&&v.toJS&&(S=S.toJS());var A=_?_.get("asyncListValues"):void 0,F=yd(e,t,S,w,h.type,y,h,null,null,A);if(null!=S&&void 0===F)return void("func"!=w&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(i)));var j=void 0;if(void 0===F&&!b&&null!=m&&void 0===(j=yd(e,t,m,O,h.type,y,h,null,null,A)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(i)));var E=null!=F?F:j;if(void 0!==E){if(d.length){var k,C=sd(g);try{for(C.s();!(k=C.n()).done;)p[k.value]=void 0}catch(e){C.e(e)}finally{C.f()}d=[]}p[g]=E}else b||f.push(g),d.push(g)}if(!f.length){var L;if("function"==typeof l.sqlFormatFunc){var I=l.sqlFormatFunc,T=[p];L=I.call.apply(I,[t.ctx].concat(T))}else{var P=Object.entries(p).map((function(e){var t=(0,x.A)(e,2);return t[0],t[1]})).join(", ");L="".concat(c,"(").concat(P,")")}return L}}else e.errors.push("Func ".concat(i," is not defined in config"))};function Od(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Od(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Od(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Sd(e,t,r,n,o,i){if(e&&r&&null!=t){var a=r,l=n.operators[a];if(l){var s=l.elasticSearchQueryType,u=!1;!s&&l.reversedOp&&(u=!0,a=l.reversedOp,s=(l=n.operators[a]).elasticSearchQueryType);var c=Uu(n,e,a,o),p=n.widgets[c];if(p){var d,f,g=p.elasticSearchFormatValue;if(d="function"==typeof s?s(c):s)return f="function"==typeof g?g(d,t,a,e,n):function(e,t,r,n,o,i){var a=n;switch(e){case"filter":return{script:o.operators[r].elasticSearchScript(n,t)};case"exists":return{field:n};case"match":return(0,L.A)({},a,t[0]);case"term":return i===wd?(0,L.A)({},n,{value:t[0]}):(0,L.A)({},n,t[0]);case"geo_bounding_box":return(0,L.A)({},n,function(e){if(null==e)return null;var t=e.split(",").map(Number);return{top_left:{lat:t[0],lon:t[1]},bottom_right:{lat:t[2],lon:t[3]}}}(t[0]));case"range":return(0,L.A)({},n,function(e,t){if(e.length>1)return{gte:"".concat(e[0]),lte:"".concat(e[1])};var r=e[0];switch(t){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}(t,r));case"wildcard":return(0,L.A)({},n,function(e){return{value:"*"+e+"*"}}(t[0]));case"regexp":return(0,L.A)({},n,function(e){return{value:e}}(t[0]));default:return}}(d,t,a,e,n,i),u?{bool:{must_not:(0,L.A)({},d,_d({},f))}}:(0,L.A)({},d,_d({},f))}}}}var wd="ES_7_SYNTAX",Ad="ES_6_SYNTAX";function Fd(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ad,n=Qc(t,void 0,!1);if(e){var o=e.get("type"),i=e.get("properties")||new Map;if("rule"===o&&i.get("field")){var a,l,s,u=i.get("operator"),c=i.get("field"),p=i.get("fieldSrc"),d=null===(a=i.get("value"))||void 0===a?void 0:a.toJS(),f=(null===(l=i.get("valueType"))||void 0===l||l.get(0),null===(s=i.get("valueSrc"))||void 0===s?void 0:s.get(0));if("func"===f||"func"==p)return;return d&&Array.isArray(d[0])?d[0].map((function(e){return Sd(c,[e],u,n,f,r)})):Sd(c,d,u,n,f,r)}if("group"===o||"rule_group"===o){var g=i.get("not"),v=i.get("conjunction");return v||(v=al(n)),function(e,t,r,n,o,i){if(e&&e.size){var a=e.valueSeq().toArray(),l=function(e,t){switch(e){case"AND":return t?"must_not":"must";case"OR":return t?"should_not":"should";case"NOT":return t?"must":"must_not";default:return}}(t,r),s=a.map((function(e){return n(e,o,i)})).filter((function(e){return void 0!==e}));if(s.length){var u=s.flat(1/0);return{bool:(0,L.A)({},l,u)}}}}(e.get("children1"),v,g,Fd,n,r)}}}var jd=r(5167);function Ed(e,t,r,n,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,o)}var kd=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function Cd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ld(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ld(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ld(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Id=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return function(){var n,o=(n=jo().mark((function n(o,i,a){var l,s,u,c,p,d;return jo().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=null!=(null==a?void 0:a.pageSize)?a.pageSize:t,s=zo(e).filter((function(e){var t=e.title,r=e.value;return null==o||-1!=t.toUpperCase().indexOf(o.toUpperCase())||-1!="".concat(r).toUpperCase().indexOf(o.toUpperCase())})),l&&Math.ceil(s.length/l),u=i||0,l&&Math.ceil(u/l),c=l?s.slice(u,u+l):s,p=l?u+c.length:null,d=!!l&&p<s.length,!r){n.next=11;break}return n.next=11,mo(r);case 11:return n.abrupt("return",{values:c,hasMore:d});case 12:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){Ed(i,r,o,a,l,"next",e)}function l(e){Ed(i,r,o,a,l,"throw",e)}a(void 0)}))});return function(e,t,r){return o.apply(this,arguments)}}()},Td=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return e;var o=e||[],i=t.filter((function(e){return null==o.find((function(t){return""+t.value==""+e.value}))})).map((function(e){return n?xd(xd({},e),{},{isHidden:!0}):e}));return r?[].concat((0,I.A)(i),(0,I.A)(o)):[].concat((0,I.A)(o),(0,I.A)(i))},Pd=function(e,t,r){var n,o=null==e||""==e?void 0:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:e,i=Uo(o,t),a=r&&!i?Vo(o):void 0,l=i||a;return[o,l?[l]:void 0]},Rd=function(e,t,r){var n=e.map((function(e,n){var o,i=null==e||""==e?void 0:null!==(o=null==e?void 0:e.value)&&void 0!==o?o:e,a=Uo(i,t),l=r&&!a?Vo(i):void 0;return a||l})).filter((function(e){return null!=e})),o=n.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e}));return o.length||(o=void 0),[o,n]},Nd=function(e){if(null==e)return null;var t=e.title,r=e.value,n=e.disabled,o=e.groupTitle,i=e.grouplabel,a=e.renderTitle,l=e.children,s=e.label,u=e.isCustom,c=e.isHidden,p=(0,jd.A)(e,kd),d={value:r,title:t||s||l};return n&&(d.disabled=n),u&&(d.isCustom=u),c&&(d.isHidden=c),(o||i)&&(d.groupTitle=o||i),a&&(d.renderTitle=a),xd(xd({},d),p)},Dd=function(e){var t,r=[],n=[],o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Cd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cd(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(e);try{var i=function(){var e=t.value,o=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,I.A)(e).reverse().findIndex(t);return-1==r?-1:e.length-1-r}(r,(function(t){var r,n;return(null!==(r=t.groupTitle)&&void 0!==r?r:"")==(null!==(n=e.groupTitle)&&void 0!==n?n:"")}));null==e.groupTitle||n.includes(e.groupTitle)||(n.push(e.groupTitle),1===n.length&&(r=r.map((function(e){return xd(xd({},e),{},{groupTitle:""})})))),null==e.groupTitle&&n.length&&(e=xd(xd({},e),{},{groupTitle:""})),-1!=o?r.splice(o+1,0,e):r.push(e)};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}return r},Vd={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},zd={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim,i=r+(o.charAt(0).toUpperCase()+o.slice(1)+"s");return"".concat(t,".").concat(i,"(").concat(n,")")},spelImport:function(e){var t,r,n,o,i=null===(t=e.methodName)||void 0===t?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(o=i[2].toLowerCase(),r=i[1],["minus","plus"].includes(r)&&["day","week","month","year"].includes(o)))return r={type:"string",val:r},o={type:"string",val:o},n=e.args[0],{date:e.obj,op:r,val:n,dim:o}},jsonLogic:function(e){var t=e.date,r=e.op;return{date_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]);return[t,e.date_add[1]>=0?"plus":"minus",r,e.date_add[2]]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(n)*("minus"==r?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return n?"".concat(t," ").concat("minus"==r?"-":"+"," ").concat(n," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},Md={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},qd={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Wd={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,n=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(n,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelImport:function(e){var t,r;if("op-plus"===e.type){var n=(0,x.A)(e.children,2);if(r=n[0],t=n[1],"op-multiply"===r.type){var o=(0,x.A)(r.children,2);return{coef:o[0],val:o[1],bias:t}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias;return{$sum:[{$multiply:[t,e.val]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias;return{"+":[{"*":[t,e.val]},r]}},jsonLogicImport:function(e){return[e["+"][0]["*"][0],e["+"][0]["*"][1],e["+"][1]]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},Bd={utils:{SqlString:Hi,moment:mi(),mongoFormatOp1:function(e,t,r,n,o,i,a,l,s,u,c,p){var d="string"!=typeof n||n.startsWith("$")?n:"$"+n,f=t(i,p);if(void 0!==f)return r?a||e&&"$eq"!=e?a?{$not:(0,L.A)({},e,[d,f])}:(0,L.A)({},n,{$not:(0,L.A)({},e,f)}):(0,L.A)({},n,{$ne:f}):a||e&&"$eq"!=e?a?(0,L.A)({},e,[d,f]):(0,L.A)({},n,(0,L.A)({},e,f)):(0,L.A)({},n,f)},mongoFormatOp2:function(e,t,r,n,o,i,a,l,s,u,c){var p="string"!=typeof r||r.startsWith("$")?r:"$"+r;return t?i?{$not:{$and:[(0,L.A)({},e[0],[p,o[0]]),(0,L.A)({},e[1],[p,o[1]])]}}:(0,L.A)({},r,{$not:(0,L.A)((0,L.A)({},e[0],o[0]),e[1],o[1])}):i?{$and:[(0,L.A)({},e[0],[p,o[0]]),(0,L.A)({},e[1],[p,o[1]])]}:(0,L.A)({},r,(0,L.A)((0,L.A)({},e[0],o[0]),e[1],o[1]))},mongoEmptyValue:Xi,escapeRegExp:po,sqlEmptyValue:Ji,stringifyForDisplay:ta,getTitleInListValues:qo,spelEscape:Qi,spelFixList:Yi,wrapWithBrackets:ra}};const $d=Bd;function Ud(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kd(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Hd={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,n,o,i,a,l,s){var u=l?"=":i.label;return"boolean"==o&&l?"No"==r?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(u," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,n,o,i,a,l,s){return"boolean"==o&&l?"No"==r?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(i.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(e){return e},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(e){return e},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return e},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(e){return e},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:function(e,t,r){return{in:[r,e]}},jsonLogic2:"#in",valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!0].concat(n))},jsonLogic:function(e,t,r){return{"!":{in:[r,e]}}},jsonLogic2:"#!in",_jsonLogicIsExclamationOp:!0,valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?"^"+t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e)+"$":void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,a,l){var s=r.first(),u=r.get(1);return l?"".concat(e," BETWEEN ").concat(s," AND ").concat(u):"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(u)},spelFormatOp:function(e,t,r,n,o,i,a,l){var s=r[0],u=r[1];return"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(u)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return"time"===e?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,a,l){var s=r.first(),u=r.get(1);return l?"".concat(e," NOT BETWEEN ").concat(s," AND ").concat(u):"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(u,")")},spelFormatOp:function(e,t,r,n,o,i,a,l){var s=r[0],u=r[1];return"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(u,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",jsonLogic:function(e,t,r){return{"!":{"<=":[Array.isArray(r)?r[0]:r,e,Array.isArray(r)?r[1]:r]}}},jsonLogic2:"!<=",_jsonLogicIsExclamationOp:!0,validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,a,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") = ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,a,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") <> ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,n,o,i,a,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,a,l){var s=l?"=":"==";return"".concat(e," ").concat(s," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,i,a,l){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):void 0},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e){return e},!1].concat(r))},reversedOp:"select_any_in",jsonLogic:function(e,t,r){return{"!":{in:[e,r]}}},jsonLogic2:"!in",_jsonLogicIsExclamationOp:!0},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains",jsonLogic2:"!some-in",jsonLogic:function(e,t,r){return{"!":{some:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,a,l){var s=l?"=":"==";return"value"==n?"".concat(e," ").concat(s," [").concat(r.join(", "),"]"):"".concat(e," ").concat(s," ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,a,l){var s=this;return"value"==n?"".concat(e," = '").concat(r.map((function(e){return s.utils.SqlString.trim(e)})).join(","),"'"):void 0},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,i,a,l){return"value"==n?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,a,l){var s=this;return"value"==n?"".concat(e," != '").concat(r.map((function(e){return s.utils.SqlString.trim(e)})).join(","),"'"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"multiselect_equals",jsonLogic2:"!all-in",jsonLogic:function(e,t,r){return{"!":{all:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,n,o,i,a,l){var s=r.first(),u=r.get(1),c=null==a?void 0:a.get("proximity");return"".concat(e," ").concat(s," NEAR/").concat(c," ").concat(u)},sqlFormatOp:function(e,t,r,n,o,i,a,l){var s=r.first(),u=r.get(1),c=this.utils.SqlString.trim(s),p=this.utils.SqlString.trim(u),d=null==a?void 0:a.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(c,", ").concat(p,"), ").concat(d,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return 0},!1].concat(r))}}},Jd={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return n?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=e.map((function(e){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e)}));return n?i.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){var i=this;return e.map((function(e){return i.utils.SqlString.escape(e)}))},spelFormatValue:function(e,t,r,n,o){var i=o&&o.spelOp&&o.spelOp.startsWith("${1}"),a=this.utils.spelEscape(e);return i&&(a=this.utils.spelFixList(a)),a},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(i.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD");return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o,i,a;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&null!==(n=r.fmt)&&void 0!==n&&null!==(n=n.value)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n," ")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&null!==(a=i.toLowerCase)&&void 0!==a&&a.call(i).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(i.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(i,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var n,o,i;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&r.fmt&&(null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.toLowerCase)||void 0===o||!o.call(n).includes("hh:mm")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&i.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var a=this.utils.moment(e.value,"HH:mm:ss");return a.isValid()?[a.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?60*r.get("hour")*60+60*r.get("minute")+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},elasticSearchFormatValue:function(e,t,r,n){return{script:{script:{source:"doc[".concat(n,"][0].getHour() >== params.min && doc[").concat(n,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(i.toDate())},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD HH:mm:ss");return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd HH:mm:ss","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o;if(!t)return[void 0,"No widget def to get value format"];if(null==r||null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.includes)||void 0===o||!o.call(n," "))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,this.utils.moment.ISO_8601);return i.isValid()?[i.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,n){return n?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,n,o,i,a){return n&&a.label||e},sqlFormatValue:function(e,t,r,n,o,i){return e},spelFormatValue:function(e,t,r,n,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(""===e?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return""===e?null:e}}},Xd=Gd(Gd({},Vc),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,n,o,i){var a=this,l=n.map((function(e,t){var r=e.key,n=e.parent,o=e.fieldSeparator;return 0==t?"[map]"==n?"#this[".concat(a.utils.spelEscape(r),"]"):r:"map"==n||"[map]"==n?"[".concat(a.utils.spelEscape(r),"]"):"".concat(o).concat(r)})).join("");return o.fieldName&&(l=e),o.isSpelVariable&&(l="#"+l),l},sqlFormatReverse:function(e){if(null!=e)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(null!=e)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,t,r,n,o,i){if(null!=e)return i?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,t,r,n,o,i,a,l,s,u){var c=a.labelForFormat,p=a.cardinality;if(0==p){var d=e?" HAVE ".concat(e):"";return"".concat(c," OF ").concat(t).concat(d)}if(null==p||1==p){var f=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(f," ").concat(c," ").concat(n)}if(2==p){var g=e?" WHERE ".concat(e):"",v=n.first(),h=n.get(1);return"COUNT OF ".concat(t).concat(g," ").concat(c," ").concat(v," AND ").concat(h)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,n){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),Yd=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={rangeslider:ef,treeselect:tf,treemultiselect:rf,rangeable__date:Zd("date","date")},i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ud(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ud(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,l=o[a];if(!l)throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(a));e=l(e,n)}}catch(e){i.e(e)}finally{i.f()}return e},Qd=function(e,t){return Yd(e,t,!0)},Zd=function(e,t){return function(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.types;return o=Gd(Gd({},o),{},(0,L.A)({},e,Gd(Gd({},o[e]),{},{widgets:Gd({},o[e].widgets)}))),n?o[e].widgets[t]=Gd({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],Gd(Gd({},r),{},{types:o})}},ef=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Gd({},r),t?r.rangeslider=Gd({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},singleWidget:"slider",toJS:function(e,t){return e}},r.rangeslider):delete r.rangeslider,n=Gd(Gd({},n),{},{number:Gd(Gd({},n.number),{},{widgets:Gd({},n.number.widgets)})}),t?n.number.widgets.rangeslider=Gd({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},n.number.widgets.rangeslider):delete n.number.widgets.rangeslider,Gd(Gd({},e),{},{widgets:r,types:n})},tf=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Gd({},r),t?r.treeselect=Gd({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,i=this.utils.getTitleInListValues(o,e);return n?this.utils.stringifyForDisplay(i):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treeselect):delete r.treeselect,n=Gd({},n),t?n.treeselect=Gd({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},n.treeselect):delete n.treeselect,Gd(Gd({},e),{},{widgets:r,types:n})},rf=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Gd({},r),t?r.treemultiselect=Gd({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,a=e.map((function(e){return o.utils.getTitleInListValues(i,e)}));return n?a.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){var i=this;return e.map((function(e){return i.utils.SqlString.escape(e)}))},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treemultiselect):delete r.treemultiselect,n=Gd({},n),t?n.treemultiselect=Gd({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},n.treemultiselect):delete n.treemultiselect,Gd(Gd({},e),{},{widgets:r,types:n})},nf={addMixins:Qd,removeMixins:function(e,t){return Yd(e,t,!1)}},of={conjunctions:{AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,n){var o=e.size>1?e.join(" "+(n?"AND":"&&")+" "):e.first();return(e.size>1||r)&&(o=this.utils.wrapWithBrackets(o)),r&&(o="NOT "+o),o},sqlFormatConj:function(e,t,r){var n=e.size>1?e.join(" AND "):e.first();return(e.size>1||r)&&(n=this.utils.wrapWithBrackets(n)),r&&(n="NOT "+n),n},spelFormatConj:function(e,t,r,n){r&&(n=!1);var o=e.size>1?e.join(" && "):e.first();return(e.size>1||r)&&!n&&(o=this.utils.wrapWithBrackets(o)),r&&(o="!"+o),o}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" || ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},operators:Hd,widgets:Jd,types:{text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},settings:Xd,ctx:$d};const af=of=Qd(of,["rangeslider","treeselect","treemultiselect"]);var lf="ADD_GROUP",sf="ADD_CASE_GROUP",uf="REMOVE_GROUP",cf="SET_CONJUNCTION",pf="SET_NOT",df="ADD_RULE",ff="REMOVE_RULE",gf="SET_FIELD",vf="SET_FIELD_SRC",hf="SET_OPERATOR",yf="SET_VALUE",mf="SET_VALUE_SRC",bf="SET_FUNC_VALUE",Of="SET_OPERATOR_OPTION",_f="SET_LOCK",Sf="SET_TREE",wf="MOVE_ITEM",Af="after",Ff="before",jf="append",Ef="prepend",kf="SET_DRAG_PROGRESS",Cf="SET_DRAG_START",Lf="SET_DRAG_END",xf=r(1612),If=r.n(xf);function Tf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tf(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Rf(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Nf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nf(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}function Nf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Df=function(e,t,r,n,o,i){var a,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(Ko(t)))return e;var u=(null==o||null===(a=o.get)||void 0===a?void 0:a.call(o,"id"))||n,c=i.settings.shouldCreateEmptyGroup,p=t.push(u),d=!c,f=!(null==s||!s.isDefaultCase),g=e;return(e=Vf(e,t,r,u,ll(i).merge(Kn(o)||{}),i,l))!==g&&(l||f||(e=e.setIn(Ko(p,"children1"),new Jn.OrderedMap),d&&(e=Vf(e,p,"rule",Yn(),ol(i,null==s?void 0:s.parentRuleGroupField),i))),e=Yo(e)),e},Vf=function(e,t,r,n,o,i){var a,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("switch_group"===r)throw new Error("Can't add switch_group programmatically");if(!e.getIn(Ko(t)))return e;var s,u,c=(null==o||null===(a=o.get)||void 0===a?void 0:a.call(o,"id"))||n,p=i.settings,d=p.maxNumberOfCases,f=p.maxNumberOfRules,g=p.maxNesting,v="switch_group"===e.get("type"),h=v?e.getIn(Ko(t.take(2))):null,y=Ko(t,"children1"),m=e.getIn(y),b=!!m&&m.size,O=b?m.size:null;if("case_group"===r)s=O,u=d;else if("group"===r){var _=Jo(e,t);if(_.length){var S=_[0],w=S.path,A=S.field,F=Ap(i,A);s=t.size-w.length,u=null==F?void 0:F.maxNesting}else s=t.size,u=g}else{var j=Jo(e,t);if(j.length){var E=j[0],k=E.path,C=E.field,x=Ap(i,C),I=Ho(e,k);u=null==x?void 0:x.maxNumberOfRules,s=ti(I)}else s=ti(v?h:e),u=f}var T=!u||!s||s<u,P={type:r,id:c,properties:o};Bf(i,P,l);var R="case_group"===r&&b&&null==m.last().get("children1");if(T){var N=new Jn.OrderedMap((0,L.A)({},c,new Jn.Map(P)));if(b)if(R){var D=m.last(),V=new Jn.OrderedMap((0,L.A)((0,L.A)({},c,new Jn.Map(P)),D.get("id"),D));e=(e=e.deleteIn(Ko(y,"children1",D.get("id")))).mergeIn(y,V)}else e=e.mergeIn(y,N);else e=e.setIn(y,N);e=Yo(e)}return e},zf=function(e,t){return e=e.deleteIn(Ko(t)),Yo(e)},Mf=function(e,t,r,n,o){var i,a,l,s,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=e.getIn(Ko(t));if(!c)return{state:e};var p=u.isEndValue,d=u.canDropArgs;if(!r)return{state:e=zf(e,t)};var f=n.settings,g=f.fieldSeparator,v=f.setOpOnChangeField,h=f.showErrorMessage;Array.isArray(r)&&(r=r.join(g));var y=c.get("type"),m=c.get("properties"),b="rule_group"==y,O=null==m?void 0:m.get("fieldSrc"),_=Ap(n,r);if(!_)return console.warn("No config for LHS ".concat(r)),{state:e};var S=_.type;"!group"!==S&&"!struct"!==S||(S=null);var w=null==m?void 0:m.get("operator"),A=null==m?void 0:m.get("operatorOptions"),F=null==m?void 0:m.get("field"),j="!group"==_.type,E=j&&"array"==_.mode,k=b!=j,C=_&&-1!==(null===(i=_.operators)||void 0===i?void 0:i.indexOf(w))?w:null,L="func"===O&&(null==F||null===(a=F.get)||void 0===a?void 0:a.call(F,"func"))===(null===(l=r)||void 0===l||null===(s=l.get)||void 0===s?void 0:s.call(l,"func"))&&!!C,x=null,I="func"===O?Tu(n,S):Pu(n,r);if(I&&1==I.length)x=I[0];else if(L)x=C;else if(I&&I.length>1){var T,P=Rf(v);try{for(P.s();!(T=P.n()).done;){var R=T.value;if("keep"!=R||k?"default"==R?x=rl(n,r,!1):"first"==R&&(x=Ru(n,r)):x=C,x)break}}catch(e){P.e(e)}finally{P.f()}}if(!j&&!_.operators)return console.warn("Type ".concat(_.type," is not supported")),{state:e};b&&!j&&(e=(e=(e=e.setIn(Ko(t,"type"),"rule")).deleteIn(Ko(t,"children1"))).setIn(Ko(t,"properties"),new Jn.OrderedMap)),m||(e=e.setIn(Ko(t,"properties"),new Jn.OrderedMap));var N=!h;if(j){e=e.setIn(Ko(t,"type"),"rule_group");var D=Su(n,n,m,r,x,"field",N,p,d),V=(D.canReuseValue,D.newValue),z=D.newValueSrc,M=D.newValueType,q=D.operatorCardinality,W=ll(n,_,r).merge({field:r,fieldSrc:"field",mode:_.mode});E&&(W=W.merge({operator:x,value:V,valueSrc:z,valueType:M})),e=(e=e.setIn(Ko(t,"children1"),new Jn.OrderedMap)).setIn(Ko(t,"properties"),W),_.initialEmptyWhere&&1==q||(e=Vf(e,t,"rule",Yn(),ol(n,r),n)),e=Yo(e)}else e=e.updateIn(Ko(t,"properties"),(function(e){return e.withMutations((function(e){var t=Su(n,n,e,r,x,"field",N,p,d),o=t.canReuseValue,i=t.newValue,a=t.newValueSrc,l=t.newValueType,s=t.newValueError,u=t.newFieldError,c=t.fixedField,f=r;c!==r&&(f=c),h&&(e=(e=e.set("fieldError",u)).set("valueError",s));var g=o?A:nl(n,x,f);return e=e.set("field",f).delete("fieldType").set("fieldSrc",O).set("operator",x).set("operatorOptions",g).set("value",i).set("valueSrc",a).set("valueType",l),o||(e=e.delete("asyncListValues")),e}))}));return{state:e}},qf=function(e,t,r,n,o,i,a){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(Ko(t)))return{state:e};var s=l.canDropArgs,u=l.isEndValue,c=i.settings,p=c.fieldSeparator,d=c.showErrorMessage,f=e.getIn(Ko(t,"properties","valueSrc",r+""))||null;"field"===f&&Array.isArray(n)&&(n=n.join(p));var g=e.getIn(Ko(t,"properties","field"))||null,v=e.getIn(Ko(t,"properties","operator"))||null,h=Fp(i,v,g),y=v?oo(h):null,m=o||Nu(n,f,i),b=yu(i,g,g,v,n,m,f,a,!d,u,s),O=(0,x.A)(b,2),_=O[0],S=O[1],w=null==S?void 0:S.find((function(e){return!e.fixed&&!e.ignore})),A=w?tu(w):null,F=_!==n;F&&(n=_),e=Wf(e,t,i,y);var j=Array.from({length:y},(function(o,i){return i==r?n:e.getIn(Ko(t,"properties","value",i+""))||null})),E=Array.from({length:y},(function(r,n){return e.getIn(Ko(t,"properties","valueSrc",n+""))||null})),k=_u(i,g,v,j,E),C=k?tu(k):null;return(!!d||!A&&!C||F)&&(e=e.deleteIn(Ko(t,"properties","asyncListValues")),void 0===n?e=(e=e.setIn(Ko(t,"properties","value",r),void 0)).setIn(Ko(t,"properties","valueType",r),null):(a&&(e=e.setIn(Ko(t,"properties","asyncListValues"),a)),e=(e=e.setIn(Ko(t,"properties","value",r),n)).setIn(Ko(t,"properties","valueType",r),m))),d&&(e.getIn(Ko(t,"properties","valueError"))||(e=e.setIn(Ko(t,"properties","valueError"),new Jn.List(new Array(y)))),e=e.setIn(Ko(t,"properties","valueError",r),A),y>=2&&(e=e.setIn(Ko(t,"properties","valueError",y),C))),{state:e}},Wf=function(e,t,r,n){if(!n){var o=e.getIn(Ko(t,"properties","field"))||null,i=e.getIn(Ko(t,"properties","operator"))||null,a=Fp(r,i,o);n=i?oo(a):null}for(var l=0,s=["value","valueType","valueError","valueSrc"];l<s.length;l++){var u=s[l];e.getIn(Ko(t,"properties",u))||(e=e.setIn(Ko(t,"properties",u),new Jn.List(n?Array.from({length:n}):[])))}return e},Bf=function e(t,r,n){n&&Array.isArray(n)&&(r.children1=new Jn.OrderedMap(n.reduce((function(r,n){var o,i=null!==(o=n.id)&&void 0!==o?o:Yn(),a=Pf(Pf({},n),{},{properties:sl(t,n).merge(Kn(n.properties)||{}),id:i});return e(t,a,a.children1),Pf(Pf({},r),{},(0,L.A)({},i,new Jn.Map(a)))}),{})))},$f={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},Uf=function(e,t){return{type:Sf,tree:t,config:e}},Kf=function(e,t,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return{type:df,ruleType:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rule",children:arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,path:uo(t),id:Yn(),properties:ol(e,n).merge(Kn(r)||{}),config:e,meta:{parentRuleGroupField:n}}},Gf=function(e,t){return{type:ff,path:uo(t),config:e}},Hf=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:sf,path:uo(t),children:n,id:Yn(),properties:ll(e).merge(Kn(r)||{}),config:e,meta:{isDefaultCase:!0}}},Jf=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:sf,path:uo(t),children:n,id:Yn(),properties:ll(e).merge(Kn(r)||{}),config:e}},Xf=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return{type:lf,path:uo(t),children:n,id:Yn(),properties:ll(e,o).merge(Kn(r)||{}),config:e,meta:{parentRuleGroupField:o}}},Yf=function(e,t){return{type:uf,path:uo(t),config:e}},Qf=function(e,t,r,n){return{type:wf,fromPath:uo(t),toPath:uo(r),placement:n,config:e}},Zf=function(e,t,r){return{type:cf,path:uo(t),conjunction:r}},eg=function(e,t,r){return{type:pf,path:uo(t),not:r}},tg=function(e,t,r){return{type:_f,path:uo(t),lock:r}},rg=function(e,t,r,n,o){return{type:gf,path:uo(t),field:r,config:e,asyncListValues:n,_meta:o}},ng=function(e,t,r){return{type:vf,path:uo(t),srcKey:r,config:e}},og=function(e,t,r){return{type:hf,path:uo(t),operator:r,config:e}},ig=function(e,t,r,n,o,i,a){return{type:yf,path:uo(t),delta:r,value:n,valueType:o,asyncListValues:i,config:e,_meta:a}},ag=function(e,t,r,n,o){return{type:mf,path:uo(t),delta:r,srcKey:n,config:e,_meta:o}},lg=function(e,t,r,n,o,i,a,l,s){return{type:bf,path:uo(t),delta:r,parentFuncs:n,argKey:o,value:i,valueType:a,asyncListValues:l,config:e,_meta:s}},sg=function(e,t,r,n){return{type:Of,path:uo(t),name:r,value:n,config:e}};function ug(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function cg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ug(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ug(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var pg=cg(cg(cg({},v),{},{Export:f,Import:l,ConfigMixins:nf},f),l),dg=r(7028),fg=r.n(dg);const gg=function(e,t,r,n,o){var i=Pf({tree:t},$f);return function(){var t,a,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,s=arguments.length>1?arguments[1]:void 0,u=null!==(t=null!==(a=null==o?void 0:o())&&void 0!==a?a:null==s?void 0:s.config)&&void 0!==t?t:e,c={},p=function(e,t){if(!e||!e.type)return null;var r,n=[Sf,Cf,kf,Lf],o=If()(Io()(e,["config","asyncListValues"]),co),i=e.path&&function(e,t){return e.getIn(Ko(t,"properties","field"))||null}(t.tree,e.path)||e.field;return i&&(null!==(r=i)&&void 0!==r&&r.toJS&&(i=i.toJS()),o.affectedField=i),(n.includes(e.type)||0==e.type.indexOf("@@redux"))&&(o=null),o}(s,l);switch(null==s?void 0:s.type){case Sf:var d=r(u,s.tree);c.tree=d;break;case sf:c.tree=Df(l.tree,s.path,"case_group",s.id,s.properties,u,s.children,s.meta);break;case lf:c.tree=Df(l.tree,s.path,"group",s.id,s.properties,u,s.children,s.meta);break;case uf:c.tree=function(e,t,r){if(!e.getIn(Ko(t)))return e;e=zf(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1);return ii(e,o)||n||(e=Qo(e),!oi(e)||n)||(e=Vf(e,new Jn.List,"rule",Yn(),ol(r,void 0,void 0,!1,!1),r)),Yo(e)}(l.tree,s.path,u);break;case df:c.tree=Vf(l.tree,s.path,s.ruleType,s.id,s.properties,u,s.children);break;case ff:c.tree=function(e,t,r){if(!e.getIn(Ko(t)))return e;e=zf(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.pop(),i=e.getIn(Ko(o)),a=i.getIn(["properties","field"]),l=i.getIn(["properties","operator"]),s=a?Ap(r,a):null,u=l?Fp(r,l,a):null,c=a&&l&&0!=u.cardinality,p="rule_group"==i.get("type"),d=!ii(e,o),f=p?c&&s.initialEmptyWhere:n;return d&&!f&&(p&&(e=e.deleteIn(Ko(o))),e=Qo(e),oi(e)&&!n)&&(e=Vf(e,new Jn.List,"rule",Yn(),ol(r,void 0,void 0,!1,!1),r)),Yo(e)}(l.tree,s.path,u);break;case cf:c.tree=function(e,t,r){return e.getIn(Ko(t))?e=e.setIn(Ko(t,"properties","conjunction"),r):e}(l.tree,s.path,s.conjunction);break;case pf:c.tree=function(e,t,r){return e.getIn(Ko(t))?e=e.setIn(Ko(t,"properties","not"),r):e}(l.tree,s.path,s.not);break;case gf:var f=Mf(l.tree,s.path,s.field,u,s.asyncListValues,s._meta).state;c.tree=f;break;case vf:c.tree=function(e,t,r,n){var o=e.getIn(Ko(t));if(!o)return e;var i=n.settings.keepInputOnChangeFieldSrc,a=o.get("properties"),l=null==a?void 0:a.get("field"),s=null==a?void 0:a.get("fieldType"),u=Ap(n,l),c=(null==u?void 0:u.type)||s;c&&"!group"!==c&&"!struct"!==c||(c=null);var p=!Iu.includes(c);return(e=i&&!Gu(o,n)&&p?(e=(e=e.setIn(Ko(t,"properties","field"),null)).deleteIn(Ko(t,"properties","fieldError"))).setIn(Ko(t,"properties","fieldType"),c):e.setIn(Ko(t,"properties"),ol(n,null,null,!1))).setIn(Ko(t,"properties","fieldSrc"),r)}(l.tree,s.path,s.srcKey,u);break;case _f:c.tree=function(e,t,r){return e.getIn(Ko(t))?e=Xo(e.setIn(Ko(t,"properties","isLocked"),r)):e}(l.tree,s.path,s.lock);break;case hf:c.tree=function(e,t,r,n){var o=e.getIn(Ko(t));if(!o)return e;var i=n.settings.showErrorMessage,a=o.get("properties"),l=o.get("children1"),s=a.get("field"),u=(a.get("fieldSrc"),Ap(n,s)),c="!group"==(null==u?void 0:u.type),p=Fp(n,r,s),d=p?oo(p):null;return e=e.updateIn(Ko(t,"properties"),(function(e){return e.withMutations((function(e){var t=e.get("field"),o=e.get("operatorOptions"),a=(e.get("value",new Jn.List),e.get("valueSrc",new Jn.List),e.get("operator"),Su(n,n,e,t,r,"operator",!0)),l=a.canReuseValue,s=a.newValue,u=a.newValueSrc,c=a.newValueType,p=a.newValueError;i&&(e=e.set("valueError",p));var d=l?o:nl(n,r,t);return l||(e=e.delete("asyncListValues")),e.set("operator",r).set("operatorOptions",d).set("value",s).set("valueSrc",u).set("valueType",c)}))})),c&&0==d&&0==l.size&&(e=Vf(e,t,"rule",Yn(),ol(n,s),n)),e}(l.tree,s.path,s.operator,u);break;case yf:var g=qf(l.tree,s.path,s.delta,s.value,s.valueType,u,s.asyncListValues,s._meta).state;c.tree=g;break;case bf:var v=function(e,t,r,n,o,i,a,l,s){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:{},c=t.getIn(Ko(r));if(!c)return t;var p,d=-1===n,f=c.get("properties"),g=f.get("field"),v=f.get("value"),h=[],y=d?g:v.getIn([n]),m=Rf(o||[]);try{for(m.s();!(p=m.n()).done;){var b=(0,x.A)(p.value,2),O=b[0],_=b[1];if(h.push([O,_,y]),O!==y.get("func")){var S=h.map((function(e){var t=(0,x.A)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")||"root";throw new Error("In ".concat(d?"LHS":"RHS"," for path ").concat(S," expected func key ").concat(O," but got ").concat(parent.get("func")))}y=y.getIn(["args",_,"value"])}}catch(e){m.e(e)}finally{m.f()}if(i){var w=y.get("func"),A=gp(e,w).args[i];y="!valueSrc"===l?Lu(y,i,a,A,e):Cu(y,i,a,A,e)}else y=Fu(y,a,e,!0),u.canDropArgs=!0;for(var F=y;h.length;){var j=h.pop(),E=(0,x.A)(j,3),k=E[0],C=E[1],L=E[2],I=gp(e,k).args[C];F=Cu(L,C,F,I,e)}return d?Mf(t,r,F,e,s,u):qf(t,r,n,F,void 0,e,s,u)}(u,l.tree,s.path,s.delta,s.parentFuncs,s.argKey,s.value,s.valueType,s.asyncListValues,s._meta),h=v.state;c.tree=h;break;case mf:c.tree=function(e,t,r,n,o){if(!e.getIn(Ko(t)))return e;var i=o.settings.showErrorMessage,a=e.getIn(Ko(t,"properties","field"))||null,l=e.getIn(Ko(t,"properties","operator"))||null,s=Fp(o,l,a),u=l?oo(s):null;if(e=(e=(e=(e=Wf(e,t,o,u)).setIn(Ko(t,"properties","value",r+""),void 0)).setIn(Ko(t,"properties","valueType",r+""),null)).deleteIn(Ko(t,"properties","asyncListValues")),i&&(e=e.setIn(Ko(t,"properties","valueError",r),null),s.validateValues&&(e=e.setIn(Ko(t,"properties","valueError",u),null))),e=void 0===n?e.setIn(Ko(t,"properties","valueSrc",r+""),null):e.setIn(Ko(t,"properties","valueSrc",r+""),n),n){var c=e.getIn(Ko(t,"properties")),p=Su(o,o,c,a,l,"valueSrc",!0),d=p.canReuseValue,f=p.newValue,g=p.newValueSrc,v=p.newValueType;p.newValueError,d||g.get(r)!=n||(e=(e=e.setIn(Ko(t,"properties","value",r+""),f.get(r))).setIn(Ko(t,"properties","valueType",r+""),v.get(r)))}return e}(l.tree,s.path,s.delta,s.srcKey,u,s._meta);break;case Of:c.tree=function(e,t,r,n){return e.getIn(Ko(t))?e.setIn(Ko(t,"properties","operatorOptions",r),n):e}(l.tree,s.path,s.name,s.value);break;case wf:c.tree=function(e,t,r,n){var o=Ho(e,t),i=t.pop(),a=t.size>1?Ho(e,i):null,l=a?a.get("children1"):null,s=Ho(e,r),u=n==jf||n==Ef?r:r.pop(),c=n==jf||n==Ef?s:r.size>1?Ho(e,u):null,p=c?c.get("children1"):null;if(!a||!c||!o)return e;var d=a.get("id")==c.get("id"),f=u.size<i.size&&io(u.toArray(),i.toArray().slice(0,u.size)),g=u.size>i.size&&io(i.toArray(),u.toArray().slice(0,i.size)),v=null,h=null;f?v=Jn.List(i.toArray().slice(u.size)):g&&(h=Jn.List(u.toArray().slice(i.size)));var y=p,m=l;return g||(m=m.delete(o.get("id"))),d?y=m:f&&(y=y.updateIn(Go(v,"children1"),(function(e){return m}))),n==Ff||n==Af?y=Jn.OrderedMap().withMutations((function(e){var t,r=Rf(y.entries());try{for(r.s();!(t=r.n()).done;){var i=(0,x.A)(t.value,2),a=i[0],l=i[1];a==(null==s?void 0:s.get("id"))&&n==Ff&&e.set(o.get("id"),o),e.set(a,l),a==(null==s?void 0:s.get("id"))&&n==Af&&e.set(o.get("id"),o)}}catch(e){r.e(e)}finally{r.f()}})):n==jf?y=y.merge(Jn.OrderedMap((0,L.A)({},o.get("id"),o))):n==Ef&&(y=Jn.OrderedMap((0,L.A)({},o.get("id"),o)).merge(y)),g&&(m=(m=m.updateIn(Go(h,"children1"),(function(e){return y}))).delete(o.get("id"))),d||f||(e=e.updateIn(Ko(i,"children1"),(function(e){return m}))),g||(e=e.updateIn(Ko(u,"children1"),(function(e){return y}))),Yo(e)}(l.tree,s.fromPath,s.toPath,s.placement);break;case Cf:c.dragStart=s.dragStart,c.dragging=s.dragging,c.mousePos=s.mousePos;break;case kf:c.mousePos=s.mousePos,c.dragging=s.dragging;break;case Lf:c.tree=function(e,t){return t.settings.canLeaveEmptyGroup||(e=Qo(e)),e}(l.tree,u),c=Pf(Pf({},c),$f)}return p&&(c.__lastAction=p),n&&c.tree&&l.tree&&n(l.tree),Pf(Pf(Pf({},l),{__lastAction:void 0}),c)}},vg=C().createContext();var hg=r(7694),yg=r(200),mg="after",bg="before",Og="append",_g="prepend",Sg=function(e,t){return{type:"SET_DRAG_PROGRESS",mousePos:e,dragging:t}},wg=function(e,t,r){return{type:"SET_DRAG_START",dragStart:e,dragging:t,mousePos:r}},Ag=function(){return{type:"SET_DRAG_END"}},Fg=y,jg=m,Eg=b,kg=function(e,t,r){if(!t||!e||e.length<=t)return e;var n=e.substr(0,t-1);return(r?n.substr(0,n.lastIndexOf(" ")):n)+"..."},Cg=function(e,t){return e===t||(null==e?void 0:e.equals(t))},Lg=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?Lg(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):e&&"function"==typeof e.equals?e.equals(t):"object"===(0,T.A)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var a=0;a<i;a++){var l=n[a];if(!(r?Lg(e[l],t[l],r):e[l]===t[l]))return!1}return!0}(e,t,r):e===t)},xg=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(null!=e?e:("undefined"!=typeof process&&process.env,0))?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}}(),Ig=pg.Validation.validateAndFixTree,Tg=function e(t){if(t){var r,n=(r=t)._reactRootContainer?"root":Object.getOwnPropertyNames(r).filter((function(e){return e.startsWith("__reactContainer")})).length>0?"container":void 0;return void 0!==n?n:e(t.parentNode)}},Pg=function(e){return"root"===Tg(e)},Rg=function(e,t){return function(r,n){var o=e.props,i=e.state,a=r!=o||n!=i;if(a&&i==n&&o!=r){var l=[];for(var s in r){var u=r[s]!=o[s];u&&("ignore"==t[s]?u=!1:"shallow_deep"==t[s]?u=!Lg(r[s],o[s],!0):"shallow"==t[s]?u=!Lg(r[s],o[s]):"function"==typeof t[s]&&(u=t[s](r[s],o[s],r,o))),u&&l.push(s)}l.length||(a=!1)}return a}},Ng=function(e){return function(t,r){return!Lg(e.props,t)||!Lg(e.state,r)}},Dg=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=Ng(e)),16==(r=C().version.split(".").map(parseInt.bind(null,10)))[0]&&r[1]<3||r[0]<16)e.componentWillReceiveProps=function(t){e.onPropsChanged(t)};else{var t=e.shouldComponentUpdate;e.shouldComponentUpdate=function(r,n){return!Lg(e.props,r)&&e.onPropsChanged(r),t.call(e,r,n)}.bind(e)}var r},Vg=function(e,t,r){return If()(e,(function(e){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r(e.apply(void 0,[t].concat(o)))}}))};function zg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zg(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(qg=function(){return!!e})()}var Wg=function(e){function t(e){var r,n,o,i;(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,qg()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).shouldComponentUpdate=Rg(r,{tree:function(e){return e!==r.oldValidatedTree||r.oldValidatedTree!==r.validatedTree}}),Dg(r),r._updateActions(e),r.validatedTree=e.getMemoizedTree(e.config,e.tree,void 0,e.sanitizeTree),r.oldValidatedTree=r.validatedTree;var a=e.getBasicConfig(e.config);return e.onInit&&e.onInit(r.validatedTree,a,void 0,r.actions),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"_updateActions",value:function(e){var t=e.config,r=e.dispatch;this.actions=Vg(Mg(Mg(Mg({},Fg),jg),Eg),t,r)}},{key:"onPropsChanged",value:function(e){var t=e.onChange,r=this.props.config,n=e.tree,o=(this.props.tree,e.config);if(this.oldValidatedTree=this.validatedTree,this.validatedTree=n,r!==o&&(this._updateActions(e),this.validatedTree=e.getMemoizedTree(o,n,r)),!Cg(this.validatedTree,this.oldValidatedTree)){var i=e.getBasicConfig(o);t&&t(this.validatedTree,i,e.__lastAction,this.actions)}}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.renderBuilder,n=e.dispatch;return r({tree:this.validatedTree,actions:this.actions,config:t,dispatch:n})}}])}(k.Component);Wg.propTypes={config:fg().object.isRequired,onChange:fg().func,onInit:fg().func,renderBuilder:fg().func,tree:fg().any};var Bg=(0,yg.connect)((function(e){return{tree:e.tree,__lastAction:e.__lastAction}}),null,null,{context:vg})(Wg);Bg.displayName="ConnectedQuery";const $g=Bg;function Ug(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ug=function(){return!!e})()}var Kg=pg.DefaultUtils.defaultRoot,Gg=pg.ConfigUtils.createConfigMemo,Hg=function(e){function t(e,r){var n,o,i,a,l,s;(0,w.A)(this,t),a=this,l=t,s=[e,r],l=(0,j.A)(l),(i=(0,F.A)(a,Ug()?Reflect.construct(l,s||[],(0,j.A)(a).constructor):l.apply(a,s))).setLastTree=function(e){i.prevTree&&(i.prevprevTree=i.prevTree),i.prevTree=e},i.getConfig=function(){return i.config},i.shouldComponentUpdate=Rg(i,{value:function(e,t){return!1}}),Dg(i);var u=Gg({reactIndex:null!==(n=null===(o=i._reactInternals)||void 0===o?void 0:o.index)&&void 0!==n?n:-1,maxSize:2,canCompile:!0}),c=u.getExtendedConfig,p=u.getBasicConfig,d=u.clearConfigMemo;i.getMemoizedConfig=c,i.getBasicConfig=p,i.clearConfigMemo=d,i.getMemoizedTree=function(){var e,t,r;return function(n,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return o?n.__configId===r&&(Cg(o,e)||Cg(o,t))?t:(r=n.__configId,e=o,t=!1===a?Ig(o,null,n,i||n,!1,!1,!1):Ig(o,null,n,i||n)):null}}();var f=i.getMemoizedConfig(e),g=f.settings.shouldCreateEmptyGroup,v=Kg(f,!g),h=!!e.value,y=e.value||v,m=i.getMemoizedTree(f,y,void 0,h),b=gg(f,m,i.getMemoizedTree,i.setLastTree,i.getConfig),O=(0,hg.createStore)(b);return i.config=f,i.state={store:O},i.QueryWrapper=function(e){return f.settings.renderProvider(e,f.ctx)},i}return(0,E.A)(t,e),(0,A.A)(t,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(e){var t=this.props,r=this.config,n=this.getMemoizedConfig(e),o=r!==n,i=this.state.store.getState().tree,a=!Cg(e.value,this.props.value)&&!Cg(e.value,i),l=a?e.value||Kg(e):i,s=a&&!Cg(e.value,this.prevTree)&&!Cg(e.value,this.prevprevTree);if(this.sanitizeTree=s||o,o&&(t.settings.renderProvider!==e.settings.renderProvider&&(this.QueryWrapper=function(e){return n.settings.renderProvider(e,n.ctx)}),this.config=n),a||o){var u=this.getMemoizedTree(n,l,r,this.sanitizeTree);this.state.store.dispatch(Fg.setTree(n,u))}}},{key:"render",value:function(){var e=this.props,t=e.renderBuilder,r=e.get_children,n=e.onChange,o=e.onInit,i=this.state.store,a=this.config,l=this.QueryWrapper;return C().createElement(l,{config:a},C().createElement(yg.Provider,{store:i,context:vg},C().createElement($g,{config:a,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:n,onInit:o,renderBuilder:t||r})))}}])}(k.Component);Hg.propTypes={conjunctions:fg().object.isRequired,fields:fg().object.isRequired,types:fg().object.isRequired,operators:fg().object.isRequired,widgets:fg().object.isRequired,settings:fg().object.isRequired,ctx:fg().object.isRequired,onChange:fg().func,onInit:fg().func,renderBuilder:fg().func,value:fg().any};var Jg=r(1858),Xg=r(2584),Yg=r.n(Xg);function Qg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Qg=function(){return!!e})()}var Zg=pg.ConfigUtils.getFieldConfig;function ev(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ev=function(){return!!e})()}var tv=pg.clone,rv=pg.TreeUtils.getFlatTree,nv=!1,ov=["isDraggingTempo","isDraggingMe","dragging"];function iv(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(iv=function(){return!!e})()}const av=function(e){return function(t){var r;return r=function(r){function n(e){var t,r,o,i;return(0,w.A)(this,n),r=this,o=n,i=[e],o=(0,j.A)(o),(t=(0,F.A)(r,iv()?Reflect.construct(o,i||[],(0,j.A)(r).constructor):o.apply(r,i))).handleDraggerMouseDown=function(e){var r=t.props.id,n=t.wrapper.current;t.props.onDragStart&&t.props.onDragStart(r,n,e)},t.wrapper=C().createRef(),t}return(0,E.A)(n,r),(0,A.A)(n,[{key:"render",value:function(){var r=this.props,n=r.isDraggingTempo,o=r.isDraggingMe,i=r.dragging,a=(0,jd.A)(r,ov),l=a.isTrueLocked,s={};o&&n&&(nv||(s={top:i.y,left:i.x,width:i.w}));var u=Yg()(e,"group-or-rule",o&&n?"qb-draggable":null,o&&!n?"qb-placeholder":null,l?"locked":null);return C().createElement("div",{className:u,style:s,ref:this.wrapper,"data-id":this.props.id},C().createElement(t,(0,Jg.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:o,isDraggingTempo:n},a)))}}])}(k.PureComponent),r.propTypes={isDraggingTempo:fg().bool,isDraggingMe:fg().bool,onDragStart:fg().func,dragging:fg().object,isLocked:fg().bool,isTrueLocked:fg().bool},r}};var lv=r(3790),sv=r.n(lv),uv=r(350),cv=r.n(uv);function pv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dv(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dv=function(){return!!e})()}var fv=pg.ConfigUtils,gv=fv.getFieldConfig,vv=fv.getOperatorConfig,hv=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,dv()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).shouldComponentUpdate=Rg(r,{selectedField:function(e,t){return!1}}),Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.selectedField,o=e.selectedFieldType,i=e.selectedOperator,a=gv(r,n),l=(0,I.A)((null==a?void 0:a.operators)||(null===(t=r.types[o])||void 0===t?void 0:t.operators)||[]);n||l.includes(i)||l.push(i);var s=If()(cv()(r.operators,(function(e,t){return-1!==(null==l?void 0:l.indexOf(t))})),(function(e,t){return vv(r,t,n)})),u=this.buildOptions(r,s,l),c=s[i]||{},p=i?[i]:null;return{placeholder:this.props.config.settings.operatorPlaceholder,items:u,selectedKey:i,selectedKeys:p,selectedPath:p,selectedLabel:c.label,selectedAltLabel:c.label2||c.tooltip,selectedOpts:c,fieldConfig:a}}},{key:"buildOptions",value:function(e,t,r){return t&&r?sv()(t).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).map((function(e){var r=t[e];return{key:e,path:e,label:r.label,altLabel:r.label2,tooltip:r.tooltip}})):null}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setOperator,o=e.readonly,i=e.id,a=e.groupId,l=t.settings.renderOperator,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pv(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:a,config:t,customProps:r,readonly:o,setField:n},this.meta);return s.items?l(s,t.ctx):null}}])}(k.Component);hv.propTypes={id:fg().string,groupId:fg().string,config:fg().object.isRequired,selectedField:fg().any,selectedFieldId:fg().string,selectedFieldType:fg().string,selectedFieldSrc:fg().string,selectedOperator:fg().string,readonly:fg().bool,customProps:fg().object,setOperator:fg().func.isRequired};var yv=["children"],mv=function(e){var t=e.children,r=(0,jd.A)(e,yv);return C().createElement("div",r,t)},bv=function(){},Ov=function(){return C().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},C().createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),C().createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},_v=function(e){return function(t){var r=t.config.settings.useConfirm,n=r?r.call(t.config.ctx,t.config.ctx):null;return C().createElement(e,(0,Jg.A)({},t,{confirmFn:n}))}},Sv=function(e){var t=e.id,r=e.isLHS,n=e.delta;return[t,r?"L":"R",r?-1:n||0,(e.parentFuncs||[]).map((function(e){var t=(0,x.A)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")].join(":")},wv=function(e,t){var r;return"function"==typeof t?(r=function(r){return null==t?void 0:t(r,e.ctx)}).displayName=t.name:r=t,r};function Av(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Av=function(){return!!e})()}var Fv=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,Av()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,a=e.setOperator,l=e.selectedFieldId,s=e.showOperator,u=e.showOperatorLabel,c=e.selectedFieldWidgetConfig,p=e.readonly,d=e.id,f=e.groupId;return[s&&C().createElement(mv,{key:"operators-for-"+l,className:"rule--operator"},t.settings.showLabels&&C().createElement("label",{className:"rule--label"},t.settings.operatorLabel),C().createElement(hv,{key:"operator",config:t,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,selectedFieldId:l,selectedOperator:i,setOperator:a,customProps:t.settings.customOperatorSelectProps,readonly:p,id:d,groupId:f})),u&&C().createElement(mv,{key:"operators-for-"+l,className:"rule--operator"},C().createElement("div",{className:"rule--operator-wrapper"},t.settings.showLabels?C().createElement("label",{className:"rule--label"}," "):null,C().createElement("div",{className:"rule--operator-text-wrapper"},C().createElement("span",{className:"rule--operator-text"},c.operatorInlineLabel))))]}}])}(k.PureComponent);function jv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ev(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ev=function(){return!!e})()}var kv=pg.RuleUtils.getFieldPathLabels,Cv=pg.ConfigUtils,Lv=Cv.getFieldConfig,xv=Cv.getFieldParts,Iv=Cv.getFieldPathParts,Tv=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,Ev()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).setField=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.props.id;if(!n.widgetId){var i=[o,"L",-1].join(":");n.widgetId=i}r.props.setField(e,t,n)},Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.config,o=e.parentField,i=t,a=n.settings,l=a.maxLabelsLength,s=a.fieldSeparatorDisplay,u=a.fieldPlaceholder,c=(a.fieldSeparator,!!t),p=c?null:kg(u,l),d=c?Lv(n,i):null,f=d||{},g=Iv(i,n),v=Iv(i,n,!0),h=this.getFieldLabel(d,i,n),y=kv(i,n),m=y?y.join(s):null;(m==h||o)&&(m=null);var b=f.label2||f.tooltip,O=xv(o,n),_=o?Lv(n,o):null,S=o?_&&_.subfields:n.fields,w=!c&&r,A=this.buildOptions(O,n,S,w,O),F=w?"Please select field":null;return i&&"object"===(0,T.A)(i)&&(i=void 0),{placeholder:p,items:A,parentField:o,selectedKey:i,selectedKeys:g,selectedPath:v,selectedLabel:h,selectedOpts:f,selectedAltLabel:b,selectedFullLabel:m,errorText:F}}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=xv(t,r),i=(null==e?void 0:e.label)||Lo()(o);return kg(i,n)}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!r)return null;var l=t.settings,s=l.fieldSeparator,u=l.fieldSeparatorDisplay,c=null!=i&&i.length?i.join(s)+s:"",p=function e(t){return Object.keys(t||{}).reduce((function(r,n){var i=t[n];return"!struct"===i.type?r+e(i.subfields):r+(i.type===o?1:0)}),0)};return sv()(r).map((function(l){var s=[].concat((0,I.A)(null!=i?i:[]),[l]),d=r[l],f=n.getFieldLabel(d,s,t),g=kv(s,t).join(u);(g==f||null!=e&&e.length)&&(g=null);var v=d.label2,h=d.tooltip,y=d.disabled;if(!d.hideForSelect){if("!struct"==d.type){var m=n.buildOptions(e,t,d.subfields,o,s,{label:f,tooltip:h}),b=p(d.subfields)>0;return{disabled:y,key:l,path:c+l,label:f,fullLabel:g,altLabel:v,tooltip:h,items:m,matchesType:b}}var O=void 0!==o?d.type===o:void 0;return{disabled:y,key:l,path:c+l,label:f,fullLabel:g,altLabel:v,tooltip:h,grouplabel:null==a?void 0:a.label,group:a,matchesType:O}}})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setFieldSrc,o=e.readonly,i=e.id,a=e.groupId,l=t.settings.renderField,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jv(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:a,config:t,customProps:r,readonly:o,setField:this.setField,setFieldSrc:n},this.meta);return l(s,t.ctx)}}])}(k.Component);function Pv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rv(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Rv=function(){return!!e})()}Tv.propTypes={id:fg().string,groupId:fg().string,config:fg().object.isRequired,selectedField:fg().any,selectedFieldSrc:fg().string,selectedFieldType:fg().string,parentField:fg().string,customProps:fg().object,readonly:fg().bool,setField:fg().func.isRequired,setFieldSrc:fg().func};var Nv=pg.clone,Dv=pg.ConfigUtils,Vv=Dv.getFieldConfig,zv=Dv.getFuncConfig,Mv=Dv.getFieldParts,qv=Dv.getFieldPathParts,Wv=pg.RuleUtils,Bv=Wv.getFuncPathLabels,$v=Wv.getWidgetForFieldOp,Uv=pg.OtherUtils.shallowEqual,Kv=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),r=(0,F.A)(n,Rv()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i)),Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"].map((function(r){return"parentFuncs"===r?!Uv(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0;(!this.meta||["config","field","fieldType","fieldSrc","value","isLHS"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r&&(this.items=this.getItems(e,this.meta))}},{key:"getItems",value:function(e,t){var r=e.config,n=e.field,o=e.fieldType,i=e.isLHS,a=e.operator,l=e.parentFuncs,s=e.fieldDefinition,u=e.isFuncArg,c=t.lookingForFieldType,p=r.settings.canUseFuncForField,d=this.filterFuncs(r,r.funcs,n,o,i,a,p,l,u,s);return this.buildOptions(r,d,c)}},{key:"getMeta",value:function(e){var t=e.config,r=(e._field,e.fieldType),n=e.value,o=e.isLHS,i=e.isFuncArg,a=t.settings,l=a.funcPlaceholder,s=a.fieldSeparatorDisplay,u=n,c=!!n,p=c?null:l,d=c?zv(t,u):null,f=d||{},g=qv(u,t),v=qv(u,t,!0),h=this.getFuncLabel(d,u,t),y=Bv(u,t),m=y?y.join(s):null;m==h&&(m=null);var b=o&&!i&&!c&&r;return{placeholder:p,selectedKey:u,selectedKeys:g,selectedPath:v,selectedLabel:h,selectedOpts:f,selectedFullLabel:m,errorText:b?"Please select function":null,lookingForFieldType:b}}},{key:"filterFuncs",value:function(e,t,r,n,o,i,a,l,s,u){t=Nv(t);var c,p=e.settings.fieldSeparator,d=Vv(e,r),f=d,g=$v(e,r,i,"value");return g&&e.widgets[g],s?(f=u,c=null==u?void 0:u.type):d?c=d.type:o||(c=n),function t(n,o){for(var s in n){var u=n[s].subfields,g=(o||[]).concat(s),v=g.join(p),h=zv(e,v);if("!struct"==h.type)0==t(u,g)&&delete n[s];else{var y,m=!c||h.returnType==c;null!==(y=f)&&void 0!==y&&y.funcs&&(m=m&&f.funcs.includes(v)),a&&(m=m&&a(r,d,v,h,i)),!h.allowSelfNesting&&l&&l.map((function(e){var t=(0,x.A)(e,2),r=t[0];return t[1],r})).includes(v)&&(m=!1),m||delete n[s]}}return sv()(n).length}(t,[]),t}},{key:"buildOptions",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;var a=e.settings,l=a.fieldSeparator,s=a.fieldSeparatorDisplay,u=null!=o&&o.length?o.join(l)+l:"",c=function e(t){return Object.keys(t||{}).reduce((function(r,o){var i=t[o];return"!struct"===i.type?r+e(i.subfields):r+(i.type===n?1:0)}),0)};return sv()(t).map((function(a){var l=[].concat((0,I.A)(null!=o?o:[]),[a]),p=t[a],d=r.getFuncLabel(p,l,e),f=Bv(l,e).join(s);f==d&&(f=null);var g=p.tooltip;if("!struct"==p.type){var v=r.buildOptions(e,p.subfields,n,l,{label:d,tooltip:g}),h=c(p.subfields)>0;return{key:a,path:u+a,label:d,fullLabel:f,tooltip:g,items:v,matchesType:h}}var y=void 0!==n?p.returnType===n:void 0;return{key:a,path:u+a,label:d,fullLabel:f,tooltip:g,grouplabel:null==i?void 0:i.label,group:i,matchesType:y}}))}},{key:"getFuncLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Mv(t,r),i=(null==e?void 0:e.label)||Lo()(o);return kg(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,a=e.groupId,l=t.settings.renderFunc,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pv(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,readonly:o,setField:n,items:this.items,id:i,groupId:a},this.meta);return l(s,t.ctx)}}])}(k.Component);Kv.propTypes={id:fg().string,groupId:fg().string,config:fg().object.isRequired,field:fg().any,fieldType:fg().string,fieldSrc:fg().string,operator:fg().string,customProps:fg().object,value:fg().string,setValue:fg().func.isRequired,readonly:fg().bool,parentFuncs:fg().array,fieldDefinition:fg().object,isFuncArg:fg().bool,isLHS:fg().bool};var Gv=r(2285),Hv=r.n(Gv),Jv=["widgetFactory"],Xv=["factory"];function Yv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yv(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Zv=pg.ListUtils.getTitleInListValues,eh=pg.ConfigUtils._widgetDefKeysToOmit,th=pg.TreeUtils,rh=th._fixImmutableValue,nh=th.isImmutable,oh=(0,k.memo)((function(e){var t=e.widgetFactory,r=(0,jd.A)(e,Jv),n=r.config,o=r.isFuncArg,i=r.fieldDefinition||{},a=i.fieldSettings,l=i.defaultValue,s=i.valueSources,u=o&&1==(null==s?void 0:s.length)&&"const"===(null==s?void 0:s[0]),c=(null==a?void 0:a.treeValues)||(null==a?void 0:a.listValues);return u&&l?"boolean"==typeof l?l?r.labelYes||"YES":r.labelNo||"NO":c?Array.isArray(l)?l.map((function(e){return Zv(c,e)||e})).join(", "):Zv(c,l)||l:""+l:t?t(r,n.ctx):"?"}));oh.displayName="WidgetFactoryMemo";var ih=function(e){var t=e.delta,r=e.isFuncArg,n=e.valueSrc,o=e.value,i=e.valueError,a=e.fieldError,l=e.asyncListValues,s=e.isSpecialRange,u=e.fieldDefinition,c=e.widget,p=e.widgetDefinition,d=e.widgetValueLabel,f=e.valueLabels,g=e.textSeparators,v=e.setValue,h=e.setFuncValue,y=e.config,m=e.field,b=e.fieldSrc,O=e.fieldPath,_=e.fieldType,S=e.isLHS,w=e.operator,A=e.readonly,F=e.parentField,j=e.parentFuncs,E=e.id,L=e.groupId,x=e.widgetId,T=p.factory,P=(0,jd.A)(p,Xv),R=o?o.map((function(e){return rh(e)})):void 0,N=(0,k.useMemo)((function(){if(s){var e=[null==R?void 0:R.get(0),null==R?void 0:R.get(1)];return void 0===e[0]&&void 0===e[1]&&(e=void 0),e}return null==R?void 0:R.get(t)}),[s,o]),D=(0,k.useMemo)((function(){return i?s?[i.get(0),i.get(1),i.get(2)]:null==i?void 0:i.get(t):null}),[s,o]),V=S?a:D,z=(u||{}).fieldSettings,M=d.label,q=d.placeholder,W=f?f.placeholder:null,B=nh(m)?null:m,$=Io()(Qv(Qv(Qv({},P),z),{},{config:y,field:B,fieldPath:O,fieldSrc:b,fieldType:_,isLHS:S,parentField:F,parentFuncs:j,fieldDefinition:u,operator:w,delta:t,isSpecialRange:s,isFuncArg:r,value:N,valueSrc:n,valueError:D,fieldError:a,errorMessage:V,label:M,placeholder:q,placeholders:W,textSeparators:g,setValue:v,setFuncValue:h,readonly:A,asyncListValues:l,id:E,groupId:L,widgetId:x,widgetFactory:T,widget:c}),[].concat((0,I.A)(eh),["toJS"]));return C().createElement(oh,(0,Jg.A)({widgetFactory:T},$))};ih.displayName="WidgetFactory";const ah=ih;function lh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(lh=function(){return!!e})()}var sh=pg.ConfigUtils,uh=sh.getFieldConfig,ch=sh.getOperatorConfig,ph=sh.getFieldWidgetConfig,dh=pg.RuleUtils,fh=dh.getValueSourcesForFieldOp,gh=dh.getWidgetForFieldOp,vh=dh.getValueLabel,hh=pg.DefaultUtils.createListWithOneElement,yh=pg.OtherUtils.shallowEqual,mh=(pg.TreeUtils.isImmutable,{cardinality:1}),bh=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,lh()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i)))._setValue=function(e,t,n,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(l.widgetId||(l.widgetId=o),e&&Array.isArray(i)){var s=[r.props.value.get(0),r.props.value.get(1)];s[0]!=i[0]&&r.props.setValue(0,i[0],n,a,l),s[1]!=i[1]&&r.props.setValue(1,i[1],n,a,l)}else r.props.setValue(t,i,n,a,l)},r._setValueSrc=function(e,t,n){var o={widgetId:t};r.props.setValueSrc(e,n,o)},r.renderWidget=function(e,t,r){var n=r.config,o=r.isFuncArg,i=r.leftField,a=r.operator,l=r.value,s=r.valueError,u=r.fieldError,c=r.readonly,p=r.parentField,d=r.parentFuncs,f=r.id,g=r.groupId,v=r.fieldSrc,h=r.fieldType,y=r.isLHS,m=r.setFuncValue,b=n.settings,O=t.widgets,_=t.iValues,S=t.aField,w=t.valueSources,A=o?_:l,F=o?i:S,j=O[e],E=j.valueSrc,k=j.valueLabel,L=j.widgetId,x=w.length>1&&!c,I=b.showLabels?C().createElement("label",{key:"label-"+L,className:"rule--label"},k.label):null;return C().createElement("div",{key:"wrapper-"+L,className:Yg()("func"===E?"widget--func":"widget--widget",x?"widget--has-valuesrcs":"widget--has-no-valuesrcs")},"func"===E?null:I,C().createElement(ah,(0,Jg.A)({key:L,id:f,groupId:g,widgetId:L,valueSrc:E,delta:e,value:A,valueError:s,fieldError:u,isFuncArg:o,isLHS:y},ko()(t,["isSpecialRange","fieldDefinition","asyncListValues"]),ko()(O[e],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:m,config:n,field:F,fieldSrc:v,fieldType:h,parentField:p,parentFuncs:d,operator:a,readonly:c})))},r.renderValueSources=function(e,t,n){var o=n.config,i=n.isFuncArg,a=n.leftField,l=n.operator,s=n.readonly,u=o.settings,c=t.valueSources,p=t.widgets,d=t.aField,f=t.valueSourcesOptions,g=i?a:d,v=p[e],h=v.valueSrc,y=v.setValueSrc,m=r.ValueSources,b=u.showLabels?C().createElement("label",{className:"rule--label"}," "):null;return c.length>1&&!s&&C().createElement("div",{key:"wrapper-valuesrc-"+e,className:"widget--valuesrc"},b,C().createElement(m,{key:"valuesrc-"+e,delta:e,valueSources:f,valueSrc:h,config:o,field:g,operator:l,setValueSrc:y,readonly:s,title:u.valueSourcesPopupTitle}))},r.renderSep=function(e,t,r){var n=r.config,o=t.widgets,i=n.settings,a=o[e].sepText,l=i.showLabels?C().createElement("label",{className:"rule--label"}," "):null;return a&&C().createElement("div",{key:"widget-separators-"+e,className:Yg()("widget--sep",0==e&&"widget--sep-first")},l,C().createElement("span",null,a))},r.renderWidgetDelta=function(e){return[r.renderSep(e,r.meta,r.props),r.renderValueSources(e,r.meta,r.props),r.renderWidget(e,r.meta,r.props)]},Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config),n=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value"].filter((function(r){return"parentFuncs"===r?!yh(e[r],t[r],!0):"field"===r?e.fieldId!==t.fieldId:e[r]!==t[r]}));if((!this.meta||n.length>0)&&(this.meta=this.getMeta(e,n)),r){var o=e.config,i=o.settings.renderValueSources;this.ValueSources=wv(o,i)}}},{key:"getMeta",value:function(e){var t,r,n,o,i=this,a=e.config,l=e.field,s=(e.fieldSrc,e.fieldType),u=e.fieldFunc,c=e.fieldArg,p=e.operator,d=e.valueSrc,f=e.value,g=e.isForRuleGroup,v=e.isCaseValue,h=e.isFuncArg,y=(e.leftField,e.asyncListValues),m=e.parentFuncs,b=e.isLHS,O=e.id,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],S=a.settings.valueSourcesInfo,w=h?{func:u,arg:c}:l,A=!l&&s,F=d,j=f;(h||g||v)&&(F=hh(d),j=hh(f));var E=uh(a,w);!E&&A&&(E=a.types[s]);var k,C=gh(a,w,p);!C&&A&&(C=null===(k=a.types[s])||void 0===k?void 0:k.mainWidget);var L=h?mh:ch(a,p,w);if((null==E||null==L)&&!v)return null;var x,I,T=null==L?void 0:L.isSpecialRange,P=T&&("field"===(null===(t=F)||void 0===t?void 0:t.get(0))||"field"===(null===(r=F)||void 0===r?void 0:r.get(1))),R=T&&!P,N=R?1:null!==(I=null==(x=L)?void 0:x.cardinality)&&void 0!==I?I:1;if(0===N)return null;var D=null===(n=this.meta)||void 0===n?void 0:n.valueSources,V=null===(o=this.meta)||void 0===o?void 0:o.valueSourcesOptions;D&&!["field","operator","config","fieldDefinition","isForRuleGroup"].filter((function(e){return _.includes(e)})).length||(D=fh(a,w,p,E),g&&(D=["value"]),w||(D=Object.keys(S)),V=D.map((function(e){return[e,{label:S[e].label}]})));var z=Hv()(0,N).map((function(e){var t,r,n,o,l=null===(t=i.meta)||void 0===t||null===(t=t.widgets)||void 0===t?void 0:t[e],s=(null===(r=F)||void 0===r?void 0:r.get(e))||null,u=gh(a,w,p,s),c=ph(a,w,p,u,s);P&&(u=c.singleWidget,c=ph(a,w,p,u,s)),!c&&A&&(u=["func","field"].includes(s)?s:C,c=a.widgets[u]);var d=null===(n=c)||void 0===n?void 0:n.type,f=vh(a,w,p,e,s,R),g=vh(a,w,p,e,null,R),v=null!=L&&L.textSeparators?null==L?void 0:L.textSeparators[e]:null,h=null,y=null;T&&(h={placeholder:[(h=[vh(a,w,p,0),vh(a,w,p,1)])[0].placeholder,h[1].placeholder],label:[h[0].label,h[1].label]},y=null==L?void 0:L.textSeparators);var _=Sv({id:O,isLHS:b,delta:e,parentFuncs:m}),S=_+":VS",j=null==l?void 0:l.setValueSrc;j&&(null==l?void 0:l.widgetId)===_||(j=i._setValueSrc.bind(i,e,S));var E=null==l?void 0:l.setValue;return E&&(null==l?void 0:l.widgetId)===_&&(null==l?void 0:l.widgetType)===d&&(null===(o=i.meta)||void 0===o?void 0:o.isSpecialRange)===T||(E=i._setValue.bind(i,T,e,d,_)),{valueSrc:s,valueLabel:f,widget:u,sepText:v,widgetDefinition:c,widgetValueLabel:g,valueLabels:h,textSeparators:y,setValueSrc:j,setValue:E,widgetId:_,widgetType:d}}));return{defaultWidget:C,fieldDefinition:E,operatorDefinition:L,isSpecialRange:R,cardinality:N,valueSources:D,valueSourcesOptions:V,widgets:z,iValues:j,aField:w,asyncListValues:y}}},{key:"render",value:function(){if(!this.meta)return null;var e=this.meta,t=e.defaultWidget,r=e.cardinality;if(!t)return null;var n=t;return C().createElement(mv,{className:"rule--widget rule--widget--".concat(n.toUpperCase()),key:"widget-col-"+n},Hv()(0,r).map(this.renderWidgetDelta))}}])}(k.Component);function Oh(e,t,r){return t=(0,j.A)(t),(0,F.A)(e,_h()?Reflect.construct(t,r||[],(0,j.A)(e).constructor):t.apply(e,r))}function _h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_h=function(){return!!e})()}bh.propTypes={config:fg().object.isRequired,value:fg().any,valueSrc:fg().any,valueError:fg().any,fieldError:fg().string,field:fg().any,fieldSrc:fg().string,fieldType:fg().string,fieldId:fg().string,operator:fg().string,readonly:fg().bool,asyncListValues:fg().array,id:fg().string,groupId:fg().string,setValue:fg().func,setValueSrc:fg().func,setFuncValue:fg().func,isFuncArg:fg().bool,fieldFunc:fg().string,fieldArg:fg().string,leftField:fg().any,isForRuleGroup:fg().bool,parentField:fg().string,parentFuncs:fg().array,isLHS:fg().bool,isCaseValue:fg().bool};var Sh=pg.ConfigUtils.getFuncConfig,wh=pg.OtherUtils.shallowEqual,Ah=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Oh(this,t,[e])).setFunc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.props,o=n.isLHS,i=n.delta,a=n.parentFuncs,l=n.id;if(!t.widgetId){var s=Sv({id:l,isLHS:o,delta:i,parentFuncs:a});t.widgetId=s}r.props.setFuncValue(o?-1:i||0,a,null,e,"!func",void 0,t)},r.setArgValue=function(e,t,n,o,i){var a=r.props,l=(a.config,a.delta),s=a.isLHS,u=a.parentFuncs;r.props.setFuncValue(s?-1:l||0,u,e,t,n,o,i)},r.setArgValueSrc=function(e,t,n){var o=r.props,i=(o.config,o.delta),a=o.isLHS,l=o.parentFuncs;r.props.setFuncValue(a?-1:i||0,l,e,t,"!valueSrc",void 0,n)},r.renderFuncSelect=function(){var e,t,n=r.props,o=n.config,i=n.field,a=n.fieldType,l=n.fieldSrc,s=n.isLHS,u=n.operator,c=n.customProps,p=n.value,d=n.readonly,f=n.parentFuncs,g=n.id,v=n.groupId,h=n.isFuncArg,y=n.fieldDefinition,m={value:null!==(e=null==p||null===(t=p.get)||void 0===t?void 0:t.call(p,"func"))&&void 0!==e?e:null,setValue:r.setFunc,config:o,field:i,fieldType:a,fieldSrc:l,isLHS:s,operator:u,customProps:c,readonly:d,parentFuncs:f,isFuncArg:h,fieldDefinition:y,id:g,groupId:v},b=o.settings,O=b.showLabels,_=b.funcLabel,S=O?C().createElement("label",{className:"rule--label"},_):null;return C().createElement(mv,{key:"func",className:"rule--func"},S,C().createElement(Kv,m))},r.renderArgLabel=function(e,t){var n=t.valueSources,o=t.type,i=t.showPrefix,a=t.label,l=r.props.config,s=n&&1==n.length&&"const"==n[0];return l.settings.showLabels||"boolean"!=o&&!s||!i?null:C().createElement(mv,{className:"rule--func--arg-label"},a||e)},r.renderArgLabelSep=function(e,t){var n=t.valueSources,o=t.type,i=t.showPrefix,a=r.props.config,l=n&&1==n.length&&"const"==n[0];return a.settings.showLabels||"boolean"!=o&&!l||!i?null:C().createElement(mv,{className:"rule--func--arg-label-sep"},":")},r.renderArgVal=function(e,t,n){var o=r.props,i=o.config,a=o.field,l=o.fieldType,s=o.fieldSrc,u=o.isLHS,c=(o.operator,o.value),p=o.readonly,d=o.parentFuncs,f=o.id,g=o.groupId,v=o.fieldError,h=o.valueError,y=o.setFuncValue,m=c?c.getIn(["args",t]):null,b=m?m.get("value"):void 0,O=1==n.valueSources.length?n.valueSources[0]:void 0,_={config:i,fieldFunc:e,fieldArg:t,leftField:a,fieldType:l,fieldSrc:s,fieldError:v,valueError:h,isLHS:u,operator:null,value:b,valueSrc:m?m.get("valueSrc")||O||"value":O,setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:y,funcKey:e,argKey:t,argDefinition:n,readonly:p,parentFuncs:d,id:f,groupId:g};return C().createElement(mv,{className:"rule--func--arg-value"},C().createElement(Fh,_))},r.renderArgSep=function(e,t,r,n){var o=n.renderSeps;return r?C().createElement(mv,{className:"rule--func--arg-sep"},o?o[r-1]:", "):null},r.renderBracketBefore=function(e){var t=e.renderBrackets;return C().createElement(mv,{key:"before_args",className:"rule--func--bracket-before"},t?t[0]:"(")},r.renderBracketAfter=function(e){var t=e.renderBrackets;return C().createElement(mv,{key:"after_args",className:"rule--func--bracket-after"},t?t[1]:")")},r.renderFuncArgs=function(){var e=r.meta,t=e.funcDefinition,n=e.funcKey;if(!n)return null;var o=(t||{}).args;return o?C().createElement(C().Fragment,null,r.renderBracketBefore(t),C().createElement(mv,{key:"args-".concat(n),className:"rule--func--args rule--func--".concat(n,"--args")},Object.keys(o).map((function(e,i){return C().createElement(mv,{key:"arg-".concat(e,"-").concat(i),className:"rule--func--arg rule--func--".concat(n,"--arg--").concat(e)},r.renderArgSep(e,o[e],i,t),r.renderArgLabel(e,o[e]),r.renderArgLabelSep(e,o[e]),r.renderArgVal(n,e,o[e]))}))),r.renderBracketAfter(t)):null},Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","operator","value","fieldSrc","fieldType","isLHS"].map((function(r){return"parentFuncs"===r?!wh(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r,n=e.config,o=(e.field,e.operator,e.value),i=null!==(t=null==o||null===(r=o.get)||void 0===r?void 0:r.call(o,"func"))&&void 0!==t?t:null;return{funcDefinition:i?Sh(n,i):null,funcKey:i}}},{key:"render",value:function(){var e=this.props.parentFuncs,t=e?e.map((function(e){var t=(0,x.A)(e,2),r=t[0],n=t[1];return"".concat(r,"_").concat(n)})).join("-"):"root",r=(null==e?void 0:e.length)||0;return C().createElement(mv,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(t," rule--func--wrapper--lev-").concat(r)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(k.Component);Ah.propTypes={id:fg().string,groupId:fg().string,config:fg().object.isRequired,field:fg().any,fieldSrc:fg().string,fieldType:fg().string,fieldError:fg().string,operator:fg().string,customProps:fg().object,value:fg().object,setValue:fg().func.isRequired,setFuncValue:fg().func,readonly:fg().bool,parentFuncs:fg().array,fieldDefinition:fg().object,isFuncArg:fg().bool,isLHS:fg().bool,valueError:fg().string};var Fh=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Oh(this,t,[e])).setValue=function(e,t,n,o,i){var a=r.props;(0,a.setValue)(a.argKey,t,n,o,i)},r.setValueSrc=function(e,t,n){var o=r.props;(0,o.setValueSrc)(o.argKey,t,n)},Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["parentFuncs","funcKey","argKey"].map((function(r){return"parentFuncs"===r?!wh(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.parentFuncs,r=e.funcKey,n=e.argKey;return{parentFuncs:[].concat((0,I.A)(t||[]),[[r,n]])}}},{key:"render",value:function(){var e=this.meta.parentFuncs;return C().createElement(bh,(0,Jg.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:e}))}}])}(k.Component);function jh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jh=function(){return!!e})()}Fh.propTypes={funcKey:fg().string.isRequired,argKey:fg().string.isRequired,setValue:fg().func.isRequired,setValueSrc:fg().func.isRequired,readonly:fg().bool,isLHS:fg().bool,parentFuncs:fg().array,id:fg().string,groupId:fg().string};var Eh=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,jh()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).renderField=function(){var e=r.props,t=e.config,n=e.classname,o=e.selectedField,i=e.selectedFieldSrc,a=e.selectedFieldType,l=e.setField,s=e.setFuncValue,u=e.parentField,c=e.readonly,p=e.id,d=e.groupId,f=e.fieldError,g=e.valueError;if(!["func","field"].includes(i))return"?";var v="func"===i?C().createElement(Ah,{isLHS:!0,config:t,value:o,fieldSrc:i,fieldType:a,fieldError:f,valueError:g,parentField:u,setValue:l,setFuncValue:s,readonly:c,id:p,groupId:d,key:"field-func-"+p}):C().createElement(Tv,{config:t,selectedField:o,selectedFieldSrc:i,selectedFieldType:a,parentField:u,setField:l,customProps:t.settings.customFieldSelectProps,readonly:c,id:p,groupId:d,key:"field-"+p}),h="func"===i?t.settings.funcLabel:t.settings.fieldLabel,y=t.settings.showLabels&&"func"!==i&&C().createElement("label",{className:"rule--label"},h);return C().createElement("div",{key:i,className:n},y,v)},r.renderFieldSources=function(){if(!r.meta)return null;var e=r.props,t=e.config,n=e.readonly,o=e.selectedFieldSrc,i=e.setFieldSrc,a=e.id,l=r.meta.fieldSourcesOptions,s=t.settings,u=r.ValueSources,c=s.showLabels?C().createElement("label",{className:"rule--label"}," "):null;return l.length>1&&!n&&C().createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},c,C().createElement(u,{key:"fieldsrc-"+a,valueSources:l,valueSrc:o,config:t,setValueSrc:i,readonly:n,title:s.fieldSourcesPopupTitle}))},Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config);if((!this.meta||["config"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r){var n=e.config,o=n.settings.renderValueSources;this.ValueSources=function(e){return o(e,n.ctx)}}}},{key:"getMeta",value:function(e){var t=e.config.settings,r=t.valueSourcesInfo;return{fieldSourcesOptions:t.fieldSources.map((function(e){return[e,{label:r[e].label}]}))}}},{key:"render",value:function(){var e=this.props,t=(e.classname,e.canSelectFieldSource),r=t&&this.renderFieldSources(),n=this.renderField();return t?C().createElement(mv,{className:"rule--field-wrapper"},r,n):n}}])}(k.Component),kh=["factory"];function Ch(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ch=function(){return!!e})()}var Lh=pg.ConfigUtils.getOperatorConfig,xh=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,Ch()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var e=Lh(this.props.config,this.props.selectedOperator,this.props.selectedField);if(void 0===e.options)return null;var t=e.options,r=t.factory,n=(0,jd.A)(t,kh),o=r(Object.assign({},n,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),this.props.config.ctx),i=this.props.selectedOperator;return C().createElement("div",{className:"rule--operator rule--operator--".concat(i.toUpperCase())},o)}}])}(k.PureComponent);function Ih(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Th(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ih(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ih(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ph(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ph=function(){return!!e})()}xh.propTypes={config:fg().object.isRequired,operatorOptions:fg().any.isRequired,selectedField:fg().any,selectedFieldSrc:fg().string,selectedOperator:fg().string.isRequired,readonly:fg().bool,setOperatorOption:fg().func.isRequired};var Rh=pg.ConfigUtils,Nh=Rh.getFieldConfig,Dh=Rh.getOperatorConfig,Vh=Rh.getFieldWidgetConfig,zh=Rh.getFieldId,Mh=pg.RuleUtils.isEmptyRuleProperties,qh=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),r=(0,F.A)(n,Ph()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i)),Dg(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props,n=!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if((!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked","parentField","parentFieldCanReorder"].map((function(t){return e[t]!==r[t]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),n){var o=e.config,i=o.settings,a=i.renderIcon,l=i.renderButton,s=i.renderButtonGroup,u=i.renderSwitch,c=i.renderBeforeWidget,p=i.renderAfterWidget,d=i.renderRuleError;this.Icon=wv(o,a),this.Btn=wv(o,l),this.BtnGrp=wv(o,s),this.Switch=wv(o,u),this.BeforeWidget=wv(o,c),this.AfterWidget=wv(o,p),this.RuleError=wv(o,d)}this.doRemove=function(){t.props.removeSelf()}}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.selectedOperator,o=e.config,i=e.reordableNodesCnt,a=e.isLocked,l=e.parentField,s=e.parentFieldCanReorder,u=o.settings.keepInputOnChangeFieldSrc,c=zh(t,o),p=Nh(o,t),d=p&&"!struct"===p.type,f=!!t||u&&r,g=f&&n,v=Dh(o,n,t),h=v&&null!=v.options,y=Vh(o,t,n,null,null)||{},m=y.hideOperator,b=o.settings.canReorder&&i>1&&!a;return l&&(b=b&&s),{selectedFieldId:c,selectedFieldWidgetConfig:y,showDragIcon:b,showOperator:f&&!m,showOperatorLabel:f&&m&&y.operatorInlineLabel,showWidget:g&&!d,showOperatorOptions:g&&h}}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,i=n.removeRuleConfirmOptions;i&&!this.isEmptyCurrentRule()?o.call(r.ctx,Th(Th({},i),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(e,t){var r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,a=e.operatorOptions,l=e.value,s=e.valueType,u=e.valueSrc,c=e.asyncListValues,p=e.valueError,d=e.fieldError,f=e.parentField;return{field:r,fieldSrc:n,fieldType:o,fieldId:t.selectedFieldId,operator:i,operatorOptions:a,value:l,valueType:s,valueSrc:u,asyncListValues:c,valueError:p,fieldError:d,parentField:f}}},{key:"isEmptyCurrentRule",value:function(){var e=this.props.config,t=this._buildWidgetProps(this.props,this.meta);return Mh(t,e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.parentField,o=e.groupId,i=e.id,a=e.selectedFieldSrc,l=e.selectedField,s=e.selectedFieldType,u=e.setField,c=e.setFuncValue,p=e.setFieldSrc,d=e.fieldError,f=t.settings.immutableFieldsMode,g=this.meta.selectedFieldId;return C().createElement(Eh,{key:"field",classname:Yg()("func"==a?"rule--field--func":"rule--field"),config:t,canSelectFieldSource:!n,selectedField:l,selectedFieldSrc:a,selectedFieldType:s,selectedFieldId:g,fieldError:d,setField:f?bv:u,setFuncValue:f?bv:c,setFieldSrc:f?bv:p,parentField:n,readonly:f||r,id:i,groupId:o})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta,o=n.selectedFieldId,i=n.selectedFieldWidgetConfig,a=n.showOperator,l=n.showOperatorLabel,s=t.settings.immutableOpsMode;return C().createElement(Fv,{key:"operator",config:t,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:o,selectedOperator:this.props.selectedOperator,setOperator:s?bv:this.props.setOperator,showOperator:a,showOperatorLabel:l,selectedFieldWidgetConfig:i,readonly:s||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta.showWidget,o=t.settings.immutableValuesMode;if(!n)return null;var i=C().createElement(bh,(0,Jg.A)({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:t,setValue:o?bv:this.props.setValue,setValueSrc:o?bv:this.props.setValueSrc,setFuncValue:o?bv:this.props.setFuncValue,readonly:o||r,id:this.props.id,groupId:this.props.groupId}));return C().createElement(mv,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},i)}},{key:"renderOperatorOptions",value:function(){var e=this.props.config,t=this.meta.showOperatorOptions,r=e.settings,n=r.immutableOpsMode,o=r.immutableValuesMode;if(!t)return null;var i=C().createElement(xh,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:n?bv:this.props.setOperatorOption,config:e,readonly:o});return C().createElement(mv,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},i)}},{key:"renderBeforeWidget",value:function(){var e=this.BeforeWidget;return e?C().createElement(mv,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},C().createElement(e,this.props)):null}},{key:"renderAfterWidget",value:function(){var e=this.AfterWidget;return e?C().createElement(mv,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},C().createElement(e,this.props)):null}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=e.fieldError,o=t.settings.showErrorMessage,i=this.RuleError,a=[n].concat((0,I.A)((null==r?void 0:r.toArray())||[])).filter((function(e){return!!e})).shift()||null;return o&&a&&C().createElement("div",{className:"rule--error"},i?C().createElement(i,{error:a}):a)}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.meta.showDragIcon,r=this.Icon,n=C().createElement(r,{type:"drag"});return t&&C().createElement("div",{key:"rule-drag-icon",onMouseDown:e,className:"qb-drag-handler rule--drag-handler"},n)}},{key:"renderDel",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings,o=n.deleteLabel,i=n.immutableGroupsMode,a=n.canDeleteLocked,l=this.Icon,s=this.Btn;return!i&&(!r||r&&a)&&C().createElement(s,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:o,config:t,renderIcon:l})}},{key:"renderLock",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.isTrueLocked,o=e.id,i=t.settings,a=i.lockLabel,l=i.lockedLabel,s=i.showLock,u=this.Switch;return s&&!(r&&!n)&&C().createElement(u,{key:"rule-lock",type:"lock",id:o,value:r,setValue:this.setLock,label:a,checkedLabel:l,hideLabel:!0,config:t})}},{key:"render",value:function(){var e=this.meta,t=e.showOperatorOptions,r=e.selectedFieldWidgetConfig,n=this.props,o=n.valueSrc,i=n.value,a=n.config,l="value"==(null==o?void 0:o.first())&&!t&&1==i.size&&r.fullWidth,s=this.BtnGrp,u=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],c=C().createElement("div",{key:"rule-body",className:Yg()("rule--body",l&&"can--shrink--value")},u),p=this.renderError(),d=this.renderDrag(),f=this.renderLock(),g=this.renderDel();return C().createElement(C().Fragment,null,d,C().createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},c,p),C().createElement("div",{key:"rule-header-wrapper",className:"rule--header"},C().createElement(s,{key:"rule-header-group",config:a},f,g)))}}])}(k.Component);qh.propTypes={id:fg().string.isRequired,groupId:fg().string,selectedField:fg().any,selectedFieldSrc:fg().string,selectedFieldType:fg().string,selectedOperator:fg().string,operatorOptions:fg().object,config:fg().object.isRequired,value:fg().any,valueSrc:fg().any,valueType:fg().any,asyncListValues:fg().array,isDraggingMe:fg().bool,isDraggingTempo:fg().bool,parentField:fg().string,valueError:fg().any,fieldError:fg().string,isLocked:fg().bool,isTrueLocked:fg().bool,handleDraggerMouseDown:fg().func,setField:fg().func,setFieldSrc:fg().func,setOperator:fg().func,setOperatorOption:fg().func,setLock:fg().func,removeSelf:fg().func,setValue:fg().func,setValueSrc:fg().func,setFuncValue:fg().func,reordableNodesCnt:fg().number,totalRulesCnt:fg().number,parentReordableNodesCnt:fg().number,parentFieldCanReorder:fg().bool};const Wh=function(e){var t=(0,yg.connect)((function(e){return{dragging:e.dragging}}),null,null,{context:vg})(function(e){var t;return t=function(t){function r(e){var t,n,o,i;return(0,w.A)(this,r),n=this,o=r,i=[e],o=(0,j.A)(o),(t=(0,F.A)(n,Qg()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeRule(t.props.path)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.setField=function(e,r,n){t.props.actions.setField(t.props.path,e,r,n)},t.setFieldSrc=function(e){t.props.actions.setFieldSrc(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setOperatorOption=function(e,r){t.props.actions.setOperatorOption(t.props.path,e,r)},t.setValue=function(e,r,n,o,i){t.props.actions.setValue(t.props.path,e,r,n,o,i)},t.setValueSrc=function(e,r,n){t.props.actions.setValueSrc(t.props.path,e,r,n)},t.setFuncValue=function(e,r,n,o,i,a,l){t.props.actions.setFuncValue(t.props.path,e,r,n,o,i,a,l)},t.pureShouldComponentUpdate=Ng(t),t.dummyFn.isDummyFn=!0,t}return(0,E.A)(r,t),(0,A.A)(r,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,a=[];for(var l in e){var s=e[l]!=r[l];"dragging"!=l||i||(s=!1),s&&a.push(l)}a.length||(o=!1)}return o}},{key:"render",value:function(){var t=this.props.dragging.id==this.props.id,r=Zg(this.props.config,this.props.field),n=this.props.fieldType||(null==r?void 0:r.type)||null,o=this.props.config.settings.showErrorMessage,i=(r&&r.type,!t&&this.props.isDraggingTempo),a=this.props,l=a.valueError,s=null!=([a.fieldError].concat((0,I.A)((null==l?void 0:l.toArray())||[])).filter((function(e){return!!e})).shift()||null)&&o;return C().createElement("div",{className:Yg()("group-or-rule-container","rule-container",s?"rule-with-error":null),"data-id":this.props.id},[t?C().createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,lev:this.props.path.size-1,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,C().createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,lev:this.props.path.size-1,isDraggingMe:t,isDraggingTempo:i,onDragStart:this.props.onDragStart,setLock:i?this.dummyFn:this.setLock,removeSelf:i?this.dummyFn:this.removeSelf,setField:i?this.dummyFn:this.setField,setFieldSrc:i?this.dummyFn:this.setFieldSrc,setFuncValue:i?this.dummyFn:this.setFuncValue,setOperator:i?this.dummyFn:this.setOperator,setOperatorOption:i?this.dummyFn:this.setOperatorOption,setValue:i?this.dummyFn:this.setValue,setValueSrc:i?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(k.Component),t.propTypes={id:fg().string.isRequired,groupId:fg().string,config:fg().object.isRequired,path:fg().any.isRequired,operator:fg().string,field:fg().any,fieldSrc:fg().string,fieldType:fg().string,actions:fg().object.isRequired,onDragStart:fg().func,value:fg().any,valueSrc:fg().any,asyncListValues:fg().array,valueError:fg().any,fieldError:fg().string,operatorOptions:fg().object,reordableNodesCnt:fg().number,parentField:fg().string,isLocked:fg().bool,isTrueLocked:fg().bool,dragging:fg().object,isDraggingTempo:fg().bool},t}(e));return t.displayName="ConnectedRuleContainer",t}(av("rule")(_v(qh)));var Bh=r(3547),$h=r.n(Bh);function Uh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Uh=function(){return!!e})()}var Kh=pg.DefaultUtils.defaultGroupConjunction,Gh=pg.ConfigUtils.getFieldConfig;const Hh=function(e,t){var r=(0,yg.connect)((function(e){return{dragging:e.dragging}}),null,null,{context:vg})(function(e,t){var r;return r=function(r){function n(e){var r,o,i,a;return(0,w.A)(this,n),o=this,i=n,a=[e],i=(0,j.A)(i),(r=(0,F.A)(o,Uh()?Reflect.construct(i,a||[],(0,j.A)(o).constructor):i.apply(o,a)))._selectedConjunction=function(e){return(e=e||r.props).conjunction||Kh(e.config,e.field)},r.setConjunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setConjunction(r.props.path,e)},r.setNot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setNot(r.props.path,e)},r.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setLock(r.props.path,e)},r.dummyFn=function(){},r.removeSelf=function(){r.props.actions.removeGroup(r.props.path)},r.addGroup=function(){var e="rule_group"==t?r.props.field:r.props.parentField;r.props.actions.addGroup(r.props.path,void 0,void 0,e)},r.addCaseGroup=function(){r.props.actions.addCaseGroup(r.props.path)},r.addDefaultCaseGroup=function(){r.props.actions.addDefaultCaseGroup(r.props.path)},r.addRule=function(){var e="rule_group"==t?r.props.field:r.props.parentField;r.props.actions.addRule(r.props.path,void 0,void 0,void 0,e)},r.setField=function(e,t,n){r.props.actions.setField(r.props.path,e,t,n)},r.setOperator=function(e){r.props.actions.setOperator(r.props.path,e)},r.setValue=function(e,t,n,o,i){r.props.actions.setValue(r.props.path,e,t,n,o,i)},r.setValueSrc=function(e,t,n){r.props.actions.setValueSrc(r.props.path,e,t,n)},r.setFuncValue=function(e,t,n,o,i,a,l){r.props.actions.setFuncValue(r.props.path,e,t,n,o,i,a,l)},r.pureShouldComponentUpdate=Ng(r),Dg(r),r.selectedConjunction=r._selectedConjunction(e),r.conjunctionOptions=r._getConjunctionOptions(e),r.dummyFn.isDummyFn=!0,r}return(0,E.A)(n,r),(0,A.A)(n,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,a=[];for(var l in e){var s=e[l]!=r[l];"dragging"!=l||i||(s=!1),s&&a.push(l)}a.length||(o=!1)}return o}},{key:"onPropsChanged",value:function(e){var t=e.config,r=(e.id,e.conjunction),n=this.props.config,o=this.props.conjunction;n==t&&o==r||(this.selectedConjunction=this._selectedConjunction(e),this.conjunctionOptions=this._getConjunctionOptions(e))}},{key:"_getConjunctionOptions",value:function(e){var t=this;return If()(e.config.conjunctions,(function(r,n){return{id:"conjunction-".concat(e.id,"-").concat(n),name:"conjunction[".concat(e.id,"]"),key:n,label:r.label,checked:n===t._selectedConjunction(e)}}))}},{key:"render",value:function(){var t=this.props.config.settings.showErrorMessage,r=this.props.dragging.id==this.props.id,n=this.props.path.size,o=this.props.config.settings.maxNesting,i=1==n;if(this.props.parentField&&this.props.parentFieldPathSize){var a=Gh(this.props.config,this.props.parentField);n=this.props.path.size-this.props.parentFieldPathSize+1,o=null==a?void 0:a.maxNesting,i=!1}else if(this.props.field){var l=Gh(this.props.config,this.props.field);n=1,o=null==l?void 0:l.maxNesting,i=!1}var s=!r&&this.props.isDraggingTempo,u=this.props.fieldType||null,c=this.props.valueError,p=null!=((0,I.A)((null==c?void 0:c.toArray())||[]).filter((function(e){return!!e})).shift()||null)&&t,d=void 0===o||n<o,f=o&&n>o;return C().createElement("div",{className:Yg()("group-or-rule-container","group-container",p?"group-with-error":null),"data-id":this.props.id},[r?C().createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:i,lev:this.props.path.size-1,allowFurtherNesting:d,isMaxNestingExceeded:f,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:u,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,C().createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:r,isDraggingTempo:s,onDragStart:this.props.onDragStart,isRoot:i,lev:this.props.path.size-1,allowFurtherNesting:d,isMaxNestingExceeded:f,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:s?this.dummyFn:this.setConjunction,setNot:s?this.dummyFn:this.setNot,setLock:s?this.dummyFn:this.setLock,removeSelf:s?this.dummyFn:this.removeSelf,addGroup:s?this.dummyFn:this.addGroup,addCaseGroup:s?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:s?this.dummyFn:this.addDefaultCaseGroup,addRule:s?this.dummyFn:this.addRule,setField:s?this.dummyFn:this.setField,setFuncValue:s?this.dummyFn:this.setFuncValue,setOperator:s?this.dummyFn:this.setOperator,setValue:s?this.dummyFn:this.setValue,setValueSrc:s?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:u,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(k.Component),r.propTypes={config:fg().object.isRequired,actions:fg().object.isRequired,path:fg().any.isRequired,id:fg().string.isRequired,groupId:fg().string,not:fg().bool,conjunction:fg().string,children1:fg().any,onDragStart:fg().func,reordableNodesCnt:fg().number,field:fg().any,fieldSrc:fg().string,fieldType:fg().string,parentField:fg().string,value:fg().any,valueSrc:fg().any,valueError:fg().any,isLocked:fg().bool,isTrueLocked:fg().bool,dragging:fg().object,isDraggingTempo:fg().bool},r}(e,t));return r.displayName="ConnectedGroupContainer",r};function Jh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jh=function(){return!!e})()}var Xh={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},Yh=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,Jh()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.removeSelf,i=e.setLock,a=e.isLocked,l=e.isTrueLocked,s=e.id,u=e.parentField,c=e.canAddGroup,p=e.canAddRule,d=e.canDeleteGroup,f=t.settings,g=f.immutableGroupsMode,v=f.addRuleLabel,h=f.addGroupLabel,y=f.addSubRuleLabel,m=f.addSubGroupLabel,b=f.delGroupLabel,O=f.groupActionsPosition,_=f.renderButton,S=f.renderIcon,w=f.renderSwitch,A=f.renderButtonGroup,F=f.lockLabel,j=f.lockedLabel,E=f.showLock,k=f.canDeleteLocked,L=function(e){return S(e,t.ctx)},x=function(e){return _(e,t.ctx)},I=function(e){return w(e,t.ctx)},T=function(e){return A(e,t.ctx)},P=Xh[O||"topRight"],R=E&&!(a&&!l)&&C().createElement(I,{type:"lock",id:s,value:a,setValue:i,label:F,checkedLabel:j,config:t}),N=!g&&p&&!a&&C().createElement(x,{type:u?"addSubRule":"addRule",onClick:r,label:u?y:v,readonly:a,config:t,renderIcon:L}),D=!g&&c&&!a&&C().createElement(x,{type:u?"addSubGroup":"addGroup",onClick:n,label:u?m:h,readonly:a,config:t,renderIcon:L}),V=!g&&d&&(!a||a&&k)&&C().createElement(x,{type:"delGroup",onClick:o,label:b,config:t,renderIcon:L});return C().createElement("div",{className:"group--actions ".concat(P)},C().createElement(T,{config:t},R,N,D,V))}}])}(k.PureComponent);function Qh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ey(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zh(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ty(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ty=function(){return!!e})()}var ry=pg.ConfigUtils.getFieldConfig,ny=pg.RuleUtils.isEmptyGroupChildren,oy=pg.TreeUtils,iy=(oy.getTotalReordableNodesCountInTree,oy.getTotalRulesCountInTree),ay=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,ty()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return""},r.renderBeforeActions=function(){var e=r.BeforeActions;return null==e?null:C().createElement(e,(0,Jg.A)({key:"group-actions-before"},r.props))},r.renderAfterActions=function(){var e=r.AfterActions;return null==e?null:C().createElement(e,(0,Jg.A)({key:"group-actions-after"},r.props))},Dg(r),r.onPropsChanged(e),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props;if(!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config)){var n=e.config,o=n.settings,i=o.renderIcon,a=o.renderConjs,l=o.renderBeforeActions,s=o.renderAfterActions;this.Icon=wv(n,i),this.Conjs=wv(n,a),this.BeforeActions=wv(n,l),this.AfterActions=wv(n,s)}this.doRemove=function(){t.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return $h()(this.props.config.settings.groupActionsPosition||"topRight","top")}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,i=n.removeGroupConfirmOptions;i&&!this.isEmptyCurrentGroup()?o.call(r.ctx,ey(ey({},i),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config;return ny(t,r)}},{key:"showNot",value:function(){var e=this.props,t=e.config,r=e.parentField,n=t.settings.showNot;if(r){var o,i=ry(t,r);n=n&&(null===(o=null==i?void 0:i.showNot)||void 0===o||o)}return n}},{key:"showConjs",value:function(){var e=this.props.config.settings.forceShowConj,t=this.conjunctionOptions();return Object.keys(t).length>1&&!this.isOneChild()||this.showNot()||e}},{key:"isNoChildren",value:function(){var e=this.props.children1;return!e||0==e.size}},{key:"isOneChild",value:function(){var e=this.props.children1;return!e||e.size<2}},{key:"renderChildrenWrapper",value:function(){return this.props.children1&&C().createElement("div",{key:"group-children",className:Yg()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var e=this.isGroupTopPosition();return C().createElement("div",{key:"group-header",className:Yg()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),e&&this.renderBeforeActions(),e&&this.renderActions(),e&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){return!this.isGroupTopPosition()&&C().createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id,l=e.parentField;return C().createElement(Yh,{key:"group-actions",config:t,addRule:r,addGroup:n,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a,parentField:l})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props,t=e.totalRulesCnt,r=e.isMaxNestingExceeded,n=e.parentField,o=this.props.config.settings.maxNumberOfRules;return n&&(o=ry(this.props.config,n).maxNumberOfRules),!r&&(!o||t<o)}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var e=this.props.children1;return e?e.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(e){if(e){var t=this.props,r=t.config,n=t.actions,o=t.onDragStart,i=t.isLocked,a=t.parentField,l=t.parentFieldPathSize,s=t.parentFieldCanReorder,u="group"==e.get("type")&&null!=e.getIn(["properties","field"])?"rule_group":e.get("type");return C().createElement(Xy,(0,Jg.A)({key:e.get("id"),id:e.get("id"),groupId:t.id,path:e.get("path"),type:u,properties:e.get("properties"),config:r,actions:n,children1:e.get("children1"),parentField:a,parentFieldPathSize:l,parentFieldCanReorder:s,reordableNodesCnt:this.reordableNodesCntForItem(e),totalRulesCnt:this.totalRulesCntForItem(e),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:i},this.extraPropsForItem(e)))}}},{key:"extraPropsForItem",value:function(e){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return"rule_group"===e.get("type")?iy(e):this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var e=this.props,t=e.config,r=e.isRoot,n=e.isLocked,o=e.parentField,i=e.parentFieldCanReorder,a=this.reordableNodesCnt(),l=t.settings.canReorder&&!r&&a>1&&!n;return o&&(l=l&&i),l}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.Icon,r=C().createElement(t,{type:"drag"});return this.showDragIcon()&&C().createElement("div",{key:"group-drag-icon",onMouseDown:e,className:"qb-drag-handler group--drag-handler"},r)}},{key:"conjunctionOptions",value:function(){var e=this.props,t=e.parentField,r=e.conjunctionOptions;return t?this.conjunctionOptionsForGroupField(t):r}},{key:"conjunctionOptionsForGroupField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.props,r=t.config,n=t.conjunctionOptions,o=ry(r,e);if(null!=o&&o.conjunctions){var i,a={},l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Qh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qh(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(o.conjunctions);try{for(l.s();!(i=l.n()).done;){var s=i.value,u=n[s];u&&(a[s]=u)}}catch(e){l.e(e)}finally{l.f()}return a}return n}},{key:"renderConjs",value:function(){var e=this.props,t=e.config,r=e.children1,n=e.id,o=e.selectedConjunction,i=e.setConjunction,a=e.not,l=e.setNot,s=e.isLocked,u=t.settings,c=u.immutableGroupsMode,p=u.notLabel,d=this.conjunctionOptions();if(!this.showConjs())return null;if(!r||!r.size)return null;var f={disabled:this.isOneChild(),readonly:c||s,selectedConjunction:o,setConjunction:c?bv:i,conjunctionOptions:d,config:t,not:a||!1,id:n,setNot:c?bv:l,notLabel:p,showNot:this.showNot(),isLocked:s},g=this.Conjs;return C().createElement(g,(0,Jg.A)({key:"group-conjs"},f))}},{key:"renderHeader",value:function(){return C().createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return C().createElement(C().Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(k.Component);ay.propTypes={reordableNodesCnt:fg().number,conjunctionOptions:fg().object.isRequired,allowFurtherNesting:fg().bool.isRequired,isMaxNestingExceeded:fg().bool,isRoot:fg().bool.isRequired,not:fg().bool,selectedConjunction:fg().string,config:fg().object.isRequired,id:fg().string.isRequired,groupId:fg().string,path:fg().any,children1:fg().any,isDraggingMe:fg().bool,isDraggingTempo:fg().bool,isLocked:fg().bool,isTrueLocked:fg().bool,parentField:fg().string,handleDraggerMouseDown:fg().func,onDragStart:fg().func,addRule:fg().func.isRequired,addGroup:fg().func.isRequired,removeSelf:fg().func.isRequired,setConjunction:fg().func.isRequired,setNot:fg().func.isRequired,setLock:fg().func.isRequired,actions:fg().object.isRequired};const ly=Hh(av("group")(_v(ay)),"group");function sy(){return sy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=(0,j.A)(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},sy.apply(null,arguments)}function uy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uy=function(){return!!e})()}var cy=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,uy()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,a=e.setLock,l=e.isLocked,s=e.isTrueLocked,u=e.id,c=t.settings,p=c.immutableGroupsMode,d=c.addRuleLabel,f=c.delGroupLabel,g=c.renderButton,v=c.renderIcon,h=c.renderSwitch,y=c.renderButtonGroup,m=c.lockLabel,b=c.lockedLabel,O=c.showLock,_=c.canDeleteLocked,S=function(e){return v(e,t.ctx)},w=function(e){return g(e,t.ctx)},A=function(e){return h(e,t.ctx)},F=function(e){return y(e,t.ctx)},j=O&&!(l&&!s)&&C().createElement(A,{type:"lock",id:u,value:l,setValue:a,label:m,checkedLabel:b,hideLabel:!0,config:t}),E=!p&&n&&!l&&C().createElement(w,{type:"addSubRuleSimple",onClick:r,label:d,readonly:l,config:t,renderIcon:S}),k=!p&&o&&(!l||l&&_)&&C().createElement(w,{type:"delRuleGroup",onClick:i,label:f,config:t,renderIcon:S});return C().createElement("div",{className:"group--actions"},C().createElement(F,{config:t},j,E,k))}}])}(k.PureComponent);function py(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?py(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):py(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function fy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fy=function(){return!!e})()}var gy=pg.ConfigUtils.getFieldConfig,vy=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,fy()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){sy((0,j.A)(t.prototype),"onPropsChanged",this).call(this,e)}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"renderChildrenWrapper",value:function(){return C().createElement(C().Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),sy((0,j.A)(t.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,a=e.setFuncValue,l=e.setFieldSrc,s=e.parentField,u=e.id,c=e.groupId,p=e.isLocked,d=t.settings.immutableFieldsMode;return C().createElement(Eh,{key:"field",classname:"group--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:a,setFieldSrc:l,parentField:s,readonly:d||p,id:u,groupId:c})}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return C().createElement(cy,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"extraPropsForItem",value:function(e){var t,r=this.props,n=r.selectedField,o=r.lev,i=r.config,a=gy(i,n);return{parentField:n,parentFieldPathSize:o+1,parentFieldCanReorder:null!==(t=null==a?void 0:a.canReorder)&&void 0!==t?t:i.settings.canReorder}}}])}(ay);vy.propTypes=dy(dy({},ay.propTypes),{},{selectedField:fg().any,selectedFieldSrc:fg().string,parentField:fg().string,setField:fg().func,setFieldSrc:fg().func,lev:fg().number});const hy=Hh(av("group rule_group")(_v(vy)),"rule_group");function yy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yy=function(){return!!e})()}var my=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,yy()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.canAddRule,i=e.canAddGroup,a=e.canDeleteGroup,l=e.removeSelf,s=e.setLock,u=e.isLocked,c=e.isTrueLocked,p=e.id,d=t.settings,f=d.immutableGroupsMode,g=d.addSubRuleLabel,v=d.addSubGroupLabel,h=d.delGroupLabel,y=d.renderButton,m=d.renderIcon,b=d.renderSwitch,O=d.renderButtonGroup,_=d.lockLabel,S=d.lockedLabel,w=d.showLock,A=d.canDeleteLocked,F=function(e){return m(e,t.ctx)},j=function(e){return y(e,t.ctx)},E=function(e){return b(e,t.ctx)},k=function(e){return O(e,t.ctx)},L=w&&!(u&&!c)&&C().createElement(E,{type:"lock",id:p,value:u,setValue:s,label:_,checkedLabel:S,config:t}),x=!f&&o&&!u&&C().createElement(j,{type:"addSubRule",onClick:r,label:g,readonly:u,config:t,renderIcon:F}),I=!f&&i&&!u&&C().createElement(j,{type:"addSubGroup",onClick:n,label:v,readonly:u,config:t,renderIcon:F}),T=!f&&a&&(!u||u&&A)&&C().createElement(j,{type:"delRuleGroup",onClick:l,label:h,config:t,renderIcon:F});return C().createElement("div",{className:"group--actions group--actions--tr"},C().createElement(k,{config:t},L,x,I,T))}}])}(k.PureComponent);function by(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?by(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):by(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_y=function(){return!!e})()}var Sy=pg.ConfigUtils,wy=Sy.getFieldConfig,Ay=Sy.getFieldWidgetConfig,Fy=pg.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,jy=pg.TreeUtils.getTotalReordableNodesCountInTree,Ey=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,_y()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canDeleteGroup=function(){return!0},r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){sy((0,j.A)(t.prototype),"onPropsChanged",this).call(this,e)}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=wy(t,r).maxNumberOfRules,o=this.props.totalRulesCnt;return!n||o<n}},{key:"renderHeaderWrapper",value:function(){return C().createElement("div",{key:"group-header",className:Yg()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return C().createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return C().createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings,o=n.renderRuleError,i=n.showErrorMessage,a=(0,I.A)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return i&&a&&C().createElement("div",{className:"rule_group--error"},o?o({error:a},t.ctx):a)}},{key:"showNot",value:function(){var e,t=this.props,r=t.config,n=t.selectedField,o=wy(r,n);return null!==(e=null==o?void 0:o.showNot)&&void 0!==e?e:r.settings.showNot}},{key:"conjunctionOptions",value:function(){var e=this.props.selectedField;return this.conjunctionOptionsForGroupField(e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,a=e.setFieldSrc,l=e.setFuncValue,s=e.parentField,u=e.id,c=e.groupId,p=e.isLocked,d=t.settings.immutableFieldsMode;return C().createElement(Eh,{key:"field",classname:"rule--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:l,setFieldSrc:a,parentField:s,readonly:d||p,id:u,groupId:c})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedOperator,i=(e.setField,e.setOperator),a=e.isLocked,l=t.settings.immutableFieldsMode,s=Ay(t,r,o)||{},u=s.hideOperator,c=r&&u&&s.operatorInlineLabel,p=r&&!u;return C().createElement(Fv,{key:"operator",classname:"group--operator",config:t,selectedField:r,selectedFieldSrc:n,selectedOperator:o,setOperator:i,showOperator:p,showOperatorLabel:c,selectedFieldWidgetConfig:s,readonly:l||a,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config,n=this._buildWidgetProps(this.props);return Fy(n,t,r)}},{key:"_buildWidgetProps",value:function(e){var t=e.selectedField,r=e.selectedFieldSrc,n=e.selectedFieldType,o=e.selectedOperator,i=e.operatorOptions,a=e.value,l=e.valueType,s=(e.valueSrc,e.asyncListValues,e.valueError);return e.fieldError,{field:t,fieldSrc:r,fieldType:n,operator:o,operatorOptions:i,value:a,valueType:l,valueSrc:["value"],valueError:s,fieldError:null,parentField:e.parentField}}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.isLocked,i=t.settings.immutableValuesMode;if(!r||!n)return null;var a=C().createElement(bh,(0,Jg.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:t,setValue:i?bv:this.props.setValue,setValueSrc:bv,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return C().createElement(mv,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},a)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id;return C().createElement(my,{config:t,addRule:r,addGroup:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props,r=t.children1,n=t.id;return jy({id:n,type:"rule_group",children1:r})}},{key:"extraPropsForItem",value:function(e){var t,r=this.props,n=r.selectedField,o=r.lev,i=r.config,a=wy(i,n);return{parentField:n,parentFieldPathSize:o+1,parentFieldCanReorder:null!==(t=null==a?void 0:a.canReorder)&&void 0!==t?t:i.settings.canReorder}}}])}(ay);Ey.propTypes=Oy(Oy({},ay.propTypes),{},{selectedField:fg().any,selectedFieldSrc:fg().string,selectedOperator:fg().string,value:fg().any,parentField:fg().string,setField:fg().func,setFieldSrc:fg().func,setOperator:fg().func,setValue:fg().func,valueError:fg().any,lev:fg().number});const ky=Hh(av("group rule_group_ext")(_v(Ey)),"rule_group");function Cy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Cy=function(){return!!e})()}var Ly={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},xy=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,Cy()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.setLock,i=e.isLocked,a=e.isTrueLocked,l=e.id,s=e.canAddGroup,u=e.canAddDefault,c=t.settings,p=c.immutableGroupsMode,d=c.addCaseLabel,f=c.addDefaultCaseLabel,g=c.groupActionsPosition,v=c.renderButton,h=c.renderIcon,y=c.renderSwitch,m=c.renderButtonGroup,b=c.lockLabel,O=c.lockedLabel,_=c.showLock,S=function(e){return h(e,t.ctx)},w=function(e){return v(e,t.ctx)},A=function(e){return y(e,t.ctx)},F=function(e){return m(e,t.ctx)},j=Ly[g||"topRight"],E=_&&!(i&&!a)&&C().createElement(A,{type:"lock",id:l,value:i,setValue:o,label:b,checkedLabel:O,config:t}),k=!p&&s&&!i&&C().createElement(w,{type:"addCaseGroup",onClick:r,label:d,readonly:i,config:t,renderIcon:S}),L=!p&&u&&!i&&C().createElement(w,{type:"addDefaultCaseGroup",onClick:n,label:f,readonly:i,config:t,renderIcon:S});return C().createElement("div",{className:"group--actions ".concat(j)},C().createElement(F,{config:t},E,k,L))}}])}(k.PureComponent);function Iy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ty(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ty=function(){return!!e})()}var Py=pg.TreeUtils,Ry=Py.getTotalReordableNodesCountInTree,Ny=Py.getTotalRulesCountInTree,Dy=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,Ty()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var e;return(null===(e=r.props.children1)||void 0===e?void 0:e.size)&&r.props.children1.filter((function(e){return null==e.get("children1")})).size>0},r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){sy((0,j.A)(t.prototype),"onPropsChanged",this).call(this,e)}},{key:"canAddGroup",value:function(){var e,t=this.props.config.settings.maxNumberOfCases,r=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return!t||r<t}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var e,t=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return this.hasDefaultCase()&&t--,t}},{key:"totalRulesCntForItem",value:function(e){return Ny(e)}},{key:"reordableNodesCntForItem",value:function(e){var t;if(this.props.isLocked)return 0;var r=this.props.config.settings,n=r.canLeaveEmptyCase,o=r.canRegroupCases,i=(null===(t=this.props.children1)||void 0===t?void 0:t.size)||0;this.hasDefaultCase()&&i--;var a=Ry(e);return 1==a&&o&&n&&i>1&&(a=111),a}},{key:"showConjs",value:function(){return!0}},{key:"renderHeaderWrapper",value:function(){return C().createElement("div",{key:"group-header",className:Yg()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return C().createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){return this.props.config.settings.renderSwitchPrefix||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id;return C().createElement(xy,{config:t,addCaseGroup:r,addDefaultCaseGroup:n,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}}])}(ay);Dy.propTypes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Iy(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iy(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},ay.propTypes);const Vy=Hh(av("group switch_group")(_v(Dy)),"switch_group");function zy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function My(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zy(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zy(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(qy=function(){return!!e})()}var Wy=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,qy()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var r=this.props,n=!this.renderBeforeCaseValue||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if(sy((0,j.A)(t.prototype),"onPropsChanged",this).call(this,e),n){var o=e.config,i=o.settings,a=i.renderBeforeCaseValue,l=i.renderAfterCaseValue,s=i.renderRuleError;this.BeforeCaseValue=wv(o,a),this.AfterCaseValue=wv(o,l),this.RuleError=wv(o,s)}}},{key:"isDefaultCase",value:function(){return null==this.props.children1}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return!this.isDefaultCase()&&sy((0,j.A)(t.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return C().createElement("div",{key:"group-header",className:Yg()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:C().createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){return this.isDefaultCase()?this.props.config.settings.defaultCaseLabel||"":C().createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:sy((0,j.A)(t.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?C().createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return!this.isDefaultCase()&&sy((0,j.A)(t.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return!this.isDefaultCase()&&sy((0,j.A)(t.prototype),"canAddRule",this).call(this)}},{key:"renderBeforeValue",value:function(){var e=this.BeforeCaseValue;return null==e?null:C().createElement(e,(0,Jg.A)({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var e=this.AfterCaseValue;return null==e?null:C().createElement(e,(0,Jg.A)({key:"values-after"},this.props))}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings.showErrorMessage,o=this.RuleError,i=(0,I.A)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return n&&i&&C().createElement("div",{className:"rule--error"},o?C().createElement(o,{error:i}):i)}},{key:"renderValue",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.value,o=e.valueSrc,i=e.valueError,a=e.setValue,l=e.setValueSrc,s=e.setFuncValue,u=e.id,c=t.settings.immutableValuesMode,p=C().createElement(bh,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:n,valueSrc:null!=o?o:"value",valueError:i,fieldError:null,config:t,setValue:c?bv:a,setValueSrc:c?bv:l,setFuncValue:c?bv:s,readonly:c||r,id:u,groupId:null});return C().createElement(mv,{className:"case_group--value"},p)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addGroup,n=e.addRule,o=e.isLocked,i=e.isTrueLocked,a=e.id;return C().createElement(Yh,{config:t,addGroup:r,addRule:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.value,r=e&&e.size?e.get(0):null,n=null!=r&&(!Array.isArray(r)||r.length>0);return sy((0,j.A)(t.prototype),"isEmptyCurrentGroup",this).call(this)&&!n}}])}(ay);Wy.propTypes=My(My({},ay.propTypes),{},{parentReordableNodesCnt:fg().number,value:fg().any,setValue:fg().func});const By=Hh(av("group case_group")(_v(Wy)),"case_group");var $y=["type"];function Uy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Uy=function(){return!!e})()}function Ky(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ky(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ky(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Hy=function(e){var t,r=(null===(t=e.properties)||void 0===t?void 0:t.toObject())||{},n=Gy({},r);return e.isParentLocked&&(n.isLocked=!0),r.isLocked&&(n.isTrueLocked=!0),n},Jy={rule:function(e){return C().createElement(Wh,(0,Jg.A)({},Hy(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},group:function(e){return C().createElement(ly,(0,Jg.A)({},Hy(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group:function(e){return C().createElement(hy,(0,Jg.A)({},Hy(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group_ext:function(e){return C().createElement(ky,(0,Jg.A)({},Hy(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},switch_group:function(e){return C().createElement(Vy,(0,Jg.A)({},Hy(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return C().createElement(By,(0,Jg.A)({},Hy(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},Xy=function(e){function t(){return(0,w.A)(this,t),e=this,r=t,n=arguments,r=(0,j.A)(r),(0,F.A)(e,Uy()?Reflect.construct(r,n||[],(0,j.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e,t=this.props,r=t.type,n=(0,jd.A)(t,$y),o="array"==(null===(e=n.properties)||void 0===e?void 0:e.get("mode"))?"_ext":"",i=n.config.settings.renderItem,a=Jy[r+o];return i?i(Gy(Gy({},n),{},{type:r,itemComponent:a}),n.config.ctx):a?a(n):null}}])}(k.PureComponent);function Yy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yy=function(){return!!e})()}Xy.propTypes={config:fg().object.isRequired,id:fg().string.isRequired,groupId:fg().string,type:fg().oneOf(["rule","group","rule_group","switch_group","case_group"]).isRequired,path:fg().any.isRequired,properties:fg().any,children1:fg().any,actions:fg().object.isRequired,reordableNodesCnt:fg().number,onDragStart:fg().func,parentField:fg().string,isDraggingTempo:fg().bool,isParentLocked:fg().bool};var Qy=pg.TreeUtils,Zy=Qy.getTotalReordableNodesCountInTree,em=Qy.getTotalRulesCountInTree,tm=pg.DefaultUtils,rm=tm.createListWithOneElement,nm=tm.emptyProperties,om=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),(r=(0,F.A)(n,Yy()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i))).pureShouldComponentUpdate=Ng(r),r._updPath(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.pureShouldComponentUpdate(e,t)}},{key:"_updPath",value:function(e){var t=e.tree.get("id");this.path=rm(t)}},{key:"render",value:function(){var e=this.props,t=e.tree,r=e.config,n=e.actions,o=e.onDragStart,i=t.get("type"),a="switch_group"==i,l=a?null:Zy(t),s=a?null:em(t),u=t.get("id");return C().createElement(Xy,{key:u,id:u,path:this.path,type:i,properties:t.get("properties")||nm(),config:r,actions:n,children1:t.get("children1")||nm(),reordableNodesCnt:l,totalRulesCnt:s,parentReordableNodesCnt:0,onDragStart:o})}}])}(k.Component);om.propTypes={tree:fg().any.isRequired,config:fg().object.isRequired,actions:fg().object.isRequired,onDragStart:fg().func};const im=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,yg.connect)((function(e){return{dragging:e.dragging,dragStart:e.dragStart,mousePos:e.mousePos}}),{setDragStart:wg,setDragProgress:Sg,setDragEnd:Ag},null,{context:vg})(function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=function(t){function n(e){var t,o,i,a;return(0,w.A)(this,n),o=this,i=n,a=[e],i=(0,j.A)(i),(t=(0,F.A)(o,ev()?Reflect.construct(i,a||[],(0,j.A)(o).constructor):i.apply(o,a)))._getEventTarget=function(e,t){return e&&e.__mocked_window||document.body||window},t.onDragStart=function(e,r,n){var o=r.closest(".query-builder");void 0===t._isUsingLegacyReactDomRender&&(t._isUsingLegacyReactDomRender=Pg(o)),document.body.classList.add("qb-dragging"),o.classList.add("qb-dragging");var i,a=o.closest(".query-builder-container")||o,l=(a=t._getScrollParent(a)||document.body).scrollTop,s=(t._getDraggableNodeEl(o),t._getPlaceholderNodeEl(o),o.querySelectorAll(".group--children")),u=s.length?s[0]:null;u&&(i=window.getComputedStyle(u,null).getPropertyValue("padding-left"),i=parseInt(i));var c={id:e,x:r.offsetLeft,y:r.offsetTop,w:r.offsetWidth,h:r.offsetHeight,itemInfo:t.tree.items[e],paddingLeft:i},p={id:e,x:r.offsetLeft,y:r.offsetTop,scrollTop:l,clientX:n.clientX,clientY:n.clientY,itemInfo:tv(t.tree.items[e]),treeEl:o,treeElContainer:a},d={clientX:n.clientX,clientY:n.clientY},f=t._getEventTarget(n,p);t.eventTarget=f,f.addEventListener("mousemove",t.onDrag),f.addEventListener("mouseup",t.onDragEnd),t.props.setDragStart(p,c,d)},t.onDrag=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.assign({},t.props.dragging),i=t.props.dragStart,a=o.paddingLeft,l=i.treeElContainer.scrollTop;if(o.itemInfo=t.tree.items[o.id],o.itemInfo){var s={clientX:e.clientX,clientY:e.clientY},u={clientX:i.clientX,clientY:i.clientY};if(e.__mock_dom){var c=i.treeEl,p=t._getDraggableNodeEl(c),d=t._getPlaceholderNodeEl(c);e.__mock_dom({treeEl:c,dragEl:p,plhEl:d})}if(!i.plX){var f=i.treeEl,g=t._getPlaceholderNodeEl(f);g&&(i.plX=g.getBoundingClientRect().left+window.scrollX,i.plY=g.getBoundingClientRect().top+window.scrollY)}var v=i.x,h=i.y,y=i.clientX,m=i.clientY,b=i.scrollTop,O={x:v+(e.clientX-y),y:h+(e.clientY-m)+(l-b)};o.x=O.x,o.y=O.y,o.paddingLeft=a,o.mousePos=s,o.startMousePos=u,t.props.setDragProgress(s,o),n&&t.handleDrag(o,e,r)||e.preventDefault&&e.preventDefault()}},t.onDragEnd=function(){var e=t.props.dragStart.treeEl;t.props.setDragEnd(),e.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),t._cacheEls={};var r=t.eventTarget||t._getEventTarget();r.removeEventListener("mousemove",t.onDrag),r.removeEventListener("mouseup",t.onDragEnd)},t.pureShouldComponentUpdate=Ng(t),Dg(t),t.onPropsChanged(e),t}return(0,E.A)(n,t),(0,A.A)(n,[{key:"onPropsChanged",value:function(e){this.tree=rv(e.tree,e.config)}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=[];for(var a in e)e[a]!=r[a]&&"dragging"!=a&&"mousePos"!=a&&i.push(a);i.length||(o=!1)}return o}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.dragging,n=this.props.dragStart;if(nv=!1,n&&n.id&&(r.itemInfo=this.tree.items[r.id],r.itemInfo&&(r.itemInfo.index!=n.itemInfo.index||r.itemInfo.parent!=n.itemInfo.parent))){var o=n.treeEl,i=n.treeElContainer,a=this._getPlaceholderNodeEl(o,!0);if(a){var l=a.getBoundingClientRect().left+window.scrollX,s=a.getBoundingClientRect().top+window.scrollY,u=n.plX,c=n.plY,p=i.scrollTop;n.plX=l,n.plY=s,n.itemInfo=tv(r.itemInfo),n.y=a.offsetTop,n.x=a.offsetLeft,n.clientY+=s-c,n.clientX+=l-u,i!=document.body&&(n.scrollTop=p),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t)return null;this._cacheEls||(this._cacheEls={});var n=this._cacheEls[t];return n&&document.contains(n)&&!r||(n=e.querySelector('.group-or-rule-container[data-id="'+t+'"]'),this._cacheEls[t]=n),n}},{key:"_getDraggableNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.draggable;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-draggable");return r=n.length?n[0]:null,this._cacheEls.draggable=r,r}},{key:"_getPlaceholderNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.placeholder;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-placeholder");return r=n.length?n[0]:null,this._cacheEls.placeholder=r,r}},{key:"_isScrollable",value:function(e){var t=window.getComputedStyle(e)["overflow-y"];return("scroll"===t||"auto"===t)&&e.scrollHeight>e.offsetHeight}},{key:"_getScrollParent",value:function(e){return null==e?null:e===document.body||this._isScrollable(e)?e:this._getScrollParent(e.parentNode)}},{key:"handleDrag",value:function(e,t,r){var n,o,i,a,l=this,s=e.itemInfo,u=e.paddingLeft,c=null,p=this.props.dragStart.treeEl,d=e.id,f=this._getDraggableNodeEl(p),g=this._getPlaceholderNodeEl(p);if(f&&g){if(n=f.getBoundingClientRect(),!(o=g.getBoundingClientRect()).width)return;var v={hrz:0,vrt:0};n.top<o.top?v.vrt=-1:n.bottom>o.bottom&&(v.vrt=1),n.left>o.left?v.hrz=1:n.left<o.left&&(v.hrz=-1);var h,y={x:(a=p.getBoundingClientRect()).left+(a.right-a.left)/2,y:v.vrt>=0?n.bottom:n.top};if(t.__mocked_hov_container)h=t.__mocked_hov_container;else{var m=document.elementFromPoint(y.x,y.y-1);if(!(h=m?m.closest(".group-or-rule-container"):null)&&m&&m.classList.contains("query-builder-container")){var b,O=null==m||null===(b=m.firstChild)||void 0===b?void 0:b.firstChild;O&&O.classList.contains("group-or-rule-container")&&(h=O)}}if(h){var _=h.classList.contains("group-container"),S=h.getAttribute("data-id"),w=h,A=!1,F=!1;if(w){var j=(i=w.getBoundingClientRect()).bottom-i.top,E=this.tree.items[S];if(!E)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var k=null,C=null,L=null,x=null;if(0==v.vrt)L=s,(C=g)&&(k=C.getBoundingClientRect());else if(_){if(v.vrt>0){var T=h.getElementsByClassName("group--header"),P=T.length?T[0]:null;if(P){var R=P.getBoundingClientRect(),N=R.bottom-R.top;n.bottom-R.top>3*N/4&&E.top>e.itemInfo.top&&(L=E,k=R,C=P,F=!0)}}else v.vrt<0&&E.lev>=s.lev&&i.bottom-n.top>=2&&E.top<e.itemInfo.top&&(L=E,k=i,C=w,A=!0);(v.vrt<0?i.bottom-n.top>j-5:n.bottom-i.top>j-5)&&(F||A||(L=E,k=i,C=w),x=E)}else(v.vrt<0?i.bottom-n.top>j/2:n.bottom-i.top>j/2)&&(L=E,k=i,C=w);var D=L&&L.id==d;if(k){var V=n.left-a.left,z=(k.left,a.left,Math.max(0,Math.round(V/u))),M=[],q=[];if(D);else{if(_&&(A?M.push([Og,L,L.lev+1]):F&&M.push([_g,L,L.lev+1]),x)){var W=0==x.lev,B="case_group"==x.type&&"case_group"!=s.type,$=x.prev&&this.tree.items[x.prev].caseId,U=x.next&&this.tree.items[x.next].caseId;s.caseId==$&&($=null),s.caseId==U&&(U=null);var K=$&&this.tree.items[$],G=U&&this.tree.items[U];v.vrt>0?W?q.push([Og,x,x.lev+1]):B&&G?q.push([_g,G,G.lev+1]):q.push([mg,x,x.lev]):v.vrt<0&&(W?q.push([_g,x,x.lev+1]):B&&K?q.push([Og,K,K.lev+1]):q.push([bg,x,x.lev]))}A||F||(v.vrt<0?M.push([bg,L,L.lev]):v.vrt>0&&M.push([mg,L,L.lev]))}var H=function(e){var t=e[1],r=s.caseId?l.tree.items[s.caseId]:null,n=t.caseId?l.tree.items[t.caseId]:null;return[].concat((0,I.A)(e),[r,n])};M=M.map(H),q=q.map(H);var J=null,X=(M=M.filter((function(e){var t=e[0],r=e[1];if((t==bg||t==mg)&&null==r.parent)return!1;if(r.collapsed&&(t==Og||t==_g))return!1;var n=r.id==s.id;if(!n)for(var o=r;o.parent;)if((o=l.tree.items[o.parent]).id==s.id){n=!0;break}return!n})).map((function(e){var t=e[0],r=e[1],n=(e[2],e[3],e[4],null);return(n=t==Og||t==_g?r:l.tree.items[r.parent])&&null==n.parent&&(n=null),e[5]=n,e}))).filter((function(e){return l.canMove(s,e[1],e[0],e[3],e[4],e[5],r)}));0==X.length&&q.length>0&&(X=q.filter((function(e){return l.canMove(s,e[1],e[0],e[3],e[4],e[5],r)})));var Y=X.map((function(e){return e[2]})),Q=s.lev,Z=Y.concat(Q),ee=null;-1!=Z.indexOf(z)?ee=z:z>Math.max.apply(Math,(0,I.A)(Z))?ee=Math.max.apply(Math,(0,I.A)(Z)):z<Math.min.apply(Math,(0,I.A)(Z))&&(ee=Math.min.apply(Math,(0,I.A)(Z))),J=X.find((function(e){return e[2]==ee})),D||J||!X.length||(J=X[0]),c=J}}}else xg.log("out of tree bounds!")}return!!c&&(this.move(s,c[1],c[0],c[3]),!0)}},{key:"canMove",value:function(e,t,r,n,o,i,a){if(!e||!t)return!1;if(e.id===t.id)return!1;var l=this.props.config.settings,s=l.canRegroup,u=l.canRegroupCases,c=l.maxNesting,p=l.maxNumberOfRules,d=l.canLeaveEmptyCase,f=(i?i.nextAtomicLev:t.atomicLev)+(e.closestRuleGroupId?0:e.depth||("group"==e.type?1:0)),g=r==bg||r==mg,v=r==_g||r==Og,h=g&&1==t.lev||v&&0==t.lev,y=e.parent!=t.parent,m=v||y,b="rule_group"==e.type||!!e.closestRuleGroupId||"rule_group"==t.type||!!t.closestRuleGroupId,O=v&&"rule_group"==t.type?t.id:t.closestRuleGroupId,_=v&&"rule_group"==t.type?t.maxNesting:t.closestRuleGroupMaxNesting,S=0!=(v&&"rule_group"==t.type?t.canRegroup:t.closestRuleGroupCanRegroup),w=v&&"rule_group"==t.type?t.lev:t.closestRuleGroupLev,A=(i?i.lev+1:t.lev)+(e.depth||("group"==e.type?1:0))-(w||0),F=b&&e.closestRuleGroupId!=O,j="case_group"==e.type&&!h||"case_group"!=e.type&&"case_group"==t.type&&g||"case_group"!=e.type&&"switch_group"==t.type||!u&&e.caseId!=t.caseId||F,E=t.isLocked||e.isLocked||i&&i.isLocked;if(c&&f>c)return!1;if(_&&A>_)return!1;if(m&&(!s||j||E))return!1;if(b&&m&&!S)return!1;if("case_group"!=e.type&&e.caseId!=t.caseId){var k=!!n&&2==n._height,C=o?o.atomicRulesCountInCase+1:0;if(p&&C>p)return!1;if(k&&!d)return!1}if("case_group"==e.type&&(e.isDefaultCase||t.isDefaultCase||"switch_group"==t.type&&r==Og))return!1;var L=!0;return a&&(L=a(e.node.toJS(),t.node.toJS(),r,i?i.node.toJS():null)),L}},{key:"move",value:function(e,t,r,n){this._isUsingLegacyReactDomRender||(nv=!0),this.props.actions.moveItem(e.path,t.path,r)}},{key:"render",value:function(){return C().createElement(e,(0,Jg.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(k.Component),t.propTypes={tree:fg().any.isRequired,actions:fg().object.isRequired},t}(e,t));return r.displayName="ConnectedSortableContainer",r}(om);function am(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(lm=function(){return!!e})()}var sm=pg.clone,um=pg.ConfigUtils,cm=um.getFieldConfig,pm=um.getFieldParts,dm=um.getFieldPathParts,fm=pg.RuleUtils,gm=fm.getFieldPathLabels,vm=fm.getWidgetForFieldOp,hm=function(e){function t(e){var r,n,o,i;return(0,w.A)(this,t),n=this,o=t,i=[e],o=(0,j.A)(o),r=(0,F.A)(n,lm()?Reflect.construct(o,i||[],(0,j.A)(n).constructor):o.apply(n,i)),Dg(r),r.onPropsChanged(e),r}return(0,E.A)(t,e),(0,A.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0,n=!this.meta||["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;r&&(this.items=this.getItems(e)),n&&(this.meta=this.getMeta(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.fieldType,o=e.operator,i=e.parentField,a=e.isFuncArg,l=e.fieldDefinition,s=t.settings.canCompareFieldWithField,u=pm(i,t),c=i?cm(t,i):null,p=i?null==c?void 0:c.subfields:t.fields,d=this.filterFields(t,p,r,i,u,o,s,a,l,n);return this.buildOptions(u,t,d,u)}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.field,o=(e.fieldType,e.operator,e.value),i=e.placeholder,a=e.isFuncArg,l=e.parentField,s=r.settings,u=s.fieldPlaceholder,c=s.fieldSeparatorDisplay,p=o,d=!!o,f=n?cm(r,n):{},g=null==f||null===(t=f.widgets)||void 0===t?void 0:t.field,v=(null==g?void 0:g.widgetProps)||{},h=d?null:a&&i||v.valuePlaceholder||u,y=d?cm(r,p):null,m=y||{},b=dm(p,r),O=dm(p,r,!0),_=this.getFieldLabel(y,p,r),S=gm(p,r),w=S?S.join(c):null;return(w==_||l)&&(w=null),{placeholder:h,selectedKey:p,selectedKeys:b,selectedPath:O,selectedLabel:_,selectedOpts:m,selectedAltLabel:m.label2||m.tooltip,selectedFullLabel:w}}},{key:"filterFields",value:function(e,t,r,n,o,i,a,l,s,u){t=sm(t);var c,p=e.settings.fieldSeparator,d=cm(e,r),f=vm(e,r,i,"value");return e.widgets[f],c=l?null==s?void 0:s.type:d?d.type:u,function t(n,o){for(var s in n){var u=n[s].subfields,f=(o||[]).concat(s),g=f.join(p),v=cm(e,g);if(v)if("!struct"==v.type||"!group"==v.type)0==t(u,f)&&delete n[s];else{var h=!(c&&v.type!=c||!l&&g==r),y=a||e.settings.canCompareFieldWithField;y&&(h=h&&y(r,d,g,v,i)),h||delete n[s]}else delete n[s]}return sv()(n).length}(t,o||[]),t}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var a=t.settings,l=a.fieldSeparator,s=a.fieldSeparatorDisplay,u=null!=o&&o.length?o.join(l)+l:"";return sv()(r).map((function(a){var l=[].concat((0,I.A)(null!=o?o:[]),[a]),c=r[a],p=n.getFieldLabel(c,l,t),d=gm(l,t).join(s);(d==p||e)&&(d=null);var f=c.label2,g=c.tooltip;if(!c.hideForCompare)return"!struct"==c.type||"!group"==c.type?{key:a,path:u+a,label:p,fullLabel:d,altLabel:f,tooltip:g,items:n.buildOptions(e,t,c.subfields,l,{label:p,tooltip:g})}:{key:a,path:u+a,label:p,fullLabel:d,altLabel:f,tooltip:g,grouplabel:null==i?void 0:i.label,group:i}})).filter((function(e){return!!e}))}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=pm(t,r),i=(null==e?void 0:e.label)||Lo()(o);return kg(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,a=e.groupId,l=t.settings.renderField,s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?am(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):am(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isValueField:!0,config:t,customProps:r,setField:n,readonly:o,items:this.items,id:i,groupId:a},this.meta);return l(s,t.ctx)}}])}(k.Component);hm.propTypes={id:fg().string,groupId:fg().string,setValue:fg().func.isRequired,config:fg().object.isRequired,field:fg().any,fieldSrc:fg().string,fieldType:fg().string,value:fg().string,operator:fg().string,customProps:fg().object,readonly:fg().bool,parentField:fg().string,fieldDefinition:fg().object,isFuncArg:fg().bool};const ym=function(e){var t=e.value,r=e.setValue,n=(e.config,e.labelYes),o=e.labelNo,i=e.readonly,a=(e.widgetId,e.customProps),l=void 0===a?{}:a,s=l.radioYes||{},u=l.radioNo||{},c=function(e){return r("true"==e.target.value)};return C().createElement(C().Fragment,null,C().createElement("input",(0,Jg.A)({type:"radio",value:!0,checked:!!t,disabled:i,onChange:c},s))," ",n,C().createElement("input",(0,Jg.A)({type:"radio",value:!1,checked:!t,disabled:i,onChange:c},u))," ",o)},mm=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,a=e.customProps,l=t||"";return C().createElement("input",(0,Jg.A)({type:"text",value:l,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i},a))},bm=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,a=(e.maxRows,e.fullWidth),l=e.customProps,s=t||"";return C().createElement("textarea",(0,Jg.A)({value:s,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i,style:{width:a?"100%":void 0}},l))};pg.moment;const Om=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.readonly),o=e.customProps;return C().createElement("input",(0,Jg.A)({type:"date",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},_m=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.use12Hours,e.readonly),o=e.customProps;return C().createElement("input",(0,Jg.A)({type:"time",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))};var Sm=pg.moment;const wm=function(e){var t,r=e.value,n=e.setValue,o=(e.config,e.valueFormat),i=(e.use12Hours,e.readonly),a=e.customProps;return t=r?Sm(r).format("YYYY-MM-DDTHH:mm"):"",C().createElement("input",(0,Jg.A)({type:"datetime-local",value:t,disabled:i,onChange:function(e){var t=e.target.value;t=""==t?void 0:Sm(new Date(t)).format(o),n(t)}},a))};var Am=pg.ListUtils.mapListValues;const Fm=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps;return C().createElement("select",(0,Jg.A)({multiple:!0,onChange:function(e){return n(function(e){for(var t=[],r=e.options,n=0;n<r.length;n++){var o=r[n];o.selected&&t.push(o.value)}return t.length||(t=void 0),t}(e.target))},value:r,disabled:o},Io()(i,["showSearch","input","showCheckboxes"])),Am(t,(function(e){var t=e.title,r=e.value;return C().createElement("option",{key:r,value:r},t)})))};var jm=pg.ListUtils.mapListValues;const Em=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps,a=null!=r;return C().createElement("select",(0,Jg.A)({onChange:function(e){return n(e.target.value)},value:a?r:"",disabled:o},Io()(i,["showSearch","input"])),!a&&C().createElement("option",{disabled:!0,value:""}),jm(t,(function(e){var t=e.title,r=e.value;return C().createElement("option",{key:r,value:r},t)})))},km=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,a=e.step,l=e.placeholder,s=e.customProps,u=null==t?"":t;return C().createElement("input",(0,Jg.A)({type:"number",value:u,placeholder:l,disabled:n,min:o,max:i,step:a,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},s))},Cm=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,a=e.step,l=e.placeholder,s=e.customProps,u=void 0===s?{}:s,c=u.input||{},p=u.slider||u,d=function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},f=null==t?"":t;return C().createElement("div",{style:{display:"inline-flex"}},C().createElement("input",(0,Jg.A)({key:"number",type:"number",value:f,placeholder:l,disabled:n,min:o,max:i,step:a,onChange:d},c)),C().createElement("input",(0,Jg.A)({key:"range",type:"range",value:f,disabled:n,min:o,max:i,step:a,onChange:d},p)))},Lm=function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,i=e.errorText,a=null!=n;return C().createElement("select",{onChange:function(e){return r(e.target.value)},value:a?n:"",disabled:o,style:{color:i?"red":null}},!a&&C().createElement("option",{disabled:!0,value:""}),function e(t){return t.map((function(t){var r=t.items,n=t.path,o=t.label,i=t.disabled,a=t.matchesType;if(r)return C().createElement("optgroup",{disabled:i,key:n,label:o},e(r));var l=a?{fontWeight:"bold"}:{};return C().createElement("option",{disabled:i,key:n,value:n,style:l},o)}))}(t))},xm=function(e){var t,r=e.id,n=e.not,o=e.setNot,i=e.conjunctionOptions,a=e.setConjunction,l=e.disabled,s=e.readonly,u=e.config,c=e.showNot,p=e.notLabel,d=Object.keys(i).length,f=l,g=u.settings.forceShowConj||d>1&&!f,v=function(e){return a(e.target.value)};return[c&&(t="not",[C().createElement("input",{key:r+t,type:"checkbox",id:r+t,checked:n,disabled:s,onChange:function(e){return o(e.target.checked)}}),C().createElement("label",{key:r+t+"label",htmlFor:r+t},p||"NOT")]),g&&Object.keys(i).map((function(e){var t=i[e],r=t.id,n=t.name,o=t.label,u=t.checked,c=a.isDummyFn?"__dummy":"";return!s&&!l||u?[C().createElement("input",{key:r+c,type:"radio",id:r+c,name:n+c,checked:u,disabled:s||l,value:e,onChange:v}),C().createElement("label",{key:r+c+"label",htmlFor:r+c},o)]:null}))]};var Im={addSubRuleSimple:"+",addSubRule:"+",addSubGroup:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const Tm=function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,i=r||Im[t];return C().createElement("button",{onClick:n,type:"button",disabled:o},i)},Pm=function(e){var t=e.type,r={}[t]||null;return r||"drag"!==t||(r=C().createElement(Ov,null)),r},Rm=function(e){var t=e.children;return e.config,C().createElement(C().Fragment,null,t)},Nm=function(e){e.config;var t=e.valueSources,r=e.valueSrc,n=(e.title,e.setValueSrc),o=e.readonly;return C().createElement("select",{onChange:function(e){return n(e.target.value)},value:r||"",disabled:o},function(e){return e.map((function(e){var t=(0,x.A)(e,2),r=t[0],n=t[1];return C().createElement("option",{key:r,value:r},n.label)}))}(t))},Dm=function(e){var t=e.value,r=e.setValue,n=e.label,o=e.id,i=(e.config,e.type);return[C().createElement("input",{key:o+i,type:"checkbox",id:o+i,checked:!!t,onChange:function(e){return r(e.target.checked)}}),C().createElement("label",{key:o+i+"label",htmlFor:o+i},n)]},Vm=function(e){var t=e.onOk,r=(e.okText,e.cancelText,e.title);confirm(r)&&t()};var zm=function(e){return e.config,e.children};function Mm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mm=function(){return!!e})()}var qm=function(e){function t(){var e,r,n,o;(0,w.A)(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r=this,n=t,o=[].concat(a),n=(0,j.A)(n),(e=(0,F.A)(r,Mm()?Reflect.construct(n,o||[],(0,j.A)(r).constructor):n.apply(r,o))).handleChange=function(t){e.props.setOption("proximity",parseInt(t))},e}return(0,E.A)(t,e),(0,A.A)(t,[{key:"render",value:function(){var e=this.props,t=e.defaults,r=e.options,n=e.config,o=e.optionLabel,i=e.optionPlaceholder,a=e.customProps,l=e.minProximity,s=e.maxProximity,u=e.optionTextBefore,c=e.readonly,p=n.settings,d=n.widgets,f=n.ctx,g=t?t.proximity:void 0,v=p.showLabels,h=r.get("proximity",g),y=Hv()(l,s+1).map((function(e){return{title:e,value:e}})),m=d.select.factory,b=function(e){return m(e,f)};return C().createElement("div",{className:"operator--PROXIMITY"},C().createElement("div",{className:"operator--options"},v&&C().createElement("label",{className:"rule--label"},o),!v&&u&&C().createElement("div",{className:"operator--options--sep"},C().createElement("span",null,u)),C().createElement(b,(0,Jg.A)({config:n,value:h,listValues:y,setValue:this.handleChange,readonly:c,placeholder:i},a))),C().createElement("div",{className:"operator--widgets"},this.props.children))}}])}(k.PureComponent);function Wm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Bm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wm(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}qm.propTypes={config:fg().object.isRequired,setOption:fg().func.isRequired,options:fg().any.isRequired,minProximity:fg().number,maxProximity:fg().number,optionPlaceholder:fg().string,optionTextBefore:fg().string,optionLabel:fg().string,customProps:fg().object,readonly:fg().bool},qm.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};var $m={conjunctions:Bm({},af.conjunctions),operators:Bm(Bm({},af.operators),{},{proximity:Bm(Bm({},af.operators.proximity),{},{options:Bm(Bm({},af.operators.proximity.options),{},{factory:function(e,t){return(0,t.RCE)(t.O.ProximityOperator,e)}})})}),widgets:{text:Bm(Bm({},af.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}}),textarea:Bm(Bm({},af.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextAreaWidget,e)}}),number:Bm(Bm({},af.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaNumberWidget,e)}}),slider:Bm(Bm({},af.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSliderWidget,e)}}),select:Bm(Bm({},af.widgets.select),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSelectWidget,e)}}),multiselect:Bm(Bm({},af.widgets.multiselect),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaMultiSelectWidget,e)}}),date:Bm(Bm({},af.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateWidget,e)}}),time:Bm(Bm({},af.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTimeWidget,e)}}),datetime:Bm(Bm({},af.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateTimeWidget,e)}}),boolean:Bm(Bm({},af.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaBooleanWidget,e)}}),field:Bm(Bm({},af.widgets.field),{},{factory:function(e,t){return(0,t.RCE)(t.W.ValueFieldWidget,e)},customProps:{showSearch:!0}}),func:Bm(Bm({},af.widgets.func),{},{factory:function(e,t){return(0,t.RCE)(t.W.FuncWidget,e)},customProps:{}}),case_value:Bm(Bm({},af.widgets.case_value),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}})},types:Bm(Bm({},af.types),{},{select:Bm(Bm({},af.types.select),{},{widgets:Bm(Bm({},af.types.select.widgets),{},{select:Bm(Bm({},af.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),settings:Bm(Bm({},af.settings),{},{renderField:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderOperator:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.VanillaConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.VanillaSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.VanillaButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.VanillaIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.VanillaButtonGroup,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.VanillaProvider,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderFieldSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderConfirm:function(e,t){return(0,t.W.vanillaConfirm)(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,t){return(0,t.RCE)("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},customOperatorSelectProps:{},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),ctx:Bm(Bm({},af.ctx),{},{W:Bm({},_),O:Bm({},S),RCE:function(e,t){return C().createElement(e,t)}})};const Um=$m=pg.ConfigMixins.removeMixins($m,["rangeslider","treeselect","treemultiselect"]);r(9517);var Km=pg.Autocomplete,Gm=(Km.mergeListValues,Km.listValueToOption,Km.optionToListValue,Km.optionsToListValues,Km.fixListValuesGroupOrder,pg.ListUtils);function Hm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hm(Object(r),!0).forEach((function(t){(0,L.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Gm.mapListValues,Gm.listValuesToArray,Gm.getListValue,Gm.makeCustomListValue,Gm.searchListValue,Gm.getItemInListValues;const Xm=Jm(Jm({},pg),{},{ReactUtils:O,DragIcon:Ov})},4221:(e,t,r)=>{"use strict";var n=r(1882),o={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var r,i,a,l,s,u,c=!1;t||(t={}),r=t.debug||!1;try{if(a=n(),l=document.createRange(),s=document.getSelection(),(u=document.createElement("span")).textContent=e,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var i=o[t.format]||o.default;window.clipboardData.setData(i,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(u),l.selectNodeContents(u),s.addRange(l),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(n){r&&console.error("unable to copy using execCommand: ",n),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),c=!0}catch(n){r&&console.error("unable to copy using clipboardData: ",n),r&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{s&&("function"==typeof s.removeRange?s.removeRange(l):s.removeAllRanges()),u&&document.body.removeChild(u),a()}return c}},502:function(e,t,r){var n,o;n=function(){"use strict";Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var e={},t={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t,r){return void 0===r?e<t:e<t&&t<r},"<=":function(e,t,r){return void 0===r?e<=t:e<=t&&t<=r},"!!":function(t){return e.truthy(t)},"!":function(t){return!e.truthy(t)},"%":function(e,t){return e%t},log:function(e){return console.log(e),e},in:function(e,t){return!(!t||void 0===t.indexOf)&&-1!==t.indexOf(e)},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(e,t,r){if(r<0){var n=String(e).substr(t);return n.substr(0,n.length+r)}return String(e).substr(t,r)},"+":function(){return Array.prototype.reduce.call(arguments,(function(e,t){return parseFloat(e,10)+parseFloat(t,10)}),0)},"*":function(){return Array.prototype.reduce.call(arguments,(function(e,t){return parseFloat(e,10)*parseFloat(t,10)}))},"-":function(e,t){return void 0===t?-e:e-t},"/":function(e,t){return e/t},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,(function(e,t){return e.concat(t)}),[])},var:function(e,t){var r=void 0===t?null:t,n=this;if(void 0===e||""===e||null===e)return n;for(var o=String(e).split("."),i=0;i<o.length;i++){if(null==n)return r;if(void 0===(n=n[o[i]]))return r}return n},missing:function(){for(var t=[],r=Array.isArray(arguments[0])?arguments[0]:arguments,n=0;n<r.length;n++){var o=r[n],i=e.apply({var:o},this);null!==i&&""!==i||t.push(o)}return t},missing_some:function(t,r){var n=e.apply({missing:r},this);return r.length-n.length>=t?[]:n}};return e.is_logic=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length},e.truthy=function(e){return!(Array.isArray(e)&&0===e.length||!e)},e.get_operator=function(e){return Object.keys(e)[0]},e.get_values=function(t){return t[e.get_operator(t)]},e.apply=function(r,n){if(Array.isArray(r))return r.map((function(t){return e.apply(t,n)}));if(!e.is_logic(r))return r;var o,i,a,l,s,u=e.get_operator(r),c=r[u];if(Array.isArray(c)||(c=[c]),"if"===u||"?:"==u){for(o=0;o<c.length-1;o+=2)if(e.truthy(e.apply(c[o],n)))return e.apply(c[o+1],n);return c.length===o+1?e.apply(c[o],n):null}if("and"===u){for(o=0;o<c.length;o+=1)if(i=e.apply(c[o],n),!e.truthy(i))return i;return i}if("or"===u){for(o=0;o<c.length;o+=1)if(i=e.apply(c[o],n),e.truthy(i))return i;return i}if("filter"===u)return l=e.apply(c[0],n),a=c[1],Array.isArray(l)?l.filter((function(t){return e.truthy(e.apply(a,t))})):[];if("map"===u)return l=e.apply(c[0],n),a=c[1],Array.isArray(l)?l.map((function(t){return e.apply(a,t)})):[];if("reduce"===u)return l=e.apply(c[0],n),a=c[1],s=void 0!==c[2]?c[2]:null,Array.isArray(l)?l.reduce((function(t,r){return e.apply(a,{current:r,accumulator:t})}),s):s;if("all"===u){if(l=e.apply(c[0],n),a=c[1],!Array.isArray(l)||!l.length)return!1;for(o=0;o<l.length;o+=1)if(!e.truthy(e.apply(a,l[o])))return!1;return!0}if("none"===u){if(l=e.apply(c[0],n),a=c[1],!Array.isArray(l)||!l.length)return!0;for(o=0;o<l.length;o+=1)if(e.truthy(e.apply(a,l[o])))return!1;return!0}if("some"===u){if(l=e.apply(c[0],n),a=c[1],!Array.isArray(l)||!l.length)return!1;for(o=0;o<l.length;o+=1)if(e.truthy(e.apply(a,l[o])))return!0;return!1}if(c=c.map((function(t){return e.apply(t,n)})),t.hasOwnProperty(u)&&"function"==typeof t[u])return t[u].apply(n,c);if(u.indexOf(".")>0){var p=String(u).split("."),d=t;for(o=0;o<p.length;o++){if(!d.hasOwnProperty(p[o]))throw new Error("Unrecognized operation "+u+" (failed at "+p.slice(0,o+1).join(".")+")");d=d[p[o]]}return d.apply(n,c)}throw new Error("Unrecognized operation "+u)},e.uses_data=function(t){var r=[];if(e.is_logic(t)){var n=e.get_operator(t),o=t[n];Array.isArray(o)||(o=[o]),"var"===n?r.push(o[0]):o.forEach((function(t){r.push.apply(r,e.uses_data(t))}))}return function(e){for(var t=[],r=0,n=e.length;r<n;r++)-1===t.indexOf(e[r])&&t.push(e[r]);return t}(r)},e.add_operation=function(e,r){t[e]=r},e.rm_operation=function(e){delete t[e]},e.rule_like=function(t,r){if(r===t)return!0;if("@"===r)return!0;if("number"===r)return"number"==typeof t;if("string"===r)return"string"==typeof t;if("array"===r)return Array.isArray(t)&&!e.is_logic(t);if(e.is_logic(r)){if(e.is_logic(t)){var n=e.get_operator(r),o=e.get_operator(t);if("@"===n||n===o)return e.rule_like(e.get_values(t,!1),e.get_values(r,!1))}return!1}if(Array.isArray(r)){if(Array.isArray(t)){if(r.length!==t.length)return!1;for(var i=0;i<r.length;i+=1)if(!e.rule_like(t[i],r[i]))return!1;return!0}return!1}return!1},e},void 0===(o=n.call(t,r,t,e))||(e.exports=o)},9517:(e,t,r)=>{var n=r(7453),o=r(2220),i=r(3662),a=Math.max,l=Math.min;e.exports=function(e,t,r){var s,u,c,p,d,f,g=0,v=!1,h=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=s,n=u;return s=u=void 0,g=t,p=e.apply(n,r)}function b(e){var r=e-f;return void 0===f||r>=t||r<0||h&&e-g>=c}function O(){var e=o();if(b(e))return _(e);d=setTimeout(O,function(e){var r=t-(e-f);return h?l(r,c-(e-g)):r}(e))}function _(e){return d=void 0,y&&s?m(e):(s=u=void 0,p)}function S(){var e=o(),r=b(e);if(s=arguments,u=this,f=e,r){if(void 0===d)return function(e){return g=e,d=setTimeout(O,t),v?m(e):p}(f);if(h)return clearTimeout(d),d=setTimeout(O,t),m(f)}return void 0===d&&(d=setTimeout(O,t)),p}return t=i(t)||0,n(r)&&(v=!!r.leading,c=(h="maxWait"in r)?a(i(r.maxWait)||0,t):c,y="trailing"in r?!!r.trailing:y),S.cancel=function(){void 0!==d&&clearTimeout(d),g=0,s=f=u=d=void 0},S.flush=function(){return void 0===d?p:_(o())},S}},2220:(e,t,r)=>{var n=r(9965);e.exports=function(){return n.Date.now()}},5489:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(5959),o=r(9389);function i(e,t){void 0===t&&(t=[]);var r=(0,o.A)(e,t,{loading:!0}),i=r[0],a=r[1];return(0,n.useEffect)((function(){a()}),[a]),i}},9389:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(7150),o=r(5959),i=r(1316);function a(e,t,r){void 0===t&&(t=[]),void 0===r&&(r={loading:!1});var a=(0,o.useRef)(0),l=(0,i.A)(),s=(0,o.useState)(r),u=s[0],c=s[1],p=(0,o.useCallback)((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=++a.current;return u.loading||c((function(e){return(0,n.__assign)((0,n.__assign)({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return l()&&o===a.current&&c({value:e,loading:!1}),e}),(function(e){return l()&&o===a.current&&c({error:e,loading:!1}),e}))}),t);return[u,p]}},4519:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(4221),o=r.n(n),i=r(5959),a=r(1316);const l=function(){var e=(0,a.A)(),t=function(e){void 0===e&&(e={});var t=(0,i.useState)(e),r=t[0],n=t[1];return[r,(0,i.useCallback)((function(e){n((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[])]}({value:void 0,error:void 0,noUserInteraction:!0}),r=t[0],n=t[1];return[r,(0,i.useCallback)((function(t){var r,i;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var a=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void n({value:t,error:a,noUserInteraction:!0})}if(""===t)return a=new Error("Cannot copy empty string to clipboard."),void n({value:t,error:a,noUserInteraction:!0});i=t.toString(),r=o()(i),n({value:i,error:void 0,noUserInteraction:r})}catch(a){n({value:i,error:a,noUserInteraction:r})}}),[])]}},8722:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(5959),o=function(){},i="undefined"!=typeof window;const a=i?n.useLayoutEffect:n.useEffect;var l={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const s=i&&void 0!==window.ResizeObserver?function(){var e=(0,n.useState)(null),t=e[0],r=e[1],o=(0,n.useState)(l),i=o[0],s=o[1],u=(0,n.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,r=t.x,n=t.y,o=t.width,i=t.height,a=t.top,l=t.left,u=t.bottom,c=t.right;s({x:r,y:n,width:o,height:i,top:a,left:l,bottom:u,right:c})}}))}),[]);return a((function(){if(t)return u.observe(t),function(){u.disconnect()}}),[t]),[r,i]}:function(){return[o,l]}},1316:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(5959);function o(){var e=(0,n.useRef)(!1),t=(0,n.useCallback)((function(){return e.current}),[]);return(0,n.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),t}},1777:(e,t,r)=>{"use strict";var n=r(7150),o=r(5959),i=n.__importDefault(r(5053));t.A=function(e,t){void 0===t&&(t=[]);var r=i.default(e,t,{loading:!0}),n=r[0],a=r[1];return o.useEffect((function(){a()}),[a]),n}},5053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7150),o=r(5959),i=n.__importDefault(r(9812));t.default=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r={loading:!1});var a=o.useRef(0),l=i.default(),s=o.useState(r),u=s[0],c=s[1],p=o.useCallback((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=++a.current;return u.loading||c((function(e){return n.__assign(n.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return l()&&o===a.current&&c({value:e,loading:!1}),e}),(function(e){return l()&&o===a.current&&c({error:e,loading:!1}),e}))}),t);return[u,p]}},990:(e,t,r)=>{"use strict";var n=r(7150),o=r(5959),i=n.__importDefault(r(1854));t.A=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=[]);var n=i.default(e,t),a=n[0],l=n[1],s=n[2];return o.useEffect(s,r),[a,l]}},9812:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5959);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}}),[]),t}},1854:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5959);t.default=function(e,t){void 0===t&&(t=0);var r=n.useRef(!1),o=n.useRef(),i=n.useRef(e),a=n.useCallback((function(){return r.current}),[]),l=n.useCallback((function(){r.current=!1,o.current&&clearTimeout(o.current),o.current=setTimeout((function(){r.current=!0,i.current()}),t)}),[t]),s=n.useCallback((function(){r.current=null,o.current&&clearTimeout(o.current)}),[]);return n.useEffect((function(){i.current=e}),[e]),n.useEffect((function(){return l(),s}),[t]),[a,s,l]}},4889:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>p});var n=r(5959);let o;o="undefined"!=typeof window?window:"undefined"!=typeof self?self:r.g;let i=null,a=null;const l=o.clearTimeout,s=o.setTimeout,u=o.cancelAnimationFrame||o.mozCancelAnimationFrame||o.webkitCancelAnimationFrame,c=o.requestAnimationFrame||o.mozRequestAnimationFrame||o.webkitRequestAnimationFrame;null==u||null==c?(i=l,a=function(e){return s(e,20)}):(i=function([e,t]){u(e),l(t)},a=function(e){const t=c((function(){l(r),e()})),r=s((function(){u(t),e()}),20);return[t,r]});class p extends n.Component{constructor(...e){super(...e),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:e,disableWidth:t,onResize:r}=this.props;if(this._parentNode){const n=window.getComputedStyle(this._parentNode)||{},o=parseFloat(n.paddingLeft||"0"),i=parseFloat(n.paddingRight||"0"),a=parseFloat(n.paddingTop||"0"),l=parseFloat(n.paddingBottom||"0"),s=this._parentNode.getBoundingClientRect(),u=s.height-a-l,c=s.width-o-i,p=this._parentNode.offsetHeight-a-l,d=this._parentNode.offsetWidth-o-i;(e||this.state.height===p&&this.state.scaledHeight===u)&&(t||this.state.width===d&&this.state.scaledWidth===c)||(this.setState({height:p,width:d,scaledHeight:u,scaledWidth:c}),"function"==typeof r&&r({height:p,scaledHeight:u,scaledWidth:c,width:d}))}},this._setRef=e=>{this._autoSizer=e}}componentDidMount(){const{nonce:e}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(null!=t&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;const r=t.ownerDocument.defaultView.ResizeObserver;null!=r?(this._resizeObserver=new r((()=>{this._timeoutId=setTimeout(this._onResize,0)})),this._resizeObserver.observe(t)):(this._detectElementResize=function(e){let t,r,n,l,s,u,c;const p="undefined"!=typeof document&&document.attachEvent;if(!p){u=function(e){const t=e.__resizeTriggers__,r=t.firstElementChild,n=t.lastElementChild,o=r.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,o.style.width=r.offsetWidth+1+"px",o.style.height=r.offsetHeight+1+"px",r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight},s=function(e){return e.offsetWidth!==e.__resizeLast__.width||e.offsetHeight!==e.__resizeLast__.height},c=function(e){if(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)return;const t=this;u(this),this.__resizeRAF__&&i(this.__resizeRAF__),this.__resizeRAF__=a((function(){s(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(r){r.call(t,e)})))}))};let e=!1,o="";n="animationstart";const p="Webkit Moz O ms".split(" ");let d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),f="";{const t=document.createElement("fakeelement");if(void 0!==t.style.animationName&&(e=!0),!1===e)for(let r=0;r<p.length;r++)if(void 0!==t.style[p[r]+"AnimationName"]){f=p[r],o="-"+f.toLowerCase()+"-",n=d[r],e=!0;break}}r="resizeanim",t="@"+o+"keyframes "+r+" { from { opacity: 0; } to { opacity: 0; } } ",l=o+"animation: 1ms "+r+"; "}return{addResizeListener:function(i,a){if(p)i.attachEvent("onresize",a);else{if(!i.__resizeTriggers__){const a=i.ownerDocument,s=o.getComputedStyle(i);s&&"static"===s.position&&(i.style.position="relative"),function(r){if(!r.getElementById("detectElementResize")){const n=(t||"")+".resize-triggers { "+(l||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',o=r.head||r.getElementsByTagName("head")[0],i=r.createElement("style");i.id="detectElementResize",i.type="text/css",null!=e&&i.setAttribute("nonce",e),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(r.createTextNode(n)),o.appendChild(i)}}(a),i.__resizeLast__={},i.__resizeListeners__=[],(i.__resizeTriggers__=a.createElement("div")).className="resize-triggers";const p=a.createElement("div");p.className="expand-trigger",p.appendChild(a.createElement("div"));const d=a.createElement("div");d.className="contract-trigger",i.__resizeTriggers__.appendChild(p),i.__resizeTriggers__.appendChild(d),i.appendChild(i.__resizeTriggers__),u(i),i.addEventListener("scroll",c,!0),n&&(i.__resizeTriggers__.__animationListener__=function(e){e.animationName===r&&u(i)},i.__resizeTriggers__.addEventListener(n,i.__resizeTriggers__.__animationListener__))}i.__resizeListeners__.push(a)}},removeResizeListener:function(e,t){if(p)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",c,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(n,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}(e),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),null!==this._timeoutId&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:e,defaultHeight:t,defaultWidth:r,disableHeight:o=!1,disableWidth:i=!1,doNotBailOutOnEmptyChildren:a=!1,nonce:l,onResize:s,style:u={},tagName:c="div",...p}=this.props,{height:d,scaledHeight:f,scaledWidth:g,width:v}=this.state,h={overflow:"visible"},y={};let m=!1;return o||(0===d&&(m=!0),h.height=0,y.height=d,y.scaledHeight=f),i||(0===v&&(m=!0),h.width=0,y.width=v,y.scaledWidth=g),a&&(m=!1),(0,n.createElement)(c,{ref:this._setRef,style:{...h,...u},...p},!m&&e(y))}}},1882:e=>{e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,r=[],n=0;n<e.rangeCount;n++)r.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||r.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},2827:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(6089),o=r(5959),i=(r(7781),r(2007));const a=({className:e,...t})=>{const r=(0,i.useStyles2)(l);return o.createElement(i.Button,{...t,className:(0,n.cx)(e,r.button)})},l=e=>({button:(0,n.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)})})},4326:(e,t,r)=>{"use strict";r.d(t,{c:()=>a});var n=r(6089),o=r(5959),i=(r(7781),r(2007));const a=e=>{var t;const{label:r,optional:n,tooltip:a,tooltipInteractive:s,children:u,width:c,...p}=e,d=(0,i.useStyles2)(l,c),f=(null==p?void 0:p.htmlFor)||(null==(t=i.ReactUtils)?void 0:t.getChildId(u)),g=o.createElement(o.Fragment,null,o.createElement("label",{className:d.label,htmlFor:f},r,n&&o.createElement("span",{className:d.optional}," - optional"),a&&o.createElement(i.Tooltip,{placement:"top",content:a,theme:"info",interactive:s},o.createElement(i.Icon,{tabIndex:0,name:"info-circle",size:"sm",className:d.icon}))),o.createElement(i.Space,{v:.5}));return o.createElement("div",{className:d.root},o.createElement(i.Field,{className:d.field,label:g,...p},u))},l=(e,t)=>({root:(0,n.css)({minWidth:e.spacing(null!=t?t:0)}),label:(0,n.css)({fontSize:12,fontWeight:e.typography.fontWeightMedium}),optional:(0,n.css)({fontStyle:"italic",color:e.colors.text.secondary}),field:(0,n.css)({marginBottom:0}),icon:(0,n.css)({color:e.colors.text.secondary,marginLeft:e.spacing(1),":hover":{color:e.colors.text.primary}})})},45:(e,t,r)=>{"use strict";r.d(t,{X:()=>a});var n=r(6089),o=r(5959),i=(r(7781),r(2007));const a=({children:e})=>{const t=(0,i.useStyles2)(l);return o.createElement("div",{className:t.root},e)},l=e=>({root:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:e.spacing(3),minHeight:e.spacing(4)})})},7088:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var n=r(2007),o=r(5959),i=r(5910);const a=o.forwardRef((function({items:e,renderItem:t,onChange:r},a){return o.createElement(i.C,null,e.map(((n,i)=>o.createElement("div",{key:i},t(n,(t=>((t,n)=>{const o=[...e];o[t]=n,r(o)})(i,t)),(()=>(t=>{const n=[...e];n.splice(t,1),r(n)})(i)))))),o.createElement(n.Button,{ref:a,onClick:()=>{const t=[...e,{}];r(t)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))}))},8442:(e,t,r)=>{"use strict";r.d(t,{U:()=>l});var n=r(6089),o=r(5959),i=(r(7781),r(2007)),a=r(5910);const l=({children:e})=>{const t=(0,i.useStyles2)(s);return o.createElement("div",{className:t.root},o.createElement(a.C,{gap:2},e))},s=e=>({root:(0,n.css)({padding:e.spacing(1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.radius.default})})},3769:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});var n=r(5959),o=r(5910);const i=({children:e})=>n.createElement(o.C,{gap:.5,direction:"column"},e)},5910:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var n=r(5959),o=r(2007);r(7781);const i=({children:e,wrap:t=!0,...r})=>{var i,a;return n.createElement(o.Stack,{wrap:t?"wrap":void 0,direction:null!=(i=r.direction)?i:"row",gap:null!=(a=r.gap)?a:2,...r},e)}},2961:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5959);const o=({grow:e,shrink:t})=>n.createElement("div",{style:{display:"block",flexGrow:e,flexShrink:t}})},4364:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});var n=r(6089),o=r(5959),i=(r(7781),r(2007));function a({label:e,...t}){const[r]=(0,o.useState)((()=>Math.random().toString(16).slice(2))),n=(0,i.useStyles2)(u),a={SelectContainer:l,ValueContainer:s,SingleValue:s};return o.createElement("div",{className:n.root},e&&o.createElement("label",{className:n.label,htmlFor:r},e,":"," "),o.createElement(i.Select,{openMenuOnFocus:!0,inputId:r,...t,components:a}))}const l=e=>{const{children:t}=e,r=(0,i.useStyles2)(u);return o.createElement(i.SelectContainer,{...e,className:(0,n.cx)(e.className,r.container)},t)},s=e=>{const{className:t,children:r}=e,a=(0,i.useStyles2)(u);return o.createElement("div",{className:(0,n.cx)(t,a.valueContainer)},r)},u=e=>({root:(0,n.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,n.css)({color:e.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,n.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,n.css)({display:"flex",alignItems:"center",flex:"initial",color:e.colors.text.secondary,fontSize:12})})},258:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});var n=r(6089),o=r(2007),i=r(5959);const a=({children:e})=>{const t=(0,o.useStyles2)(s),r=i.Children.map(e,(e=>(0,i.isValidElement)(e)&&e.props.invalid?(0,i.cloneElement)(e,{className:(0,n.cx)(e.props.className,t.invalidChild)}):e));return i.createElement("div",{className:t.root},r)},l=["","base","hovered","invalid","focused"],s=()=>({root:(0,n.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:l.indexOf("base"),"&:hover":{zIndex:l.indexOf("hovered")},"&:focus-within":{zIndex:l.indexOf("focused")}}}),invalidChild:(0,n.css)({zIndex:l.indexOf("invalid")})})},7893:(e,t,r)=>{"use strict";r.d(t,{Y:()=>T});var n=r(2007),o=r(5959),i=r(8056),a=r(7781);const l=(e,t,r={})=>({label:e,insertText:e,kind:i.Io.Field,sortText:i.mY.Medium,range:t,...r}),s=()=>[{id:i.X7.SelectKeyword,name:i.X7.SelectKeyword,kind:[i.ng.SelectKeyword]},{id:i.X7.WithKeyword,name:i.X7.WithKeyword,kind:[i.ng.WithKeyword]},{id:i.X7.AfterSelectKeyword,name:i.X7.AfterSelectKeyword,kind:[i.ng.StarWildCard,i.ng.FunctionsWithArguments,i.ng.Columns,i.ng.SelectMacro]},{id:i.X7.AfterSelectFuncFirstArgument,name:i.X7.AfterSelectFuncFirstArgument,kind:[i.ng.Columns]},{id:i.X7.AfterGroupByFunctionArgument,name:i.X7.AfterGroupByFunctionArgument,kind:[i.ng.Columns]},{id:i.X7.AfterWhereFunctionArgument,name:i.X7.AfterWhereFunctionArgument,kind:[i.ng.Columns]},{id:i.X7.AfterSelectArguments,name:i.X7.AfterSelectArguments,kind:[i.ng.Columns]},{id:i.X7.AfterFromKeyword,name:i.X7.AfterFromKeyword,kind:[i.ng.Schemas,i.ng.Tables,i.ng.TableMacro]},{id:i.X7.AfterSchema,name:i.X7.AfterSchema,kind:[i.ng.Tables,i.ng.TableMacro]},{id:i.X7.SelectAlias,name:i.X7.SelectAlias,kind:[i.ng.Columns,i.ng.FunctionsWithArguments]},{id:i.X7.FromKeyword,name:i.X7.FromKeyword,kind:[i.ng.FromKeyword]},{id:i.X7.AfterFrom,name:i.X7.AfterFrom,kind:[i.ng.WhereKeyword,i.ng.GroupByKeywords,i.ng.OrderByKeywords,i.ng.LimitKeyword]},{id:i.X7.AfterTable,name:i.X7.AfterTable,kind:[i.ng.WhereKeyword,i.ng.GroupByKeywords,i.ng.OrderByKeywords,i.ng.LimitKeyword]},{id:i.X7.WhereKeyword,name:i.X7.WhereKeyword,kind:[i.ng.Columns,i.ng.FilterMacro,i.ng.TemplateVariables]},{id:i.X7.WhereComparisonOperator,name:i.X7.WhereComparisonOperator,kind:[i.ng.ComparisonOperators]},{id:i.X7.WhereValue,name:i.X7.WhereValue,kind:[i.ng.FilterMacro,i.ng.TemplateVariables]},{id:i.X7.AfterWhereValue,name:i.X7.AfterWhereValue,kind:[i.ng.LogicalOperators,i.ng.GroupByKeywords,i.ng.OrderByKeywords,i.ng.LimitKeyword,i.ng.Columns,i.ng.TemplateVariables]},{id:i.X7.AfterGroupByKeywords,name:i.X7.AfterGroupByKeywords,kind:[i.ng.GroupMacro,i.ng.Columns]},{id:i.X7.AfterGroupBy,name:i.X7.AfterGroupBy,kind:[i.ng.OrderByKeywords,i.ng.LimitKeyword]},{id:i.X7.AfterOrderByKeywords,name:i.X7.AfterOrderByKeywords,kind:[i.ng.Columns]},{id:i.X7.AfterOrderByFunction,name:i.X7.AfterOrderByFunction,kind:[i.ng.SortOrderDirectionKeyword,i.ng.LimitKeyword]},{id:i.X7.AfterOrderByDirection,name:i.X7.AfterOrderByDirection,kind:[i.ng.LimitKeyword]},{id:i.X7.AfterIsOperator,name:i.X7.AfterOrderByDirection,kind:[i.ng.NotKeyword,i.ng.NullValue,i.ng.BoolValues]},{id:i.X7.AfterIsNotOperator,name:i.X7.AfterOrderByDirection,kind:[i.ng.NullValue,i.ng.BoolValues]}];class u{constructor(e,t,r,n,o){this.type=e,this.value=t,this.range=r,this.previous=n,this.next=o}isKeyword(){return this.type===i.ks.Keyword}isWhiteSpace(){return this.type===i.ks.Whitespace}isParenthesis(){return this.type===i.ks.Parenthesis}isIdentifier(){return this.type===i.ks.Identifier}isString(){return this.type===i.ks.String}isNumber(){return this.type===i.ks.Number}isDoubleQuotedString(){return this.type===i.ks.Type}isVariable(){return this.type===i.ks.Variable}isFunction(){return this.type===i.ks.Function}isOperator(){return this.type===i.ks.Operator}isTemplateVariable(){return this.type===i.ks.Variable}is(e,t){const r=this.type===e;return void 0!==t?r&&c(e,this,t):r}getPreviousNonWhiteSpaceToken(){let e=this.previous;for(;null!=e;){if(!e.isWhiteSpace())return e;e=e.previous}return null}getPreviousOfType(e,t){let r=this.previous;for(;null!=r;){const n=r.type===e;if(void 0!==t?n&&c(e,r,t):n)return r;r=r.previous}return null}getPreviousUntil(e,t,r){let n=[],o=this.previous;for(;null!=o;){if(t.some((e=>e===(null==o?void 0:o.type)))){o=o.previous;continue}const i=o.type===e;if(void 0!==r?i&&c(e,o,r):i)return n;o.isWhiteSpace()||n.push(o),o=o.previous}return n}getNextUntil(e,t,r){let n=[],o=this.next;for(;null!=o;){if(t.some((e=>e===(null==o?void 0:o.type)))){o=o.next;continue}const i=o.type===e;if(void 0!==r?i&&c(e,o,r):i)return n;o.isWhiteSpace()||n.push(o),o=o.next}return n}getPreviousKeyword(){let e=this.previous;for(;null!=e;){if(e.isKeyword())return e;e=e.previous}return null}getNextNonWhiteSpaceToken(){let e=this.next;for(;null!=e;){if(!e.isWhiteSpace())return e;e=e.next}return null}getNextOfType(e,t){let r=this.next;for(;null!=r;){const n=r.type===e;if(void 0!==t?n&&c(e,r,t):n)return r;r=r.next}return null}}function c(e,t,r){return e===i.ks.Keyword||e===i.ks.Operator?t.value.toLowerCase()===r.toString().toLowerCase():t.value===r}const p="select",d="from",f="where",g="group",v="order",h="by",y="desc",m="asc",b="with",O=e=>{var t;const r=(e=>{const t=(e=>{var t;return null!=(t=null==e?void 0:e.getPreviousOfType(i.ks.Keyword,p))?t:null})(e);return null==t?void 0:t.getNextOfType(i.ks.Keyword,d)})(e),n=null==r?void 0:r.getNextNonWhiteSpaceToken();return(null==n?void 0:n.isVariable())||(null==n?void 0:n.isKeyword())&&(null==(t=n.next)?void 0:t.is(i.ks.Parenthesis,"("))?null:n},_=e=>{const t=null==e?void 0:e.value.split(".");return 1===(null==t?void 0:t.length)?{table:t[0]}:2===(null==t?void 0:t.length)?{schema:t[0],table:t[1]}:null},S={id:"editor.action.triggerSuggest",title:""};var w=r(6373),A=r(8531);function F(e){return{label:e.name,insertText:`${"\\"+e.text}${t=e.args,t?"(".concat(t.map(((e,t)=>`\${${t}:${e}}`)).join(", ")).concat(")"):"()"} `,insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Snippet,documentation:e.description,command:S};var t}function j(){return[{id:i.X7.SelectKeyword,name:i.X7.SelectKeyword,resolve:(e,t,r,n)=>Boolean(null===e||e.isWhiteSpace()&&null===e.previous||e.is(i.ks.Keyword,p)||e.is(i.ks.Keyword,p)&&null===e.previous||n||e.isIdentifier()&&(n||null===(null==e?void 0:e.previous))||e.isIdentifier()&&p.startsWith(e.value.toLowerCase()))},{id:i.X7.WithKeyword,name:i.X7.WithKeyword,resolve:(e,t,r,n)=>Boolean(null===e||e.isWhiteSpace()&&null===e.previous||e.is(i.ks.Keyword,b)&&null===e.previous||e.isIdentifier()&&b.toLowerCase().startsWith(e.value.toLowerCase()))},{id:i.X7.AfterSelectKeyword,name:i.X7.AfterSelectKeyword,resolve:(e,t,r,n)=>Boolean((null==r?void 0:r.value.toLowerCase())===p)},{id:i.X7.AfterSelectArguments,name:i.X7.AfterSelectArguments,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.value.toLowerCase())===p&&","===(null==r?void 0:r.value))},{id:i.X7.AfterSelectFuncFirstArgument,name:i.X7.AfterSelectFuncFirstArgument,resolve:(e,t,r,n)=>Boolean(((null==t?void 0:t.value.toLowerCase())===p||"as"===(null==t?void 0:t.value.toLowerCase()))&&((null==r?void 0:r.is(i.ks.Parenthesis,"("))||(null==e?void 0:e.is(i.ks.Parenthesis,"()"))))},{id:i.X7.AfterWhereFunctionArgument,name:i.X7.AfterWhereFunctionArgument,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.is(i.ks.Keyword,f))&&((null==r?void 0:r.is(i.ks.Parenthesis,"("))||(null==e?void 0:e.is(i.ks.Parenthesis,"()"))))},{id:i.X7.AfterGroupBy,name:i.X7.AfterGroupBy,resolve:(e,t,r,n)=>{var o;return Boolean((null==t?void 0:t.is(i.ks.Keyword,h))&&(null==(o=null==t?void 0:t.getPreviousKeyword())?void 0:o.is(i.ks.Keyword,g))&&((null==r?void 0:r.isIdentifier())||(null==r?void 0:r.isDoubleQuotedString())||(null==r?void 0:r.is(i.ks.Parenthesis,")"))||(null==r?void 0:r.is(i.ks.Parenthesis,"()"))))}},{id:i.X7.SelectAlias,name:i.X7.SelectAlias,resolve:(e,t,r,n)=>","===(null==r?void 0:r.value)&&"as"===(null==t?void 0:t.value.toLowerCase())},{id:i.X7.FromKeyword,name:i.X7.FromKeyword,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.value.toLowerCase())===p&&","!==(null==r?void 0:r.value)||((null==e?void 0:e.isKeyword())||(null==e?void 0:e.isIdentifier()))&&d.toLowerCase().startsWith(e.value.toLowerCase()))},{id:i.X7.AfterFromKeyword,name:i.X7.AfterFromKeyword,resolve:(e,t,r,n)=>Boolean(!(null==e?void 0:e.value.includes("."))&&(null==r?void 0:r.value.toLowerCase())===d)},{id:i.X7.AfterSchema,name:i.X7.AfterSchema,resolve:(e,t,r,n)=>((null==e?void 0:e.isWhiteSpace())&&(null==e?void 0:e.next)&&(r=(e=null==e?void 0:e.previous).getPreviousNonWhiteSpaceToken()),Boolean((null==e?void 0:e.isIdentifier())&&(null==e?void 0:e.value.endsWith("."))&&(null==r?void 0:r.value.toLowerCase())===d))},{id:i.X7.AfterFrom,name:i.X7.AfterFrom,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.value.toLowerCase())===d&&(null==r?void 0:r.isDoubleQuotedString())||(null==t?void 0:t.value.toLowerCase())===d&&(null==r?void 0:r.isIdentifier())||(null==t?void 0:t.value.toLowerCase())===d&&(null==r?void 0:r.isVariable()))},{id:i.X7.AfterTable,name:i.X7.AfterTable,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.value.toLowerCase())===d&&((null==r?void 0:r.isVariable())||""!==(null==r?void 0:r.value)&&(null==r?void 0:r.value.toLowerCase())!==d))},{id:i.X7.WhereKeyword,name:i.X7.WhereKeyword,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.value.toLowerCase())===f&&((null==r?void 0:r.isKeyword())||(null==r?void 0:r.is(i.ks.Parenthesis,"("))||(null==r?void 0:r.is(i.ks.Operator,"AND"))))},{id:i.X7.WhereComparisonOperator,name:i.X7.WhereComparisonOperator,resolve:(e,t,r,n)=>{var o;return Boolean((null==t?void 0:t.value.toLowerCase())===f&&!(null==(o=null==r?void 0:r.getPreviousNonWhiteSpaceToken())?void 0:o.isOperator())&&!(null==e?void 0:e.is(i.ks.Delimiter,"."))&&!(null==e?void 0:e.isParenthesis())&&((null==r?void 0:r.isIdentifier())||(null==r?void 0:r.isDoubleQuotedString())))}},{id:i.X7.WhereValue,name:i.X7.WhereValue,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.value.toLowerCase())===f&&(null==r?void 0:r.isOperator()))},{id:i.X7.AfterWhereValue,name:i.X7.AfterWhereValue,resolve:(e,t,r,n)=>{var o,a,l;return Boolean((null==t?void 0:t.value.toLowerCase())===f&&((null==r?void 0:r.is(i.ks.Operator,"and"))||(null==r?void 0:r.is(i.ks.Operator,"or"))||(null==r?void 0:r.isString())||(null==r?void 0:r.isNumber())||(null==r?void 0:r.is(i.ks.Parenthesis,")"))||(null==r?void 0:r.is(i.ks.Parenthesis,"()"))||(null==r?void 0:r.isTemplateVariable())||(null==r?void 0:r.is(i.ks.IdentifierQuote))&&(null==(o=r.getPreviousNonWhiteSpaceToken())?void 0:o.is(i.ks.Identifier))&&(null==(l=null==(a=null==r?void 0:r.getPreviousNonWhiteSpaceToken())?void 0:a.getPreviousNonWhiteSpaceToken())?void 0:l.is(i.ks.IdentifierQuote))))}},{id:i.X7.AfterGroupByKeywords,name:i.X7.AfterGroupByKeywords,resolve:(e,t,r,n)=>{var o;return Boolean((null==t?void 0:t.is(i.ks.Keyword,h))&&(null==(o=null==t?void 0:t.getPreviousKeyword())?void 0:o.is(i.ks.Keyword,g))&&((null==r?void 0:r.is(i.ks.Keyword,h))||(null==r?void 0:r.is(i.ks.Delimiter,","))))}},{id:i.X7.AfterGroupByFunctionArgument,name:i.X7.AfterGroupByFunctionArgument,resolve:(e,t,r,n)=>{var o;return Boolean((null==t?void 0:t.is(i.ks.Keyword,h))&&(null==(o=null==t?void 0:t.getPreviousKeyword())?void 0:o.is(i.ks.Keyword,g))&&((null==r?void 0:r.is(i.ks.Parenthesis,"("))||(null==e?void 0:e.is(i.ks.Parenthesis,"()"))))}},{id:i.X7.AfterOrderByKeywords,name:i.X7.AfterOrderByKeywords,resolve:(e,t,r,n)=>{var o;return Boolean((null==r?void 0:r.is(i.ks.Keyword,h))&&(null==(o=null==r?void 0:r.getPreviousKeyword())?void 0:o.is(i.ks.Keyword,v)))}},{id:i.X7.AfterOrderByFunction,name:i.X7.AfterOrderByFunction,resolve:(e,t,r,n)=>{var o,a;return Boolean((null==t?void 0:t.is(i.ks.Keyword,h))&&(null==(o=null==t?void 0:t.getPreviousKeyword())?void 0:o.is(i.ks.Keyword,v))&&(null==r?void 0:r.is(i.ks.Parenthesis))&&(null==(a=null==r?void 0:r.getPreviousNonWhiteSpaceToken())?void 0:a.is(i.ks.Function)))}},{id:i.X7.AfterOrderByDirection,name:i.X7.AfterOrderByDirection,resolve:(e,t,r,n)=>Boolean((null==t?void 0:t.is(i.ks.Keyword,y))||(null==t?void 0:t.is(i.ks.Keyword,m)))},{id:i.X7.AfterIsOperator,name:i.X7.AfterIsOperator,resolve:(e,t,r,n)=>Boolean(null==r?void 0:r.is(i.ks.Operator,"IS"))},{id:i.X7.AfterIsNotOperator,name:i.X7.AfterIsNotOperator,resolve:(e,t,r,n)=>{var o;return Boolean((null==r?void 0:r.is(i.ks.Operator,"NOT"))&&(null==(o=r.getPreviousNonWhiteSpaceToken())?void 0:o.is(i.ks.Operator,"IS")))}}]}let E={logger:()=>{}},k=()=>{};n.attachDebugger&&n.createLogger&&(E=(0,n.createLogger)("SQLEditor"),k=E.logger,(0,n.attachDebugger)("sqleditor",void 0,E));var C=r(3247);const L={id:"standardSql",extensions:[".sql"],aliases:["sql"],mimetypes:[],loader:()=>require("./language"),completionProvider:C.N},x=new Map,I=new Map,T=({children:e,onBlur:t,onChange:r,query:i,language:a={id:"sql"},width:l,height:s})=>{const u=(0,o.useRef)(null),c=(0,o.useRef)(),p=(0,o.useMemo)((()=>{const e=(0,w.A)(),t=`${a.id}-${e}`;return c.current=t,t}),[a.id]);(0,o.useEffect)((()=>()=>{c.current&&I.delete(c.current),k(`Removing instance cache ${c.current}`,!1,I)}),[]);const d=(0,o.useCallback)((()=>{u.current&&u.current.getAction("editor.action.formatDocument").run()}),[]);return o.createElement("div",{style:{width:l}},o.createElement(n.CodeEditor,{height:s||"240px",width:l?l-2+"px":void 0,language:p,value:i,onBlur:e=>{r&&r(e,!1),t&&t(e)},showMiniMap:!1,showLineNumbers:!0,onEditorDidMount:(e,t)=>{u.current=e,e.onDidChangeModelContent((t=>{const n=e.getValue();r&&r(n,!1)})),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.Enter,(()=>{const t=e.getValue();r&&r(t,!0)})),e.onKeyUp((t=>{84===t.keyCode&&e.trigger(S.id,S.id,{})})),P(t,a,p)}}),e&&e({formatQuery:d}))},P=async(e,t,r)=>{const n=((e,t)=>{if("sql"!==(null==t?void 0:t.id)&&!t.loader){k(`Loading language '${null==t?void 0:t.id}' from Monaco registry`,!1);const r=e.languages.getLanguages().find((({id:e})=>e===(null==t?void 0:t.id)));if(!r)throw Error(`Unknown Monaco language ${null==t?void 0:t.id}`);return{completionProvider:C.N,...r,...t}}return{...L,...t}})(e,t);if(!n.loader)return;const{language:o,conf:c}=await n.loader(e);if(e.languages.register({id:r}),e.languages.setMonarchTokensProvider(r,{...o}),e.languages.setLanguageConfiguration(r,{...c}),n.formatter&&e.languages.registerDocumentFormattingEditProvider(r,{provideDocumentFormattingEdits:e=>{var r;const n=null==(r=t.formatter)?void 0:r.call(t,e.getValue());return[{range:e.getFullModelRange(),text:n||""}]}}),n.completionProvider){const c=n.completionProvider(e,o);!function(e,t,r){var n;x.has(e)||function(e){x.has(e)||x.set(e,{functions:new a.Registry,operators:new a.Registry,suggestionKinds:new a.Registry(s),positionResolvers:new a.Registry(j),macros:new a.Registry}),x.get(e)}(e);const o=x.get(e);var l,u,c;I.has(t)||I.set(t,new a.Registry((l=o.functions,u=o.operators,c=o.macros,()=>[{id:i.ng.SelectKeyword,name:i.ng.SelectKeyword,suggestions:(e,t)=>Promise.resolve([{label:"SELECT <column>",insertText:"SELECT $0",insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Snippet,command:S,sortText:i.mY.Medium},{label:"SELECT <column> FROM <table>",insertText:"SELECT $2 FROM $1",insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Snippet,command:S,sortText:i.mY.Medium}])},{id:i.ng.TemplateVariables,name:i.ng.TemplateVariables,suggestions:(e,t)=>{const r=(0,A.getTemplateSrv)();return r?Promise.resolve(r.getVariables().map((e=>{const t=`$${e.name}`,n=r.replace(t);return{label:t,detail:`(Template Variable) ${n}`,kind:i.Io.Snippet,documentation:`(Template Variable) ${n}`,insertText:`\\$${e.name} `,insertTextRules:i._E.InsertAsSnippet,command:S,sortText:i.mY.Low}}))):Promise.resolve([])}},{id:i.ng.SelectMacro,name:i.ng.SelectMacro,suggestions:(e,t)=>Promise.resolve([...c.list().filter((e=>e.type===i.hh.Value||e.type===i.hh.Column)).map(F)])},{id:i.ng.TableMacro,name:i.ng.TableMacro,suggestions:(e,t)=>Promise.resolve([...c.list().filter((e=>e.type===i.hh.Table)).map(F)])},{id:i.ng.GroupMacro,name:i.ng.GroupMacro,suggestions:(e,t)=>Promise.resolve([...c.list().filter((e=>e.type===i.hh.Group)).map(F)])},{id:i.ng.FilterMacro,name:i.ng.FilterMacro,suggestions:(e,t)=>Promise.resolve([...c.list().filter((e=>e.type===i.hh.Filter)).map(F)])},{id:i.ng.WithKeyword,name:i.ng.WithKeyword,suggestions:(e,t)=>Promise.resolve([{label:"WITH <alias> AS ( ... )",insertText:"WITH $1  AS ( $2 )",insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Snippet,command:S,sortText:i.mY.Medium}])},{id:i.ng.StarWildCard,name:i.ng.StarWildCard,suggestions:(e,t)=>Promise.resolve([{label:"*",insertText:"* $0",insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Field,command:S,sortText:i.mY.High}])},{id:i.ng.FunctionsWithArguments,name:i.ng.FunctionsWithArguments,suggestions:(e,t)=>Promise.resolve([...l.list().map((e=>({label:e.name,insertText:`${e.name}($0)`,documentation:e.description,insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Function,command:S,sortText:i.mY.MediumLow})))])},{id:i.ng.FunctionsWithoutArguments,name:i.ng.FunctionsWithoutArguments,suggestions:(e,t)=>Promise.resolve([...l.list().map((e=>({label:e.name,insertText:`${e.name}()`,documentation:e.description,insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Function,command:S,sortText:i.mY.MediumHigh})))])},{id:i.ng.FromKeyword,name:i.ng.FromKeyword,suggestions:(e,t)=>Promise.resolve([{label:"FROM",insertText:"FROM $0",command:S,insertTextRules:i._E.InsertAsSnippet,kind:i.Io.Keyword}])},{id:i.ng.Schemas,name:i.ng.Schemas,suggestions:(e,t)=>Promise.resolve([])},{id:i.ng.Tables,name:i.ng.Tables,suggestions:(e,t)=>Promise.resolve([])},{id:i.ng.Columns,name:i.ng.Columns,suggestions:(e,t)=>Promise.resolve([])},{id:i.ng.LogicalOperators,name:i.ng.LogicalOperators,suggestions:(e,t)=>Promise.resolve(u.list().filter((e=>e.type===i.hu.Logical)).map((e=>({label:e.operator,insertText:`${e.operator} `,documentation:e.description,command:S,sortText:i.mY.MediumHigh,kind:i.Io.Operator}))))},{id:i.ng.WhereKeyword,name:i.ng.WhereKeyword,suggestions:(e,t)=>Promise.resolve([{label:"WHERE",insertText:"WHERE ",command:S,sortText:i.mY.MediumHigh,kind:i.Io.Keyword}])},{id:i.ng.ComparisonOperators,name:i.ng.ComparisonOperators,suggestions:(e,t)=>Promise.resolve([...u.list().filter((e=>e.type===i.hu.Comparison)).map((e=>({label:e.operator,insertText:`${e.operator} `,documentation:e.description,command:S,sortText:i.mY.MediumHigh,kind:i.Io.Operator}))),{label:"IN (...)",insertText:"IN ( $0 )",command:S,sortText:i.mY.Medium,kind:i.Io.Operator,insertTextRules:i._E.InsertAsSnippet},{label:"NOT IN (...)",insertText:"NOT IN ( $0 )",command:S,sortText:i.mY.Medium,kind:i.Io.Operator,insertTextRules:i._E.InsertAsSnippet},{label:"IS",insertText:"IS",command:S,sortText:i.mY.Medium,kind:i.Io.Operator},{label:"IS NOT",insertText:"IS NOT",command:S,sortText:i.mY.Medium,kind:i.Io.Operator}])},{id:i.ng.GroupByKeywords,name:i.ng.GroupByKeywords,suggestions:(e,t)=>Promise.resolve([{label:"GROUP BY",insertText:"GROUP BY ",command:S,sortText:i.mY.MediumHigh,kind:i.Io.Keyword}])},{id:i.ng.OrderByKeywords,name:i.ng.OrderByKeywords,suggestions:(e,t)=>Promise.resolve([{label:"ORDER BY",insertText:"ORDER BY ",command:S,sortText:i.mY.Medium,kind:i.Io.Keyword},{label:"ORDER BY(ascending)",insertText:"ORDER BY $1 ASC ",command:S,sortText:i.mY.MediumLow,kind:i.Io.Snippet,insertTextRules:i._E.InsertAsSnippet},{label:"ORDER BY(descending)",insertText:"ORDER BY $1 DESC",command:S,sortText:i.mY.MediumLow,kind:i.Io.Snippet,insertTextRules:i._E.InsertAsSnippet}])},{id:i.ng.LimitKeyword,name:i.ng.LimitKeyword,suggestions:(e,t)=>Promise.resolve([{label:"LIMIT",insertText:"LIMIT ",command:S,sortText:i.mY.MediumLow,kind:i.Io.Keyword}])},{id:i.ng.SortOrderDirectionKeyword,name:i.ng.SortOrderDirectionKeyword,suggestions:(e,t)=>Promise.resolve([m,y].map((e=>({label:e,insertText:`${e} `,command:S,kind:i.Io.Keyword}))))},{id:i.ng.NotKeyword,name:i.ng.NotKeyword,suggestions:()=>Promise.resolve([{label:"NOT",insertText:"NOT",command:S,kind:i.Io.Keyword,sortText:i.mY.High}])},{id:i.ng.BoolValues,name:i.ng.BoolValues,suggestions:()=>Promise.resolve(["TRUE","FALSE"].map((e=>({label:e,insertText:`${e}`,command:S,kind:i.Io.Keyword,sortText:i.mY.Medium}))))},{id:i.ng.NullValue,name:i.ng.NullValue,suggestions:()=>Promise.resolve(["NULL"].map((e=>({label:e,insertText:`${e}`,command:S,kind:i.Io.Keyword,sortText:i.mY.Low}))))}])));const p=I.get(t);if(r.supportedFunctions)for(const e of r.supportedFunctions())o.functions.getIfExists(e.id)||o.functions.register(e);if(r.supportedOperators)for(const e of r.supportedOperators())o.operators.getIfExists(e.id)||o.operators.register({...e,name:e.id});if(r.supportedMacros)for(const e of r.supportedMacros())o.macros.getIfExists(e.id)||o.macros.register({...e,name:e.id});if(r.customStatementPlacement)for(const e of r.customStatementPlacement()){const t=o.positionResolvers.getIfExists(e.id);if(t){const r=t.resolve;t.resolve=(...t)=>{const n=e.resolve(...t);return e.overrideDefault?n:r(...t)||n}}else o.positionResolvers.register({...e,id:e.id,name:e.id}),o.suggestionKinds.register({id:e.id,name:e.id,kind:[]})}if(r.customSuggestionKinds)for(const e of r.customSuggestionKinds()){if(null==(n=e.applyTo)||n.forEach((t=>{const r=o.suggestionKinds.getIfExists(t);r&&-1===r.kind.indexOf(e.id)&&r.kind.push(e.id)})),e.overrideDefault){const t=p.get(e.id);if(void 0!==t){t.suggestions=e.suggestionsResolver;continue}}p.register({id:e.id,name:e.id,suggestions:e.suggestionsResolver})}if(r.schemas){const e=p.get(i.ng.Schemas),t=e.suggestions;e.suggestions=async(e,n)=>{const o=await t(e,n);if(!r.schemas)return[...o];const a=(await r.schemas.resolve()).map((e=>{var t;return{label:e.name,insertText:`${null!=(t=e.completion)?t:e.name}.`,command:S,kind:i.Io.Module,sortText:i.mY.High}}));return[...o,...a]}}if(r.tables){const e=p.get(i.ng.Tables),t=e.suggestions;e.suggestions=async(e,n)=>{var o,a,l,s,u;const c=await t(e,n),p=O(e.currentToken),d=(null!=(a=null==(o=r.tables)?void 0:o.parseName)?a:_)(p);return[...c,...(null!=(u=await(null==(s=null==(l=r.tables)?void 0:l.resolve)?void 0:s.call(l,d)))?u:[]).map((e=>{var t;return{label:e.name,insertText:`${null!=(t=e.completion)?t:e.name}${e.completion===e.name?" $0":""}`,insertTextRules:i._E.InsertAsSnippet,command:S,kind:i.Io.Field,sortText:i.mY.MediumHigh}}))]}}if(r.columns){const e=p.get(i.ng.Columns),t=e.suggestions;e.suggestions=async(e,n)=>{var o,a,l;const s=await t(e,n),u=O(e.currentToken);let c;const p=null!=(a=null==(o=r.tables)?void 0:o.parseName)?a:_;u&&u.value&&(c=p(u));let d=[];if(c){const e=await(null==(l=r.columns)?void 0:l.resolve(c));d=e?e.map((e=>{var t;return{label:e.name,insertText:null!=(t=e.completion)?t:e.name,kind:i.Io.Field,sortText:i.mY.High,detail:e.type,documentation:e.description}})):[]}return[...s,...d]}}}(t.id,r,c);const p=x.get(t.id),d=I.get(r),f=async(t,n,o,a)=>{const s=function(e,t,r,n="sql"){var o;let a=null,l=null;const s=e.editor.tokenize(null!=(o=t.getValue())?o:"",n);for(let o=0;o<s.length;o++){const c=s[o];if(!c.length&&l){const e={offset:0,type:i.ks.Whitespace,language:n,_tokenBrand:void 0};c.push(e)}for(let n=0;n<c.length;n++){const i=c[n];let s=c.length>n+1?c[n+1].offset+1:t.getLineLength(o+1)+1;const p={startLineNumber:o+1,startColumn:0===i.offset?0:i.offset+1,endLineNumber:o+1,endColumn:s},d=t.getValueInRange(p),f=new u(i.type,d,p,l,null);e.Range.containsPosition(p,r)&&(a=f),l&&(l.next=f),l=f}}return a}(e,t,n,r),c=function(e,t){var r;const n=null==e?void 0:e.getPreviousNonWhiteSpaceToken(),o=null==e?void 0:e.getPreviousKeyword(),a=null==(r=null==e?void 0:e.getPreviousNonWhiteSpaceToken())?void 0:r.is(i.ks.Operator,"/"),l=t.list(),s=[];for(const t of l)t.resolve(e,null!=o?o:null,null!=n?n:null,Boolean(a))&&s.push(t.id);return 0===s.length?[i.X7.Unknown]:s}(s,p.positionResolvers),f=function(e,t){let r=[];for(let n=0;n<e.length;n++){const o=t.getIfExists(e[n]);o&&(r=r.concat(o.kind))}return r}(c,p.suggestionKinds);k("Statement position",!1,c),k("Suggestion kinds",!1,f);const g={position:n,currentToken:s,statementPosition:c,kind:f,range:e.Range.fromPositions(n)},v=await(async(e,t,r,n,o)=>{let i=[];const a=(null==t?void 0:t.isWhiteSpace())||(null==t?void 0:t.isParenthesis())||(null==t?void 0:t.isIdentifier())&&t.value.endsWith(".")||!(null==t?void 0:t.range)?e.Range.fromPositions(n.position):null==t?void 0:t.range;for(const t of[...new Set(r)]){const r=o.getIfExists(t);if(r){const t=await r.suggestions({...n,range:a},e);i=[...i,...t.map((e=>l(e.label,a,{kind:e.kind,...e})))]}}return Promise.resolve(i)})(e,s,f,g,d);return{suggestions:v}};e.languages.registerCompletionItemProvider(r,{...c,provideCompletionItems:f})}}}}]);
//# sourceMappingURL=329.js.map