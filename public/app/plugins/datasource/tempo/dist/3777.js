"use strict";(globalThis.webpackChunktempo=globalThis.webpackChunktempo||[]).push([[3777],{8864:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Tt});var n=r(9728),o=r(6089),a=r(5959),i=r(8531),s=r(2007),l=r(4330),c=r(8146),u=r.n(c),p=(r(7493),r(7781));function d({query:e,lang:t,className:r}){const i=(0,a.useContext)(p.ThemeContext),s=g(i),l=u().highlight(e,t.grammar,t.name);return(0,n.jsx)("div",{className:(0,o.cx)(s.editorField,"prism-syntax-highlight",r),"aria-label":"selector",dangerouslySetInnerHTML:{__html:l}})}new WeakMap;const g=e=>({editorField:(0,o.css)({fontFamily:e.typography.fontFamilyMonospace,fontSize:e.typography.bodySmall.fontSize})});var y=r(3557),f=r(2381),m=r(6490),h=r(4326);function v({title:e,children:t,collapsedInfo:r,queryStats:o,onToggle:a,isOpen:l}){const[c,u]=(0,f.A)(!1),p=(0,s.useStyles2)(b);return(0,n.jsxs)("div",{className:p.wrapper,children:[(0,n.jsx)(s.Collapse,{className:p.collapse,collapsible:!0,isOpen:null!=l?l:c,onToggle:null!=a?a:u,label:(0,n.jsxs)(s.Stack,{gap:0,children:[(0,n.jsx)("h6",{className:p.title,children:e}),!c&&(0,n.jsx)("div",{className:p.description,children:r.map(((e,t)=>(0,n.jsx)("span",{children:e},t)))})]}),children:(0,n.jsx)("div",{className:p.body,children:t})}),o&&i.config.featureToggles.lokiQuerySplitting&&(0,n.jsx)(s.Tooltip,{content:"Note: the query will be split into multiple parts and executed in sequence. Query limits will only apply each individual part.",children:(0,n.jsx)(s.Icon,{tabIndex:0,name:"info-circle",className:p.tooltip,size:"sm"})}),o&&(0,n.jsx)("p",{className:p.stats,children:j(o)})]})}const b=e=>({collapse:(0,o.css)({backgroundColor:"unset",border:"unset",marginBottom:0,"> button":{padding:e.spacing(0,1)}}),wrapper:(0,o.css)({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"baseline"}),title:(0,o.css)({flexGrow:1,overflow:"hidden",fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,margin:0}),description:(0,o.css)({color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.bodySmall.fontWeight,paddingLeft:e.spacing(2),gap:e.spacing(2),display:"flex"}),body:(0,o.css)({display:"flex",gap:e.spacing(2),flexWrap:"wrap"}),stats:(0,o.css)({margin:"0px",color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize}),tooltip:(0,o.css)({marginRight:e.spacing(.25)})}),j=e=>e.message?e.message:`This query will process approximately ${O(e)}.`,O=e=>{const{text:t,suffix:r}=(0,p.getValueFormat)("bytes")(e.bytes,1);return t+r};var M=r(4288);function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){T(e,t,r[t])}))}return e}function A(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const S=(e,t)=>{const r=parseInt(e,10);return isNaN(r)?t:r},w=a.memo((({onChange:e,query:t,searchStreaming:r,metricsStreaming:o})=>{const a=(0,s.useStyles2)(I),[i,l]=(0,f.A)(!1);t.hasOwnProperty("limit")||(t.limit=M.eH),t.hasOwnProperty("tableType")||(t.tableType=y.Jv.Traces),t.hasOwnProperty("metricsQueryType")||(t.metricsQueryType=y.Ag.Range);const c=[`Limit: ${t.limit||M.eH}`,`Spans Limit: ${t.spss||M.m9}`,"Table Format: "+(t.tableType===y.Jv.Traces?"Traces":"Spans"),"|","Streaming: "+(r?"Enabled":"Disabled")],u=[`Step: ${t.step||"auto"}`,"Type: "+(t.metricsQueryType===y.Ag.Range?"Range":"Instant"),"|","Streaming: "+(o?"Enabled":"Disabled")];return(0,n.jsx)(m.U,{children:(0,n.jsxs)("div",{className:a.options,children:[(0,n.jsxs)(v,{title:"Search Options",collapsedInfo:c,isOpen:i,onToggle:l,children:[(0,n.jsx)(h.c,{label:"Limit",tooltip:"Maximum number of traces to return.",children:(0,n.jsx)(s.AutoSizeInput,{className:"width-4",placeholder:"auto",type:"number",min:1,defaultValue:t.limit||M.eH,onCommitChange:r=>{e(A(x({},t),{limit:S(r.currentTarget.value,M.eH)}))},value:t.limit})}),(0,n.jsx)(h.c,{label:"Span Limit",tooltip:"Maximum number of spans to return for each span set.",children:(0,n.jsx)(s.AutoSizeInput,{className:"width-4",placeholder:"auto",type:"number",min:1,defaultValue:t.spss||M.m9,onCommitChange:r=>{e(A(x({},t),{spss:S(r.currentTarget.value,M.m9)}))},value:t.spss})}),(0,n.jsx)(h.c,{label:"Table Format",tooltip:"How the query data should be displayed in the results table",children:(0,n.jsx)(s.RadioButtonGroup,{options:[{label:"Traces",value:y.Jv.Traces},{label:"Spans",value:y.Jv.Spans}],value:t.tableType,onChange:r=>{e(A(x({},t),{tableType:r}))}})}),(0,n.jsx)(h.c,{label:"Streaming",tooltip:(0,n.jsx)(C,{}),tooltipInteractive:!0,children:(0,n.jsx)("div",{children:r?"Enabled":"Disabled"})})]}),(0,n.jsxs)(v,{title:"Metrics Options",collapsedInfo:u,isOpen:i,onToggle:l,children:[(0,n.jsx)(h.c,{label:"Step",tooltip:"Defines the step for metric queries. Use duration notation, for example 30s or 1m",children:(0,n.jsx)(s.AutoSizeInput,{className:"width-4",placeholder:"auto",type:"string",defaultValue:t.step,onCommitChange:r=>{e(A(x({},t),{step:r.currentTarget.value}))},value:t.step})}),(0,n.jsx)(h.c,{label:"Type",tooltip:"Type of metrics query to run",children:(0,n.jsx)(s.RadioButtonGroup,{options:[{label:"Range",value:y.Ag.Range},{label:"Instant",value:y.Ag.Instant}],value:t.metricsQueryType,onChange:r=>{e(A(x({},t),{metricsQueryType:r}))}})}),(0,n.jsx)(h.c,{label:"Streaming",tooltip:(0,n.jsx)(C,{}),tooltipInteractive:!0,children:(0,n.jsx)("div",{children:o?"Enabled":"Disabled"})})]})]})})})),C=()=>(0,n.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[(0,n.jsx)("span",{children:"Indicates if streaming is currently enabled. Streaming allows you to view partial query results before the entire query completes."}),(0,n.jsx)("a",{href:"https://grafana.com/docs/tempo/latest/traceql/#stream-query-results","aria-label":"Learn more about streaming query results",target:"_blank",rel:"noreferrer",style:{textDecoration:"underline"},children:"Learn more"})]});w.displayName="TempoQueryBuilderOptions";const I=e=>({options:(0,o.css)({display:"flex",width:"-webkit-fill-available",gap:e.spacing(1),"> div":{width:"auto"}})});var N=r(2190),D=r(2862);function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){P(e,t,r[t])}))}return e}function _(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const L=/^(\$\w+)|(\d+(?:\.\d)?\d*(?:us|Âµs|ns|ms|s|m|h))$/,z=()=>({noBoxShadow:(0,o.css)({boxShadow:"none","*:focus":{boxShadow:"none"}})}),R=({filter:e,operators:t,updateFilter:r})=>{const o=(0,s.useStyles2)(z);let a=!1;return"string"==typeof e.value&&(a=!!e.value&&!L.test(e.value.concat(""))),(0,n.jsxs)(s.HorizontalGroup,{spacing:"none",children:[(0,n.jsx)(s.Select,{className:o.noBoxShadow,inputId:`${e.id}-operator`,options:t.map(D.wu),value:e.operator,onChange:t=>{r(_(E({},e),{operator:null==t?void 0:t.value}))},isClearable:!1,"aria-label":`select ${e.id} operator`,allowCustomValue:!0,width:8}),(0,n.jsx)(s.Input,{className:o.noBoxShadow,value:e.value,onChange:t=>{r(_(E({},e),{value:t.currentTarget.value}))},placeholder:"e.g. 100ms, 1.2s","aria-label":`select ${e.id} value`,invalid:a,width:18})]})};var k=r(6373),F=r(2827),q=r(2599);const Q=({label:e,tooltip:t,children:r})=>(0,n.jsx)(s.InlineFieldRow,{children:(0,n.jsx)(s.InlineField,{label:e,labelWidth:28,grow:!0,tooltip:t,children:r})});var V=r(2181);function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){B(e,t,r[t])}))}return e}function Y(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const G=e=>{var t;const{datasource:r,onChange:o,query:i,isTagsLoading:l,addVariablesToOptions:c}=e,u=(0,s.useStyles2)($),p=()=>(0,k.A)().slice(0,8),[d,g]=(0,a.useState)("");(0,a.useEffect)((()=>{i.groupBy&&0!==i.groupBy.length||o(Y(W({},i),{groupBy:[{id:p(),scope:y.d.Span}]}))}),[o,i]);const f=(0,a.useMemo)((()=>e=>{const t=r.languageProvider.getMetricsSummaryTags(e.scope);if(0===d.length)return t.slice(0,q.J_);const n=d.toLowerCase();return t.filter((e=>e.toLowerCase().includes(n))).slice(0,q.J_)}),[r,d]),m=e=>{var t;const r=W({},i);(t=r).groupBy||(t.groupBy=[]);const n=r.groupBy.findIndex((t=>t.id===e.id));n>=0?r.groupBy=(0,D._D)(r.groupBy,n,e):r.groupBy.push(e),o(r)},h=Object.values(y.d).filter((e=>r.languageProvider.getTags(e).length>0)).map((e=>({label:e,value:e})));return(0,n.jsx)(Q,{label:"Aggregate by",tooltip:"Note: We recommend using Explore Traces instead. Select one or more tags to see the metrics summary.",children:(0,n.jsxs)(n.Fragment,{children:[null===(t=i.groupBy)||void 0===t?void 0:t.map(((e,t)=>{var r,a,d,v;const b=null===(a=f(e))||void 0===a?void 0:a.concat(void 0===e.tag||""===e.tag||(null===(r=f(e))||void 0===r?void 0:r.includes(e.tag))?[]:[e.tag]).map((e=>({label:e,value:e})));var j,O;return(0,n.jsx)("div",{children:(0,n.jsxs)(s.HorizontalGroup,{spacing:"none",width:"auto",children:[(0,n.jsx)(s.Select,{"aria-label":`Select scope for filter ${t+1}`,onChange:t=>{m(Y(W({},e),{scope:null==t?void 0:t.value,tag:""}))},options:h,placeholder:"Select scope",value:e.scope}),(0,n.jsx)(s.Select,{"aria-label":`Select tag for filter ${t+1}`,isClearable:!0,allowCustomValue:!0,isLoading:l,onChange:t=>{m(Y(W({},e),{tag:null==t?void 0:t.value}))},options:c?(0,V.r)(b):b,onInputChange:(e,{action:t})=>{"input-change"===t&&g(e)},onCloseMenu:()=>g(""),placeholder:"Select tag",value:e.tag||""},e.tag),(e.tag||(null!==(j=null===(d=i.groupBy)||void 0===d?void 0:d.length)&&void 0!==j?j:0)>1)&&(0,n.jsx)(F.Z,{"aria-label":`Remove tag for filter ${t+1}`,icon:"times",onClick:()=>(e=>{var t;o(Y(W({},i),{groupBy:null===(t=i.groupBy)||void 0===t?void 0:t.filter((t=>t.id!==e.id))}))})(e),tooltip:"Remove tag",title:`Remove tag for filter ${t+1}`,variant:"secondary"}),e.tag&&t===(null!==(O=null===(v=i.groupBy)||void 0===v?void 0:v.length)&&void 0!==O?O:0)-1&&(0,n.jsx)("span",{className:u.addTag,children:(0,n.jsx)(F.Z,{"aria-label":"Add tag",icon:"plus",onClick:()=>{m({id:p(),scope:y.d.Span})},tooltip:"Add tag",variant:"secondary"})})]})},e.id)})),i.groupBy&&i.groupBy.length>0&&i.groupBy[0].tag&&(0,n.jsxs)(s.Alert,{title:"",severity:"warning",className:u.notice,children:["The aggregate by feature is deprecated. We recommend using Explore Traces instead. If you want to write your own TraceQL queries to replicate this API, please check",(0,n.jsx)("a",{href:"https://grafana.com/docs/tempo/latest/api_docs/metrics-summary/#deprecation-in-favor-of-traceql-metrics",className:u.noticeLink,target:"_blank",rel:"noreferrer noopener",children:"this page"}),"."]})]})})},$=e=>({addTag:(0,o.css)({marginLeft:e.spacing(1)}),notice:(0,o.css)({width:"500px",marginTop:e.spacing(.75)}),noticeLink:(0,o.css)({color:e.colors.text.link,textDecoration:"underline",marginLeft:"5px"})});var U=r(4160);function Z(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function K(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){K(e,t,r[t])}))}return e}function H(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const X=["min-duration","max-duration","status"],ee=({datasource:e,query:t,onChange:r,onClearResults:o,app:c,addVariablesToOptions:u=!0})=>{var p,g,f,m,h,v;const b=(0,s.useStyles2)(te),[j,O]=(0,a.useState)(),[M,T]=(0,a.useState)(null),[x,A]=(0,a.useState)(!0),[S,C]=(0,a.useState)(""),I=(0,i.getTemplateSrv)(),P=(0,a.useCallback)((e=>{var n;const o=J({},t);(n=o).filters||(n.filters=[]);const a=o.filters.findIndex((t=>t.id===e.id));a>=0?o.filters=(0,D._D)(o.filters,a,e):o.filters.push(e),r(o)}),[r,t]),E=(0,i.getTemplateSrv)().getVariables();(0,a.useEffect)((()=>{C(e.languageProvider.generateQueryFromFilters((0,D.tH)(t.filters||[])))}),[e.languageProvider,t,E]);const _=(0,a.useCallback)((e=>{var r;return null===(r=t.filters)||void 0===r?void 0:r.find((t=>t.id===e))}),[t.filters]);(0,a.useEffect)((()=>{const t=function(){var t,r=(t=function*(){try{yield e.languageProvider.start(),A(!1),O(void 0)}catch(e){e instanceof Error&&O(`Error: ${e.message}`)}},function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(e){Z(a,n,o,i,s,"next",e)}function s(e){Z(a,n,o,i,s,"throw",e)}i(void 0)}))});return function(){return r.apply(this,arguments)}}();t()}),[e,O]),(0,a.useEffect)((()=>{var t,r;null===(r=e.search)||void 0===r||null===(t=r.filters)||void 0===t||t.filter((e=>e.value)).forEach((e=>{_(e.id)||P(e)}))}),[null===(p=e.search)||void 0===p?void 0:p.filters,_,P]);const L=(null===(f=e.search)||void 0===f||null===(g=f.filters)||void 0===g?void 0:g.map((e=>e.tag)))||[];L.push("duration"),L.push("traceDuration"),L.push("span:duration"),L.push("trace:duration"),L.push("status"),L.push("span:status");const z=(t.filters||[]).filter((t=>{var r,n;return!X.includes(t.id)&&-1===((null===(n=e.search)||void 0===n||null===(r=n.filters)||void 0===r?void 0:r.findIndex((e=>e.id===t.id)))||0)&&"duration-type"!==t.id})),k=r=>{var n;if(!r)return S;const o=(null===(n=t.filters)||void 0===n?void 0:n.filter((e=>e.id!==r.id)))||[];return e.languageProvider.generateQueryFromFilters((0,D.tH)(o||[]))};var F,q,B;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:b.container,children:[(0,n.jsxs)("div",{children:[null===(h=e.search)||void 0===h||null===(m=h.filters)||void 0===m?void 0:m.map((t=>t.tag&&(0,n.jsx)(Q,{label:(0,D.hr)(t,e.languageProvider),tooltip:`Filter your search by ${(0,D.pE)(t,e.languageProvider)}. To modify the default filters shown for search visit the Tempo datasource configuration page.`,children:(0,n.jsx)(V.A,{filter:_(t.id)||t,datasource:e,setError:T,updateFilter:P,tags:[],hideScope:!0,hideTag:!0,query:k(_(t.id)),addVariablesToOptions:u})},t.id))),(0,n.jsx)(Q,{label:"Status",children:(0,n.jsx)(V.A,{filter:_("status")||{id:"status",tag:"status",scope:y.d.Intrinsic,operator:"="},datasource:e,setError:T,updateFilter:P,tags:[],hideScope:!0,hideTag:!0,query:k(_("status")),isMulti:!1,allowCustomValue:!1,addVariablesToOptions:u})}),(0,n.jsx)(Q,{label:"Duration",tooltip:"The trace or span duration, i.e. end - start time of the trace/span. Accepted units are ns, ms, s, m, h",children:(0,n.jsxs)(s.HorizontalGroup,{spacing:"none",children:[(0,n.jsx)(s.Select,{options:[{label:"span",value:"span"},{label:"trace",value:"trace"}],value:null!==(F=null===(v=_("duration-type"))||void 0===v?void 0:v.value)&&void 0!==F?F:"span",onChange:e=>{const t=_("duration-type")||{id:"duration-type",value:"span"};P(H(J({},t),{value:null==e?void 0:e.value}))},"aria-label":"duration type"}),(0,n.jsx)(R,{filter:_("min-duration")||{id:"min-duration",tag:"duration",operator:">",valueType:"duration"},operators:[">",">="],updateFilter:P}),(0,n.jsx)(R,{filter:_("max-duration")||{id:"max-duration",tag:"duration",operator:"<",valueType:"duration"},operators:["<","<="],updateFilter:P})]})}),(0,n.jsx)(Q,{label:"Tags",children:(0,n.jsx)(U.A,{filters:z,datasource:e,setError:T,updateFilter:P,deleteFilter:e=>{r(H(J({},t),{filters:t.filters.filter((t=>t.id!==e.id))}))},staticTags:L,isTagsLoading:x,generateQueryWithoutFilter:k,requireTagAndValue:!0,addVariablesToOptions:u})}),i.config.featureToggles.metricsSummary&&(0,n.jsx)(G,{datasource:e,onChange:r,query:t,isTagsLoading:x,addVariablesToOptions:u})]}),(0,n.jsxs)("div",{className:b.rawQueryContainer,children:[(0,n.jsx)(d,{query:I.replace(S),lang:{grammar:N.UD,name:"traceql"}}),(0,n.jsx)(s.Button,{variant:"secondary",size:"sm",onClick:()=>{(0,i.reportInteraction)("grafana_traces_copy_to_traceql_clicked",{app:null!=c?c:"",grafana_version:i.config.buildInfo.version,location:"search_tab"}),o();const n=e.languageProvider.generateQueryFromFilters(t.filters||[]);r(H(J({},t),{query:n,queryType:"traceql"}))},children:"Edit in TraceQL"})]}),(0,n.jsx)(w,{onChange:r,query:t,searchStreaming:null!==(q=e.isStreamingSearchEnabled())&&void 0!==q&&q,metricsStreaming:null!==(B=e.isStreamingMetricsEnabled())&&void 0!==B&&B})]}),M?(0,n.jsxs)(s.Alert,{title:"Unable to connect to Tempo search",severity:"info",className:b.alert,children:["Please ensure that Tempo is configured with search enabled. If you would like to hide this tab, you can configure it in the ",(0,n.jsx)("a",{href:`/datasources/edit/${e.uid}`,children:"datasource settings"}),"."]}):null,j&&(0,n.jsx)(l.C,{severity:"error",text:j})]})},te=e=>({alert:(0,o.css)({maxWidth:"75ch",marginTop:e.spacing(2)}),container:(0,o.css)({display:"flex",gap:"4px",flexWrap:"wrap",flexDirection:"column"}),rawQueryContainer:(0,o.css)({alignItems:"center",backgroundColor:e.colors.background.secondary,display:"flex",justifyContent:"space-between",padding:e.spacing(1)})});var re=r(1777),ne=r(3437);function oe(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){oe(a,n,o,i,s,"next",e)}function s(e){oe(a,n,o,i,s,"throw",e)}i(void 0)}))}}const ie=({datasource:e,onChange:t,disabled:r,filterKey:o,allFilters:a})=>null===o?(0,n.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,n.jsx)(s.SegmentAsync,{disabled:r,className:"query-segment-key",Component:ce,value:o,onChange:t,loadOptions:()=>ue(e,o,a),inputMinWidth:90})}):(0,n.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,n.jsx)(s.SegmentAsync,{disabled:r,className:"query-segment-key",value:o,onChange:t,loadOptions:()=>pe(e,o,a),inputMinWidth:90})}),se="-- remove filter --",le={label:se,value:se},ce=(0,n.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,n.jsx)(s.Icon,{name:"plus"})}),ue=function(){var e=ae((function*(e,t,r){const n=yield(0,i.getDataSourceSrv)().get(e);if(!n||!n.getTagKeys)return[];const o=r.filter((e=>e.key!==t)),a=yield n.getTagKeys({filters:o});return(Array.isArray(a)?a:a.data).map((e=>({label:e.text,value:e.text})))}));return function(t,r,n){return e.apply(this,arguments)}}(),pe=function(){var e=ae((function*(e,t,r){const n=yield ue(e,t,r);return[le,...n]}));return function(t,r,n){return e.apply(this,arguments)}}();function de(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}const ge=({datasource:e,disabled:t,onChange:r,filterKey:o,filterValue:a,placeHolder:i,allFilters:l})=>(0,n.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,n.jsx)(s.SegmentAsync,{className:"query-segment-value",disabled:t,placeholder:i,value:a,onChange:r,loadOptions:()=>ye(e,o,l)})}),ye=function(){var e,t=(e=function*(e,t,r){const n=yield(0,i.getDataSourceSrv)().get(e);if(!n||!n.getTagValues)return[];const o=(0,p.getDefaultTimeRange)(),a=r.filter((e=>e.key!==t)),s=yield n.getTagValues({key:t,filters:a,timeRange:o});return(Array.isArray(s)?s:s.data).map((e=>({label:e.text,value:e.text})))},function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){de(a,n,o,i,s,"next",e)}function s(e){de(a,n,o,i,s,"throw",e)}i(void 0)}))});return function(e,r,n){return t.apply(this,arguments)}}(),fe=["=","!=","<",">","=~","!~"].map((e=>({label:e,value:e}))),me=({value:e,disabled:t,onChange:r})=>(0,n.jsx)(s.Segment,{className:"query-segment-operator",value:e,disabled:t,options:fe,onChange:r}),he=({datasource:e,filter:{key:t,operator:r,value:o},onKeyChange:a,onOperatorChange:i,onValueChange:s,placeHolder:l,allFilters:c,disabled:u})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ie,{disabled:u,datasource:e,filterKey:t,onChange:a,allFilters:c}),(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(me,{disabled:u,value:r,onChange:i})}),(0,n.jsx)(ge,{disabled:u,datasource:e,filterKey:t,filterValue:o,allFilters:c,onChange:s,placeHolder:l})]}),ve=ne.Ay.t,be=({datasource:e,appendBefore:t,onCompleted:r,allFilters:o})=>{const[i,s]=(0,a.useState)(null),[l,c]=(0,a.useState)("="),u=(0,a.useCallback)((e=>{var t;e.value===se?s(null):s(null!==(t=e.value)&&void 0!==t?t:"")}),[s]),p=(0,a.useCallback)((e=>{var t;return c(null!==(t=e.value)&&void 0!==t?t:"")}),[c]),d=(0,a.useCallback)((e=>{var t;r({value:null!==(t=e.value)&&void 0!==t?t:"",operator:l,key:i}),s(null),c("=")}),[r,l,i]);return null===i?(0,n.jsx)(ie,{datasource:e,filterKey:i,onChange:u,allFilters:o}):(0,n.jsxs)(a.Fragment,{children:[t,(0,n.jsx)(he,{datasource:e,filter:{key:i,value:"",operator:l},placeHolder:ve("variable.adhoc.placeholder","Select value",undefined),onKeyChange:u,onOperatorChange:p,onValueChange:d,allFilters:o})]},"filter-builder")},je=({label:e})=>(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)("span",{className:"gf-form-label query-keyword",children:e})});function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Me extends a.PureComponent{render(){const{filters:e,disabled:t}=this.props;return(0,n.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(e,t),!t&&(0,n.jsx)(be,{datasource:this.props.datasource,appendBefore:e.length>0?(0,n.jsx)(je,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(e,t){return 0===e.length&&t?(0,n.jsx)(s.Segment,{disabled:t,value:"No filters",options:[],onChange:()=>{}}):e.reduce(((e,r,o)=>(e.length>0&&e.push((0,n.jsx)(je,{label:"AND"},`condition-${o}`)),e.push(this.renderFilterSegments(r,o,t)),e)),[])}renderFilterSegments(e,t,r){return(0,n.jsx)(a.Fragment,{children:(0,n.jsx)(he,{disabled:r,datasource:this.props.datasource,filter:e,onKeyChange:this.onChange(t,"key"),onOperatorChange:this.onChange(t,"operator"),onValueChange:this.onChange(t,"value"),allFilters:this.getAllFilters()})},`filter-${t}`)}constructor(...e){super(...e),Oe(this,"onChange",((e,t)=>r=>{const{filters:n}=this.props,{value:o}=r;return r.value===se?this.props.removeFilter(e):this.props.changeFilter(e,(a=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Oe(e,t,r[t])}))}return e}({},n[e]),i=null!=(i={[t]:o})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(i)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(i,e))})),a));var a,i})),Oe(this,"appendFilterToVariable",(e=>{this.props.addFilter(e)}))}}var Te=r(4340);function xe(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function Ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ae(e,t,r[t])}))}return e}function we(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ce({graphDatasourceUid:e,query:t,onChange:r}){const o=(0,s.useStyles2)(De),i=(0,re.A)((()=>(0,Te.q$)(e)),[e]),[l,c]=(0,a.useState)(void 0);if((0,a.useEffect)((()=>{function e(){return t=function*(e){const t=yield e.getTagKeys({filters:[{key:"__name__",operator:"=~",value:"traces_service_graph_request_server_seconds_sum|traces_service_graph_request_total|traces_service_graph_request_failed_total",condition:""}]});c(Boolean(t.length))},e=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(e){xe(a,n,o,i,s,"next",e)}function s(e){xe(a,n,o,i,s,"throw",e)}i(void 0)}))},e.apply(this,arguments);var t}!i.loading&&i.value&&function(t){e.apply(this,arguments)}(i.value)}),[i]),i.loading)return null;const u=i.value;if(!e)return Ie("No service graph datasource selected","Please set up a service graph datasource in the datasource settings",o);if(e&&!u)return Ie("No service graph data found","Service graph datasource is configured but the data source no longer exists. Please configure existing data source to use the service graph functionality",o);const p=function(e){let t,r=[];const n=/([\w_]+)(=|!=|<|>|=~|!~)"(.*?)"/g;for(;null!==(t=n.exec(e));)r.push({key:t[1],operator:t[2],value:t[3],condition:""});return r}((Array.isArray(t.serviceMapQuery)?t.serviceMapQuery[0]:t.serviceMapQuery)||"");return(0,n.jsxs)("div",{children:[(0,n.jsx)(s.InlineFieldRow,{children:(0,n.jsx)(s.InlineField,{label:"Filter",labelWidth:14,grow:!0,children:(0,n.jsx)(Me,{datasource:{uid:e},filters:p,baseFilters:[{key:"__name__",operator:"=~",value:"traces_service_graph_request_total|traces_spanmetrics_calls_total",condition:""}],addFilter:e=>{r(we(Se({},t),{serviceMapQuery:Ne([...p,e])}))},removeFilter:e=>{const n=[...p];n.splice(e,1),r(we(Se({},t),{serviceMapQuery:Ne(n)}))},changeFilter:(e,n)=>{const o=[...p];o.splice(e,1,n),r(we(Se({},t),{serviceMapQuery:Ne(o)}))}})})}),!1===l?Ie("No service graph data found","Please ensure that service graph metrics are set up correctly",o):null]})}function Ie(e,t,r){return(0,n.jsxs)(s.Alert,{title:e,severity:"info",className:r.alert,children:[t," according to the"," ",(0,n.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:"https://grafana.com/docs/grafana/latest/datasources/tempo/service-graph/",className:r.link,children:"Tempo documentation"}),"."]})}function Ne(e){return`{${e.map((e=>`${e.key}${e.operator}"${e.value}"`)).join(",")}}`}const De=e=>({alert:(0,o.css)({maxWidth:"75ch",marginTop:e.spacing(2)}),link:(0,o.css)({color:e.colors.text.link,textDecoration:"underline"})});var Pe=r(3241);const Ee={};var _e=r(6417),Le=r(3731);function ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Re(e,t){const r=e.cursorAt(t);do{if(r.from===t||r.to===t){const{node:e}=r;if(e.type.isError)return e}}while(r.next());return null}function ke(e,t){return e[t]}function Fe(e,t){let r=e;for(const[e,n]of t){if(r=ke(r,e),null===r)return null;if(void 0===n.find((e=>e===(null==r?void 0:r.type.id))))return null}return r}function qe(e,t){return t.slice(e.from===e.to?e.from-1:e.from,e.to)}function Qe(e,t){return e.every(((e,r)=>e===t[r]))}const Ve=[{path:[0,Le.d4],fun:function(e,t){const r=Fe(e,[["parent",[Le.d4]]]),n=r?qe(r,t):"";if("."===n)return{type:"SPANSET_ONLY_DOT"};const o=n.indexOf("."),a=n.slice(0,o);return["event","instrumentation","link","resource","span","parent"].find((e=>e===a))?{type:"SPANSET_IN_NAME_SCOPE",scope:a}:{type:"SPANSET_IN_NAME"}}},{path:[0,Le.v5],fun:Ye},{path:[0,Le.NA],fun:function(e,t,r){const n=Be(e,t,r);return n||{type:"SPANSET_EXPRESSION_OPERATORS_WITH_MISSING_CLOSED_BRACE"}}},{path:[0,Le.S6],fun:$e},{path:[0,Le.sd],fun:$e},{path:[0,Le.vp],fun:$e},{path:[0,Le.yl],fun:$e},{path:[0,Le.zs],fun:function(e,t,r){var n;return(null===(n=e.prevSibling)||void 0===n?void 0:n.type.id)===Le.nT?{type:"SPANSET_PIPELINE_AFTER_OPERATOR"}:{type:"NEW_SPANSET"}}},{path:[0,Le.T,Le.$f],fun:function(e,t,r){var n;if((null===(n=e.prevSibling)||void 0===n?void 0:n.type.id)!==Le.LU)return{type:"SPANSET_COMPARISON_OPERATORS"}}},{path:[Le.v5],fun:We},{path:[Le.NA],fun:We},{path:[Le.zs],fun:Ge},{path:[Le.z],fun:Ge},{path:[Le.Qf,Le.jC],fun:Ye}],Be=(e,t,r)=>{const n=e=>{const r=Fe(e,[["firstChild",[Le.d4]]]),n=r?qe(r,t):"",o=n.indexOf(".");return n.slice(0,o)};if(" "===t[r-1])return;const o=Fe(e,[["firstChild",[Le.v5]]]);if(o)return{type:"SPANSET_IN_NAME_SCOPE",scope:n(o)};const a=Fe(e,[["parent",[Le.NA]],["firstChild",[Le.v5]]]);return a&&" "!==t[r]?{type:"SPANSET_IN_NAME_SCOPE",scope:n(a)}:void 0};function We(e,t,r,n){const o=Be(e,t,n);if(o)return o;let a=Fe(e,[["firstChild",[Le.v5]],["firstChild",[Le.d4]]]);return a?{type:"SPANSET_EXPRESSION_OPERATORS"}:(a=Fe(e,[["lastChild",[Le.v5]],["lastChild",[Le.v5]],["lastChild",[Le.jC]]]),a?{type:"SPANFIELD_COMBINING_OPERATORS"}:(a=Fe(e,[["lastChild",[Le.v5]]]),a?{type:"SPANSET_EXPRESSION_OPERATORS"}:{type:"SPANSET_EMPTY"}))}function Ye(e,t,r,n){var o,a,i;const s=Be(e,t,n);if(s)return s;if(Fe(e,[["parent",[Le.jC]],["parent",[Le.v5]],["prevSibling",[Le.Ib]]])){var l,c,u;let r=null===(u=e.parent)||void 0===u||null===(c=u.parent)||void 0===c||null===(l=c.prevSibling)||void 0===l?void 0:l.prevSibling;if(r)return{type:"SPANSET_IN_VALUE",tagName:qe(r,t),betweenQuotes:!0}}if((null===(o=e.prevSibling)||void 0===o?void 0:o.type.id)===Le.Ib){var p;let r=null===(p=e.prevSibling)||void 0===p?void 0:p.prevSibling;if(r)return{type:"SPANSET_IN_VALUE",tagName:qe(r,t),betweenQuotes:!1}}return"And"===(null===(a=e.prevSibling)||void 0===a?void 0:a.type.name)||"Or"===(null===(i=e.prevSibling)||void 0===i?void 0:i.type.name)?{type:"SPANSET_EMPTY"}:{type:"SPANSET_IN_THE_MIDDLE"}}function Ge(e,t,r){let n=e.firstChild;try{for(n=e.firstChild;n.to<r;)n=n.nextSibling}catch(e){console.error("Unexpected error while searching for previous node",e)}return(null==n?void 0:n.type.id)===Le.KD||(null==n?void 0:n.type.id)===Le.Or?{type:"NEW_SPANSET"}:{type:"SPANSET_COMBINING_OPERATORS"}}function $e(e,t,r){const n=null==e?void 0:e.parent;if(n&&[Le.sd,Le.S6,Le.vp,Le.yl,Le.oL].includes(n.type.id))return{type:"ATTRIBUTE_FOR_FUNCTION"}}function Ue(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function Ze(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Ue(a,n,o,i,s,"next",e)}function s(e){Ue(a,n,o,i,s,"throw",e)}i(void 0)}))}}function Ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ke(e,t,r[t])}))}return e}function He(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class Xe{provideCompletionItems(e,t){var r;if(!this.monaco||!this.editor)throw new Error("provideCompletionItems called before CompletionProvider was initialized");if((null===(r=this.editor.getModel())||void 0===r?void 0:r.id)!==e.id)return{suggestions:[]};const{range:n,offset:o}=function(e,t,r){const n=t.getWordAtPosition(r),o=null!=n?e.Range.lift({startLineNumber:r.lineNumber,endLineNumber:r.lineNumber,startColumn:n.startColumn,endColumn:n.endColumn}):e.Range.fromPositions(r),a={column:r.column,lineNumber:r.lineNumber};return{offset:t.getOffsetAt(a),range:o}}(this.monaco,e,t),a=function(e,t){if(""===e)return{query:e,type:"EMPTY"};const r=Le.K3.parse(e);let n=t;for(;n-1>=0&&" "===e[n-1];)n-=1;let o=Re(r,n);o||(o=Re(r,n-1)),o||(o=Re(r,n+1));const a=null!=o?o.cursor():r.cursorAt(n),i=a.node,s=[a.type.id];for(;a.parent();)s.push(a.type.id);let l;for(let r of Ve)Qe(r.path,s)&&(l=r.fun(i,e,n,t));return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ze(e,t,r[t])}))}return e}({query:e},null!=l?l:{type:"UNKNOWN"})}(e.getValue(),o);return(null!=a?this.getCompletions(a,this.setAlertText):Promise.resolve([])).then((t=>{var r;const a=function(e,t,r="noOp",n,o){var a;const[i,s,l]=null!==(a=n.substring(0,o).match(tt))&&void 0!==a?a:[],c=e.length.toString().length,u=e.map(((e,n)=>{const a={kind:et(e.type),label:e.label,insertText:e.insertText,insertTextRules:e.insertTextRules,detail:e.detail,documentation:e.documentation,sortText:n.toString().padStart(c,"0"),range:t,command:{id:r,title:"Report Interaction",arguments:[e.label,e.type]}};return l&&"TAG_NAME"===e.type&&function(e,t,r,n){null==n&&"."!==e.insertText[0]&&(e.insertText="."+e.insertText),e.range=He(Je({},e.range),{startColumn:t-r.length+1})}(a,o,l,s),a}));return u}(t,n,null!==(r=this.registerInteractionCommandId)&&void 0!==r?r:void 0,e.getValue(),o);return{suggestions:a}}))}setRegisterInteractionCommandId(e){this.registerInteractionCommandId=e}getTagValues(e,t){var r=this;return Ze((function*(){let n;const o=`${e}:${t}`;return r.cachedValues.hasOwnProperty(o)?n=r.cachedValues[o]:(n=yield r.languageProvider.getOptionsV2(e,t),r.cachedValues[o]=n),n}))()}getCompletions(e,t){var r=this;return Ze((function*(){switch(e.type){case"UNKNOWN":return[];case"EMPTY":return r.getScopesCompletions("{ ","$0 }").concat(r.getIntrinsicsCompletions("{ ","$0 }")).concat(r.getTagsCompletions("{ ."));case"SPANSET_EMPTY":case"ATTRIBUTE_FOR_FUNCTION":return r.getScopesCompletions().concat(r.getIntrinsicsCompletions()).concat(r.getTagsCompletions("."));case"SPANSET_ONLY_DOT":return r.getTagsCompletions();case"SPANSET_IN_THE_MIDDLE":case"SPANSET_EXPRESSION_OPERATORS_WITH_MISSING_CLOSED_BRACE":return r.getOperatorsCompletions([...Xe.comparisonOps,...Xe.logicalOps]);case"SPANSET_IN_NAME":return r.getScopesCompletions().concat(r.getIntrinsicsCompletions()).concat(r.getTagsCompletions());case"SPANSET_IN_NAME_SCOPE":return r.getTagsCompletions(void 0,e.scope);case"SPANSET_EXPRESSION_OPERATORS":return r.getOperatorsCompletions([...Xe.comparisonOps,...Xe.logicalOps,...Xe.arithmeticOps]);case"SPANFIELD_COMBINING_OPERATORS":return r.getOperatorsCompletions([...Xe.logicalOps,...Xe.arithmeticOps,...Xe.comparisonOps]);case"SPANSET_COMBINING_OPERATORS":return r.getOperatorsCompletions(Xe.spansetOps);case"SPANSET_PIPELINE_AFTER_OPERATOR":return[...Xe.functions.map((e=>He(Je({},e),{insertTextRules:_e.eo.CompletionItemInsertTextRule.InsertAsSnippet,type:"FUNCTION"}))),...r.getScopesCompletions().concat(r.getIntrinsicsCompletions()).concat(r.getTagsCompletions("."))];case"SPANSET_COMPARISON_OPERATORS":return r.getOperatorsCompletions(Xe.comparisonOps);case"SPANSET_IN_VALUE":let n;try{n=yield r.getTagValues(e.tagName,e.query),t(void 0)}catch(e){(0,i.isFetchError)(e)?t(e.data.error):e instanceof Error&&t(`Error: ${e.message}`)}const o=t=>e.betweenQuotes?t.label:"string"===t.type?`"${t.label}"`:t.label,a=[];return null==n||n.forEach((e=>{(null==e?void 0:e.label)&&a.push({label:e.label,insertText:o(e),type:"TAG_VALUE"})})),a;case"SPANSET_AFTER_VALUE":return Xe.logicalOps.map((e=>({label:e.label,insertText:e.insertText+"}",type:"OPERATOR"})));case"NEW_SPANSET":return r.getScopesCompletions("{ ","$0 }").concat(r.getIntrinsicsCompletions("{ ","$0 }")).concat(r.getTagsCompletions("."));default:throw new Error(`Unexpected situation ${e}`)}}))()}getTagsCompletions(e,t){return function(e,t=""){return e.sort(rt.compare).map((e=>({label:e,insertText:`${t}${e}`,type:"TAG_NAME"})))}(this.languageProvider.getTraceqlAutocompleteTags(t),e)}getIntrinsicsCompletions(e,t){return this.languageProvider.getIntrinsics().map((r=>{var n;return{label:r,insertText:(e||"")+r+(t||""),type:"KEYWORD",insertTextRules:null===(n=_e.eo.CompletionItemInsertTextRule)||void 0===n?void 0:n.InsertAsSnippet}}))}getScopesCompletions(e,t){return N.Wu.map((r=>{var n;return{label:r,insertText:(e||"")+r+(t||""),type:"SCOPE",insertTextRules:null===(n=_e.eo.CompletionItemInsertTextRule)||void 0===n?void 0:n.InsertAsSnippet}}))}getOperatorsCompletions(e){return e.map((e=>He(Je({},e),{type:"OPERATOR"})))}constructor(e){Ke(this,"languageProvider",void 0),Ke(this,"registerInteractionCommandId",void 0),Ke(this,"setAlertText",void 0),Ke(this,"triggerCharacters",["{",".","[","(","=","~"," ",'"']),Ke(this,"monaco",void 0),Ke(this,"editor",void 0),Ke(this,"cachedValues",{}),this.languageProvider=e.languageProvider,this.setAlertText=e.setAlertText,this.registerInteractionCommandId=null}}function et(e){switch(e){case"TAG_NAME":return _e.eo.CompletionItemKind.Enum;case"KEYWORD":return _e.eo.CompletionItemKind.Keyword;case"OPERATOR":return _e.eo.CompletionItemKind.Operator;case"TAG_VALUE":return _e.eo.CompletionItemKind.EnumMember;case"SCOPE":return _e.eo.CompletionItemKind.Class;case"FUNCTION":return _e.eo.CompletionItemKind.Function;default:throw new Error(`Unexpected CompletionItemType: ${e}`)}}Ke(Xe,"arithmeticOps",[{label:"+",insertText:"+",detail:"Plus"},{label:"-",insertText:"-",detail:"Minus"},{label:"*",insertText:"*",detail:"Times"},{label:"/",insertText:"/",detail:"Over"}]),Ke(Xe,"logicalOps",[{label:"&&",insertText:"&&",detail:"And",documentation:"And (intersection) operator. Checks that both conditions found matches."},{label:"||",insertText:"||",detail:"Or",documentation:"Or (union) operator. Checks that either condition found matches."}]),Ke(Xe,"comparisonOps",[{label:"=",insertText:"=",detail:"Equality"},{label:"!=",insertText:"!=",detail:"Inequality"},{label:">",insertText:">",detail:"Greater than"},{label:">=",insertText:">=",detail:"Greater than or equal to"},{label:"<",insertText:"<",detail:"Less than"},{label:"<=",insertText:"<=",detail:"Less than or equal to"},{label:"=~",insertText:"=~",detail:"Regular expression"},{label:"!~",insertText:"!~",detail:"Negated regular expression"}]),Ke(Xe,"structuralOps",[{label:">>",insertText:">>",detail:"Descendant",documentation:"Descendant operator. Looks for spans matching {condB} that are descendants of a span matching {condA}"},{label:">",insertText:">",detail:"Child",documentation:"Child operator. Looks for spans matching {condB} that are direct child spans of a parent matching {condA}"},{label:"<<",insertText:"<<",detail:"Ancestor",documentation:"Ancestor operator. Looks for spans matching {condB} that are ancestors of a span matching {condA}"},{label:"<",insertText:"<",detail:"Parent",documentation:"Parent operator. Looks for spans matching {condB} that are direct parent spans of a child matching {condA}"},{label:"~",insertText:"~",detail:"Sibling",documentation:"Sibling operator. Checks that spans matching {condA} and {condB} are siblings of the same parent span."}]),Ke(Xe,"spansetOps",[{label:"|",insertText:"|",detail:"Pipe"},...Xe.logicalOps,...Xe.structuralOps]),Ke(Xe,"aggregatorFunctions",[{label:"avg",insertText:"avg($0)",detail:"Average of attribute",documentation:"Computes the average of a given numeric attribute or intrinsic for a spanset."},{label:"count",insertText:"count()$0",detail:"Number of spans",documentation:"Counts the number of spans in a spanset."},{label:"max",insertText:"max($0)",detail:"Max value of attribute",documentation:"Computes the maximum value of a given numeric attribute or intrinsic for a spanset."},{label:"min",insertText:"min($0)",detail:"Min value of attribute",documentation:"Computes the minimum value of a given numeric attribute or intrinsic for a spanset."},{label:"sum",insertText:"sum($0)",detail:"Sum value of attribute",documentation:"Computes the sum value of a given numeric attribute or intrinsic for a spanset."}]),Ke(Xe,"functions",[...Xe.aggregatorFunctions,{label:"by",insertText:"by($0)",detail:"Grouping of attributes",documentation:"Groups by arbitrary attributes."},{label:"count_over_time",insertText:"count_over_time()$0",detail:"Number of spans over time",documentation:"Counts the number of spans over time."},{label:"histogram_over_time",insertText:"histogram_over_time($0)",detail:"Histogram of attribute over time",documentation:"Retrieves a histogram of an attributes values over time which are sorted into buckets."},{label:"quantile_over_time",insertText:"quantile_over_time($0)",detail:"Quantile of attribute over time",documentation:"Retrieves one or more quantiles of an attributes numeric values over time."},{label:"rate",insertText:"rate()$0",detail:"Rate of spans",documentation:"Counts the rate of spans per second."},{label:"select",insertText:"select($0)",detail:"Selection of fields",documentation:"Selects arbitrary fields from spans."}]);const tt=/(event\.|instrumentation\.|link\.|resource\.|span\.|\.)?([\w./-]*)$/,rt=new Intl.Collator("en",{sensitivity:"accent"}),nt=e=>{if(""===e.trim())return[];if(e.trim().match(/^[0-9A-Fa-f]*$/))return[];const t=Le.K3.parse(e),r=[];return t.iterate({enter:e=>{0===e.type.id&&r.push(e.node)}}),r},ot=(e,t,r)=>{const n=[...at(e.MarkerSeverity.Error,t,r),...it(e.MarkerSeverity.Warning,t)];e.editor.setModelMarkers(t,"owner",n)},at=(e,t,r)=>r.map((r=>{const n=(e=>{var t;switch(null===(t=e.parent)||void 0===t?void 0:t.type.id){case Le.v5:var r;switch(null===(r=e.prevSibling)||void 0===r?void 0:r.type.id){case Le.KD:case Le.Or:return"Invalid value after logical operator.";case Le.Ib:return"Invalid value after comparison or arithmetic operator.";default:return"Invalid operator after field expression."}case Le.NA:var n;return(null===(n=e.prevSibling)||void 0===n?void 0:n.type.id)===Le.v5?"Invalid comparison operator after field expression.":"Invalid expression for spanset.";case Le.zs:var o;switch(null===(o=e.prevSibling)||void 0===o?void 0:o.type.id){case Le.zs:return"Invalid spanset combining operator after spanset expression.";case Le.nT:return"Invalid aggregation operator after pipeline operator.";default:return"Invalid spanset expression after spanset combining operator."}case Le.sd:case Le.S6:var a,i,s,l,c,u,p;return(null===(s=e.parent)||void 0===s||null===(i=s.parent)||void 0===i||null===(a=i.parent)||void 0===a?void 0:a.type.id)===Le.vp?"Invalid expression for by operator.":(null===(p=e.parent)||void 0===p||null===(u=p.parent)||void 0===u||null===(c=u.parent)||void 0===c||null===(l=c.parent)||void 0===l?void 0:l.type.id)===Le.yl?"Invalid expression for select operator.":"Invalid expression for aggregator operator.";case Le.d4:return"Invalid expression for spanset.";case Le.T:var d;switch(null===(d=e.prevSibling)||void 0===d?void 0:d.type.id){case Le.LU:return"Invalid value after comparison operator.";case Le.JP:var g,y;if((null===(y=e.prevSibling)||void 0===y||null===(g=y.firstChild)||void 0===g?void 0:g.type.id)===Le.S6)return"Invalid comparison operator after aggregator operator.";default:return"Invalid value after comparison operator."}default:return"Invalid query."}})(r);return st(e,n,t,r.from,r.to)})),it=(e,t)=>{let r=[];const n=t.getValue(),o=Le.K3.parse(n);if(n.indexOf(".")>-1){const n=o.cursorAt(0);do{const{node:o}=n;var a,i,s,l,c,u;if(o.type.id===Le.gw&&(null===(a=o.prevSibling)||void 0===a?void 0:a.type.id)!==Le.n$&&(null===(i=o.prevSibling)||void 0===i?void 0:i.type.id)!==Le.Jh&&(null===(s=o.prevSibling)||void 0===s?void 0:s.type.id)!==Le.r5&&(null===(l=o.prevSibling)||void 0===l?void 0:l.type.id)!==Le.N_&&(null===(c=o.prevSibling)||void 0===c?void 0:c.type.id)!==Le.FW&&(null===(u=o.prevSibling)||void 0===u?void 0:u.type.id)!==Le.L9){const n=o.prevSibling?o.prevSibling.from:o.from-1,a=o.prevSibling?o.prevSibling.to:o.from-1,i="Add resource or span scope to attribute to improve query performance.";r.push(st(e,i,t,n,a))}}while(n.next())}return r},st=(e,t,r,n,o)=>{let a=0,i=0,s=n,l=o;for(;s>0;)a++,s-=r.getLineLength(a)+1;for(;l>0;)i++,l-=r.getLineLength(i)+1;return{message:t,severity:e,startLineNumber:a,endLineNumber:i,startColumn:s+r.getLineLength(a)+2,endColumn:l+r.getLineLength(i)+2}};function lt(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function ct(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ut(e){const[t,r]=(0,a.useState)(),{query:o,onChange:c,onRunQuery:u,placeholder:p}=e,d=function(e,t){const r=(0,a.useRef)(new Xe({languageProvider:e.languageProvider,setAlertText:t}));(0,a.useEffect)((()=>{const r=function(){var r,n=(r=function*(){try{yield e.languageProvider.start(),t(void 0)}catch(e){e instanceof Error&&t(`Error: ${e.message}`)}},function(){var e=this,t=arguments;return new Promise((function(n,o){var a=r.apply(e,t);function i(e){lt(a,n,o,i,s,"next",e)}function s(e){lt(a,n,o,i,s,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();r()}),[e,t]);const n=(0,a.useRef)(null);return(0,a.useEffect)((()=>()=>{var e;null===(e=n.current)||void 0===e||e.call(n)}),[]),(e,t,o)=>{r.current.editor=e,r.current.monaco=t,r.current.setRegisterInteractionCommandId(o);const{dispose:a}=t.languages.registerCompletionItemProvider(dt,r.current);n.current=a}}(e.datasource,r),g=(0,s.useTheme2)(),y=yt(g,p),f=(0,a.useRef)(o);f.current=o;const m=e=>{var t,r;c((t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ct(e,t,r[t])}))}return e}({},f.current),r=null!=(r={query:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))},h=(0,a.useRef)(u);h.current=u;const v=(0,a.useRef)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.CodeEditor,{value:o.query||"",language:dt,onBlur:m,onChange:m,containerStyles:y.queryField,readOnly:e.readOnly,monacoOptions:{folding:!1,fontSize:14,lineNumbers:"off",overviewRulerLanes:0,renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0},scrollBeyondLastLine:!1,wordWrap:"on"},onBeforeEditorMount:gt,onEditorDidMount:(t,r)=>{e.readOnly||(d(t,r,function(e){return e.addCommand(0,(function(e,t,r){const n={datasourceType:"tempo",type:r};"TAG_VALUE"!==r&&(n.label=t),(0,i.reportInteraction)("grafana_traces_traceql_completion",n)}))}(t)),function(e,t){e.addAction({id:"run-query",label:"Run Query",keybindings:[t.KeyMod.Shift|t.KeyCode.Enter],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(){h.current()}})}(t,r),function(e,t,r){const n=[{range:new t.Range(1,1,1,1),options:{className:r.placeholder,isWholeLine:!0}}];let o=[];const a=()=>{const t=e.getModel();if(!t)return;const r=0===t.getValueLength()?n:[];o=t.deltaDecorations(o,r)};a(),e.onDidChangeModelContent(a)}(t,r,y)),function(e){const t=e.getDomNode(),r=()=>{if(t){const r=Math.min(1e3,e.getContentHeight()),n=parseInt(t.style.width,10);t.style.width=`${n}px`,t.style.height=`${r}px`,e.layout({width:n,height:r})}};e.onDidContentSizeChange(r),r()}(t);const n=t.getModel();if(n){const e=nt(n.getValue());ot(r,n,e)}t.onDidChangeModelContent((e=>{const n=t.getModel();if(!n)return;window.clearTimeout(v.current);const o=nt(n.getValue()),a=e.changes[0].rangeOffset;ot(r,n,o.filter((e=>!(e.from<=a&&a<=e.to)))),v.current=window.setTimeout((()=>{ot(r,n,o)}),500)}))}}),t&&(0,n.jsx)(l.C,{severity:"error",text:t})]})}let pt=!1;const dt="traceql";function gt(e){if(!pt){pt=!0;const{aliases:t,extensions:r,mimetypes:n,def:o}=N.YG;e.languages.register({id:dt,aliases:t,extensions:r,mimetypes:n}),e.languages.setMonarchTokensProvider(dt,o.language),e.languages.setLanguageConfiguration(dt,o.languageConfiguration)}}const yt=(e,t)=>({queryField:(0,o.css)({borderRadius:e.shape.radius.default,border:`1px solid ${e.components.input.borderColor}`,flex:1}),placeholder:(0,o.css)({"::after":{content:`'${t}'`,fontFamily:e.typography.fontFamilyMonospace,opacity:.3}})});function ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mt(e){const t=(0,s.useStyles2)(ht),r=(0,Pe.defaults)(e.query,Ee),[o,l]=(0,a.useState)((()=>{const t=e.datasource.languageProvider.generateQueryFromFilters(r.filters||[]);return t===r.query||"{}"===t}));var c,u;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.InlineLabel,{children:["Build complex queries using TraceQL to select a list of traces."," ",(0,n.jsx)("a",{rel:"noreferrer",target:"_blank",href:"https://grafana.com/docs/tempo/latest/traceql/",children:"Documentation"})]}),!o&&(0,n.jsxs)("div",{className:t.copyContainer,children:[(0,n.jsx)("span",{children:"Continue editing the query from the Search tab?"}),(0,n.jsx)(s.Button,{variant:"secondary",size:"sm",onClick:()=>{var t,n,o;(0,i.reportInteraction)("grafana_traces_copy_to_traceql_clicked",{app:null!==(t=e.app)&&void 0!==t?t:"",grafana_version:i.config.buildInfo.version,location:"traceql_tab"}),e.onClearResults(),e.onChange((n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ft(e,t,r[t])}))}return e}({},r),o=null!=(o={query:e.datasource.languageProvider.generateQueryFromFilters(r.filters||[])})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})),n)),l(!0)},style:{marginLeft:"10px"},children:"Copy query from Search"})]}),(0,n.jsx)(ut,{placeholder:"Enter a TraceQL query or trace ID (run with Shift+Enter)",query:r,onChange:e.onChange,datasource:e.datasource,onRunQuery:e.onRunQuery}),(0,n.jsx)("div",{className:t.optionsContainer,children:(0,n.jsx)(w,{query:r,onChange:e.onChange,searchStreaming:null!==(c=e.datasource.isStreamingSearchEnabled())&&void 0!==c&&c,metricsStreaming:null!==(u=e.datasource.isStreamingMetricsEnabled())&&void 0!==u&&u})})]})}const ht=e=>({optionsContainer:(0,o.css)({marginTop:"10px"}),copyContainer:(0,o.css)({backgroundColor:e.colors.background.secondary,padding:e.spacing(.5,1),fontSize:e.typography.body.fontSize})});function vt(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){bt(e,t,r[t])}))}return e}function Ot(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class Mt extends a.PureComponent{componentDidMount(){var e,t=this;return(e=function*(){t.props.query.queryType&&"clear"!==t.props.query.queryType||t.props.onChange(Ot(jt({},t.props.query),{queryType:"traceql"}))},function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){vt(a,n,o,i,s,"next",e)}function s(e){vt(a,n,o,i,s,"throw",e)}i(void 0)}))})()}render(){var e;const{query:t,onChange:r,datasource:a,app:l}=this.props,c=null===(e=a.serviceMap)||void 0===e?void 0:e.datasourceUid;return(t.spanName||t.serviceName||t.search||t.maxDuration||t.minDuration||"nativeSearch"===t.queryType)&&r((0,Te.d6)(t)),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.Modal,{title:"Upload trace",isOpen:this.state.uploadModalOpen,onDismiss:()=>this.setState({uploadModalOpen:!1}),children:(0,n.jsx)("div",{className:(0,o.css)({padding:this.props.theme.spacing(2)}),children:(0,n.jsx)(s.FileDropzone,{options:{multiple:!1},onLoad:e=>{if("string"!=typeof e&&null!==e)throw Error("Unexpected result type: "+typeof e);this.props.datasource.uploadedJson=e,r(Ot(jt({},t),{queryType:"upload"})),this.setState({uploadModalOpen:!1}),this.props.onRunQuery()}})})}),(0,n.jsx)(s.InlineFieldRow,{children:(0,n.jsx)(s.InlineField,{label:"Query type",grow:!0,children:(0,n.jsxs)(s.HorizontalGroup,{spacing:"sm",align:"center",justify:"space-between",children:[(0,n.jsx)(s.RadioButtonGroup,{options:[{value:"traceqlSearch",label:"Search"},{value:"traceql",label:"TraceQL"},{value:"serviceMap",label:"Service Graph"}],value:t.queryType,onChange:e=>{var n;(0,i.reportInteraction)("grafana_traces_query_type_changed",{datasourceType:"tempo",app:null!=l?l:"",grafana_version:i.config.buildInfo.version,newQueryType:e,previousQueryType:null!==(n=t.queryType)&&void 0!==n?n:""}),this.onClearResults(),r(Ot(jt({},t),{queryType:e}))},size:"md"}),(0,n.jsx)(s.Button,{variant:"secondary",size:"sm",onClick:()=>{this.setState({uploadModalOpen:!0})},children:"Import trace"})]})})}),"traceqlSearch"===t.queryType&&(0,n.jsx)(ee,{datasource:this.props.datasource,query:t,onChange:r,onBlur:this.props.onBlur,app:l,onClearResults:this.onClearResults,addVariablesToOptions:this.props.addVariablesToOptions}),"serviceMap"===t.queryType&&(0,n.jsx)(Ce,{graphDatasourceUid:c,query:t,onChange:r}),"traceql"===t.queryType&&(0,n.jsx)(mt,{datasource:this.props.datasource,query:t,onRunQuery:this.props.onRunQuery,onChange:r,app:l,onClearResults:this.onClearResults})]})}constructor(e){super(e),bt(this,"onClearResults",(()=>{const{onChange:e,query:t,onRunQuery:r}=this.props;e(Ot(jt({},t),{queryType:"clear"})),r()})),this.state={uploadModalOpen:!1}}}const Tt=(0,s.withTheme2)(Mt)},8968:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAHUlEQVQYV2PYvXu3JAi7uLiAMaYAjAGTQBPYLQkAa/0Zef3qRswAAAAASUVORK5CYII="},7584:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNDguMDM2NCA0LjAxMDQySDQuMDA3NzlMNC4wMDc3OSAzMi4wMjg2SDQ4LjAzNjRWNC4wMTA0MlpNNC4wMDc3OSAwLjAwNzgxMjVDMS43OTcyMSAwLjAwNzgxMjUgMC4wMDUxODc5OSAxLjc5OTg0IDAuMDA1MTg3OTkgNC4wMTA0MlYzMi4wMjg2QzAuMDA1MTg3OTkgMzQuMjM5MiAxLjc5NzIxIDM2LjAzMTIgNC4wMDc3OSAzNi4wMzEySDQ4LjAzNjRDNTAuMjQ3IDM2LjAzMTIgNTIuMDM5IDM0LjIzOTIgNTIuMDM5IDMyLjAyODZWNC4wMTA0MkM1Mi4wMzkgMS43OTk4NCA1MC4yNDcgMC4wMDc4MTI1IDQ4LjAzNjQgMC4wMDc4MTI1SDQuMDA3NzlaTTguMDEwNDIgOC4wMTMwMkgxMi4wMTNWMTIuMDE1Nkg4LjAxMDQyVjguMDEzMDJaTTIwLjAxODIgOC4wMTMwMkgxNi4wMTU2VjEyLjAxNTZIMjAuMDE4MlY4LjAxMzAyWk0yNC4wMjA4IDguMDEzMDJIMjguMDIzNFYxMi4wMTU2SDI0LjAyMDhWOC4wMTMwMlpNMzYuMDI4NiA4LjAxMzAySDMyLjAyNlYxMi4wMTU2SDM2LjAyODZWOC4wMTMwMlpNNDAuMDMxMiA4LjAxMzAySDQ0LjAzMzlWMTIuMDE1Nkg0MC4wMzEyVjguMDEzMDJaTTE2LjAxNTYgMTYuMDE4Mkg4LjAxMDQyVjIwLjAyMDhIMTYuMDE1NlYxNi4wMTgyWk0yMC4wMTgyIDE2LjAxODJIMjQuMDIwOFYyMC4wMjA4SDIwLjAxODJWMTYuMDE4MlpNMzIuMDI2IDE2LjAxODJIMjguMDIzNFYyMC4wMjA4SDMyLjAyNlYxNi4wMTgyWk00NC4wMzM5IDE2LjAxODJWMjAuMDIwOEgzNi4wMjg2VjE2LjAxODJINDQuMDMzOVpNMTIuMDEzIDI0LjAyMzRIOC4wMTA0MlYyOC4wMjZIMTIuMDEzVjI0LjAyMzRaTTE2LjAxNTYgMjQuMDIzNEgzNi4wMjg2VjI4LjAyNkgxNi4wMTU2VjI0LjAyMzRaTTQ0LjAzMzkgMjQuMDIzNEg0MC4wMzEyVjI4LjAyNkg0NC4wMzM5VjI0LjAyMzRaIiBmaWxsPSIjNDI0MjQyIi8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDAiPgo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg=="},6060:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwKSI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNDguMDM2NCA0LjAxMDQySDQuMDA3NzlMNC4wMDc3OSAzMi4wMjg2SDQ4LjAzNjRWNC4wMTA0MlpNNC4wMDc3OSAwLjAwNzgxMjVDMS43OTcyMSAwLjAwNzgxMjUgMC4wMDUxODc5OSAxLjc5OTg0IDAuMDA1MTg3OTkgNC4wMTA0MlYzMi4wMjg2QzAuMDA1MTg3OTkgMzQuMjM5MiAxLjc5NzIxIDM2LjAzMTIgNC4wMDc3OSAzNi4wMzEySDQ4LjAzNjRDNTAuMjQ3IDM2LjAzMTIgNTIuMDM5IDM0LjIzOTIgNTIuMDM5IDMyLjAyODZWNC4wMTA0MkM1Mi4wMzkgMS43OTk4NCA1MC4yNDcgMC4wMDc4MTI1IDQ4LjAzNjQgMC4wMDc4MTI1SDQuMDA3NzlaTTguMDEwNDIgOC4wMTMwMkgxMi4wMTNWMTIuMDE1Nkg4LjAxMDQyVjguMDEzMDJaTTIwLjAxODIgOC4wMTMwMkgxNi4wMTU2VjEyLjAxNTZIMjAuMDE4MlY4LjAxMzAyWk0yNC4wMjA4IDguMDEzMDJIMjguMDIzNFYxMi4wMTU2SDI0LjAyMDhWOC4wMTMwMlpNMzYuMDI4NiA4LjAxMzAySDMyLjAyNlYxMi4wMTU2SDM2LjAyODZWOC4wMTMwMlpNNDAuMDMxMiA4LjAxMzAySDQ0LjAzMzlWMTIuMDE1Nkg0MC4wMzEyVjguMDEzMDJaTTE2LjAxNTYgMTYuMDE4Mkg4LjAxMDQyVjIwLjAyMDhIMTYuMDE1NlYxNi4wMTgyWk0yMC4wMTgyIDE2LjAxODJIMjQuMDIwOFYyMC4wMjA4SDIwLjAxODJWMTYuMDE4MlpNMzIuMDI2IDE2LjAxODJIMjguMDIzNFYyMC4wMjA4SDMyLjAyNlYxNi4wMTgyWk00NC4wMzM5IDE2LjAxODJWMjAuMDIwOEgzNi4wMjg2VjE2LjAxODJINDQuMDMzOVpNMTIuMDEzIDI0LjAyMzRIOC4wMTA0MlYyOC4wMjZIMTIuMDEzVjI0LjAyMzRaTTE2LjAxNTYgMjQuMDIzNEgzNi4wMjg2VjI4LjAyNkgxNi4wMTU2VjI0LjAyMzRaTTQ0LjAzMzkgMjQuMDIzNEg0MC4wMzEyVjI4LjAyNkg0NC4wMzM5VjI0LjAyMzRaIiBmaWxsPSIjQzVDNUM1Ii8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDAiPgo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg=="}}]);
//# sourceMappingURL=3777.js.map