"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9349],{49840:(gt,ct,A)=>{A.d(ct,{C$:()=>s,HY:()=>ft,Tr:()=>tt,ur:()=>ht});const R=10,rt=4;function ht(w,a,h,c,f,u){return w>=h&&w<=f&&a>=c&&a<=u}function tt(w,a,h){let c=[];if(w.o.length&&c.push(...w.o.filter(f=>(a==null||f.sidx===a)&&(h==null||f.didx===h))),w.q)for(let f=0;f<w.q.length;f++)c.push(...tt(w.q[f],a,h));return c}function ft(w,a){return w.x<=a.x+a.w&&w.x+w.w>=a.x&&w.y+w.h>=a.y&&w.y<=a.y+a.h}class s{constructor(a,h,c,f,u=0){this.x=a,this.y=h,this.w=c,this.h=f,this.l=u,this.o=[],this.q=null}split(){let a=this,h=a.x,c=a.y,f=a.w/2,u=a.h/2,P=a.l+1;a.q=[new s(h+f,c,f,u,P),new s(h,c,f,u,P),new s(h,c+u,f,u,P),new s(h+f,c+u,f,u,P)]}quads(a,h,c,f,u){let P=this,et=P.q,X=P.x+P.w/2,dt=P.y+P.h/2,xt=h<dt,d=a<X,e=a+c>X,M=h+f>dt;xt&&e&&u(et[0]),d&&xt&&u(et[1]),d&&M&&u(et[2]),e&&M&&u(et[3])}add(a){let h=this;if(h.q!=null)h.quads(a.x,a.y,a.w,a.h,c=>{c.add(a)});else{let c=h.o;if(c.push(a),c.length>R&&h.l<rt){h.split();for(let f=0;f<c.length;f++){let u=c[f];h.quads(u.x,u.y,u.w,u.h,P=>{P.add(u)})}h.o.length=0}}}get(a,h,c,f,u){let P=this,et=P.o;for(let X=0;X<et.length;X++)u(et[X]);P.q!=null&&P.quads(a,h,c,f,X=>{X.get(a,h,c,f,u)})}clear(){this.o.length=0,this.q=null}}},66865:(gt,ct,A)=>{A.d(ct,{KQ:()=>ht,P7:()=>R.P7,iS:()=>R.iS,uM:()=>R.uM});var R=A(90086),rt=A(7500);const ht={...R.KQ,color:{...R.KQ.color,mode:R.P7.Scheme,scale:R.uM.Exponential},yAxis:{...R.KQ.yAxis,axisPlacement:rt.vM.Left},rowsFrame:{...R.KQ.rowsFrame,layout:rt.D7.auto}}},49349:(gt,ct,A)=>{A.d(ct,{Mv:()=>f,O4:()=>xt,g$:()=>dt});var R=A(36613),rt=A(63739),ht=A(47370),tt=A(27844),ft=A(59141),s=A(7500),w=A(5858),a=A(75771),h=A(49840),c=A(66865);function f(d){const{dataRef:e,theme:M,timeZone:g,getTimeRange:v,cellGap:_,hideLE:N,hideGE:C,yAxisConfig:B,ySizeDivisor:m,selectionMode:U=c.iS.X}=d,Q="x";let p=!0;e.current?.heatmap?.fields[0].type!==rt.PU.time&&(p=!1);const T=devicePixelRatio;let ot=e.current?.heatmap?.meta?.type;const at=M.visualization.getColorByName(d.exemplarColor);let V,E,y=new w.e(g);y.addHook("init",l=>{l.root.querySelectorAll(".u-cursor-pt").forEach(i=>{Object.assign(i.style,{borderRadius:"0",border:"1px solid white",background:"transparent"})})}),p&&y.addHook("setData",l=>{let{min:i,max:t}=l.scales.x,r=v().from.valueOf(),n=v().to.valueOf();(i!==r||t!==n)&&queueMicrotask(()=>{l.setScale(Q,{min:r,max:n})})}),y.addHook("drawClear",l=>{V=V||new h.C$(0,0,l.bbox.width,l.bbox.height),V.clear(),l.series.forEach((i,t)=>{t>0&&(i._paths=null)})}),y.setMode(2),y.addScale({scaleKey:Q,isTime:p,orientation:s.Lt.Horizontal,direction:s.ON.Right,range:(l,i,t)=>{if(p)return[v().from.valueOf(),v().to.valueOf()];if(e.current?.xLayout===s.D7.le)return[i-e.current?.xBucketSize,t];if(e.current?.xLayout===s.D7.ge)return[i,t+e.current?.xBucketSize];{let r=e.current?.xBucketSize/2;return[i-r,t+r]}}});let W;if(!p){W=[];for(let l=0;l<10;l++)W.push(l*e.current?.xBucketSize)}y.addAxis({scaleKey:Q,placement:s.vM.Bottom,incrs:W,isTime:p,theme:M,timeZone:g});const z=e.current?.heatmap?.fields[1];if(!z)return y;const k=z.config?.custom?.scaleDistribution??{type:s.L4.Linear},j=!!B.reverse,L=ot===ht.m.HeatmapCells&&!(0,a.Nb)(e.current?.heatmap),q=k.type!==s.L4.Linear||L,F=(0,a.eE)(e.current?.heatmap).yOrdinalDisplay!=null,D="y_"+(Math.random()+1).toString(36).substring(7);y.addScale({scaleKey:D,isTime:!1,orientation:s.Lt.Vertical,direction:j?s.ON.Down:s.ON.Up,distribution:q?s.L4.Log:s.L4.Linear,log:k.log??2,range:L?(l,i,t)=>{let r=l.data[1][2][0]/l.data[1][1][0];t*=r;let n,o;if([n,o]=q?R.A.rangeLog(i,t,k.log??2,!0):[i,t],q&&!F){let b=l.scales[D].log,x=b===2?Math.log2:Math.log10,{min:S,max:I}=B;if(S!=null&&S>0){let G=x(S);n=b**(0,tt.rs)(G,1)}if(I!=null&&I>0){let G=x(I);o=b**(0,tt.Uh)(G,1)}}return[n,o]}:(l,i,t)=>{let r=i,n=t,{min:o,max:b}=B;if(q){let x=l.scales[D].log,S=!1,I=!1,G=x===2?Math.log2:Math.log10;if(m!==1){let Z=G(i),Y=G(t);Number.isInteger(Z)||(r=x**(0,tt.rs)(Z,1),S=!0),Number.isInteger(Y)||(n=x**(0,tt.Uh)(Y,1),I=!0)}if(e.current?.yLayout===s.D7.le?S||(r/=x):e.current?.yLayout===s.D7.ge?I||(n*=x):(r/=x/2,n*=x/2),!F){if(o!=null&&o>0){let Z=G(o);r=x**(0,tt.rs)(Z,1)}if(b!=null&&b>0){let Z=G(b);n=x**(0,tt.Uh)(Z,1)}}}else{let x=e.current?.yBucketSize;x===0&&(x=1),x&&(e.current?.yLayout===s.D7.le?r-=x:e.current?.yLayout===s.D7.ge?n+=x:(r-=x/2,n+=x/2)),F||(r=o??r,n=b??n)}return[r,n]}});const it=z.display??(0,ft.j_)("short");y.addAxis({scaleKey:D,show:B.axisPlacement!==s.vM.Hidden,placement:B.axisPlacement||s.vM.Left,size:B.axisWidth||null,label:B.axisLabel,theme:M,formatValue:(l,i)=>(0,ft.cN)(it(l,i)),splits:F?l=>{const i=(0,a.eE)(e.current?.heatmap);if(!i.yOrdinalDisplay)return[0,1];let t=i.yOrdinalDisplay.map((r,n)=>n);switch(e.current?.yLayout){case s.D7.le:t.unshift(-1);break;case s.D7.ge:t.push(t.length);break}if(l.height<60)t=[t[0],t[t.length-1]];else for(;t.length>3&&(l.height-15)/t.length<10;)t=t.filter((r,n)=>n%2===0);return t}:void 0,values:F?(l,i)=>{const t=(0,a.eE)(e.current?.heatmap);return t.yOrdinalDisplay?i.map(r=>r<0?t.yMinDisplay??"":t.yOrdinalDisplay[r]??""):i}:void 0});const H=L?X:P;y.addSeries({facets:[{scale:Q,auto:!0,sorted:1},{scale:D,auto:!0}],pathBuilder:H({each:(l,i,t,r,n,o,b)=>{V.add({x:r-l.bbox.left,y:n-l.bbox.top,w:o,h:b,sidx:i,didx:t})},gap:_,hideLE:N,hideGE:C,xAlign:e.current?.xLayout===s.D7.le?-1:e.current?.xLayout===s.D7.ge?1:0,yAlign:(e.current?.yLayout===s.D7.le?-1:e.current?.yLayout===s.D7.ge?1:0)*(j?-1:1),ySizeDivisor:m,disp:{fill:{values:(l,i)=>e.current?.heatmapColors?.values,index:e.current?.heatmapColors?.palette}}}),theme:M,scaleKey:""}),y.addSeries({facets:[{scale:Q,auto:!0,sorted:1},{scale:D,auto:!0}],pathBuilder:et({each:(l,i,t,r,n,o,b)=>{V.add({x:r-l.bbox.left,y:n-l.bbox.top,w:o,h:b,sidx:i,didx:t})}},at,e.current.yLayout),theme:M,scaleKey:""});const K=U===c.iS.X||U===c.iS.Xy,J=U===c.iS.Y||U===c.iS.Xy,nt={drag:{x:K,y:J,setScale:!1},dataIdx:(l,i)=>{if(i===1){E=null;let t=l.cursor.left*T,r=l.cursor.top*T;V.get(t,r,1,1,n=>{(0,h.ur)(t,r,n.x,n.y,n.x+n.w,n.y+n.h)&&(E=n)})}return E&&i===E.sidx?E.didx:null},focus:{prox:1e3,dist:(l,i)=>E?.sidx===i?0:1/0},points:{fill:"rgba(255,255,255, 0.3)",bbox:(l,i)=>{let t=E&&i===E.sidx;return{left:t?E.x/T:-10,top:t?E.y/T:-10,width:t?E.w/T:0,height:t?E.h/T:0}}}};return y.setCursor(nt),y}const u=4;function P(d){const{disp:e,each:M,gap:g=1,hideLE:v=-1/0,hideGE:_=1/0,xAlign:N=1,yAlign:C=1,ySizeDivisor:B=1}=d,m=devicePixelRatio,U=g>=u?Math.round:p=>p,Q=Math.round(g*m);return(p,T)=>(R.A.orient(p,T,(ot,at,V,E,y,W,z,$,k,j,L,q,F,D,it)=>{let H=p.data[T];const K=H[0],J=H[1],nt=H[2],l=K.length;let i=e.fill.values(p,T),t=e.fill.index??[...new Set(i)],r=t.map(O=>new Path2D),n=l-J.lastIndexOf(J[0]),o=l/n,b=J[1]-J[0]||y.max-y.min,x=K[n]-K[0],S,I;E.distr===3?S=Math.abs(W(K[0]*E.log,E,j,$)-W(K[0],E,j,$)):S=Math.abs(W(x,E,j,$)-W(0,E,j,$)),y.distr===3?I=Math.abs(z(J[0]*y.log,y,L,k)-z(J[0],y,L,k))/B:I=Math.abs(z(b,y,L,k)-z(0,y,L,k))/B,S=Math.max(1,U(S-Q)),I=Math.max(1,U(I-Q));let G=N===-1?-S:N===0?-S/2:0,Z=C===1?-I:C===0?-I/2:0,Y=J.slice(0,n).map(O=>U(z(O,y,L,k)+Z)),st=Array.from({length:o},(O,lt)=>U(W(K[lt*n],E,j,$)+G));for(let O=0;O<l;O++)if(nt[O]!=null&&nt[O]>v&&nt[O]<_){let lt=st[~~(O/n)],ut=Y[O%n],yt=r[i[O]];D(yt,lt,ut,S,I),M(p,1,O,lt,ut,S,I)}return p.ctx.save(),p.ctx.rect(p.bbox.left,p.bbox.top,p.bbox.width,p.bbox.height),p.ctx.clip(),r.forEach((O,lt)=>{p.ctx.fillStyle=t[lt],p.ctx.fill(O)}),p.ctx.restore(),null}),null)}function et(d,e,M){return(g,v)=>(R.A.orient(g,v,(_,N,C,B,m,U,Q,p,T,ot,at,V,E,y,W)=>{let z=new Path2D,$=[z],k=[e??"rgba(255,0,255,0.7)"],j=M===s.D7.le?-.5:M===s.D7.ge?.5:0;for(let L=0;L<N.length;L++){let q=C[L];m.distr===3&&m.log===2||(q+=j);let D=U(N[L],B,ot,p),it=Q(q,m,at,T),H=8,K=8;y(z,D-H/2,it-K/2,H,K),d.each(g,v,L,D-H/2,it-K/2,H,K)}g.ctx.save(),g.ctx.rect(g.bbox.left,g.bbox.top,g.bbox.width,g.bbox.height),g.ctx.clip(),$.forEach((L,q)=>{g.ctx.fillStyle=k[q],g.ctx.fill(L)}),g.ctx.restore()}),null)}function X(d){const{disp:e,each:M,gap:g=1,hideLE:v=-1/0,hideGE:_=1/0}=d,N=devicePixelRatio,C=g>=u?Math.round:m=>m,B=Math.round(g*N);return(m,U)=>(R.A.orient(m,U,(Q,p,T,ot,at,V,E,y,W,z,$,k,j,L,q)=>{let F=m.data[U];const D=F[0],it=F[1],H=F[2],K=F[3],J=D.length;let nt=e.fill.values(m,U),l=e.fill.index??[...new Set(nt)],i=l.map(o=>new Path2D),t=new Map,r=new Map;for(let o=0;o<D.length;o++){let b=D[o],x=it[o],S=H[o];t.has(b)||t.set(b,C(V(b,ot,z,y))),r.has(x)||r.set(x,C(E(x,at,$,W))),r.has(S)||r.set(S,C(E(S,at,$,W)))}let n=t.get(D.find(o=>o!==D[0]))-t.get(D[0]);for(let o=0;o<J;o++){if(K[o]<=v||K[o]>=_)continue;let b=D[o],x=it[o],S=H[o],I=t.get(b),G=r.get(x),Z=r.get(S),Y=n,st=G-Z;Y=Math.max(1,Y-B),st=Math.max(1,st-B);let O=I-B/2-Y,lt=Z+B/2,ut=i[nt[o]];L(ut,O,lt,Y,st),M(m,1,o,O,lt,Y,st)}m.ctx.save(),m.ctx.rect(m.bbox.left,m.bbox.top,m.bbox.width,m.bbox.height),m.ctx.clip(),i.forEach((o,b)=>{m.ctx.fillStyle=l[b],m.ctx.fill(o)}),m.ctx.restore()}),null)}const dt=(d,e,M,g=-1/0,v=1/0)=>{if(e==null){e=1/0;for(let _=0;_<d.length;_++)d[_]!=null&&d[_]>g&&d[_]<v&&(e=Math.min(e,d[_]))}if(M==null){M=-1/0;for(let _=0;_<d.length;_++)d[_]!=null&&d[_]>g&&d[_]<v&&(M=Math.max(M,d[_]))}return[e,M]},xt=(d,e,M,g)=>{let v=g-M||1,_=e.length,N=Array(d.length);for(let C=0;C<d.length;C++)N[C]=d[C]<M?0:d[C]>g?_-1:Math.min(_-1,Math.floor(_*(d[C]-M)/v));return N}}}]);

//# sourceMappingURL=9349.e3f821f9d8caec9f1c72.js.map