"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1510],{47761:(N,P,e)=>{e.d(P,{l:()=>v});var a=e(74848),D=e(22803),x=e(96540),M=e(49785);function v({defaultValues:p,onSubmit:i,validateOnMount:d=!1,validateFieldsOnMount:h,children:c,validateOn:y="onSubmit",maxWidth:g=600,...T}){const{handleSubmit:_,trigger:E,formState:U,...A}=(0,M.mN)({mode:y,defaultValues:p});return(0,x.useEffect)(()=>{d&&E(h)},[E,h,d]),(0,a.jsx)("form",{className:(0,D.css)({maxWidth:g!=="none"?g+"px":g,width:"100%"}),onSubmit:_(i),...T,children:c({errors:U.errors,formState:U,trigger:E,...A})})}},22447:(N,P,e)=>{e.d(P,{A:()=>l,u:()=>f});var a=e(74848),D=e(22803),x=e(96540),M=e(71985),v=e(16753),p=e(58779),i=e(56276),d=e(32370),h=e(44617),c=e(86489),y=e(54731),g=e(51064),T=e(40271),_=e(14749),E=e(45282),U=e(83508),A=e(54594),I=e(90617),R=e(93403),n=e(11817),L=e(1783),W=e(33237),F=e(97267);function K(){const O=L.Yj.map(s=>({value:s.code,label:s.name})).sort((s,t)=>s.value===L.wi?1:t.value===L.wi?-1:s.label.localeCompare(t.label));return[{value:"",label:(0,n.t)("common.locale.default","Default")},...O]}class f extends x.PureComponent{constructor(r){super(r),this.onSubmitForm=async t=>{if(t.preventDefault(),this.props.onConfirm?await this.props.onConfirm():!0){const{homeDashboardUID:b,theme:o,timezone:B,weekStart:j,language:S,queryHistory:z,navbar:m}=this.state;await this.service.update({homeDashboardUID:b,theme:o,timezone:B,weekStart:j,language:S,queryHistory:z,navbar:m}),window.location.reload()}},this.onThemeChanged=t=>{this.setState({theme:t.value}),(0,i.rR)("grafana_preferences_theme_changed",{toTheme:t.value,preferenceType:this.props.preferenceType}),t.value&&(0,F.K)(t.value,!0)},this.onTimeZoneChanged=t=>{typeof t=="string"&&this.setState({timezone:t})},this.onWeekStartChanged=t=>{this.setState({weekStart:t})},this.onHomeDashboardChanged=t=>{this.setState({homeDashboardUID:t})},this.onLanguageChanged=t=>{this.setState({language:t}),(0,i.rR)("grafana_preferences_language_changed",{toLanguage:t,preferenceType:this.props.preferenceType})},this.service=new W.W(r.resourceUri),this.state={isLoading:!1,theme:"",timezone:"",weekStart:"",language:"",queryHistory:{homeTab:""},navbar:{bookmarkUrls:[]}};const s=[];d.$.featureToggles.extraThemes&&s.push("debug"),d.$.featureToggles.grafanaconThemes&&(s.push("desertbloom"),s.push("gildedgrove"),s.push("sapphiredusk"),s.push("tron"),s.push("gloom")),this.themeOptions=(0,M.k)(s).map(t=>({value:t.id,label:u(t)})),this.themeOptions.unshift({value:"",label:(0,n.t)("shared-preferences.theme.default-label","Default")})}async componentDidMount(){this.setState({isLoading:!0});const r=await this.service.load();this.setState({isLoading:!1,homeDashboardUID:r.homeDashboardUID,theme:r.theme,timezone:r.timezone,weekStart:r.weekStart,language:r.language,queryHistory:r.queryHistory,navbar:r.navbar})}render(){const{theme:r,timezone:s,weekStart:t,homeDashboardUID:Y,language:b,isLoading:o}=this.state,{disabled:B}=this.props,j=C(),S=K(),z=this.themeOptions.find(m=>m.value===r)??this.themeOptions[0];return(0,a.jsxs)("form",{onSubmit:this.onSubmitForm,className:j.form,children:[(0,a.jsxs)(h.n,{label:(0,a.jsx)(n.x6,{i18nKey:"shared-preferences.title",children:"Preferences"}),disabled:B,children:[(0,a.jsx)(c.D,{loading:o,disabled:o,label:(0,n.t)("shared-preferences.fields.theme-label","Interface theme"),description:d.$.featureToggles.grafanaconThemes&&d.$.feedbackLinksEnabled?(0,a.jsxs)(n.x6,{i18nKey:"shared-preferences.fields.theme-description",children:["Enjoying the limited edition themes? Tell us what you'd like to see"," ",(0,a.jsx)(y.Y,{variant:"bodySmall",external:!0,href:"https://docs.google.com/forms/d/e/1FAIpQLSeRKAY8nUMEVIKSYJ99uOO-dimF6Y69_If1Q1jTLOZRWqK1cw/viewform?usp=dialog",children:"here."})]}):void 0,children:(0,a.jsx)(g.G,{options:this.themeOptions,value:z.value,onChange:this.onThemeChanged,id:"shared-preferences-theme-select"})}),(0,a.jsx)(c.D,{loading:o,disabled:o,label:(0,a.jsx)(T.J,{htmlFor:"home-dashboard-select",children:(0,a.jsx)("span",{className:j.labelText,children:(0,a.jsx)(n.x6,{i18nKey:"shared-preferences.fields.home-dashboard-label",children:"Home Dashboard"})})}),"data-testid":"User preferences home dashboard drop down",children:(0,a.jsx)(R.b,{value:Y,onChange:m=>this.onHomeDashboardChanged(m?.uid??""),defaultOptions:!0,isClearable:!0,placeholder:(0,n.t)("shared-preferences.fields.home-dashboard-placeholder","Default dashboard"),inputId:"home-dashboard-select"})}),(0,a.jsx)(c.D,{loading:o,disabled:o,label:(0,n.t)("shared-dashboard.fields.timezone-label","Timezone"),"data-testid":p.Tp.components.TimeZonePicker.containerV2,children:(0,a.jsx)(_.U,{includeInternal:!0,value:s,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})}),(0,a.jsx)(c.D,{loading:o,disabled:o,label:(0,n.t)("shared-preferences.fields.week-start-label","Week start"),"data-testid":p.Tp.components.WeekStartPicker.containerV2,children:(0,a.jsx)(E.l,{value:t||"",onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})}),(0,a.jsx)(c.D,{loading:o,disabled:o,label:(0,a.jsxs)(T.J,{htmlFor:"locale-select",children:[(0,a.jsx)("span",{className:j.labelText,children:(0,a.jsx)(n.x6,{i18nKey:"shared-preferences.fields.locale-label",children:"Language"})}),(0,a.jsx)(U.y,{featureState:v.Ay.beta})]}),"data-testid":"User preferences language drop down",children:(0,a.jsx)(g.G,{value:S.find(m=>m.value===b)?.value||"",onChange:m=>this.onLanguageChanged(m?.value??""),options:S,placeholder:(0,n.t)("shared-preferences.fields.locale-placeholder","Choose language"),id:"locale-select"})})]}),(0,a.jsx)(A.$n,{type:"submit",variant:"primary","data-testid":p.Tp.components.UserProfile.preferencesSaveButton,children:(0,a.jsx)(n.x6,{i18nKey:"common.save",children:"Save"})})]})}}const l=f,C=(0,I.N)(()=>({labelText:(0,D.css)({marginRight:"6px"}),form:(0,D.css)({width:"100%",maxWidth:"600px"})}));function u(O){switch(O.id){case"dark":return(0,n.t)("shared.preferences.theme.dark-label","Dark");case"light":return(0,n.t)("shared.preferences.theme.light-label","Light");case"system":return(0,n.t)("shared.preferences.theme.system-label","System preference");default:return O.name}}},82250:(N,P,e)=>{e.r(P),e.d(P,{OrgDetailsPage:()=>n,default:()=>K});var a=e(74848),D=e(96540),x=e(71468),M=e(48583),v=e(54122),p=e(22447),i=e(87638),d=e(12636),h=e(61491),c=e(91830),y=e(44617),g=e(86489),T=e(34128),_=e(54594),E=e(47761);const A=({onSubmit:f,orgName:l})=>{const C=i.TP.hasPermission(h.AccessControlAction.OrgsWrite);return(0,a.jsx)(E.l,{defaultValues:{orgName:l},onSubmit:({orgName:u})=>f(u),children:({register:u})=>(0,a.jsxs)(y.n,{label:"Organization profile",disabled:!C,children:[(0,a.jsx)(g.D,{label:"Organization name",children:(0,a.jsx)(T.p,{id:"org-name-input",type:"text",...u("orgName",{required:!0})})}),(0,a.jsx)(_.$n,{type:"submit",children:"Update organization name"})]})})};var I=e(80713),R=e(8969);class n extends D.PureComponent{constructor(){super(...arguments),this.onUpdateOrganization=l=>{this.props.setOrganizationName(l),this.props.updateOrganization()},this.handleConfirm=()=>new Promise(l=>{i.lE.publish(new c.bY({title:"Confirm preferences update",text:"This will update the preferences for the whole organization. Are you sure you want to update the preferences?",yesText:"Save",yesButtonVariant:"primary",onConfirm:async()=>l(!0),onDismiss:async()=>l(!1)}))})}async componentDidMount(){await this.props.loadOrganization()}render(){const{navModel:l,organization:C}=this.props,u=Object.keys(C).length===0,O=i.TP.hasPermission(h.AccessControlAction.OrgsRead),r=i.TP.hasPermission(h.AccessControlAction.OrgsPreferencesRead),s=i.TP.hasPermission(h.AccessControlAction.OrgsPreferencesWrite);return(0,a.jsx)(v.Y,{navModel:l,children:(0,a.jsx)(v.Y.Contents,{isLoading:u,children:!u&&(0,a.jsxs)(M.B,{direction:"column",gap:3,children:[O&&(0,a.jsx)(A,{onSubmit:this.onUpdateOrganization,orgName:C.name}),r&&(0,a.jsx)(p.A,{resourceUri:"org",disabled:!s,preferenceType:"org",onConfirm:this.handleConfirm})]})})})}}function L(f){return{navModel:(0,d.tc)(f.navIndex,"org-settings"),organization:f.organization.organization}}const W={loadOrganization:I.YS,setOrganizationName:R.n,updateOrganization:I.L_},K=(0,x.connect)(L,W)(n)}}]);

//# sourceMappingURL=OrgDetailsPage.3dcf1fe242e1ede1e3ea.js.map