"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2154],{70811:(ne,M,s)=>{s.d(M,{A:()=>S});var e=s(74848),c=s(96540),h=s(60484),p=s(22560),x=s(54594),m=s(89963);class S extends c.PureComponent{render(){const{searchQuery:O,linkButton:E,setSearchQuery:r,target:ae,placeholder:se="Search by name or type",sortPicker:D}=this.props,Y={href:E?.href,disabled:E?.disabled};return ae&&(Y.target=ae),(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(h.I,{grow:!0,children:(0,e.jsx)(p.Z,{value:O,onChange:r,placeholder:se})}),D&&(0,e.jsx)(m.r,{onChange:D.onChange,value:D.value,getSortOptions:D.getSortOptions}),E&&(0,e.jsx)(x.z9,{...Y,children:E.title})]})}}},2983:(ne,M,s)=>{s.r(M),s.d(M,{default:()=>hs});var e=s(74848),c=s(54148),h=s(61491),p=s(61674),x=s(96540),m=s(41007),S=s(54122),y=s(27033),O=s(40099),E=s(11241),r=s(22803),ae=s(53027),se=s(56276),D=s(29675),Y=s(86489),ie=s(60641),he=s(6736),B=s(51064),R=s(81876),q=s(59830),W=s(87638),Ce=s(65539),d=s(11817),L=s(83524),$=s(93078),b=s(67097),k=s(83215),I=s(36871),A=s(32864),Q=s(66384),F=s(98349),C=s(6210),N=s(48583),w=s(91715),te=s(36233);const pe=a=>({heading:(0,r.css)({fontSize:a.typography.h5.fontSize,fontWeight:"inherit"}),figure:(0,r.css)({width:"inherit",marginRight:"0px","> img":{width:a.spacing(7)}}),meta:(0,r.css)({marginTop:"6px",position:"relative"}),description:(0,r.css)({margin:"0px",fontSize:a.typography.bodySmall.fontSize}),card:(0,r.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,r.css)({marginRight:a.spacing(3),marginLeft:a.spacing(1),width:a.spacing(7),maxHeight:a.spacing(7)})});function me(){const a=(0,D.of)(te.X);return(0,A.a)("enterprise.plugins")?(0,e.jsx)(Q.E,{text:(0,d.t)("get-enterprise.title","Enterprise"),color:"blue"}):(0,e.jsx)(Q.E,{icon:"lock",role:"img","aria-label":(0,d.t)("lock-icon","lock icon"),text:(0,d.t)("get-enterprise.title","Enterprise"),color:"darkgrey",className:a,title:(0,d.t)("get-enterprise.requires-license","Requires a Grafana Enterprise license")})}const Ee=({items:a,onClickItem:t})=>{const n=(0,D.of)(pe);return(0,e.jsx)(F.x,{gap:1.5,minColumnWidth:44,children:a.map(o=>(0,e.jsxs)(C.Z,{className:n.card,href:o.url,onClick:l=>{t&&t(l,o)},children:[(0,e.jsx)(C.Z.Heading,{className:n.heading,children:o.name}),(0,e.jsx)(C.Z.Figure,{align:"center",className:n.figure,children:(0,e.jsx)("img",{className:n.logo,src:o.logo,alt:""})}),(0,e.jsx)(C.Z.Meta,{className:n.meta,children:(0,e.jsxs)(N.B,{height:"auto",wrap:"wrap",children:[o.isEnterprise&&(0,e.jsx)(me,{}),o.isDeprecated&&(0,e.jsx)(w.yf,{}),o.isInstalled&&(0,e.jsx)(w.Jn,{}),o.isDisabled&&(0,e.jsx)(w.Df,{error:o.error}),(0,k.wD)(o)&&(0,e.jsx)(w.z$,{plugin:o}),o.angularDetected&&(0,e.jsx)(w.fk,{})]})})]},o.id))})};var le=s(79784);const Pe=a=>({categoryHeader:(0,r.css)({alignItems:"center",display:"flex",marginBottom:a.spacing(3)}),categoryLabel:(0,r.css)({marginBottom:0,marginLeft:a.spacing(1)})}),je=({iconName:a,label:t})=>{const n=(0,D.of)(Pe);return(0,e.jsxs)("div",{className:n.categoryHeader,children:[(0,e.jsx)(le.I,{name:a,size:"xl"}),(0,e.jsx)("h3",{className:n.categoryLabel,children:t})]})};var v=s(25356),f=s(54594);const V=a=>({modal:(0,r.css)({width:"500px"}),modalContent:(0,r.css)({overflow:"visible",color:a.colors.text.secondary,a:{color:a.colors.text.link}}),description:(0,r.css)({marginBottom:a.spacing(2)}),bottomSection:(0,r.css)({display:"flex",borderTop:`1px solid ${a.colors.border.weak}`,paddingTop:a.spacing(3),marginTop:a.spacing(3)}),actionsSection:(0,r.css)({display:"flex",justifyContent:"end",marginTop:a.spacing(3)}),warningIcon:(0,r.css)({color:a.colors.warning.main,paddingRight:a.spacing(),marginTop:a.spacing(.25)}),header:(0,r.css)({display:"flex",alignItems:"center"}),headerTitle:(0,r.css)({margin:0}),headerLogo:(0,r.css)({marginRight:a.spacing(2),width:"32px",height:"32px"})});function ke({item:a,isOpen:t,onDismiss:n}){const o=(0,D.of)(V);return(0,e.jsx)(v.a,{className:o.modal,contentClassName:o.modalContent,title:(0,e.jsx)(Qe,{item:a}),isOpen:t,onDismiss:n,children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:[a.description&&(0,e.jsx)("div",{className:o.description,children:a.description}),(0,e.jsxs)("div",{children:["Links",(0,e.jsx)("br",{}),(0,e.jsx)("a",{href:`https://grafana.com/grafana/plugins/${a.id}`,title:`${a.name} on Grafana.com`,target:"_blank",rel:"noopener noreferrer",children:a.name})]})]}),(0,e.jsxs)("div",{className:o.bottomSection,children:[(0,e.jsx)("div",{className:o.warningIcon,children:(0,e.jsx)(le.I,{name:"exclamation-triangle"})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["Editors cannot add new connections. You may check to see if it is already configured in"," ",(0,e.jsx)("a",{href:"/connections/datasources",children:"Data sources"}),"."]}),(0,e.jsx)("p",{children:"To add a new connection, contact your Grafana admin."})]})]}),(0,e.jsx)("div",{className:o.actionsSection,children:(0,e.jsx)(f.$n,{onClick:n,children:"Okay"})})]})})}function Qe({item:a}){const t=(0,D.of)(V);return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:t.header,children:[a.logo&&(0,e.jsx)("img",{className:t.headerLogo,src:a.logo,alt:`logo of ${a.name}`}),(0,e.jsx)("h4",{className:t.headerTitle,children:a.name})]})})}const Je=a=>({spacer:(0,r.css)({height:a.spacing(2)}),modal:(0,r.css)({width:"500px"}),modalContent:(0,r.css)({overflow:"visible"}),actionBar:(0,r.css)({[a.breakpoints.up("xl")]:{marginLeft:"auto"}})});function Xe(){const[a,t]=(0,Ce.s)(),n=a.search?String(a.search):"",[o,l]=(0,x.useState)(!1),[u,g]=(0,x.useState)(null),i=(0,c.zy)(),P=(0,I.W)(),T=(0,ae.SE)(i.search),J=T.sortBy||k.by.nameAsc,X=T.filterBy?.toString()||"all",_=W.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),re=(0,D.of)(Je),Z=z=>{t({search:z})},de=(0,E.pw)(),{error:G,plugins:K,isLoading:ue}=(0,E.PW)({keyword:n,type:m.QE.datasource,isInstalled:X==="installed"?!0:void 0,hasUpdate:X==="has-update"?!0:void 0},J),H=[{value:"all",label:"All"},{value:"installed",label:"Installed"},{value:"has-update",label:"New Updates"}],fe=(z,He)=>{_||(z.preventDefault(),z.stopPropagation(),ye(He),(0,se.rR)("connections_plugin_card_clicked",{plugin_id:He.id,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}))},ye=z=>{l(!0),g(z)},Ie=()=>{l(!1),g(null)},De=(0,x.useMemo)(()=>K.map(z=>({...z,logo:z.info.logos.small,url:p.b.DataSourcesDetails.replace(":id",z.id)})),[K]),Be=z=>{P.push({query:{sortBy:z.value}})},ee=z=>{P.push({query:{filterBy:z}})},ge=(0,x.useMemo)(()=>!ue&&!G&&K.length<1,[ue,G,K]),ve=(0,d.t)("connections.connect-data.category-header-label","Data sources");return(0,e.jsxs)(e.Fragment,{children:[u&&(0,e.jsx)(ke,{item:u,isOpen:o,onDismiss:Ie}),(0,e.jsxs)(L.G,{wrap:!0,children:[(0,e.jsx)(Y.D,{label:(0,d.t)("common.search","Search"),children:(0,e.jsx)(b.L,{value:n,onSearch:Z})}),(0,e.jsxs)(L.G,{className:re.actionBar,children:[de?(0,e.jsx)(Y.D,{label:(0,d.t)("plugins.filter.state","State"),children:(0,e.jsx)(ie.z,{value:X,onChange:ee,options:H})}):(0,e.jsx)(he.m,{content:(0,d.t)("plugins.filter.disabled","This filter has been disabled because the Grafana server cannot access grafana.com"),placement:"top",children:(0,e.jsx)("div",{children:(0,e.jsx)(Y.D,{label:(0,d.t)("plugins.filter.state","State"),children:(0,e.jsx)(ie.z,{disabled:!0,value:X,onChange:ee,options:H})})})}),(0,e.jsx)(Y.D,{label:(0,d.t)("plugins.filter.sort","Sort"),children:(0,e.jsx)(B.G,{"aria-label":(0,d.t)("plugins.filter.sort-list","Sort Plugins List"),width:24,value:J?.toString(),onChange:Be,options:[{value:"nameAsc",label:"By name (A-Z)"},{value:"nameDesc",label:"By name (Z-A)"},{value:"updated",label:"By updated date"},{value:"published",label:"By published date"},{value:"downloads",label:"By downloads"}]})})]})]}),(0,e.jsx)(je,{iconName:"database",label:ve}),ue?(0,e.jsx)(R._,{text:(0,d.t)("common.loading","Loading...")}):G?(0,e.jsxs)(d.x6,{i18nKey:"alerting.policies.update-errors.error-code",values:{error:G.message},children:['Error message: "',{error:G.message},'"']}):(0,e.jsx)(Ee,{items:De,onClickItem:fe}),ge&&(0,e.jsx)(q.p,{variant:"not-found",message:(0,d.t)("connections.connect-data.empty-message","No results matching your query were found")}),(0,e.jsx)($.E,{})]})}function qe(){const{isLoading:a,updatablePlugins:t}=(0,E.sM)(),n=t.filter(P=>P.type===m.QE.datasource),[o,l]=(0,x.useState)(!1),u=n.length<=0||a,g=()=>{l(!0)},i=(0,e.jsx)(y.A,{disabled:u,onUpdateAll:g,updatablePluginsLength:n.length});return(0,e.jsx)(S.Y,{navId:"connections-add-new-connection",actions:i,children:(0,e.jsxs)(S.Y.Contents,{children:[(0,e.jsx)(Xe,{}),(0,e.jsx)(O.A,{isOpen:o,isLoading:a,onDismiss:()=>l(!1),plugins:n})]})})}var ce=s(37e3),_e=s(59467);function ea(){const a="standalone-plugin-page-/connections/add-new-connection",{id:t=""}=(0,c.g)(),l=!!(0,h.useSelector)(u=>u.navIndex)[a]?a:"connections-add-new-connection";return(0,e.jsx)(_e.V,{pluginId:t,navId:l,notFoundComponent:(0,e.jsx)(aa,{}),notFoundNavModel:{text:"Unknown datasource",subTitle:"No datasource with this ID could be found.",active:!0}})}function aa(){const{id:a}=(0,c.g)();return(0,e.jsxs)(ce.F,{severity:h.AppNotificationSeverity.Warning,title:"",children:["Maybe you mistyped the URL or the plugin with the id ",(0,e.jsx)(Q.E,{text:a,color:"orange"})," is unavailable.",(0,e.jsx)("br",{}),"To see a list of available datasources please ",(0,e.jsx)("a",{href:p.b.AddNewConnection,children:"click here"}),"."]})}var xe=s(32370),U=s(92643);function sa(){const a=W.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),t=(0,x.useCallback)(()=>{(0,U.DO)({path:location.pathname})},[]);return a?(0,e.jsx)(f.z9,{icon:"plus",href:xe.$.appSubUrl+p.b.DataSourcesNew,onClick:t,children:(0,e.jsx)(d.x6,{i18nKey:"data-sources.datasource-add-button.label",children:"Add new data source"})}):null}var ta=s(54731),j=s(12786),Le=s(20523),Se=s(2543),na=s(70811);const be="alpha-asc",Oe="alpha-desc",oa=[{label:"Sort by A\u2013Z",value:be},{label:"Sort by Z\u2013A",value:Oe}];function ra(){const a=(0,h.useDispatch)(),t=(0,x.useMemo)(()=>(0,Se.debounce)(i=>{(0,U.ov)({query:i})},300),[]),n=(0,x.useCallback)(i=>{a((0,j.Bs)(i)),i&&t(i)},[a,t]),o=(0,h.useSelector)(({dataSources:i})=>(0,j.xs)(i)),l=(0,x.useCallback)(i=>a((0,j.Tk)(i.value===be)),[a]),u=(0,h.useSelector)(({dataSources:i})=>(0,j.lv)(i)),g={onChange:l,value:u?be:Oe,getSortOptions:()=>Promise.resolve(oa)};return(0,e.jsx)(na.A,{searchQuery:o,setSearchQuery:n,sortPicker:g},"action-bar")}function ia(){const{isLoading:a}=(0,j.US)(),t=(0,h.useSelector)(g=>(0,j.zC)(g.dataSources)),n=(0,h.useSelector)(({dataSources:g})=>(0,j.wC)(g)),o=W.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),l=W.TP.hasPermission(h.AccessControlAction.DataSourcesWrite),u=W.TP.hasAccessToExplore();return(0,e.jsx)(la,{dataSources:t,dataSourcesCount:n,isLoading:a,hasCreateRights:o,hasWriteRights:l,hasExploreRights:u})}function la({dataSources:a,dataSourcesCount:t,isLoading:n,hasCreateRights:o,hasWriteRights:l,hasExploreRights:u}){const g=(0,D.of)(ca),i=(0,c.zy)();if((0,x.useEffect)(()=>{(0,U.kg)({grafana_version:xe.$.buildInfo.version,path:i.pathname})},[i]),!n&&t===0)return(0,e.jsx)(q.p,{variant:"call-to-action",button:(0,e.jsx)(f.z9,{disabled:!o,href:p.b.DataSourcesNew,icon:"database",size:"lg",children:(0,e.jsx)(d.x6,{i18nKey:"data-source-list.empty-state.button-title",children:"Add data source"})}),message:(0,d.t)("data-source-list.empty-state.title","No data sources defined"),children:(0,e.jsxs)(d.x6,{i18nKey:"data-source-list.empty-state.pro-tip",children:["You can also define data sources through configuration files."," ",(0,e.jsx)(ta.Y,{external:!0,href:"http://docs.grafana.org/administration/provisioning/?utm_source=grafana_ds_list#data-sources",children:"Learn more"})]})});const P=()=>n?new Array(20).fill(null).map((T,J)=>(0,e.jsx)(Le.N.Skeleton,{hasExploreRights:u},J)):a.map(T=>(0,e.jsx)("li",{children:(0,e.jsx)(Le.N,{dataSource:T,hasWriteRights:l,hasExploreRights:u})},T.uid));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ra,{}),a.length===0&&!n?(0,e.jsx)(q.p,{variant:"not-found",message:(0,d.t)("data-sources.empty-state.message","No data sources found")}):(0,e.jsx)("ul",{className:g.list,children:P()})]})}const ca=a=>({list:(0,r.css)({listStyle:"none",display:"grid"})});function da(){const t=(0,h.useSelector)(({dataSources:n})=>(0,j.wC)(n))>0?(0,e.jsx)(sa,{}):void 0;return(0,e.jsx)(S.Y,{navId:"connections-datasources",actions:t,children:(0,e.jsx)(S.Y.Contents,{children:(0,e.jsx)(ia,{})})})}var Ae=s(20337),Re=s(64555),ua=s(34547),ga=s(79310);function ha({uid:a}){(0,j.oU)(a);const t=(0,h.useDispatch)(),n=(0,h.useSelector)(i=>i.dataSources.dataSource),o=(0,h.useSelector)(i=>i.plugins.dashboards),l=(0,h.useSelector)(i=>i.plugins.isLoadingPluginDashboards);(0,x.useEffect)(()=>{n.id>0&&t((0,ua.h9)())},[t,n.id]);const u=(i,P)=>{t((0,Re.Q9)({pluginId:i.pluginId,path:i.path,overwrite:P,inputs:[{name:"*",type:"datasource",pluginId:n.type,value:n.name}]},i.title))},g=({uid:i})=>{t((0,Re.TA)(i))};return(0,e.jsx)(pa,{dashboards:o,isLoading:l,onImportDashboard:u,onRemoveDashboard:g})}const pa=({isLoading:a,dashboards:t,onImportDashboard:n,onRemoveDashboard:o})=>a?(0,e.jsx)(Ae.A,{}):(0,e.jsx)(ga.A,{dashboards:t,onImport:n,onRemove:o});var Ue=s(98437),Ke=s(12636),Ne=s(802),Te=s(96326);function ze(a){const{uid:t=""}=(0,c.g)(),n=(0,c.zy)(),o=(0,Ne.xw)(t),l=(0,Ne.S4)(o.type),u=(0,E.ob)(o.type),g=new URLSearchParams(n.search),i=a||g.get("page"),{plugin:P,loadError:T,loading:J}=(0,Ne._e)(),X=(0,Ue.l)()?.getInstanceSettings(t),_=!!(X?.meta?.alerting??!1),re=X?.type==="alertmanager",Z=_||re,de=(0,h.useSelector)(H=>H.navIndex),G=i?`datasource-${i}-${t}`:`datasource-settings-${t}`;let K={node:{text:"Data Source Nav Node"},main:{text:"Data Source Nav Node"}};if(T){const H={text:T,subTitle:"Data Source Error",icon:"exclamation-triangle"};K={node:H,main:H}}return(J||!P)&&(K=(0,Ke.tc)(de,G,(0,Te.$m)("settings"))),P&&(K=(0,Ke.tc)(de,G,(0,Te.Vh)((0,Te.R4)(o,P),i||"settings"))),{navId:"connections-datasources",pageNav:{...K.main,dataSourcePluginName:u?.name||P?.meta.name||"",active:!0,text:o.name,subTitle:`Type: ${l.name}`,children:(K.main.children||[]).map(H=>({...H,url:H.url?.replace("datasources/edit/","/connections/datasources/edit/")}))},dataSourceHeader:{alertingSupported:Z}}}function ma(){const{uid:a=""}=(0,c.g)(),{navId:t,pageNav:n}=ze("dashboards");return(0,e.jsx)(S.Y,{navId:t,pageNav:n,children:(0,e.jsx)(S.Y.Contents,{children:(0,e.jsx)(ha,{uid:a})})})}var xa=s(35383),fa=s(93253),We=s(83821),va=s(70415),ja=s(22492),oe=s(58779),$e=s(60484),Sa=s(34128),ya=s(29010);function Da({dataSourceName:a,isDefault:t,onDefaultChange:n,onNameChange:o,disabled:l}){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"gf-form-group","aria-label":"Datasource settings page basic settings",children:(0,e.jsxs)("div",{className:"gf-form-inline",children:[(0,e.jsx)("div",{className:"gf-form max-width-30",children:(0,e.jsx)($e.I,{label:"Name",tooltip:`The name is used when you select the data source in panels. The default data source is
              'preselected in new panels.`,grow:!0,disabled:l,labelWidth:14,children:(0,e.jsx)(Sa.p,{id:"basic-settings-name",type:"text",value:a,placeholder:"Name",onChange:u=>o(u.currentTarget.value),required:!0,"data-testid":oe.Tp.pages.DataSource.name})})}),(0,e.jsx)($e.I,{label:"Default",labelWidth:8,disabled:l,children:(0,e.jsx)(ya.K,{id:"basic-settings-default",value:t,onChange:u=>{n(u.currentTarget.checked)}})})]})})})}function ps({enabled:a}){const t=useStyles2(Ca);return jsx("div",{className:t.badge,children:a?jsx(Badge,{color:"green",icon:"check-circle",text:"Alerting supported"}):jsx(Badge,{color:"orange",icon:"exclamation-triangle",text:"Alerting not supported"})})}const Ca=a=>({badge:css({marginBottom:a.spacing(2)})});function Ea({canSave:a,canDelete:t,onDelete:n,onSubmit:o,onTest:l}){return(0,e.jsxs)("div",{className:"gf-form-button-row",children:[(0,e.jsx)(f.$n,{type:"button",variant:"destructive",disabled:!t,onClick:n,"data-testid":oe.Tp.pages.DataSource.delete,children:"Delete"}),a&&(0,e.jsx)(f.$n,{type:"submit",variant:"primary",disabled:!a,onClick:o,"data-testid":oe.Tp.pages.DataSource.saveAndTest,children:"Save & test"}),!a&&(0,e.jsx)(f.$n,{variant:"primary",onClick:l,children:"Test"})]})}var Pa=s(96698),ba=s(23657),Aa=s(88023);const Na="datasources.settings.cloudInfoBox.isDismissed";function Ta({dataSource:a}){let t="",n="";if(a.readOnly||(a.version??0)>2||Aa.$W.buildInfo.edition!==Pa.r.OpenSource)return null;switch(a.type){case"prometheus":t="Prometheus",n="Loki";break;case"loki":t="Loki",n="Prometheus";break;default:return null}return(0,e.jsx)(ba.b,{storageKey:Na,defaultValue:!1,children:(o,l)=>o?null:(0,e.jsxs)(ce.F,{title:`Configure your ${t} data source below`,severity:"info",bottomSpacing:4,onRemove:()=>{l(!0)},children:["Or skip the effort and get ",t," (and ",n,") as fully-managed, scalable, and hosted data sources from Grafana Labs with the"," ",(0,e.jsx)("a",{className:"external-link",href:`https://grafana.com/signup/cloud/connect-account?src=grafana-oss&cnt=${a.type}-settings`,target:"_blank",rel:"noreferrer",title:"The free plan includes 10k active metrics and 50gb storage.",children:"free-forever Grafana Cloud plan"}),"."]})})}const Ma="This data source was added by config and cannot be modified using the UI. Please contact your server admin to update this data source.";function Fe(){return(0,e.jsx)(ce.F,{"data-testid":oe.Tp.pages.DataSource.readOnly,severity:"info",title:"Provisioned data source",children:Ma})}function Ia({dataSourceRights:a,onDelete:t}){const{readOnly:n,hasDeleteRights:o}=a,l=!n&&o,u=()=>history.back();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(Fe,{}),(0,e.jsxs)("div",{className:"gf-form-button-row",children:[l&&(0,e.jsx)(f.$n,{type:"submit",variant:"destructive",onClick:t,children:"Delete"}),(0,e.jsx)(f.$n,{variant:"secondary",fill:"outline",type:"button",onClick:u,children:"Back"})]})]})}const Ba="You are not allowed to modify this data source. Please contact your server admin to update this data source.";function La(){return(0,e.jsx)(ce.F,{severity:"info",title:"Missing rights",children:Ba})}function Oa({plugin:a,pageId:t}){if(!a||!a.configPages)return null;const n=a.configPages.find(({id:o})=>o===t);return n?(0,e.jsx)(n.body,{plugin:a,query:{}}):(0,e.jsxs)("div",{children:["Page not found: ",n]})}var Ra=s(4050);class Ua extends x.PureComponent{constructor(t){super(t),this.element=null,this.onModelChanged=n=>{this.props.onModelChange(n)},this.scopeProps={ctrl:{datasourceMeta:t.dataSourceMeta,current:(0,Se.cloneDeep)(t.dataSource)},onModelChanged:this.onModelChanged},this.onModelChanged=this.onModelChanged.bind(this)}componentDidMount(){const{plugin:t}=this.props;if(this.element&&!t.components.ConfigEditor){const n=(0,Ra.E)(),o='<plugin-component type="datasource-config-ctrl" />';this.component=n.load(this.element,this.scopeProps,o)}}componentDidUpdate(t){const{plugin:n}=this.props;!n.components.ConfigEditor&&this.props.dataSource!==t.dataSource&&(this.scopeProps.ctrl.current=(0,Se.cloneDeep)(this.props.dataSource),this.component?.digest())}componentWillUnmount(){this.component&&this.component.destroy()}render(){const{plugin:t,dataSource:n}=this.props;return t?(0,e.jsx)("div",{ref:o=>this.element=o,children:t.components.ConfigEditor&&(0,x.createElement)(t.components.ConfigEditor,{options:n,onOptionsChange:this.onModelChanged})}):null}}var Ka=s(62637);function za({state:a}){return(0,e.jsxs)("div",{className:"gf-form",children:[(0,e.jsx)("div",{className:"gf-form-label width-10",children:"Plugin state"}),(0,e.jsx)("div",{className:"gf-form-label gf-form-label--transparent",children:(0,e.jsx)(Ka.p,{state:a})})]})}var Me=s(8270);const Wa=(a,t)=>({content:(0,r.css)({color:a.colors.text.secondary,paddingTop:t?a.spacing(1):0,maxHeight:"50vh",overflowY:"auto"}),disabled:(0,r.css)({pointerEvents:"none",color:a.colors.text.secondary})}),we=({title:a,exploreUrl:t,dataSourceId:n,onDashboardLinkClicked:o})=>{const l=(0,D.$j)(),g=Wa(l,!!a),i=W.TP.hasAccessToExplore();return(0,e.jsx)("div",{className:g.content,children:(0,e.jsxs)(d.x6,{i18nKey:"data-source-testing-status-page.success-more-details-links",children:["Next, you can start to visualize data by"," ",(0,e.jsx)(Me.N,{"aria-label":"Create a dashboard",href:`/dashboard/new-with-ds/${n}`,className:"external-link",onClick:o,children:"building a dashboard"}),", or by querying data in the"," ",(0,e.jsx)(Me.N,{"aria-label":"Explore data",className:(0,r.cx)("external-link",{[`${g.disabled}`]:!i,"test-disabled":!i}),href:t,children:"Explore view"}),"."]})})};we.displayName="AlertSuccessMessage";const Ve=({link:a})=>{const t=(0,D.$j)(),n={content:(0,r.css)({color:t.colors.text.secondary,paddingBlock:t.spacing(1),maxHeight:"50vh",overflowY:"auto"})};return a?/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(a)?(0,e.jsx)("div",{className:n.content,children:(0,e.jsxs)(d.x6,{i18nKey:"data-source-testing-status-page.error-more-details-link",children:["Click"," ",(0,e.jsx)(Me.N,{"aria-label":"More details about the error",className:"external-link",href:a,target:"_blank",rel:"noreferrer",children:"here"})," ","to learn more about this error."]})}):(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(e.Fragment,{})};Ve.displayName="ErrorDetailsLink";const $a=new Set(["success","info","warning","error"]),Fa=a=>$a.has(a),wa=a=>a.toLowerCase()==="ok"?"success":Fa(a)?a:"info";function Va({testingStatus:a,exploreUrl:t,dataSource:n}){const o=wa(a?.status??"error"),l=a?.message,u=a?.details?.message,g=a?.details?.verboseMessage,i=a?.details?.errorDetailsLink,P=()=>{(0,U.TR)({grafana_version:xe.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},T=(0,D.of)(Ga);return l?(0,e.jsx)("div",{className:(0,r.cx)("gf-form-group",T.container),children:(0,e.jsx)(ce.F,{severity:o,title:l,"data-testid":oe.Tp.pages.DataSource.alert,children:a?.details&&(0,e.jsxs)(e.Fragment,{children:[u?(0,e.jsx)(e.Fragment,{children:String(u)}):null,o==="success"?(0,e.jsx)(we,{title:l,exploreUrl:t,dataSourceId:n.uid,onDashboardLinkClicked:P}):null,o==="error"&&i?(0,e.jsx)(Ve,{link:String(i)}):null,g?(0,e.jsx)("details",{style:{whiteSpace:"pre-wrap"},children:String(g)}):null]})})}):null}const Ga=a=>({container:(0,r.css)({paddingTop:a.spacing(3)}),moreLink:(0,r.css)({marginBlock:a.spacing(1)})});function Ya({uid:a,pageId:t}){(0,j.oU)(a);const n=(0,h.useDispatch)(),o=(0,j.xw)(a),l=(0,j.S4)(o.type),u=(0,j._e)(),g=(0,j.u1)(a),i=(0,j.Tn)(a),P=(0,j.$k)(),T=(0,j.BY)(a),J=(0,j.k9)(),X=Z=>n((0,j.C_)(Z)),_=Z=>n((0,j.rb)(Z)),re=Z=>n((0,j.jz)(Z));return(0,e.jsx)(Za,{pageId:t,dataSource:o,dataSourceMeta:l,dataSourceSettings:u,dataSourceRights:g,exploreUrl:i,onDelete:P,onDefaultChange:X,onNameChange:_,onOptionsChange:re,onTest:T,onUpdate:J})}function Za({pageId:a,dataSource:t,dataSourceMeta:n,dataSourceSettings:o,dataSourceRights:l,exploreUrl:u,onDelete:g,onDefaultChange:i,onNameChange:P,onOptionsChange:T,onTest:J,onUpdate:X}){const{plugin:_,loadError:re,testingStatus:Z,loading:de}=o,{readOnly:G,hasWriteRights:K,hasDeleteRights:ue}=l,H=t.id>0,fe=(0,Ue.l)()?.getInstanceSettings(t.uid),ye=async ee=>{ee.preventDefault(),(0,U._i)("save_and_test");try{await X({...t}),(0,U.m3)({item:"success"}),ja.A.publish(new xa.wE)}catch{(0,U.m3)({item:"fail"});return}J()},Ie=fa.S.DataSourceConfig,{extensions:De}=(0,va.kr)({extensionPointId:Ie}),Be=(0,x.useMemo)(()=>{const ee=["grafana-pdc-app","grafana-auth-app"];return De.filter(ge=>ee.includes(ge.pluginId))},[De]);return re?(0,e.jsx)(Ia,{dataSourceRights:l,onDelete:()=>{(0,U._i)("delete"),g()}}):de?(0,e.jsx)(Ae.A,{}):!H||!fe?null:a?(0,e.jsx)(We.p,{instanceSettings:fe,children:(0,e.jsx)(Oa,{pageId:a,plugin:_})}):(0,e.jsxs)("form",{onSubmit:ye,children:[!K&&(0,e.jsx)(La,{}),G&&(0,e.jsx)(Fe,{}),n.state&&(0,e.jsx)(za,{state:n.state}),(0,e.jsx)(Ta,{dataSource:t}),(0,e.jsx)(Da,{dataSourceName:t.name,isDefault:t.isDefault,onDefaultChange:i,onNameChange:P,disabled:G||!K}),_&&(0,e.jsx)(We.p,{instanceSettings:fe,children:(0,e.jsx)(Ua,{plugin:_,dataSource:t,dataSourceMeta:n,onModelChange:T})}),Be.map(ee=>{const ge=ee.component;return(0,e.jsx)("div",{children:(0,e.jsx)(ge,{context:{dataSource:(0,Se.cloneDeep)(t),dataSourceMeta:n,testingStatus:Z,setJsonData:ve=>T({...t,jsonData:{...t.jsonData,...ve}}),setSecureJsonData:ve=>T({...t,secureJsonData:{...t.secureJsonData,...ve}})}})},ee.id)}),(0,e.jsx)(Va,{testingStatus:Z,exploreUrl:u,dataSource:t}),(0,e.jsx)(Ea,{onSubmit:ye,onDelete:()=>{(0,U._i)("delete"),g()},onTest:()=>{(0,U._i)("test"),J()},canDelete:!G&&ue,canSave:!G&&K})]})}var Ha=s(47310);function ka({uid:a}){const t=(0,j.xw)(a),n=W.TP.hasAccessToExplore();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(f.z9,{variant:"secondary",size:"sm",href:(0,Ha.h)(t),onClick:()=>{(0,U._i)("explore"),(0,U.M1)({grafana_version:xe.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},children:"Explore data"}),(0,e.jsx)(f.z9,{size:"sm",variant:"secondary",href:`dashboard/new-with-ds/${t.uid}`,onClick:()=>{(0,U._i)("build_a_dashboard"),(0,U.TR)({grafana_version:xe.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},children:"Build a dashboard"})]})}const Qa=a=>{const t=[],n=a.alertingSupported;return t.push({label:"Type",value:a.dataSourcePluginName}),t.push({label:"Alerting",value:(0,e.jsx)(Q.E,{color:n?"green":"red",text:n?"Supported":"Not supported"})}),t};function Ja({title:a}){const t=(0,D.of)(Xa);return(0,e.jsx)("div",{className:t.container,children:(0,e.jsx)("h1",{className:t.title,children:a})})}const Xa=a=>({container:(0,r.css)({marginBottom:a.spacing(2),h1:{display:"inline-block"}}),title:(0,r.css)({display:"inline-block",margin:"0 0 0 0",maxWidth:"40vw",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});function qa({uid:a,pageId:t}){const{navId:n,pageNav:o,dataSourceHeader:l}=ze(),u=Qa({dataSourcePluginName:o.dataSourcePluginName,alertingSupported:l.alertingSupported});return(0,e.jsx)(S.Y,{navId:n,pageNav:o,renderTitle:g=>(0,e.jsx)(Ja,{title:g}),info:u,actions:(0,e.jsx)(ka,{uid:a}),children:(0,e.jsx)(S.Y.Contents,{children:(0,e.jsx)(Ya,{uid:a,pageId:t})})})}const _a=qa;function es(){const{uid:a=""}=(0,c.g)(),t=(0,c.zy)(),o=new URLSearchParams(t.search).get("page");return(0,e.jsx)(_a,{uid:a,pageId:o})}var as=s(22560),Ge=s(79878),Ye=s(50278);function ss({filterByPluginType:a}){let t=(0,E.F9)(a);const{isLoading:n}=(0,E.m5)(),o=(0,D.of)(ns);return n||t.length===0?null:(0,e.jsxs)(ce.F,{title:"Unsigned plugins were found during plugin initialization. Grafana Labs cannot guarantee the integrity of these plugins. We recommend only using signed plugins.","data-testid":oe.Tp.pages.PluginsList.signatureErrorNotice,severity:"warning",children:[(0,e.jsx)("p",{children:"The following plugins are disabled and not shown in the list below:"}),(0,e.jsx)(Ge.B,{items:t,className:o.list,renderItem:l=>(0,e.jsx)("div",{className:o.wrapper,children:(0,e.jsxs)(N.B,{justifyContent:"flex-start",alignItems:"center",children:[(0,e.jsx)("strong",{children:l.pluginId}),(0,e.jsx)(Ye.B,{status:ts(l.errorCode),className:o.badge})]})})}),(0,e.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/plugins/plugin-signatures/",className:o.docsLink,target:"_blank",rel:"noreferrer",children:[(0,e.jsx)(le.I,{name:"book"})," Read more about plugin signing"]})]})}function ts(a){switch(a){case m.ZK.invalidSignature:return m.Ac.invalid;case m.ZK.missingSignature:return m.Ac.missing;case m.ZK.modifiedSignature:return m.Ac.modified;default:return m.Ac.missing}}function ns(a){return{list:(0,r.css)({listStyleType:"circle"}),wrapper:(0,r.css)({marginTop:a.spacing(1)}),badge:(0,r.css)({marginTop:0}),docsLink:(0,r.css)({display:"inline-block",color:a.colors.text.link,marginTop:a.spacing(2)})}}function os({onClick:a,dataSourcePlugin:t}){const n=t.module==="phantom",o=!n&&!t.unlicensed,l=t.info?.links?.length>0?t.info.links[0]:null,u=l?.target??"_blank",g=(0,D.of)(rs);return(0,e.jsxs)(C.Z,{className:(0,r.cx)(g.card,"card-parent"),onClick:o?a:()=>{},children:[(0,e.jsx)(C.Z.Heading,{className:g.heading,"aria-label":oe.Tp.pages.AddDataSource.dataSourcePluginsV2(t.name),children:t.name}),(0,e.jsx)(C.Z.Figure,{align:"center",className:g.figure,children:(0,e.jsx)("img",{className:g.logo,src:t.info.logos.small,alt:""})}),(0,e.jsx)(C.Z.Description,{className:g.description,children:t.info.description}),!n&&(0,e.jsx)(C.Z.Meta,{className:g.meta,children:(0,e.jsx)(Ye.B,{status:t.signature})}),(0,e.jsx)(C.Z.Actions,{className:g.actions,children:l&&(0,e.jsx)(f.z9,{"aria-label":`${t.name}, learn more.`,href:`${l.url}?utm_source=grafana_add_ds`,onClick:i=>i.stopPropagation(),rel:"noopener",target:u,variant:"secondary",children:l.name})})]})}function rs(a){return{heading:(0,r.css)({fontSize:a.v1.typography.heading.h5,fontWeight:"inherit"}),figure:(0,r.css)({width:"inherit",marginRight:"0px","> img":{width:a.spacing(7)}}),meta:(0,r.css)({marginTop:"6px",position:"relative"}),description:(0,r.css)({margin:"0px",fontSize:a.typography.size.sm}),actions:(0,r.css)({position:"relative",alignSelf:"center",marginTop:"0px",opacity:0,".card-parent:hover &, .card-parent:focus-within &":{opacity:1}}),card:(0,r.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,r.css)({marginRight:a.v1.spacing.lg,marginLeft:a.v1.spacing.sm,width:a.spacing(7),maxHeight:a.spacing(7)})}}function Ze({dataSourcePlugins:a,onClickDataSourceType:t}){return!a||!a.length?null:(0,e.jsx)(Ge.B,{items:a,getItemKey:n=>n.id.toString(),renderItem:n=>(0,e.jsx)(os,{dataSourcePlugin:n,onClick:()=>t(n)}),className:(0,r.css)({"> li":{marginBottom:"2px"}})})}function is({categories:a,onClickDataSourceType:t}){const n=`${p.b.AddNewConnection}?cat=data-source`,o=(0,D.of)(ls),l=(0,x.useCallback)(()=>{(0,se.rR)("connections_add_datasource_find_more_ds_plugins_clicked",{targetPath:n,path:location.pathname,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},[n]);return(0,e.jsxs)(e.Fragment,{children:[a.map(({id:u,title:g,plugins:i})=>(0,e.jsxs)("div",{className:o.category,children:[(0,e.jsx)("div",{className:o.header,id:u,children:g}),(0,e.jsx)(Ze,{dataSourcePlugins:i,onClickDataSourceType:t})]},u)),(0,e.jsx)("div",{className:o.more,children:(0,e.jsx)(f.z9,{variant:"secondary",href:n,onClick:l,target:"_self",rel:"noopener",children:"Find more data source plugins"})})]})}const ls=a=>({category:(0,r.css)({marginBottom:a.spacing(2)}),header:(0,r.css)({fontSize:a.typography.h5.fontSize,marginBottom:a.spacing(1)}),more:(0,r.css)({margin:a.spacing(4),textAlign:"center"})});function cs(){(0,j.hx)();const a=(0,h.useDispatch)(),t=(0,h.useSelector)(i=>(0,j.hp)(i.dataSources)),n=(0,h.useSelector)(i=>i.dataSources.dataSourceTypeSearchQuery),o=(0,h.useSelector)(i=>i.dataSources.isLoadingDataSourcePlugins),l=(0,h.useSelector)(i=>i.dataSources.categories),u=(0,j.Um)(),g=i=>a((0,j.eB)(i));return(0,e.jsx)(ds,{dataSources:t,dataSourceCategories:l,searchQuery:n,isLoading:o,onAddDataSource:u,onSetSearchQuery:g})}function ds({dataSources:a,dataSourceCategories:t,searchQuery:n,isLoading:o,onAddDataSource:l,onSetSearchQuery:u}){return o?(0,e.jsx)(Ae.A,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(as.Z,{value:n,onChange:u,placeholder:"Filter by name or type"}),(0,e.jsx)("div",{className:"page-action-bar__spacer"}),(0,e.jsx)(f.z9,{href:p.b.DataSources,fill:"outline",variant:"secondary",icon:"arrow-left",children:"Cancel"})]}),!n&&(0,e.jsx)(ss,{filterByPluginType:m.QE.datasource}),(0,e.jsxs)("div",{children:[n&&(0,e.jsx)(Ze,{dataSourcePlugins:a,onClickDataSourceType:l}),!n&&(0,e.jsx)(is,{categories:t,onClickDataSourceType:l})]})]})}function us(){return(0,e.jsx)(S.Y,{navId:"connections-datasources",pageNav:{text:"Add data source",subTitle:"Choose a data source type",active:!0},children:(0,e.jsx)(S.Y.Contents,{children:(0,e.jsx)(cs,{})})})}function gs(){const{search:a}=(0,c.zy)();return(0,e.jsx)(c.C5,{replace:!0,to:{pathname:p.b.AddNewConnection,search:a}})}function hs(){const t=!!(0,h.useSelector)(n=>n.navIndex)["standalone-plugin-page-/connections/add-new-connection"];return(0,e.jsxs)(c.BV,{children:[(0,e.jsx)(c.qh,{caseSensitive:!0,path:"/",element:(0,e.jsx)(c.C5,{replace:!0,to:p.b.AddNewConnection})}),(0,e.jsx)(c.qh,{caseSensitive:!0,path:p.b.DataSources.replace(p.b.Base,""),element:(0,e.jsx)(da,{})}),(0,e.jsx)(c.qh,{caseSensitive:!0,path:p.b.DataSourcesNew.replace(p.b.Base,""),element:(0,e.jsx)(us,{})}),(0,e.jsx)(c.qh,{caseSensitive:!0,path:p.b.DataSourcesDetails.replace(p.b.Base,""),element:(0,e.jsx)(ea,{})}),(0,e.jsx)(c.qh,{caseSensitive:!0,path:p.b.DataSourcesEdit.replace(p.b.Base,""),element:(0,e.jsx)(es,{})}),(0,e.jsx)(c.qh,{caseSensitive:!0,path:p.b.DataSourcesDashboards.replace(p.b.Base,""),element:(0,e.jsx)(ma,{})}),!t&&(0,e.jsx)(c.qh,{caseSensitive:!0,path:p.b.AddNewConnection.replace(p.b.Base,""),element:(0,e.jsx)(qe,{})}),(0,e.jsx)(c.qh,{path:p.b.ConnectDataOutdated.replace(p.b.Base,""),element:(0,e.jsx)(gs,{})}),(0,e.jsx)(c.qh,{path:"/your-connections/:page",element:(0,e.jsx)(c.C5,{replace:!0,to:`${p.b.Base}/:page`})}),(0,e.jsx)(c.qh,{path:p.b.YourConnectionsOutdated.replace(p.b.Base,""),element:(0,e.jsx)(c.C5,{replace:!0,to:p.b.DataSources})}),(0,e.jsx)(c.qh,{element:(0,e.jsx)(c.C5,{replace:!0,to:"/notfound"})})]})}},64555:(ne,M,s)=>{s.d(M,{Bz:()=>Y,Q9:()=>se,Ss:()=>he,TA:()=>D,lC:()=>ie});var e=s(28082),c=s(23737),h=s(17687),p=s(15543),x=s(10474),m=s(14297),S=s(89880),y=s(34547),O=s(20138),E=s(16910),r=s(80757),ae=s(86983);function se(B,R){return async q=>{await(0,e.AI)().post("/api/dashboards/import",B),q((0,c.dx)((0,h.tZ)("Dashboard Imported",R))),q((0,y.h9)())}}function D(B){return async R=>{await(0,p.n)().deleteDashboard(B,!1),R((0,y.h9)())}}const Y=()=>(B,R)=>{const W=R().dashboard.getModel();W&&(W.destroy(),B((0,O.Y7)(W.uid))),(0,r.jG)().stopAutoRefresh(),B((0,ae.p0)()),B((0,m.rG)()),x.t.leave(),(0,E.UA)().setCurrent(void 0)},ie=B=>R=>{R((0,S.Cj)(B)),(0,r.jG)().refreshTimeModel()},he=B=>R=>{R((0,S.xu)(B)),(0,r.jG)().refreshTimeModel()}},93078:(ne,M,s)=>{s.d(M,{E:()=>m});var e=s(74848),c=s(56276),h=s(9968),p=s(54731),x=s(11817);const m=()=>(0,e.jsxs)("div",{children:[(0,e.jsx)(h.$,{v:2}),(0,e.jsx)(p.Y,{href:"https://github.com/grafana/grafana/issues/new?assignees=&labels=area%2Fdatasource%2Ctype%2Fnew-plugin-request&projects=&template=3-data_source_request.yaml&title=%5BNew+Data+Source%5D%3A+%3Cname-of-service%3E",onClick:()=>(0,c.rR)("connections_data_source_request_clicked"),external:!0,children:(0,e.jsx)(x.x6,{i18nKey:"connections.connect-data.request-data-source",children:"Request a new data source"})}),(0,e.jsx)("br",{}),(0,e.jsx)(p.Y,{href:"https://github.com/orgs/grafana/projects/619/views/1?pane=info",onClick:()=>(0,c.rR)("connections_data_source_roadmap_clicked"),external:!0,children:(0,e.jsx)(x.x6,{i18nKey:"connections.connect-data.roadmap",children:"View roadmap"})})]})},67097:(ne,M,s)=>{s.d(M,{L:()=>m});var e=s(74848),c=s(96540),h=s(40996),p=s(22560);const x=(S,y=0,O=[])=>{const E=(0,c.useRef)(!0),r=[...O,E];return(0,h.A)(()=>{if(E.current){E.current=!1;return}return S()},y,r)},m=({value:S,onSearch:y})=>{const[O,E]=(0,c.useState)(S);return x(()=>y(O??""),500,[O]),(0,e.jsx)(p.Z,{value:O,onKeyDown:r=>{(r.key==="Enter"||r.keyCode===13)&&y(r.currentTarget.value)},placeholder:"Search Grafana plugins",onChange:r=>{E(r)},width:46})}},27033:(ne,M,s)=>{s.d(M,{A:()=>x});var e=s(74848),c=s(54594),h=s(11817);const x=({disabled:m,onUpdateAll:S,updatablePluginsLength:y})=>(0,e.jsx)(c.$n,{disabled:m,onClick:S,children:m?(0,e.jsx)(h.x6,{i18nKey:"plugins.catalog.no-updates-available",children:"No updates available"}):(0,e.jsxs)(h.x6,{i18nKey:"plugins.catalog.update-all.button",values:{length:y},children:["Update all (",{length},")"]})})},40099:(ne,M,s)=>{s.d(M,{U:()=>R,A:()=>Ce});var e=s(74848),c=s(96540),h=s(56276),p=s(32370),x=s(65164),m=s(11817),S=s(11241),y=s(22803),O=s(29675),E=s(6736),r=s(79784),ae=s(20968),se=s(59830),D=s(81942);const Y=d=>({table:(0,y.css)({marginTop:d.spacing(2),width:"100%",borderCollapse:"collapse"}),tableRow:(0,y.css)({borderBottom:`1px solid ${d.colors.border.weak}`,td:{paddingRight:d.spacing(1)}}),icon:(0,y.css)({display:"flex",justifyContent:"center",alignItems:"center"}),header:(0,y.css)({textAlign:"left",padding:d.spacing(1),borderBottom:`2px solid ${d.colors.border.strong}`,th:{paddingRight:d.spacing(1)}}),data:(0,y.css)({padding:"10px"}),footer:(0,y.css)({fontSize:d.typography.bodySmall.fontSize,marginTop:d.spacing(3)}),noPluginsMessage:(0,y.css)({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}),tableContainer:(0,y.css)({overflowY:"auto",overflowX:"hidden",maxHeight:d.spacing(41),marginBottom:d.spacing(2)}),errorIcon:(0,y.css)({color:d.colors.error.main}),successIcon:(0,y.css)({color:d.colors.success.main}),pluginsInstalled:(0,y.css)({svg:{marginRight:d.spacing(1)}})}),ie=({id:d,inProgress:L,isSelected:$,isInstalled:b,errorMap:k})=>{const I=(0,O.of)(Y);return k&&k.has(d)?(0,e.jsx)(E.m,{content:`${(0,m.t)("plugins.catalog.update-all.error","Error updating plugin:")} ${k.get(d)?.message}`,children:(0,e.jsx)(r.I,{className:I.errorIcon,size:"xl",name:"exclamation-triangle"})}):b?(0,e.jsx)(r.I,{className:I.successIcon,size:"xl",name:"check"}):L&&$?(0,e.jsx)(ae.y,{}):""},he=({plugins:d,pluginsNotInstalled:L,inProgress:$,selectedPlugins:b,onCheckboxChange:k,errorMap:I})=>{const A=(0,O.of)(Y),Q=d.length-L.size,F=d.length!==L.size&&!$;return(0,e.jsx)("div",{children:d.length===0?(0,e.jsx)(se.p,{variant:"completed",message:(0,m.t)("plugins.catalog.update-all.all-plugins-updated","All plugins updated!")}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.header",children:"The following plugins have update available"})}),(0,e.jsx)("div",{className:A.tableContainer,children:(0,e.jsxs)("table",{className:A.table,children:[(0,e.jsx)("thead",{className:A.header,children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.update-header",children:"Update"})}),(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.name-header",children:"Name"})}),(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.installed-header",children:"Installed"})}),(0,e.jsx)("th",{children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.available-header",children:"Available"})}),(0,e.jsx)("th",{})]})}),(0,e.jsx)("tbody",{children:d.map(({id:C,name:N,installedVersion:w,latestVersion:te})=>(0,e.jsxs)("tr",{className:A.tableRow,children:[(0,e.jsx)("td",{children:(0,e.jsx)(D.S,{onChange:()=>k(C),value:b?.has(C),disabled:!L.has(C)})}),(0,e.jsx)("td",{children:N}),(0,e.jsx)("td",{children:w}),(0,e.jsx)("td",{children:te}),(0,e.jsx)("td",{className:A.icon,children:(0,e.jsx)(ie,{id:C,inProgress:$,isSelected:b?.has(C)??!1,isInstalled:!L.has(C),errorMap:I})})]},C))})]})}),Q>0&&F&&(0,e.jsxs)("div",{className:A.pluginsInstalled,children:[(0,e.jsx)(r.I,{className:A.successIcon,size:"lg",name:"check"}),`${Q} ${(0,m.t)("plugins.catalog.update-all.update-status-text","plugins updated")}`]}),I.size>0&&F&&(0,e.jsxs)("div",{className:A.pluginsInstalled,children:[(0,e.jsx)(r.I,{className:A.errorIcon,size:"lg",name:"exclamation-triangle"}),`${I.size} ${(0,m.t)("plugins.catalog.update-all.error-status-text","failed - see error messages")}`]}),p.$.pluginAdminExternalManageEnabled&&(0,e.jsx)("footer",{className:A.footer,children:(0,e.jsx)(m.x6,{i18nKey:"plugins.catalog.update-all.cloud-update-message",children:"* It may take a few minutes for the plugins to be available for usage."})})]})})},B="plugins_update_all_clicked",R=({isOpen:d,onDismiss:L,isLoading:$,plugins:b})=>{const k=(0,S.xX)(),{error:I}=(0,S.XN)(),[A,Q]=(0,c.useState)(new Map),[F,C]=(0,c.useState)(!1),[N,w]=(0,c.useState)(),te=(0,c.useRef)(b),pe=(0,c.useMemo)(()=>new Set(b.map(v=>v.id)),[b]),me=b.length;(0,c.useEffect)(()=>{te.current.length===0&&(te.current=[...b])},[b]),(0,c.useEffect)(()=>{F&&(N?.forEach(v=>{pe.has(v)||w(f=>{const V=new Set(f);return V.delete(v),V})}),N?.size===0&&C(!1))},[F,pe,N]),(0,c.useEffect)(()=>{if(N===void 0&&b.length>0&&!$){const v=new Set(b.map(f=>f.id));w(v)}},[$,b,N]),(0,c.useEffect)(()=>{F&&I&&!A.has(I.id)&&N?.has(I.id)&&(Q(v=>{const f=new Map(v);return f.set(I.id,I),f}),w(v=>{const f=new Set(v);return f.delete(I.id),f}))},[I,A,F,N]);const Ee=async()=>{if(!F)if((0,h.rR)(B,{path:location.pathname,count:N?.size,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}),C(!0),p.$.pluginAdminExternalManageEnabled)for(let v of b)N?.has(v.id)&&await k(v.id,v.latestVersion,!0);else b.forEach(v=>{N?.has(v.id)&&k(v.id,v.latestVersion,!0)})},le=()=>{te.current=[],Q(new Map),C(!1),w(void 0),L()},Pe=v=>{w(f=>{const V=new Set(f);return V.has(v)?V.delete(v):V.add(v),V}),A.has(v)&&Q(f=>{const V=new Map(f);return V.delete(v),V})},je=N?.size||0;return(0,e.jsx)(x.u,{isOpen:d,title:(0,m.t)("plugins.catalog.update-all.modal-title","Update Plugins"),body:(0,e.jsx)(he,{plugins:te.current,pluginsNotInstalled:pe,inProgress:F,errorMap:A,onCheckboxChange:Pe,selectedPlugins:N}),onConfirm:me>0?Ee:le,onDismiss:le,disabled:W(F,me,je),confirmText:q(me,F,je),confirmButtonVariant:"primary"})};function q(d,L,$){return L?(0,m.t)("plugins.catalog.update-all.modal-in-progress","Updating..."):d>0?(0,m.t)("plugins.catalog.update-all.modal-confirmation","Update")+` (${$})`:(0,m.t)("plugins.catalog.update-all.modal-dismiss","Close")}function W(d,L,$){return!!(d||L>0&&$===0)}const Ce=R},36871:(ne,M,s)=>{s.d(M,{W:()=>c});var e=s(53027);const c=()=>({push:({query:h})=>{e.Ny.partial(h)}})}}]);

//# sourceMappingURL=Connections.1ca3742b02e958e90897.js.map