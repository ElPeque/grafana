"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3525],{24520:(Z,w,o)=>{o.d(w,{X:()=>G,k:()=>e});var m=o(47286),D=o(52718),B=o(63739),A=o(84099),W=o(28082),L=o(87638),M=o(65874),l=o(35874);const e=(g,v,p,f,t,s)=>!t||t.length===0?[]:t.map(c=>{const d=(0,m.vd)(g,v,p),r={...p,__dataContext:d},y=(j,O,P)=>f(j,{...r,...O},P);s.valueRowIndex!==void 0&&!isNaN(s.valueRowIndex)?d.value.rowIndex=s.valueRowIndex:d.value.calculatedValue=s.calculatedValue;const T=f(c.title,r),u=f(c.confirmation||`Are you sure you want to ${c.title}?`,r);return{title:T,confirmation:u,onClick:(j,O)=>{R(c,y)},oneClick:c.oneClick??!1}}).filter(c=>!!c),R=(g,v)=>{try{const p=new URL(K(v(g.fetch.url))),f={};let t={url:p.toString(),method:g.fetch.method,data:U(g,v),headers:f};g.fetch.headers&&g.fetch.headers.forEach(([s,i])=>{f[v(s)]=v(i)}),g.fetch.queryParams&&(g.fetch.queryParams?.forEach(([s,i])=>{p.searchParams.append(v(s),v(i))}),t.url=p.toString()),f["X-Grafana-Action"]="1",t.headers=f,(0,W.AI)().fetch(t).subscribe({error:s=>{L.lE.emit(D.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(s)},complete:()=>{L.lE.emit(D.r1.alertSuccess,["API call was successful"])}})}catch(p){L.lE.emit(D.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(p);return}},G=(g=[],v=[])=>({name:"Default field",type:B.PU.string,config:{links:g,actions:v},values:[]}),K=g=>{if(g.startsWith("/")){const p=A.sQ.sanitizeUrl(g);g=(0,l.z)(p,[])}return g},U=(g,v)=>{let p=g.fetch.body?v(g.fetch.body):"{}";return g.fetch.method===M.DO.GET&&(p=void 0),p}},65874:(Z,w,o)=>{o.d(w,{DO:()=>A,en:()=>m,gR:()=>D,xp:()=>B});var m=(e=>(e.Center="center",e.Left="left",e.LeftRight="leftright",e.Right="right",e.Scale="scale",e))(m||{}),D=(e=>(e.Bottom="bottom",e.Center="center",e.Scale="scale",e.Top="top",e.TopBottom="topbottom",e))(D||{}),B=(e=>(e.Contain="contain",e.Cover="cover",e.Fill="fill",e.Original="original",e.Tile="tile",e))(B||{}),A=(e=>(e.GET="GET",e.POST="POST",e.PUT="PUT",e))(A||{}),W=(e=>(e.Straight="straight",e))(W||{});const L={vertices:[]},M={connections:[]},l={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0}},88464:(Z,w,o)=>{o.d(w,{L:()=>g});var m=o(74848),D=o(22803),B=o(74958),A=o(23570),W=o(38075),L=o(350),M=o(32370),l=o(29675),e=o(90415),R=o(32991),G=o(44826),K=o(24520),U=o(50959);function g(d){const{data:r,height:y,width:T,options:u,fieldConfig:S,id:j,timeRange:O,replaceVariables:P}=d,H=(0,l.$j)(),X=(0,e.d2)(),V=(0,U.gy)(r.series)?(0,U.S5)(r.series):r.series,J=V?.length,ee=V.some(I=>I.fields.length>0),Y=v(V,u),te=V[Y];let k=y;if(!J||!ee)return(0,m.jsx)(L.a,{panelId:j,fieldConfig:S,data:r});if(J>1){const I=H.spacing.gridSize*H.components.height.md,z=H.spacing.gridSize;k=y-I-z}const oe=X.sync&&X.sync()!==B.y.Off,Q=(0,m.jsx)(R.X,{height:k,width:T,data:te,noHeader:!u.showHeader,showTypeIcons:u.showTypeIcons,resizable:!0,initialSortBy:u.sortBy,onSortByChange:I=>f(I,d),onColumnResize:(I,z)=>p(I,z,d),onCellFilterAdded:X.onAddAdHocFilter,footerOptions:u.footer,enablePagination:u.footer?.enablePagination,cellHeight:u.cellHeight,timeRange:O,enableSharedCrosshair:M.$.featureToggles.tableSharedCrosshair&&oe,fieldConfig:S,getActions:i,replaceVariables:P});if(J===1)return Q;const $=V.map((I,z)=>({label:(0,A.Ri)(I),value:z}));return(0,m.jsxs)("div",{className:c.wrapper,children:[Q,(0,m.jsx)("div",{className:c.selectWrapper,children:(0,m.jsx)(G.l6,{options:$,value:$[Y],onChange:I=>t(I,d)})})]})}function v(d,r){return r.frameIndex>0&&r.frameIndex<d.length?r.frameIndex:0}function p(d,r,y){const{fieldConfig:T}=y,{overrides:u}=T,S=W.Ct.byName,j="custom.width",O=u.find(P=>P.matcher.id===S&&P.matcher.options===d);if(O){const P=O.properties.find(H=>H.id===j);P?P.value=r:O.properties.push({id:j,value:r})}else u.push({matcher:{id:S,options:d},properties:[{id:j,value:r}]});y.onFieldConfigChange({...T,overrides:u})}function f(d,r){r.onOptionsChange({...r.options,sortBy:d})}function t(d,r){r.onOptionsChange({...r.options,frameIndex:d.value||0})}const s=d=>d,i=(d,r,y,T)=>{if(!M.$.featureToggles?.vizActions)return[];const u=[],S=new Set;return(0,K.k)(d,r,r.state.scopedVars,T??s,r.config.actions??[],{valueRowIndex:y}).forEach(O=>{const P=`${O.title}`;S.has(P)||(u.push(O),S.add(P))}),u},c={wrapper:(0,D.css)({display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}),selectWrapper:(0,D.css)({padding:"8px 8px 0px 8px"})}},50959:(Z,w,o)=>{o.d(w,{S5:()=>p,fq:()=>L,gy:()=>f,l1:()=>g});var m=o(2543),D=o.n(m),B=o(38075),A=o(99116),W=o(63739);const L=t=>(!t.pluginVersion&&"columns"in t&&console.log("Was angular table",t),t.options),M={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},l={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},e={cell:"color-background",row:"color-background",value:"color-text"},R=(t,s)=>[-1/0,...t].map((i,c)=>({color:s[c],value:(0,m.isNumber)(i)?i:parseInt(i,10)})),G=(t,s)=>{const i=t.transformations??[];if(Object.keys(M).includes(s.transform)){const c={reducers:[]};s.transform==="timeseries_aggregations"&&(c.includeTimeField=!1,c.reducers=s.columns.map(d=>l[d.value])),i.push({id:M[s.transform],options:c})}return i},K=t=>{const i={matcher:{id:/^\/.*\/$/.test(t.pattern)?B.Ct.byRegexp:B.Ct.byName,options:t.pattern},properties:[]};return t.alias&&i.properties.push({id:"displayName",value:t.alias}),t.unit&&i.properties.push({id:"unit",value:t.unit}),t.decimals&&i.properties.push({id:"decimals",value:t.decimals}),t.type==="date"&&i.properties.push({id:"unit",value:`time: ${t.dateFormat}`}),t.type==="hidden"&&i.properties.push({id:"custom.hidden",value:!0}),t.link&&i.properties.push({id:"links",value:[{title:(0,m.defaultTo)(t.linkTooltip,""),url:(0,m.defaultTo)(t.linkUrl,""),targetBlank:(0,m.defaultTo)(t.linkTargetBlank,!1)}]}),t.colorMode&&i.properties.push({id:"custom.cellOptions",value:{type:e[t.colorMode]}}),t.align&&i.properties.push({id:"custom.align",value:t.align==="auto"?null:t.align}),t.thresholds?.length&&i.properties.push({id:"thresholds",value:{mode:A.O.Absolute,steps:R(t.thresholds,t.colors)}}),i},U=t=>{let s={custom:{}};if(t){if(s=(0,m.omitBy)({unit:t.unit,decimals:t.decimals,displayName:t.alias,custom:{align:t.align==="auto"?null:t.align}},m.isNil),t.thresholds.length){const i={mode:A.O.Absolute,steps:R(t.thresholds,t.colors)};s.thresholds=i}t.colorMode&&(s.custom.cellOptions={type:e[t.colorMode]})}return s},g=(t,s,i)=>{if(s==="table-old"&&i.angular){const c=i.angular,d=G(t,c),r=c.styles.find(u=>u.pattern==="/.*/"),y=U(r),T=c.styles.filter(u=>u.pattern!=="/.*/").map(K);t.transformations=d,t.fieldConfig={defaults:y,overrides:T}}return{}},v=t=>t?.filter(s=>s.meta?.custom?.parentRowIndex===void 0)||[t?.[0]],p=t=>{const s=[];return v(t).filter(c=>!!c&&c.length!==0)?.forEach(c=>{const d=t?.filter(u=>c.refId===u.refId&&u.meta?.custom?.parentRowIndex!==void 0),r=(0,m.groupBy)(d,u=>u.meta?.custom?.parentRowIndex),y=Object.keys(r).map(u=>r[u]),T={...c};d&&d.length>0&&T.fields.push({name:"nested",type:W.PU.nestedFrames,config:{},values:y}),s.push(T)}),s},f=t=>t?.some(s=>s.meta?.custom?.parentRowIndex!==void 0)},25807:(Z,w,o)=>{o.r(w),o.d(w,{plugin:()=>ie});var m=o(68256),D=o(49448),B=o(79488),A=o(91357),W=o(63739),L=o(23570),M=o(67553),l=o(7500),e=o(74848),R=o(29010);function G({onChange:a,value:n,context:h}){const E=C=>{C?.currentTarget.checked&&(h.options.footer.show=!1),a(C?.currentTarget.checked)};return(0,e.jsx)(R.d,{value:!!n,onChange:E})}var K=o(22803),U=o(2543),g=o(96540),v=o(32370),p=o(29675),f=o(86489),t=o(44826),s=o(40271),i=o(66384);const c=({cellOptions:a,onChange:n})=>{const h=()=>{a.wrapText=!a.wrapText,n(a)},E=(0,e.jsxs)(s.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,e.jsx)(i.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(f.D,{label:E,children:(0,e.jsx)(R.d,{value:a.wrapText,onChange:h})})})};var d=o(48583),r=o(60641);function y({cellOptions:a,onChange:n}){const h=C=>{a.mode=C,n(a)},E=C=>{a.valueDisplayMode=C,n(a)};return(0,e.jsxs)(d.B,{direction:"column",gap:0,children:[(0,e.jsx)(f.D,{label:"Gauge display mode",children:(0,e.jsx)(r.z,{value:a?.mode??l.eX.Gradient,onChange:h,options:T})}),(0,e.jsx)(f.D,{label:"Value display",children:(0,e.jsx)(r.z,{value:a?.valueDisplayMode??l.$l.Text,onChange:E,options:u})})]})}const T=[{value:l.eX.Basic,label:"Basic"},{value:l.eX.Gradient,label:"Gradient"},{value:l.eX.Lcd,label:"Retro LCD"}],u=[{value:l.$l.Color,label:"Value color"},{value:l.$l.Text,label:"Text color"},{value:l.$l.Hidden,label:"Hidden"}],S=[{value:l.Wq.Basic,label:"Basic"},{value:l.Wq.Gradient,label:"Gradient"}],j=({cellOptions:a,onChange:n})=>{const h=x=>{a.mode=x,n(a)},E=()=>{a.applyToRow=!a.applyToRow,n(a)},C=()=>{a.wrapText=!a.wrapText,n(a)},b=(0,e.jsxs)(s.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,e.jsx)(i.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.D,{label:"Background display mode",children:(0,e.jsx)(r.z,{value:a?.mode??l.Wq.Gradient,onChange:h,options:S})}),(0,e.jsx)(f.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,e.jsx)(R.d,{value:a.applyToRow,onChange:E})}),(0,e.jsx)(f.D,{label:b,children:(0,e.jsx)(R.d,{value:a.wrapText,onChange:C})})]})};var O=o(34128);const P=({cellOptions:a,onChange:n})=>{const h=C=>{a.alt=C.currentTarget.value,n(a)},E=C=>{a.title=C.currentTarget.value,n(a)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,e.jsx)(O.p,{onChange:h,defaultValue:a.alt})}),(0,e.jsx)(f.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,e.jsx)(O.p,{onChange:E,defaultValue:a.title})})]})};var H=o(76346),X=o(19550),V=o(97225),J=o(38928);const ee=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function Y(a){const n=(0,J.V)(a);return{...n,useCustomConfig:h=>{n.useCustomConfig?.(h),h.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const te=a=>{const{cellOptions:n,onChange:h}=a,E=(0,g.useMemo)(()=>{const x=Y(V.t);return(0,H.O)(x,"ChartCell")},[]),C=(0,p.of)(oe),b={...V.t,...n};return(0,e.jsx)(X.gW,{children:E.list(ee.map(x=>`custom.${x}`)).map(x=>{if(x.showIf&&!x.showIf(b))return null;const ae=x.editor,F=x.path;return(0,e.jsx)(f.D,{label:x.name,className:C.field,children:(0,e.jsx)(ae,{onChange:N=>h({...n,[F]:N}),value:(k(F,b)?b[F]:void 0)??x.defaultValue,item:x,context:{data:[]}})},x.id)})})};function k(a,n){return a in n}const oe=()=>({field:(0,K.css)({width:"100%","[title='Use color scheme to define gradient']":{display:"none"}})}),Q=({value:a,onChange:n})=>{const h=a.type,E=(0,p.of)(I),C=$.find(N=>N.value.type===h);let[b,x]=(0,g.useState)({});const ae=N=>{N.value!==void 0&&(a=N.value,b[a.type]!==void 0&&Object.keys(b[a.type]).length>1&&(a=(0,U.merge)(a,b[a.type])),n(a))},F=N=>{b[a.type]=(0,U.merge)(a,N),x(b),n(b[a.type])};return(0,e.jsxs)("div",{className:E.fixBottomMargin,children:[(0,e.jsx)(f.D,{children:(0,e.jsx)(t.l6,{options:$,value:C,onChange:ae})}),(h===l.ob.Auto||h===l.ob.ColorText)&&(0,e.jsx)(c,{cellOptions:a,onChange:F}),h===l.ob.Gauge&&(0,e.jsx)(y,{cellOptions:a,onChange:F}),h===l.ob.ColorBackground&&(0,e.jsx)(j,{cellOptions:a,onChange:F}),h===l.ob.Sparkline&&(0,e.jsx)(te,{cellOptions:a,onChange:F}),h===l.ob.Image&&(0,e.jsx)(P,{cellOptions:a,onChange:F})]})};let $=[{value:{type:l.ob.Auto},label:"Auto"},{value:{type:l.ob.Sparkline},label:"Sparkline"},{value:{type:l.ob.ColorText},label:"Colored text"},{value:{type:l.ob.ColorBackground},label:"Colored background"},{value:{type:l.ob.Gauge},label:"Gauge"},{value:{type:l.ob.DataLinks},label:"Data links"},{value:{type:l.ob.JSONView},label:"JSON View"},{value:{type:l.ob.Image},label:"Image"}];v.$.featureToggles.vizActions&&($=[...$,{value:{type:l.ob.Actions},label:"Actions"}]);const I=a=>({fixBottomMargin:(0,K.css)({marginBottom:a.spacing(-2)})});var z=o(88464),ne=o(50959);const _={cellHeight:l.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};var se=o(18550);class re{getSuggestionsForData(n){const h=n.getListAppender({name:se.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:E=>{E.fieldConfig.defaults.custom.minWidth=50}}});n.dataSummary.fieldCount===0?h.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):h.append({})}}const q="Table footer",le=["Cell options"],ie=new m.m(z.L).setPanelChangeHandler(ne.l1).setMigrationHandler(ne.fq).useFieldConfig({useCustomConfig:a=>{a.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:M.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:M.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:M.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:Q,override:Q,defaultValue:M.gB.cellOptions,process:D.hS,category:le,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:le,showIf:n=>n.cellOptions.type===l.ob.Auto||n.cellOptions.type===l.ob.JSONView||n.cellOptions.type===l.ob.ColorText||n.cellOptions.type===l.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:M.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(a=>{a.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:_.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:_.cellHeight,settings:{options:[{value:l.qM.Sm,label:"Small"},{value:l.qM.Md,label:"Medium"},{value:l.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[q],name:"Show table footer",defaultValue:_.footer?.show}).addCustomEditor({id:"footer.reducer",category:[q],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:B.D.get("stats-picker").editor,defaultValue:[A.gy.sum],showIf:n=>n.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[q],name:"Count rows",description:"Display a single count for all data rows",defaultValue:_.footer?.countRows,showIf:n=>n.footer?.reducer?.length===1&&n.footer?.reducer[0]===A.gy.count}).addMultiSelect({path:"footer.fields",category:[q],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async n=>{const h=[];if(n&&n.data&&n.data.length>0){const E=n.data[0];for(const C of E.fields)if(C.type===W.PU.number){const b=(0,L.Ct)(C,E,n.data),x=C.name;h.push({value:x,label:b})}}return h}},defaultValue:"",showIf:n=>n.footer?.show&&!n.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:G})}).setSuggestionsSupplier(new re)}}]);

//# sourceMappingURL=tablePanel.24b1616228162840cc54.js.map