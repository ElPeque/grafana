"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3704],{68880:(bt,H,c)=>{c.r(H),c.d(H,{default:()=>pt});var e=c(74848),N=c(32370),L=c(37e3),R=c(54731),ie=c(54122),t=c(11817),I=c(90231),f=c(48583),l=c(45565);const C=({children:o,title:n,linkHref:r,linkTitle:s})=>(0,e.jsxs)(f.B,{gap:2,direction:"column",children:[(0,e.jsx)(l.E,{element:"h4",children:n}),(0,e.jsx)(l.E,{color:"secondary",children:o}),r&&(0,e.jsx)(R.Y,{href:r,external:!0,children:s??r})]}),le=()=>(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.migrate-to-this-stack.title","Let us help you migrate to this stack"),children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.migrate-to-this-stack.body",children:"You can migrate some resources from your self-managed Grafana installation to this cloud stack. To do this securely, you'll need to generate a migration token. Your self-managed instance will use the token to authenticate with this cloud stack."})});var P=c(22803),G=c(29675);const ce=()=>{const o=(0,G.of)(de);return(0,e.jsxs)(I.a,{alignItems:"flex-start",display:"flex",direction:"column",gap:2,children:[(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.get-started.title","Performing a migration"),linkTitle:(0,t.t)("migrate-to-cloud.get-started.link-title","Learn more about Private Data Source Connect"),linkHref:"https://grafana.com/docs/grafana-cloud/connect-externally-hosted/private-data-source-connect",children:(0,e.jsxs)(f.B,{direction:"column",gap:2,children:[(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.get-started.body",children:"The migration process must be started from your self-managed Grafana instance."}),(0,e.jsxs)("ol",{className:o.list,children:[(0,e.jsx)("li",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-1",children:"Log in to your self-managed instance and navigate to Administration, General, Migrate to Grafana Cloud."})}),(0,e.jsx)("li",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-2",children:'Select "Migrate this instance to Cloud".'})}),(0,e.jsx)("li",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-3",children:"You'll be prompted for a migration token. Generate one from this screen."})}),(0,e.jsx)("li",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-4",children:'In your self-managed instance, select "Upload everything" to upload data sources and dashboards to this cloud stack.'})}),(0,e.jsx)("li",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.get-started.step-5",children:"If some of your data sources will not work over the public internet, you\u2019ll need to install Private Data Source Connect in your self-managed environment."})})]})]})}),(0,e.jsx)(R.Y,{href:"/connections/private-data-source-connections",children:(0,t.t)("migrate-to-cloud.get-started.configure-pdc-link","Configure PDC for this stack")}),(0,e.jsx)(R.Y,{href:"/a/grafana-selfservetutorials-app/migrate-oss",children:(0,t.t)("migrate-to-cloud.migrate-to-this-stack.link-title","View the full migration guide")})]})},de=o=>({list:(0,P.css)({padding:"revert"})});var m=c(96540),M=c(56276),p=c(54594),j=c(5989),$=c(28082);function z(o){if(!(0,$.NF)(o)||typeof o.data!="object"||!o.data)return null;const n=o?.data,r="message"in n&&typeof n.message=="string"?n.message:null,s="messageId"in n&&typeof n.messageId=="string"?n.messageId:null,a="statusCode"in n&&typeof n.statusCode=="number"?n.statusCode:null;return!r||!s||!a?null:{message:r,messageId:s,statusCode:a}}function W(){return(0,e.jsx)(L.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.migration-token.error-title","Something went wrong"),children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.migration-token.error-body",children:"Unable to generate a migration token. Please try again later."})})}var D=c(25356),V=c(93604),X=c(86489),Z=c(34128);const ue=({isOpen:o,hideModal:n,migrationToken:r})=>(0,e.jsxs)(D.a,{isOpen:o,title:(0,t.t)("migrate-to-cloud.migration-token.modal-title","Migration token created"),onDismiss:n,children:[r?(0,e.jsx)(ge,{migrationToken:r}):(0,e.jsx)(W,{}),(0,e.jsxs)(D.a.ButtonRow,{children:[(0,e.jsx)(p.$n,{variant:"secondary",onClick:n,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.migration-token.modal-close",children:"Close"})}),r&&(0,e.jsx)(V.b,{variant:"primary",getText:()=>r,onClipboardCopy:n,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.migration-token.modal-copy-and-close",children:"Copy to clipboard and close"})})]})]});function ge({migrationToken:o}){const n=(0,m.useId)();return(0,e.jsx)(X.D,{description:(0,t.t)("migrate-to-cloud.migration-token.modal-field-description","Copy the token now as you will not be able to see it again. Losing a token requires creating a new one."),htmlFor:n,label:(0,t.t)("migrate-to-cloud.migration-token.modal-field-label","Token"),children:(0,e.jsxs)(f.B,{children:[(0,e.jsx)(Z.p,{id:n,value:o,readOnly:!0}),(0,e.jsx)(V.b,{icon:"clipboard-alt",getText:()=>o,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.migration-token.modal-copy-button",children:"Copy to clipboard"})})]})})}var J=c(65164);function me(o){const{isOpen:n,hasError:r,onConfirm:s,onDismiss:a}=o,i=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.delete-migration-token-confirm.body",children:"If you've already used this token with a self-managed installation, that installation will no longer be able to upload content."})}),r&&(0,e.jsx)(L.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.delete-migration-token-confirm.error-title","Error deleting token")})]});return(0,e.jsx)(J.u,{isOpen:n,title:(0,t.t)("migrate-to-cloud.delete-migration-token-confirm.title","Delete migration token"),body:i,confirmText:(0,t.t)("migrate-to-cloud.delete-migration-token-confirm.confirm-button","Delete token"),onConfirm:s,onDismiss:a})}var U=c(70255);const he=({hasToken:o,errorMessageId:n,isFetching:r})=>r?(0,e.jsx)(U.A,{width:100}):o?(0,e.jsx)(l.E,{color:"success",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.token-status.active",children:"Token created and active"})}):n==="cloudmigrations.tokenNotFound"?(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.token-status.no-active",children:"No active token"}):n?(0,e.jsx)(l.E,{color:"error",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.token-status.unknown-error",children:"Error retrieving token"})}):(0,e.jsx)(l.E,{color:"warning",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.token-status.unknown",children:"Unknown"})}),fe=()=>{const[o,n]=(0,m.useState)(!1),[r,s]=(0,m.useState)(!1),a=(0,j.YX)(),[i,u]=(0,j.dX)(),[d,h]=(0,j.WH)(),g=z(a.error),x=!!a.data?.id&&g?.statusCode!==404,E=a.isFetching||u.isLoading,T=(0,m.useCallback)(async()=>{(0,M.rR)("grafana_e2c_generate_token_clicked"),"error"in await i()||n(!0)},[i]),k=(0,m.useCallback)(async()=>{if(!a.data?.id)return;(0,M.rR)("grafana_e2c_delete_token_clicked"),"error"in await d({uid:a.data.id})||s(!1)},[d,a.data]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(I.a,{display:"flex",alignItems:"flex-start",direction:"column",gap:2,children:[u?.isError?(0,e.jsx)(W,{}):(0,e.jsx)(l.E,{color:"secondary",children:(0,e.jsxs)(t.x6,{i18nKey:"migrate-to-cloud.migration-token.status",children:["Current status:"," ",(0,e.jsx)(he,{hasToken:x,isFetching:E,errorMessageId:g?.messageId})]})}),x?(0,e.jsx)(p.$n,{onClick:()=>s(!0),variant:"destructive",children:(0,t.t)("migrate-to-cloud.migration-token.delete-button","Delete token")}):(0,e.jsx)(p.$n,{disabled:E,onClick:T,children:u.isLoading?(0,t.t)("migrate-to-cloud.migration-token.generate-button-loading","Generating a migration token..."):(0,t.t)("migrate-to-cloud.migration-token.generate-button","Generate a migration token")})]}),(0,e.jsx)(ue,{isOpen:o,hideModal:()=>{(0,M.rR)("grafana_e2c_generated_token_modal_dismissed"),n(!1)},migrationToken:u.data?.token}),(0,e.jsx)(me,{isOpen:r,onConfirm:k,onDismiss:()=>s(!1),hasError:!!h.error})]})},pe=()=>(0,e.jsx)(I.a,{backgroundColor:"secondary",display:"flex",alignItems:"center",direction:"column",children:(0,e.jsxs)(I.a,{maxWidth:90,paddingY:6,paddingX:2,gap:6,direction:"column",display:"flex",children:[(0,e.jsxs)(f.B,{gap:2,direction:"column",children:[(0,e.jsx)(le,{}),(0,e.jsx)(fe,{})]}),(0,e.jsx)(ce,{})]})});var F=c(10378);function Q(o){const{error:n,children:r,...s}=o,a=xe(n);return(0,e.jsx)(L.F,{...s,children:(0,e.jsxs)(f.B,{direction:"column",gap:1,children:[r,a&&(0,e.jsxs)(l.E,{element:"p",color:"secondary",variant:"bodySmall",children:["Trace ID: ",a]})]})})}function xe(o){const n=(0,$.NF)(o)?o.data:o;if(typeof n=="object"&&n&&"traceID"in n&&typeof n.traceID=="string")return n.traceID}const ye=({isOpen:o,isError:n,isLoading:r,onDisconnectConfirm:s,onDismiss:a})=>{const i=(0,e.jsxs)(f.B,{direction:"column",children:[n&&(0,e.jsx)(L.F,{severity:"error",title:(0,t.t)("migrate-to-cloud.disconnect-modal.error","There was an error disconnecting")}),(0,e.jsx)("div",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.disconnect-modal.body",children:"This will remove the migration token from this installation. If you wish to upload more resources in the future, you will need to enter a new migration token."})})]});return(0,e.jsx)(J.u,{isOpen:o,title:(0,t.t)("migrate-to-cloud.disconnect-modal.title","Disconnect from cloud stack"),body:(0,e.jsx)(e.Fragment,{}),description:i,confirmText:r?(0,t.t)("migrate-to-cloud.disconnect-modal.disconnecting","Disconnecting..."):(0,t.t)("migrate-to-cloud.disconnect-modal.disconnect","Disconnect"),dismissText:(0,t.t)("migrate-to-cloud.disconnect-modal.cancel","Cancel"),onConfirm:s,onDismiss:a})};var je=c(98349),Ee=c(49785);function Ie(o){switch(o){case"cloudmigrations.createMigration.tokenInvalid":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.token-invalid","Token is not valid. Generate a new token on your cloud instance and try again.");case"cloudmigrations.createMigration.tokenRequestError":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.token-request-error","An error occurred while validating the token. Please check the Grafana instance logs.");case"cloudmigrations.createMigration.tokenValidationFailure":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.token-validation-failure","Token is not valid. Please ensure the token matches the migration token on your cloud instance.");case"cloudmigrations.createMigration.instanceUnreachable":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.instance-unreachable","The cloud instance cannot be reached. Make sure the instance is running and try again.");case"cloudmigrations.createMigration.instanceRequestError":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.instance-request-error","An error occurred while attempting to verify the cloud instance's connectivity. Please check the network settings or cloud instance status.");case"cloudmigrations.createMigration.sessionCreationFailure":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.session-creation-failure","There was an error creating the migration. Please try again.");case"cloudmigrations.createMigration.migrationDisabled":return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.migration-disabled","Cloud migrations are disabled on this instance.");default:return(0,t.t)("migrate-to-cloud.connect-modal.token-errors.token-not-saved","There was an error saving the token. See the Grafana server logs for more details.")}}const be=({isOpen:o,isLoading:n,error:r,hideModal:s,onConfirm:a})=>{const i=(0,m.useId)(),u=(0,G.of)(ke),{handleSubmit:d,register:h,formState:{errors:g},watch:x}=(0,Ee.mN)({defaultValues:{token:""}}),E=x("token"),T=k=>{a({cloudMigrationSessionRequestDto:{authToken:k.token}}).then(v=>{typeof v=="object"&&v&&"error"in v||s()})};return(0,e.jsx)(D.a,{isOpen:o,title:(0,t.t)("migrate-to-cloud.connect-modal.title","Connect to a cloud stack"),onDismiss:s,children:(0,e.jsxs)("form",{onSubmit:d(T),children:[(0,e.jsx)(l.E,{color:"secondary",children:(0,e.jsxs)(f.B,{direction:"column",gap:2,children:[(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-get-started",children:"To get started, you'll need a Grafana.com account."}),(0,e.jsx)("div",{children:(0,e.jsx)(R.Y,{href:"https://grafana.com/auth/sign-up/create-user?pg=prod-cloud",external:!0,children:(0,t.t)("migrate-to-cloud.connect-modal.body-sign-up","Sign up for a Grafana.com account")})}),(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-cloud-stack",children:"You'll also need a cloud stack. If you just signed up, we'll automatically create your first stack. If you have an account, you'll need to select or create a stack."}),(0,e.jsx)("div",{children:(0,e.jsx)(R.Y,{href:"https://grafana.com/auth/sign-in/",external:!0,children:(0,t.t)("migrate-to-cloud.connect-modal.body-view-stacks","View my cloud stacks")})}),(0,e.jsx)("div",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-token",children:"Your self-managed Grafana installation needs special access to securely migrate content. You'll need to create a migration token on your chosen cloud stack."})}),(0,e.jsx)("div",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.body-token-instructions",children:"Log into your cloud stack and navigate to Administration, General, Migrate to Grafana Cloud. Create a migration token on that screen and paste the token here."})}),r?(0,e.jsx)(Q,{error:r,severity:"error",title:(0,t.t)("migrate-to-cloud.connect-modal.token-error-title","Error saving token"),children:(0,e.jsx)(l.E,{element:"p",children:Ie(z(r)?.messageId||"")||"There was an error saving the token. See the Grafana server logs for more details."})}):void 0,(0,e.jsx)(X.D,{className:u.field,invalid:!!g.token,error:g.token?.message,label:(0,t.t)("migrate-to-cloud.connect-modal.body-token-field","Migration token"),required:!0,children:(0,e.jsx)(Z.p,{...h("token",{required:(0,t.t)("migrate-to-cloud.connect-modal.token-required-error","Migration token is required")}),id:i,placeholder:(0,t.t)("migrate-to-cloud.connect-modal.body-token-field-placeholder","Paste token here")})})]})}),(0,e.jsxs)(D.a.ButtonRow,{children:[(0,e.jsx)(p.$n,{variant:"secondary",onClick:s,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.connect-modal.cancel",children:"Cancel"})}),(0,e.jsx)(p.$n,{type:"submit",disabled:n||!E,children:n?(0,t.t)("migrate-to-cloud.connect-modal.connecting","Connecting to this stack..."):(0,t.t)("migrate-to-cloud.connect-modal.connect","Connect to this stack")})]})]})})},ke=o=>({field:(0,P.css)({alignSelf:"stretch"})}),ve=()=>{const[o,n]=(0,m.useState)(!1),[r,s]=(0,j.hZ)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(I.a,{display:"flex",gap:2,direction:"column",alignItems:"center",backgroundColor:"secondary",children:[(0,e.jsx)(l.E,{variant:"h3",textAlignment:"center",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.cta.header",children:"Let us manage your Grafana stack"})}),(0,e.jsx)(p.$n,{disabled:s.isLoading,onClick:()=>n(!0),children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.cta.button",children:"Migrate this instance to Cloud"})})]}),(0,e.jsx)(be,{isOpen:o,isLoading:s.isLoading,error:s.error,onConfirm:r,hideModal:()=>n(!1)})]})},Ce=()=>(0,e.jsxs)(f.B,{gap:4,direction:"column",children:[(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.what-is-cloud.title","What is Grafana Cloud?"),linkTitle:(0,t.t)("migrate-to-cloud.what-is-cloud.link-title","Learn about cloud features"),linkHref:"https://grafana.com/products/cloud",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.what-is-cloud.body",children:"Grafana cloud is a fully managed cloud-hosted observability platform ideal for cloud native environments. It's everything you love about Grafana without the overhead of maintaining, upgrading, and supporting an installation."})}),(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.why-host.title","Why host with Grafana?"),linkTitle:(0,t.t)("migrate-to-cloud.why-host.link-title","More questions? Talk to an expert"),linkHref:"https://grafana.com/contact",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.why-host.body",children:"In addition to the convenience of managed hosting, Grafana Cloud includes many cloud-exclusive features like SLOs, incident management, machine learning, and powerful observability integrations."})}),(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.is-it-secure.title","Is it secure?"),linkTitle:(0,t.t)("migrate-to-cloud.is-it-secure.link-title","Grafana Labs Trust Center"),linkHref:"https://trust.grafana.com",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.is-it-secure.body",children:"Grafana Labs is committed to maintaining the highest standards of data privacy and security. By implementing industry-standard security technologies and procedures, we help protect our customers' data from unauthorized access, use, or disclosure."})})]}),Te=()=>(0,e.jsxs)(f.B,{gap:4,direction:"column",children:[(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.pdc.title","Not all my data sources are on the public internet"),linkTitle:(0,t.t)("migrate-to-cloud.pdc.link-title","Learn about PDC"),linkHref:"https://grafana.com/docs/grafana-cloud/connect-externally-hosted/private-data-source-connect",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.pdc.body",children:"Exposing your data sources to the internet can raise security concerns. Private data source connect (PDC) allows Grafana Cloud to access your existing data sources over a secure network tunnel."})}),(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.pricing.title","How much does it cost?"),linkTitle:(0,t.t)("migrate-to-cloud.pricing.link-title","Grafana Cloud pricing"),linkHref:"https://grafana.com/pricing",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.pricing.body",children:"Grafana Cloud has a generous free plan and a 14 day unlimited usage trial. After your trial expires, you'll be billed based on usage over the free plan limits."})}),(0,e.jsx)(C,{title:(0,t.t)("migrate-to-cloud.can-i-move.title","Can I move this installation to Grafana Cloud?"),linkTitle:(0,t.t)("migrate-to-cloud.can-i-move.link-title","Learn about migrating other settings"),linkHref:"https://grafana.com/docs/grafana-cloud/account-management/migration-guide",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.can-i-move.body",children:"Once you connect this installation to a cloud stack, you'll be able to upload data sources and dashboards."})})]}),Se=()=>(0,e.jsx)(I.a,{backgroundColor:"secondary",display:"flex",alignItems:"center",direction:"column",children:(0,e.jsx)(I.a,{maxWidth:180,paddingY:6,paddingX:2,children:(0,e.jsxs)(f.B,{gap:5,direction:"column",children:[(0,e.jsx)(ve,{}),(0,e.jsxs)(je.x,{alignItems:"flex-start",gap:4,columns:{xs:1,lg:2},children:[(0,e.jsx)(Ce,{}),(0,e.jsx)(Te,{})]})]})})});var Re=c(9968),Ne=c(13171);function A({title:o,children:n}){return(0,e.jsxs)(I.a,{minWidth:{xs:0,xxl:16},display:"flex",direction:"column",children:[(0,e.jsx)(l.E,{variant:"bodySmall",color:"secondary",children:o}),(0,e.jsx)(l.E,{variant:"h4",children:n})]})}const Le={dateStyle:"medium",timeStyle:"short"};function De(o){const{session:n,snapshot:r,isBusy:s,disconnectIsLoading:a,onDisconnect:i,showBuildSnapshot:u,buildSnapshotIsLoading:d,onBuildSnapshot:h,showUploadSnapshot:g,uploadSnapshotIsLoading:x,onUploadSnapshot:E,showRebuildSnapshot:T}=o,k=r?.stats?.total??0,v=r?.stats?.statuses?.ERROR??0,y=r?.stats?.statuses?.OK??0,S=r?.stats?.statuses?.WARNING??0;return(0,e.jsxs)(I.a,{borderColor:"weak",borderStyle:"solid",padding:2,display:"flex",gap:4,alignItems:"center",justifyContent:"space-between",children:[(0,e.jsxs)(f.B,{gap:4,wrap:!0,children:[(0,e.jsx)(A,{title:(0,t.t)("migrate-to-cloud.summary.snapshot-date","Snapshot timestamp"),children:r?.created?(0,Ne.Y)(r.created,Le):(0,e.jsx)(l.E,{color:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.snapshot-not-created",children:"Not yet created"})})}),(0,e.jsx)(A,{title:(0,t.t)("migrate-to-cloud.summary.total-resource-count","Total resources"),children:k}),(0,e.jsx)(A,{title:(0,t.t)("migrate-to-cloud.summary.errored-resource-count","Errors"),children:v}),(0,e.jsx)(A,{title:(0,t.t)("migrate-to-cloud.summary.successful-resource-count","Successfully migrated"),children:y+S}),(0,e.jsxs)(A,{title:(0,t.t)("migrate-to-cloud.summary.target-stack-title","Uploading to"),children:[n.slug,(0,e.jsx)(Re.$,{h:1,layout:"inline"}),(0,e.jsx)(p.$n,{disabled:s,onClick:i,variant:"secondary",size:"sm",icon:a?"spinner":void 0,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.disconnect",children:"Disconnect"})})]})]}),(0,e.jsxs)(f.B,{gap:2,wrap:!0,justifyContent:"flex-end",children:[u&&(0,e.jsx)(p.$n,{disabled:s,onClick:h,icon:d?"spinner":void 0,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.start-migration",children:"Build snapshot"})}),T&&(0,e.jsx)(p.$n,{disabled:s,onClick:h,icon:d?"spinner":void 0,variant:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.rebuild-snapshot",children:"Rebuild snapshot"})}),g&&(0,e.jsx)(p.$n,{disabled:s||x,onClick:E,icon:x?"spinner":void 0,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.upload-migration",children:"Upload snapshot"})})]})]})}var Ae=c(14123),we=c(16110),b=c(79784),q=c(85516),Oe=c(15664);function Pe(o){const n=o.row.original;return(0,e.jsxs)(f.B,{direction:"row",gap:2,alignItems:"center",children:[(0,e.jsx)(He,{resource:n}),(0,e.jsx)(f.B,{direction:"column",gap:0,children:(0,e.jsx)(Ge,{data:n})})]})}function Ge({data:o}){switch(o.type){case"DASHBOARD":return(0,e.jsx)(Fe,{data:o});case"DATASOURCE":return(0,e.jsx)(Me,{data:o});case"FOLDER":return(0,e.jsx)(Ke,{data:o});case"LIBRARY_ELEMENT":return(0,e.jsx)(Be,{data:o});default:return(0,e.jsx)(Ye,{data:o})}}function Me({data:o}){const n=o.refId,r=_(n);return r?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:r.name}),(0,e.jsx)(l.E,{color:"secondary",children:r.type})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.E,{children:(0,e.jsxs)(t.x6,{i18nKey:"migrate-to-cloud.resource-table.unknown-datasource-title",children:["Data source ",{datasourceUID:n}]})}),(0,e.jsx)(l.E,{color:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.resource-table.unknown-datasource-type",children:"Unknown data source"})})]})}function Ue(o){return o&&"title"in o&&typeof o.title=="string"?o.title:null}function Fe({data:o}){const n=o.refId,r=!!o.name&&!!o.parentName,{data:s,isLoading:a,isError:i}=(0,j.bM)({uid:n},{skip:r}),u=o.name||Ue(s?.dashboard)||n,d=o.parentName||s?.meta?.folderTitle||"Dashboards";return i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.E,{italic:!0,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.resource-table.dashboard-load-error",children:"Unable to load dashboard"})}),(0,e.jsxs)(l.E,{color:"secondary",children:["Dashboard ",n]})]}):a?(0,e.jsx)(K,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:u}),(0,e.jsx)(l.E,{color:"secondary",children:d})]})}function Ke({data:o}){const n=o.refId,r=!!o.name&&!!o.parentName,{data:s,isLoading:a,isError:i}=(0,Oe.kH)(n,{skip:r}),u=o.name||s?.title,d=o.parentName||s?.parents?.[s.parents.length-1]?.title;return i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.E,{italic:!0,children:"Unable to load folder"}),(0,e.jsxs)(l.E,{color:"secondary",children:["Folder ",o.refId]})]}):a?(0,e.jsx)(K,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:u}),(0,e.jsx)(l.E,{color:"secondary",children:d??"Dashboards"})]})}function Be({data:o}){const n=o.refId,r=!!o.name&&!!o.parentName,{data:s,isError:a,isLoading:i}=(0,j.A_)({libraryElementUid:n},{skip:r}),u=o.name||s?.result?.name||n,d=o.parentName||s?.result?.meta?.folderName||"General";return a?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.E,{italic:!0,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.resource-table.error-library-element-title",children:"Unable to load library element"})}),(0,e.jsx)(l.E,{color:"secondary",children:(0,e.jsxs)(t.x6,{i18nKey:"migrate-to-cloud.resource-table.error-library-element-sub",children:["Library Element ",n]})})]}):i?(0,e.jsx)(K,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:u}),(0,e.jsx)(l.E,{color:"secondary",children:d})]})}function K(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.A,{width:250}),(0,e.jsx)(U.A,{width:130})]})}function Ye({data:o}){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:o.name}),o.parentName&&(0,e.jsx)(l.E,{color:"secondary",children:o.parentName})]})}function He({resource:o}){const n=(0,G.of)($e),r=_(o.type==="DATASOURCE"?o.refId:void 0),s=ze(o.type==="PLUGIN"?o.plugin:void 0);switch(o.type){case"DASHBOARD":return(0,e.jsx)(b.I,{size:"xl",name:"dashboard"});case"FOLDER":return(0,e.jsx)(b.I,{size:"xl",name:"folder"});case"DATASOURCE":return r?.meta?.info?.logos?.small?(0,e.jsx)("img",{className:n.icon,src:r.meta.info.logos.small,alt:""}):(0,e.jsx)(b.I,{size:"xl",name:"database"});case"LIBRARY_ELEMENT":return(0,e.jsx)(b.I,{size:"xl",name:"library-panel"});case"MUTE_TIMING":return(0,e.jsx)(b.I,{size:"xl",name:"bell"});case"NOTIFICATION_TEMPLATE":return(0,e.jsx)(b.I,{size:"xl",name:"bell"});case"CONTACT_POINT":return(0,e.jsx)(b.I,{size:"xl",name:"bell"});case"NOTIFICATION_POLICY":return(0,e.jsx)(b.I,{size:"xl",name:"bell"});case"ALERT_RULE":return(0,e.jsx)(b.I,{size:"xl",name:"bell"});case"ALERT_RULE_GROUP":return(0,e.jsx)(b.I,{size:"xl",name:"bell"});case"PLUGIN":return s?(0,e.jsx)("img",{className:n.icon,src:s,alt:""}):(0,e.jsx)(b.I,{size:"xl",name:"plug"});default:return}}function $e(){return{icon:(0,P.css)({display:"block",width:(0,q.cs)("xl"),height:(0,q.cs)("xl")})}}function _(o){return(0,m.useMemo)(()=>{if(o)return N.$.datasources[o]||Object.values(N.$.datasources).find(r=>r.uid===o)},[o])}function ze(o){return(0,m.useMemo)(()=>{if(o)return o?.info?.logos},[o])?.small}function ee(o){switch(o){case"DATASOURCE":return(0,t.t)("migrate-to-cloud.resource-type.datasource","Data source");case"DASHBOARD":return(0,t.t)("migrate-to-cloud.resource-type.dashboard","Dashboard");case"FOLDER":return(0,t.t)("migrate-to-cloud.resource-type.folder","Folder");case"LIBRARY_ELEMENT":return(0,t.t)("migrate-to-cloud.resource-type.library_element","Library Element");case"MUTE_TIMING":return(0,t.t)("migrate-to-cloud.resource-type.mute_timing","Mute Timing");case"NOTIFICATION_TEMPLATE":return(0,t.t)("migrate-to-cloud.resource-type.notification_template","Notification Template");case"CONTACT_POINT":return(0,t.t)("migrate-to-cloud.resource-type.contact_point","Contact Point");case"NOTIFICATION_POLICY":return(0,t.t)("migrate-to-cloud.resource-type.notification_policy","Notification Policy");case"ALERT_RULE":return(0,t.t)("migrate-to-cloud.resource-type.alert_rule","Alert Rule");case"ALERT_RULE_GROUP":return(0,t.t)("migrate-to-cloud.resource-type.alert_rule_group","Alert Rule Group");case"PLUGIN":return(0,t.t)("migrate-to-cloud.resource-type.plugin","Plugin");default:return(0,t.t)("migrate-to-cloud.resource-type.unknown","Unknown")}}function We(o){const{type:n}=o.row.original;return(0,e.jsx)(e.Fragment,{children:ee(n)})}function Ve(o){switch(o){case"DATASOURCE_NAME_CONFLICT":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.datasource-name-conflict","There is a data source with the same name in the target instance. Rename one of them and try again.");case"DATASOURCE_INVALID_URL":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.datasource-invalid-url","There is a data source which has an invalid URL. Provide a valid URL and try again.");case"DATASOURCE_ALREADY_MANAGED":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.datasource-already-managed","Data source is already provisioned and managed by Grafana in the cloud instance. If this is a different resource, set another UID and try again.");case"FOLDER_NAME_CONFLICT":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.folder-name-conflict","There is a folder with the same name in the target instance. Rename one of them and try again.");case"DASHBOARD_ALREADY_MANAGED":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.dashboard-already-managed","Dashboard is already provisioned and managed by Grafana in the cloud instance. We recommend using the provisioned dashboard going forward. If you still wish to copy the dashboard to the cloud instance, then change the dashboard ID in the dashboard JSON, save a new snapshot and upload again.");case"LIBRARY_ELEMENT_NAME_CONFLICT":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.library-element-name-conflict","There is a library element with the same name in the target instance. Rename one of them and try again.");case"UNSUPPORTED_DATA_TYPE":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.unsupported-data-type","Migration of this data type is not currently supported.");case"RESOURCE_CONFLICT":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.resource-conflict","There is a resource conflict with the target instance. Please check the Grafana server logs for more details.");case"UNEXPECTED_STATUS_CODE":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.unexpected-error","There has been an error while migrating. Please check the Grafana server logs for more details.");case"INTERNAL_SERVICE_ERROR":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.internal-service-error","There has been an error while migrating. Please check the Grafana server logs for more details.");case"GENERIC_ERROR":return(0,t.t)("migrate-to-cloud.resource-details.error-messages.generic-error","There has been an error while migrating. Please check the cloud migration logs for more information.");default:return""}}function Xe(o){const{resource:n,onClose:r}=o,s=n?.refId,a=n&&ee(n.type),i=n?.errorCode||n?.message;let u=(0,t.t)("migrate-to-cloud.resource-details.generic-title","Resource migration details:");return n?.status==="ERROR"?u=(0,t.t)("migrate-to-cloud.resource-details.error-title","Unable to migrate this resource:"):n?.status==="WARNING"&&(u=(0,t.t)("migrate-to-cloud.resource-details.warning-title","Resource migrated with a warning:")),(0,e.jsx)(D.a,{title:(0,t.t)("migrate-to-cloud.resource-details.title","Migration resource details"),isOpen:!!n,onDismiss:r,children:n&&(0,e.jsxs)(f.B,{direction:"column",gap:2,alignItems:"flex-start",children:[(0,e.jsx)(l.E,{element:"p",weight:"bold",children:(0,e.jsxs)(t.x6,{i18nKey:"migrate-to-cloud.resource-details.resource-summary",children:[{refId:s}," (",{typeName:a},")"]})}),i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.E,{element:"p",children:u}),(0,e.jsx)(l.E,{element:"p",children:Ve(n?.errorCode)||n?.message||"There has been an error while migrating. Please check the cloud migration logs for more information."})]}):(0,e.jsx)(l.E,{element:"p",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.resource-details.missing-message",children:"No message provided."})}),(0,e.jsx)(p.$n,{onClick:r,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.resource-details.dismiss-button",children:"OK"})})]})})}function Ze(o){const n=o.row.original;return n.status==="PENDING"?(0,e.jsx)(l.E,{color:"secondary",children:(0,t.t)("migrate-to-cloud.resource-status.not-migrated","Not yet uploaded")}):n.status==="OK"?(0,e.jsx)(l.E,{color:"success",children:(0,t.t)("migrate-to-cloud.resource-status.migrated","Uploaded to cloud")}):n.status==="WARNING"?(0,e.jsx)(Qe,{item:n}):n.status==="ERROR"?(0,e.jsx)(Je,{item:n}):(0,e.jsx)(l.E,{color:"secondary",children:(0,t.t)("migrate-to-cloud.resource-status.unknown","Unknown")})}function Je({item:o}){return(0,e.jsxs)(f.B,{alignItems:"center",children:[(0,e.jsx)(l.E,{color:"error",children:(0,t.t)("migrate-to-cloud.resource-status.failed","Error")}),o.message&&(0,e.jsx)(p.$n,{size:"sm",variant:"secondary",onClick:()=>o.showDetails(o),children:(0,t.t)("migrate-to-cloud.resource-status.error-details-button","Details")})]})}function Qe({item:o}){return(0,e.jsxs)(f.B,{alignItems:"center",children:[(0,e.jsx)(l.E,{color:"warning",children:(0,t.t)("migrate-to-cloud.resource-status.warning","Uploaded with warning")}),o.message&&(0,e.jsx)(p.$n,{size:"sm",variant:"secondary",onClick:()=>o.showDetails(o),children:(0,t.t)("migrate-to-cloud.resource-status.warning-details-button","Details")})]})}const qe=[{id:"name",header:"Name",cell:Pe},{id:"type",header:"Type",cell:We},{id:"status",header:"Status",cell:Ze}];function _e({resources:o,localPlugins:n,numberOfPages:r=0,onChangePage:s,page:a=1}){const[i,u]=(0,m.useState)(),d=(0,m.useCallback)(g=>{u(g)},[]),h=(0,m.useMemo)(()=>o.map(g=>{const x=et(g,n);return{...g,showDetails:d,plugin:x}}),[o,d,n]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(f.B,{alignItems:"flex-end",direction:"column",children:[(0,e.jsx)(Ae.j,{columns:qe,data:h,getRowId:g=>g.refId}),(0,e.jsx)(we.d,{numberOfPages:r,currentPage:a,onNavigate:s})]}),(0,e.jsx)(Xe,{resource:i,onClose:()=>u(void 0)})]})}function et(o,n){if(!(!o||!n||o.type!=="PLUGIN"))return n.find(r=>r.id===o.refId)}var tt=c(20968);function te(o){const{title:n,accessory:r,children:s}=o;return(0,e.jsxs)(I.a,{maxWidth:44,display:"flex",direction:"row",gap:1,alignItems:"flex-start",children:[r&&(0,e.jsx)(I.a,{children:r}),(0,e.jsxs)(f.B,{gap:2,direction:"column",alignItems:"flex-start",children:[(0,e.jsx)(l.E,{element:"h3",variant:"h5",children:n}),s]})]})}function ot(o){const{disabled:n,isLoading:r,onClick:s}=o;return(0,e.jsxs)(te,{title:(0,t.t)("migrate-to-cloud.build-snapshot.title","No snapshot exists"),accessory:(0,e.jsx)(b.I,{name:"cog",size:"lg"}),children:[(0,e.jsx)(l.E,{element:"p",variant:"body",color:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.build-snapshot.description",children:"This tool can migrate some resources from this installation to your cloud stack. To get started, you'll need to create a snapshot of this installation. Creating a snapshot typically takes less than two minutes. The snapshot is stored alongside this Grafana installation."})}),(0,e.jsx)(l.E,{element:"p",variant:"body",color:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.build-snapshot.when-complete",children:"Once the snapshot is complete, you will be able to upload it to your cloud stack."})}),(0,e.jsx)(p.$n,{disabled:n,onClick:s,icon:r?"spinner":void 0,children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.start-migration",children:"Build snapshot"})})]})}function nt(o){const{disabled:n,isLoading:r,onClick:s}=o;return(0,e.jsxs)(te,{title:(0,t.t)("migrate-to-cloud.building-snapshot.title","Building installation snapshot"),accessory:(0,e.jsx)(tt.y,{inline:!0}),children:[(0,e.jsx)(l.E,{element:"p",variant:"body",color:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.building-snapshot.description",children:"We're creating a point-in-time snapshot of the current state of this installation. Once the snapshot is complete. you'll be able to upload it to Grafana Cloud."})}),(0,e.jsx)(l.E,{element:"p",variant:"body",color:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.building-snapshot.description-eta",children:"Creating a snapshot typically takes less than two minutes."})}),(0,e.jsx)(p.$n,{disabled:n,onClick:s,icon:r?"spinner":void 0,variant:"secondary",children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.cancel-snapshot",children:"Cancel snapshot"})})]})}function rt(){return(0,e.jsx)(l.E,{color:"secondary",textAlignment:"center",children:(0,e.jsxs)(t.x6,{i18nKey:"migrate-to-cloud.support-types-disclosure.text",children:["Dashboards, Folders, and built-in core data sources are migrated to your Grafana Cloud stack."," ",(0,e.jsx)(R.Y,{external:!0,href:"https://grafana.com/docs/grafana-cloud/account-management/migration-guide",children:"Learn about migrating other settings."})]})})}var st=c(17687);const at=4;function it(o){const n=(0,m.useRef)(void 0),r=(0,st._2)();(0,m.useEffect)(()=>{const s=o?.status,a=n.current!=="FINISHED"&&n.current!==void 0&&s==="FINISHED";if(n.current=s,!!a&&o){const i=(0,t.t)("migrate-to-cloud.onprem.success-title","Migration completed!"),u=lt(o);r.success(i,u)}},[r,o])}function lt(o){const n=[];let r=0;for(const[a,i]of Object.entries(o.stats?.types??{}))i<=0||(a==="DASHBOARD"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.dashboards","dashboards")):a==="DATASOURCE"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.datasources","data sources")):a==="FOLDER"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.folders","folders")):a==="LIBRARY_ELEMENT"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.library_elements","library elements")):a==="MUTE_TIMING"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.mute_timings","mute timings")):a==="NOTIFICATION_TEMPLATE"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.notification_templates","notification templates")):a==="CONTACT_POINT"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.contact_points","contact points")):a==="NOTIFICATION_POLICY"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.notification_policies","notification policies")):a==="ALERT_RULE"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.alert_rules","alert rules")):a==="ALERT_RULE_GROUP"?n.push((0,t.t)("migrate-to-cloud.migrated-counts.alert_rule_groups","alert rule groups")):a==="PLUGIN"&&n.push((0,t.t)("migrate-to-cloud.migrated-counts.plugins","plugins")),r+=1);const s=o?.stats?.statuses?.OK??0;return r>at?(0,t.t)("migrate-to-cloud.onprem.success-message-generic","Successfully migrated {{successCount}} resources to your Grafana Cloud instance.",{successCount:s}):(0,t.t)("migrate-to-cloud.onprem.success-message","Successfully migrated {{successCount}} {{types, list}} to your Grafana Cloud instance.",{successCount:s,types:n})}function ct(){const o=(0,j.SM)(),n=o.data?.sessions?.at(-1);return{...o,data:n}}const dt=["INITIALIZING","CREATING","UPLOADING","PENDING_PROCESSING","PROCESSING"],ut=["PENDING_UPLOAD","FINISHED","ERROR","UNKNOWN"],gt=["INITIALIZING","CREATING"],oe=["UPLOADING","PENDING_PROCESSING","PROCESSING"],ne=50;function mt(o,n=1){const[r,s]=(0,m.useState)(!1),a=(0,j.M8)(o?{uid:o,page:1,limit:1,sort:"latest"}:F.hT),i=a.currentData?.snapshots?.at(0),u=o&&i?.uid?{uid:o,snapshotUid:i.uid,resultLimit:ne,resultPage:n}:F.hT,d=(0,j.YD)(u,{pollingInterval:r?N.$.cloudMigrationPollIntervalMs:0,skipPollingIfUnfocused:!0}),h=a.isError||d.isError;return(0,m.useEffect)(()=>{const g=!h&&dt.includes(d.data?.status);s(g)},[d?.data?.status,h]),{...d,data:u===F.hT?void 0:d.data,error:a.error||d.error,isError:h,isLoading:a.isLoading||d.isLoading,isFetching:a.isFetching||d.isFetching}}const ht=()=>{const[o,n]=(0,m.useState)(!1),r=ct(),[s,a]=(0,m.useState)(1),i=mt(r.data?.uid,s),[u,d]=(0,j.ri)(),[h,g]=(0,j.aD)(),[x,E]=(0,j.r3)(),[T,k]=(0,j.AC)(),{currentData:v=[]}=(0,j.u)();it(i.data);const y=r.data?.uid,S=i.data?.uid,xt=r.isLoading,w=i.data?.status,B=d.isLoading||g.isLoading||E.isLoading||r.isLoading||i.isLoading||k.isLoading,Y=!i.isError&&!i.isLoading&&!i.data,re=gt.includes(w),yt=!i.isError&&(w==="PENDING_UPLOAD"||oe.includes(w)),jt=ut.includes(w),O=ft({snapshot:i.data,getSnapshotError:i.error,getSessionError:r.error,createSnapshotError:d.error,uploadSnapshotError:g.error,cancelSnapshotError:E.error,disconnectSnapshotError:k.error}),se=(0,m.useCallback)(async()=>{y&&T({uid:y})},[T,y]),ae=(0,m.useCallback)(()=>{y&&u({uid:y})},[u,y]),Et=(0,m.useCallback)(()=>{y&&S&&h({uid:y,snapshotUid:S})},[h,y,S]),It=(0,m.useCallback)(()=>{y&&S&&x({uid:y,snapshotUid:S})},[x,y,S]);return xt?(0,e.jsx)("div",{children:(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.summary.page-loading",children:"Loading..."})}):r.data?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(f.B,{direction:"column",gap:2,children:[r.data&&(0,e.jsx)(De,{session:r.data,snapshot:i.data,isBusy:B,disconnectIsLoading:k.isLoading,onDisconnect:se,showBuildSnapshot:Y,buildSnapshotIsLoading:d.isLoading,onBuildSnapshot:ae,showUploadSnapshot:yt,uploadSnapshotIsLoading:g.isLoading||oe.includes(w),onUploadSnapshot:Et,showRebuildSnapshot:jt}),O&&(0,e.jsx)(Q,{severity:O.severity,title:O.title,error:O.error,children:(0,e.jsx)(l.E,{element:"p",children:O.body})}),(Y||re)&&(0,e.jsxs)(I.a,{display:"flex",justifyContent:"center",paddingY:10,children:[Y&&(0,e.jsx)(ot,{disabled:B,isLoading:d.isLoading,onClick:ae}),re&&(0,e.jsx)(nt,{disabled:B,isLoading:E.isLoading,onClick:It})]}),i.data?.results&&i.data.results.length>0&&(0,e.jsxs)(f.B,{gap:4,direction:"column",children:[(0,e.jsx)(_e,{resources:i.data.results,localPlugins:v,onChangePage:a,numberOfPages:Math.ceil((i?.data?.stats?.total||0)/ne),page:s}),(0,e.jsx)(rt,{})]})]}),(0,e.jsx)(ye,{isOpen:o,isLoading:k.isLoading,isError:k.isError,onDisconnectConfirm:se,onDismiss:()=>n(!1)})]}):(0,e.jsx)(Se,{})};function ft(o){const{snapshot:n,getSnapshotError:r,getSessionError:s,createSnapshotError:a,uploadSnapshotError:i,cancelSnapshotError:u,disconnectSnapshotError:d}=o,h=(0,t.t)("migrate-to-cloud.onprem.error-see-server-logs","See the Grafana server logs for more details");if(s)return{severity:"error",title:(0,t.t)("migrate-to-cloud.onprem.get-session-error-title","Error loading migration configuration"),body:h,error:s};if(r)return{severity:"error",title:(0,t.t)("migrate-to-cloud.onprem.get-snapshot-error-title","Error loading snapshot"),body:h,error:r};if(d)return{severity:"warning",title:(0,t.t)("migrate-to-cloud.onprem.disconnect-error-title","Error disconnecting"),body:h,error:d};if(a)return{severity:"warning",title:(0,t.t)("migrate-to-cloud.onprem.create-snapshot-error-title","Error creating snapshot"),body:h,error:a};if(i)return{severity:"warning",title:(0,t.t)("migrate-to-cloud.onprem.upload-snapshot-error-title","Error uploading snapshot"),body:h,error:i};if(u)return{severity:"warning",title:(0,t.t)("migrate-to-cloud.onprem.cancel-snapshot-error-title","Error cancelling creating snapshot"),body:h,error:u};if(n?.status==="ERROR")return{severity:"warning",title:(0,t.t)("migrate-to-cloud.onprem.snapshot-error-status-title","Error migrating resources"),body:(0,t.t)("migrate-to-cloud.onprem.snapshot-error-status-body","There was an error creating the snapshot or starting the migration process. See the Grafana server logs for more details")};const g=n?.stats?.statuses?.ERROR??0,x=n?.stats?.statuses?.WARNING??0;if(n?.status==="FINISHED"&&g+x>0){let E="";return g>0?E=(0,t.t)("migrate-to-cloud.onprem.migration-finished-with-errors-body","The migration has completed, but some items could not be migrated to the cloud stack. Check the failed resources for more details"):x>0&&(E=(0,t.t)("migrate-to-cloud.onprem.migration-finished-with-warnings-body","The migration has completed with some warnings. Check individual resources for more details")),{severity:"warning",title:(0,t.t)("migrate-to-cloud.onprem.migration-finished-with-caveat-title","Resource migration complete"),body:E}}}function pt(){const o=N.$.cloudMigrationFeedbackURL;return(0,e.jsxs)(ie.Y,{navId:"migrate-to-cloud",children:[(0,e.jsxs)(L.F,{title:(0,t.t)("migrate-to-cloud.public-preview.title","Migrate to Grafana Cloud is in public preview"),buttonContent:(0,t.t)("migrate-to-cloud.public-preview.button-text","Give feedback"),severity:"info",onRemove:o?()=>{window.open(o,"_blank")}:void 0,children:[(0,e.jsxs)(t.x6,{i18nKey:"migrate-to-cloud.public-preview.message",children:[(0,e.jsx)(R.Y,{href:"https://grafana.com/docs/grafana-cloud/account-management/migration-guide/cloud-migration-assistant/",external:!0,children:"Visit our docs"})," ","to learn more about this feature!"]}),N.$.cloudMigrationIsTarget&&(0,e.jsxs)(e.Fragment,{children:["\xA0",(0,e.jsx)(t.x6,{i18nKey:"migrate-to-cloud.public-preview.message-cloud",children:"Your self-managed instance of Grafana requires version 11.5+, or 11.2+ with the onPremToCloudMigrations feature flag enabled."})]})]}),N.$.cloudMigrationIsTarget?(0,e.jsx)(pe,{}):(0,e.jsx)(ht,{})]})}}}]);

//# sourceMappingURL=MigrateToCloud.aed9c46f962b6554cda5.js.map