(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5892],{83821:(q,j,e)=>{"use strict";e.d(j,{p:()=>a});var t=e(74848),n=e(96540),r=e(10175);function a(i){const{children:x,instanceSettings:s}=i,c=(0,n.useMemo)(()=>({instanceSettings:s,meta:s.meta}),[s]);return(0,t.jsx)(r.o.Provider,{value:c,children:x})}},10175:(q,j,e)=>{"use strict";e.d(j,{o:()=>n});var t=e(96540);const n=(0,t.createContext)(void 0)},86360:(q,j,e)=>{"use strict";e.d(j,{a:()=>r});var t=e(74848),n=e(10175);function r(a){const{children:i,...x}=a;return(0,t.jsx)(n.o.Provider,{value:x,children:i})}},35617:(q,j,e)=>{"use strict";e.d(j,{S:()=>t});function t(n){return"instanceSettings"in n&&"meta"in n}},79748:(q,j,e)=>{"use strict";e.d(j,{Q:()=>r});var t=e(96540),n=e(10175);function r(){const a=(0,t.useContext)(n.o);return a||null}},75906:(q,j,e)=>{"use strict";e.d(j,{I:()=>a,f:()=>r});var t=e(63739),n=e(4038);class r{constructor(c,d){return this.fields=[],this.length=0,a(c,d)}}function a(s,c){const d={fields:[],length:s.length};if(!s?.length)return d;if(c){if(!x(s))throw new Error("source is not an array of objects");for(const g of c)d.fields.push(i(g,s.map(o=>o&&o[g])));return d}if(s.find(g=>g)===null)return d;if(x(s)){const g=s.find(o=>o);d.fields=Object.keys(g||{}).map(o=>i(o,s.map(E=>E&&E[o])))}else d.fields.push(i(t.Bc,s));return d}function i(s,c){const d={name:s,config:{},values:c,type:t.PU.other};return d.type=(0,n.dF)(d)??t.PU.other,d}function x(s){const c=s.find(d=>d);return s.length>0&&typeof c=="object"}},24616:(q,j,e)=>{"use strict";e.d(j,{x:()=>r});var t=e(54850),n=e(36669);class r extends n.k{constructor(i){super(void 0,x=>new t.$({...i,buffer:x}))}}},26701:(q,j,e)=>{"use strict";e.d(j,{EL:()=>i,Nw:()=>c,or:()=>s,t:()=>a});var t=e(63739),n=e(4038);const r={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function a(d,u){let g;for(g in d){const o=r[g];for(const E of d[g])E<u.length&&(u[E]=o)}}function i(d,u){for(let g=0;g<u.length;g++)u[g]=d[Number(u[g])]}function x(d,u){for(const g of u)if(g!=null)return(0,n.by)(d,g);return t.PU.other}function s(d){const{schema:u,data:g}=d;if(!u||!u.fields)throw new Error("JSON needs a fields definition");const o=g?g.values.reduce((m,f)=>Math.max(m,f.length),0):0,E=u.fields.map((m,f)=>{let p=g?g.values[f]:[],h=p.length,D=m.type;h!==o&&(p.length=o,p.fill(void 0,h));let C=g?.entities?.[f];C&&a(C,p);let l=g?.enums?.[f];l&&(i(l,p),D=t.PU.string);const v=g?.nanos?.[f],y={...m,type:D??x(m.name,p),config:m.config??{},values:p,entities:C??{}};return v!=null&&(y.nanos=v),y});return{...u,fields:E,length:o}}function c(d){const u={values:[]},g=[];let o=!1;const E={refId:d.refId,meta:d.meta,name:d.name,fields:d.fields.map(m=>{const{values:f,nanos:p,state:h,display:D,...C}=m;return"entities"in C&&delete C.entities,u.values.push(f),p!=null?(g.push(p),o=!0):g.push(null),C})};return o&&(u.nanos=g),{schema:E,data:u}}},94626:(q,j,e)=>{"use strict";e.d(j,{R:()=>n});var t=e(98486);class n extends t.F{constructor(a){super(),this.data=a,this.index=0;const i={},x={};for(let s=0;s<a.fields.length;s++){const c=a.fields[s];if(!c.name)continue;x[c.name]=c;const d=()=>c.values.get(this.index);i.hasOwnProperty(c.name)||Object.defineProperty(i,c.name,{enumerable:!0,get:d}),i.hasOwnProperty(s.toString())||Object.defineProperty(i,s,{enumerable:!1,get:d})}this.obj=i,this.fields=x}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(a){if(!this.dataFrame||!this.dataFrame.fields)return;const i=this.dataFrame.fields[a];if(!(!i||!i.display))return i.display}get(a){return this.index=a,this.obj}toArray(){return new Array(this.data.length).fill(0).map((a,i)=>({...this.get(i)}))}}},38790:(q,j,e)=>{"use strict";e.d(j,{L:()=>r});var t=e(63739),n=e(4038);class r{constructor(i){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=i.fields.map((x,s)=>({...x,index:s}));for(let x=0;x<i.fields.length;x++){const s=i.fields[x];if(s.type===t.PU.other){const c=(0,n.dF)(s);c&&(s.type=c)}this.fieldByType[s.type]||(this.fieldByType[s.type]=[]),this.fieldByType[s.type].push({...s,index:x}),this.fieldByName[s.name]?console.warn("Duplicate field names in DataFrame: ",s.name):this.fieldByName[s.name]={...s,index:x}}}getFields(i){if(!i)return[...this.fields];const x=this.fieldByType[i];return x?[...x]:[]}hasFieldOfType(i){const x=this.fieldByType[i];return x&&x.length>0}getFirstFieldOfType(i,x=!1){return this.fieldByType[i]?.find(d=>x||!d.config.custom?.hidden)}hasFieldNamed(i){return!!this.fieldByName[i]}hasFieldWithNameAndType(i,x){return!!this.fieldByName[i]&&this.fieldByType[x].filter(s=>s.name===i).length>0}getFieldByName(i){return this.fieldByName[i]}getFieldsByLabel(i,x){return Object.values(this.fieldByName).filter(s=>s.labels&&s.labels[i]===x)}}},36669:(q,j,e)=>{"use strict";e.d(j,{p:()=>x,k:()=>s});var t=e(2543),n=e(63739),r=e(4038);function a(c,d){return d.type||(d.name==="time"||d.name==="Time"?d.type=n.PU.time:d.type=(0,r.HW)(c)),d.type===n.PU.number?u=>parseFloat(u):d.type===n.PU.boolean?u=>!(u[0]==="F"||u[0]==="f"||u[0]==="0"):u=>u}var i=e(98486);const x=void 0;class s extends i.F{constructor(d,u){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=u||(g=>g??[]),d){const{name:g,refId:o,meta:E,fields:m}=d;if(g&&(this.name=g),o&&(this.refId=o),E&&(this.meta=E),m)for(const f of m)this.addField(f)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(d,u){return this.addField({name:u||"",type:(0,r.HW)(d)})}addField(d,u){let g;d.values&&(g=d.values);let o=d.type;!o&&(d.name==="time"||d.name==="Time")?o=n.PU.time:(!o&&g&&g.length&&(o=(0,r.HW)(g[0])),o||(o=n.PU.other));let E=d.name;E||(E=`Field ${this.fields.length+1}`);const m={...d,name:E,type:o,config:d.config||{},values:this.creator(g)};if(o===n.PU.other&&(o=(0,r.dF)(m),o&&(m.type=o)),this.fields.push(m),this.first=this.fields[0].values,u)for(;m.values.length<u;)m.values.push(x);else this.validate();return m}validate(){const d=this.fields.reduce((u,g)=>Math.max(u,g.values.length),0);for(const u of this.fields)for(;u.values.length!==d;)u.values.push(x)}setParser(d,u){return this.parsers||(this.parsers=new Map),this.parsers.set(d,u),u}parseValue(d,u){let g=this.parsers?.get(d);return g||(g=this.setParser(d,a(u,d))),g(u)}appendRow(d){for(let u=this.fields.length;u<d.length;u++)this.addField({name:`Field ${u+1}`,type:(0,r.HW)(d[u])});if(this.length<1)for(let u=0;u<this.fields.length;u++){const g=this.fields[u];(!g.type||g.type===n.PU.other)&&(g.type=(0,r.HW)(d[u]))}for(let u=0;u<this.fields.length;u++){const g=this.fields[u];let o=d[u];g.type!==n.PU.string&&(0,t.isString)(o)&&(o=this.parseValue(g,o)),g.values.push(o)}}push(...d){for(const u of d)this.add(u);return this.length}reverse(){for(const d of this.fields)d.values.reverse();return this}add(d){const u=d;for(const g of this.fields){let o=u[g.name];g.type!==n.PU.string&&(0,t.isString)(o)&&(o=this.parseValue(g,o)),o===void 0&&(o=x),g.values.push(o)}}set(d,u){if(d>this.length)throw new Error("Unable to set value beyond current length");const g=u||{};for(const o of this.fields)o.values[d]=g[o.name]}get(d){const u={};for(const g of this.fields)u[g.name]=g.values[d];return u}toJSON(){return(0,r.Kl)(this)}}},59765:(q,j,e)=>{"use strict";e.d(j,{Kh:()=>s,Ls:()=>E,k9:()=>u,m8:()=>g});var t=e(77230),n=e(63739),r=e(55515),a=e(52733),i=e(26701),x=e(4038),s=(l=>(l.Append="append",l.Replace="replace",l))(s||{});const c="__name__";var d=(l=>(l[l.wide=0]="wide",l[l.labels=1]="labels",l))(d||{});class u{constructor(v){this.options=v,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(y,P,b)=>{const S=P?Object.assign({},{...this.options,...P}):this.options,M=(0,x.By)(this,y),O=D(M.fields.map(L=>L.values??[]),typeof b?.maxLength=="number"?Math.min(b.maxLength,S.maxLength):S.maxLength,this.timeFieldIndex,S.maxDelta);M.fields=M.fields.map(L=>({...L,values:L.values?.slice(O)}));const R=M.fields[0]?.values?.length??0;return{...M,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:R,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:S}},this.initFromSerialized=y=>{this.name=y.name,this.refId=y.refId,this.meta=y.meta,this.length=y.length,this.labels=y.labels,this.schemaFields=y.schemaFields,this.timeFieldIndex=y.timeFieldIndex,this.pushMode=y.pushMode,this.packetInfo.length=y.packetInfo.length,this.packetInfo.number=y.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=y.fields.map(P=>({...P,type:P.type??n.PU.other,config:P.config??{},values:P.values??[]})),h(this.fields.map(P=>P.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:y,maxDelta:P})=>{const b=y&&this.options.maxLength<y,S=P&&this.options.maxDelta<P,M=P&&this.options.maxDelta===1/0;return!!(b||S||M)},this.resize=({maxLength:y,maxDelta:P})=>{P&&(this.options.maxDelta===1/0?this.options.maxDelta=P:this.options.maxDelta=Math.max(P,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,y??0)},this.pushNewValues=y=>{if(!y?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=y[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?p(this.fields.map(b=>b.values),y,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(y.forEach((b,S)=>{this.fields[S]&&(this.fields[S].values=b)}),h(this.fields.map(b=>b.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const P=this.fields?.[0]?.values.length;P!==void 0&&(this.length=P)},this.resetStateCalculations=()=>{this.fields.forEach(y=>{y.state={...y.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=y=>this.fields.map((P,b)=>y(P)?b:void 0).filter(P=>P!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(y=>{const P=y.values;return P.slice(Math.max(P.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=v=>{const y=new u(v.options);return y.initFromSerialized(v),y}}static{this.empty=v=>new u(g(v))}static{this.fromDataFrameJSON=(v,y)=>{const P=new u(g(y));return P.push(v),P}}get alwaysReplace(){return this.options.action==="replace"}push(v){const{schema:y,data:P}=v;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,y){this.pushMode=0,this.timeFieldIndex=y.fields.findIndex(O=>O.type===n.PU.time);const b=y.fields[0];this.timeFieldIndex===1&&b.type===n.PU.string&&(b.name==="labels"||b.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const S=this.pushMode===1?y.fields.slice(1):y.fields;this.refId=y.refId,y.meta&&(this.meta={...y.meta});const{displayNameFormat:M}=this.options;if(C(this.schemaFields,S)){const O=S.length;this.fields.forEach((R,L)=>{const B=S[L%O];R.config=B.config??{},R.labels=B.labels}),M&&this.fields.forEach(R=>{const L={[c]:R.name,...R.labels};R.config.displayNameFromDS=(0,a.j)(M,L)})}else{this.packetInfo.schemaChanged=!0;const O=this.pushMode===0;this.fields=S.map(R=>{const L=R.config??{};if(M){const B={[c]:R.name,...R.labels};L.displayNameFromDS=(0,a.j)(M,B)}return{config:L,name:R.name,labels:R.labels,type:R.type??n.PU.other,values:O?this.fields.find(B=>B.name===R.name&&R.type===B.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=S}if(P&&P.values.length&&P.values[0].length){let{values:b,entities:S}=P;if(S&&S.forEach((O,R)=>{O&&(0,i.t)(O,b[R])}),this.pushMode===1){const O=o(b);for(const B of O.keys())this.labels.has(B)||(this.packetInfo.schemaChanged=!0,this.addLabel(B));let R=Array(this.schemaFields.length).fill([]),L=[];this.labels.forEach(B=>{L.push(O.get(B)??R)}),b=(0,t.fj)(L)}if(b.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${b.length} (labels=${this.pushMode===1})`);this.fields=b.map((O,R)=>{let L=`Field ${R}`,B=(0,x.HW)(O[0]);return R===0&&B===n.PU.number&&O[0]>1600016688632&&(B=n.PU.time,L="Time"),{name:L,type:B,config:{},values:[]}})}let M=b;this.packetInfo.length=b[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",M=this.fields.map(O=>O.values),p(M,b,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),M.forEach((O,R)=>{const L=this.fields[R],{state:B}=L;L.values=O,B&&(B.calcs=void 0)}),this.length=M[0].length}return{...this.packetInfo}}addLabel(v){const{displayNameFormat:y}=this.options,P=this.labels.size,b=m(v);if(P===0)this.fields.forEach((S,M)=>{if(M>0&&(S.labels=b,y)){const O={[c]:S.name,...b};S.config.displayNameFromDS=(0,a.j)(y,O)}});else for(let S=1;S<this.schemaFields.length;S++){let M=this.schemaFields[S];const O=M.config??{};if(y){const R={[c]:M.name,...b};O.displayNameFromDS=(0,a.j)(y,R)}this.fields.push({...M,config:O,labels:b,values:Array(this.length).fill(void 0)})}this.labels.add(v)}}function g(l){return{maxLength:l?.maxLength??1e3,maxDelta:l?.maxDelta??1/0,action:l?.action??"append",displayNameFormat:l?.displayNameFormat}}function o(l){let v=new Set(l[0]),y=new Map;v.forEach(P=>{let b=Array(l.length-1).fill(null).map(()=>[]);y.set(P,b)});for(let P=0;P<l[0].length;P++){let b=y.get(l[0][P]);for(let S=1;S<l.length;S++)b[S-1].push(l[S][P])}return y}function E(l,v,y,P){let b;y=y||0,P=P||v.length-1;let S=P<=2147483647;for(;P-y>1;)b=S?y+P>>1:Math.floor((y+P)/2),v[b]<l?y=b:P=b;return l-v[y]<=v[P]-l?y:P}function m(l){if(!l.length)return{};if(l.charAt(0)==="{")return(0,r.Xy)(l);const v={};return l.split(",").forEach(y=>{const[P,b]=y.trim().split("=");v[P]=b}),v}function f(l){if(l instanceof u)return l.packetInfo.action}function p(l,v,y=1/0,P=0,b=1/0){for(let S=0;S<l.length;S++)for(let M=0;M<v[S].length;M++)l[S].push(v[S][M]);return h(l,y,P,b)}function h(l,v=1/0,y=0,P=1/0){const b=D(l,v,y,P);if(b)for(let S=0;S<l.length;S++)l[S].splice(0,b);return b}function D(l,v=1/0,y=0,P=1/0){if(!l[0]?.length)return 0;const b=l[0].length;let S=0;if(b>v&&(S=b-v),P!==1/0&&y>=0){const M=l[y],O=M[S],R=M[b-1];R-O>P&&(S=E(R-P,M,S))}return S}function C(l,v){if(l?.length!==v.length)return!1;for(let y=0;y<l.length;y++){const P=l[y],b=v[y];if(P.name!==b.name||P.type!==b.type)return!1}return!0}},16557:(q,j,e)=>{"use strict";e.d(j,{Km:()=>i,P4:()=>r,WK:()=>a,g6:()=>n,r4:()=>t,xB:()=>x});const t=(s,c)=>({name:s,columns:c}),n=s=>s.columns,r=(s,c)=>s.columns[c],a=(s,c,d)=>s.columns[c].values[d],i=(s,c,d)=>s.columns.map(u=>u.values[d]),x=(s,c)=>s[c]},2049:(q,j,e)=>{"use strict";e.d(j,{J3:()=>a,ab:()=>x,bW:()=>r});var t=e(2543),n=e.n(t);function r(s,c,d){if(s===c)return!0;if(s?.fields?.length!==c?.fields?.length||s.name!==c.name)return!1;for(let u=0;u<s.fields.length;u++){const g=s.fields[u],o=c.fields[u];if(g.type!==o.type||g.name!==o.name)return!1;if(d)continue;if(g.labels&&o.labels&&!x(g.labels,o.labels))return!1;const E=g.config,m=o.config;if(Object.keys(E).length!==Object.keys(m).length)return!1;let f;for(f in E){if(!(f in m))return!1;if(f!=="interval"&&!(0,t.isEqual)(E[f],m[f]))return!1}}return!0}function a(s,c,d){if(s===c)return!0;if(s?.length!==c?.length)return!1;for(let u=0;u<s.length;u++)if(!d(s[u],c[u]))return!1;return!0}const i=(s,c)=>s===c;function x(s,c,d=i){if(s===c)return!0;if(Object.keys(s).length!==Object.keys(c).length)return!1;let u;for(u in s)if(!d(s[u],c[u]))return!1;return!0}},4038:(q,j,e)=>{"use strict";e.d(j,{Bt:()=>I,By:()=>L,EI:()=>W,ES:()=>S,HW:()=>h,KR:()=>B,Kl:()=>R,LI:()=>y,N$:()=>U,Vc:()=>P,XQ:()=>C,Yn:()=>O,by:()=>f,ci:()=>v,dF:()=>D,oE:()=>p,pH:()=>l,q7:()=>M,w3:()=>b});var t=e(2543),n=e.n(t),r=e(3202),a=e(53539),i=e(23570),x=e(8392),s=e(63739),c=e(75906),d=e(26701);function u(A){const N=A.columns.map(K=>{const{text:V,type:T,...z}=K,w=[];return{name:V?.length?V:K,config:z||{},values:w,type:T&&Object.values(s.PU).includes(T)?T:s.PU.other}});if(!(0,t.isArray)(A.rows))throw new Error(`Expected table rows to be array, got ${typeof A.rows}.`);for(const K of A.rows)for(let V=0;V<N.length;V++)N[V].values.push(K[V]);for(const K of N)if(K.type===s.PU.other){const V=D(K);V&&(K.type=V)}return{fields:N,refId:A.refId,meta:A.meta,name:A.name,length:A.rows.length}}function g(A){const N=[],K=[],V=A.datapoints||A.points;for(const z of V)K.push(z[0]),N.push(z[1]);const T=[{name:s.LE,type:s.PU.time,config:{},values:N},{name:s.Bc,type:s.PU.number,config:{unit:A.unit},values:K,labels:A.tags}];return A.title&&(T[1].config.displayNameFromDS=A.title),{name:A.target||A.name,refId:A.refId,meta:A.meta,fields:T,length:K.length}}function o(A){const N=[],K=[];for(let V=0;V<A.data.length;V++){const T=A.data[V];N.push(T[1]),K.push(T[0])}return{name:A.label,fields:[{name:A.label||s.Bc,type:s.PU.number,config:{},values:N},{name:s.LE,type:s.PU.time,config:{unit:"dateTimeAsIso"},values:K}],length:N.length}}function E(A){const N=[{name:A.target,type:s.PU.other,labels:A.tags,config:{unit:A.unit,filterable:A.filterable},values:[]}];for(const K of A.datapoints)N[0].values.push(K);return{name:A.target,refId:A.target,meta:{json:!0},fields:N,length:A.datapoints.length}}const m=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function f(A,N){return A&&(A=A.toLowerCase(),A==="date"||A==="time")?s.PU.time:h(N)}function p(A){return A instanceof Date||(0,r.Ar)(A)?s.PU.time:(0,t.isNumber)(A)?s.PU.number:(0,t.isString)(A)?s.PU.string:(0,t.isBoolean)(A)?s.PU.boolean:s.PU.other}function h(A){return A instanceof Date||(0,r.Ar)(A)?s.PU.time:(0,t.isNumber)(A)?s.PU.number:(0,t.isString)(A)?m.test(A)?s.PU.number:A==="true"||A==="TRUE"||A==="True"||A==="false"||A==="FALSE"||A==="False"?s.PU.boolean:s.PU.string:(0,t.isBoolean)(A)?s.PU.boolean:s.PU.other}function D(A){if(A.name){const N=A.name.toLowerCase();if(N==="date"||N==="time")return s.PU.time}for(let N=0;N<A.values.length;N++){const K=A.values[N];if(K!=null)return h(K)}}const C=(A,N=!1)=>{for(const K of A.fields)if(!K.type||K.type===s.PU.other||N)return{...A,fields:A.fields.map(V=>V.type&&V.type!==s.PU.other&&!N?V:{...V,type:D(V)||s.PU.other})};return A},l=A=>!!(A&&A.hasOwnProperty("columns")),v=A=>!!(A&&A.hasOwnProperty("fields")),y=A=>!!(v(A)&&A.hasOwnProperty("value"));function P(A){if("fields"in A)return"length"in A&&A.fields[0]?.values?.get?A:W(A);if(A.hasOwnProperty("type")&&A.type==="docs")return E(A);if(A.hasOwnProperty("datapoints")||A.hasOwnProperty("points"))return g(A);if(A.hasOwnProperty("data"))return A.hasOwnProperty("schema")?(0,d.or)(A):o(A);if(A.hasOwnProperty("columns"))return u(A);if(Array.isArray(A))return(0,c.I)(A);throw console.warn("Can not convert",A),new Error("Unsupported data format")}const b=A=>{const{fields:N}=A,K=A.length,V=[];if(N.length===2){const{timeField:T,timeIndex:z}=B(A);if(T){const H=N[z===0?1:0],G=N[z];for(let X=0;X<K;X++)V.push([H.values[X],G.values[X]]);return{alias:A.name,target:(0,i.Ct)(H,A),datapoints:V,unit:N[0].config?N[0].config.unit:void 0,refId:A.refId,meta:A.meta}}}for(let T=0;T<K;T++){const z=[];for(let w=0;w<N.length;w++)z.push(N[w].values[T]);V.push(z)}return A.meta&&A.meta.json?{alias:N[0].name||A.name,target:N[0].name||A.name,datapoints:N[0].values,filterable:N[0].config?N[0].config.filterable:void 0,type:"docs"}:{columns:N.map(T=>{const{name:z,config:w}=T;if(w){const{...H}=w;return H.text=z,H}return{text:z}}),type:"table",refId:A.refId,meta:A.meta,rows:V}};function S(A,N,K=!1){const V=A.fields[N];if(!V)return A;const T=[];for(let w=0;w<A.length;w++)T.push(w);const z=(0,a.i)(V,K);return T.sort(z),{...A,fields:A.fields.map(w=>{const H={...w,values:w.values.map((X,k)=>w.values[T[k]])},{nanos:G}=w;return G!==void 0&&(H.nanos=G.map((X,k)=>G[T[k]])),H})}}function M(A){return{...A,fields:A.fields.map(N=>{const K=[...N.values];K.reverse();const V={...N,values:K},{nanos:T}=N;if(T!==void 0){const z=[...T];z.reverse(),V.nanos=z}return V})}}function O(A,N){const K=[];for(const V of A.fields)K.push(V.values[N]);return K}function R(A){return L(A)}function L(A,N){return{fields:(N?A.fields.filter(N):A.fields).map(T=>{let z=T.values;return{name:T.name,type:T.type,config:T.config,values:z,labels:T.labels}}),refId:A.refId,meta:A.meta,name:A.name}}const B=A=>{for(let N=0;N<A.fields.length;N++)if(A.fields[N].type===s.PU.time)return{timeField:A.fields[N],timeIndex:N};return{}};function F(A){const N=C(P(A));if(N.fields&&N.fields.length)for(const K of N.fields)K.state=null;return N}function I(A){return!A||!(0,t.isArray)(A)?[]:A.map(N=>F(N))}function U(A,N){const{series:K,annotations:V}=A;if(A.state===x.Gu.Loading&&K.length===0)return N||(N=A),{...N,state:x.Gu.Loading,request:A.request};const T=performance.now(),z=K.map(G=>F(G)),w=I(V),H=performance.now();return{...A,series:z,annotations:w,timings:{dataProcessingTime:H-T}}}function W(A){let N=0;const K=A.fields.map((V,T)=>{const{state:z,...w}=V;return w.name||(w.name=`Field ${T+1}`),w.config||(w.config={}),w.values?w.values.length>N&&(N=w.values.length):w.values=new Array(N),w.type||(w.type=D(w)??s.PU.other),w});return{...A,fields:K,length:N}}},67555:(q,j,e)=>{"use strict";e.d(j,{S1:()=>c,aH:()=>a,hF:()=>x,jq:()=>i,t9:()=>d,tP:()=>s,uY:()=>u});var t=e(63739),n=e(4038);const r=100;function a(g){if(g.fields.length<2)return!1;const o=g.fields.find(m=>m.type===t.PU.number);let E=!1;for(const m of g.fields)if(x(m)){E=!0;break}return E&&o!==void 0}function i(g){return!g.find(o=>!a(o))}function x(g){if(g.type!==t.PU.time)return!1;let o=null,E=g.values.length>r?r:g.values.length;for(let m=0;m<E;m++){const f=g.values[m];if(o===null||f!==null&&f>o)o=f;else return!1}return!0}function s(g){for(let o=0;o<g.length;o++){const E=(0,n.KR)(g[o]);if(E.timeField!==void 0&&E.timeIndex!==void 0)return!0}return!1}function c(g){return g.fields.some(o=>o.type===t.PU.time)}function d(g,o){if(g.meta?.uniqueRowIdFields!==void 0)return g.meta.uniqueRowIdFields.map(E=>g.fields[E].values[o]).join("-")}function u(g,o){if(o instanceof Array)for(let E=0;E<o.length;E++)g.fields[E].values.push(o[E]);else for(const E of g.fields)E.values.push(o[E.name]);try{g.length++}catch{}}},66102:(q,j,e)=>{"use strict";e.d(j,{E9:()=>s,Q7:()=>x,Ri:()=>c,V3:()=>E,WT:()=>d,dU:()=>i,di:()=>g,pp:()=>o,vd:()=>u});var t=e(47402),n=e(60365),r=e(66907);const a={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function i(f,p=!0){if((0,t.d)(f.start,f.end))return"";const h=(0,n.F)(f);return x(h,p)}function x(f,p){return Object.entries(f).reduce((h,[D,C])=>C&&C!==0&&!(D==="seconds"&&!p&&h)?h+`${h!==""?" ":""}${C}${a[D][0]}`:h,"")}function s(f){return f.split(" ").reduce((p,h)=>{const D=h.match(/(\d+)(.+)/),C=D?.[1],l=D?.[2];if(!(C&&l))return p;const v=Object.entries(a).find(([P,b])=>b?.includes(D[2])),y=parseInt(C,10);return v?{...p,[v[0]]:y}:p},{})}function c(f,p){return(0,r.W)(f,p)}function d(f){const p=new Date;return c(p,f).getTime()-p.getTime()}function u(f){return!isNaN(Date.parse(f))}function g(f){for(const p of f.trim().split(" ")){const h=p.match(/(\d+)(.+)/);if(h===null||h.length!==3||!Object.entries(a).find(([C,l])=>l?.includes(h[2]))?.[0])return!1}return!0}function o(f){return m(f,["h","m","s","ms","us","\xB5s","ns"])}function E(f){return m(f,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function m(f,p){for(const h of f.trim().split(" ")){const D=h.match(/([0-9]*[.]?[0-9]+)(.+)/);if(D===null||D.length!==3||!p.includes(D[2]))return!1}return!0}},58064:(q,j,e)=>{"use strict";e.d(j,{HD:()=>c,P3:()=>u,QZ:()=>d,U3:()=>g,g$:()=>x,le:()=>s});var t=e(2543),n=e.n(t),r=e(84743),a=e.n(r),i=e(35023),x=(h=>(h.default="",h.localBrowserTime="browser",h.utc="utc",h))(x||{});const s=h=>{switch((0,i.O)({timeZone:h})){case"browser":return"Local browser time";case"utc":return"UTC";default:return h}},c=h=>a().tz.zone(h),d=(h,D)=>{const C=o(h,D);return C||m(h,D)},u=(0,t.memoize)((h=!1)=>{const D=[];return h===!0?D.push("","browser","utc"):h&&D.push(...h),a().tz.names().reduce((C,l)=>{const v=p[l];return!Array.isArray(v)||v.length===0||C.push(l),C},D)}),g=(0,t.memoize)((h=!1)=>{const C=u(h).reduce((l,v)=>{const y=v.indexOf("/");if(y===-1){const b="";return l[b]=l[b]??[],l[b].push(v),l}const P=v.slice(0,y);return l[P]=l[P]??[],l[P].push(v),l},{});return Object.keys(C).map(l=>({name:l,zones:C[l]}))}),o=(h,D)=>{switch(h){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:h,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const C=(0,i.O)(),v=C==="browser"||C==="utc"?o(C,D):m(C,D);return{countries:p[C]??[],abbreviation:"",offsetInMins:0,...v,ianaName:v?.ianaName??"",name:"Default",zone:h}}case"browser":{const C=a().tz.guess(!0),l=m(C,D);return{countries:p[C]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...l,name:"Browser Time",ianaName:l?.ianaName??"",zone:h}}default:return}},E=h=>/^(\+|\-).+/.test(h)?"":h,m=(h,D)=>{const C=a().tz.zone(h);if(C)return{name:h,ianaName:C.name,zone:h,countries:p[h]??[],abbreviation:E(C.abbr(D)),offsetInMins:C.utcOffset(D)}},f={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},p=a().tz.countries().reduce((h,D)=>a().tz.zonesForCountry(D).reduce((l,v)=>{l[v]||(l[v]=[]);const y=f[D];return y&&l[v].push({code:D,name:y}),l},h),{})},35383:(q,j,e)=>{"use strict";e.d(j,{LL:()=>d,LO:()=>a,NI:()=>c,Tp:()=>u,We:()=>i,b_:()=>n,gc:()=>x,ql:()=>r,wE:()=>s});var t=e(91733);class n extends t.x{static{this.type="data-hover"}}class r extends t.a{static{this.type="data-hover-clear"}}class a extends t.x{static{this.type="data-select"}}class i extends t.x{static{this.type="annotation-event"}}class x extends t.x{static{this.type="dashboard-loaded"}}class s extends t.a{static{this.type="datasource-updated-successfully"}}class c extends t.a{static{this.type="datasource-test-succeeded"}}class d extends t.a{static{this.type="datasource-test-failed"}}class u extends t.x{static{this.type="set-panel-attention"}}},89300:(q,j,e)=>{"use strict";e.d(j,{K:()=>n});var t=e(64015);class n extends t.O{}},16869:(q,j,e)=>{"use strict";e.d(j,{H:()=>m,J:()=>o});var t=e(2543),n=e.n(t),r=e(4038),a=e(3202),i=e(59457),x=e(63739),s=e(39244),c=e(16060),d=e(59141),u=e(42825);const g={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function o(p){if(!p||(0,t.isEmpty)(p)||!p.field)return E;const h=p.field,D=h.config??{},{palette:C}=p.theme.visualization;let l=D.unit,v=l&&(g[l]||l.startsWith("time:")),y=!1;if(h.type===x.PU.time&&!v){if(l="dateTimeAsSystem",v=!0,h.values&&h.values.length>1){let B=h.values[0],F=h.values[h.values.length-1];typeof B=="string"?(B=(0,i.b)(B).unix(),F=(0,i.b)(F).unix()):(B/=1e3,F/=1e3),y=Math.abs(F-B)<60}}else h.type===x.PU.boolean?(0,d.j9)(l)||(l="bool"):!l&&h.type===x.PU.string&&(l="string");const P=l?.startsWith("currency"),b=(0,d.j9)(l),S=h.type===x.PU.number,O=!v&&!P&&!b&&!(l==="locale")&&S&&D.decimals==null,R=(0,d.j_)(l||"none"),L=(0,u.jc)(h,p.theme);return(B,F)=>{const{mappings:I}=D,U=l==="string";v&&typeof B=="string"&&(B=(0,a.yT)(B).valueOf());let W=U?NaN:(0,s.t)(B),A,N,K,V,T,z;if(I&&I.length>0){const H=(0,c.Zz)(I,B);H&&(H.text!=null&&(A=H.text),H.color!=null&&(V=p.theme.visualization.getColorByName(H.color)),H.icon!=null&&(T=H.icon))}else if(h.type===x.PU.enum){if(B==null)return{text:"",numeric:NaN};const H=+B;if(D&&D.type&&D.type.enum){const{text:G,color:X}=D.type.enum;if(A=G?G[H]:`${B}`,V=X?X[H]:void 0,V==null){const k=C[H%C.length];V=p.theme.visualization.getColorByName(k)}}}if(!Number.isNaN(W)){if(A==null&&!(0,t.isBoolean)(B)){let H;O&&F!=null?(H=R(W,F,null,p.timeZone,y),H.text=+H.text+""):H=R(W,D.decimals,null,p.timeZone,y),A=H.text,K=H.suffix,N=H.prefix}if(V==null){const H=L(W);V=H.color,z=H.percent}}if(A==null&&(0,t.isArray)(B)&&(A=(0,t.join)(B,", ")),A==null&&(A=(0,t.toString)(B),A||(D.noValue?A=D.noValue:A="")),!V){const H=L(-1/0);V=H.color,z=H.percent}const w={text:A,numeric:W,prefix:N,suffix:K,color:V};return T!=null&&(w.icon=T),z!=null&&(w.percent=z),w}}function E(p){return{text:(0,t.toString)(p),numeric:(0,s.t)(p)}}function m(){return p=>({text:(0,r.oE)(p)==="other"?`${JSON.stringify(p,f())}`:`${p}`,numeric:null})}const f=()=>{const p=new WeakSet;return(h,D)=>{if(typeof D=="object"&&D!==null){if(p.has(D))return;p.add(D)}return D}}},18752:(q,j,e)=>{"use strict";e.d(j,{Hs:()=>m,Qi:()=>E,lz:()=>f,uf:()=>g});var t=e(21197),n=e(55459),r=e.n(n),a=e(84140),i=e(87190),x=e(91357),s=e(62931),c=e(64015),d=e(42825),u=e(42483);const g=new c.O(()=>[{id:s.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:p},{id:s.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:h},{id:s.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(D,C)=>(l,v,y)=>{const P=y??u.QS;return C.visualization.getColorByName(P.color)}},new o({id:s.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:D=>D.visualization.palette}),new o({id:s.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:D=>D.visualization.palette.filter(C=>(0,i.eM)(D.visualization.getColorByName(C),D.colors.background.primary)>=D.colors.contrastThreshold)}),new o({id:s.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:D=>["green","yellow","red"]}),new o({id:s.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:D=>["red","yellow","green"]}),new o({id:s.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:D=>["dark-blue","super-light-yellow","dark-red"]}),new o({id:s.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:D=>["super-light-yellow","dark-red"]}),new o({id:s.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:D=>["blue","purple"]}),new o({id:s.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:D=>["super-light-yellow","dark-blue"]}),new o({id:s.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:D=>["panel-bg","dark-blue"]}),new o({id:s.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:D=>["panel-bg","dark-red"]}),new o({id:s.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:D=>["panel-bg","dark-green"]}),new o({id:s.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:D=>["panel-bg","dark-purple"]})]);class o{constructor(C){this.id=C.id,this.name=C.name,this.description=C.description,this.getNamedColors=C.getColors,this.isContinuous=C.isContinuous,this.isByValue=C.isByValue,this.useSeriesName=C.useSeriesName}getColors(C){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===C?this.colorCache:(this.colorCache=this.getNamedColors(C).map(C.visualization.getColorByName),this.colorCacheTheme=C,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,t.Ik)(this.colorCache)),this.interpolator}getCalculator(C,l){const v=this.getColors(l);return this.isByValue?this.isContinuous?(y,P,b)=>this.getInterpolator()(P):(y,P,b)=>v[P*(v.length-1)]:this.useSeriesName?(y,P,b)=>v[Math.abs(r()(C.state?.displayName??C.name))%v.length]:(y,P,b)=>{const S=C.state?.seriesIndex??0;return v[S%v.length]}}}function E(D){return g.get(D.config.color?.mode??s.Y.Thresholds)}function m(D){return g.get(D??s.Y.Thresholds)}function f(D,C){const l=E(D);if(!l.isByValue)return{color:l.getCalculator(D,C)(0,0),threshold:u.QS,percent:1};const v=(0,d.jc)(D,C),y=D.config.color?.seriesBy??"last",b=(0,x.Nw)({field:D,reducers:[y]})[y]??0;return v(b)}function p(D,C){return()=>C.visualization.getColorByName(D.config.color?.fixedColor??s.F)}function h(D,C){return()=>{const l=C.visualization.getColorByName(D.config.color?.fixedColor??s.F),v=[l],y=6,P=10,b=35,S=35;for(let O=1;O<y;O++)v.push((0,a.A)(l).spin(O/y*P).brighten(O/y*b).toHexString()),v.push((0,a.A)(l).spin(-(O/y)*P).darken(O/y*S).toHexString());const M=D.state?.seriesIndex??0;return v[M%v.length]}}},49973:(q,j,e)=>{"use strict";e.d(j,{PI:()=>h,Pm:()=>p,XS:()=>y,Zo:()=>S,a_:()=>f,eG:()=>v,k3:()=>g,k_:()=>m,nF:()=>E,py:()=>o});var t=e(2543),n=e.n(t),r=e(94626),a=e(4038),i=e(91357),x=e(40462),s=e(38075),c=e(63739),d=e(16869),u=e(23570);const g="__series.name",o="__field.displayName",E="__field.labels",m="__calc",f="__cell_",p=25,h=O=>{const{replaceVariables:R,reduceOptions:L,timeZone:B,theme:F}=O,I=L.calcs.length?L.calcs:[i.gy.last],U=[],W=(0,x.NS)(L.fields?{id:s.Ct.byRegexp,options:L.fields}:{id:s.Ct.numeric}),A=O.data??[],N=L.limit?L.limit:p;let K=!1;for(let V=0;V<A.length&&!K;V++){const T=A[V],{timeField:z}=(0,a.KR)(T),w=new r.R(T);for(let H=0;H<T.fields.length&&!K;H++){const G=T.fields[H],X=G.getLinks;if(!W(G,T,A))continue;let k=G.config;G.state?.range&&(k={...k,...G.state?.range});let _=G.config.displayName??"";const ee=G.display??(0,d.J)({field:G,theme:O.theme,timeZone:B});if(L.values)for(let J=0;J<G.values.length;J++){G.state=C(G,U.length);const Z=M(G,J),te=ee(G.values[J]),ae=D(T,G,J,R,Z),re=l(ae,O.fieldConfig,F);if(U.push({name:"",field:k,display:{...te,title:ae,color:re??te.color},view:w,colIndex:H,rowIndex:J,getLinks:X?()=>X({valueRowIndex:J}):()=>[],hasLinks:v(G)}),U.length>=N){K=!0;break}}else{const J=(0,i.Nw)({field:G,reducers:I});for(const Z of I){const te=G.state?.scopedVars??{};te[m]={value:Z,text:Z};const ae=ee(J[Z]);_!==""?ae.title=R(_,te):ae.title=(0,u.Ct)(G,T,A),ae.percentChange=O.percentChange?(0,i.Nw)({field:G,reducers:[i.gy.diffperc]}).diffperc:void 0;let re;O.sparkline&&(re={y:T.fields[H],x:z},Z===i.gy.last?re.highlightIndex=re.y.values.length-1:Z===i.gy.first&&(re.highlightIndex=0));const ne=T.length===1?0:void 0;U.push({name:Z,field:k,display:ae,sparkline:re,view:w,colIndex:H,getLinks:X?()=>X({calculatedValue:ae,valueRowIndex:ne}):()=>[],hasLinks:v(G)})}}}}return U.length===0&&U.push(P(O)),U};function D(O,R,L,B,F){const I=R.config.displayName;if(I)return I.indexOf(f)?B(S(I),F):B(I,F);let U=[],W=0;for(const A of O.fields)if(A!==R)if(A.type===c.PU.string){const N=A.values[L]??"",K=A.display?A.display(N).text:N;K.length>0&&U.push(K)}else A.type===c.PU.number&&W++;return(W||U.length===0)&&U.push((0,u.Ct)(R,O)),U.join(" ")}function C(O,R){return{...O.state,seriesIndex:R}}function l(O,R,L){for(const B of R.overrides)if(B.matcher.id==="byName"&&B.matcher.options===O){for(const F of B.properties)if(F.id==="color"&&F.value)return L.visualization.getColorByName(F.value.fixedColor)}return null}function v(O){return O.config?.links?.length?O.config.links.length>0:!1}function y(O){let R="",L="",B="",F="";for(let I=0;I<O.length;I++){const U=O[I].display;U.text&&U.text.length>L.length&&(L=U.text),U.title&&U.title.length>R.length&&(R=U.title),U.prefix&&U.prefix.length>B.length&&(B=U.prefix),U.suffix&&U.suffix.length>F.length&&(F=U.suffix)}return{text:L,title:R,suffix:F,prefix:B}}function P(O){const R="No data",{fieldConfig:L,timeZone:B}=O,{defaults:F}=L,U=(0,d.J)({field:{type:c.PU.other,config:F},theme:O.theme,timeZone:B})(null),W=b(U,R);return{name:R,field:{...F,max:F.max??0,min:F.min??0},display:{text:W,numeric:0,color:U.color},hasLinks:!1}}function b(O,R){return!O||(0,t.isEmpty)(O.text)?R:O.text}function S(O){return O.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(R,L,B,F,I,U,W)=>`\${__data.fields[${L??F??U}]${B??I??W}}`)}function M(O,R){return O.state?.scopedVars?.__dataContext?{...O.state?.scopedVars,__dataContext:{value:{...O.state?.scopedVars?.__dataContext.value,rowIndex:R}}}:O.state?.scopedVars}},47286:(q,j,e)=>{"use strict";e.d(j,{BF:()=>M,K3:()=>L,_M:()=>R,nJ:()=>C,rJ:()=>B,vd:()=>F,we:()=>l});var t=e(2543),n=e.n(t),r=e(96540),a=e(80292),i=e(13076),x=e(7500),s=e(2049),c=e(4038),d=e(87190),u=e(91357),g=e(40462),o=e(63739),E=e(62931),m=e(46399),f=e(2567),p=e(16869),h=e(42825),D=e(79488);function C(I){let U=null,W=null;const A=[u.gy.min,u.gy.max];for(const N of I)for(const K of N.fields)if(K.type===o.PU.number){const V=(0,u.Nw)({field:K,reducers:A}),T=V[u.gy.min],z=V[u.gy.max];(U===null||T<U)&&(U=T),(W===null||z>W)&&(W=z)}return{min:U,max:W,delta:(W??0)-(U??0)}}function l(I){if(!I.data)return[];const U=I.fieldConfig;if(!U)return I.data;const W=I.fieldConfigRegistry??D.G;let A=0,N;const K=[];if(U.overrides)for(const V of U.overrides){const T=g.sJ.get(V.matcher.id);T&&K.push({match:T.get(V.matcher.options),properties:V.properties})}return I.data.map((V,T)=>{const z={...V};z.fields=z.fields.map(w=>({...w,config:(0,t.cloneDeep)(w.config),state:{...w.state}}));for(const w of z.fields){const H=w.config;w.state.scopedVars={__dataContext:{value:{data:I.data,frame:z,frameIndex:T,field:w}}};const G={field:w,data:I.data,dataFrameIndex:T,replaceVariables:I.replaceVariables,fieldConfigRegistry:W};b(H,U.defaults,G);for(const ee of K)if(ee.match(w,z,I.data))for(const J of ee.properties)P(H,J,G);let X=w.type;if(!X||X===o.PU.other){const ee=(0,c.dF)(w);ee&&(X=ee)}const{range:k,newGlobalRange:_}=v(H,w,N,I.data);if(N=_,w.state.displayName=null,w.state.seriesIndex=A,w.state.range=k,w.type=X,w.type!==o.PU.time&&A++,w.display=(0,p.J)({field:w,theme:I.theme,timeZone:I.timeZone}),w.config.unit!=="dateTimeFromNow"&&(w.display=y(w.display,2500)),w.getLinks=R(z,w,w.state.scopedVars,G.replaceVariables,I.timeZone,I.dataLinkPostProcessor),w.type===o.PU.nestedFrames)for(const ee of w.values)for(let J=0;J<ee.length;J++)for(const Z of ee[J].fields)Z.display=(0,p.J)({field:Z,theme:I.theme,timeZone:I.timeZone}),Z.state={scopedVars:{__dataContext:{value:{data:ee,frame:ee[J],frameIndex:J,field:Z}}}},Z.getLinks=R(ee[J],Z,Z.state.scopedVars,G.replaceVariables,I.timeZone,I.dataLinkPostProcessor)}return z})}function v(I,U,W,A){if(U.type!==o.PU.number||(0,t.isNumber)(I.min)&&(0,t.isNumber)(I.max))return{newGlobalRange:W};if(I.fieldMinMax){const T=(0,h.AP)(U),z=I.min??T.min,w=I.max??T.max;return{range:{min:z,max:w,delta:w-z},newGlobalRange:W}}const N=W??C(A),K=I.min??N.min,V=I.max??N.max;return{range:{min:K,max:V,delta:V-K},newGlobalRange:N}}function y(I,U=2500){const W=new Map;for(let A=-1;A<=15;A++)W.set(A,new Map);return(A,N)=>{let K=W.get(N??-1),V=K.get(A);return V||(K.size===U&&K.clear(),V=I(A,N),V.color&&(V.color=(0,d.ze)(V.color)),K.set(A,V)),V}}function P(I,U,W){const N=W.fieldConfigRegistry.getIfExists(U.id);if(!N)return;const K=N.process(U.value,W,N.settings);K==null?N.isCustom&&I.custom?(0,t.unset)(I.custom,N.path):(0,t.unset)(I,N.path):N.isCustom?(I.custom||(I.custom={}),(0,t.set)(I.custom,N.path,K)):(0,t.set)(I,N.path,K)}function b(I,U,W){I.links&&U.links&&(I.links=[...I.links,...U.links]);const A=U?.thresholds?.mode===i.Ol.Absolute&&U.thresholds?.steps.find(N=>N.value===-1/0);I.thresholds?.mode===i.Ol.Absolute&&!I.thresholds.steps.some(N=>N.value===-1/0)&&A&&(I.thresholds.steps=[A,...I.thresholds.steps]);for(const N of W.fieldConfigRegistry.list())N.isCustom&&!I.custom&&(I.custom={}),S(N.isCustom?I.custom:I,N.isCustom?U.custom:U,N,W);M(I)}function S(I,U,W,A){const N=(0,t.get)(I,W.path);if(N==null){const K=A.fieldConfigRegistry.getIfExists(W.id);if(!K)return;if(K&&K.shouldApply(A.field)){const V=K.process((0,t.get)(U,K.path),A,K.settings);V!=null&&(0,t.set)(I,K.path,V)}}}function M(I){const{thresholds:U}=I;if(I.color?I.color.mode||delete I.color:U&&(I.color={mode:E.Y.Thresholds}),I.hasOwnProperty("min")&&I.hasOwnProperty("max")&&I.min>I.max){const W=I.max;I.max=I.min,I.min=W}}const O=I=>{const{link:U,linkModel:W,dataLinkScopedVars:A,field:N,replaceVariables:K}=I;return U.internal?(0,m.u)({link:U,internalLink:U.internal,scopedVars:A,field:N,range:U.internal.range,replaceVariables:K}):W},R=(I,U,W,A,N,K)=>V=>!U.config.links||U.config.links.length===0?[]:U.config.links.map(z=>{const w=F(I,U,W),H={...W,__dataContext:w},G=(_,ee,J)=>A(_,{...H,...ee},J);V.valueRowIndex!==void 0&&!isNaN(V.valueRowIndex)?w.value.rowIndex=V.valueRowIndex:w.value.calculatedValue=V.calculatedValue;let X,k=z.onClick||!z.onBuildUrl?z.url:z.onBuildUrl({origin:U,replaceVariables:G});return k&&(k=f.I.assureBaseUrl(k.replace(/\n/g,"")),k=A(k,H,x.$m.UriEncode),k=f.I.processUrl(k)),z.onClick?X={href:k,title:A(z.title||"",H),target:z.targetBlank?"_blank":void 0,onClick:(_,ee)=>{z.onClick({origin:ee??U,e:_,replaceVariables:G})},origin:U,oneClick:z.oneClick??!1}:X={href:k,title:A(z.title||"",H),target:z.targetBlank?"_blank":void 0,origin:U,oneClick:z.oneClick??!1},(K||O)({frame:I,field:U,dataLinkScopedVars:H,replaceVariables:A,config:V,link:z,linkModel:X})}).filter(z=>!!z);function L(I){if(!I||I.length===0)return[];const U=[...I],W=(0,p.H)();for(let A=0;A<U.length;A++){const N={...U[A]},K=[...N.fields];for(let V=0;V<K.length;V++)K[V]={...K[V],display:W};U[A]={...N,fields:K}}return U}function B(I,U,W,A,N,K,V){const T=I?.fieldConfigRegistry,z=(0,r.useRef)(0),w=(0,a.A)(W?.series);return(0,r.useMemo)(()=>{if(!T||!U||!W)return;const H=W?.series;W.structureRev==null&&H&&w&&!(0,s.J3)(H,w,s.bW)&&z.current++;const G={structureRev:z.current,...W,series:l({data:H,fieldConfig:U,fieldConfigRegistry:T,replaceVariables:K,theme:N,timeZone:A,dataLinkPostProcessor:V})};return W.annotations&&W.annotations.length>0&&(G.annotations=l({data:W.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:K,theme:N,timeZone:A,dataLinkPostProcessor:V})),G},[T,U,W,w,A,N,K,V])}function F(I,U,W){return W?.__dataContext?{value:{...W.__dataContext.value}}:{value:{frame:I,field:U,data:[I]}}}},23570:(q,j,e)=>{"use strict";e.d(j,{Ct:()=>s,Fm:()=>i,Ri:()=>a,fk:()=>d,j2:()=>x});var t=e(40462),n=e(63739),r=e(55515);function a(g,o){if(g.name)return g.name;const E=[];for(const m of g.fields)if(m.type!==n.PU.time){if(E.length>1)break;E.push(s(m,g))}return E.length===1?E[0]:o===void 0&&g.fields.length>0?g.fields.filter(m=>m.type!==n.PU.time).map(m=>s(m,g)).join(", "):g.refId?`Series (${g.refId})`:`Series (${o})`}function i(g){g.forEach(o=>{o.fields.forEach(E=>{s(E,o,g)})})}function x(g,o){g.forEach(E=>{E.fields.forEach(m=>{const f={legend:!1,tooltip:!1,viz:!1,...o.defaults.custom?.hideFrom},p=m.config.custom?.hideFrom;o.overrides.forEach(h=>{if("__systemRef"in h)return;if((0,t.NS)(h.matcher)(m,E,g))for(const C of h.properties)C.id==="custom.hideFrom"&&Object.assign(f,C.value)}),m.state={...m.state,hideFrom:{...p}},m.config.custom.hideFrom=f})})}function s(g,o,E){const m=g.state?.displayName,f=!!(E&&E.length>1);if(m&&f===g.state?.multipleFrames)return m;const p=c(g,o,E);return g.state=g.state||{},g.state.displayName=p,g.state.multipleFrames=f,p}function c(g,o,E){const m=g.config?.displayName&&g.config?.displayName.length,f=!!o?.meta?.timeCompare?.isTimeShiftQuery;let p=m?g.config.displayName:g.name;if(m)return f?`${p} (comparison)`:p;if(o&&g.config?.displayNameFromDS)return f?`${g.config.displayNameFromDS} (comparison)`:g.config.displayNameFromDS;if(g.type===n.PU.time&&!g.labels)return p??n.LE;let h=[],D=!1;if(E&&E.length>1){for(let v=1;v<E.length;v++)if(E[v].name!==E[v-1].name){D=!0;break}}let C=!1,l=!1;if(D&&o?.name&&(h.push(o.name),C=!0),g.name&&g.name!==n.Bc&&h.push(g.name),g.labels&&o){let v=u(E??[o]);if(v)g.labels[v]&&(h.push(g.labels[v]),l=!0);else{let y=(0,r.h6)(g.labels);y&&(h.push(y),l=!0)}}return o&&!C&&!l&&g.name===n.Bc&&o.name&&o.name.length>0&&(h.push(o.name),C=!0),h.length?p=h.join(" "):g.name?p=g.name:p=n.Bc,p===g.name&&(p=d(g,o)),f&&(p=`${p} (comparison)`),p}function d(g,o){let E=0,m=!1;if(o)for(let f=0;f<o.fields.length;f++){const p=o.fields[f];if(g===p){if(m=!0,E>0){E++;break}}else if(g.name===p.name&&(E++,m))break}return E?`${g.name} ${E}`:g.name}function u(g){let o=null;for(let E=0;E<g.length;E++){const m=g[E];for(const f of m.fields)if(f.labels){for(const p in f.labels)if(o===null)o=p;else if(p!==o)return null}}return o}},41931:(q,j,e)=>{"use strict";e.d(j,{F:()=>i});var t=e(2543),n=e.n(t),r=e(59141),a=e(16869);function i(x){return new Proxy({},{get:(s,c)=>{let d=x.frame.fields.find(E=>c===E.name);if(!d){const E=(0,t.toNumber)(c);d=x.frame.fields[E]}if(d||(d=x.frame.fields.find(E=>c===E.config.displayName)),d||(d=x.frame.fields.find(E=>E.labels?c===E.labels.name:!1)),!d)return;const u=d.display??(0,a.J)(),g=d.values[x.rowIndex],o=u(g);return o.toString=()=>(0,r.cN)(o),o}})}},49448:(q,j,e)=>{"use strict";e.d(j,{AM:()=>r,Ch:()=>a,FM:()=>g,N7:()=>d,OU:()=>c,X4:()=>o,cz:()=>i,hL:()=>s,hS:()=>t,lG:()=>u,m0:()=>n,xT:()=>x});const t=E=>E,n=(E,m,f)=>{if(E!=null)return parseFloat(String(E))},r=(E,m,f)=>(delete m.field?.state?.displayName,c(E,m,f)),a=(E,m,f)=>E,i=(E,m,f)=>E,x=(E,m,f)=>E,s=(E,m,f)=>E,c=(E,m,f)=>E==null?E:f&&f.expandTemplateVars&&m.replaceVariables&&typeof E=="string"?m.replaceVariables(E,m.field.state.scopedVars):`${E}`,d=(E,m,f)=>E,u=(E,m,f)=>E,g=(E,m,f)=>E;var o=(E=>(E.IncludeAll="all",E.ExcludeBaseNames="exclude",E.OnlyBaseNames="only",E))(o||{})},42825:(q,j,e)=>{"use strict";e.d(j,{AP:()=>d,jc:()=>s,xg:()=>u});var t=e(2543),n=e.n(t),r=e(91357),a=e(63739),i=e(18752),x=e(42483);function s(g,o){if(g.type===a.PU.boolean)return c(g,o);const m=(0,i.Qi)(g).getCalculator(g,o),f=g.state?.range??d(g);return p=>{let h=0;p!==-1/0&&(h=(p-f.min)/f.delta,Number.isNaN(h)&&(h=0));const D=(0,x.k5)(g,p,h);return{percent:h,threshold:D,color:m(p,h,D)}}}function c(g,o){const E={color:o.visualization.getColorByName("green"),percent:1,threshold:void 0},m={color:o.visualization.getColorByName("red"),percent:0,threshold:void 0},f=(0,i.Qi)(g);if(f.isContinuous&&f.getColors){const p=f.getColors(o);E.color=p[p.length-1],m.color=p[0]}return p=>p?E:m}function d(g){if(g.type!==a.PU.number)return{min:0,max:100,delta:100};let o=g.config.min,E=g.config.max;if(!(0,t.isNumber)(o)||!(0,t.isNumber)(E))if(g.values&&g.values.length){const m=(0,r.Nw)({field:g,reducers:[r.gy.min,r.gy.max]});(0,t.isNumber)(o)||(o=m[r.gy.min]),(0,t.isNumber)(E)||(E=m[r.gy.max])}else o=0,E=100;return{min:o,max:E,delta:E-o}}function u(g,o){const{config:E}=g;let{min:m,max:f}=E;return(0,t.isNumber)(m)&&(0,t.isNumber)(f)?E:o||!g.state?.range?{...E,...d(g)}:{...E,...g.state.range}}},79488:(q,j,e)=>{"use strict";e.d(j,{D:()=>a,G:()=>r});var t=e(64015),n=e(89300);const r=new n.K,a=new t.O},42483:(q,j,e)=>{"use strict";e.d(j,{QS:()=>r,RU:()=>x,k5:()=>i,yQ:()=>a});var t=e(62931),n=e(99116);const r={value:0,color:t.F};function a(s,c){if(!c||c.length===0)return r;let d=c[0];for(const u of c)if(s>=u.value)d=u;else break;return d}function i(s,c,d){const{thresholds:u}=s.config;return u?.mode===n.O.Percentage?a(d*100,u?.steps):a(c,u?.steps)}function x(s){return s.sort((c,d)=>c.value-d.value)}},33234:(q,j,e)=>{"use strict";e.r(j),e.d(j,{AbstractLabelOperator:()=>nn.D_,AlertState:()=>pn.O,AnnotationChangeEvent:()=>v.We,AnnotationEventFieldSource:()=>$t.V,AppEvents:()=>cn.r1,AppPlugin:()=>gn.hX,ArrayDataFrame:()=>d.f,ArrayVector:()=>Ct,BinaryOperationID:()=>he.k,BusEventBase:()=>C.a,BusEventWithPayload:()=>C.x,ByNamesMatcherMode:()=>Le.PP,CSVHeaderStyle:()=>Z.F7,CSVReader:()=>Z.i8,CircularDataFrame:()=>ut.x,CircularVector:()=>Qt.$,CoreApp:()=>gn.Jk,CustomVariableSupport:()=>xn.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>L.Pm,DEFAULT_SAML_NAME:()=>zt.En,DashboardCursorSync:()=>on.y,DashboardLoadedEvent:()=>v.gc,DataFrameType:()=>Yn.m,DataFrameView:()=>n.R,DataHoverClearEvent:()=>v.ql,DataHoverEvent:()=>v.b_,DataLinkBuiltInVars:()=>K.c,DataLinkConfigOrigin:()=>bn.x0,DataQueryErrorType:()=>qt.v2,DataSelectEvent:()=>v.LO,DataSourceApi:()=>qt.mA,DataSourcePlugin:()=>qt.tD,DataSourcePluginContextProvider:()=>ht.p,DataSourceTestFailed:()=>v.LL,DataSourceTestSucceeded:()=>v.NI,DataSourceUpdatedSuccessfully:()=>v.wE,DataSourceVariableSupport:()=>xn.ZV,DataTopic:()=>E.QR,DataTransformerID:()=>Qe.F,DefaultTimeZone:()=>es.lE,DocsId:()=>V.f,EventBusSrv:()=>l.o,ExploreMode:()=>qt.ZF,FALLBACK_COLOR:()=>Ot.F,FeatureState:()=>gn.Ay,FieldCache:()=>r.L,FieldColorModeId:()=>Ot.Y,FieldConfigEditorBuilder:()=>U.bk,FieldConfigOptionsRegistry:()=>P.K,FieldConfigProperty:()=>Tn.uo,FieldMatcherID:()=>we.Ct,FieldNamePickerBaseNameMode:()=>I.X4,FieldType:()=>zn.PU,FrameGeometrySourceMode:()=>E.aG,FrameMatcherID:()=>we.jR,GAUGE_DEFAULT_MAXIMUM:()=>zt.d1,GAUGE_DEFAULT_MINIMUM:()=>zt.tw,GrafanaPlugin:()=>Bt.Ud,GrafanaThemeType:()=>_n.I,HttpRequestMethod:()=>In.DO,ISO_8601:()=>Oe.mt,InternalTimeZones:()=>nt.g$,LanguageProvider:()=>qt.Is,LayoutModes:()=>Re.R,LegacyGraphHoverClearEvent:()=>cn.Tq,LegacyGraphHoverEvent:()=>cn.kb,LegacyMappingType:()=>H.An,LiveChannelConnectionState:()=>dt.ZF,LiveChannelEventType:()=>dt.o4,LiveChannelScope:()=>dt.qD,LiveChannelType:()=>dt.os,LoadingState:()=>St.Gu,LocalStorageValueProvider:()=>be.b,LogLevel:()=>Lt.$b,LogRowContextQueryDirection:()=>Lt.ZF,LogSortOrderChangeEvent:()=>Lt.Df,LogsDedupDescription:()=>Lt._C,LogsDedupStrategy:()=>E.fY,LogsMetaKind:()=>Lt.tG,LogsSortOrder:()=>E.uH,LogsVolumeType:()=>Lt.Aj,MISSING_VALUE:()=>a.p,MappingType:()=>ps.d,MatcherID:()=>we.cV,MutableDataFrame:()=>a.k,NodeGraphDataFrameFieldNames:()=>de.u,NullValueMode:()=>St.UW,NumericLogLevel:()=>Lt.s5,OneClickMode:()=>bn.yd,OrgRole:()=>jn.X,PageLayoutType:()=>ls.k,PanelEvents:()=>cn.ee,PanelOptionsEditorBuilder:()=>U.pv,PanelPlugin:()=>at.m,PluginContextProvider:()=>st.a,PluginErrorCode:()=>Bt.ZK,PluginExtensionPoints:()=>lt.S,PluginExtensionTypes:()=>lt.u,PluginIncludeType:()=>Bt.ib,PluginLoadingStrategy:()=>Bt.xf,PluginSignatureStatus:()=>Bt.Ac,PluginSignatureType:()=>Bt.kv,PluginState:()=>Bt.pn,PluginType:()=>Bt.QE,ReducerID:()=>$e.gy,Registry:()=>_.O,SetPanelAttentionEvent:()=>v.Tp,SpecialValue:()=>wn.N,SpecialValueMatch:()=>ps.W,StandardVariableSupport:()=>xn.J$,StreamingDataFrame:()=>c.k9,StreamingFrameAction:()=>c.Kh,SupplementaryQueryType:()=>Lt.cF,SupportedTransformationType:()=>bn.CC,SystemDateFormatsState:()=>Je.JE,TIME_FORMAT:()=>es.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>zn.aI,TIME_SERIES_TIME_FIELD_NAME:()=>zn.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>zn.Bc,ThemeContext:()=>ge.D,ThresholdsMode:()=>Ye.O,TransformationApplicabilityLevels:()=>wn.M,TransformerCategory:()=>Te.m,UnaryOperationID:()=>oe._,VAR_CALC:()=>L.k_,VAR_CELL_PREFIX:()=>L.a_,VAR_FIELD_LABELS:()=>L.nF,VAR_FIELD_NAME:()=>L.py,VAR_SERIES_NAME:()=>L.k3,ValueMatcherID:()=>we.Js,VariableHide:()=>Rt.zL,VariableOrigin:()=>bn.$0,VariableRefresh:()=>Rt.CO,VariableSort:()=>Rt.ZG,VariableSuggestionsScope:()=>bn.uP,VariableSupportBase:()=>xn.xi,VariableSupportType:()=>xn.Qz,VisualizationSuggestionScore:()=>Jt.nQ,VisualizationSuggestionsBuilder:()=>Jt.v2,VisualizationSuggestionsListAppender:()=>Jt.NV,VizOrientation:()=>Jt.wV,addDurationToDate:()=>tt.Ri,addRow:()=>s.uY,amendTable:()=>t.c,anySeriesWithTimeField:()=>s.tP,anyToNumber:()=>z.t,applyFieldOverrides:()=>S.we,applyNullInsertThreshold:()=>Ke.M,applyRawFieldOverrides:()=>S.K3,arrayToDataFrame:()=>d.I,arrayUtils:()=>Pe,availableIconsIndex:()=>vn.az,binaryOperators:()=>he.b,booleanOverrideProcessor:()=>I.FM,booleanValueFormatter:()=>xe.Qc,buildHistogram:()=>Me.p3,cacheFieldDisplayNames:()=>O.Fm,classicColors:()=>ne,closestIdx:()=>c.Ls,colorManipulator:()=>fe.MV,compareArrayValues:()=>g.J3,compareDataFrameStructures:()=>g.bW,containsSearchFilter:()=>G.E,contentTypeOptions:()=>In.Ur,convertOldAngularValueMappings:()=>H.bh,createDataFrame:()=>i.EI,createDimension:()=>x.r4,createFieldConfigRegistry:()=>ze.O,createTheme:()=>ie.a,dataFrameFromJSON:()=>u.or,dataFrameToJSON:()=>u.Nw,dataLinksOverrideProcessor:()=>I.Ch,dateMath:()=>je,dateTime:()=>Oe.KQ,dateTimeAsMoment:()=>Oe.AN,dateTimeForTimeZone:()=>Oe.oZ,dateTimeFormat:()=>Be.LE,dateTimeFormatISO:()=>Be.M7,dateTimeFormatTimeAgo:()=>Be.fq,dateTimeFormatWithAbbrevation:()=>Be._Q,dateTimeParse:()=>Ze.b,decodeFieldValueEntities:()=>u.t,decodeFieldValueEnums:()=>u.EL,defaultActionConfig:()=>In.mx,defaultCalcs:()=>$e.C6,deprecationWarning:()=>J.l,displayNameOverrideProcessor:()=>I.AM,doStandardCalcs:()=>$e.H3,durationToMilliseconds:()=>tt.WT,ensureTimeField:()=>De.ks,escapeRegex:()=>m.$f,escapeStringForRegex:()=>m.jD,eventFactory:()=>D.R,fieldColorModeRegistry:()=>y.uf,fieldMatchers:()=>Xe.sJ,fieldReducers:()=>$e.AS,filterFieldConfigOverrides:()=>yt.aW,findCommonLabels:()=>te.yO,findHighlightChunksInText:()=>f.Oq,findMatchesInText:()=>f.bs,findUniqueLabels:()=>te.s6,fixCellTemplateExpressions:()=>L.Zo,formatLabels:()=>te.h6,formattedValueToString:()=>xe.cN,frameMatchers:()=>Xe.RE,getActiveThreshold:()=>b.yQ,getAllValuesFromDimension:()=>x.Km,getBuiltInThemes:()=>ve.k,getColumnFromDimension:()=>x.P4,getColumnsFromDimension:()=>x.g6,getDataFrameRow:()=>i.Yn,getDataSourceRef:()=>ee.p$,getDataSourceUID:()=>ee.Iz,getDefaultRelativeTimeRange:()=>es.Cn,getDefaultTimeRange:()=>es.E2,getDimensionByName:()=>x.xB,getDisplayProcessor:()=>B.J,getDisplayValueAlignmentFactors:()=>L.XS,getFieldColorMode:()=>y.Hs,getFieldColorModeForField:()=>y.Qi,getFieldConfigWithMinMax:()=>R.xg,getFieldDataContextClone:()=>S.vd,getFieldDisplayName:()=>O.Ct,getFieldDisplayValues:()=>L.PI,getFieldDisplayValuesProxy:()=>M.F,getFieldMatcher:()=>Xe.NS,getFieldSeriesColor:()=>y.lz,getFieldTypeFromValue:()=>i.oE,getFlotPairs:()=>W.R,getFlotPairsConstant:()=>W.r,getFrameDisplayName:()=>O.Ri,getFrameMatchers:()=>Xe.Dq,getHistogramFields:()=>Me.ix,getLinksSupplier:()=>S._M,getLocale:()=>Oe.JK,getLocaleData:()=>Oe.XN,getMinMaxAndDelta:()=>R.AP,getNextRefId:()=>o.M,getPanelOptionsWithDefaults:()=>yt.F,getProcessedDataFrames:()=>i.Bt,getRawDisplayProcessor:()=>B.H,getRowUniqueId:()=>s.t9,getScaleCalculator:()=>R.jc,getSearchFilterScopedVar:()=>G.c,getSeriesTimeStep:()=>ce,getThemeById:()=>ve.g,getTimeField:()=>i.KR,getTimeZone:()=>ke.O,getTimeZoneGroups:()=>nt.U3,getTimeZoneInfo:()=>nt.QZ,getTimeZones:()=>nt.P3,getUniqueFieldName:()=>O.fk,getValueFormat:()=>xe.j_,getValueFormats:()=>xe.Ke,getValueFormatterIndex:()=>xe.uH,getValueFromDimension:()=>x.WK,getValueMatcher:()=>Xe.kK,getWeekdayIndex:()=>Oe.xQ,getWeekdayIndexByEnglishName:()=>Oe.pp,getZone:()=>nt.HD,guessDecimals:()=>ae.E,guessFieldTypeForField:()=>i.dF,guessFieldTypeFromNameAndValue:()=>i.by,guessFieldTypeFromValue:()=>i.HW,guessFieldTypes:()=>i.XQ,hasLinks:()=>L.eG,hasLogsContextSupport:()=>Lt.Ol,hasLogsContextUiSupport:()=>Lt.wj,hasMsResolution:()=>le,hasQueryExportSupport:()=>nn.Ee,hasQueryImportSupport:()=>nn.FL,hasQueryModificationSupport:()=>Lt._0,hasSupplementaryQuerySupport:()=>Lt.Nc,hasTimeField:()=>s.S1,hasToggleableQueryFiltersSupport:()=>Lt.FP,histogramBucketSizes:()=>Me.rW,histogramFieldInfo:()=>Me.Rt,histogramFieldsToFrame:()=>Me.cg,histogramFrameBucketMaxFieldName:()=>Me.dA,histogramFrameBucketMinFieldName:()=>Me.d$,histogramTransformer:()=>Me.OA,httpMethodOptions:()=>In.ki,identityOverrideProcessor:()=>I.hS,incrRound:()=>Me.ZU,incrRoundDn:()=>Me.rs,incrRoundUp:()=>Me.Uh,intervalToAbbreviatedDurationString:()=>tt.dU,isBooleanUnit:()=>xe.j9,isCustomFieldProp:()=>yt.TQ,isDataFrame:()=>i.ci,isDataFrameWithValue:()=>i.LI,isDataSourcePluginContext:()=>Gt.S,isDataSourceRef:()=>ee.fN,isDateTime:()=>Oe.Ar,isDateTimeInput:()=>Oe.u8,isEmptyObject:()=>re.R,isHistogramFrameBucketMaxFieldName:()=>Me.H1,isHistogramFrameBucketMinFieldName:()=>Me.NX,isIconName:()=>vn.n6,isLikelyAscendingVector:()=>Ge.g2,isLiveChannelJoinEvent:()=>dt.Cz,isLiveChannelLeaveEvent:()=>dt.jQ,isLiveChannelMessageEvent:()=>dt.Z7,isLiveChannelStatusEvent:()=>dt.ew,isObject:()=>St.Gv,isReducerID:()=>$e.Em,isStandardFieldProp:()=>yt.nx,isSystemOverride:()=>Tn.Ow,isSystemOverrideWithRef:()=>Tn.ZW,isTableData:()=>i.pH,isTimeSeriesField:()=>s.hF,isTimeSeriesFrame:()=>s.aH,isTimeSeriesFrames:()=>s.jq,isTruthy:()=>St.zz,isUnsignedPluginSignature:()=>un.x,isValidDate:()=>tt.vd,isValidDuration:()=>tt.di,isValidGoDuration:()=>tt.pp,isValidGrafanaDuration:()=>tt.V3,isValidLiveChannelAddress:()=>dt.aj,localTimeFormat:()=>Je.Od,locale:()=>xe.Hg,locationUtil:()=>A.I,makeClassES5Compatible:()=>T.Y,makeTimeRange:()=>es.HW,mapInternalLinkToExplore:()=>K.u,matchAllLabels:()=>te._p,matchPluginId:()=>k._,monacoLanguageRegistry:()=>Ne.l,nullToValue:()=>Ie.C,numberOverrideProcessor:()=>I.m0,objRemoveUndefined:()=>re.w,onUpdateDatasourceJsonDataOption:()=>ee.PG,onUpdateDatasourceJsonDataOptionChecked:()=>ee.EX,onUpdateDatasourceJsonDataOptionSelect:()=>ee.BD,onUpdateDatasourceOption:()=>ee.zX,onUpdateDatasourceResetOption:()=>ee.yV,onUpdateDatasourceSecureJsonDataOption:()=>ee.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>ee.wY,outerJoinDataFrames:()=>Ge.Fd,parseDuration:()=>tt.E9,parseFlags:()=>f.bQ,parseLabels:()=>te.Xy,parseLiveChannelAddress:()=>dt.DG,patchArrayVectorProrotypeMethods:()=>On.V,preProcessPanelData:()=>i.N$,preferredVisualizationTypes:()=>St.Nx,rangeUtil:()=>Ve,readCSV:()=>Z.Jh,reduceField:()=>$e.Nw,renderLegendFormat:()=>X.j,renderMarkdown:()=>p.G,renderTextPanelMarkdown:()=>p.P,restoreCustomOverrideRules:()=>yt.H9,reverseDataFrame:()=>i.q7,reverseParseDuration:()=>tt.Q7,roundDecimals:()=>ae.h,scaledUnits:()=>xe.yP,scopeFilterOperatorMap:()=>Pt.n,selectOverrideProcessor:()=>I.hL,serializeStateToUrlParam:()=>N.Pp,setLocale:()=>Oe.xS,setTimeZoneResolver:()=>ke.G,setWeekStart:()=>Oe.$D,shallowCompare:()=>g.ab,simpleCountUnit:()=>xe.UR,sortDataFrame:()=>i.ES,sortThresholds:()=>b.RU,standardEditorsRegistry:()=>F.D,standardFieldConfigEditorRegistry:()=>F.G,standardTransformers:()=>Se.c,standardTransformersRegistry:()=>Te.h,store:()=>Ee.M,stringFormater:()=>xe.cH,stringOverrideProcessor:()=>I.OU,stringStartsAsRegEx:()=>m.AP,stringToJsRegex:()=>m.dO,stringToMs:()=>m.dc,systemDateFormats:()=>Je.WC,textUtil:()=>h.sQ,thresholdsOverrideProcessor:()=>I.N7,timeZoneAbbrevation:()=>Be.jw,timeZoneFormatUserFriendly:()=>nt.le,toCSV:()=>Z._O,toDataFrame:()=>i.Vc,toDataFrameDTO:()=>i.Kl,toDuration:()=>Oe.Ah,toFilteredDataFrameDTO:()=>i.By,toFixed:()=>xe.Mg,toFixedScaled:()=>xe.gZ,toFixedUnit:()=>xe.G8,toFloatOrUndefined:()=>m.$D,toIconName:()=>vn.Uo,toIntegerOrUndefined:()=>m.vb,toLegacyResponseData:()=>i.w3,toLiveChannelId:()=>dt.Qp,toNumberString:()=>m.kT,toOption:()=>me.z,toPascalCase:()=>m.MX,toURLRange:()=>N.sQ,toUtc:()=>Oe.yT,transformDataFrame:()=>Fe.m,trimTable:()=>t.F,unEscapeStringFromRegex:()=>m.xb,unaryOperators:()=>oe.j,unitOverrideProcessor:()=>I.lG,updateDatasourcePluginJsonDataOption:()=>ee.lO,updateDatasourcePluginOption:()=>ee.pN,updateDatasourcePluginResetOption:()=>ee.QP,updateDatasourcePluginSecureJsonDataOption:()=>ee.wp,urlUtil:()=>N.kM,useFieldOverrides:()=>S.rJ,usePluginContext:()=>It.Q,userHasAllPermissions:()=>Et.Fj,userHasAnyPermission:()=>Et.jW,userHasPermission:()=>Et.ZU,userHasPermissionInMetadata:()=>Et.T6,validateFieldConfig:()=>S.BF,valueMappingsOverrideProcessor:()=>I.xT,valueMatchers:()=>Xe.hI,vectorator:()=>an.E,withLoadingIndicator:()=>w.k});var t=e(63884),n=e(94626),r=e(38790),a=e(36669),i=e(4038),x=e(16557),s=e(67555),c=e(59765),d=e(75906),u=e(26701),g=e(2049),o=e(44099),E=e(7500),m=e(67793),f=e(37535),p=e(60997),h=e(84099),D=e(98436),C=e(91733),l=e(10112),v=e(35383),y=e(18752),P=e(89300),b=e(42483),S=e(47286),M=e(41931),O=e(23570),R=e(42825),L=e(49973),B=e(16869),F=e(79488),I=e(49448),U=e(14781),W=e(42344),A=e(2567),N=e(93407),K=e(46399),V=e(14211),T=e(26023),z=e(39244),w=e(78137),H=e(16060),G=e(34227),X=e(52733),k=e(6989),_=e(64015),ee=e(61809),J=e(33262),Z=e(60590),te=e(55515),ae=e(12936),re=e(34923);const ne=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],ce=Ut=>{let Wt,gt,Vt=Number.MAX_VALUE;for(let Ft=0;Ft<Ut.values.length;Ft++){const dn=Ut.values[Ft];if(Wt!==void 0){const Cn=dn-Wt;gt===void 0&&(Vt=Cn),Cn<Vt&&(Vt=Cn)}Wt=dn}return Vt},le=Ut=>{for(let Wt=0;Wt<Ut.values.length;Wt++){const gt=Ut.values[Wt];if(gt!=null){const Vt=gt.toString();if(Vt.length===13&&Vt%1e3!==0)return!0}}return!1};var he=e(16268),oe=e(90808),de=e(12462),me=e(35095),Pe=e(6562),Ee=e(69199),be=e(33870),Se=e(36596),Xe=e(40462),Qe=e(66564),we=e(38075),$e=e(91357),Fe=e(54092),Te=e(48279),Le=e(93682),Ge=e(77230),Me=e(27844),De=e(17177),Ke=e(66380),Ie=e(54430),Ne=e(48913),ie=e(10468),ve=e(71985),fe=e(87190),ge=e(15580),xe=e(59141),je=e(30468),Ve=e(59577),ke=e(35023),Oe=e(3202),nt=e(58064),Je=e(90168),Be=e(88090),Ze=e(59457),tt=e(66102),Re=e(39010),at=e(68256),yt=e(27999),ze=e(76346),st=e(86360),ht=e(83821),It=e(79748),Gt=e(35617),un=e(3021),vn=e(5005),pn=e(91323),xn=e(50471),cn=e(52718),jn=e(83827),_n=e(17599),Ot=e(62931),Rt=e(14964),Ye=e(99116),dt=e(17162),lt=e(93253),Pt=e(42853),Bt=e(41007),Jt=e(21288),qt=e(29997),gn=e(16753),On=e(8503),Tn=e(62321),wn=e(19844),ps=e(65329),es=e(55801),ls=e(80426),Lt=e(18163),$t=e(59764),nn=e(58462),on=e(74958),bn=e(47180),In=e(63786),Yn=e(47370),zn=e(63739),St=e(8392),zt=e(8919),Qt=e(54850),an=e(98486);const mn="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let yn=!1;class Ct extends Array{get buffer(){return this}set buffer(Wt){this.length=0;const gt=Wt?.length;if(gt){let Vt=65e3,Ft=Math.ceil(gt/Vt);for(let dn=0;dn<Ft;dn++)this.push.apply(this,Wt.slice(dn*Vt,(dn+1)*Vt))}}constructor(Wt){super(),this.buffer=Wt??[],yn||(console.warn(mn),yn=!0)}toJSON(){return[...this]}}var ut=e(24616),Et=e(7553)},68256:(q,j,e)=>{"use strict";e.d(j,{m:()=>c});var t=e(2543),n=e.n(t),r=e(89300),a=e(41007),i=e(14781),x=e(33262),s=e(76346);class c extends a.Ud{constructor(u){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new r.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=u}get defaults(){let u=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const g=new i.pv;this.optionsSupplier(g,{data:[]});for(const o of g.getItems())o.defaultValue!=null&&(0,t.set)(u,o.path,o.defaultValue)}return u}get fieldConfigDefaults(){const u=this._fieldConfigDefaults.defaults;u.custom={};for(const g of this.fieldConfigRegistry.list())g.defaultValue!==void 0&&(0,t.set)(u,g.id,g.defaultValue);return{defaults:{...u},overrides:this._fieldConfigDefaults.overrides}}setDefaults(u){return(0,x.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=u,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(u){return(0,x.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=u,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(u){return this.onPanelMigration=u,this}setPanelChangeHandler(u){return this.onPanelTypeChanged=u,this}setPanelOptions(u){return this.optionsSupplier=u,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(u){return this.dataSupport={...this.dataSupport,...u},this}useFieldConfig(u={}){return this._initConfigRegistry=()=>(0,s.O)(u,this.meta.name),this}setSuggestionsSupplier(u){return this.suggestionsSupplier=u,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(u){return this.meta.id===u}}},27999:(q,j,e)=>{"use strict";e.d(j,{F:()=>s,H9:()=>E,TQ:()=>m,aW:()=>d,nx:()=>f});var t=e(2543),n=e.n(t),r=e(18752),a=e(62931),i=e(62321),x=e(99116);function s({plugin:p,currentOptions:h,currentFieldConfig:D,isAfterPluginChange:C}){const l=(0,t.mergeWith)({},p.defaults,h||{},(P,b)=>{if((0,t.isArray)(b))return b}),v=c(D,p),y=g(p,v,C);return{options:l,fieldConfig:y}}function c(p,h){const D=h.fieldConfigDefaults,C={defaults:(0,t.mergeWith)({},D.defaults,p?p.defaults:{},(l,v)=>{if((0,t.isArray)(v))return v}),overrides:p?.overrides??[]};u(C.defaults,"",h.fieldConfigRegistry),C.defaults.thresholds&&o(C.defaults.thresholds),C.overrides=d(C.overrides,l=>h.fieldConfigRegistry.getIfExists(l.id)!==void 0);for(const l of C.overrides)for(const v of l.properties)v.id==="thresholds"&&o(v.value);return C}function d(p,h){return p.map(D=>{const C=D.properties.filter(h);return{...D,properties:C}})}function u(p,h,D){let C=!1;for(const[l,v]of Object.entries(p)){const y=`${h}${l}`,P=!!D.getIfExists(y);if(P){C=!0;continue}(0,t.isArray)(v)||!(0,t.isObject)(v)?P||(0,t.unset)(p,l):u(v,`${y}.`,D)||(0,t.unset)(p,l)}return C}function g(p,h,D){if(!D)return h;const C=p.fieldConfigRegistry.getIfExists(i.uo.Color);if(C&&C.settings){const l=C.settings,v=r.uf.getIfExists(h.defaults.color?.mode);if(!l.byValueSupport&&(!v||v.isByValue))return h.defaults.color={mode:a.Y.PaletteClassic},h;if(l.byValueSupport&&l.preferThresholdsMode&&v?.id!==a.Y.Fixed&&(!v||!v.isByValue))return h.defaults.color={mode:a.Y.Thresholds},h;if(l.bySeriesSupport&&v?.isByValue)return h.defaults.color={mode:a.Y.PaletteClassic},h}return h}function o(p){p.mode||(p.mode=x.O.Absolute),p.steps?p.steps.length&&(p.steps[0].value=-1/0):p.steps=[]}function E(p,h){const D={defaults:{...p.defaults,custom:h.defaults.custom},overrides:[...p.overrides]};for(const C of h.overrides)for(const l of C.properties)if(m(l)){const v=D.overrides.find(y=>(0,t.isEqual)(y.matcher,C.matcher));v?v!==C&&v.properties.push(l):D.overrides.push(C)}return D}function m(p){return p.id.startsWith("custom.")}function f(p){return!m(p)}},76346:(q,j,e)=>{"use strict";e.d(j,{O:()=>a});var t=e(89300),n=e(79488),r=e(14781);function a(x={},s){const c=new t.K,d=n.G.list(),u={};if(x.useCustomConfig){const g=new r.bk;x.useCustomConfig(g);for(const o of g.getRegistry().list())if(o.isCustom=!0,o.id="custom."+o.id,i(o,d)){const E=u[o.category[0]]??[];E.push(o),u[o.category[0]]=E}else c.register(o)}for(let g of d){const o=g.id;if(!(x.disableStandardOptions&&x.disableStandardOptions.indexOf(o)>-1)){if(x.standardOptions){const E=x.standardOptions[o]?.hideFromDefaults,m=x.standardOptions[o]?.defaultValue,f=x.standardOptions[o]?.settings;E!==void 0&&(g={...g,hideFromDefaults:E}),m&&(g={...g,defaultValue:m}),f&&(g={...g,settings:g.settings?{...g.settings,...f}:f})}if(c.register(g),g.category&&u[g.category[0]])for(let E of u[g.category[0]])c.register(E)}}for(const g of c.list())if(g.path.indexOf("[")>0)throw new Error(`[${s}] Field config paths do not support arrays: ${g.id}`);return c}function i(x,s){return!!s.find(c=>x.category&&c.category&&x.category[0]===c.category[0])}},44099:(q,j,e)=>{"use strict";e.d(j,{M:()=>t});const t=r=>{for(let a=0;;a++){const i=n(a);if(!r.some(x=>x.refId===i))return i}};function n(r){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return r<a.length?a[r]:n(Math.floor(r/a.length)-1)+a[r%a.length]}},63884:(q,j,e)=>{"use strict";e.d(j,{F:()=>r,c:()=>n});var t=e(59765);function n(a,i){let[x]=a,[s]=i,c=x.length,d=x[0],u=x[c-1],g=s.length,o=s[0],E=s[g-1],m;if(c)if(g){if(o>u)m=a.map((f,p)=>a[p].concat(i[p]));else if(E<d)m=i.map((f,p)=>i[p].concat(a[p]));else if(o<=d&&E>=u)m=i;else if(o>d&&E<u){let f=(0,t.Ls)(o,x);f=x[f]<o?f+1:f;let p=(0,t.Ls)(E,x);p=x[p]>E?p-1:p,m=a.map((h,D)=>a[D].slice(0,f).concat(i[D]).concat(a[D].slice(p+1)))}else if(o>=d){let f=(0,t.Ls)(o,x);f=x[f]<o?f-1:f,m=a.map((p,h)=>a[h].slice(0,f).concat(i[h]))}else if(E>=d){let f=(0,t.Ls)(E,x);f=x[f]<E?f:f+1,m=i.map((p,h)=>i[h].concat(a[h].slice(f)))}}else m=a;else g?m=i:m=[[]];return m}function r(a,i,x){let[s,...c]=a,d,u;return s[0]<i&&(d=(0,t.Ls)(i,s),s[d]<i&&d++),s[s.length-1]>x&&(u=(0,t.Ls)(x,s),s[u]>x&&u--),(d!=null||u!=null)&&(s=s.slice(d??0,u),c=c.map(g=>g.slice(d??0,u))),[s,...c]}},60997:(q,j,e)=>{"use strict";e.d(j,{G:()=>x,P:()=>s});var t=e(60023),n=e(33836),r=e(84099);let a=!1;const i={pedantic:!1,gfm:!0,breaks:!1};function x(c,d){a||(t.xI.use((0,n.z)()),t.xI.setOptions({...i}),a=!0);let u;d?.breaks&&(u={...i,breaks:!0});const g=(0,t.xI)(c||"",u);if(typeof g!="string")throw new Error("Failed to process markdown synchronously.");return d?.noSanitize?g:(0,r.G$)(g)}function s(c,d){a||(t.xI.use((0,n.z)()),t.xI.setOptions({...i}),a=!0);const u=(0,t.xI)(c||"");if(typeof u!="string")throw new Error("Failed to process markdown synchronously.");return d?.noSanitize?u:(0,r.G$)(u)}},37535:(q,j,e)=>{"use strict";e.d(j,{Oq:()=>t,bQ:()=>x,bs:()=>r});function t({searchWords:s,textToHighlight:c}){const d=[];for(const u of s)typeof u=="string"&&d.push(...r(c,u));return d}const n=s=>s.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function r(s,c){if(!s||!c)return[];const d=[],{cleaned:u,flags:g}=x(n(c));let o;try{o=new RegExp(`(?:${u})`,g)}catch{return d}return s.replace(o,(E,...m)=>{if(E){const f=m[m.length-2];d.push({text:E,start:f,length:E.length,end:f+E.length})}return""}),d}const a="-",i=/\(\?([ims-]+)\)/g;function x(s){const c=new Set(["g"]);return{cleaned:s.replace(i,(u,g)=>{const o=g.startsWith(a);for(let E=0;E<g.length;++E){const m=g.charAt(E);o||g.charAt(E-1)===a?c.delete(m):m!==a&&c.add(m)}return""}),flags:Array.from(c).join("")}}},91357:(q,j,e)=>{"use strict";e.d(j,{AS:()=>d,C6:()=>g,Em:()=>s,H3:()=>o,Nw:()=>c,gy:()=>x});var t=e(2543),n=e.n(t),r=e(8392),a=e(63739),i=e(64015),x=(y=>(y.sum="sum",y.max="max",y.min="min",y.logmin="logmin",y.mean="mean",y.variance="variance",y.stdDev="stdDev",y.last="last",y.median="median",y.first="first",y.count="count",y.range="range",y.diff="diff",y.diffperc="diffperc",y.delta="delta",y.step="step",y.firstNotNull="firstNotNull",y.lastNotNull="lastNotNull",y.changeCount="changeCount",y.distinctCount="distinctCount",y.allIsZero="allIsZero",y.allIsNull="allIsNull",y.allValues="allValues",y.uniqueValues="uniqueValues",y.p1="p1",y.p2="p2",y.p3="p3",y.p4="p4",y.p5="p5",y.p6="p6",y.p7="p7",y.p8="p8",y.p9="p9",y.p10="p10",y.p11="p11",y.p12="p12",y.p13="p13",y.p14="p14",y.p15="p15",y.p16="p16",y.p17="p17",y.p18="p18",y.p19="p19",y.p20="p20",y.p21="p21",y.p22="p22",y.p23="p23",y.p24="p24",y.p25="p25",y.p26="p26",y.p27="p27",y.p28="p28",y.p29="p29",y.p30="p30",y.p31="p31",y.p32="p32",y.p33="p33",y.p34="p34",y.p35="p35",y.p36="p36",y.p37="p37",y.p38="p38",y.p39="p39",y.p40="p40",y.p41="p41",y.p42="p42",y.p43="p43",y.p44="p44",y.p45="p45",y.p46="p46",y.p47="p47",y.p48="p48",y.p49="p49",y.p50="p50",y.p51="p51",y.p52="p52",y.p53="p53",y.p54="p54",y.p55="p55",y.p56="p56",y.p57="p57",y.p58="p58",y.p59="p59",y.p60="p60",y.p61="p61",y.p62="p62",y.p63="p63",y.p64="p64",y.p65="p65",y.p66="p66",y.p67="p67",y.p68="p68",y.p69="p69",y.p70="p70",y.p71="p71",y.p72="p72",y.p73="p73",y.p74="p74",y.p75="p75",y.p76="p76",y.p77="p77",y.p78="p78",y.p79="p79",y.p80="p80",y.p81="p81",y.p82="p82",y.p83="p83",y.p84="p84",y.p85="p85",y.p86="p86",y.p87="p87",y.p88="p88",y.p89="p89",y.p90="p90",y.p91="p91",y.p92="p92",y.p93="p93",y.p94="p94",y.p95="p95",y.p96="p96",y.p97="p97",y.p98="p98",y.p99="p99",y))(x||{});function s(y){return Object.keys(x).includes(y)}function c(y){const{field:P,reducers:b}=y;if(!P||!b||b.length<1)return{};if(P.state?.calcs){const F=[];for(const I of b)P.state.calcs.hasOwnProperty(I)||F.push(I);if(F.length<1)return{...P.state.calcs}}P.state||(P.state={});const S=d.list(b),M=P.values;if(M&&M.length<1){const F={...P.state.calcs};for(const I of S)F[I.id]=I.emptyInputResult!==null?I.emptyInputResult:null;return P.state.calcs=F}const{nullValueMode:O=r.UW.Ignore}=P.config,R=O===r.UW.Ignore,L=O===r.UW.AsZero;if(S.length===1&&S[0].reduce){const F=S[0].reduce(P,R,L);return P.state.calcs={...P.state.calcs,...F},F}let B=o(P,R,L);for(const F of S)!B.hasOwnProperty(F.id)&&F.reduce&&(B={...B,...F.reduce(P,R,L)});return P.state.calcs={...P.state.calcs,...B},B}const d=new i.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:p,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:f,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:m,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:E,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!1,reduce:v,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:h,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:h,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:D,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:C,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:y=>({allValues:[...y.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:y=>({uniqueValues:[...new Set(y.values)]}),preservesUnits:!1},...u()]),u=(y=[...Array.from({length:99},(P,b)=>b+1)])=>{const P=[],b=S=>S>3&&S<21?"th":S%10===1?"st":S%10===2?"nd":S%10===3?"rd":"th";return y.forEach(S=>{const M=S/100,O=`p${S}`,R=`${S}${b(S)} %`,L=`${S}${b(S)} percentile value`;P.push({id:O,name:R,description:L,standard:!1,reduce:(B,F,I)=>({[O]:l(B,M,F,I)}),preservesUnits:!0})}),P},g={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function o(y,P,b){const S={...g},M=y.values;if(!M)return S;const O=y.type===a.PU.number||y.type===a.PU.time;for(let R=0;R<M.length;R++){let L=M[R];if(R===0&&(S.first=L),S.last=L,L==null){if(P)continue;b&&(L=0)}if(S.count++,L!=null&&!Number.isNaN(L)){const B=S.firstNotNull===null;if(B&&(S.firstNotNull=L),O){if(S.sum+=L,S.allIsNull=!1,S.nonNullCount++,!B){const F=L-S.lastNotNull;S.step>F&&(S.step=F),S.lastNotNull>L?(S.previousDeltaUp=!1,R===M.length-1&&(S.delta+=L)):(S.previousDeltaUp?S.delta+=F:S.delta+=L,S.previousDeltaUp=!0)}L>S.max&&(S.max=L),L<S.min&&(S.min=L),L<S.logmin&&L>0&&(S.logmin=L)}L!==0&&(S.allIsZero=!1),S.lastNotNull=L}}return S.max===-Number.MAX_VALUE&&(S.max=null),S.min===Number.MAX_VALUE&&(S.min=null),S.step===Number.MAX_VALUE&&(S.step=null),S.nonNullCount>0&&(S.mean=S.sum/S.nonNullCount),S.allIsNull&&(S.allIsZero=!1),S.max!==null&&S.min!==null&&(S.range=S.max-S.min),(0,t.isNumber)(S.firstNotNull)&&(0,t.isNumber)(S.lastNotNull)&&(S.diff=S.lastNotNull-S.firstNotNull),(0,t.isNumber)(S.firstNotNull)&&(0,t.isNumber)(S.diff)&&(S.diffperc=S.diff/S.firstNotNull*100),S}function E(y,P,b){return{first:y.values[0]}}function m(y,P,b){const S=y.values;for(let M=0;M<S.length;M++){const O=S[M];if(O!=null&&!Number.isNaN(O))return{firstNotNull:O}}return{firstNotNull:null}}function f(y,P,b){const S=y.values;return{last:S[S.length-1]}}function p(y,P,b){const S=y.values;let M=S.length-1;for(;M>=0;){const O=S[M--];if(O!=null&&!Number.isNaN(O))return{lastNotNull:O}}return{lastNotNull:null}}function h(y,P,b){if(!(y.type===a.PU.number||y.type===a.PU.time))return{variance:0,stdDev:0};let S=0,M=0,O=0;const R=y.values;for(let L=0;L<R.length;L++){const B=R[L];if(B!=null){O++;let F=M;M+=(B-F)/O,S+=(B-F)*(B-M)}}if(O>0){const L=S/O;return{variance:L,stdDev:Math.sqrt(L)}}return{variance:0,stdDev:0}}function D(y,P,b){const S=y.values;let M=0,O=!0,R=null;for(let L=0;L<S.length;L++){let B=S[L];if(B===null){if(P)continue;b&&(B=0)}!O&&R!==B&&M++,O=!1,R=B}return{changeCount:M}}function C(y,P,b){const S=y.values,M=new Set;for(let O=0;O<S.length;O++){let R=S[O];if(R===null){if(P)continue;b&&(R=0)}M.add(R)}return{distinctCount:M.size}}function l(y,P,b,S){let M=y.values;b&&(M=M.filter(L=>L!==null)),S&&(M=M.map(L=>L===null?0:L));const O=M.slice().sort((L,B)=>L-B),R=Math.round((O.length-1)*P);return O[R]}function v(y,P,b){const S=[];for(let O=0;O<y.values.length;O++){let R=y.values[O];if(R==null){if(P)continue;b&&(R=0)}S.push(R)}S.sort((O,R)=>O-R);const M=Math.floor(S.length/2);return S.length%2===0?{median:(S[M-1]+S[M])/2}:{median:S[M]}}},40462:(q,j,e)=>{"use strict";e.d(j,{Dq:()=>D,NS:()=>h,RE:()=>f,hI:()=>p,kK:()=>C,sJ:()=>m});var t=e(64015),n=e(52735),r=e(23936),a=e(93682),i=e(99575),x=e(75235),s=e(80645),c=e(711),d=e(31064),u=e(87496),g=e(41958),o=e(57452),E=e(84324);const m=new t.O(()=>[...(0,i.nz)(),...(0,n._)(),...(0,a.P7)(),...(0,s.W)(),r.u]),f=new t.O(()=>[...(0,i.UM)(),...(0,a.Y7)(),...(0,x.i)()]),p=new t.O(()=>[...(0,d._)(),...(0,u.E)(),...(0,c.d)(),...(0,E.m)(),...(0,g.G)(),...(0,o.z)()]);function h(l){const v=m.get(l.id);if(!v)throw new Error("Unknown field matcher: "+l.id);return v.get(l.options)}function D(l){const v=f.get(l.id);if(!v)throw new Error("Unknown frame matcher: "+l.id);return v.get(l.options)}function C(l){const v=p.get(l.id);if(!v)throw new Error("Unknown value matcher: "+l.id);return v.get(l.options)}},93682:(q,j,e)=>{"use strict";e.d(j,{P7:()=>m,PP:()=>i,Y7:()=>f});var t=e(23570),n=e(67793),r=e(63739),a=e(38075),i=(p=>(p.exclude="exclude",p.include="include",p))(i||{});const x={id:a.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:p=>{const D=c(new Set([p]));return(C,l,v)=>p===C.name||p===(0,t.Ct)(C,l,v)||!!(D&&D(C,l,v))},getOptionsDisplayText:p=>`Field name: ${p}`},s={id:a.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:p=>{const{names:h,mode:D="include"}=p,C=new Set(h??[]),l=c(C),v=(y,P,b)=>C.has(y.name)||C.has((0,t.Ct)(y,P,b))||!!(l&&l(y,P,b));return D==="exclude"?(y,P,b)=>!v(y,P,b):v},getOptionsDisplayText:p=>{const{names:h,mode:D}=p,C=(h??[]).join(", ");return D==="exclude"?`All except: ${C}`:`All of: ${C}`}};function c(p){let h;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(p.has(r.Bc)?h=(C,l)=>!!C.labels&&C.labels?.__name__===C.name:(p.has("Time")||p.has("time"))&&(h=(C,l)=>l.meta?.typeVersion==null&&C.type===r.PU.time)),h}const d={id:a.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:p=>{const h=o(p);return(D,C,l)=>{const v=(0,t.Ct)(D,C,l);return!!h&&h.test(v)}},getOptionsDisplayText:p=>`Field name by pattern: ${p}`},u={id:a.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:p=>(h,D,C)=>D.refId===p,getOptionsDisplayText:p=>`Math all fields returned by query with reference ID: ${p}`},g={id:a.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:p=>{const h=d.get(p?.pattern||""),D=s.get({mode:"include",names:p?.names??[]});return(C,l,v)=>D(C,l,v)||h(C,l,v)},getOptionsDisplayText:p=>{const h=p?.pattern??"",D=p?.names?.join(",")??"";return`Field name by pattern: ${h} or names: ${D}`}},o=p=>{if(p)try{return(0,n.dO)(p)}catch(h){console.error(h);return}},E={id:a.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:p=>{const h=(0,n.dO)(p);return D=>h.test(D.name||"")},getOptionsDisplayText:p=>`Frame name: ${p}`};function m(){return[x,d,s,g,u]}function f(){return[E]}},99575:(q,j,e)=>{"use strict";e.d(j,{UM:()=>l,Yg:()=>u,nz:()=>C,zx:()=>E});var t=e(63739),n=e(40462),r=e(38075);const a={id:r.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const y=v.map(P=>(0,n.NS)(P));return(P,b,S)=>{for(const M of y)if(M(P,b,S))return!0;return!1}},getOptionsDisplayText:v=>{let y="";for(const P of v){y.length>0&&(y+=" OR ");const b=n.sJ.get(P.id);y+=b.getOptionsDisplayText?b.getOptionsDisplayText(P):b.name}return y}},i={id:r.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const y=v.map(P=>(0,n.Dq)(P));return P=>{for(const b of y)if(b(P))return!0;return!1}},getOptionsDisplayText:v=>{let y="";for(const P of v){y.length>0&&(y+=" OR ");const b=n.RE.get(P.id);y+=b.getOptionsDisplayText?b.getOptionsDisplayText(P):b.name}return y}},x={id:r.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const y=v.map(P=>(0,n.NS)(P));return(P,b,S)=>{for(const M of y)if(!M(P,b,S))return!1;return!0}},getOptionsDisplayText:v=>{let y="";for(const P of v){y.length>0&&(y+=" AND ");const b=n.sJ.get(P.id);y+=b.getOptionsDisplayText?b.getOptionsDisplayText(P):b.name}return y}},s={id:r.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:v=>{const y=v.map(P=>(0,n.Dq)(P));return P=>{for(const b of y)if(!b(P))return!1;return!0}},getOptionsDisplayText:v=>{let y="";for(const P of v){y.length>0&&(y+=" AND ");const b=n.RE.get(P.id);y+=b.getOptionsDisplayText?b.getOptionsDisplayText(P):b.name}return y}},c={id:r.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:v=>{const y=(0,n.NS)(v);return(P,b,S)=>!y(P,b,S)},getOptionsDisplayText:v=>{const y=n.sJ.get(v.id);return"NOT "+(y.getOptionsDisplayText?y.getOptionsDisplayText(v.options):y.name)}},d={id:r.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:v=>{const y=(0,n.Dq)(v);return P=>!y(P)},getOptionsDisplayText:v=>{const y=n.RE.get(v.id);return"NOT "+(y.getOptionsDisplayText?y.getOptionsDisplayText(v.options):y.name)}},u=v=>!0,g=v=>!0,o=v=>!1,E=v=>v.type!==t.PU.time,m=v=>!1,f={id:r.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:v=>u,getOptionsDisplayText:v=>"Always"},p={id:r.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:v=>g,getOptionsDisplayText:v=>"Always"},h={id:r.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:v=>o,getOptionsDisplayText:v=>"Never"},D={id:r.cV.neverMatch,name:"No Frames",description:"Never Match",get:v=>m,getOptionsDisplayText:v=>"Never"};function C(){return[a,x,c,f,h]}function l(){return[i,s,d,p,D]}},48279:(q,j,e)=>{"use strict";e.d(j,{h:()=>r,m:()=>n});var t=e(64015),n=(a=>(a.Combine="combine",a.CalculateNewFields="calculateNewFields",a.CreateNewVisualization="createNewVisualization",a.Filter="filter",a.PerformSpatialOperations="performSpatialOperations",a.Reformat="reformat",a.ReorderAndRename="reorderAndRename",a))(n||{});const r=new t.O},54092:(q,j,e)=>{"use strict";e.d(j,{m:()=>d});var t=e(62467),n=e(69862),r=e(81160),a=e(40462),i=e(48279);const x=(g,o)=>E=>{const m=i.h.get(g.id);if(!m)return E;const p={...m.transformation.defaultOptions??{},...g.options},h=g.filter?.options?(0,a.Dq)(g.filter):void 0;return E.pipe((0,n.Z)(D=>(0,t.of)(s(D,h)).pipe(m.transformation.operator(p,o),c(D,m,h))))};function s(g,o){return o?g.filter(E=>o(E)):g}const c=(g,o,E)=>m=>m.pipe((0,r.T)(f=>{if(f===g)return f;if(E){let p=0;const h=g.filter((D,C)=>{const l=!E(D);return l&&!p&&(p=C),l});h.length&&f.splice(p,0,...h)}return f}));function d(g,o,E){const m=(0,t.of)(o);if(!g.length)return m;const f=[],p=E??{interpolate:h=>h};for(let h=0;h<g.length;h++){const D=g[h];if(u(D))f.push(D(p));else{if(D.disabled)continue;f.push(x(D,p))}}return m.pipe.apply(m,f)}function u(g){return typeof g=="function"}},36596:(q,j,e)=>{"use strict";e.d(j,{c:()=>me});var t=e(46884),n=e(70736),r=e(17177),a=e(46655),i=e(85410),x=e(3468),s=e(38075),c=e(66564);const d={id:c.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(Pe,Ee)=>be=>{const Se={};return Pe.include&&(Se.include={id:s.jR.byRefId,options:Pe.include}),Pe.exclude&&(Se.exclude={id:s.jR.byRefId,options:Pe.exclude}),be.pipe(i.I.operator(Se,Ee))}};var u=e(13710),g=e(41758),o=e(81160),E=e(23570),m=e(19844);const f={id:c.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:Pe=>{for(const Ee of Pe)for(const be of Ee.fields)if(be.type==="time")return m.M.Applicable;return m.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(Pe,Ee)=>be=>be.pipe((0,o.T)(Se=>p(Pe,Se,Ee)))},p=({timeField:Pe,outputFormat:Ee,timezone:be},Se,Xe)=>!Array.isArray(Se)||Se.length===0?Se:((0,E.Fm)(Se),Ee=Xe?.interpolate(Ee)??Ee,Se.map(Qe=>({...Qe,fields:Qe.fields.map(we=>(we.state?.displayName===Pe&&(we=(0,r.Xv)(we,Ee,{timeZone:be})),we))})));var h=e(97463),D=e(22915),C=e(40462);const l="Time",v="Time",y="Value",P=m.N.Empty,b=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,S={id:c.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:l,rowField:v,valueField:y},isApplicable:Pe=>{let Ee=0;for(const be of Pe)Ee+=be.fields.length;return Ee>=3?m.M.Applicable:m.M.NotApplicable},isApplicableDescription:Pe=>{let Ee=0;for(const be of Pe)Ee+=be.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${Ee} fields.`},operator:(Pe,Ee)=>be=>be.pipe((0,o.T)(Se=>{const Xe=Pe.columnField||l,Qe=Pe.rowField||v,we=Pe.valueField||y,$e=Pe.emptyValue||P;if(Se.length!==1)return Se;const Fe=Se[0],Te=O(Fe,Xe),Le=O(Fe,Qe),Ge=O(Fe,we),Me=`${Qe}\\${Xe}`;if(!Te||!Le||!Ge)return Se;const De=M(Te.values),Ke=M(Le.values),Ie={};for(let ie=0;ie<Ge.values.length;ie++){const ve=Te.values[ie],fe=Le.values[ie],ge=Ge.values[ie];Ie[ve]||(Ie[ve]={}),Ie[ve][fe]=ge}const Ne=[{name:Me,values:Ke,type:Le.type,config:{}}];for(const ie of De){let ve=[];for(const fe of Ke){const ge=Ie[ie][fe]??R($e);ve.push(ge)}b&&typeof ie=="number"&&(Ge.config={...Ge.config,displayNameFromDS:void 0}),Ne.push({name:ie?.toString()??null,values:ve,config:Ge.config,type:Ge.type})}return[{fields:Ne,length:Ke.length}]}))};function M(Pe){const Ee=new Set(Pe);return Array.from(Ee)}function O(Pe,Ee){for(let be=0;be<Pe.fields.length;be++){const Se=Pe.fields[be];let Xe;if(b?Xe=C.sJ.get(s.Ct.byName).get(Ee)(Se,Pe,[Pe]):Xe=Ee===(0,E.Ct)(Se),Xe)return Se}return null}function R(Pe){switch(Pe){case m.N.False:return!1;case m.N.True:return!0;case m.N.Null:return null;case m.N.Zero:return 0;case m.N.Empty:default:return""}}var L=e(27844),B=e(71393),F=e(55883);const I=10,U={id:c.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:I},operator:(Pe,Ee)=>be=>be.pipe((0,o.T)(Se=>{let Xe=I;return Pe.limitField!==void 0&&(typeof Pe.limitField=="string"?Xe=parseInt(Pe.limitField,10):Xe=Pe.limitField),Se.map(Qe=>Qe.length>Xe?{...Qe,fields:Qe.fields.map(we=>({...we,values:Xe>=0?we.values.slice(0,Xe):we.values.slice(we.values.length+Xe,we.values.length)})),length:Math.abs(Xe)}:Qe)}))};var W=e(63738),A=e(6896),N=e(86242);const K={id:c.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:Pe=>Ee=>Ee.pipe((0,o.T)(be=>{const Se=V(Pe.renameByName);return!Array.isArray(be)||be.length===0?be:be.map(Xe=>({...Xe,fields:Se(Xe)}))}))},V=Pe=>Ee=>!Pe||Object.keys(Pe).length===0?Ee.fields:Ee.fields.map(be=>{const Se=(0,E.Ct)(be,Ee),Xe=Pe[Se];return typeof Xe!="string"||Xe.length===0?be:{...be,config:{...be.config,displayName:Xe},state:{...be.state,displayName:Xe}}}),T={id:c.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:Pe=>Pe.length>1?m.M.NotPossible:m.M.Applicable,operator:(Pe,Ee)=>be=>be.pipe(x.D.operator({include:Pe.includeByName?{names:z(Pe.includeByName)}:void 0,exclude:{names:z(Pe.excludeByName)}},Ee),N.x.operator(Pe,Ee),K.operator(Pe,Ee))},z=Pe=>Pe?Object.keys(Pe).filter(Ee=>Pe[Ee]):[];var w=e(27586),H=e(67793);const G={id:c.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:Pe=>Ee=>Ee.pipe((0,o.T)(be=>!Array.isArray(be)||be.length===0?be:be.map(X(Pe))))},X=Pe=>Ee=>{const be=(0,H.dO)(Pe.regex),Se=Ee.fields.map(Xe=>{const Qe=(0,E.Ct)(Xe,Ee);if(!be.test(Qe))return Xe;const we=Qe.replace(be,Pe.renamePattern);return{...Xe,config:{...Xe.config,displayName:we},state:{...Xe.state,displayName:we}}});return{...Ee,fields:Se}};var k=e(2543),_=e(36669),ee=e(4038),J=e(67555),Z=e(63739);const te={id:c.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:Pe=>Ee=>Ee.pipe((0,o.T)(be=>{if(!Array.isArray(be)||be.length===0||(be=be.filter($e=>$e.length>0),!(0,J.jq)(be)))return be;const Se={},Xe=new Set,Qe=new _.k({refId:`${c.F.seriesToRows}-${be.map($e=>$e.refId).join("-")}`,fields:[]}),we={name:Z.aI,values:[],config:{},type:Z.PU.string};for(let $e=0;$e<be.length;$e++){const Fe=be[$e];for(let Te=0;Te<Fe.fields.length;Te++){const Le=Fe.fields[Te];if(Le.type===Z.PU.time){Se[$e]=Te,Xe.has(Z.LE)||(Qe.addField(ae(Le,Z.LE)),Qe.addField(we),Xe.add(Z.LE));continue}Xe.has(Z.Bc)||(Qe.addField(ae(Le,Z.Bc)),Xe.add(Z.Bc))}}for(let $e=0;$e<be.length;$e++){const Fe=be[$e];for(let Te=0;Te<Fe.length;Te++){const Le=Se[$e],Ge=Le===0?1:0;Qe.add({[Z.LE]:Fe.fields[Le].values[Te],[Z.aI]:(0,E.Ri)(Fe),[Z.Bc]:Fe.fields[Ge].values[Te]})}}return[(0,ee.ES)(Qe,0,!0)]}))},ae=(Pe,Ee)=>({...(0,k.omit)(Pe,["values","state","labels","config","name"]),name:Ee,values:[],config:{...(0,k.omit)(Pe.config,["displayName","displayNameFromDS"])}}),re={id:c.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(Pe,Ee)=>be=>be.pipe((0,o.T)(Se=>!Array.isArray(Se)||Se.length===0||!Pe?.sort?.length?Se:ne(Se,Pe.sort,Ee)))};function ne(Pe,Ee,be){return Pe.map(Se=>{const Xe=ce(Se,Ee,be);return Xe.length&&Xe[0].index!=null?(0,ee.ES)(Se,Xe[0].index,Xe[0].desc):Se})}function ce(Pe,Ee,be){return Ee.map(Se=>Se.index!=null?Se:{...Se,index:Pe.fields.findIndex(Xe=>Se.field===(0,E.Ct)(Xe,Pe))})}const le={id:c.F.transpose,name:"Transpose",description:"Transpose the data frame",defaultOptions:{},operator:Pe=>Ee=>Ee.pipe((0,o.T)(be=>be.length===0?be:he(Pe,be)))};function he(Pe,Ee){return Ee.map(be=>{const Se=be.fields[0],Xe=Pe.firstFieldName?Pe.firstFieldName:"Field",Qe=Pe.restFieldsName?Pe.restFieldsName:"Value",we=Se.type===Z.PU.string||Se.type===Z.PU.time||Se.type===Z.PU.enum,$e=we?[Xe,...de(Se,Se.values)]:[Xe,...Se.values.map((Ge,Me)=>Qe)],Fe=we?be.fields.map(Ge=>Ge.name).slice(1):be.fields.map(Ge=>Ge.name),Te=oe(we?be.fields.map(Ge=>Ge.type).slice(1):be.fields.map(Ge=>Ge.type)),Le=$e.map((Ge,Me)=>{if(Me===0)return{name:Xe,type:Z.PU.string,config:{},values:Fe};const De=be.fields.map(Ne=>Te===Z.PU.string?de(Ne,[Ne.values[Me-1]])[0]:Ne.values[Me-1]),Ke=we?Se.name:"row",Ie=we?Ge:Me;return{name:we?Qe:Ge,labels:{[Ke]:Ie},type:Te,config:{},values:we?De.slice(1):De}});return{...be,fields:Le,length:Math.max(...Le.map(Ge=>Ge.values.length)),refId:`${c.F.transpose}-${be.refId}`}})}function oe(Pe){const Ee=new Set(Pe);return Ee.size===1?[...Ee][0]:Z.PU.string}function de(Pe,Ee){switch(Pe.type){case Z.PU.time:case Z.PU.number:case Z.PU.boolean:case Z.PU.string:return Ee.map(be=>`${be}`);case Z.PU.enum:return Ee.map(be=>Pe.config.type.enum.text[be]);default:return Ee.map(be=>JSON.stringify(be))}}const me={noopTransformer:A.W,filterFieldsTransformer:i.z,filterFieldsByNameTransformer:x.D,filterFramesTransformer:i.I,filterFramesByRefIdTransformer:d,filterByValueTransformer:u.Sv,formatStringTransformer:g.yt,formatTimeTransformer:f,orderFieldsTransformer:N.x,organizeFieldsTransformer:T,reduceTransformer:w.Wj,concatenateTransformer:n.vz,calculateFieldTransformer:t.SC,joinByFieldTransformer:B.L,seriesToColumnsTransformer:B.L,seriesToRowsTransformer:te,renameFieldsTransformer:K,labelsToFieldsTransformer:F.V,ensureColumnsTransformer:a.b,groupByTransformer:h.of,sortByTransformer:re,mergeTransformer:W.o,renameByRegexTransformer:G,histogramTransformer:L.OA,convertFieldTypeTransformer:r.zM,groupingToMatrixTransformer:S,limitTransformer:U,groupToNestedTable:D._,transposeTransformer:le}},46884:(q,j,e)=>{"use strict";e.d(j,{Bp:()=>h,SC:()=>P,UY:()=>p,Uj:()=>l,ip:()=>D,pR:()=>U,sw:()=>A});var t=e(2543),n=e.n(t),r=e(81160),a=e(4038),i=e(23570),x=e(8392),s=e(63739),c=e(16268),d=e(90808),u=e(91357),g=e(40462),o=e(38075),E=e(46655),m=e(66564),f=e(6896),p=(N=>(N.ReduceRow="reduceRow",N.CumulativeFunctions="cumulativeFunctions",N.WindowFunctions="windowFunctions",N.BinaryOperation="binary",N.UnaryOperation="unary",N.Index="index",N))(p||{}),h=(N=>(N.Percentage="percentage",N.Fixed="fixed",N))(h||{}),D=(N=>(N.Trailing="trailing",N.Centered="centered",N))(D||{});const C={reducer:u.gy.sum},l={reducer:u.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},v={left:{fixed:""},operator:c.k.Add,right:{fixed:""}},y={operator:d._.Abs,fieldName:""},P={id:m.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:u.gy.sum}},operator:(N,K)=>V=>{const T=N.mode??"reduceRow",z=N.timeSeries!==!1,w=T==="binary"&&N.binary?.right.fixed!=null,G=z&&!w?E.b.operator(null,K):f.W.operator({},K);return V.pipe(G,(0,r.T)(X=>{let k;switch(T){case"reduceRow":k=B((0,t.defaults)(N.reduce,C),X);break;case"cumulativeFunctions":k=L((0,t.defaults)(N.cumulative,C),X);break;case"windowFunctions":k=b((0,t.defaults)(N.window,l),X);break;case"unary":k=W((0,t.defaults)(N.unary,y),X);break;case"binary":const ee=[];X.map(Z=>{Z.fields.map(te=>{ee.push(te.name)})});const J={left:U(N.binary?.left??"",ee),operator:N.binary?.operator??v.operator,right:U(N.binary?.right??"",ee)};if(N.binary=J,J.left?.matcher?.id&&J.left?.matcher.id===o.Ct.byType){const Z=J.left.matcher.options,te=c.b.getIfExists(J.operator);return X.map(re=>{const{timeField:ne}=(0,a.KR)(re),ce=[];let le=!1;if(ne&&N.timeSeries!==!1&&ce.push(ne),re.fields.map((he,oe)=>{if(N.replaceFields||ce.push(he),he.type===Z){const de=he.values,me=F(re,J.right??v.right,X,K);if(!de||!me||!te)return;const Pe=new Array(de.length);for(let be=0;be<Pe.length;be++)Pe[be]=te.operation(de[be],me[be]);const Ee={...he,name:`${he.name} ${N.binary?.operator??""} ${N.binary?.right.matcher?.options??N.binary?.right.fixed}`,values:Pe};ce.push(Ee),le=!0}}),!(N.replaceFields&&!le))return{...re,fields:ce}}).filter(re=>re!=null)}else k=I((0,t.defaults)(J,v),X,K);break;case"index":return X.map(Z=>{const te=[...Array(Z.length).keys()];if(N.index?.asPercentile)for(let re=0;re<te.length;re++)te[re]=te[re]/te.length;const ae={name:N.alias??"Row",type:s.PU.number,values:te,config:N.index?.asPercentile?{unit:"percentunit"}:{}};return{...Z,fields:N.replaceFields?[ae]:[...Z.fields,ae]}})}return k?X.map(ee=>{const J=k(ee);if(!J)return N.replaceFields?void 0:ee;const Z={name:A(N),type:s.PU.number,config:{},values:J};let te=[];if(N.replaceFields){const{timeField:ae}=(0,a.KR)(ee);ae&&N.timeSeries!==!1?te=[ae,Z]:te=[Z]}else te=[...ee.fields,Z];return{...ee,fields:te}}).filter(ee=>ee!=null):X}))}};function b(N,K){if(N.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let V=(0,g.NS)({id:o.Ct.numeric});return N.field&&(V=(0,g.NS)({id:o.Ct.byNames,options:{names:[N.field]}})),T=>{const z=Math.ceil(N.windowSize*(N.windowSizeMode==="percentage"?T.length:1));let w=null;for(const H of T.fields)if(V(H,T,K)){w=H;break}if(w){if(![u.gy.mean,u.gy.stdDev,u.gy.variance].includes(N.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${N.reducer}`);return N.windowAlignment==="centered"?M(T,N.reducer,w,z):S(T,N.reducer,w,z)}}}function S(N,K,V,T){const z=[];let w=0,H=0;for(let G=0;G<N.length;G++)if(K===u.gy.mean){const X=V.values[G];if(X!=null&&(H++,w+=X,G>T-1)){const k=V.values[G-T];k!=null&&(w-=k,H--)}z.push(H===0?0:w/H)}else if(K===u.gy.variance){const X=Math.max(0,G-T+1),k=G+1;z.push(O(V.values.slice(X,k)))}else if(K===u.gy.stdDev){const X=Math.max(0,G-T+1),k=G+1;z.push(R(V.values.slice(X,k)))}return z}function M(N,K,V,T){const z=[];let w=0,H=0;const G=Math.ceil(T/2)-1,X=Math.floor(T/2);for(let k=0;k<N.length;k++){const _=k-X,ee=k+G;if(K===u.gy.mean){if(k===0)for(let J=0;J<G+1&&J<V.values.length;J++)V.values[J]!=null&&(w+=V.values[J],H++);else ee<V.values.length&&V.values[ee]!=null&&(w+=V.values[ee],H++),_>0&&V.values[_-1]!=null&&(w-=V.values[_-1],H--);z.push(H===0?0:w/H)}else if(K===u.gy.variance){const J=V.values.slice(Math.max(0,_),Math.min(ee+1,V.values.length));z.push(O(J))}else if(K===u.gy.stdDev){const J=V.values.slice(Math.max(0,_),Math.min(ee+1,V.values.length));z.push(R(J))}}return z}function O(N){if(N.length<1)return 0;let K=0,V=0,T=0;for(let w=0;w<N.length;w++){const H=N[w];if(H!=null){T++;let G=V;V+=(H-G)/T,K+=(H-G)*(H-V)}}return T===0?0:K/T}function R(N){return Math.sqrt(O(N))}function L(N,K){let V=(0,g.NS)({id:o.Ct.numeric});if(N.field&&(V=(0,g.NS)({id:o.Ct.byNames,options:{names:[N.field]}})),![u.gy.mean,u.gy.sum].includes(N.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${N.reducer}`);return T=>{let z=null;for(const G of T.fields)if(V(G,T,K)){z=G;break}if(!z)return;const w=[];let H=0;for(let G=0;G<T.length;G++)H+=z.values[G]??0,N.reducer===u.gy.sum?w.push(H):N.reducer===u.gy.mean&&w.push(H/(G+1));return w}}function B(N,K){let V=(0,g.NS)({id:o.Ct.numeric});N.include&&N.include.length&&(V=(0,g.NS)({id:o.Ct.byNames,options:{names:N.include}}));const T=u.AS.get(N.reducer);if(!T)throw new Error(`Unknown reducer: ${N.reducer}`);const z=T.reduce??u.H3,w=N.nullValueMode===x.UW.Ignore,H=N.nullValueMode===x.UW.AsZero;return G=>{const X=[];for(const J of G.fields)V(J,G,K)&&X.push(J.values);const k=X.length,_={name:"temp",values:new Array(k),type:s.PU.number,config:{}},ee=[];for(let J=0;J<G.length;J++){for(let Z=0;Z<k;Z++)_.values[Z]=X[Z][J];ee.push(z(_,w,H)[N.reducer])}return ee}}function F(N,K,V,T){if(!K)return;if(K.matcher&&K.matcher.id===o.Ct.byName){const w=K.matcher.options??"";for(const H of N.fields)if(w===(0,i.Ct)(H,N,V))return H.type===s.PU.boolean?H.values.map(G=>G?1:0):H.values}const z=parseFloat(K.fixed??K.matcher?.options??"");if(!isNaN(z))return new Array(N.length).fill(z)}function I(N,K,V){const T=c.b.getIfExists(N.operator);return z=>{const w=F(z,N.left,K,V),H=F(z,N.right,K,V);if(!w||!H||!T)return;const G=new Array(w.length);for(let X=0;X<G.length;X++)G[X]=T.operation(w[X],H[X]);return G}}function U(N,K){return typeof N=="string"?isNaN(Number(N))?{matcher:{id:o.Ct.byName,options:N}}:K.includes(N)?{matcher:{id:o.Ct.byName,options:N}}:{fixed:N}:N}function W(N,K){const V=d.j.getIfExists(N.operator);return T=>{let z=[];for(const H of T.fields)N.fieldName===(0,i.Ct)(H,T,K)&&H.type===s.PU.number&&(z=H.values);if(!z.length||!V)return;const w=new Array(z.length);for(let H=0;H<w.length;H++)w[H]=V.operation(z[H]);return w}}function A(N){if(N.alias?.length)return N.alias;switch(N.mode){case"cumulativeFunctions":{const{cumulative:K}=N;return`cumulative ${K?.reducer??""}${K?.field?`(${K.field})`:""}`}case"windowFunctions":{const{window:K}=N;return`${K?.windowAlignment??""} moving ${K?.reducer??""}${K?.field?`(${K.field})`:""}`}case"unary":{const{unary:K}=N;return`${K?.operator??""}${K?.fieldName?`(${K.fieldName})`:""}`}case"binary":{const{binary:K}=N;return`${K?.left?.matcher?.options??K?.left?.fixed??""} ${K?.operator??""} ${K?.right?.matcher?.options??K?.right?.fixed??""}`.replace(/\$/g,"")}case"reduceRow":{const K=u.AS.getIfExists(N.reduce?.reducer);if(K)return K.name}break;case"index":return"Row"}return"math"}},70736:(q,j,e)=>{"use strict";e.d(j,{vz:()=>i,x1:()=>a});var t=e(81160),n=e(63739),r=e(66564),a=(s=>(s.Drop="drop",s.FieldName="field",s.Label="label",s))(a||{});const i={id:r.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:s=>c=>c.pipe((0,t.T)(d=>!Array.isArray(d)||d.length<2?d:[x(d,s)]))};function x(s,c){let d=!0,u=s[0].length;const g=c.frameNameLabel??"frame";let o=[];for(const E of s){u!==E.length&&(d=!1,u=Math.max(u,E.length));for(const m of E.fields){const f={...m};f.state=void 0,E.name&&(c.frameNameMode==="drop"||(c.frameNameMode==="label"?(f.labels={...m.labels},f.labels[g]=E.name):!f.name||f.name===n.Bc?f.name=E.name:f.name=`${E.name} \xB7 ${m.name}`)),o.push(f)}}return d||(o=o.map(E=>{if(E.values.length===u)return E;const m=E.values.slice();return m.length=u,{...E,values:m}})),{fields:o,length:u}}},17177:(q,j,e)=>{"use strict";e.d(j,{Xv:()=>m,ks:()=>p,s7:()=>d,zM:()=>s});var t=e(81160),n=e(59457),r=e(63739),a=e(40462),i=e(38075),x=e(66564);const s={id:x.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(D,C)=>l=>l.pipe((0,t.T)(v=>s.transformer(D,C)(v))),transformer:D=>C=>!Array.isArray(C)||C.length===0?C:c(D,C)??[]};function c(D,C){if(!D.conversions.length)return C;const l=C.map(v=>({...v}));for(const v of D.conversions){if(!v.targetField)continue;const y=a.sJ.get(i.Ct.byName).get(v.targetField);for(const P of l)P.fields=P.fields.map(b=>y(b,P,l)?d(b,v):b)}return l}function d(D,C){switch(C.destinationType){case r.PU.time:return p(D,C.dateFormat);case r.PU.number:return o(D);case r.PU.string:return m(D,C.dateFormat,{timeZone:C.timezone},C.joinWith);case r.PU.boolean:return E(D);case r.PU.enum:return h(D,C.enumConfig);case r.PU.other:return f(D);default:return D}}const u=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function g(D,C){let l=C?{format:C}:void 0;const v=D.values.slice();let y=v.find(S=>S!=null);const P=typeof y=="number"&&C==="X",b=typeof y=="string"&&u.test(y);for(let S=0;S<v.length;S++)if(v[S]){let M=b?Date.parse(v[S]):(0,n.b)(v[S],l).valueOf();Number.isFinite(M)?v[S]=P?M*1e3:M:v[S]=null}else v[S]=null;return{...D,type:r.PU.time,values:v}}function o(D){const C=D.values.slice(),l=C.some(v=>typeof v=="string");for(let v=0;v<C.length;v++){let y=C[v];l&&y!=null&&typeof y=="string"&&(y=y.replace(/,/g,""));const P=+y;C[v]=Number.isFinite(P)?P:null}return{...D,type:r.PU.number,values:C}}function E(D){const C=D.values.slice();for(let l=0;l<C.length;l++)C[l]=!!C[l];return{...D,type:r.PU.boolean,values:C}}function m(D,C,l,v){let y=D.values;switch(D.type){case r.PU.time:y=y.map(P=>(0,n.b)(P,l).format(C));break;case r.PU.other:y=y.map(P=>v?.length&&Array.isArray(P)?P.join(v):JSON.stringify(P));break;default:y=y.map(P=>`${P}`)}return{...D,type:r.PU.string,values:y}}function f(D){const C=D.values.slice();for(let l=0;l<C.length;l++)try{C[l]=JSON.parse(C[l])}catch{C[l]=null}return{...D,type:r.PU.other,values:C}}function p(D,C){const l=typeof D.values[0]=="number",v=C==="X";return D.type===r.PU.time&&l?D:l&&!v?{...D,type:r.PU.time}:g(D,C)}function h(D,C){const l={...C},v=D.values.slice(),y=new Map;if(l.text&&l.text.length>0)for(let P=0;P<l.text.length;P++)y.set(l.text[P],P);else return D;for(let P=0;P<v.length;P++){const b=v[P];v[P]=y.get(b)}return{...D,config:{...D.config,type:{enum:l}},type:r.PU.enum,values:v}}},46655:(q,j,e)=>{"use strict";e.d(j,{b:()=>i});var t=e(81160),n=e(4038),r=e(66564),a=e(71393);const i={id:r.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(s,c)=>d=>d.pipe((0,t.T)(u=>i.transformer(s,c)(u))),transformer:(s,c)=>d=>{const u=x(d);return d.length>1&&u?a.L.transformer({byField:u},c)(d):d}};function x(s){let c;for(const d of s){const{timeField:u}=(0,n.KR)(d);if(!u)return;if(!c)c=u.name;else if(c!==u.name)return}return c}},85410:(q,j,e)=>{"use strict";e.d(j,{I:()=>x,z:()=>i});var t=e(81160),n=e(40462),r=e(66564),a=e(6896);const i={id:r.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(s,c)=>d=>!s.include&&!s.exclude?d.pipe(a.W.operator({},c)):(typeof s.include?.options=="string"?s.include.options=s.include?.options:typeof s.include?.options?.pattern=="string"&&(s.include.options.pattern=s.include?.options.pattern),typeof s.exclude?.options=="string"?s.exclude.options=s.exclude?.options:typeof s.exclude?.options?.pattern=="string"&&(s.exclude.options.pattern=s.exclude?.options.pattern),d.pipe((0,t.T)(u=>{const g=s.include?(0,n.NS)(s.include):null,o=s.exclude?(0,n.NS)(s.exclude):null,E=[];for(const m of u){const f=[];for(let h=0;h<m.fields.length;h++){const D=m.fields[h];if(o){if(o(D,m,u))continue;g||f.push(D)}g&&g(D,m,u)&&f.push(D)}if(!f.length)continue;const p={...m,fields:f};E.push(p)}return E})))},x={id:r.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(s,c)=>d=>!s.include&&!s.exclude?d.pipe(a.W.operator({},c)):d.pipe((0,t.T)(u=>{const g=s.include?(0,n.Dq)(s.include):null,o=s.exclude?(0,n.Dq)(s.exclude):null,E=[];for(const m of u){if(o){if(o(m))continue;g||E.push(m)}g&&g(m)&&E.push(m)}return E}))}},3468:(q,j,e)=>{"use strict";e.d(j,{D:()=>a,R:()=>i});var t=e(38075),n=e(85410),r=e(66564);const a={id:r.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(x,s)=>c=>c.pipe(n.z.operator({include:i(x.include,x.byVariable),exclude:i(x.exclude,x.byVariable)},s))},i=(x,s)=>{if(!x)return;const{names:c,pattern:d,variable:u}=x;if(s&&u){const g=u;if(/\{.*\}/.test(g)){const o=g.slice(1).slice(0,-1).split(",");return{id:t.Ct.byNames,options:{names:o}}}return{id:t.Ct.byNames,options:{names:g.split(",")}}}if(!((!Array.isArray(c)||c.length===0)&&!d))return d?!Array.isArray(c)||c.length===0?{id:t.Ct.byRegexp,options:d}:{id:t.Ct.byRegexpOrNames,options:x}:{id:t.Ct.byNames,options:{names:c}}}},13710:(q,j,e)=>{"use strict";e.d(j,{Sm:()=>s,Sv:()=>c,j4:()=>x});var t=e(81160),n=e(23570),r=e(40462),a=e(66564),i=e(6896),x=(g=>(g.exclude="exclude",g.include="include",g))(x||{}),s=(g=>(g.all="all",g.any="any",g))(s||{});const c={id:a.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(g,o)=>E=>{const m=g.filters,f=g.match==="all",p=g.type==="include";return!Array.isArray(m)||m.length===0?E.pipe(i.W.operator({},o)):E.pipe((0,t.T)(h=>{if(h.length===0)return h;const D=[];for(const C of h){const l=new Set,v=u(C,h),y=d(m,v);for(let S=0;S<C.length;S++){if(l.has(S))continue;let M=!0;for(const O of y){const R=O(S,C,h);if(!f&&R){M=!0;break}if(f&&!R){M=!1;break}M=R}M&&l.add(S)}const P=[],b=p?l.size:h[0].length-l.size;for(const S of C.fields){const M=[];for(let O=0;O<C.length;O++){if(p&&l.has(O)){M.push(S.values[O]);continue}if(!p&&!l.has(O)){M.push(S.values[O]);continue}}P.push({...S,values:M,state:{}})}D.push({...C,fields:P,length:b})}return D}))}},d=(g,o)=>{const E=()=>!1;return g.map(m=>{const f=o[m.fieldName]??-1;if(f<0)return console.warn(`[FilterByValue] Could not find index for field name: ${m.fieldName}`),E;const p=(0,r.kK)(m.config);return(h,D,C)=>p(h,D.fields[f],D,C)})},u=(g,o)=>{const E={};return g.fields.forEach((m,f)=>{const p=(0,n.Ct)(m,g,o);E[p]=f}),E}},41758:(q,j,e)=>{"use strict";e.d(j,{gs:()=>s,yt:()=>u});var t=e(81160),n=e(63739),r=e(19844),a=e(40462),i=e(38075),x=e(66564),s=(o=>(o.UpperCase="Upper Case",o.LowerCase="Lower Case",o.SentenceCase="Sentence Case",o.TitleCase="Title Case",o.PascalCase="Pascal Case",o.CamelCase="Camel Case",o.SnakeCase="Snake Case",o.KebabCase="Kebab Case",o.Trim="Trim",o.Substring="Substring",o))(s||{});const c=o=>{const E=o.split(" ");for(let m=0;m<E.length;m++)E[m]=E[m].charAt(0).toUpperCase()+E[m].slice(1).toLowerCase();return E},d=o=>E=>E.values.map(m=>{switch(o.outputFormat){case"Upper Case":return m.toUpperCase();case"Lower Case":return m.toLowerCase();case"Sentence Case":return m.charAt(0).toUpperCase()+m.slice(1);case"Title Case":return c(m).join(" ");case"Pascal Case":return c(m).join("");case"Camel Case":return m=c(m).join(""),m.charAt(0).toLowerCase()+m.slice(1);case"Snake Case":return m.toLowerCase().split(" ").join("_");case"Kebab Case":return m.toLowerCase().split(" ").join("-");case"Trim":return m.trim();case"Substring":return m.substring(o.substringStart,o.substringEnd)}}),u={id:x.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:o=>{for(const E of o)for(const m of E.fields)if(m.type==="string")return r.M.Applicable;return r.M.NotApplicable},operator:o=>E=>E.pipe((0,t.T)(m=>{if(m.length===0)return m;const f=a.sJ.get(i.Ct.byName).get(o.stringField),p=d(o),h=g(f,p);return m.map(D=>({...D,fields:h(D,m)}))}))},g=(o,E)=>(m,f)=>m.fields.map(p=>{if(o(p,m,f)){const h=E(p);return{...p,type:n.PU.string,values:h}}return p})},97463:(q,j,e)=>{"use strict";e.d(j,{Ce:()=>p,R3:()=>u,Y2:()=>f,of:()=>g});var t=e(81160),n=e(4038),r=e(23570),a=e(63739),i=e(19844),x=e(91357),s=e(66564),c=e(1371);const d=2;var u=(h=>(h.aggregate="aggregate",h.groupBy="groupby",h))(u||{});const g={id:s.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:h=>(0,c.f)(h)>=d?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:h=>{const D=(0,c.f)(h);return`The Group by transformation requires a series with at least ${d} fields to work. The maximum number of fields found on a series is ${D}`},operator:h=>D=>D.pipe((0,t.T)(C=>{if(!Object.keys(h.fields).find(y=>h.fields[y].operation==="groupby"))return C;const v=[];for(const y of C){const P=y.fields.filter(M=>o(M,h));if(P.length===0)continue;const b=f(y,P),S=p(P,b);for(const M of y.fields){if(!E(M,h))continue;const O=(0,r.Ct)(M),R=h.fields[O].aggregations,L={};b.forEach(B=>{const F=B[O],I=(0,x.Nw)({field:F,reducers:R});for(const U of R)Array.isArray(L[U])||(L[U]=[]),L[U].push(I[U])});for(const B of R){const F={name:`${O} (${B})`,values:L[B]??[],type:a.PU.other,config:{}};F.type=m(B,M,F),S.push(F)}}v.push({fields:S,length:b.size})}return v}))},o=(h,D)=>{const C=(0,r.Ct)(h);return D?.fields[C]?.operation==="groupby"},E=(h,D)=>{const C=(0,r.Ct)(h);return D?.fields[C]?.operation==="aggregate"&&Array.isArray(D?.fields[C].aggregations)&&D?.fields[C].aggregations.length>0};function m(h,D,C){switch(h){case x.gy.allIsNull:return a.PU.boolean;case x.gy.last:case x.gy.lastNotNull:case x.gy.first:case x.gy.firstNotNull:return D.type;default:return(0,n.dF)(C)??a.PU.string}}function f(h,D){const C=new Map;for(let l=0;l<h.length;l++){const v=String(D.map(P=>P.values[l])),y=C.get(v)??{};C.has(v)||C.set(v,y);for(let P of h.fields){const b=(0,r.Ct)(P);y[b]||(y[b]={name:b,type:P.type,config:{...P.config},values:[]}),y[b].values.push(P.values[l])}}return C}function p(h,D){const C=[];for(const l of h){const v=[],y=(0,r.Ct)(l);D.forEach(P=>{v.push(P[y].values[0])}),C.push({name:l.name,type:l.type,config:{...l.config},values:v})}return C}},22915:(q,j,e)=>{"use strict";e.d(j,{_:()=>E,l:()=>u});var t=e(81160),n=e(4038),r=e(23570),a=e(63739),i=e(19844),x=e(91357),s=e(97463),c=e(66564),d=e(1371);const u=!0,g=2;var o=(C=>(C.aggregate="aggregate",C.groupBy="groupby",C))(o||{});const E={id:c.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:u,fields:{}},isApplicable:C=>(0,d.f)(C)>=g?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:C=>{const l=(0,d.f)(C);return`The Group to nested table transformation requires a series with at least ${g} fields to work. The maximum number of fields found on a series is ${l}`},operator:C=>l=>l.pipe((0,t.T)(v=>{if(!Object.keys(C.fields).find(b=>C.fields[b].operation==="groupby"))return v;const P=[];for(const b of v){const S=b.fields.filter(L=>f(L,C));if(S.length===0)continue;const M=(0,s.Y2)(b,S),O=(0,s.Ce)(S,M),R=D(M,C);for(let L=0;L<b.fields.length;L++){const B=b.fields[L];if(!p(B,C))continue;const F=(0,r.Ct)(B),I=C.fields[F].aggregations,U={};M.forEach(W=>{const A=W[F],N=(0,x.Nw)({field:A,reducers:I});for(const K of I)Array.isArray(U[K])||(U[K]=[]),U[K].push(N[K])});for(const W of I){const A={name:`${F} (${W})`,values:U[W],type:a.PU.other,config:{}};A.type=h(W,B,A),O.push(A)}}O.push({config:{},name:"Nested frames",type:a.PU.nestedFrames,values:R}),P.push({fields:O,length:M.size})}return P}))};function m(C,l,v){return{meta:{custom:{noHeader:!(v.showSubframeHeaders===void 0?u:v.showSubframeHeaders)}},length:l,fields:C}}const f=(C,l)=>{const v=(0,r.Ct)(C);return l?.fields[v]?.operation==="groupby"},p=(C,l)=>{const v=(0,r.Ct)(C);return l?.fields[v]?.operation==="aggregate"&&Array.isArray(l?.fields[v].aggregations)&&l?.fields[v].aggregations.length>0},h=(C,l,v)=>{switch(C){case x.gy.allIsNull:return a.PU.boolean;case x.gy.last:case x.gy.lastNotNull:case x.gy.first:case x.gy.firstNotNull:return l.type;default:return(0,n.dF)(v)??a.PU.string}};function D(C,l){const v=[];for(const[,y]of C){const P=[];for(const[b,S]of Object.entries(y)){const M=l.fields[b];(M===void 0||M.aggregations===void 0||M.operation==="aggregate"&&M.aggregations.length===0||M.operation===null||M.operation===void 0)&&P.push(S)}P.length>0?v.push([m(P,P[0].values.length,l)]):v.push([m([],0,l)])}return v}},27844:(q,j,e)=>{"use strict";e.d(j,{H1:()=>C,NX:()=>h,OA:()=>f,Rt:()=>m,Uh:()=>P,ZU:()=>y,cg:()=>M,d$:()=>p,dA:()=>D,ix:()=>l,p3:()=>v,rW:()=>u,rs:()=>b});var t=e(81160),n=e(16869),r=e(10468),a=e(63739),i=e(47370),x=e(12936),s=e(66564),c=e(77230),d=e(54430);const u=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],g=30,o=[],E=(O,R)=>O-R,m={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},f={id:s.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(O,R)=>L=>L.pipe((0,t.T)(B=>f.transformer(O,R)(B))),transformer:(O,R)=>L=>{if(!Array.isArray(L)||L.length===0)return L;let B,F;O.bucketSize&&(typeof O.bucketSize=="string"?B=parseFloat(O.bucketSize):B=O.bucketSize,isNaN(B)&&(B=void 0)),O.bucketOffset&&(typeof O.bucketOffset=="string"?F=parseFloat(O.bucketOffset):F=O.bucketOffset,isNaN(F)&&(F=void 0));const I={bucketSize:B,bucketOffset:F,combine:O.combine},U=v(L,I);return U==null?[]:[M(U)]}},p="xMin";function h(O){return O===p||O==="BucketMin"}const D="xMax";function C(O){return O===D||O==="BucketMax"}function l(O){if(O.meta?.type===i.m.HeatmapCells){let F=O.fields.find(V=>V.name==="yMin"),I=O.fields.find(V=>V.name==="yMax"),U=O.fields.find(V=>V.name==="count"),W=[...new Set(I.values)].sort((V,T)=>V-T),A=[...new Set(F.values)].sort((V,T)=>V-T),N=new Map;W.forEach(V=>N.set(V,0));for(let V=0;V<I.values.length;V++){let T=I.values[V];N.set(T,N.get(T)+U.values[V])}return{xMin:{...F,name:"xMin",values:A},xMax:{...I,name:"xMax",values:W},counts:[{...U,values:[...N.values()]}]}}else if(O.meta?.type===i.m.HeatmapRows){let F=[],I=[],U=[],W="0";return O.fields.forEach(N=>{if(N.type===a.PU.number){let K=N.values.reduce((V,T)=>V+T,0);U.push(K),F.push(W),I.push(W=N.name)}}),U.push(0),F.push(W),I.push(W),{xMin:{...O.fields[1],name:"xMin",type:a.PU.string,values:F},xMax:{...O.fields[1],name:"xMax",type:a.PU.string,values:I},counts:[{...O.fields[1],name:"count",type:a.PU.number,values:U}]}}let R,L;const B=[];for(const F of O.fields)h(F.name)?R=F:C(F.name)?L=F:F.type===a.PU.number&&B.push(F);if(!L&&R&&R.values.length>1){let F=R.values,I=(0,x.h)(F[1]-F[0],6);L={...R,name:D,values:F.map(U=>U+I)}}if(!R&&L&&L?.values.length>1){let F=L.values,I=(0,x.h)(F[1]-F[0],6);R={...L,name:p,values:F.map(U=>U-I)}}if(R&&L&&B.length)return{xMin:R,xMax:L,counts:B}}function v(O,R){let L=R?.bucketSize,B=R?.bucketCount??g,F=R?.bucketOffset??0;if(O=O.map(z=>({...z,fields:z.fields.map(w=>{if(w.type===a.PU.number){const H=Number(w.config.noValue);Number.isNaN(H)?w={...w,values:w.values.filter(G=>G!=null)}:w=(0,d.A)(w,H)}return w})})),!L||L<0){let z=[];for(const _ of O)for(const ee of _.fields)ee.type===a.PU.number&&(z=z.concat(ee.values));z.sort((_,ee)=>_-ee);let w=1/0;if(z.length===1)w=1;else for(let _=1;_<z.length;_++){let ee=z[_]-z[_-1];ee!==0&&(w=Math.min(w,ee))}let H=z[0];const k=(z[z.length-1]-H)/B;for(let _=0;_<u.length;_++){let ee=u[_];if(k<ee&&ee>=w){L=ee;break}}}const I=z=>(0,x.h)(b(z-F,L)+F,9);let U=((""+L).match(/\.\d+$/)??["."])[0].length-1,W=[],A=[],N;for(const z of O)for(const w of z.fields)if(w.type===a.PU.number){let H=S(w.values,I,o,E);W.push(H),A.push({...w,config:{...w.config,unit:w.config.unit==="short"?"short":void 0}}),!N&&w.config.unit&&(N=w.config)}if(!A.length)return null;let K=(0,c.fj)(W);for(let z=1;z<K.length;z++){let w=K[z];for(let H=0;H<w.length;H++)w[H]==null&&(w[H]=0)}const V={name:p,values:K[0],type:a.PU.number,state:void 0,config:U===0?N??{}:{...N,decimals:U}},T={...V,name:D,values:K[0].map(z=>z+L)};if(R?.combine){const z=new Array(K[0].length).fill(0);for(let w=1;w<K.length;w++)for(let H=0;H<z.length;H++)z[H]+=K[w][H];A=[{...A[0],name:"count",values:z,type:a.PU.number,state:{...A[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else A.forEach((z,w)=>{z.values=K[w+1]});return{xMin:V,xMax:T,counts:A}}function y(O,R){return Math.round(O/R)*R}function P(O,R){return Math.ceil(O/R)*R}function b(O,R){return Math.floor(O/R)*R}function S(O,R,L,B){let F=new Map;for(let A=0;A<O.length;A++){let N=O[A];N!=null&&(N=R(N));let K=F.get(N);K?K.count++:F.set(N,{value:N,count:1})}L&&L.forEach(A=>F.delete(A));let I=[...F.values()];B&&I.sort((A,N)=>B(A.value,N.value));let U=Array(I.length),W=Array(I.length);for(let A=0;A<I.length;A++)U[A]=I[A].value,W[A]=I[A].count;return[U,W]}function M(O,R){if(!O.xMin.display){const L=(0,n.J)({field:O.xMin,theme:R??(0,r.a)()});O.xMin.display=L,O.xMax.display=L}return O.counts[0].display=(0,n.J)({field:O.counts[0],theme:R??(0,r.a)()}),{length:O.xMin.values.length,meta:{type:i.m.Histogram},fields:[O.xMin,O.xMax,...O.counts],refId:`${s.F.histogram}`}}},71393:(q,j,e)=>{"use strict";e.d(j,{L:()=>s,W:()=>x});var t=e(81160),n=e(40462),r=e(38075),a=e(66564),i=e(77230),x=(c=>(c.outer="outer",c.inner="inner",c.outerTabular="outerTabular",c))(x||{});const s={id:a.F.joinByField,aliasIds:[a.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(c,d)=>u=>u.pipe((0,t.T)(g=>s.transformer(c,d)(g))),transformer:(c,d)=>{let u;return g=>{if(g.length>1){c.byField&&!u&&(u=n.sJ.get(r.Ct.byName).get(c.byField));const o=(0,i.Fd)({frames:g,joinBy:u,mode:c.mode});if(o)return o.refId=`${a.F.joinByField}-${g.map(E=>E.refId).join("-")}`,[o]}return g}}}},77230:(q,j,e)=>{"use strict";e.d(j,{Fd:()=>d,JI:()=>m,RC:()=>o,WO:()=>E,Yj:()=>c,fj:()=>p,g2:()=>h});var t=e(4038),n=e(63739),r=e(40462),a=e(38075),i=e(71393);function x(D){const{timeField:C}=(0,t.KR)(D[0]);if(C)return r.sJ.get(a.Ct.firstTimeField).get({});let l=[];for(const v of D[0].fields)v.type===n.PU.number&&l.push(v.name);for(let v=1;v<D.length;v++){const y=[];for(const P of D[0].fields)P.type===n.PU.number&&y.push(P.name);l=l.filter(P=>!y.includes(P))}return r.sJ.get(a.Ct.byName).get(l[0])}function s(D){return D.joinBy??x(D.frames)}function c(D,C){if(C>=0){let l=D.fields[C];l.type!==n.PU.string&&!h(l.values)&&(D=(0,t.ES)(D,C))}return D}function d(D){if(!D.frames?.length)return;const C=D.nullMode??(O=>{let R=O.config.custom?.spanNulls;return R===!0?o:R===-1?E:m});if(D.frames.length===1){let O=D.frames[0],R=O;const L=s(D);let B=R.fields.findIndex(F=>L(F,R,D.frames));if(D.keepOriginIndices&&(R={...O,fields:O.fields.map((F,I)=>{const U={...F},W={frameIndex:0,fieldIndex:I};return U.state?U.state.origin=W:U.state={origin:W},U})},B>0)){const F=R.fields[B],I=R.fields.filter((U,W)=>W!==B);I.unshift(F),R.fields=I,B=0}if(B>=0&&(R=c(R,B)),D.keep){let F=R.fields.filter((I,U)=>U===B||D.keep(I,R,D.frames));O!==R?R.fields=F:R={...O,fields:F}}return R}const l=[],v=[],y=[],P=[];let b=1;const S=s(D);for(let O=0;O<D.frames.length;O++){const R=D.frames[O];if(!R||!R.fields?.length)continue;const L=[o];let B,F=[],I=[];for(let W=0;W<R.fields.length;W++){const A=R.fields[W];if(A.state=A.state||{},!B&&S(A,R,D.frames))B=A;else{if(D.keep&&!D.keep(A,R,D.frames))continue;L.push(C(A));let N=A.labels??{},K=A.name;R.name&&(A.name===n.Bc?K=R.name:N.name==null&&(N={...N,name:R.name})),F.push({...A,name:K,labels:N})}D.keepOriginIndices&&(A.state.origin={frameIndex:O,fieldIndex:W})}if(!B)continue;y.length===0&&y.push(B),l.push(L);const U=[B.values];for(const W of F)U.push(W.values),y.push(W),D.keepDisplayNames||delete W.state?.displayName,I.push(b),b++;P.push(I),v.push(U)}let M=[];return D.mode===i.W.outerTabular?M=u(v,P,y.length,l):D.mode===i.W.inner?M=g(v):M=p(v,l,D.mode),{length:M[0]?M[0].length:0,fields:y.map((O,R)=>({...O,values:M[R]}))}}function u(D,C,l,v){let y={};for(let b=0;b<D.length;b++){let S=D[b],M=S[0];for(let O=0;O<D.length;O++){if(O===b)continue;let R=D[O],L=R[0];for(let B=0;B<M.length;B++){const F=M[B],I=l-1;let U=[F].concat(new Array(I)),W=0;for(let A=1;A<S.length;A++){const N=C[b][W];U[N]=S[A][B],W++}for(let A=0;A<L.length;A++)if(M[B]===L[A]){let N=0;for(let K=1;K<R.length;K++){const V=C[O][N];U[V]=R[K][A],N++}break}y[JSON.stringify(U)]=U}}}let P=[];for(let b=0;b<l;b++)P.push(new Array(0));for(let b in y){const S=y[b];for(let M=0;M<S.length;M++)P[M].push(S[M])}return P}function g(D){const C=[],l=(v,y,P)=>{if(y===v.length){C.push(P);return}const b=v[y],[S,...M]=b;for(let O=0;O<S.length;O++){const R=S[O];if(y===0||P.includes(R)){const L=[...P];y===0&&L.push(R);for(let B=0;B<M.length;B++)L.push(M[B][O]);l(v,y+1,L)}}};if(l(D,0,[]),C.length===0){const v=D.reduce((y,P)=>y+(P.length-1),1);return Array.from({length:v},()=>[])}return C[0].map((v,y)=>C.map(P=>P[y]))}const o=0,E=1,m=2;function f(D,C,l){for(let v=0,y,P=-1;v<C.length;v++){let b=C[v];if(b>P){for(y=b-1;y>=0&&D[y]==null;)D[y--]=null;for(y=b+1;y<l&&D[y]==null;)D[P=y++]=null}}}function p(D,C,l=i.W.outer){let v=new Set;for(let S=0;S<D.length;S++){let O=D[S][0],R=O.length;for(let L=0;L<R;L++)v.add(O[L])}let y=[Array.from(v).sort((S,M)=>S-M)],P=y[0].length,b=new Map;for(let S=0;S<P;S++)b.set(y[0][S],S);for(let S=0;S<D.length;S++){let M=D[S],O=M[0];for(let R=1;R<M.length;R++){let L=M[R],B=Array(P).fill(void 0),F=C?C[S][R]:E,I=[];for(let U=0;U<L.length;U++){let W=L[U],A=b.get(O[U]);W===null?F!==o&&(B[A]=W,F===m&&I.push(A)):B[A]=W}f(B,I,P),y.push(B)}}return y}function h(D,C=50){const l=D.length;if(l<=1)return!0;let v=0,y=l-1;for(;v<=y&&D[v]==null;)v++;for(;y>=v&&D[y]==null;)y--;if(y<=v)return!0;const P=Math.max(1,Math.floor((y-v+1)/C));for(let b=D[v],S=v+P;S<=y;S+=P){const M=D[S];if(M!=null&&b!=null){if(M<=b)return!1;b=M}}return!0}},55883:(q,j,e)=>{"use strict";e.d(j,{V:()=>x,n:()=>i});var t=e(81160),n=e(23570),r=e(63739),a=e(66564),i=(c=>(c.Columns="columns",c.Rows="rows",c))(i||{});const x={id:a.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(c,d)=>u=>u.pipe((0,t.T)(g=>x.transformer(c,d)(g))),transformer:c=>d=>{if(c.mode==="rows")return s(d,c.keepLabels);const u=[],g=c.keepLabels?.length?new Set(c.keepLabels):void 0;for(const o of d){const E=[],m={};for(const f of o.fields){if(!f.labels){E.push(f);continue}const p={...f,config:{...f.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};E.push(p);for(const h of Object.keys(f.labels)){if(g&&!g.has(h))continue;if(c.valueLabel===h){p.name=f.labels[h];continue}(m[h]??(m[h]=new Set)).add(f.labels[h])}}for(const f in m)for(const p of m[f]){const h=new Array(o.length).fill(p);E.push({name:f,type:r.PU.string,values:h,config:{}})}u.push({...o,fields:E,length:o.length})}return u}};function s(c,d){const u=[];for(const g of c)for(const o of g.fields)if(o.labels){const E=[],m=[];if(d)for(const f of d)E.push(f),m.push(o.labels[f]);else for(const[f,p]of Object.entries(o.labels))E.push(f),m.push(p);m.length&&u.push({...g,name:(0,n.Ct)(o,g,c),fields:[{name:"label",type:r.PU.string,config:{},values:E},{name:"value",type:r.PU.string,config:{},values:m}],length:m.length})}return u}},63738:(q,j,e)=>{"use strict";e.d(j,{o:()=>s});var t=e(2543),n=e.n(t),r=e(81160),a=e(36669),i=e(19844),x=e(66564);const s={id:x.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:m=>m.length>1?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:m=>`The merge transformation requires at least 2 data series to work. There is currently ${m.length} data series.`,operator:m=>f=>f.pipe((0,r.T)(p=>{if(!Array.isArray(p)||p.length<=1)return p;const h=p.filter(M=>M.fields.length>0);if(h.length===0)return[p[0]];const D=new Set,C={},l=[],v=new a.k({refId:`${x.F.merge}-${h.map(M=>M.refId).join("-")}`,fields:[]});for(let M=0;M<h.length;M++){const O=h[M];for(let R=0;R<O.fields.length;R++){const L=O.fields[R];D.has(L.name)||(v.addField(c(L)),D.add(L.name)),C[L.name]=C[L.name]||{},C[L.name][M]=R,h.length-1===M&&o(C,L,h)&&l.push(L.name)}}if(l.length===0)return p;const y={},P=[],b=d(h,C,l),S=u(h,D,C);for(let M=0;M<h.length;M++){const O=h[M];for(let R=0;R<O.length;R++){const L=b(M,R),B=S(M,R);if(!Array.isArray(y[L])){y[L]=[B],P.push(E(L,y));continue}let F=!1;y[L]=y[L].map(I=>g(I,B)?(F=!0,{...I,...B}):I),F||(y[L].push(B),P.push(E(L,y)))}}for(const M of P){const O=y[M.key][M.index];O&&v.add(O)}return[v]}))},c=m=>({...(0,t.omit)(m,["values","state","labels","config"]),values:[],config:{...(0,t.omit)(m.config,"displayName")}}),d=(m,f,p)=>{const h=p.reduce((D,C)=>Object.keys(f[C]).reduce((l,v)=>(l[v]=l[v]||[],l[v].push(f[C][v]),l),D),{});return(D,C)=>h[D].reduce((l,v)=>l+m[D].fields[v].values[C],"")},u=(m,f,p)=>(h,D)=>{const C={},l=Array.from(f);for(const v of l){const y=p[v];if(!y)continue;const P=y[h];if(typeof P!="number")continue;const b=m[h];if(!b||!b.fields)continue;const S=b.fields[P];!S||!S.values||(C[v]=S.values[D])}return C},g=(m,f)=>{let p=!0;for(const h in f)if(!(typeof m[h]>"u")&&m[h]!==null&&m[h]!==f[h]){p=!1;break}return p},o=(m,f,p)=>Object.keys(m[f.name]).length===p.length,E=(m,f)=>({key:m,index:f[m].length-1})},6896:(q,j,e)=>{"use strict";e.d(j,{W:()=>n});var t=e(66564);const n={id:t.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:r=>a=>a,transformer:r=>a=>a}},66380:(q,j,e)=>{"use strict";e.d(j,{M:()=>a});var t=e(63739);const n={threshold:(x,s,c)=>x+c,midpoint:(x,s,c)=>(x+s)/2,plusone:(x,s,c)=>x+1};function r(x,s){return x.fields.find(c=>s!=null?c.name===s:c.type===t.PU.time)}function a(x){if(x.frame.length===0)return x.frame;let s=!0,{frame:c,refFieldName:d,refFieldPseudoMax:u,refFieldPseudoMin:g,insertMode:o}=x;o||(o=n.threshold);const E=r(c,d);if(E==null)return c;E.state={...E.state,nullThresholdApplied:!0};const m=c.fields.map(p=>p.config.custom?.insertNulls||E.config.interval||null),f=new Set(m);if(f.delete(null),f.size===0)return c;if(f.size===1){const p=f.values().next().value;if(!p||p<=0)return c;const h=E.values,D=c.fields.map(l=>l.values),C=i(h,D,p,g,u,o,s);return C===D?c:{...c,length:C[0].length,fields:c.fields.map((l,v)=>({...l,values:C[v]}))}}return c}function i(x,s,c,d=null,u=null,g,o){const E=x.length,m=[];if(d!=null&&d<x[0]){let D=Math.ceil((x[0]-d)/c),C=x[0]-D*c;for(;C<x[0];)m.push(g(C-c,C,c)),C+=c}m.push(x[0]);let f=x[0];for(let D=1;D<E;D++){const C=x[D];for(;C-f>c&&(m.push(g(f,C,c)),f+=c,!!o););m.push(C),f=C}if(u!=null&&u>f)for(;f+c<u;)m.push(g(f,u,c)),f+=c;const p=m.length;if(p===E)return s;const h=[];for(let D of s){let C;if(D!==x){C=Array(p);for(let l=0,v=0;l<p;l++)C[l]=x[v]===m[l]?D[v++]:null}else C=m;h.push(C)}return h}},54430:(q,j,e)=>{"use strict";e.d(j,{A:()=>n,C:()=>t});function t(r){return{...r,fields:r.fields.map(a=>{const i=Number(a.config.noValue);return Number.isNaN(i)?a:n(a,i)})}}function n(r,a){const i=r.values.slice();for(let x=0;x<i.length;x++)i[x]===null&&(i[x]=a);return{...r,values:i}}},86242:(q,j,e)=>{"use strict";e.d(j,{X:()=>s,x:()=>x});var t=e(2543),n=e.n(t),r=e(81160),a=e(23570),i=e(66564);const x={id:i.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:u=>g=>g.pipe((0,r.T)(o=>{const E=c(u.indexByName);return!Array.isArray(o)||o.length===0?o:o.map(m=>({...m,fields:E(m.fields,o,m)}))}))},s=u=>(g,o)=>d(g,u)-d(o,u),c=u=>(g,o,E)=>{if(!Array.isArray(g)||g.length===0||!u||Object.keys(u).length===0)return g;const m=s(u);return(0,t.clone)(g).sort((f,p)=>m((0,a.Ct)(f,E,o),(0,a.Ct)(p,E,o)))},d=(u,g)=>Number.isInteger(g[u])?g[u]:Number.MAX_SAFE_INTEGER},27586:(q,j,e)=>{"use strict";e.d(j,{Wj:()=>u,rV:()=>d});var t=e(81160),n=e(4038),r=e(23570),a=e(63739),i=e(91357),x=e(40462),s=e(99575),c=e(66564),d=(p=>(p.SeriesToRows="seriesToRows",p.ReduceFields="reduceFields",p))(d||{});const u={id:c.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[i.gy.max]},operator:p=>h=>h.pipe((0,t.T)(D=>{if(!p?.reducers?.length)return D;const C=p.fields?(0,x.NS)(p.fields):p.includeTimeField&&p.mode==="reduceFields"?s.Yg:s.zx;if(p.mode==="reduceFields")return m(D,C,p.reducers);const l=g(D,C,p.reducers,p.labelsToFields);return l?[{...l,refId:`${c.F.reduce}-${D.map(v=>v.refId).join("-")}`}]:[]}))};function g(p,h,D,C){const l=i.AS.list(D),v=l.map(b=>b.id),y=[],P=C?o(p):[];for(const b of p){const S=b.fields.filter(F=>h(F,b,p)),M=S.length,O=[],R=new Array(M);O.push({name:"Field",type:a.PU.string,values:R,config:{}});const L={};if(C)for(const F of P)L[F]=new Array(M),O.push({name:F,type:a.PU.string,values:L[F],config:{}});const B={};for(const F of l)B[F.id]=new Array(M),O.push({name:F.name,type:a.PU.other,values:B[F.id],config:{}});for(let F=0;F<S.length;F++){const I=S[F],U=(0,i.Nw)({field:I,reducers:v});if(C){if(R[F]=I.name,I.labels)for(const W in I.labels)L[W][F]=I.labels[W]}else R[F]=(0,r.Ct)(I,b,p);for(const W of l){const A=U[W.id];A===null?B[W.id][F]=NaN:B[W.id][F]=A}}for(const F of O)if(F.type===a.PU.other){const I=(0,n.dF)(F);I&&(F.type=I)}y.push({...b,fields:O,length:M})}return E(y)}function o(p){const h=new Set;for(const D of p)for(const C of D.fields)if(C.labels)for(const l of Object.keys(C.labels))h.add(l);return[...h]}function E(p){if(!p?.length)return;const h=p[0];for(let D=1;D<p.length;D++){const C=p[D];for(let l=0;l<h.fields.length;l++){const v=h.fields[l];for(let y=0;y<C.fields.length;y++){const P=C.fields[y],b=l===0&&y===0,S=v.type===P.type&&v.name===P.name;if(b||S){const M=v.values,O=P.values;v.values=M.concat(O)}}}}return h.name=void 0,h.length=h.fields[0].values.length,h}function m(p,h,D){const l=i.AS.list(D).map(y=>y.id),v=[];for(const y of p){const P=[];for(const b of y.fields)if(h(b,y,p)){const S=(0,i.Nw)({field:b,reducers:l});for(const M of l){const O=S[M],R={...b,type:f(M,b),values:[O]};R.state=void 0,l.length>1&&(R.labels||(R.labels={}),R.labels.reducer=i.AS.get(M).name),P.push(R)}}P.length&&v.push({...y,fields:P,length:1})}return v}function f(p,h){switch(p){case i.gy.allValues:case i.gy.uniqueValues:return a.PU.other;case i.gy.first:case i.gy.firstNotNull:case i.gy.last:case i.gy.lastNotNull:return h.type;default:return a.PU.number}}},1371:(q,j,e)=>{"use strict";e.d(j,{f:()=>t});function t(n){let r=0;for(const a of n)a.fields.length>r&&(r=a.fields.length);return r}},63786:(q,j,e)=>{"use strict";e.d(j,{DO:()=>n,Ur:()=>a,ki:()=>r,mx:()=>i});var t=(x=>(x.Fetch="fetch",x))(t||{}),n=(x=>(x.POST="POST",x.PUT="PUT",x.GET="GET",x))(n||{});const r=[{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"GET",value:"GET"}],a=[{label:"application/json",value:"application/json"},{label:"text/plain",value:"text/plain"},{label:"application/xml",value:"application/xml"},{label:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}],i={type:"fetch",title:"",fetch:{url:"",method:"POST",body:"{}",queryParams:[],headers:[["Content-Type","application/json"]]}}},91323:(q,j,e)=>{"use strict";e.d(j,{O:()=>t});var t=(n=>(n.NoData="no_data",n.Paused="paused",n.Alerting="alerting",n.OK="ok",n.Pending="pending",n.Unknown="unknown",n))(t||{})},59764:(q,j,e)=>{"use strict";e.d(j,{V:()=>t});var t=(n=>(n.Field="field",n.Text="text",n.Skip="skip",n))(t||{})},16753:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>a,Jk:()=>n,hX:()=>r});var t=e(41007),n=(i=>(i.CloudAlerting="cloud-alerting",i.UnifiedAlerting="unified-alerting",i.Dashboard="dashboard",i.Explore="explore",i.Correlations="correlations",i.Unknown="unknown",i.PanelEditor="panel-editor",i.PanelViewer="panel-viewer",i))(n||{});class r extends t.Ud{constructor(){super(...arguments),this._exposedComponentConfigs=[],this._addedComponentConfigs=[],this._addedLinkConfigs=[],this._addedFunctionConfigs=[]}init(x){}setRootPage(x){return this.root=x,this}setComponentsFromLegacyExports(x){if(x.ConfigCtrl&&(this.angularConfigCtrl=x.ConfigCtrl),this.meta&&this.meta.includes){for(const s of this.meta.includes)if(s.type===t.ib.page&&s.component&&!x[s.component]){console.warn("App Page uses unknown component: ",s.component,this.meta);continue}}}get exposedComponentConfigs(){return this._exposedComponentConfigs}get addedComponentConfigs(){return this._addedComponentConfigs}get addedLinkConfigs(){return this._addedLinkConfigs}get addedFunctionConfigs(){return this._addedFunctionConfigs}addLink(x){return this._addedLinkConfigs.push(x),this}addComponent(x){return this._addedComponentConfigs.push(x),this}addFunction(x){return this._addedFunctionConfigs.push(x),this}exposeComponent(x){return this._exposedComponentConfigs.push(x),this}configureExtensionLink(x){return this.addLink({targets:[x.extensionPointId],...x}),this}configureExtensionComponent(x){return this.addComponent({targets:[x.extensionPointId],...x,component:x.component}),this}}var a=(i=>(i.alpha="alpha",i.beta="beta",i.experimental="experimental",i.privatePreview="private preview",i.preview="preview",i))(a||{})},96698:(q,j,e)=>{"use strict";e.d(j,{r:()=>t});var t=(n=>(n.OpenSource="Open Source",n.Pro="Pro",n.Enterprise="Enterprise",n))(t||{})},8919:(q,j,e)=>{"use strict";e.d(j,{En:()=>r,d1:()=>n,tw:()=>t});const t=0,n=100,r="SAML"},74958:(q,j,e)=>{"use strict";e.d(j,{y:()=>t});var t=(n=>(n[n.Off=0]="Off",n[n.Crosshair=1]="Crosshair",n[n.Tooltip=2]="Tooltip",n))(t||{})},8392:(q,j,e)=>{"use strict";e.d(j,{Gu:()=>t,Gv:()=>x,Nx:()=>n,UW:()=>r,zz:()=>a});var t=(s=>(s.NotStarted="NotStarted",s.Loading="Loading",s.Streaming="Streaming",s.Done="Done",s.Error="Error",s))(t||{});const n=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var r=(s=>(s.Null="null",s.Ignore="connected",s.AsZero="null as zero",s))(r||{});const a=s=>!!s;function i(s){return s}function x(s){return typeof s=="object"&&s!==null?!0:!1}},47370:(q,j,e)=>{"use strict";e.d(j,{m:()=>t});var t=(n=>(n.TimeSeriesWide="timeseries-wide",n.TimeSeriesLong="timeseries-long",n.TimeSeriesMany="timeseries-many",n.TimeSeriesMulti="timeseries-multi",n.NumericWide="numeric-wide",n.NumericMulti="numeric-multi",n.NumericLong="numeric-long",n.LogLines="log-lines",n.DirectoryListing="directory-listing",n.HeatmapRows="heatmap-rows",n.HeatmapCells="heatmap-cells",n.Histogram="histogram",n))(t||{})},47180:(q,j,e)=>{"use strict";e.d(j,{$0:()=>r,CC:()=>n,uP:()=>a,x0:()=>t,yd:()=>i});var t=(x=>(x.Datasource="Datasource",x.Correlations="Correlations",x.ExploreCorrelationsEditor="CorrelationsEditor",x))(t||{}),n=(x=>(x.Regex="regex",x.Logfmt="logfmt",x))(n||{}),r=(x=>(x.Series="series",x.Field="field",x.Fields="fields",x.Value="value",x.BuiltIn="built-in",x.Template="template",x))(r||{}),a=(x=>(x.Values="values",x))(a||{}),i=(x=>(x.Action="action",x.Link="link",x.Off="off",x))(i||{})},29997:(q,j,e)=>{"use strict";e.d(j,{Is:()=>s,ZF:()=>i,mA:()=>a,tD:()=>r,v2:()=>x});var t=e(26023),n=e(41007);class r extends n.Ud{constructor(d){super(),this.DataSourceClass=d,this.components={}}setConfigEditor(d){return this.components.ConfigEditor=d,this}setConfigCtrl(d){return this.angularConfigCtrl=d,this}setQueryCtrl(d){return this.components.QueryCtrl=d,this}setAnnotationQueryCtrl(d){return this.components.AnnotationsQueryCtrl=d,this}setQueryEditor(d){return this.components.QueryEditor=d,this}setExploreQueryField(d){return this.components.ExploreQueryField=d,this}setExploreMetricsQueryField(d){return this.components.ExploreMetricsQueryField=d,this}setExploreLogsQueryField(d){return this.components.ExploreLogsQueryField=d,this}setQueryEditorHelp(d){return this.components.QueryEditorHelp=d,this}setExploreStartPage(d){return this.setQueryEditorHelp(d)}setVariableQueryEditor(d){return this.components.VariableQueryEditor=d,this}setMetadataInspector(d){return this.components.MetadataInspector=d,this}setComponentsFromLegacyExports(d){this.angularConfigCtrl=d.ConfigCtrl,this.components.QueryCtrl=d.QueryCtrl,this.components.AnnotationsQueryCtrl=d.AnnotationsQueryCtrl,this.components.ExploreQueryField=d.ExploreQueryField,this.components.QueryEditor=d.QueryEditor,this.components.QueryEditorHelp=d.QueryEditorHelp,this.components.VariableQueryEditor=d.VariableQueryEditor}}class a{constructor(d){this.name=d.name,this.id=d.id,this.type=d.type,this.meta=d.meta,this.cachingConfig=d.cachingConfig,this.uid=d.uid,this.apiVersion=d.apiVersion}filterQuery(d){return!0}getRef(){const d={type:this.type,uid:this.uid};return this.apiVersion&&(d.apiVersion=this.apiVersion),d}}var i=(c=>(c.Logs="Logs",c.Metrics="Metrics",c.Tracing="Tracing",c))(i||{}),x=(c=>(c.Cancelled="cancelled",c.Timeout="timeout",c.Unknown="unknown",c))(x||{});class s{}s=(0,t.Y)(s),a=(0,t.Y)(a)},62321:(q,j,e)=>{"use strict";e.d(j,{Ow:()=>n,ZW:()=>t,uo:()=>r});function t(a){return i=>"__systemRef"in i&&i.__systemRef===a}const n=a=>"__systemRef"in a&&typeof a.__systemRef=="string";var r=(a=>(a.Unit="unit",a.Min="min",a.Max="max",a.FieldMinMax="fieldMinMax",a.Decimals="decimals",a.DisplayName="displayName",a.NoValue="noValue",a.Thresholds="thresholds",a.Mappings="mappings",a.Links="links",a.Actions="actions",a.Color="color",a.Filterable="filterable",a))(r||{})},39010:(q,j,e)=>{"use strict";e.d(j,{R:()=>t});var t=(n=>(n.Grid="grid",n.List="list",n))(t||{})},52718:(q,j,e)=>{"use strict";e.d(j,{Tq:()=>x,ee:()=>a,kb:()=>i,r1:()=>r});var t=e(98436),n=e(91733);const r={alertSuccess:(0,t.R)("alert-success"),alertWarning:(0,t.R)("alert-warning"),alertError:(0,t.R)("alert-error"),alertInfo:(0,t.R)("alert-info")},a={refresh:(0,t.R)("refresh"),componentDidMount:(0,t.R)("component-did-mount"),dataReceived:(0,t.R)("data-received"),dataError:(0,t.R)("data-error"),dataFramesReceived:(0,t.R)("data-frames-received"),dataSnapshotLoad:(0,t.R)("data-snapshot-load"),editModeInitialized:(0,t.R)("init-edit-mode"),initPanelActions:(0,t.R)("init-panel-actions"),initialized:(0,t.R)("panel-initialized"),panelTeardown:(0,t.R)("panel-teardown"),render:(0,t.R)("render")};class i extends n.x{static{this.type="graph-hover"}}class x extends n.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},17162:(q,j,e)=>{"use strict";e.d(j,{Cz:()=>x,DG:()=>d,Qp:()=>g,Z7:()=>c,ZF:()=>r,aj:()=>u,ew:()=>i,jQ:()=>s,o4:()=>a,os:()=>n,qD:()=>t});var t=(o=>(o.DataSource="ds",o.Plugin="plugin",o.Grafana="grafana",o.Stream="stream",o))(t||{}),n=(o=>(o.DataStream="stream",o.DataFrame="frame",o.JSON="json",o))(n||{}),r=(o=>(o.Pending="pending",o.Connected="connected",o.Connecting="connecting",o.Disconnected="disconnected",o.Shutdown="shutdown",o.Invalid="invalid",o))(r||{}),a=(o=>(o.Status="status",o.Join="join",o.Leave="leave",o.Message="message",o))(a||{});function i(o){return o.type==="status"}function x(o){return o.type==="join"}function s(o){return o.type==="leave"}function c(o){return o.type==="message"}function d(o){if(o?.length){let E=o.trim().split("/");if(E.length>=3)return{scope:E[0],namespace:E[1],path:E.slice(2).join("/")}}}function u(o){return!!(o?.path&&o.namespace&&o.scope)}function g(o){if(!o.scope)return"";let E=o.scope;return!o.namespace||(E+="/"+o.namespace,!o.path)?E:E+"/"+o.path}},18163:(q,j,e)=>{"use strict";e.d(j,{$b:()=>n,Aj:()=>d,Df:()=>m,FP:()=>o,Nc:()=>u,Ol:()=>s,ZF:()=>x,_0:()=>E,_C:()=>i,cF:()=>c,s5:()=>r,tG:()=>a,wj:()=>g});var t=e(91733),n=(f=>(f.emerg="critical",f.fatal="critical",f.alert="critical",f.crit="critical",f.critical="critical",f.warn="warning",f.warning="warning",f.err="error",f.eror="error",f.error="error",f.info="info",f.information="info",f.informational="info",f.notice="info",f.dbug="debug",f.debug="debug",f.trace="trace",f.unknown="unknown",f))(n||{});const r={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var a=(f=>(f[f.Number=0]="Number",f[f.String=1]="String",f[f.LabelsMap=2]="LabelsMap",f[f.Error=3]="Error",f))(a||{}),i=(f=>(f.none="No de-duplication",f.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",f.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",f.signature="De-duplication of successive lines that have identical punctuation and whitespace.",f))(i||{}),x=(f=>(f.Backward="BACKWARD",f.Forward="FORWARD",f))(x||{});const s=f=>!f||typeof f!="object"?!1:"getLogRowContext"in f;var c=(f=>(f.LogsVolume="LogsVolume",f.LogsSample="LogsSample",f))(c||{}),d=(f=>(f.FullRange="FullRange",f.Limited="Limited",f))(d||{});const u=(f,p)=>f?("getDataProvider"in f||"getSupplementaryRequest"in f)&&"getSupplementaryQuery"in f&&"getSupportedSupplementaryQueryTypes"in f&&f.getSupportedSupplementaryQueryTypes().includes(p):!1,g=f=>!f||typeof f!="object"?!1:"getLogRowContextUi"in f,o=f=>f!=null&&typeof f=="object"&&"toggleQueryFilter"in f&&"queryHasFilter"in f,E=f=>f!=null&&typeof f=="object"&&"modifyQuery"in f&&"getSupportedQueryModifications"in f;class m extends t.x{static{this.type="logs-sort-order-change"}}},80426:(q,j,e)=>{"use strict";e.d(j,{k:()=>t});var t=(n=>(n[n.Standard=0]="Standard",n[n.Canvas=1]="Canvas",n[n.Custom=2]="Custom",n))(t||{})},21288:(q,j,e)=>{"use strict";e.d(j,{NV:()=>s,nQ:()=>i,v2:()=>x,wV:()=>a});var t=e(2543),n=e.n(t),r=e(63739),a=(c=>(c.Auto="auto",c.Vertical="vertical",c.Horizontal="horizontal",c))(a||{}),i=(c=>(c[c.Best=100]="Best",c[c.Good=70]="Good",c[c.OK=50]="OK",c))(i||{});class x{constructor(d,u){this.list=[],this.data=d,this.panel=u,this.dataSummary=this.computeDataSummary()}getListAppender(d){return new s(this.list,d)}computeDataSummary(){const d=this.data?.series||[];let u=0,g=0,o=0,E=0,m=0,f=0,p;for(const h of d){E+=h.length,h.meta?.preferredVisualisationType&&(p=h.meta.preferredVisualisationType);for(const D of h.fields)switch(f++,D.type){case r.PU.number:u+=1;break;case r.PU.time:g+=1;break;case r.PU.string:o+=1;break}h.length>m&&(m=h.length)}return{numberFieldCount:u,timeFieldCount:g,stringFieldCount:o,rowCountTotal:E,rowCountMax:m,fieldCount:f,preferredVisualisationType:p,frameCount:d.length,hasData:E>0,hasTimeField:g>0,hasNumberField:u>0,hasStringField:o>0}}getList(){return this.list}}class s{constructor(d,u){this.list=d,this.defaults=u}append(d){this.list.push((0,t.defaultsDeep)(d,this.defaults))}}},93253:(q,j,e)=>{"use strict";e.d(j,{S:()=>n,u:()=>t});var t=(r=>(r.link="link",r.component="component",r.function="function",r))(t||{}),n=(r=>(r.AlertInstanceAction="grafana/alerting/instance/action",r.AlertingHomePage="grafana/alerting/home",r.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",r.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",r.CommandPalette="grafana/commandpalette/action",r.DashboardPanelMenu="grafana/dashboard/panel/menu",r.DataSourceConfig="grafana/datasources/config",r.ExploreToolbarAction="grafana/explore/toolbar/action",r.UserProfileTab="grafana/user/profile/tab",r))(n||{})},3021:(q,j,e)=>{"use strict";e.d(j,{x:()=>n});var t=e(41007);function n(r){return r&&r!==t.Ac.valid&&r!==t.Ac.internal}},58462:(q,j,e)=>{"use strict";e.d(j,{D_:()=>t,Ee:()=>r,FL:()=>n});var t=(a=>(a.Equal="Equal",a.NotEqual="NotEqual",a.EqualRegEx="EqualRegEx",a.NotEqualRegEx="NotEqualRegEx",a))(t||{});const n=a=>!a||typeof a!="object"?!1:"importFromAbstractQueries"in a,r=a=>!a||typeof a!="object"?!1:"exportToAbstractQueries"in a},42853:(q,j,e)=>{"use strict";e.d(j,{n:()=>t});const t={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match","=|":"one-of","!=|":"not-one-of"}},14964:(q,j,e)=>{"use strict";e.d(j,{CO:()=>t,ZG:()=>n,zL:()=>r});var t=(a=>(a[a.never=0]="never",a[a.onDashboardLoad=1]="onDashboardLoad",a[a.onTimeRangeChanged=2]="onTimeRangeChanged",a))(t||{}),n=(a=>(a[a.disabled=0]="disabled",a[a.alphabeticalAsc=1]="alphabeticalAsc",a[a.alphabeticalDesc=2]="alphabeticalDesc",a[a.numericalAsc=3]="numericalAsc",a[a.numericalDesc=4]="numericalDesc",a[a.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",a[a.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",a[a.naturalAsc=7]="naturalAsc",a[a.naturalDesc=8]="naturalDesc",a))(n||{}),r=(a=>(a[a.dontHide=0]="dontHide",a[a.hideLabel=1]="hideLabel",a[a.hideVariable=2]="hideVariable",a))(r||{})},99116:(q,j,e)=>{"use strict";e.d(j,{O:()=>t});var t=(n=>(n.Absolute="absolute",n.Percentage="percentage",n))(t||{})},19844:(q,j,e)=>{"use strict";e.d(j,{M:()=>t,N:()=>n});var t=(r=>(r[r.NotPossible=-1]="NotPossible",r[r.NotApplicable=0]="NotApplicable",r[r.Applicable=1]="Applicable",r[r.HighlyApplicable=2]="HighlyApplicable",r))(t||{}),n=(r=>(r.True="true",r.False="false",r.Null="null",r.Empty="empty",r.Zero="zero",r))(n||{})},65329:(q,j,e)=>{"use strict";e.d(j,{W:()=>n,d:()=>t});var t=(r=>(r.ValueToText="value",r.RangeToText="range",r.RegexToText="regex",r.SpecialValue="special",r))(t||{}),n=(r=>(r.True="true",r.False="false",r.Null="null",r.NaN="nan",r.NullAndNaN="null+nan",r.Empty="empty",r))(n||{})},50471:(q,j,e)=>{"use strict";e.d(j,{J$:()=>r,Qz:()=>t,ZV:()=>i,f5:()=>a,xi:()=>n});var t=(x=>(x.Legacy="legacy",x.Standard="standard",x.Custom="custom",x.Datasource="datasource",x))(t||{});class n{}class r extends n{getType(){return"standard"}}class a extends n{getType(){return"custom"}}class i extends n{getType(){return"datasource"}}},8503:(q,j,e)=>{"use strict";e.d(j,{V:()=>t});function t(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(n){return this[n]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(n,r){this[n]=r},writable:!0,enumerable:!1,configurable:!0},add:{value:function(n){this.push(n)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}t()},33870:(q,j,e)=>{"use strict";e.d(j,{b:()=>a});var t=e(74848),n=e(96540),r=e(69199);const a=i=>{const{children:x,storageKey:s,defaultValue:c}=i,[d,u]=(0,n.useState)({value:r.M.getObject(i.storageKey,i.defaultValue)});(0,n.useEffect)(()=>{const E=m=>{m.key===s&&u({value:r.M.getObject(i.storageKey,i.defaultValue)})};return window.addEventListener("storage",E),()=>{window.removeEventListener("storage",E)}});const g=E=>{try{r.M.setObject(s,E)}catch(m){console.error(m)}u({value:E})},o=()=>{try{r.M.delete(s)}catch(E){console.log(E)}u({value:c})};return(0,t.jsx)(t.Fragment,{children:x(d.value,g,o)})}},14781:(q,j,e)=>{"use strict";e.d(j,{bk:()=>s,pv:()=>u,iF:()=>d});var t=e(2543),n=e(49448),r=e(79488),a=e(64015);class i{constructor(){this.properties=[]}addCustomEditor(o){return this.properties.push(o),this}getRegistry(){return new a.O(()=>this.properties)}getItems(){return this.properties}}var x=e(8392);class s extends i{addNumberInput(o){return this.addCustomEditor({...o,id:o.path,override:r.D.get("number").editor,editor:r.D.get("number").editor,process:n.m0,shouldApply:o.shouldApply??(()=>!0),settings:o.settings||{}})}addSliderInput(o){return this.addCustomEditor({...o,id:o.path,override:r.D.get("slider").editor,editor:r.D.get("slider").editor,process:n.m0,shouldApply:o.shouldApply??(()=>!0),settings:o.settings||{}})}addTextInput(o){return this.addCustomEditor({...o,id:o.path,override:r.D.get("text").editor,editor:r.D.get("text").editor,process:n.OU,shouldApply:o.shouldApply??(()=>!0),settings:o.settings||{}})}addSelect(o){return this.addCustomEditor({...o,id:o.path,override:r.D.get("select").editor,editor:r.D.get("select").editor,process:n.hL,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{options:[]}})}addRadio(o){return this.addCustomEditor({...o,id:o.path,override:r.D.get("radio").editor,editor:r.D.get("radio").editor,process:n.hL,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{options:[]}})}addBooleanSwitch(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("boolean").editor,override:r.D.get("boolean").editor,process:n.FM,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addColorPicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("color").editor,override:r.D.get("color").editor,process:n.hS,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addUnitPicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("unit").editor,override:r.D.get("unit").editor,process:n.lG,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addFieldNamePicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("field-name").editor,override:r.D.get("field-name").editor,process:n.hS,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}addGenericEditor(o,E){return this.addCustomEditor({...o,id:o.path,editor:E,override:E,process:n.hS,shouldApply:o.shouldApply?o.shouldApply:()=>!0,settings:o.settings||{}})}}class c{constructor(o){this.cfg=o,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=E=>{const m=this.cfg.values;return m?m(E):{getValue:f=>E.getValue(`${this.path}.${f}`),onChange:(f,p)=>E.onChange(`${this.path}.${f}`,p)}},this.path=o.path,this.category=o.category,this.defaultValue=this.getDefaultValue(o)}getDefaultValue(o){let E=(0,x.Gv)(o.defaultValue)?(0,t.cloneDeep)(o.defaultValue):{};const m=new u;o.build(m,{data:[]});for(const f of m.getItems())f.defaultValue!=null&&(0,t.set)(E,f.path,f.defaultValue);return E}}function d(g){return(0,x.Gv)(g)&&"id"in g&&g.id==="nested-panel-options"}class u extends i{addNestedOptions(o){const E=new c(o);return this.addCustomEditor(E)}addNumberInput(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("number").editor})}addSliderInput(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("slider").editor})}addTextInput(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("text").editor})}addStringArray(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("strings").editor})}addSelect(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("select").editor})}addMultiSelect(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("multi-select").editor})}addRadio(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("radio").editor})}addBooleanSwitch(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("boolean").editor})}addColorPicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("color").editor,settings:o.settings||{}})}addTimeZonePicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("timezone").editor,settings:o.settings||{}})}addUnitPicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("unit").editor})}addFieldNamePicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("field-name").editor})}addDashboardPicker(o){return this.addCustomEditor({...o,id:o.path,editor:r.D.get("dashboard-uid").editor})}}},39244:(q,j,e)=>{"use strict";e.d(j,{t:()=>r});var t=e(2543),n=e.n(t);function r(a){return typeof a=="number"?a:a===""||a===null||a===void 0||Array.isArray(a)?NaN:typeof a=="boolean"?a?1:0:(0,t.toNumber)(a)}},6562:(q,j,e)=>{"use strict";e.r(j),e.d(j,{insertAfterImmutably:()=>a,insertBeforeImmutably:()=>r,moveItemImmutably:()=>n,sortValues:()=>s});var t=e(7500);function n(c,d,u){const g=[...c];return Array.prototype.splice.call(g,u,0,Array.prototype.splice.call(g,d,1)[0]),g}function r(c,d,u){if(u<0||u>c.length)throw new Error("Index out of bounds");const g=[...c];return g.splice(u,0,d),g}function a(c,d,u){if(u<0||u>c.length)throw new Error("Index out of bounds");const g=[...c];return g.splice(u+1,0,d),g}const i=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),x=(c,d)=>c-d;function s(c){return(d,u)=>{if(d===u)return 0;if(u==null||typeof u=="string"&&u.trim()==="")return-1;if(d==null||typeof d=="string"&&d?.trim()==="")return 1;let g=i.compare;return typeof d=="number"&&typeof u=="number"&&(g=x),c===t.xB.Descending?g(u,d):g(d,u)}}},16268:(q,j,e)=>{"use strict";e.d(j,{b:()=>r,k:()=>n});var t=e(64015),n=(a=>(a.Add="+",a.Subtract="-",a.Divide="/",a.Multiply="*",a))(n||{});const r=new t.O(()=>[{id:"+",name:"Add",operation:(a,i)=>a+i,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(a,i)=>a-i,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(a,i)=>a*i,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(a,i)=>a/i,binaryOperationID:"/"}])},60590:(q,j,e)=>{"use strict";e.d(j,{F7:()=>u,Jh:()=>g,_O:()=>D,i8:()=>E});var t=e(2543),n=e.n(t),r=e(44809),a=e.n(r),i=e(36669),x=e(4038),s=e(23570),c=e(63739),d=e(59141),u=(C=>(C[C.full=0]="full",C[C.name=1]="name",C[C.none=2]="none",C))(u||{});function g(C,l){return new E(l).readCSV(C)}var o=(C=>(C[C.Starting=0]="Starting",C[C.InHeader=1]="InHeader",C[C.ReadingRows=2]="ReadingRows",C))(o||{});class E{constructor(l){this.chunk=(v,y)=>{for(let P=0;P<v.data.length;P++){const b=v.data[P];if(b.length<1)continue;const S=b[0];if(S){if(S.startsWith("#")){const M=S.indexOf("#",2);if(M>0){const O=S.slice(1,M),R=O==="name";if(R||{unit:"#"}.hasOwnProperty(O)){this.state===2&&(this.current=new i.k({fields:[]}),this.data.push(this.current));const B=S.slice(M+1);if(R){this.current.addFieldFor(void 0,B);for(let F=1;F<b.length;F++)this.current.addFieldFor(void 0,b[F])}else{const{fields:F}=this.current;for(let I=0;I<F.length;I++){F[I].config||(F[I].config={});const U=F[I].config;U[O]=I===0?B:b[I]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,x.HW)(S)===c.PU.string){for(const O of b)this.current.addFieldFor(void 0,O);this.state=1;continue}this.state=1}}if(this.state,this.state=2,b.length>this.current.fields.length){const{fields:M}=this.current;for(let O=M.length;O<b.length;O++)this.current.addFieldFor(b[O]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(b),this.callback&&this.callback.onRow(b)}},l||(l={}),this.config=l.config||{},this.callback=l.callback,this.current=new i.k({fields:[]}),this.state=0,this.data=[]}readCSV(l){this.current=new i.k({fields:[]}),this.data=[this.current];const v={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return a().parse(l,v),this.data}}function m(C,l){if(C==null)return"";const v=C.toString();return v.includes('"')?l.quoteChar+v.replace(/"/gi,'""')+l.quoteChar:v.includes(`
`)||l.delimiter&&v.includes(l.delimiter)?l.quoteChar+v+l.quoteChar:v}function f(C,l){return C.display?v=>{const y=C.display(v);return m((0,d.cN)(y),l)}:v=>m(v,l)}function p(C,l,v){const y=C==="name",P=C==="type";for(const b of l){const S=b.config;if(y||P||S&&S.hasOwnProperty(C)){let M="#"+C+"#";for(let O=0;O<l.length;O++){O>0&&(M=M+v.delimiter);let R=l[O].name;P?R=l[O].type:y||(R=l[O].config[C]),R&&(M=M+m(R,v))}return M+v.newline}}return""}function h(){const C=["x","y"];return C.toLocaleString?C.toLocaleString().charAt(1):","}function D(C,l){if(!C)return"";l=(0,t.defaults)(l,{delimiter:h(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let v=l.useExcelHeader?`sep=${l.delimiter}${l.newline}`:"";for(let y=0;y<C.length;y++){const P=C[y],{fields:b}=P;if(b.length===0)continue;if(l.headerStyle===0)v=v+p("name",b,l)+p("type",b,l)+p("unit",b,l)+p("dateFormat",b,l);else if(l.headerStyle===1){for(let M=0;M<b.length;M++)M>0&&(v+=l.delimiter),v+=`"${(0,s.Ct)(b[M],P).replace(/"/g,'""')}"`;v+=l.newline}const S=b[0].values.length;if(S>0){const M=b.map(O=>f(O,l));for(let O=0;O<S;O++){for(let R=0;R<b.length;R++){R>0&&(v=v+l.delimiter);let L=b[R].values[O];b[R].type===c.PU.frame&&b[R].values[O].value&&(L=b[R].values[O].value),L!==null&&(v=v+M[R](L))}O!==S-1&&(v=v+l.newline)}}y!==C.length-1&&(v=v+l.newline)}return v}},46399:(q,j,e)=>{"use strict";e.d(j,{c:()=>r,u:()=>a});var t=e(2567),n=e(93407);const r={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function a(c){const{onClickFn:d,replaceVariables:u,link:g,scopedVars:o,range:E,field:m,internalLink:f}=c,p=typeof g.internal?.query=="function"?g.internal.query({replaceVariables:u,scopedVars:o}):f.query,h=x(p,o,u),D=x(g.internal?.panelsState,o,u),C=x(g.meta?.correlationData,o,u),l=g.title?g.title:f.datasourceName;return{title:u(l,o),href:i(f.datasourceUid,h,E,D),onClick:d?v=>{v.preventDefault&&v.preventDefault(),d({datasourceUid:f.datasourceUid,queries:[h],panelsState:D,correlationHelperData:C,range:E})}:void 0,target:g?.targetBlank?"_blank":"_self",origin:m}}function i(c,d,u,g){return t.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,n.Pp)({...u?.raw?{range:(0,n.sQ)(u.raw)}:{},datasource:c,queries:[d],panelsState:g}))}`)}function x(c,d,u){if(!c)return c;if(typeof c=="string")return u(c,d);const g=JSON.parse(JSON.stringify(c));return s(g,d,u)}function s(c,d,u){for(const g of Object.keys(c))typeof c[g]=="string"?c[g]=u(c[g],d):typeof c[g]=="object"&&c[g]!==null&&(c[g]=s(c[g],d,u));return c}},61809:(q,j,e)=>{"use strict";e.d(j,{BD:()=>d,EX:()=>u,Iz:()=>i,PG:()=>s,QP:()=>p,fN:()=>a,lO:()=>m,mn:()=>c,p$:()=>r,pN:()=>E,wY:()=>g,wp:()=>f,yV:()=>o,zX:()=>x});var t=e(2543),n=e.n(t);function r(h){const D={uid:h.uid,type:h.type};return h.apiVersion&&(D.apiVersion=h.apiVersion),D}function a(h){return typeof h=="object"&&typeof h?.uid=="string"}function i(h){if(a(h))return h.uid;if((0,t.isString)(h))return h}const x=(h,D)=>C=>{E(h,D,C.currentTarget.value)},s=(h,D)=>C=>{m(h,D,C.currentTarget.value)},c=(h,D)=>C=>{f(h,D,C.currentTarget.value)},d=(h,D)=>C=>{m(h,D,C.value)},u=(h,D)=>C=>{m(h,D,C.currentTarget.checked)},g=(h,D)=>C=>{f(h,D,C.value)},o=(h,D)=>C=>{p(h,D)};function E(h,D,C){const l=h.options;h.onOptionsChange({...l,[D]:C})}const m=(h,D,C)=>{const l=h.options;h.onOptionsChange({...l,jsonData:{...l.jsonData,[D]:C}})},f=(h,D,C)=>{const l=h.options;h.onOptionsChange({...l,secureJsonData:{...l.secureJsonData?l.secureJsonData:{},[D]:C}})},p=(h,D)=>{const C=h.options;h.onOptionsChange({...C,secureJsonData:{...C.secureJsonData?C.secureJsonData:{},[D]:""},secureJsonFields:{...C.secureJsonFields,[D]:!1}})}},14211:(q,j,e)=>{"use strict";e.d(j,{f:()=>t});var t=(n=>(n[n.Transformations=0]="Transformations",n[n.FieldConfig=1]="FieldConfig",n[n.FieldConfigOverrides=2]="FieldConfigOverrides",n))(t||{})},42344:(q,j,e)=>{"use strict";e.d(j,{R:()=>n,r:()=>r});var t=e(8392);function n({xField:a,yField:i,nullValueMode:x}){const s=a.values,c=i.values,d=s.length;if(c.length!==d)throw new Error("Unexpected field length");const u=x===t.UW.Ignore,g=x===t.UW.AsZero,o=[];for(let E=0;E<d;E++){const m=s[E];let f=c[E];if(f===null){if(u)continue;g&&(f=0)}m!==null&&o.push([m,f])}return o}function r(a,i){if(!i.from||!i.to||!a||a.length===0)return[];const x=i.from.valueOf(),s=i.to.valueOf(),c=a[0][1];return[[x,c],[s,c]]}},55515:(q,j,e)=>{"use strict";e.d(j,{Xy:()=>n,_p:()=>i,h6:()=>x,s6:()=>a,yO:()=>r});const t=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function n(s){const c={};return s.replace(t,(d,u,g,o)=>(c[u]=o,"")),c}function r(s){return s.reduce((c,d)=>{if(!d)throw new Error("Need parsed labels to find common labels.");return Object.keys(d).forEach(u=>{(c[u]===void 0||c[u]!==d[u])&&delete c[u]}),Object.keys(c).forEach(u=>{d[u]===void 0&&delete c[u]}),c},{...s[0]})}function a(s,c){const d={...s};return Object.keys(c).forEach(u=>{delete d[u]}),d}function i(s,c){if(!s)return!0;for(const[d,u]of Object.entries(s))if(!c||c[d]!==u)return!1;return!0}function x(s,c="",d){if(!s||Object.keys(s).length===0)return c;const g=Object.keys(s).sort().map(o=>`${o}="${s[o]}"`).join(", ");return d?g:["{",g,"}"].join("")}},2567:(q,j,e)=>{"use strict";e.d(j,{I:()=>g});var t=e(84099),n=e(93407);let r={appSubUrl:""},a,i;const x=o=>{try{return new URL(o)}catch{return}},s=o=>{const E=x(o);if(E&&E.origin!==window.location.origin)return o;const m=r.appSubUrl??"",f=m.endsWith("/")?1:0,p=o.startsWith("http");let h=m;return(!o.startsWith("/")||p)&&(h=`${window.location.origin}${m}`),o.length>0&&(o.indexOf(h+"/")===0||o===h)?o.slice(h.length-f):o},c=o=>o.startsWith("/")?`${r.appSubUrl}${s(o)}`:o,g={initialize:o=>{r=o.config,a=o.getTimeRangeForUrl,i=o.getVariablesUrlParams},stripBaseFromUrl:s,assureBaseUrl:c,updateSearchParams:(o,E)=>{const m=new URLSearchParams(E);try{const f=new URL(o);return m.forEach((p,h)=>f.searchParams.set(h,p)),f.href}catch{const f=new URLSearchParams(o);return m.forEach((p,h)=>{f.set(h,p)}),"?"+f.toString()}},getTimeRangeUrlParams:()=>a?n.kM.toUrlParams(a()):null,getVariablesUrlParams:o=>{if(!i)return null;const E=i(o);return n.kM.toUrlParams(E)},getUrlForPartial:(o,E)=>{const m=n.kM.parseKeyValue(o.search.startsWith("?")?o.search.substring(1):o.search);for(const f in E)E[f]===null||E[f]===void 0?delete m[f]:m[f]=E[f];return c(n.kM.renderUrl(o.pathname,m))},processUrl:o=>r.disableSanitizeHtml?o:t.sQ.sanitizeUrl(o)}},26023:(q,j,e)=>{"use strict";e.d(j,{Y:()=>t});function t(n){return new Proxy(n,{apply(r,a,i){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(r,i,a.constructor)}})}},6989:(q,j,e)=>{"use strict";e.d(j,{_:()=>t});function t(n,r){return r.id===n?!0:r.aliasIDs?r.aliasIDs.includes(n):!1}},12462:(q,j,e)=>{"use strict";e.d(j,{u:()=>t});var t=(n=>(n.id="id",n.title="title",n.subTitle="subtitle",n.mainStat="mainstat",n.secondaryStat="secondarystat",n.arc="arc__",n.icon="icon",n.color="color",n.source="source",n.target="target",n.detail="detail__",n.nodeRadius="noderadius",n.thickness="thickness",n.highlighted="highlighted",n.strokeDasharray="strokedasharray",n.fixedX="fixedx",n.fixedY="fixedy",n.isInstrumented="isinstrumented",n))(t||{})},12936:(q,j,e)=>{"use strict";e.d(j,{E:()=>n,h:()=>t});function t(r,a=0){if(Number.isInteger(r))return r;let i=10**a,x=r*i*(1+Number.EPSILON);return Math.round(x)/i}function n(r){return((""+r).split(".")[1]||"").length}},34923:(q,j,e)=>{"use strict";e.d(j,{R:()=>n,w:()=>t});const t=r=>Object.keys(r).reduce((a,i)=>(r[i]!==void 0&&(a[i]=r[i]),a),{}),n=r=>typeof r=="object"&&r!==null&&Object.keys(r).length===0},69199:(q,j,e)=>{"use strict";e.d(j,{M:()=>n});class t{get(a){return window.localStorage[a]}set(a,i){window.localStorage[a]=i}getBool(a,i){return i!==void 0&&!this.exists(a)?i:window.localStorage[a]==="true"}getObject(a,i){let x=i;if(this.exists(a)){const s=window.localStorage[a];try{x=JSON.parse(s)}catch(c){console.error(`Error parsing store object: ${a}. Returning default: ${i}. [${c}]`)}}return x}setObject(a,i){let x;try{x=JSON.stringify(i)}catch(s){throw new Error(`Could not stringify object: ${a}. [${s}]`)}try{this.set(a,x)}catch(s){const c=new Error(`Could not save item in localStorage: ${a}. [${s}]`);throw s instanceof Error&&(c.name=s.name),c}return!0}exists(a){return window.localStorage[a]!==void 0}delete(a){window.localStorage.removeItem(a)}}const n=new t},90808:(q,j,e)=>{"use strict";e.d(j,{_:()=>n,j:()=>r});var t=e(64015),n=(a=>(a.Abs="abs",a.Exp="exp",a.Ln="ln",a.Floor="floor",a.Ceil="ceil",a))(n||{});const r=new t.O(()=>[{id:"abs",name:"Absolute value",operation:a=>Math.abs(a),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:a=>Math.exp(a),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:a=>Math.log(a),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:a=>Math.floor(a),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:a=>Math.ceil(a),unaryOperationID:"ceil"}])},93407:(q,j,e)=>{"use strict";e.d(j,{Pp:()=>g,kM:()=>u,sQ:()=>o});var t=e(3202);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function n(E,m){return m&&Object.keys(m).length>0&&(E+="?"+a(m)),E}function r(E,m){return encodeURIComponent(E).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,m?"%20":"+").replace(/[!'()*]/g,function(f){return"%"+f.charCodeAt(0).toString(16).toUpperCase()})}function a(E,m=!0){const f=[],p=/\[\]$/,h=m?(v,y)=>r(v,y):(v,y)=>encodeURIComponent(v),D=v=>Object.prototype.toString.call(v)==="[object Array]",C=(v,y)=>{if(y=typeof y=="function"?y():y===null||y===void 0?"":y,typeof y!="boolean")f[f.length]=h(v,!0)+"="+h(y,!0);else{const P=y?"":"="+h("false",!0);f[f.length]=h(v,!0)+P}},l=(v,y)=>{let P,b,S;if(v)if(D(y))for(P=0,b=y.length;P<b;P++)p.test(v)?C(v,y[P]):l(v,y[P]);else if(y&&String(y)==="[object Object]")for(S in y)l(v+"["+S+"]",y[S]);else C(v,y);else if(D(y))for(P=0,b=y.length;P<b;P++)C(y[P].name,y[P].value);else for(S in y)l(S,y[S]);return f};return l("",E).join("&")}function i(E){return a(E,!1)}function x(E,m){if(m!=null&&m!==""){const f=E.indexOf("?");f!==-1?E.length-f>1&&(E+="&"):E+="?",E+=m}return E}function s(){const m=window.location.search.substring(1).split("&"),f={};for(const p of m){const h=p.split("=");if(h.length>1){const D=decodeURIComponent(h[0]),C=decodeURIComponent(h[1]);D in f?f[D]=[...f[D],C]:f[D]=[C]}else if(h.length===1){const D=decodeURIComponent(h[0]);f[D]=!0}}return f}function c(E){const m={},f=(E||"").split("&");for(let p of f){let h,D,C;if(p&&(D=p=p.replace(/\+/g,"%20"),h=p.indexOf("="),h!==-1&&(D=p.substring(0,h),C=p.substring(h+1)),D=d(D),D!==void 0)){C=C!==void 0?d(C):!0;let l;typeof C=="string"&&C!==""?l=C==="true"||C==="false"?C==="true":C:l=C,m.hasOwnProperty(D)?Array.isArray(m[D])?m[D].push(C):m[D]=[m[D],isNaN(l)?C:l]:m[D]=isNaN(l)?C:l}}return m}function d(E){try{return decodeURIComponent(E)}catch{return}}const u={renderUrl:n,toUrlParams:a,appendQueryToUrl:x,getUrlSearchParams:s,parseKeyValue:c,serializeParams:i};function g(E,m){return m!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(E)}const o=E=>{let m=E.from;(0,t.Ar)(m)&&(m=m.valueOf().toString());let f=E.to;return(0,t.Ar)(f)&&(f=f.valueOf().toString()),{from:m,to:f}}},16060:(q,j,e)=>{"use strict";e.d(j,{An:()=>x,Zz:()=>a,bh:()=>s});var t=e(42483),n=e(67793),r=e(65329);function a(d,u){for(const g of d)switch(g.type){case r.d.ValueToText:if(u==null)continue;const o=g.options[u];if(o)return o;break;case r.d.RangeToText:if(u==null)continue;const E=parseFloat(u);if(isNaN(E)||!isNaN(g.options.from)&&E<g.options.from||!isNaN(g.options.to)&&E>g.options.to)continue;return g.options.result;case r.d.RegexToText:if(u==null||typeof u!="string")continue;const p=(0,n.dO)(g.options.pattern);if(u.match(p)){const h={...g.options.result};return h.text!=null&&(h.text=u.replace(p,g.options.result.text||"")),h}case r.d.SpecialValue:switch(g.options.match){case r.W.Null:{if(u==null)return g.options.result;break}case r.W.NaN:{if(typeof u=="number"&&isNaN(u))return g.options.result;break}case r.W.NullAndNaN:{if(typeof u=="number"&&isNaN(u)||u==null)return g.options.result;break}case r.W.True:{if(u===!0||u==="true")return g.options.result;break}case r.W.False:{if(u===!1||u==="false")return g.options.result;break}case r.W.Empty:{if(u==="")return g.options.result;break}}}return null}function i(d){return(typeof d=="number"||typeof d=="string"&&d.trim()!=="")&&!isNaN(d)}var x=(d=>(d[d.ValueToText=1]="ValueToText",d[d.RangeToText=2]="RangeToText",d))(x||{});function s(d,u){const g=[];let o=d.mappingType;if(d.mappingType||(d.valueMaps&&d.valueMaps.length?o=1:d.rangeMaps&&d.rangeMaps.length&&(o=2)),o===1)for(let E=0;E<d.valueMaps.length;E++){const m=d.valueMaps[E];g.push(c({...m,id:E,type:r.d.ValueToText},d.fieldConfig?.defaults?.thresholds||u))}else if(o===2)for(let E=0;E<d.rangeMaps.length;E++){const m=d.rangeMaps[E];g.push(c({...m,id:E,type:r.d.RangeToText},d.fieldConfig?.defaults?.thresholds||u))}return g}function c(d,u){const g={type:r.d.ValueToText,options:{}},o=[];let E;const m=parseFloat(d.text);if(u&&!isNaN(m)){const f=(0,t.yQ)(m,u.steps);f&&f.color&&(E=f.color)}switch(d.type){case 1:case r.d.ValueToText:d.value!=null&&(d.value==="null"?o.push({type:r.d.SpecialValue,options:{match:r.W.Null,result:{text:d.text,color:E}}}):g.options[String(d.value)]={text:d.text,color:E});break;case 2:case r.d.RangeToText:d.from==="null"||d.to==="null"?o.push({type:r.d.SpecialValue,options:{match:r.W.Null,result:{text:d.text,color:E}}}):o.push({type:r.d.RangeToText,options:{from:+d.from,to:+d.to,result:{text:d.text,color:E}}});break}return Object.keys(g.options).length>0&&o.unshift(g),o[0]}},34227:(q,j,e)=>{"use strict";e.d(j,{E:()=>n,c:()=>r});const t="__searchFilter",n=a=>a&&typeof a=="string"?a.indexOf(t)!==-1:!1,r=a=>{const{query:i,wildcardChar:x}=a;if(!n(i))return{};let{options:s}=a;return s=s||{searchFilter:""},{__searchFilter:{value:s.searchFilter?`${s.searchFilter}${x}`:`${x}`,text:""}}}},78137:(q,j,e)=>{"use strict";e.d(j,{k:()=>i});var t=e(44240),n=e(39697),r=e(65961),a=e(67791);function i({whileLoading:x,source:s}){return(0,t.h)((0,n.O)(200).pipe((0,r.u)(x),(0,a.Q)(s)),s)}},54850:(q,j,e)=>{"use strict";e.d(j,{$:()=>n});var t=e(98486);class n extends t.F{constructor(a){return super(),this.buffer=a.buffer||[],this.capacity=this.buffer.length,this.tail=a.append!=="head",this.index=0,this.add=this.getAddFunction(),a.capacity&&this.setCapacity(a.capacity),new Proxy(this,{get(i,x,s){if(typeof x!="symbol"){const c=+x;if(String(c)===x)return i.get(c)}return Reflect.get(i,x,s)},set(i,x,s,c){if(typeof x!="symbol"){const d=+x;if(String(d)===x)return i.set(d,s),!0}return Reflect.set(i,x,s,c)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?a=>{this.buffer.push(a),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:a=>{this.buffer.unshift(a),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?a=>{this.buffer[this.index]=a,this.index=(this.index+1)%this.buffer.length}:a=>{let i=this.index-1;i<0&&(i=this.buffer.length-1),this.buffer[i]=a,this.index=i}}setCapacity(a){if(this.capacity===a)return;const i=this.toArray();if(a>this.length)this.buffer=i;else if(a<this.capacity){const x=this.length-a;this.tail?this.buffer=i.slice(x,i.length):this.buffer=i.slice(0,i.length-x)}this.capacity=a,this.index=0,this.add=this.getAddFunction()}setAppendMode(a){const i=a!=="head";i!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=i,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(a){return this.buffer[(a+this.index)%this.buffer.length]}set(a,i){this.buffer[(a+this.index)%this.buffer.length]=i}get length(){return this.buffer.length}}},98486:(q,j,e)=>{"use strict";e.d(j,{E:()=>i,F:()=>r});var t,n;class r{constructor(){this[t]={}}*iterator(){for(let s=0;s<this.length;s++)yield this.get(s)}set(s,c){throw"unsupported operation"}add(s){throw"unsupported operation"}push(...s){for(const c of s)this.add(c);return this.length}[(n=Symbol.iterator,t=Symbol.unscopables,n)](){return this.iterator()}forEach(s){return i(this).forEach(s)}map(s){return i(this).map(s)}filter(s){return i(this).filter(s)}at(s){return this.get(s)}toArray(){const s=new Array(this.length);for(let c=0;c<this.length;c++)s[c]=this.get(c);return s}join(s){return this.toArray().join(s)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...s){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(s){throw new Error("Method not implemented.")}splice(s,c,...d){throw new Error("Method not implemented.")}unshift(...s){throw new Error("Method not implemented.")}fill(s,c,d){throw new Error("Method not implemented.")}copyWithin(s,c,d){throw new Error("Method not implemented.")}slice(s,c){return this.toArray().slice(s,c)}indexOf(s,c){return this.toArray().indexOf(s,c)}lastIndexOf(s,c){return this.toArray().lastIndexOf(s,c)}every(s,c){return this.toArray().every(s,c)}some(s,c){return this.toArray().some(s,c)}reduce(s,c){throw new Error("Method not implemented.")}reduceRight(s,c){throw new Error("Method not implemented.")}find(s,c){return this.toArray().find(s,c)}findIndex(s,c){return this.toArray().findIndex(s,c)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(s,c){return this.toArray().includes(s,c)}flatMap(s,c){return this.toArray().flatMap(s,c)}flat(s){throw new Error("Method not implemented.")}}const a=[];function i(x){return{*[Symbol.iterator](){for(let s=0;s<x.length;s++)yield x.get(s)},forEach(s){for(let c=0;c<x.length;c++)s(x.get(c),c,a)},map(s){const c=[];for(let d=0;d<x.length;d++)c.push(s(x.get(d),d,a));return c},filter(s){const c=[];let d=0;for(const u of this)s(u,d++,a)&&c.push(u);return c}}}},29927:(q,j,e)=>{"use strict";e.d(j,{t:()=>a});var t=e(21489),n=e(18990),r=e(11222);function a(d,u,g,o="="){if(!u||!g)throw new Error("Need label to add to query.");const E=i(d);if(!E.length)return d;const m=x(u,g,o);return s(d,E,m)}function i(d){const u=t.K3.parse(d),g=[];return u.iterate({enter:({to:o,from:E,type:m})=>{if(m.id===t.Fb){const f=(0,r.u)(d.substring(E,o));return g.push({query:f.query,from:E,to:o}),!1}}}),g}function x(d,u,g){const o=u===1/0?"+Inf":u.toString();return{label:d,op:g,value:o}}function s(d,u,g){const o=new n.l;let E="",m=0;for(let f=0;f<u.length;f++){const p=u[f],h=f===u.length-1,D=d.substring(m,p.from),C=h?d.substring(p.to):"";c(p.query.labels,g)||p.query.labels.push(g);const l=o.renderQuery(p.query);E+=D+l+C,m=p.to}return E}function c(d,u){return d.find(g=>g.label===u.label&&g.value===u.value)}},84204:(q,j,e)=>{"use strict";e.d(j,{L:()=>_n});var t=e(74848),n=e(22803),r=e(96540),a=e(4038),i=e(33870),x=e(58779),s=e(56276),c=e(79784),d=e(54594),u=e(29675),g=e(87574),o=e(56958);function E(Ot){return typeof Ot=="object"&&Ot!==null&&"isCanceled"in Ot}const m=Ot=>{let Rt=!1;return{promise:new Promise((dt,lt)=>{const Pt={isCanceled:!0};Ot.then(Bt=>Rt?lt(Pt):dt(Bt)),Ot.catch(Bt=>lt(Rt?Pt:Bt))}),cancel(){Rt=!0}}};var f=e(21489),p=e(75357),h=e(39554),D=e(24726),C=e(86618);function l(){const Ot=new Map;return Ot.set("expandSuggestionDocs","true"),{onDidChangeValue:Rt=>{},onDidChangeTarget:Rt=>{},onWillSaveState:Rt=>{},get:(Rt,Ye,dt)=>Ot.get(Rt)??dt,getBoolean:(Rt,Ye,dt)=>{const lt=Ot.get(Rt);return lt!==void 0?lt==="true":dt},getNumber:(Rt,Ye,dt)=>{const lt=Ot.get(Rt);return lt!==void 0?parseInt(lt,10):dt},store:(Rt,Ye,dt,lt)=>{Ye==null?Ot.delete(Rt):Ot.set(Rt,Ye.toString())},remove:(Rt,Ye)=>{Ot.delete(Rt)},keys:(Rt,Ye)=>Array.from(Ot.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:Rt=>!0,flush:Rt=>Promise.resolve(void 0)}}let v=null;function y(){return v===null&&(v={storageService:l()}),v}var P=e(84139),b=e(32370),S=e(15511),M=e(93981),O=e(23401);class R extends Error{constructor(Rt){super("should never happen")}}const L=4,B={multiInsert:new P.A({intraMode:0}),singleError:new P.A({intraMode:1})},F="${1:}";function I({metricNames:Ot,inputText:Rt,limit:Ye}){if(!Rt?.trim())return Ot.slice(0,Ye);const Pt=B.multiInsert.split(Rt).length>4?B.multiInsert.filter(Ot,Rt):B.singleError.filter(Ot,Rt);return Pt?Pt.slice(0,Ye).map(Bt=>Ot[Bt]):[]}function U(Ot){let Rt=Ot.getAllMetricNames();if(b.$.featureToggles.prometheusCodeModeMetricNamesSearch&&Rt.length>Ot.metricNamesSuggestionLimit){const{monacoSettings:Ye}=Ot;Ye.enableAutocompleteSuggestionsUpdate(),Ye.inputInRange?Rt=I({metricNames:Rt,inputText:Ye.inputInRange,limit:Ot.metricNamesSuggestionLimit}):Rt=Rt.slice(0,Ot.metricNamesSuggestionLimit)}return Ot.metricNamesToMetrics(Rt).map(Ye=>({type:"METRIC_NAME",label:Ye.name,detail:`${Ye.name} : ${Ye.type}`,documentation:Ye.help,...Ye.isUtf8?{insertText:`{"${Ye.name}"${F}}`,insertTextRules:L}:{insertText:Ye.name}}))}const W=M.AW.map(Ot=>({type:"FUNCTION",label:Ot.label,insertText:Ot.insertText??"",detail:Ot.detail,documentation:Ot.documentation}));async function A(Ot){const Rt=U(Ot);return[...W,...Rt]}const N=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(Ot=>({type:"DURATION",label:Ot,insertText:Ot}));function K(Ot){return Ot.getHistory().slice(0,10).map(Ye=>({type:"HISTORY",label:Ye,insertText:Ye}))}function V(Ot,Rt){const Ye=[...Rt];return Ot!==void 0&&Ye.push({name:"__name__",value:Ot,op:"="}),`{${Ye.map(lt=>`${lt.name}${lt.op}"${(0,g.Qn)(lt.value)}"`).join(",")}}`}async function T(Ot,Rt,Ye){if(Ot===void 0&&Rt.length===0)return Promise.resolve(Ye.getAllLabelNames());{const dt=V(Ot,Rt);return await Ye.getSeriesLabels(dt,Rt)}}async function z(Ot,Rt,Ye,dt,lt){return(await T(Ot,dt,lt)).map(Bt=>{const Jt=!(0,O.Rq)(Bt);return{type:"LABEL_NAME",label:Bt,...Jt?{insertText:`"${Bt}"${Rt}`,insertTextRules:L}:{insertText:`${Bt}${Rt}`},triggerOnInsert:Ye}})}async function w(Ot,Rt,Ye){return z(Ot,"=",!0,Rt,Ye)}async function H(Ot,Rt,Ye){return z(Ot,"",!1,Rt,Ye)}async function G(Ot,Rt,Ye,dt){if(Ot===void 0&&Ye.length===0)return dt.getLabelValues(Rt);{const lt=V(Ot,Ye);return await dt.getSeriesValues(Rt,lt)}}async function X(Ot,Rt,Ye,dt,lt){return(await G(Ot,Rt,dt,lt)).map(Bt=>({type:"LABEL_VALUE",label:Bt,insertText:k(Bt,Ye)}))}function k(Ot,Rt){const Ye=b.$.featureToggles.prometheusSpecialCharsInLabelValues?(0,S.ee)(Ot):Ot;return Rt?Ye:`"${Ye}"`}function _(Ot,Rt){switch(Ot.type){case"IN_DURATION":return Promise.resolve(N);case"IN_FUNCTION":return A(Rt);case"AT_ROOT":return A(Rt);case"EMPTY":{const Ye=U(Rt),dt=K(Rt);return Promise.resolve([...dt,...W,...Ye])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return w(Ot.metricName,Ot.otherLabels,Rt);case"IN_GROUPING":return H(Ot.metricName,Ot.otherLabels,Rt);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return X(Ot.metricName,Ot.labelName,Ot.betweenQuotes,Ot.otherLabels,Rt);default:throw new R(Ot)}}function ee(Ot,Rt){switch(Rt){case"parent":return Ot.parent;case"firstChild":return Ot.firstChild;case"lastChild":return Ot.lastChild;case"nextSibling":return Ot.nextSibling;default:throw new R(Rt)}}function J(Ot,Rt){let Ye=Ot;for(const[dt,lt]of Rt)if(Ye=ee(Ye,dt),Ye===null||Ye.type.id!==lt)return null;return Ye}function Z(Ot,Rt,Ye){const dt=Ye?Ot.from+1:Ot.from,lt=Ye?Ot.to-1:Ot.to;return Rt.slice(dt,lt)}function te(Ot){const Rt=Ot.slice(1,Ot.length-1);if(Ot.startsWith('"')&&Ot.endsWith('"'))return Rt.replace(/\\"/,'"');if(Ot.startsWith("'")&&Ot.endsWith("'"))return Rt.replace(/\\'/,"'");if(Ot.startsWith("`")&&Ot.endsWith("`"))return Rt;throw new Error("FIXME: invalid string literal")}function ae(Ot,Rt){return Ot.every((Ye,dt)=>Ye===Rt[dt])}const re=0,ne=[{path:[f.ww,f.Fb],fun:we},{path:[f.LW,f.c6,f.ww,f.Fb],fun:$e},{path:[f.ab],fun:Se},{path:[f.Dh],fun:Xe},{path:[f.LW,f.Yq],fun:Ee},{path:[f.LW,f.d2],fun:be},{path:[re,f.df,f.ab],fun:Se},{path:[re,f.Yq],fun:Ee},{path:[re,f.d2],fun:be},{path:[re,f.TG,f.l4],fun:Qe},{path:[f.x$],fun:Pe}],ce=new Map([[f.Hl,"="],[f.Ed,"=~"],[f.l3,"!="],[f.$i,"!~"]]);function le(Ot){const Rt=Ot.firstChild;return Rt===null?null:ce.get(Rt.type.id)??null}function he(Ot,Rt){if(!new Set([f.Yq,f.d2]).has(Ot.type.id))return null;const dt=J(Ot,[["firstChild",f.IC]])??J(Ot,[["firstChild",f.c6]]);if(dt===null)return null;const lt=J(dt,[["nextSibling",f.Lf]]);if(lt===null)return null;const Pt=le(lt);if(Pt===null)return null;const Bt=J(Ot,[["lastChild",f.LW]]);if(Bt===null)return null;const Jt=Z(dt,Rt),qt=te(Z(Bt,Rt));return{name:Jt,value:qt,op:Pt}}function oe(Ot,Rt){return Ot.type.id!==f.ww?[]:[f.Yq,f.d2].reduce((dt,lt)=>(Ot.getChildren(lt).forEach(Pt=>{const Bt=he(Pt,Rt);Ge(Bt)&&dt.push(Bt)}),dt),[])}function de(Ot){let Rt=Ot.firstChild;const Ye=[];for(;Rt!==null;)Ye.push(Rt),Rt=Rt.nextSibling;return Ye}function me(Ot,Rt){if(Ot.type.id===Rt)return Ot;const Ye=de(Ot);for(const dt of Ye){const lt=me(dt,Rt);if(lt!==null)return lt}return null}function Pe(Ot,Rt,Ye){const dt=J(Ot,[["parent",f.hI],["parent",f.Fn]]);if(dt===null)return null;const lt=dt.getChild(f.Dh);if(lt===null)return null;const Pt=me(lt,f.gw)??me(lt,f.LW);return!Pt||Pt.type.id===f.LW&&Pt.parent?.type.id!==f.c6?null:{type:"IN_GROUPING",metricName:Z(Pt,Rt,Pt.type.id===f.LW),otherLabels:[]}}function Ee(Ot,Rt,Ye){const dt=!Ot.type.isError,lt=J(Ot,[["parent",f.Yq]]);if(lt===null)return null;const Pt=J(lt,[["firstChild",f.IC]]);if(Pt===null)return null;const Bt=Z(Pt,Rt),Jt=J(lt,[["parent",f.ww]]);if(Jt===null)return null;const gn=oe(Jt,Rt).filter(Tn=>Tn.name!==Bt),On=Fe(Jt,Rt);return{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:Bt,betweenQuotes:dt,otherLabels:gn,...On?{metricName:On}:{}}}function be(Ot,Rt,Ye){const dt=!Ot.type.isError,lt=J(Ot,[["parent",f.d2]]);if(lt===null)return null;const Pt=J(lt,[["firstChild",f.c6]]);if(Pt===null)return null;const Bt=Z(Pt,Rt),Jt=J(lt,[["parent",f.ww]]);if(Jt===null)return null;const gn=oe(Jt,Rt).filter(Tn=>Tn.name!==Bt),On=Fe(lt.parent,Rt);return{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:Bt,betweenQuotes:dt,otherLabels:gn,...On?{metricName:On}:{}}}function Se(Ot,Rt,Ye){return{type:"AT_ROOT"}}function Xe(Ot,Rt,Ye){return{type:"IN_FUNCTION"}}function Qe(Ot,Rt,Ye){return{type:"IN_DURATION"}}function we(Ot,Rt,Ye){let dt=J(Ot,[["firstChild",f.Yq]]);if(dt!==null&&!Rt.slice(dt.to,Ye).includes(",")||(dt=J(Ot,[["firstChild",f.c6]]),dt!==null&&!Rt.slice(dt.to,Ye).includes(",")))return null;const lt=oe(Ot,Rt),Pt=Fe(Ot,Rt);return{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:lt,betweenQuotes:!1,...Pt?{metricName:Pt}:{}}}function $e(Ot,Rt,Ye){const dt=oe(Ot,Rt),lt=Ot.parent?.parent?Fe(Ot.parent.parent,Rt):null;return{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:dt,betweenQuotes:!0,...lt?{metricName:lt}:{}}}function Fe(Ot,Rt){const Ye=J(Ot,[["parent",f.Fb],["firstChild",f.gw]]);if(Ye)return Z(Ye,Rt);const dt=J(Ot,[["parent",f.Fb],["firstChild",f.ww],["firstChild",f.c6],["firstChild",f.LW]]);return dt?Z(dt,Rt,!0):null}function Te(Ot,Rt){const Ye=Ot.cursorAt(Rt);for(;;){if(Ye.from===Rt&&Ye.to===Rt){const{node:dt}=Ye;if(dt.type.isError)return dt}if(!Ye.next())break}return null}function Le(Ot,Rt){if(Ot==="")return{type:"EMPTY"};const Ye=f.K3.parse(Ot),dt=Te(Ye,Rt),lt=dt!=null?dt.cursor():Ye.cursorAt(Rt),Pt=lt.node,Bt=[lt.type.id];for(;lt.parent();)Bt.push(lt.type.id);for(let Jt of ne)if(ae(Jt.path,Bt))return Jt.fun(Pt,Ot,Rt);return null}function Ge(Ot){return Ot!=null}function Me(){return{showWords:!1}}function De(Ot,Rt){switch(Ot){case"DURATION":return Rt.languages.CompletionItemKind.Unit;case"FUNCTION":return Rt.languages.CompletionItemKind.Variable;case"HISTORY":return Rt.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return Rt.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return Rt.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return Rt.languages.CompletionItemKind.Constructor;default:throw new R(Ot)}}function Ke(Ot,Rt){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(dt,lt)=>{const Pt=dt.getWordAtPosition(lt),Bt=Pt!=null?Ot.Range.lift({startLineNumber:lt.lineNumber,endLineNumber:lt.lineNumber,startColumn:Pt.startColumn,endColumn:Pt.endColumn}):Ot.Range.fromPositions(lt),Jt={column:lt.column,lineNumber:lt.lineNumber};if(Rt.monacoSettings.setInputInRange(dt.getValueInRange(Bt)),window.getSelection){const Tn=window.getSelection()?.toString();Tn&&Tn.length>0&&(Jt.column=Jt.column-Tn.length)}const qt=dt.getOffsetAt(Jt),gn=Le(dt.getValue(),qt);return(gn!=null?_(gn,Rt):Promise.resolve([])).then(Tn=>{const wn=Tn.length.toString().length;return{suggestions:Tn.map((es,ls)=>({kind:De(es.type,Ot),label:es.label,insertText:es.insertText,insertTextRules:es.insertTextRules,detail:es.detail,documentation:es.documentation,sortText:ls.toString().padStart(wn,"0"),range:Bt,command:es.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:Rt.monacoSettings.suggestionsIncomplete}})}}}var Ie=e(31320);const Ne=0;function ie(Ot,Rt,Ye,dt){if(!Ot)return!1;const lt=ve(Rt,dt);if(!lt.length)return!1;let Pt=lt;if(Ot!==Rt){const Bt=ve(Ot,dt);Pt=lt.flatMap(Jt=>Bt.filter(qt=>Jt.text===qt.text)||Jt)}return Pt.map(Bt=>fe(Ot,Ye,Bt)).filter(ge)}function ve(Ot,Rt){const Ye=[];return Rt.parse(Ot).iterate({enter:lt=>{if(lt.type.id===Ne){const Pt=lt.node;Ye.push({node:Pt,text:Ot.substring(Pt.from,Pt.to)})}}}),Ye}function fe(Ot,Rt,Ye){if(Rt.length===1){const Pt=Ye.node.from===Ye.node.to,Bt=Pt&&Ye.node.parent?Ye.node.parent:Ye.node,Jt=Pt?Ot.substring(Bt.from,Bt.to):Ye.text;return{startLineNumber:1,startColumn:Bt.from+1,endLineNumber:1,endColumn:Bt.to+1,error:Jt}}let dt=0,lt=0;for(let Pt=0;Pt<Rt.length;Pt++){if(lt=dt+Rt[Pt].length,Ye.node.from>lt){dt+=Rt[Pt].length+1;continue}return{startLineNumber:Pt+1,startColumn:Ye.node.from-dt+1,endLineNumber:Pt+1,endColumn:Ye.node.to-dt+1,error:Ye.text}}return null}function ge(Ot){return Ot!==null}const xe={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},je={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},Ve=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],ke=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","double_exponential_smoothing","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],Oe=[];for(let Ot=0,Rt=Ve;Ot<Rt.length;Ot++){let Ye=Rt[Ot];Oe.push(Ye+"_over_time")}const nt=["on","ignoring","group_right","group_left","by","without"],Je="("+nt.reduce(function(Ot,Rt){return Ot+"|"+Rt})+")",Be=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Ze=["offset"],Re={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:Ve.concat(ke).concat(Oe).concat(nt).concat(Ze),operators:Be,vectorMatching:Je,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},at={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:Me(),suggestFontSize:12,wordWrap:"on"},yt=2,ze=p.Y.id;let st=!1;function ht(Ot){if(st===!1){st=!0;const{aliases:Rt,extensions:Ye,mimetypes:dt}=p.Y;Ot.languages.register({id:ze,aliases:Rt,extensions:Ye,mimetypes:dt}),Ot.languages.setMonarchTokensProvider(ze,Re),Ot.languages.setLanguageConfiguration(ze,je)}}const It=(Ot,Rt)=>({container:(0,n.css)({borderRadius:Ot.shape.radius.default,border:`1px solid ${Ot.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%",overflow:"hidden"}),placeholder:(0,n.css)({"::after":{content:`'${Rt}'`,fontFamily:Ot.typography.fontFamilyMonospace,opacity:.6}})}),un=Ot=>{const Rt=(0,D.A)(),Ye=(0,r.useRef)(y()),dt=(0,r.useRef)(null),{languageProvider:lt,history:Pt,onBlur:Bt,onRunQuery:Jt,initialValue:qt,placeholder:gn,datasource:On}=Ot,Tn=(0,h.A)(lt),wn=(0,h.A)(Pt),ps=(0,h.A)(Jt),es=(0,h.A)(Bt),ls=(0,r.useRef)(null),Lt=(0,u.$j)(),$t=It(Lt,gn);return(0,r.useEffect)(()=>()=>{ls.current?.()},[]),(0,t.jsx)("div",{"data-testid":x.Tp.components.QueryField.container,className:$t.container,ref:dt,children:(0,t.jsx)(C.m,{saveViewState:!0,overrideServices:Ye.current,options:at,language:"promql",value:qt,beforeMount:nn=>{ht(nn)},onMount:(nn,on)=>{const bn=nn.createContextKey("isEditorFocused"+Rt,!1);nn.onDidBlurEditorWidget(()=>{bn.set(!1),es.current(nn.getValue())}),nn.onDidFocusEditorText(()=>{bn.set(!0)});const In=new Ie.M9({historyProvider:wn.current,languageProvider:Tn.current}),Yn=Ke(on,In),zn={...Yn,provideCompletionItems:(Qt,an,mn,yn)=>nn.getModel()?.id!==Qt.id?{suggestions:[]}:Yn.provideCompletionItems(Qt,an,mn,yn)},{dispose:St}=on.languages.registerCompletionItemProvider(ze,zn);ls.current=St;const zt=()=>{const Qt=dt.current;if(Qt!==null){const an=nn.getContentHeight();Qt.style.height=`${an+yt}px`,Qt.style.width="100%";const mn=Qt.clientWidth;nn.layout({width:mn,height:an})}};if(nn.onDidContentSizeChange(zt),zt(),nn.addCommand(on.KeyMod.Shift|on.KeyCode.Enter,()=>{ps.current(nn.getValue())},"isEditorFocused"+Rt),on.editor.addKeybindingRule({keybinding:on.KeyMod.CtrlCmd|on.KeyCode.KeyF,command:null}),nn.addCommand(on.KeyMod.CtrlCmd|on.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),gn){const Qt=[{range:new on.Range(1,1,1,1),options:{className:$t.placeholder,isWholeLine:!0}}];let an=[];const mn=()=>{const yn=nn.getModel();if(!yn)return;const Ct=yn.getValueLength()===0?Qt:[];an=yn.deltaDecorations(an,Ct)};mn(),nn.onDidChangeModelContent(mn),nn.onDidChangeModelContent(yn=>{const Ct=nn.getModel();if(!Ct)return;const ut=Ct.getValue(),Ut=(ie(ut,On.interpolateString(ut,xe),Ct.getLinesContent(),f.K3)||[]).map(({error:Wt,...gt})=>({message:`${Wt?`Error parsing "${Wt}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:on.MarkerSeverity.Error,...gt}));on.editor.setModelMarkers(Ct,"owner",Ut)})}}})})},vn=Ot=>(0,t.jsx)(r.Suspense,{fallback:null,children:(0,t.jsx)(un,{...Ot})}),pn=Ot=>{const Rt=(0,r.useRef)(null),{onRunQuery:Ye,onChange:dt,...lt}=Ot,Pt=Jt=>{Rt.current=Jt,dt(Jt),Ye()},Bt=Jt=>{dt(Jt)};return(0,t.jsx)(vn,{onRunQuery:Pt,onBlur:Bt,...lt})},xn="grafana.datasources.prometheus.browser.labels";function cn(Ot,Rt,Ye){return Ot?"(Disabled)":Rt?Ye?"Metrics browser":"(No metrics found)":"Loading metrics..."}class jn extends r.PureComponent{constructor(Rt){super(Rt),this.refreshHint=()=>{const{datasource:Ye,query:dt,data:lt}=this.props,Pt=Ye.getInitHints(),Bt=Pt.length>0?Pt[0]:null;if(!lt||lt.series.length===0){this.setState({hint:Bt});return}const Jt=(0,a.ci)(lt.series[0])?lt.series.map(a.w3):lt.series,qt=Ye.getQueryHints(dt,Jt);let gn=qt.length>0?qt[0]:null;this.setState({hint:gn??Bt})},this.refreshMetrics=async()=>{const{range:Ye,datasource:{languageProvider:dt}}=this.props;this.languageProviderInitializationPromise=m(dt.start(Ye));try{const lt=await this.languageProviderInitializationPromise.promise;await Promise.all(lt),this.onUpdateLanguage()}catch(lt){if(!(E(lt)&&lt.isCanceled))throw lt}},this.onChangeLabelBrowser=Ye=>{this.onChangeQuery(Ye,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(Ye,dt)=>{const{query:lt,onChange:Pt,onRunQuery:Bt}=this.props;if(Pt){const Jt={...lt,expr:Ye};Pt(Jt),dt&&Bt&&Bt()}},this.onClickChooserButton=()=>{this.setState(Ye=>({labelBrowserVisible:!Ye.labelBrowserVisible})),(0,s.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:Ye,query:dt,onChange:lt,onRunQuery:Pt}=this.props,{hint:Bt}=this.state;Bt?.fix?.action&&lt(Ye.modifyQuery(dt,Bt.fix.action)),Pt()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:Ye}}=this.props,{metrics:dt}=Ye;dt&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(Rt){const{data:Ye,datasource:{languageProvider:dt},range:lt}=this.props;dt!==Rt.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const Pt=this.rangeChangedToRefresh(lt,Rt.range);(dt!==Rt.datasource.languageProvider||Pt)&&this.refreshMetrics(),Ye&&Rt.data&&Rt.data.series!==Ye.series&&this.refreshHint()}rangeChangedToRefresh(Rt,Ye){if(Rt&&Ye){const dt=(0,g.eN)(Rt.from.valueOf())===(0,g.eN)(Ye.from.valueOf()),lt=(0,g.eN)(Rt.to.valueOf())===(0,g.eN)(Ye.to.valueOf());return!(dt&&lt)}return!1}render(){const{datasource:Rt,datasource:{languageProvider:Ye},query:dt,ExtraFieldElement:lt,history:Pt=[],theme:Bt}=this.props,{labelBrowserVisible:Jt,syntaxLoaded:qt,hint:gn}=this.state,On=Ye.metrics.length>0,Tn=cn(Rt.lookupsDisabled,qt,On),wn=!(qt&&On);return(0,t.jsx)(i.b,{storageKey:xn,defaultValue:[],children:(ps,es,ls)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:[(0,t.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:wn,type:"button","data-testid":x.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton,children:[Tn,(0,t.jsx)(c.I,{name:Jt?"angle-down":"angle-right"})]}),(0,t.jsx)("div",{className:"flex-grow-1 min-width-15",children:(0,t.jsx)(pn,{languageProvider:Ye,history:Pt,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:dt.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:Rt})})]}),Jt&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(o.ur,{languageProvider:Ye,onChange:this.onChangeLabelBrowser,lastUsedLabels:ps||[],storeLastUsedLabels:es,deleteLastUsedLabels:ls,timeRange:this.props.range})}),lt,gn?(0,t.jsx)("div",{className:(0,n.css)({flexBasis:"100%"}),children:(0,t.jsxs)("div",{className:"text-warning",children:[gn.label," ",gn.fix?(0,t.jsx)("button",{type:"button",className:(0,n.cx)((0,d.my)(Bt),"text-link","muted"),onClick:this.onClickHintFix,children:gn.fix.label}):null]})}):null]})})}}const _n=(0,u.cV)(jn)},56958:(q,j,e)=>{"use strict";e.d(j,{_N:()=>C,bS:()=>l,ur:()=>S});var t=e(74848),n=e(22803),r=e(96540),a=e(91793),i=e(58779),x=e(90617),s=e(81876),c=e(48583),d=e(40271),u=e(34128),g=e(53112),o=e(54594),E=e(29675),m=e(87574),f=e(23401);const p="{}",h="__name__",D=25,C="40000",l="none";function v(M){let O="";const R=[];for(const F of M)if((F.name===h||F.selected)&&F.values&&F.values.length>0){const I=F.values.filter(U=>U.selected).map(U=>U.name);I.length>1?R.push(`${(0,f.Nc)(F.name)}=~"${I.map(m.Cs).join("|")}"`):I.length===1&&(F.name===h?O=I[0]:R.push(`${(0,f.Nc)(F.name)}="${(0,m.Qn)(I[0])}"`))}const L=[];return O===""||(0,f.Rq)(O)?L.push(O,"{"):(L.push("{",`"${O}"`),R.length>0&&L.push(",")),L.push(R.join(","),"}"),L.join("")}function y(M,O,R){return M.map(L=>{const B=O[L.name];if(B){let F;if(L.name===R&&L.values)F=L.values;else{const I=new Set(L.values?.filter(U=>U.selected).map(U=>U.name)||[]);F=B.map(U=>({name:U,selected:I.has(U)}))}return{...L,loading:!1,values:F,hidden:!B,facets:F.length}}return{...L,loading:!1,hidden:!B,values:void 0,facets:0}})}const P=(0,x.N)(M=>({wrapper:(0,n.css)({backgroundColor:M.colors.background.secondary,padding:M.spacing(1),width:"100%"}),list:(0,n.css)({marginTop:M.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,n.css)({"& + &":{margin:`${M.spacing(2)} 0`},position:"relative"}),selector:(0,n.css)({fontFamily:M.typography.fontFamilyMonospace,marginBottom:M.spacing(1)}),status:(0,n.css)({padding:M.spacing(.5),color:M.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[M.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,n.css)({opacity:1}),error:(0,n.css)({color:M.colors.error.main}),valueList:(0,n.css)({marginRight:M.spacing(1),resize:"horizontal"}),valueListWrapper:(0,n.css)({borderLeft:`1px solid ${M.colors.border.medium}`,margin:`${M.spacing(1)} 0`,padding:`${M.spacing(1)} 0 ${M.spacing(1)} ${M.spacing(1)}`}),valueListArea:(0,n.css)({display:"flex",flexWrap:"wrap",marginTop:M.spacing(1)}),valueTitle:(0,n.css)({marginLeft:`-${M.spacing(.5)}`,marginBottom:M.spacing(1)}),validationStatus:(0,n.css)({padding:M.spacing(.5),marginBottom:M.spacing(1),color:M.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class b extends r.Component{constructor(){super(...arguments),this.valueListsRef=r.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=O=>{this.setState({labelSearchTerm:O.target.value})},this.onChangeMetricSearch=O=>{this.setState({metricSearchTerm:O.target.value})},this.onChangeSeriesLimit=O=>{this.setState({seriesLimit:O.target.value.trim()})},this.onChangeValueSearch=O=>{this.setState({valueSearchTerm:O.target.value})},this.onClickRunQuery=()=>{const O=v(this.state.labels);this.props.onChange(O)},this.onClickRunRateQuery=()=>{const R=`rate(${v(this.state.labels)}[$__rate_interval])`;this.props.onChange(R)},this.onClickClear=()=>{this.setState(O=>({labels:O.labels.map(L=>({...L,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(h,p)},this.onClickLabel=(O,R,L)=>{const B=this.state.labels.find(U=>U.name===O);if(!B)return;const F=!B.selected;let I={selected:F};if(B.values&&!F){const U=B.values.map(W=>({...W,selected:!1}));I={...I,facets:0,values:U}}this.setState({labelSearchTerm:""}),this.updateLabelState(O,I,"",()=>this.doFacettingForLabel(O))},this.onClickValue=(O,R,L)=>{const B=this.state.labels.find(I=>I.name===O);if(!B||!B.values)return;this.setState({labelSearchTerm:""});const F=B.values.map(I=>({...I,selected:I.name===R?!I.selected:I.selected}));this.updateLabelState(O,{values:F},"",()=>this.doFacetting(O))},this.onClickMetric=(O,R,L)=>{const B=this.state.labels.find(U=>U.name===O);if(!B||!B.values)return;this.setState({metricSearchTerm:""});const F=B.values.map(U=>({...U,selected:U.name===R||U.selected?!U.selected:U.selected})),I=F.some(U=>U.selected);this.updateLabelState(O,{selected:I,values:F},"",()=>this.doFacetting(O))},this.onClickValidate=()=>{const O=v(this.state.labels);this.validateSelector(O)},this.doFacetting=O=>{const R=v(this.state.labels);if(R===p){const L=this.state.labels.map(B=>({...B,facets:0,values:void 0,hidden:!1}));this.setState({labels:L},()=>{this.state.labels.forEach(B=>(B.selected||B.name===h)&&this.fetchValues(B.name,R))})}else this.fetchSeries(R,O)}}updateLabelState(O,R,L="",B){this.setState(F=>{const I=F.labels.map(W=>W.name===O?{...W,...R}:W),U=L?"":F.error;return{labels:I,status:L,error:U,validationStatus:""}},B)}componentDidMount(){const{languageProvider:O,lastUsedLabels:R}=this.props;if(O){const L=R;O.start(this.props.timeRange).then(()=>{let B=O.getLabelKeys();this.fetchValues(h,p);const F=B.map((I,U,W)=>({name:I,selected:L.includes(I),loading:!1}));this.setState({labels:F},()=>{this.state.labels.forEach(I=>{I.selected&&this.fetchValues(I.name,p)})})})}}doFacettingForLabel(O){const R=this.state.labels.find(B=>B.name===O);if(!R)return;const L=this.state.labels.filter(B=>B.selected).map(B=>B.name);this.props.storeLastUsedLabels(L),R.selected?R.values||this.fetchValues(O,v(this.state.labels)):this.doFacetting()}async fetchValues(O,R){const{languageProvider:L}=this.props;this.updateLabelState(O,{loading:!0},`Fetching values for ${O}`);try{let B=await L.getLabelValues(O);if(R!==v(this.state.labels)){this.updateLabelState(O,{loading:!1});return}const F=[],{metricsMetadata:I}=L;for(const U of B){const W={name:U};if(O===h&&I){const A=I[U];A&&(W.details=`(${A.type}) ${A.help}`)}F.push(W)}this.updateLabelState(O,{values:F,loading:!1})}catch(B){console.error(B)}}async fetchSeries(O,R){const{languageProvider:L}=this.props;R&&this.updateLabelState(R,{loading:!0},`Facetting labels for ${O}`);try{const B=await L.fetchSeriesLabels(O,!0,this.state.seriesLimit);if(O!==v(this.state.labels)){R&&this.updateLabelState(R,{loading:!1});return}if(Object.keys(B).length===0){this.setState({error:`Empty results, no matching label for ${O}`});return}const F=y(this.state.labels,B,R);this.setState({labels:F,error:""}),R&&this.updateLabelState(R,{loading:!1})}catch(B){console.error(B)}}async validateSelector(O){const{languageProvider:R}=this.props;this.setState({validationStatus:`Validating selector ${O}`,error:""});const L=await R.fetchSeries(O);this.setState({validationStatus:`Selector is valid (${L.length} series found)`})}render(){const{theme:O}=this.props,{labels:R,labelSearchTerm:L,metricSearchTerm:B,status:F,error:I,validationStatus:U,valueSearchTerm:W}=this.state,A=P(O);if(R.length===0)return(0,t.jsx)("div",{className:A.wrapper,children:(0,t.jsx)(s._,{text:"Loading labels..."})});let N=R.find(H=>H.name===h);N&&B&&(N={...N,values:N.values?.filter(H=>H.selected||H.name.includes(B))});let K=R.filter(H=>!H.hidden&&H.name!==h);L&&(K=K.filter(H=>H.selected||H.name.includes(L)));let V=K.filter(H=>H.selected&&H.values);W&&(V=V.map(H=>({...H,values:H.values?.filter(G=>G.selected||G.name.includes(W))})));const T=v(this.state.labels),z=T===p,w=N?.values?.length||0;return(0,t.jsxs)("div",{className:A.wrapper,children:[(0,t.jsxs)(c.B,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:A.section,children:[(0,t.jsx)(d.J,{description:"Once a metric is selected only possible labels are shown. Labels are limited by the series limit below.",children:"1. Select a metric"}),(0,t.jsx)("div",{children:(0,t.jsx)(u.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:B,"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})}),(0,t.jsx)(d.J,{description:"Set to 'none' to remove limit and show all labels for a selected metric. Removing the limit may cause performance issues.",children:"Series limit"}),(0,t.jsx)("div",{children:(0,t.jsx)(u.p,{onChange:this.onChangeSeriesLimit,"aria-label":"Limit results from series endpoint",value:this.state.seriesLimit??C,"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.seriesLimit})}),(0,t.jsx)("div",{role:"list",className:A.valueListWrapper,"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList,children:(0,t.jsx)(a.Y1,{height:Math.min(450,w*D),itemCount:w,itemSize:D,itemKey:H=>N.values[H].name,width:300,className:A.valueList,children:({index:H,style:G})=>{const X=N?.values?.[H];return X?(0,t.jsx)("div",{style:G,children:(0,t.jsx)(g.J,{name:N.name,value:X?.name,title:X.details,active:X?.selected,onClick:this.onClickMetric,searchTerm:B})}):null}})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:A.section,children:[(0,t.jsx)(d.J,{description:"Once label values are selected, only possible label combinations are shown.",children:"2. Select labels to search in"}),(0,t.jsx)("div",{children:(0,t.jsx)(u.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:L,"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})}),(0,t.jsx)("div",{className:A.list,style:{height:120},children:K.map(H=>(0,t.jsx)(g.J,{name:H.name,loading:H.loading,active:H.selected,hidden:H.hidden,facets:H.facets,onClick:this.onClickLabel,searchTerm:L},H.name))})]}),(0,t.jsxs)("div",{className:A.section,children:[(0,t.jsx)(d.J,{description:"Use the search field to find values across selected labels.",children:"3. Select (multiple) values for your labels"}),(0,t.jsx)("div",{children:(0,t.jsx)(u.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:W,"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})}),(0,t.jsx)("div",{className:A.valueListArea,ref:this.valueListsRef,children:V.map(H=>(0,t.jsxs)("div",{role:"list","aria-label":`Values for ${H.name}`,className:A.valueListWrapper,children:[(0,t.jsx)("div",{className:A.valueTitle,children:(0,t.jsx)(g.J,{name:H.name,loading:H.loading,active:H.selected,hidden:H.hidden,facets:H.facets||H.values?.length,onClick:this.onClickLabel})}),(0,t.jsx)(a.Y1,{height:Math.min(200,D*(H.values?.length||0)),itemCount:H.values?.length||0,itemSize:28,itemKey:G=>H.values[G].name,width:200,className:A.valueList,children:({index:G,style:X})=>{const k=H.values?.[G];return k?(0,t.jsx)("div",{style:X,children:(0,t.jsx)(g.J,{name:H.name,value:k?.name,active:k?.selected,onClick:this.onClickValue,searchTerm:W})}):null}})]},H.name))})]})]})]}),(0,t.jsxs)("div",{className:A.section,children:[(0,t.jsx)(d.J,{children:"4. Resulting selector"}),(0,t.jsx)("div",{"aria-label":"selector",className:A.selector,children:T}),U&&(0,t.jsx)("div",{className:A.validationStatus,children:U}),(0,t.jsxs)(c.B,{children:[(0,t.jsx)(o.$n,{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:z,onClick:this.onClickRunQuery,children:"Use query"}),(0,t.jsx)(o.$n,{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:z,onClick:this.onClickRunRateQuery,children:"Use as rate query"}),(0,t.jsx)(o.$n,{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:z,onClick:this.onClickValidate,children:"Validate selector"}),(0,t.jsx)(o.$n,{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"}),(0,t.jsx)("div",{className:(0,n.cx)(A.status,(F||I)&&A.statusShowing),children:(0,t.jsx)("span",{className:I?A.error:"",children:I||F})})]})]})]})}}const S=(0,E.cV)(b)},31320:(q,j,e)=>{"use strict";e.d(j,{M9:()=>a,Ol:()=>r,w0:()=>n});var t=e(23401);const n="codeModeSuggestionsIncomplete";function r(i){return i.type===n&&"detail"in i&&typeof i.detail=="object"&&i.detail!==null&&"limit"in i.detail&&"datasourceUid"in i.detail}class a{constructor(x){this.languageProvider=x.languageProvider,this.historyProvider=x.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(x=>x.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(x){const{metricsMetadata:s}=this.languageProvider;return x.map(d=>{const u=s?.[d];return{name:d,help:u?.help??"",type:u?.type??"",isUtf8:!(0,t.Rq)(d)}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(n,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(x){this.inputInRange=x}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},22338:(q,j,e)=>{"use strict";e.d(j,{TT:()=>s,Zh:()=>c,jW:()=>x,k1:()=>a});var t=e(74848),n=e(22803),r=e(64467);const a=30,i=d=>{const{options:u,onOptionsChange:g}=d,o=useTheme2(),E=c(o);return jsxs(Fragment,{children:[u.access==="direct"&&jsx(Alert,{title:"Error",severity:"error",children:"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."}),jsx(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),jsx("hr",{className:`${E.hrTopSpace} ${E.hrBottomSpace}`}),jsx(DataSourceHttpSettingsOverhaul,{options:u,onOptionsChange:g,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),jsx("hr",{}),jsxs(ConfigSection,{className:E.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",children:[jsx(AdvancedHttpSettings,{className:E.advancedHTTPSettingsMargin,config:u,onChange:g}),jsx(AlertingSettingsOverhaul,{options:u,onOptionsChange:g}),jsx(PromSettings,{options:u,onOptionsChange:g})]})]})};function x(d){return(0,t.jsx)("a",{href:d||"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/",target:"_blank",rel:"noopener noreferrer",children:"Visit docs for more details here."})}const s=(d,u,g)=>{const o="Value is not valid";return d&&!d.match(u)?(0,t.jsx)(r.P,{children:g||o}):!0};function c(d){return{additionalSettings:(0,n.css)({marginBottom:"25px"}),secondaryGrey:(0,n.css)({color:d.colors.secondary.text,opacity:"65%"}),inlineError:(0,n.css)({margin:"0px 0px 4px 245px"}),switchField:(0,n.css)({alignItems:"center"}),sectionHeaderPadding:(0,n.css)({paddingTop:"32px"}),sectionBottomPadding:(0,n.css)({paddingBottom:"28px"}),subsectionText:(0,n.css)({fontSize:"12px"}),hrBottomSpace:(0,n.css)({marginBottom:"56px"}),hrTopSpace:(0,n.css)({marginTop:"50px"}),textUnderline:(0,n.css)({textDecoration:"underline"}),versionMargin:(0,n.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,n.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,n.css)({paddingTop:"32px"}),alertingTop:(0,n.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,n.css)({fontWeight:400}),container:(0,n.css)({maxwidth:578})}}},15511:(q,j,e)=>{"use strict";e.d(j,{gs:()=>xe,UD:()=>je,ee:()=>Oe});var t=e(2543),n=e(84743),r=e(13288),a=e(75505),i=e(81160),x=e(59099),s=e(97716),c=e.n(s),d=e(59577),u=e(52733),g=e(55801),o=e(3202),E=e(42853),m=e(16753),f=e(65502),p=e(39736),h=e(23919),D=e(28082),C=e(32370),l=e(29927),v=e(74848),y=e(58779),P=e(1667),b=e(32300),S=e(30048),M=e(78246),O=e(95722),R=e(9968),L=e(34128),B=e(38283);function F(Je){const Be=Je.annotation,Ze=Je.onAnnotationChange,tt={expr:Be.expr,refId:Be.name,interval:Be.step};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(P.D,{children:[(0,v.jsx)(B.$,{...Je,query:tt,showExplain:!1,onChange:Re=>{Ze({...Be,expr:Re.expr})}}),(0,v.jsx)(b.U,{children:(0,v.jsx)(S.c,{label:"Min step",tooltip:(0,v.jsxs)(v.Fragment,{children:["An additional lower limit for the step parameter of the Prometheus query and for the"," ",(0,v.jsx)("code",{children:"$__interval"})," and ",(0,v.jsx)("code",{children:"$__rate_interval"})," variables."]}),children:(0,v.jsx)(O.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:Re=>{Ze({...Be,step:Re.currentTarget.value})},defaultValue:tt.interval,id:y.Tp.components.DataSource.Prometheus.annotations.minStep})})})]}),(0,v.jsx)(R.$,{v:.5}),(0,v.jsxs)(b.U,{children:[(0,v.jsx)(S.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,v.jsx)(L.p,{type:"text",placeholder:"{{alertname}}",value:Be.titleFormat,onChange:Re=>{Ze({...Be,titleFormat:Re.currentTarget.value})},"data-testid":y.Tp.components.DataSource.Prometheus.annotations.title})}),(0,v.jsx)(S.c,{label:"Tags",children:(0,v.jsx)(L.p,{type:"text",placeholder:"label1,label2",value:Be.tagKeys,onChange:Re=>{Ze({...Be,tagKeys:Re.currentTarget.value})},"data-testid":y.Tp.components.DataSource.Prometheus.annotations.tags})}),(0,v.jsx)(S.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,v.jsx)(L.p,{type:"text",placeholder:"{{instance}}",value:Be.textFormat,onChange:Re=>{Ze({...Be,textFormat:Re.currentTarget.value})},"data-testid":y.Tp.components.DataSource.Prometheus.annotations.text})}),(0,v.jsx)(S.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.",children:(0,v.jsx)(M.C,{value:Be.useValueForTime,onChange:Re=>{Ze({...Be,useValueForTime:Re.currentTarget.value})},"data-testid":y.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp})})]})]})}var I=e(75257),U=e(87574),W=e(18990),A=e(11222),N=e(83909);const K=/^label_names\(\)\s*$/,V=/^label_values\((?:(.+),\s*)?(.+)\)\s*$/,T=/^metrics\((.+)\)\s*$/,z=/^query_result\((.+)\)\s*$/,w=/^label_names\((.+)\)\s*$/;function H(Je){if(typeof Je!="string")return Je;const Be={refId:"PrometheusDatasource-VariableQuery",qryType:N.B4.LabelNames},Ze=Je.match(w);if(Ze)return{...Be,qryType:N.B4.LabelNames,match:Ze[1]};const tt=Je.match(K);if(tt)return{...Be,qryType:N.B4.LabelNames};const Re=Je.match(/^label_values\(/);if(Re){const ze=Je.match(V),st=ze?ze[2]:"",ht=ze?ze[1]:"";if(ht){const It=(0,A.u)(ht);return{...Be,qryType:N.B4.LabelValues,label:st,metric:It.query.metric,labelFilters:It.query.labels}}else return{...Be,qryType:N.B4.LabelValues,label:st}}const at=Je.match(/^metrics\(/);if(at){const ze=Je.match(T),st=ze?ze[1]:"";return{...Be,qryType:N.B4.MetricNames,metric:st}}const yt=Je.match(/^query_result\(/);if(yt){const ze=Je.match(z),st=ze?ze[1]:"";return{...Be,qryType:N.B4.VarQueryResult,varQuery:st}}return!tt&&!Re&&!at&&!yt?{...Be,qryType:N.B4.SeriesQuery,seriesQuery:Je}:Be}function G(Je){switch(Je.qryType){case N.B4.LabelNames:return Je.match?`label_names(${Je.match})`:"label_names()";case N.B4.LabelValues:if(Je.metric||Je.labelFilters&&Je.labelFilters.length!==0){const Ze={metric:Je.metric,labels:Je.labelFilters??[],operations:[]};return`label_values(${W.z.renderQuery(Ze)},${Je.label})`}else return`label_values(${Je.label})`;case N.B4.MetricNames:return`metrics(${Je.metric})`;case N.B4.VarQueryResult:return`query_result(${X(Je.varQuery)})`;case N.B4.SeriesQuery:return Je.seriesQuery??"";case N.B4.ClassicQuery:return Je.classicQuery??""}return""}function X(Je){return Je?Je.replace(/[\r\n]+/gm,""):""}var k=e(23401);class _{constructor(Be,Ze){this.datasource=Be,this.query=Ze,this.datasource=Be,this.query=Ze,this.range=(0,g.E2)()}process(Be){this.range=Be;const Ze=K,tt=w,Re=V,at=T,yt=z,ze=this.query.match(Ze),st=this.query.match(tt);if(st){const vn=`{__name__=~".*${st[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(vn,[]).then(pn=>pn.map(xn=>({text:xn})))}if(ze)return this.datasource.getTagKeys({filters:[],timeRange:Be});const ht=this.query.match(Re);if(ht){const vn=ht[1],pn=ht[2];return ee(vn)?this.labelValuesQuery(pn,vn):this.labelValuesQuery(pn)}const It=this.query.match(at);if(It)return this.metricNameQuery(It[1]);const Gt=this.query.match(yt);return Gt?this.queryResultQuery(Gt[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(Be,Ze){const tt=(0,U.mv)(this.range.from,!1),Re=(0,U.mv)(this.range.to,!0),at={...Ze&&{"match[]":Ze},start:tt.toString(),end:Re.toString()};let yt=Be;if((0,k.Rq)(Be)||(yt=(0,k.$H)(Be)),!Ze||this.datasource.hasLabelsMatchAPISupport()){const ze=`/api/v1/label/${yt}/values`;return this.datasource.metadataRequest(ze,at).then(st=>(0,t.map)(st.data.data,ht=>({text:ht})))}else return this.datasource.metadataRequest("/api/v1/series",at).then(st=>{const ht=(0,t.map)(st.data.data,It=>It[Be]||"").filter(It=>It!=="");return(0,t.uniq)(ht).map(It=>({text:It,expandable:!0}))})}metricNameQuery(Be){const Ze=(0,U.mv)(this.range.from,!1),tt=(0,U.mv)(this.range.to,!0),Re={start:Ze.toString(),end:tt.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",Re).then(yt=>(0,t.chain)(yt.data.data).filter(ze=>new RegExp(Be).test(ze)).map(ze=>({text:ze,expandable:!0})).value())}queryResultQuery(Be){const Ze="/api/v1/query",tt={query:Be,time:(0,U.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(Ze,tt).then(Re=>{switch(Re.data.data.resultType){case"scalar":case"string":return[{text:Re.data.data.result[1]||"",expandable:!1}];case"vector":return(0,t.map)(Re.data.data.result,at=>{let yt=at.metric.__name__||"";return delete at.metric.__name__,yt+="{"+(0,t.map)(at.metric,(ze,st)=>st+'="'+ze+'"').join(",")+"}",yt+=" "+at.value[1]+" "+at.value[0]*1e3,{text:yt,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${Re.data.data.resultType}]`)}})}metricNameAndLabelsQuery(Be){const Ze=(0,U.mv)(this.range.from,!1),tt=(0,U.mv)(this.range.to,!0),Re={"match[]":Be,start:Ze.toString(),end:tt.toString()},at="/api/v1/series",yt=this;return this.datasource.metadataRequest(at,Re).then(ze=>(0,t.map)(ze.data.data,st=>({text:yt.datasource.getOriginalMetricName(st),expandable:!0})))}}function ee(Je){return Je&&Je.split(" ").join("")!=="{}"}const J=20;function Z(Je,Be,Ze){const tt=[],Re=Ze?.languageProvider?.metricsMetadata;if(Je.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))tt.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Je}}});else if(Re&&oe(Je)){const yt=le(Je),{nameMetric:ze}=he(yt,"histogram",Re,!1);if(ze){const ht="Selected metric is a native histogram.";tt.push({type:"HISTOGRAM_QUANTILE",label:ht,fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Je}}},{type:"HISTOGRAM_AVG",label:ht,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:Je}}},{type:"HISTOGRAM_COUNT",label:ht,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:Je}}})}}if(Je.indexOf("rate(")===-1&&Je.indexOf("increase(")===-1){const yt=Je.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let ze=yt?yt[1]:"",st=!1;if(Re){const ht=le(Je),It=he(ht,"counter",Re,st);ze=It.nameMetric,st=It.certain}if(ze){const ht=oe(Je);let Gt=`Selected metric ${st?"is":"looks like"} a counter.`,un;ht?un={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:Je}}:Gt=`${Gt} Consider calculating rate of counter by adding rate().`,tt.push({type:"APPLY_RATE",label:Gt,fix:un})}}if(Ze&&Ze.ruleMappings){const yt=re(Je,Ze.ruleMappings);tt.push(...yt)}return Be&&Be.length>=J&&Je.trim().match(/^\w+$/)&&tt.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:Je,preventSubmit:!0}}}),tt}function te(Je){const Be=[];return Je.lookupsDisabled&&Be.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),Be}function ae(Je,Be){return!Je||!Be?!1:new RegExp(`(?<![\\w:])${Be}(?=[\\[{(\\s\\)]|$)`).test(Je)}function re(Je,Be){const Ze=[],tt=Object.keys(Be).reduce((Re,at)=>{if(!ae(Je,at))return Re;if(Be[at].length>1){const{idx:yt,expandedQuery:ze,identifier:st,identifierValue:ht}=ne(Je,at,Be[at]);return yt===-1?(Ze.push({type:"EXPAND_RULES_WARNING",label:"We found multiple recording rules that match in this query. To expand the recording rule, add an identifier label/value."}),Re):{...Re,[at]:{expandedQuery:ze,identifier:st,identifierValue:ht}}}else return{...Re,[at]:{expandedQuery:Be[at][0].query}}},{});return(0,t.size)(tt)>0&&Ze.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:Je,options:tt}}}),Ze}function ne(Je,Be,Ze){const{query:tt}=(0,A.u)(Je),Re=ce(Be,tt);if(Re.length===0)return{idx:-1,identifier:"",identifierValue:"",expandedQuery:""};let at="",yt="",ze=-1;return Re.forEach(st=>{ze===-1&&st.label.search("uuid")!==-1&&(at=st.label,yt=st.value)}),Ze.forEach((st,ht)=>{st.labels&&Object.entries(st.labels).forEach(([It,Gt])=>{ze===-1&&It===at&&Gt===yt&&(ze=ht)})}),{idx:ze,identifier:at,identifierValue:yt,expandedQuery:Ze[ze]?.query??""}}function ce(Je,Be){if(Be.metric===Je)return Be.labels;if(Be.binaryQueries)for(let Ze=0;Ze<Be.binaryQueries.length;Ze++){const tt=ce(Je,Be.binaryQueries[Ze].query);if(tt&&tt.length>0)return tt}return[]}function le(Je){return Array.from(Je.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([Be])=>Be).filter(Be=>!Be.startsWith("$")).flatMap(Be=>Be.split(":"))}function he(Je,Be,Ze,tt){return{nameMetric:Je.find(at=>{const yt=Ze[at];return yt&&yt.type.toLowerCase()===Be?(tt=!0,!0):!1})??"",certain:tt}}function oe(Je){return Je.trim().match(/^\w+$|^\w+{.*}$/)}var de=e(23417),me=e(1391),Pe=e(56276);function Ee(Je,Be,Ze){const{app:tt,targets:Re}=Be;if(tt===m.Jk.Explore)for(const at of Re)(0,Pe.rR)("grafana_prometheus_query_executed",{app:tt,grafana_version:C.$.buildInfo.version,has_data:Je.data.some(yt=>yt.length>0),has_error:Je.error!==void 0,expr:at.expr,format:at.format,instant:at.instant,range:at.range,exemplar:at.exemplar,hinting:at.hinting,interval:at.interval,intervalFactor:at.intervalFactor,utcOffsetSec:at.utcOffsetSec,legend:at.legendFormat,valueWithRefId:at.valueWithRefId,requestId:Be.requestId,showingGraph:at.showingGraph,showingTable:at.showingTable,editor_mode:at.editorMode,simultaneously_sent_query_count:Re.length,time_range_from:Be?.range?.from?.toISOString(),time_range_to:Be?.range?.to?.toISOString(),time_taken:Date.now()-Ze.getTime()})}var be=e(62467),Se=e(65474),Xe=e(50471),Qe=e(76459),we=e.n(Qe),$e=e(96540),Fe=e(35095),Te=e(77222),Le=e(60484),Ge=e(44826),Me=e(50926),De=e(63372);const Ke=[{label:"Label names",value:N.B4.LabelNames},{label:"Label values",value:N.B4.LabelValues},{label:"Metrics",value:N.B4.MetricNames},{label:"Query result",value:N.B4.VarQueryResult},{label:"Series query",value:N.B4.SeriesQuery},{label:"Classic query",value:N.B4.ClassicQuery}],Ie="PrometheusVariableQueryEditor-VariableQuery",Ne=({onChange:Je,query:Be,datasource:Ze,range:tt})=>{const[Re,at]=(0,$e.useState)(void 0),[yt,ze]=(0,$e.useState)(""),[st,ht]=(0,$e.useState)(""),[It,Gt]=(0,$e.useState)(""),[un,vn]=(0,$e.useState)(""),[pn,xn]=(0,$e.useState)(""),[cn,jn]=(0,$e.useState)(""),[_n,Ot]=(0,$e.useState)([]),[Rt,Ye]=(0,$e.useState)([]);function dt($t,nn){Ye([...nn,...$t]);const on=(0,U.ky)($t);Ot([...nn,...on])}const[lt,Pt]=(0,$e.useState)([]);(0,$e.useEffect)(()=>{Ze.languageProvider.start(tt)},[]),(0,$e.useEffect)(()=>{if(Be)if(Be.qryType===N.B4.ClassicQuery)at(Be.qryType),jn(Be.query??"");else{const $t=ie(Be);ht($t.match??""),at($t.qryType),ze($t.label??""),Gt($t.metric??""),Pt($t.labelFilters??[]),vn($t.varQuery??""),xn($t.seriesQuery??""),jn($t.classicQuery??"")}},[Be]),(0,$e.useEffect)(()=>{if(Re!==N.B4.LabelValues)return;const $t=Ze.getVariables().map(nn=>({label:nn,value:nn}));if(!It)Ze.getTagKeys({filters:[]}).then(nn=>{const on=nn.map(({text:bn})=>({label:bn,value:bn}));dt(on,$t)});else{const nn=[{label:"__name__",op:"=",value:It}],on=W.z.renderLabels(nn);Ze.languageProvider.fetchLabelsWithMatch(on).then(bn=>{const Yn=Object.keys(bn).map(zn=>({label:zn,value:zn}));dt(Yn,$t)})}},[Ze,Re,It]);const Bt=($t,nn)=>{const In={...{qryType:Re,label:yt,metric:It,match:st,varQuery:un,seriesQuery:pn,classicQuery:cn,refId:"PrometheusVariableQueryEditor-VariableQuery"},...$t,...nn?{labelFilters:nn}:{labelFilters:lt}},Yn=G(In);Je({query:Yn,qryType:In.qryType,refId:Ie})},Jt=$t=>{at($t.value),$t.value!==N.B4.SeriesQuery&&Bt({qryType:$t.value??0})},qt=$t=>{const nn=$t&&$t.value?$t.value:"";ze(nn),Re===N.B4.LabelValues&&nn&&Bt({label:nn})},gn=$t=>{Gt($t.metric),Pt($t.labels);const nn=$t.metric,on=$t.labels??[];Re===N.B4.LabelValues&&yt&&(nn||on)&&Bt({qryType:Re,metric:nn},on)},On=$t=>{Re===N.B4.LabelNames&&Bt({qryType:Re,match:$t})},Tn=$t=>{Re===N.B4.MetricNames&&$t&&Bt({metric:$t})},wn=$t=>{vn($t.currentTarget.value)},ps=$t=>{xn($t.currentTarget.value)},es=$t=>{jn($t.currentTarget.value)},ls=(0,$e.useCallback)(()=>({metric:It,labels:lt,operations:[]}),[It,lt]),Lt=we()($t=>{const nn=Rt.filter(on=>on.value?.includes($t));return(0,U.ky)(nn)},300);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Query type",labelWidth:20,tooltip:(0,v.jsx)("div",{children:"The Prometheus data source plugin provides the following query types for template variables."}),children:(0,v.jsx)(Ge.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:Jt,value:Re,options:Ke,width:25,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType})})}),Re===N.B4.LabelValues&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:(0,v.jsx)("div",{children:"Returns a list of label values for the label name in all metrics unless the metric is specified."}),children:(0,v.jsx)(Ge.DW,{"aria-label":"label-select",onChange:qt,value:yt?(0,Fe.z)(yt):null,defaultOptions:_n,width:25,allowCustomValue:!0,isClearable:!0,loadOptions:Lt,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect})})}),(0,v.jsx)(De.I,{query:ls(),datasource:Ze,onChange:gn,variableEditor:!0})]}),Re===N.B4.LabelNames&&(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:(0,v.jsx)("div",{children:"Returns a list of label names, optionally filtering by specified metric regex."}),children:(0,v.jsx)(L.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:st,onBlur:$t=>{ht($t.currentTarget.value),On($t.currentTarget.value)},onChange:$t=>{ht($t.currentTarget.value)},width:25,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex})})}),Re===N.B4.MetricNames&&(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:(0,v.jsx)("div",{children:"Returns a list of metrics matching the specified metric regex."}),children:(0,v.jsx)(L.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:It,onChange:$t=>{Gt($t.currentTarget.value)},onBlur:$t=>{Gt($t.currentTarget.value),Tn($t.currentTarget.value)},width:25,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex})})}),Re===N.B4.VarQueryResult&&(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Query",labelWidth:20,tooltip:(0,v.jsx)("div",{children:"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines)."}),children:(0,v.jsx)(Me.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:un,onChange:wn,onBlur:()=>{Re===N.B4.VarQueryResult&&un&&Bt({qryType:Re})},cols:100,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult})})}),Re===N.B4.SeriesQuery&&(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Series Query",labelWidth:20,tooltip:(0,v.jsx)("div",{children:'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.'}),children:(0,v.jsx)(L.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:pn,onChange:ps,onBlur:()=>{Re===N.B4.SeriesQuery&&pn&&Bt({qryType:Re})},width:100,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery})})}),Re===N.B4.ClassicQuery&&(0,v.jsx)(Te.C,{children:(0,v.jsx)(Le.I,{label:"Classic Query",labelWidth:20,tooltip:(0,v.jsx)("div",{children:"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric)."}),children:(0,v.jsx)(L.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:cn,onChange:es,onBlur:()=>{Re===N.B4.ClassicQuery&&cn&&Bt({qryType:Re})},width:100,"data-testid":y.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery})})})]})};function ie(Je){return typeof Je=="string"?H(Je):Je.query?H(Je.query):Je}class ve extends Xe.f5{constructor(Be,Ze=(0,p.w)()){super(),this.datasource=Be,this.templateSrv=Ze,this.editor=Ne}query(Be){let Ze;if(typeof Be.targets[0]=="string"?Ze=Be.targets[0]:Ze=Be.targets[0].query,!Ze)return(0,be.of)({data:[]});const tt={...Be.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:d.intervalToMs(this.datasource.interval),value:d.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(Be.range)},Re=this.templateSrv.replace(Ze,tt,this.datasource.interpolateQueryExpr),at=new _(this.datasource,Re);return(0,Se.H)(at.process(Be.range)).pipe((0,i.T)(ze=>({data:ze})))}}const fe="60s",ge=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels","suggestions"],xe="-Instant";class je extends f.iy{constructor(Be,Ze=(0,p.w)(),tt){super(Be),this.templateSrv=Ze,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(Re,at)=>{const yt=(0,h.bE)({data:at}).data;if(!yt||!yt.length)return[];const ze=Re.annotation,{tagKeys:st="",titleFormat:ht="",textFormat:It=""}=ze,Gt=yt[0].meta?.executedQueryString||"",un=/Step:\s*([\d\w]+)/,vn=Gt.match(un),pn=vn?vn[1]:null,xn=d.intervalToSeconds(pn||fe)*1e3,cn=st.split(","),jn=[];for(const _n of yt){if(_n.fields.length===0)continue;const Ot=_n.fields[0],Rt=_n.fields[1],Ye=Rt?.labels||{},dt=Object.keys(Ye).filter(gn=>cn.includes(gn)).map(gn=>Ye[gn]),lt=[];let Pt=0;Rt.values.forEach(gn=>{let On,Tn;const wn=Ot.values[Pt];Re.annotation.useValueForTime?(On=Math.floor(parseFloat(gn)),Tn=1):(On=Math.floor(parseFloat(wn)),Tn=parseFloat(gn)),Pt++,lt.push([On,Tn])});const Jt=lt.filter(gn=>gn[1]>0).map(gn=>gn[0]);let qt=null;for(const gn of Jt){if(qt&&(qt.timeEnd??0)+xn>=gn){qt.timeEnd=gn;continue}qt&&jn.push(qt),qt={time:gn,timeEnd:gn,annotation:ze,title:(0,u.j)(ht,Ye),tags:dt,text:(0,u.j)(It,Ye)}}qt&&(qt.timeEnd=Jt[Jt.length-1],jn.push(qt))}return jn},this.type="prometheus",this.id=Be.id,this.url=Be.url,this.access=Be.access,this.basicAuth=Be.basicAuth,this.withCredentials=!!Be.withCredentials,this.interval=Be.jsonData.timeInterval||"15s",this.httpMethod=Be.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=Be.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=Be.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=tt??new I.Ay(this),this.lookupsDisabled=Be.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(Be.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=Be.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=Be.jsonData.prometheusVersion,this.seriesEndpoint=Be.jsonData.seriesEndpoint??!1,this.defaultEditor=Be.jsonData.defaultEditor,this.disableRecordingRules=Be.jsonData.disableRecordingRules??!1,this.variables=new ve(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=Be.jsonData.cacheLevel??N.fD.Low,this.metricNamesAutocompleteSuggestionLimit=Be.jsonData.codeModeMetricNamesSuggestionLimit??I.OP,this.cache=new de.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:Be.jsonData.incrementalQueryOverlapWindow??de.Dr,applyInterpolation:this.interpolateString.bind(this)}),this.annotations={QueryEditor:F}}getQueryDisplayText(Be){return Be.expr}getPrometheusTargetSignature(Be,Ze){return`${this.interpolateString(Ze.expr)}|${Ze.interval??Be.interval}|${JSON.stringify(Be.rangeRaw??"")}|${Ze.exemplar}`}hasLabelsMatchAPISupport(){return this.seriesEndpoint?!1:this._isDatasourceVersionGreaterOrEqualTo("2.24.0",N.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",N.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",N.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",N.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(Be,Ze){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:Ze!==this.datasourceConfigurationPrometheusFlavor?!1:c().gte(this.datasourceConfigurationPrometheusVersion,Be)}_addTracingHeaders(Be,Ze){Be.headers={},this.access==="proxy"&&(Be.headers["X-Dashboard-UID"]=Ze.dashboardUID,Be.headers["X-Panel-Id"]=Ze.panelId)}directAccessError(){return(0,r.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(Be,Ze,tt={}){if(this.access==="direct")return this.directAccessError();Ze=Ze||{};for(const[yt,ze]of this.customQueryParameters)Ze[yt]==null&&(Ze[yt]=ze);let Re=this.url+Be;Be.startsWith(`/api/datasources/uid/${this.uid}`)&&(Re=Be);const at=(0,t.defaults)(tt,{url:Re,method:this.httpMethod,headers:{}});return at.method==="GET"?Ze&&Object.keys(Ze).length&&(at.url=at.url+(at.url.search(/\?/)>=0?"&":"?")+Object.entries(Ze).map(([yt,ze])=>`${encodeURIComponent(yt)}=${encodeURIComponent(ze)}`).join("&")):(at.headers["Content-Type"]||(at.headers["Content-Type"]="application/x-www-form-urlencoded"),at.data=Ze),(this.basicAuth||this.withCredentials)&&(at.withCredentials=!0),this.basicAuth&&(at.headers.Authorization=this.basicAuth),(0,D.AI)().fetch(at)}async importFromAbstractQueries(Be){return Be.map(Ze=>this.languageProvider.importFromAbstractQuery(Ze))}async exportToAbstractQueries(Be){return Be.map(Ze=>this.languageProvider.exportToAbstractQuery(Ze))}async metadataRequest(Be,Ze={},tt){if(ge.some(Re=>Be.includes(Re)))try{return await(0,a.s)(this._request(`/api/datasources/uid/${this.uid}/resources${Be}`,Ze,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...tt}))}catch(Re){if(this.httpMethod==="POST"&&(0,D.NF)(Re)&&(Re.status===405||Re.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw Re}return await(0,a.s)(this._request(`/api/datasources/uid/${this.uid}/resources${Be}`,Ze,{method:"GET",hideFromInspector:!0,...tt}))}interpolateQueryExpr(Be=[],Ze){if(!Ze.multi&&!Ze.includeAll)return Oe(Be);if(typeof Be=="string")return nt(Be);const tt=Be.map(Re=>nt(Re));return tt.length===1?tt[0]:"("+tt.join("|")+")"}targetContainsTemplate(Be){return this.templateSrv.containsTemplate(Be.expr)}shouldRunExemplarQuery(Be,Ze){if(Be.exemplar){const tt=this.languageProvider.histogramMetrics.find(yt=>Be.expr.includes(yt)),Re=Ze.targets.findIndex(yt=>yt.refId===Be.refId),at=Ze.targets.slice(0,Re).filter(yt=>!yt.hide);return!!(!tt||tt&&!at.some(yt=>yt.expr.includes(tt)))}return!1}processTargetV2(Be,Ze){let tt=Ze.range.to.utcOffset();Ze.timezone==="browser"?tt=this.isUsingRelativeTimeRange(Ze.range)?tt:0:tt=(0,n.tz)(Ze.timezone).utcOffset();const Re=[],at={...Be,exemplar:this.shouldRunExemplarQuery(Be,Ze),requestId:Ze.panelId+Be.refId,utcOffsetSec:tt*60};return C.$.featureToggles.promQLScope&&(at.scopes=(Ze.scopes??[]).map(yt=>({name:yt.metadata.name,...yt.spec}))),C.$.featureToggles.groupByVariable&&(at.groupByKeys=Ze.groupByKeys),Be.instant&&Be.range?Re.push({...at,refId:at.refId,instant:!1},{...at,refId:at.refId+xe,range:!1,exemplar:!1}):Re.push(at),Re}query(Be){if(this.access==="direct")return this.directAccessError();let Ze,tt;const Re=Be.targets.some(ze=>ze.instant);this.hasIncrementalQuery&&!Re?(tt=this.cache.requestInfo(Be),Ze=tt.requests[0]):Ze=Be;const at=Ze.targets.map(ze=>this.processTargetV2(ze,Ze)),yt=new Date;return super.query({...Ze,targets:at.flat()}).pipe((0,i.T)(ze=>{const st={...ze,data:this.cache.procFrames(Be,tt,ze.data)};return(0,me.J3)(st,Be,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,x.M)(ze=>{Ee(ze,Be,yt)}))}metricFindQuery(Be,Ze){if(!Be)return Promise.resolve([]);const tt=Ze?.range??this.languageProvider.timeRange??(0,g.E2)(),Re={...this.getIntervalVars(),...this.getRangeScopedVars(tt)},at=this.templateSrv.replace(Be,Re,this.interpolateQueryExpr);return new _(this,at).process(tt)}getIntervalVars(){return{__interval:{text:this.interval,value:this.interval},__interval_ms:{text:d.intervalToMs(this.interval),value:d.intervalToMs(this.interval)}}}getRangeScopedVars(Be){const Ze=Be.to.diff(Be.from),tt=Math.round(Ze/1e3);return{__range_ms:{text:Ze,value:Ze},__range_s:{text:tt,value:tt},__range:{text:tt+"s",value:tt+"s"}}}async annotationQuery(Be){if(this.access==="direct"){const yt=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(yt)}const Ze=Be.annotation,{expr:tt=""}=Ze;if(!tt)return Promise.resolve([]);const Re=Be.annotation.step||fe,at={expr:tt,range:!0,instant:!1,exemplar:!1,interval:Re,refId:"X",datasource:this.getRef()};return await(0,a.s)((0,D.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,U.mv)(Be.range.from,!1)*1e3).toString(),to:((0,U.mv)(Be.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(at,{})]},requestId:`prom-query-${Ze.name}`}).pipe((0,i.T)(yt=>this.processAnnotationResponse(Be,yt.data))))}async getTagKeys(Be){if(C.$.featureToggles.promQLScope&&(Be?.scopes?.length??0)>0)return(await this.languageProvider.fetchSuggestions(Be.timeRange,Be.queries,Be.scopes,Be.filters)).filter(yt=>!!yt&&!Be.filters.find(ze=>ze.key===yt)).map(yt=>({value:yt,text:yt}));if(!Be||Be.filters.length===0)return await this.languageProvider.fetchLabels(Be.timeRange,Be.queries),this.languageProvider.getLabelKeys().map(at=>({value:at,text:at}));const Ze=Be.filters.map(at=>({label:at.key,value:at.value,op:at.operator})),tt=W.z.renderLabels(Ze);let Re=await this.languageProvider.fetchLabelsWithMatch(tt);return Object.keys(Re).filter(at=>!Be.filters.find(yt=>yt.key===at)).map(at=>({value:at,text:at}))}async getTagValues(Be){const Ze=`[${this.uid}][${Be.key}]`;if(C.$.featureToggles.promQLScope)return(await this.languageProvider.fetchSuggestions(Be.timeRange,Be.queries,Be.scopes,Be.filters,Be.key,void 0,Ze)).map(ze=>({value:ze,text:ze}));const tt=Be.filters.map(ze=>({label:ze.key,value:ze.value,op:ze.operator})),Re=W.z.renderLabels(tt);if(this.hasLabelsMatchAPISupport())return(await this.languageProvider.fetchSeriesValuesWithMatch(Be.key,Re,Ze,Be.timeRange)).map(ze=>({value:ze,text:ze}));const at=this.getTimeRangeParams(Be.timeRange??(0,g.E2)());return(await this.metadataRequest(`/api/v1/label/${Be.key}/values`,at))?.data?.data?.map(ze=>({text:ze}))??[]}interpolateVariablesInQueries(Be,Ze,tt){let Re=Be;return Be&&Be.length&&(Re=Be.map(at=>{const yt=this.templateSrv.replace(at.expr,Ze,this.interpolateExploreMetrics(at.fromExploreMetrics)),ze=C.$.featureToggles.promQLScope?yt:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(tt,yt),Ze,this.interpolateQueryExpr);return{...at,...C.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(tt)}:{},datasource:this.getRef(),expr:ze,interval:this.templateSrv.replace(at.interval,Ze)}})),Re}getQueryHints(Be,Ze){return Z(Be.expr??"",Ze,this)}getInitHints(){return te(this)}async loadRules(){try{const Ze=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;Ze&&(this.ruleMappings=ke(Ze))}catch(Be){console.log("Rules API is experimental. Ignore next error."),console.error(Be)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,o.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,o.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(Be,Ze){let tt=Be.expr??"";switch(Ze.type){case"ADD_FILTER":{const{key:Re,value:at}=Ze.options??{};Re&&at&&(tt=(0,l.t)(tt,Re,at));break}case"ADD_FILTER_OUT":{const{key:Re,value:at}=Ze.options??{};Re&&at&&(tt=(0,l.t)(tt,Re,at,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{tt=`histogram_quantile(0.95, sum(rate(${tt}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{tt=`histogram_avg(rate(${tt}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{tt=`histogram_fraction(0,0.2,rate(${tt}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{tt=`histogram_count(rate(${tt}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{tt=`histogram_sum(rate(${tt}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{tt=`histogram_stddev(rate(${tt}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{tt=`histogram_stdvar(rate(${tt}[$__rate_interval]))`;break}case"ADD_RATE":{tt=`rate(${tt}[$__rate_interval])`;break}case"ADD_SUM":{tt=`sum(${tt.trim()}) by ($1)`;break}case"EXPAND_RULES":{Ze.options&&(tt=(0,U.P_)(tt,Ze.options));break}default:break}return{...Be,expr:tt}}getAdjustedInterval(Be){return(0,U.Xd)(this.cacheLevel,Be)}getTimeRangeParams(Be){return{start:(0,U.mv)(Be.from,!1).toString(),end:(0,U.mv)(Be.to,!0).toString()}}getOriginalMetricName(Be){return(0,me.hF)(Be)}generateScopeFilters(Be){return Be?Be.map(Ze=>({key:Ze.key,operator:E.n[Ze.operator],value:this.templateSrv.replace(Ze.value,{},this.interpolateQueryExpr),values:Ze.values?.map(tt=>this.templateSrv.replace(tt,{},this.interpolateQueryExpr))})):[]}enhanceExprWithAdHocFilters(Be,Ze){return!Be||Be.length===0?Ze:Be.reduce((Re,at)=>{const{key:yt,operator:ze}=at;let{value:st}=at;return(ze==="=~"||ze==="!~")&&(st=Oe(st)),(0,l.t)(Re,yt,st,ze)},Ze)}filterQuery(Be){return!(Be.hide||!Be.expr)}applyTemplateVariables(Be,Ze,tt){const Re={...Ze};Re.__interval={value:"$__interval"},Re.__interval_ms={value:"$__interval_ms"};const at=this.templateSrv.replace(Be.expr,Re,this.interpolateExploreMetrics(Be.fromExploreMetrics)),yt=C.$.featureToggles.promQLScope?at:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(tt,at),Re,this.interpolateQueryExpr);return{...Be,...C.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(tt)}:{},expr:yt,interval:this.templateSrv.replace(Be.interval,Re),legendFormat:this.templateSrv.replace(Be.legendFormat,Re)}}getVariables(){return this.templateSrv.getVariables().map(Be=>`$${Be.name}`)}interpolateString(Be,Ze){return this.templateSrv.replace(Be,Ze,this.interpolateQueryExpr)}interpolateExploreMetrics(Be){return(Ze=[],tt)=>{if(typeof Ze=="string"&&Be){if(tt.name==="filters")return(0,k.p0)(Ze);if(tt.name==="groupby")return(0,k.Nc)(Ze)}return this.interpolateQueryExpr(Ze,tt)}}isUsingRelativeTimeRange(Be){return typeof Be.raw.from!="string"||typeof Be.raw.to!="string"?!1:Be.raw.from.includes("now")||Be.raw.to.includes("now")}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case N.fD.Medium:return 600;case N.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case N.fD.Medium:return 7;case N.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,U.u3)(this.cacheLevel)}getDefaultQuery(Be){const Ze={refId:"A",expr:"",range:!0,instant:!1};return Be===m.Jk.UnifiedAlerting?{...Ze,instant:!0,range:!1}:Be===m.Jk.Explore?{...Ze,instant:!0,range:!0}:Ze}}function Ve(Je,Be,Ze,tt){const Re=Math.floor((Be+tt)/Ze)*Ze-tt,at=Math.floor((Je+tt)/Ze)*Ze-tt;return{end:Re,start:at}}function ke(Je){return Je.reduce((Be,Ze)=>Ze.rules.filter(tt=>tt.type==="recording").reduce((tt,Re)=>{const at=tt[Re.name]??[];return at.push({query:Re.query,labels:Re.labels}),tt[Re.name]=at,tt},Be),{})}function Oe(Je){return typeof Je!="string"?Je:C.$.featureToggles.prometheusSpecialCharsInLabelValues?/^\w+(=|!=|=~|!~)".*"$/.test(Je)?Je:Je.replace(/\\/g,"\\\\").replace(/"/g,'\\"'):Je.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'")}function nt(Je){return typeof Je!="string"?Je:C.$.featureToggles.prometheusSpecialCharsInLabelValues?Je.replace(/\\/g,"\\\\\\\\").replace(/"/g,'\\\\\\"').replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):Je.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]+?.()|]/g,"\\\\$&")}},75257:(q,j,e)=>{"use strict";e.d(j,{AU:()=>v,Ay:()=>b,OP:()=>h,pK:()=>l,xB:()=>C});var t=e(2543),n=e.n(t),r=e(28848),a=e.n(r),i=e(29997),x=e(55801),s=e(42853),c=e(58462),d=e(56958),u=e(87574),g=e(93981),o=e(11222),E=e(83909),m=e(23401);const f=["job","instance"],p="{}",h=1e4,D=R=>({headers:{"X-Grafana-Cache":`private, max-age=${R}`}});function C(R,L){if(!L[R])return;const{type:B,help:F}=L[R];return`${B.toUpperCase()}: ${F}`}function l(R,L){if(L[R])return L[R].help}function v(R,L){if(L[R])return L[R].type}const y=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,P=86400;class b extends i.Is{constructor(L,B){super(),this.labelKeys=[],this.request=async(F,I,U={},W)=>{try{return(await this.datasource.metadataRequest(F,U,W)).data.data}catch(A){M(A)||console.error(A)}return I},this.start=async F=>(this.timeRange=F??(0,x.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,u.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async F=>{const I=this.datasource.getAdjustedInterval(this.timeRange),U=this.datasource.interpolateString(F),A=`/api/v1/label/${(0,m.$H)(O(U))}/values`;return await this.request(A,[],I,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(F,I)=>{F&&(this.timeRange=F);let U="/api/v1/labels";const W=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const A=new URLSearchParams({...W});I?.forEach(K=>{const V=(0,o.u)(K.expr);if(V.query.metric!==""){const T=!(0,m.Rq)(V.query.metric);A.append("match[]",T?`{"${V.query.metric}"}`:V.query.metric),V.query.binaryQueries&&V.query.binaryQueries.forEach(z=>{A.append("match[]",T?`{"${z.query.metric}"}`:z.query.metric)})}}),this.datasource.httpMethod==="GET"&&(U+=`?${A.toString()}`);const N=await this.request(U,[],A,this.getDefaultCacheHeaders());return Array.isArray(N)&&(this.labelKeys=N.slice().sort()),[]},this.getSeriesValues=async(F,I)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(F,I):(await this.getSeries(I))[O(F)]??[],this.fetchSeriesValuesWithMatch=async(F,I,U,W=this.timeRange)=>{const A=F?this.datasource.interpolateString(F):null,N=I?this.datasource.interpolateString(I):null,V={...this.datasource.getAdjustedInterval(W),...N&&{"match[]":N}};let T={...this.getDefaultCacheHeaders(),...U&&{requestId:U}};Object.keys(T).length||(T=void 0);const z=(0,m.$H)(O(A??""));return await this.request(`/api/v1/label/${z}/values`,[],V,T)??[]},this.getSeriesLabels=async(F,I)=>{let U,W;this.datasource.hasLabelsMatchAPISupport()?(I.push({name:"__name__",value:"",op:"!="}),W=await this.fetchSeriesLabelsMatch(F),U=Object.keys(W)):(W=await this.getSeries(F),U=Object.keys(W));const A=new Set(I.map(N=>N.name));return U.filter(N=>!A.has(N))},this.fetchLabelsWithMatch=async(F,I)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(F,I):this.fetchSeriesLabels(F,I,d.bS),this.fetchSeriesLabels=async(F,I,U)=>{const W=this.datasource.interpolateString(F);let N={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":W};U!=="none"&&(N={...N,limit:U??d._N});const V=await this.request("/api/v1/series",[],N,this.getDefaultCacheHeaders()),{values:T}=(0,u.P7)(V,I);return T},this.fetchSeriesLabelsMatch=async(F,I)=>{const U=this.datasource.interpolateString(F),A={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":U};return(await this.request("/api/v1/labels",[],A,this.getDefaultCacheHeaders())).reduce((V,T)=>({...V,[T]:""}),{})},this.fetchSeries=async F=>{const I="/api/v1/series",W={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":F};return await this.request(I,{},W,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,t.once)(async()=>{const F=await Promise.all(f.map(I=>this.fetchLabelValues(I)));return f.reduce((I,U,W)=>({...I,[U]:F[W]}),{})}),this.fetchSuggestions=async(F,I,U,W,A,N,K)=>{F&&(this.timeRange=F);const V="/suggestions",T=this.datasource.getAdjustedInterval(this.timeRange);return await this.request(V,[],{labelName:A,queries:I?.map(w=>this.datasource.interpolateString(w.expr,{...this.datasource.getIntervalVars(),...this.datasource.getRangeScopedVars(this.timeRange)})),scopes:U?.reduce((w,H)=>(w.push(...H.spec.filters),w),[]),adhocFilters:W?.map(w=>({key:w.key,operator:s.n[w.operator],value:w.value,values:w.values})),limit:N,...T},{...K&&{requestId:K},headers:{...this.getDefaultCacheHeaders()?.headers,"Content-Type":"application/json"},method:"POST"})??[]},this.datasource=L,this.histogramMetrics=[],this.timeRange=(0,x.E2)(),this.metrics=[],Object.assign(this,B)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==E.fD.None)return D(this.datasource.getCacheDurationInMinutes()*60)}cleanText(L){return L.split(y).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return g.Ay}async loadMetricsMetadata(){const L=D(this.datasource.getDaysToCacheMetadata()*P);this.metricsMetadata=(0,u.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...L}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(L){return(0,u.pt)(L)}exportToAbstractQuery(L){const B=L.expr;if(!B||B.length===0)return{refId:L.refId,labelMatchers:[]};const F=a().tokenize(B,g.Ay),I=(0,u.VH)(F),U=S(B,F);return U&&U.length>0&&I.push({name:"__name__",operator:c.D_.Equal,value:U}),{refId:L.refId,labelMatchers:I}}async getSeries(L,B){if(this.datasource.lookupsDisabled)return{};try{return L===p?await this.fetchDefaultSeries():await this.fetchSeriesLabels(L,B,d.bS)}catch(F){return console.error(F),{}}}async getLabelValues(L){return await this.fetchLabelValues(L)}}function S(R,L){let B="";for(const F of L)if(typeof F=="string"){B=F;break}return B}function M(R){return typeof R=="object"&&R!==null&&"cancelled"in R&&R.cancelled===!0}function O(R){return R.match(/^"(.*)"$/)?.[1]??R}},87574:(q,j,e)=>{"use strict";e.d(j,{Cs:()=>R,DX:()=>C,P7:()=>E,P_:()=>h,Qn:()=>O,Rg:()=>o,VH:()=>W,Xd:()=>A,eN:()=>l,ky:()=>V,mv:()=>K,pt:()=>I,u3:()=>N});var t=e(2543),n=e.n(t),r=e(28848),a=e.n(r),i=e(58462),x=e(27844),s=e(30468),c=e(29927),d=e(75257),u=e(79277),g=e(83909);const o=T=>{const z=new Set,w=new RegExp("_bucket($|:)");for(let H=0;H<T.length;H++){const G=T[H];w.test(G)&&z.add(G)}return[...z]};function E(T,z=!1){const w={};T.forEach(G=>{const{__name__:X,...k}=G;z&&(w.__name__=w.__name__||new Set,w.__name__.has(X)||w.__name__.add(X)),Object.keys(k).forEach(_=>{w[_]||(w[_]=new Set),w[_].has(k[_])||w[_].add(k[_])})});const H={};return P(Object.keys(w)).forEach(G=>{H[G]=P(Array.from(w[G]))}),{values:H,keys:Object.keys(H)}}const m=/\{[^}]*?(\}|$)/,f=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function p(T,z=1){if(!T.match(m)){if(T.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${T}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+T)}const w=T.slice(0,z),H=w.lastIndexOf("{"),G=w.lastIndexOf("}");if(H===-1)throw new Error("Not inside selector, missing open brace: "+w);if(G>-1&&G>H)throw new Error("Not inside selector, previous selector already closed: "+w);const X=T.slice(z),_=X.indexOf("}")+z,ee=X.indexOf("{"),J=ee+z;if(_===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+X);if(ee>-1&&J<_)throw new Error("Not inside selector, next selector opens before this one closed: "+X);const Z=T.slice(H,_),te={};Z.replace(f,(he,oe,de,me)=>{const Pe=T.indexOf(he),Ee=Pe+oe.length+de.length+1,be=Pe+oe.length+de.length+me.length-1;return(z<Ee||z>be)&&(te[oe]={value:me,operator:de}),""});const re=T.slice(0,H).match(/[A-Za-z:][\w:]*$/);re&&(te.__name__={value:`"${re[0]}"`,operator:"="});const ne=Object.keys(te).sort(),le=["{",ne.map(he=>`${he}${te[he].operator}${te[he].value}`).join(","),"}"].join("");return{labelKeys:ne,selector:le}}function h(T,z){const w=k=>new RegExp(`(\\s|\\(|^)(${k})(\\s|$|\\(|\\[|\\{)`,"ig"),H=Object.keys(z).reduce((k,_)=>{let ee=[],J=[],Z=[];return k.filter(Boolean).forEach((te,ae)=>{te.match(w(_))&&(ee=te.split(_),ee.length===2?(Z.push(ae),J.push(...[ee[0],_,ee[1]].filter(Boolean))):ee.length>2&&(Z.push(ae),ee=ee.map(ne=>ne===""?_:ne),J.push(...ee)))}),Z.forEach(te=>k[te]=""),k=k.filter(Boolean),k.push(...J),k},[T]);let G=!1;return H.map((k,_)=>{if(G)return G=!1,"";if(z[k]){const{expandedQuery:ee,identifierValue:J,identifier:Z}=z[k];if(_+1!==H.length&&H[_+1].match(f)){G=!0;const te=new RegExp(`(,)?(\\s)?(${Z}=\\"${J}\\")(,)?(\\s)?`,"g"),ae=H[_+1].replace(te,""),re=/(\)\{|\}\{|\]\{)/;return D(ee+ae,re)}else return ee}return k}).filter(Boolean).join("")}function D(T,z){const w=T.match(z);if(!w)return T;const H=w.index??0,G=T.slice(0,H+1),X=T.slice(H+1),k=[];X.replace(f,(Z,te,ae,re,ne,ce)=>(k.push({key:te,operator:ae,value:re,comma:ne,space:ce}),""));let _=G;k.filter(Boolean).forEach(Z=>{const te=Z.value.slice(1,-1);_=(0,c.t)(_,Z.key,te,Z.operator)});let ee=k.reduce((Z,te)=>(Z+=`${te.key}${te.operator}${te.value}${te.comma??""}${te.space??""}`,Z),"");ee="{"+ee+"}";const J=X.replace(ee,"");return _+J}function C(T){if(!T)return T;const z={},w={};for(const G in T){const X=T[G][0];z[G]=X,X.type==="histogram"&&(w[`${G}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${X.help})`},w[`${G}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${X.help})`},w[`${G}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${X.help})`}),X.type==="summary"&&(w[`${G}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${X.help})`},w[`${G}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${X.help})`})}const H={};return H.ALERTS={type:"gauge",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...z,...w,...H}}function l(T){return v(T/1e3)}function v(T){return Math.floor(T/60)}function y(T,z=1){return Math.ceil(T/60)-Math.ceil(T/60)%z}function P(T){return T.slice(0,d.OP)}function b(T){return T&&T.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const S=/[*+?()|\\.\[\]{}^$]/g;function M(T){return T.replace(S,"\\$&")}function O(T){return T.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function R(T){return O(M(T))}const L={"=":i.D_.Equal,"!=":i.D_.NotEqual,"=~":i.D_.EqualRegEx,"!~":i.D_.NotEqualRegEx},B=(0,t.invert)(L);function F(T){const z=T.labelMatchers.map(w=>{const H=B[w.operator];return H?`${w.name}${H}"${w.value}"`:""}).filter(w=>w!=="").join(", ");return z?`{${z}}`:""}function I(T){return{refId:T.refId,expr:F(T),range:!0}}function U(T){return typeof T.content=="string"?T.content:""}function W(T){const z=[];for(const w of T)if(w instanceof r.Token&&w.type==="context-labels"){let H="",G="",X="";const k=Array.isArray(w.content)?w.content:[w.content];for(let _ of k)if(typeof _=="string"){let ee;ee=_,(ee==="="||ee==="!="||ee==="=~"||ee==="!~")&&(X=ee)}else if(_ instanceof r.Token)switch(_.type){case"label-key":H=U(_);break;case"label-value":G=U(_),G=G.substring(1,G.length-1);const ee=L[X];ee&&z.push({name:H,operator:ee,value:G});break}}return z}function A(T,z){if(T===g.fD.None)return{start:K(z.from,!1).toString(),end:K(z.to,!0).toString()};const w=K(z.from,!1),H=(0,x.rs)(w,N(T)*60),G=K(z.to,!0),X=y(G,N(T))*60;if(H===X){const ee=X+N(T)*60;return{start:H.toString(),end:ee.toString()}}const k=H.toString(),_=X.toString();return{start:k,end:_}}function N(T){switch(T){case g.fD.Medium:return 10;case g.fD.High:return 60;default:return 1}}function K(T,z){return typeof T=="string"&&(T=s.parse(T,z)),Math.ceil(T.valueOf()/1e3)}function V(T,z){return z===void 0&&(z=u.o6),T.length=Math.min(T.length,z),T}},93981:(q,j,e)=>{"use strict";e.d(j,{AW:()=>x,Ay:()=>d,n6:()=>c});const t=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],n=["by","group_left","group_right","ignoring","on","offset","without"],r=null,a=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],x=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...a,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"double_exponential_smoothing",label:"double_exponential_smoothing",detail:"double_exponential_smoothing(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Renamed as double_exponential_smoothing in prometheus v3.x. For prometheus versions equal and greater than v3.0 please use double_exponential_smoothing. \n\nProduces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],s=x.map(u=>u.label),c={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${x.map(u=>u.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${n.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},d=c},18990:(q,j,e)=>{"use strict";e.d(j,{l:()=>b,z:()=>S});var t=e(93981),n=e(88093),r=e(31879),a=e(76799),i=e(5091);function x(){return[{id:i.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:i.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},s({id:i.jN.HistogramAvg}),s({id:i.jN.HistogramCount}),s({id:i.jN.HistogramSum}),{id:i.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:i.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},s({id:i.jN.HistogramStddev}),s({id:i.jN.HistogramStdvar}),{id:i.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:i.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:n.kf,addOperationHandler:n.iZ},{id:i.jN.Ln,name:"Ln",params:[],defaultParams:[],category:i.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},c(i.jN.Changes),c(i.jN.Rate,!0),c(i.jN.Irate),c(i.jN.Increase,!0),c(i.jN.Idelta),c(i.jN.Delta),s({id:i.jN.DoubleExponentialSmoothing,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:g,changeTypeHandler:d}),s({id:i.jN.HoltWinters,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:g,changeTypeHandler:d}),s({id:i.jN.PredictLinear,params:[(0,n.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:g,changeTypeHandler:d}),s({id:i.jN.QuantileOverTime,params:[(0,n.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:i.Ag.RangeFunctions,renderer:n.Kl,addOperationHandler:g,changeTypeHandler:d}),...r.Iu,{id:i.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:i.Ag.BinaryOps,renderer:(O,R,L)=>L,addOperationHandler:o},s({id:i.jN.Abs}),s({id:i.jN.Absent}),s({id:i.jN.Acos,category:i.Ag.Trigonometric}),s({id:i.jN.Acosh,category:i.Ag.Trigonometric}),s({id:i.jN.Asin,category:i.Ag.Trigonometric}),s({id:i.jN.Asinh,category:i.Ag.Trigonometric}),s({id:i.jN.Atan,category:i.Ag.Trigonometric}),s({id:i.jN.Atanh,category:i.Ag.Trigonometric}),s({id:i.jN.Ceil}),s({id:i.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),s({id:i.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),s({id:i.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),s({id:i.jN.Cos,category:i.Ag.Trigonometric}),s({id:i.jN.Cosh,category:i.Ag.Trigonometric}),s({id:i.jN.DayOfMonth,category:i.Ag.Time}),s({id:i.jN.DayOfWeek,category:i.Ag.Time}),s({id:i.jN.DayOfYear,category:i.Ag.Time}),s({id:i.jN.DaysInMonth,category:i.Ag.Time}),s({id:i.jN.Deg}),c(i.jN.Deriv),s({id:i.jN.Exp}),s({id:i.jN.Floor}),s({id:i.jN.Hour}),s({id:i.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:a.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:a.r}],defaultParams:["",",",""],renderer:E,explainHandler:m,addOperationHandler:f}),s({id:i.jN.Log10}),s({id:i.jN.Log2}),s({id:i.jN.Minute}),s({id:i.jN.Month}),s({id:i.jN.Pi,renderer:O=>`${O.id}()`}),s({id:i.jN.Rad}),c(i.jN.Resets),s({id:i.jN.Round,category:i.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),s({id:i.jN.Scalar}),s({id:i.jN.Sgn}),s({id:i.jN.Sin,category:i.Ag.Trigonometric}),s({id:i.jN.Sinh,category:i.Ag.Trigonometric}),s({id:i.jN.Sort}),s({id:i.jN.SortDesc}),s({id:i.jN.Sqrt}),s({id:i.jN.Stddev}),s({id:i.jN.Tan,category:i.Ag.Trigonometric}),s({id:i.jN.Tanh,category:i.Ag.Trigonometric}),s({id:i.jN.Time,renderer:O=>`${O.id}()`}),s({id:i.jN.Timestamp}),s({id:i.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:O=>`${O.id}(${O.params[0]})`}),s({id:i.jN.Year})]}function s(M){return{...M,id:M.id,name:M.name??(0,n.DQ)(M.id),params:M.params??[],defaultParams:M.defaultParams??[],category:M.category??i.Ag.Functions,renderer:M.renderer??(M.params?n.kf:n.jY),addOperationHandler:M.addOperationHandler??n.iZ}}function c(M,O=!1){return{id:M,name:(0,n.DQ)(M),params:[(0,n.z2)(O)],defaultParams:[O?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:u,addOperationHandler:g,changeTypeHandler:d}}function d(M,O){return(M.params[0]==="$__rate_interval"&&O.defaultParams[0]!=="$__rate_interval"||M.params[0]==="$__interval"&&O.defaultParams[0]!=="$__interval")&&(M.params=O.defaultParams),M}function u(M,O,R){let L=(M.params??[])[0]??"5m";return`${O.id}(${R}[${L}])`}function g(M,O,R){const L={id:M.id,params:M.defaultParams};return O.operations.length>0&&R.getOperationDef(O.operations[0].id).addOperationHandler===g?{...O,operations:[L,...O.operations.slice(1)]}:{...O,operations:[L,...O.operations]}}function o(M,O){return{...O,binaryQueries:[...O.binaryQueries??[],{operator:"/",query:O}]}}function E(M,O,R){const L=M.params[0]??"",F=`"${M.params[1]??""}"`;return`${M.id}(${R}, "${L}", ${F}, "${M.params.slice(2).join(F)}")`}function m(M,O){let R=O?.documentation??"no docs";return typeof M.params[1]!="string"&&(R+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),R}function f(M,O){const R={id:M.id,params:M.defaultParams};return{...O,operations:[...O.operations,R]}}function p(){return[...(0,n.G3)(i.jN.Sum),...(0,n.G3)(i.jN.Avg),...(0,n.G3)(i.jN.Min),...(0,n.G3)(i.jN.Max),...(0,n.G3)(i.jN.Count),...(0,n.G3)(i.jN.Group),...(0,n.jC)(i.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(i.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(i.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),...(0,n.jC)(i.jN.Quantile,{params:[{name:"Value",type:"number"}],defaultParams:[1]}),h(i.jN.SumOverTime),h(i.jN.AvgOverTime),h(i.jN.MinOverTime),h(i.jN.MaxOverTime),h(i.jN.CountOverTime),h(i.jN.LastOverTime),h(i.jN.PresentOverTime),h(i.jN.AbsentOverTime),h(i.jN.StddevOverTime)]}function h(M){return{id:M,name:(0,n.DQ)(M),params:[(0,n.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:i.Ag.RangeFunctions,renderer:D,addOperationHandler:g}}function D(M,O,R){let L=(M.params??[])[0]??"$__interval";return`${O.id}(${R}[${L}])`}var C=e(64015),l=e(32370),v=e(15511),y=e(23401);class P{constructor(O){this.categories=[],this.operationsRegistry=new C.O(O)}setOperationCategories(O){this.categories=O}getOperationsForCategory(O){return this.operationsRegistry.list().filter(R=>R.category===O&&!R.hideFromList)}getAlternativeOperations(O){return this.operationsRegistry.list().filter(R=>R.alternativesKey&&R.alternativesKey===O)}getCategories(){return this.categories}getOperationDef(O){return this.operationsRegistry.getIfExists(O)}renderOperations(O,R){for(const L of R){const B=this.operationsRegistry.getIfExists(L.id);if(!B)throw new Error(`Could not find operation ${L.id} in the registry`);O=B.renderer(L,B,O)}return O}renderBinaryQueries(O,R){if(R)for(const L of R)O=`${this.renderBinaryQuery(O,L)}`;return O}renderBinaryQuery(O,R){let L=O+` ${R.operator} `;return R.vectorMatches&&(L+=`${R.vectorMatchesType}(${R.vectorMatches}) `),L+this.renderQuery(R.query,!0)}renderLabels(O){if(O.length===0)return"";let R="{";for(const L of O){R!=="{"&&(R+=", ");let B=L.value;const F=L.op==="=~"||L.op==="!~";l.$.featureToggles.prometheusSpecialCharsInLabelValues&&!F&&(B=(0,v.ee)(B)),R+=`${(0,y.Nc)(L.label)}${L.op}"${B}"`}return R+"}"}renderQuery(O,R){let L="";const B=this.renderLabels(O.labels);return O.metric?(0,y.Rq)(O.metric)?L=`${O.metric}${B}`:L=`{"${O.metric}"${B.length>0?`, ${B.substring(1)}`:"}"}`:L=B,L=this.renderOperations(L,O.operations),!R&&this.hasBinaryOp(O)&&O.binaryQueries?.length&&(L=`(${L})`),L=this.renderBinaryQueries(L,O.binaryQueries),R&&(this.hasBinaryOp(O)||O.binaryQueries?.length)&&(L=`(${L})`),L}hasBinaryOp(O){return O.operations.find(R=>this.getOperationDef(R.id)?.category===i.Ag.BinaryOps)!==void 0}}class b extends P{constructor(){super(()=>{const O=[...x(),...p()];for(const R of O){const L=t.AW.find(B=>B.insertText===R.id);L&&(R.documentation=L.documentation)}return O}),this.setOperationCategories([i.Ag.Aggregations,i.Ag.RangeFunctions,i.Ag.Functions,i.Ag.BinaryOps,i.Ag.Trigonometric,i.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:i.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:i.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:i.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:i.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:i.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const S=new b},31879:(q,j,e)=>{"use strict";e.d(j,{AE:()=>a,C8:()=>r,Iu:()=>i});var t=e(88093),n=e(5091);const r=[{id:n.jN.Addition,name:"Add scalar",sign:"+"},{id:n.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.jN.Exponent,name:"Exponent",sign:"^"},{id:n.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],a=r.reduce((s,c)=>(s[c.sign]={id:c.id,comparison:c.comparison},s),{}),i=r.map(s=>{const c=[{name:"Value",type:"number"}];let d=[2];return s.comparison&&(c.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),d=[2,!1]),{id:s.id,name:s.name,params:c,defaultParams:d,alternativesKey:"binary scalar operations",category:n.Ag.BinaryOps,renderer:x(s.sign),addOperationHandler:t.iZ}});function x(s){return function(d,u,g){let o=d.params[0],E="";return d.params.length===2&&(E=d.params[1]?" bool":""),`${g} ${s}${E} ${o}`}}},76799:(q,j,e)=>{"use strict";e.d(j,{r:()=>s});var t=e(74848),n=e(96540),r=e(35095),a=e(44826),i=e(18990),x=e(88093);function s({onChange:d,index:u,operationId:g,value:o,query:E,datasource:m}){const[f,p]=(0,n.useState)({});return(0,t.jsx)(a.l6,{inputId:(0,x.OS)(g,u),autoFocus:o===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{p({isLoading:!0});const h=await c(E,m);p({options:h,isLoading:void 0})},isLoading:f.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:f.options,value:(0,r.z)(o),onChange:h=>d(u,h.value)})}async function c(d,u){let g=d.labels;u.type==="prometheus"&&(g=[{label:"__name__",op:"=",value:d.metric},...d.labels]);const o=i.z.renderLabels(g),E=await u.languageProvider.fetchLabelsWithMatch(o);return Object.keys(E).map(m=>({label:m,value:m}))}},79277:(q,j,e)=>{"use strict";e.d(j,{dm:()=>O,o6:()=>M});var t=e(74848),n=e(22803),r=e(76459),a=e.n(r),i=e(96540),x=e(23257),s=e.n(x),c=e(35095),d=e(58779),u=e(75349),g=e(30048),o=e(29675),E=e(54594),m=e(79784),f=e(77299),p=e(74162),h=e(99134),D=e(44826),C=e(77222),l=e(60484),v=e(87574),y=e(25734),P=e(3132),b=e(49130);const S=" ",M=1e3;function O({datasource:F,query:I,onChange:U,onGetMetrics:W,labelsFilters:A,metricLookupDisabled:N,onBlur:K,variableEditor:V}){const T=(0,o.of)(R),[z,w]=(0,i.useState)({}),H=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],G=(0,i.useCallback)((re,ne)=>{const ce=re.label??re.value;return ce?ce.toLowerCase?ne.split(S).reduce((he,oe)=>{const de=ce.toLowerCase().includes(oe.toLowerCase());return he&&(de||ce==="Metrics explorer")},!0):!0:!1},[]),X=(0,i.useCallback)((re,ne)=>re.__isNew__?re.label:(0,t.jsx)(s(),{searchWords:ne.inputValue.split(S),textToHighlight:re.label??"",highlightClassName:T.highlight}),[T.highlight]),k=(re,ne)=>{const ce=(0,y.b4)(re);return L(ce,ne)},_=re=>F.metricFindQuery(k(re,A)).then(ce=>{const le=ce.length;(0,v.ky)(ce),le>ce.length?w({...z,resultsTruncated:!0}):w({...z,resultsTruncated:!1});const he=ce.map(oe=>({label:oe.text,value:oe.text}));return[...H,...he]}),ee=()=>Promise.resolve([]),J=a()(re=>_(re),F.getDebounceTimeInMilliseconds()),Z=re=>{const ne=re.data;if(ne.value==="BrowseMetrics"){const ce=re.isFocused?T.focus:"";return(0,t.jsx)("div",{...re.innerProps,ref:re.innerRef,className:`${T.customOptionWidth} metric-encyclopedia-open`,"data-testid":d.Tp.components.Select.option,onKeyDown:le=>{le.code==="Enter"&&w({...z,metricsModalOpen:!0})},children:(0,t.jsxs)("div",{className:`${T.customOption} ${ce} metric-encyclopedia-open`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"metric-encyclopedia-open",children:ne.label}),(0,t.jsx)("div",{className:`${T.customOptionDesc} metric-encyclopedia-open`,children:ne.description})]}),(0,t.jsxs)(E.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>w({...z,metricsModalOpen:!0}),className:"metric-encyclopedia-open",children:["Open",(0,t.jsx)(m.I,{name:"arrow-right"})]})]})})}return(0,f.o5)(re)},te=({children:re,maxHeight:ne,innerRef:ce,innerProps:le})=>{const he=(0,o.$j)(),oe=(0,p.J)(he),de=!i.isValidElement(re)&&z.resultsTruncated;return(0,t.jsxs)("div",{...le,className:`${oe.menu} ${T.customMenuContainer}`,style:{maxHeight:Math.round(ne*.9)},"aria-label":"Select options menu",children:[(0,t.jsx)(h.P,{ref:ce,showScrollIndicators:!0,children:re}),de&&(0,t.jsx)("div",{className:T.customMenuFooter,children:(0,t.jsx)("div",{children:"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics."})})]})},ae=()=>(0,t.jsx)(D.DW,{"data-testid":d.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!V,inputId:"prometheus-metric-select",className:T.select,value:I.metric?(0,c.z)(I.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:X,filterOption:G,minMenuHeight:250,onOpenMenu:async()=>{if(N)return;w({isLoading:!0});const re=await W(),ne=re.map(le=>le.value),ce=re.length;re.length>M&&(0,v.ky)(re),w({metrics:[...H,...re],isLoading:void 0,initialMetrics:ne,resultsTruncated:ce>re.length})},loadOptions:N?ee:J,isLoading:z.isLoading,defaultOptions:z.metrics??Array.from(new Array(25),()=>({value:""})),onChange:re=>{const ne=re?.value;ne?ne==="BrowseMetrics"?((0,b.E5)("grafana_prometheus_metric_encyclopedia_open",null,"",I),w({...z,metricsModalOpen:!0})):U({...I,metric:ne}):U({...I,metric:""})},components:{Option:Z,MenuList:te},onBlur:K});return(0,t.jsxs)(t.Fragment,{children:[!F.lookupsDisabled&&z.metricsModalOpen&&(0,t.jsx)(P.Ly,{datasource:F,isOpen:z.metricsModalOpen,onClose:()=>w({...z,metricsModalOpen:!1}),query:I,onChange:U,initialMetrics:z.initialMetrics??[]}),V?(0,t.jsx)(C.C,{children:(0,t.jsx)(l.I,{label:"Metric",labelWidth:20,tooltip:(0,t.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:ae()})}):(0,t.jsx)(u.B,{children:(0,t.jsx)(g.c,{label:"Metric",children:ae()})})]})}const R=F=>({select:(0,n.css)({minWidth:"125px"}),highlight:(0,n.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:F.colors.warning.contrastText,backgroundColor:F.colors.warning.main}),customOption:(0,n.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:F.colors.emphasize(F.colors.background.primary,.1)}}),customOptionlabel:(0,n.css)({color:F.colors.text.primary}),customOptionDesc:(0,n.css)({color:F.colors.text.secondary,fontSize:F.typography.size.xs,opacity:"50%"}),focus:(0,n.css)({backgroundColor:F.colors.emphasize(F.colors.background.primary,.1)}),customOptionWidth:(0,n.css)({minWidth:"400px"}),customMenuFooter:(0,n.css)({flex:0,display:"flex",justifyContent:"space-between",padding:F.spacing(1.5),borderTop:`1px solid ${F.colors.border.weak}`,color:F.colors.text.secondary}),customMenuContainer:(0,n.css)({display:"flex",flexDirection:"column",background:F.colors.background.primary,boxShadow:F.shadows.z3})}),L=(F,I)=>{const U=I?B(I):[];return`label_values({__name__=~".*${F}"${U?U.join(""):""}},__name__)`},B=F=>F.map(I=>`,${I.label}="${I.value}"`)},63372:(q,j,e)=>{"use strict";e.d(j,{I:()=>N});var t=e(74848),n=e(96540),r=e(32370),a=e(75257),i=e(87574),x=e(18990),s=e(25734),c=e(22803),d=e(2543),u=e(26774),g=e(75349),o=e(30048),E=e(77222),m=e(76302),f=e(76459),p=e.n(f),h=e(35095),D=e(58779),C=e(72500),l=e(20301),v=e(44826);function y({item:V,defaultOp:T,onChange:z,onDelete:w,onGetLabelNames:H,onGetLabelValues:G,invalidLabel:X,invalidValue:k,getLabelValuesAutofillSuggestions:_,debounceDuration:ee}){const[J,Z]=(0,n.useState)({}),[te,ae]=(0,n.useState)(!1),[re,ne]=(0,n.useState)(!1),[ce,le]=(0,n.useState)([]),he=(Ee=V.op)=>P.find(be=>be.label===Ee)?.isMultiValue,oe=Ee=>{if(Ee){const be=/\(([^)]+)\)/,Se=Ee?.match(be);return Se&&Se[0].indexOf("|")>0?[Ee]:Ee.indexOf("|")>0?Ee.split("|"):[Ee]}return[]},de=p()(Ee=>_(Ee,V.label),ee),me=p()(Ee=>{const be=ce.filter(Se=>Se.value.includes(Ee));return(0,i.ky)(be)},ee),Pe=V?.value??"";return(0,t.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,t.jsxs)(C.M,{children:[(0,t.jsx)(v.DW,{placeholder:"Select label","data-testid":D.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:V.label?(0,h.z)(V.label):null,allowCustomValue:!0,onOpenMenu:async()=>{Z({isLoadingLabelNames:!0});const Ee=await H(V);le(Ee),ae(!0);const be=(0,i.ky)(Ee);Z({labelNames:be,isLoadingLabelNames:void 0})},onCloseMenu:()=>{ae(!1)},isOpen:te,isLoading:J.isLoadingLabelNames??!1,loadOptions:me,defaultOptions:J.labelNames,onChange:Ee=>{Ee.label&&z({...V,op:V.op??T,label:Ee.label})},invalid:X}),(0,t.jsx)(v.l6,{"data-testid":D.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,h.z)(V.op??T),options:P,width:"auto",onChange:Ee=>{Ee.value!=null&&z({...V,op:Ee.value,value:he(Ee.value)?V.value:oe(V?.value)[0]})}}),(0,t.jsx)(v.DW,{placeholder:"Select value","data-testid":D.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:he()?oe(Pe).map(h.z):oe(Pe).map(h.z)[0],allowCustomValue:!0,formatCreateLabel:Ee=>Ee,createOptionPosition:V.op?.includes("~")?"first":"last",onOpenMenu:async()=>{Z({isLoadingLabelValues:!0});const Ee=await G(V);(0,i.ky)(Ee),ne(!0),Z({...J,labelValues:Ee,isLoadingLabelValues:void 0})},onCloseMenu:()=>{ne(!1)},isOpen:re,defaultOptions:J.labelValues,isMulti:he(),isLoading:J.isLoadingLabelValues,loadOptions:de,onChange:Ee=>{if(Ee.value)z({...V,value:Ee.value,op:V.op??T});else{const be=Ee.map(Se=>Se.label).join("|");z({...V,value:be,op:V.op??T})}},invalid:k}),(0,t.jsx)(l.Z,{"aria-label":`remove-${V.label}`,icon:"times",variant:"secondary",onClick:w})]})},Pe)}const P=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],b="Select at least 1 label filter (label and value)";function S({labelsFilters:V,onChange:T,onGetLabelNames:z,onGetLabelValues:w,labelFilterRequired:H,getLabelValuesAutofillSuggestions:G,debounceDuration:X,variableEditor:k}){const _="=",[ee,J]=(0,n.useState)([{op:_}]);(0,n.useEffect)(()=>{V.length>0?J(V):J([{op:_}])},[V]);const Z=re=>{J(re);const ne=re.filter(ce=>ce.label!=null&&ce.value!=null);(0,d.isEqual)(ne,V)||T(ne)},te=ee.some(re=>re.label&&re.value),ae=()=>(0,t.jsx)(u.o,{items:ee,onChange:Z,renderItem:(re,ne,ce)=>(0,t.jsx)(y,{debounceDuration:X,item:re,defaultOp:_,onChange:ne,onDelete:ce,onGetLabelNames:z,onGetLabelValues:w,invalidLabel:H&&!re.label,invalidValue:H&&!re.value,getLabelValuesAutofillSuggestions:G})});return(0,t.jsx)(t.Fragment,{children:k?(0,t.jsx)(E.C,{children:(0,t.jsxs)("div",{className:(0,c.cx)((0,c.css)({display:"flex"})),children:[(0,t.jsx)(m.c,{width:20,tooltip:(0,t.jsx)("div",{children:"Optional: used to filter the metric select for this query type."}),children:"Label filters"}),ae()]})}):(0,t.jsx)(g.B,{children:(0,t.jsx)(o.c,{label:"Label filters",error:b,invalid:H&&!te,children:ae()})})})}var M=e(51064),O=e(54594),R=e(60484),L=e(3132),B=e(49130);function F({datasource:V,query:T,onChange:z,onGetMetrics:w,labelsFilters:H,variableEditor:G}){const[X,k]=(0,n.useState)(!1),_=(0,n.useCallback)(async ae=>(await V.metricFindQuery(W(ae,H))).map(ce=>({label:ce.text,value:ce.text})),[V,H]),ee=(0,n.useCallback)(ae=>{z({...T,metric:ae?.value??""})},[z,T]),J=(0,n.useCallback)(async ae=>(ae.length?await _(ae):await w()).map(ne=>({label:ne.label??ne.value,value:ne.value})),[_,w]),Z=(0,n.useCallback)(async()=>{const ae=await w(),re=[];for(const ne of ae)ne.value&&re.push(ne.value);return re},[w]),te=()=>(0,t.jsxs)(C.M,{children:[(0,t.jsx)(M.G,{placeholder:"Select metric",width:"auto",minWidth:25,options:J,value:T.metric,onChange:ee,createCustomValue:!0}),(0,t.jsx)(O.$n,{tooltip:"Open metrics explorer","aria-label":"Open metrics explorer",variant:"secondary",icon:"book-open",onClick:()=>{(0,B.E5)("grafana_prometheus_metric_encyclopedia_open",null,"",T),k(!0)}})]});return(0,t.jsxs)(t.Fragment,{children:[!V.lookupsDisabled&&X&&(0,t.jsx)(L.Ly,{datasource:V,isOpen:X,onClose:()=>k(!1),query:T,onChange:z,initialMetrics:Z}),G?(0,t.jsx)(E.C,{children:(0,t.jsx)(R.I,{label:"Metric",labelWidth:20,tooltip:(0,t.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:te()})}):(0,t.jsx)(g.B,{children:(0,t.jsx)(o.c,{label:"Metric",children:te()})})]})}const I=(V,T)=>{const z=T?U(T):[];return`label_values({__name__=~".*${V}"${z?z.join(""):""}},__name__)`},U=V=>V.map(T=>`,${T.label}="${T.value}"`),W=(V,T)=>{const z=(0,s.b4)(V);return I(z,T)};var A=e(79277);function N({datasource:V,query:T,onChange:z,onBlur:w,variableEditor:H}){const G=re=>{z({...T,labels:re})},X=(0,n.useCallback)(async re=>{const ne=V.getVariables(),ce=await re;return[...ne.map(le=>({label:le,value:le})),...ce.map(le=>({label:le.value,value:le.value,title:le.description}))]},[V]),k=async re=>{if(!T.metric)return await V.languageProvider.fetchLabels(),V.languageProvider.getLabelKeys().map(he=>({value:he}));const ne=T.labels.filter(he=>he!==re);ne.push({label:"__name__",op:"=",value:T.metric});const ce=x.z.renderLabels(ne);let le=await V.languageProvider.fetchLabelsWithMatch(ce);return Object.keys(le).filter(he=>!ne.find(oe=>oe.label===he)).map(he=>({value:he}))},_=(re,ne)=>{const ce={label:ne??"__name__",op:"=~",value:(0,s.b4)(`.*${re}`)},le=T.labels.filter(me=>me.label!==ce.label);le.push(ce),T.metric&&le.push({label:"__name__",op:"=",value:T.metric});const he=le.map(me=>({...me,label:V.interpolateString(me.label),value:V.interpolateString(me.value)})),oe=x.z.renderLabels(he);let de;return V.hasLabelsMatchAPISupport()?de=J(ce,oe):de=ee(ce,oe),de.then(me=>((0,i.ky)(me),me))},ee=(re,ne)=>{if(!re.label)return Promise.resolve([]);const ce=V.languageProvider.fetchSeries(ne),le=V.interpolateString(re.label);return ce.then(he=>{const oe=new Set;return he.forEach(de=>{const me=de[le];oe.add(me)}),Array.from(oe).map(de=>({label:de,value:de}))})},J=(re,ne)=>{if(!re.label)return Promise.resolve([]);const ce=`[${V.uid}][${T.metric}][${re.label}][${re.op}]`;return V.languageProvider.fetchSeriesValuesWithMatch(re.label,ne,ce).then(le=>le.map(he=>({value:he,label:he})))},Z=async re=>{if(!re.label)return[];if(!T.metric)return(await V.languageProvider.getLabelValues(re.label)).map(he=>({value:he}));const ne=T.labels.filter(he=>he!==re);ne.push({label:"__name__",op:"=",value:T.metric});const ce=ne.map(he=>({...he,label:V.interpolateString(he.label),value:V.interpolateString(he.value)})),le=x.z.renderLabels(ce);return V.hasLabelsMatchAPISupport()?J(re,le):ee(re,le)},te=(0,n.useCallback)(()=>X(K(V,T)),[V,T,X]),ae=r.$.featureToggles.prometheusUsesCombobox?F:A.dm;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ae,{query:T,onChange:z,onGetMetrics:te,datasource:V,labelsFilters:T.labels,metricLookupDisabled:V.lookupsDisabled,onBlur:w||(()=>{}),variableEditor:H}),(0,t.jsx)(S,{debounceDuration:V.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:_,labelsFilters:T.labels,onChange:G,onGetLabelNames:re=>X(k(re)),onGetLabelValues:re=>X(Z(re)),variableEditor:H})]})}async function K(V,T){V.languageProvider.metricsMetadata||await V.languageProvider.loadMetricsMetadata(),V.languageProvider.metricsMetadata||(V.languageProvider.metricsMetadata={});let z;if(T.labels.length>0){const w=x.z.renderLabels(T.labels);z=(await V.languageProvider.getSeries(w,!0)).__name__??[]}else z=await V.languageProvider.getLabelValues("__name__")??[];return z.map(w=>({value:w,description:(0,a.xB)(w,V.languageProvider.metricsMetadata)}))}},41010:(q,j,e)=>{"use strict";e.d(j,{W:()=>u,i:()=>g});var t=e(74848),n=e(96540),r=e(48583),a=e(93981),i=e(18990),x=e(11222),s=e(48432),c=e(90375),d=e(37886);const u="Fetch all series matching metric name and label filters.",g=(0,n.memo)(({query:o})=>{const E=(0,x.u)(o||"").query,m={grammar:a.Ay,name:"promql"};return(0,t.jsxs)(r.B,{gap:.5,direction:"column",children:[(0,t.jsx)(s.r,{stepNumber:1,title:(0,t.jsx)(d.Z,{query:`${i.z.renderQuery(E)}`,lang:m}),children:u}),(0,t.jsx)(c.k,{stepNumber:2,queryModeller:i.z,query:E,lang:m})]})});g.displayName="PromQueryBuilderExplained"},38283:(q,j,e)=>{"use strict";e.d(j,{$:()=>s});var t=e(74848),n=e(22803),r=e(58779),a=e(29675),i=e(84204),x=e(41010);function s(d){const{query:u,datasource:g,range:o,onRunQuery:E,onChange:m,data:f,app:p,showExplain:h}=d,D=(0,a.of)(c);return(0,t.jsxs)("div",{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:D.wrapper,children:[(0,t.jsx)(i.L,{datasource:g,query:u,range:o,onRunQuery:E,onChange:m,history:[],data:f,app:p}),h&&(0,t.jsx)(x.i,{query:u.expr})]})}const c=d=>({wrapper:(0,n.css)({".gf-form":{marginBottom:0}})})},3132:(q,j,e)=>{"use strict";e.d(j,{Ly:()=>V,hD:()=>T,VL:()=>le});var t=e(74848),n=e(22803),r=e(65307),a=e(76459),i=e.n(a),x=e(96540),s=e(58779),c=e(29675),d=e(25356),u=e(34128),g=e(44826),o=e(20968),E=e(26676),m=e(90333),f=e(54594),p=e(79784),h=e(16110),D=e(29010),C=e(6736),l=e(49130);function v(he){const{state:oe,onChangeFullMetaSearch:de,onChangeIncludeNullMetadata:me,onChangeDisableTextWrap:Pe,onChangeUseBackend:Ee}=he,be=(0,c.$j)(),Se=y(be);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Se.selectItem,children:[(0,t.jsx)(D.d,{"data-testid":T.searchWithMetadata,value:oe.fullMetaSearch,disabled:oe.useBackend||!oe.hasMetadata,onChange:()=>de()}),(0,t.jsx)("div",{className:Se.selectItemLabel,children:l.Ft.metadataSearchSwitch})]}),(0,t.jsxs)("div",{className:Se.selectItem,children:[(0,t.jsx)(D.d,{value:oe.includeNullMetadata,disabled:!oe.hasMetadata,onChange:()=>me()}),(0,t.jsx)("div",{className:Se.selectItemLabel,children:l.Ft.includeNullMetadata})]}),(0,t.jsxs)("div",{className:Se.selectItem,children:[(0,t.jsx)(D.d,{value:oe.disableTextWrap,onChange:()=>Pe()}),(0,t.jsx)("div",{className:Se.selectItemLabel,children:"Disable text wrap"})]}),(0,t.jsxs)("div",{className:Se.selectItem,children:[(0,t.jsx)(D.d,{"data-testid":T.setUseBackend,value:oe.useBackend,onChange:()=>Ee()}),(0,t.jsxs)("div",{className:Se.selectItemLabel,children:[l.Ft.setUseBackend,"\xA0"]}),(0,t.jsx)(C.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end",children:(0,t.jsx)(p.I,{name:"info-circle",size:"xs",className:Se.settingsIcon})})]})]})}function y(he){return{settingsIcon:(0,n.css)({color:he.colors.text.secondary}),selectItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,n.css)({margin:`0 0 0 ${he.spacing(1)}`,alignSelf:"center",color:he.colors.text.secondary,fontSize:"12px"})}}var P=e(48583);function b({feedbackUrl:he}){const oe=(0,c.of)(S);return(0,t.jsx)(P.B,{children:(0,t.jsxs)("a",{href:he,className:oe.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)(p.I,{name:"comment-alt-message"})," Give feedback"]})})}function S(he){return{link:(0,n.css)({color:he.colors.text.secondary,fontSize:he.typography.bodySmall.fontSize,":hover":{color:he.colors.text.link},margin:"-25px 0 30px 0"})}}var M=e(23257),O=e.n(M),R=e(22338);function L(he){const{metrics:oe,onChange:de,onClose:me,query:Pe,state:Ee,disableTextWrap:be}=he,Se=(0,c.$j)(),Xe=B(Se,be);function Qe(Ge){Ge.value&&(de({...Pe,metric:Ge.value}),(0,l.E5)("grafana_prom_metric_encycopedia_tracking",Ee,Ge.value),me())}function we(Ge){return Ee.fullMetaSearch&&Ge?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:Fe(Ge.type??"")}),(0,t.jsx)("td",{children:(0,t.jsx)(O(),{textToHighlight:Ge.description??"",searchWords:Ee.metaHaystackMatches,autoEscape:!0,highlightClassName:Xe.matchHighLight})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:Fe(Ge.type??"")}),(0,t.jsx)("td",{children:Ge.description??""})]})}function $e(Ge,Me,De){return(0,t.jsxs)(t.Fragment,{children:[Ge,(0,t.jsx)("span",{className:Xe.tooltipSpace,children:(0,t.jsx)(C.m,{content:(0,t.jsxs)(t.Fragment,{children:["When creating a ",Me,", Prometheus exposes multiple series with the type counter."," ",(0,R.jW)(De)]}),placement:"bottom-start",interactive:!0,children:(0,t.jsx)(p.I,{name:"info-circle",size:"xs"})})})]})}function Fe(Ge){return Ge?Ge.includes("(summary)")?$e(Ge,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):Ge.includes("(histogram)")?$e(Ge,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):Ge:""}function Te(){let Ge;return Ee.fuzzySearchQuery||(Ge="There are no metrics found in the data source."),Pe.labels.length>0&&(Ge="There are no metrics found. Try to expand your label filters."),(Ee.fuzzySearchQuery||Ee.selectedTypes.length>0)&&(Ge="There are no metrics found. Try to expand your search and filters."),(0,t.jsx)("tr",{className:Xe.noResults,children:(0,t.jsx)("td",{colSpan:3,children:Ge})})}function Le(Ge){return Ge.useBackend?[Ge.fuzzySearchQuery]:Ge.fullMetaSearch?Ge.metaHaystackMatches:Ge.nameHaystackMatches}return(0,t.jsxs)("table",{className:Xe.table,children:[(0,t.jsx)("thead",{className:Xe.stickyHeader,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:`${Xe.nameWidth} ${Xe.tableHeaderPadding}`,children:"Name"}),Ee.hasMetadata&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("th",{className:`${Xe.typeWidth} ${Xe.tableHeaderPadding}`,children:"Type"}),(0,t.jsx)("th",{className:`${Xe.descriptionWidth} ${Xe.tableHeaderPadding}`,children:"Description"})]}),(0,t.jsx)("th",{className:Xe.selectButtonWidth,children:" "})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)(t.Fragment,{children:[oe.length>0&&oe.map((Ge,Me)=>(0,t.jsxs)("tr",{className:Xe.row,children:[(0,t.jsx)("td",{className:Xe.nameOverflow,children:(0,t.jsx)(O(),{textToHighlight:Ge?.value??"",searchWords:Le(Ee),autoEscape:!0,highlightClassName:Xe.matchHighLight})}),Ee.hasMetadata&&we(Ge),(0,t.jsx)("td",{children:(0,t.jsx)(f.$n,{size:"md",variant:"secondary",onClick:()=>Qe(Ge),className:Xe.centerButton,children:"Select"})})]},Ge?.value??Me)),oe.length===0&&!Ee.isLoading&&Te()]})})]})}const B=(he,oe)=>({table:(0,n.css)({tableLayout:oe?void 0:"fixed",borderRadius:he.shape.radius.default,width:"100%",whiteSpace:oe?"nowrap":"normal",td:{padding:he.spacing(1)},"td,th":{minWidth:he.spacing(3),borderBottom:`1px solid ${he.colors.border.weak}`}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${he.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,n.css)({padding:"8px"}),matchHighLight:(0,n.css)({background:"inherit",color:he.components.textHighlight.text,backgroundColor:he.components.textHighlight.background}),nameWidth:(0,n.css)({width:oe?void 0:"37.5%"}),nameOverflow:(0,n.css)({overflowWrap:oe?void 0:"anywhere"}),typeWidth:(0,n.css)({width:oe?void 0:"15%"}),descriptionWidth:(0,n.css)({width:oe?void 0:"35%"}),selectButtonWidth:(0,n.css)({width:oe?void 0:"12.5%"}),stickyHeader:(0,n.css)({position:"sticky",top:0,backgroundColor:he.colors.background.primary}),noResults:(0,n.css)({textAlign:"center",color:he.colors.text.secondary}),tooltipSpace:(0,n.css)({marginLeft:"4px"}),centerButton:(0,n.css)({display:"block",margin:"auto",border:"none"})});var F=e(10002);const I=(he,oe)=>({modal:(0,n.css)({width:"85vw",[he.breakpoints.down("md")]:{width:"100%"},[he.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,n.css)({flexBasis:"40%",paddingRight:"16px",[he.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,n.css)({flexGrow:1,flexBasis:"20%",[he.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,n.css)({marginBottom:he.spacing(1)}),resultsAmount:(0,n.css)({color:he.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,n.css)({margin:`4px 0 ${he.spacing(2)} 0`}),resultsDataCount:(0,n.css)({margin:0}),resultsDataFiltered:(0,n.css)({color:he.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,n.css)({display:"inline",verticalAlign:"text-top"}),results:(0,n.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,n.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,n.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,n.css)({visibility:"hidden"}),visible:(0,n.css)({visibility:"visible"}),settingsBtn:(0,n.css)({float:"right"}),noBorder:(0,n.css)({border:"none"}),resultsPerPageLabel:(0,n.css)({color:he.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,n.css)({display:"flex"})});var U=e(84139),W=e(2543);const A=new U.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function N(he,oe,de){const[me,Pe,Ee]=A.search(he,oe,0,1e5);let be=[],Se=new Set;if(me&&Ee){const Xe=(Qe,we)=>{we&&Se.add(Qe)};for(let Qe=0;Qe<Ee.length;Qe++){let we=Ee[Qe];U.A.highlight(he[Pe.idx[we]],Pe.ranges[we],Xe),be.push(he[Pe.idx[we]])}de([be,[...Se]])}else oe||de([[],[]])}const K=(0,W.debounce)(N,300),V=he=>{const{datasource:oe,isOpen:de,onClose:me,onChange:Pe,query:Ee,initialMetrics:be}=he,[Se,Xe]=(0,x.useReducer)(z.reducer,(0,F.ue)(Ee)),Qe=(0,c.$j)(),we=I(Qe,Se.disableTextWrap),$e=(0,x.useCallback)(async()=>{Xe(w(!0));const Ke=typeof be=="function"?await be():be,Ie=await(0,l.E1)(oe,Ee,Ke);Xe(H({isLoading:!1,hasMetadata:Ie.hasMetadata,metrics:Ie.metrics,metaHaystackDictionary:Ie.metaHaystackDictionary,nameHaystackDictionary:Ie.nameHaystackDictionary,totalMetricCount:Ie.metrics.length,filteredMetricCount:Ie.metrics.length}))},[Ee,oe,be]);(0,x.useEffect)(()=>{$e()},[$e]);const Fe=l.uq.map(Ke=>({value:Ke.value,label:Ke.value,description:Ke.description})),Te=(0,x.useMemo)(()=>i()(async Ke=>{Xe(w(!0));const Ie=await(0,l.qn)(Ke,Ee.labels,oe);Xe(G({metrics:Ie,filteredMetricCount:Ie.length,isLoading:!1}))},oe.getDebounceTimeInMilliseconds()),[oe,Ee]);function Le(Ke){Xe(ee(Ke))}function Ge(Ke){Xe(J(Ke))}function Me(Ke,Ie){Se.useBackend&&Ke===""?$e():Se.useBackend?Te(Ke):Ie?K(Object.keys(Se.metaHaystackDictionary),Ke,Ge):K(Object.keys(Se.nameHaystackDictionary),Ke,Le)}const De=(0,t.jsx)(v,{state:Se,onChangeFullMetaSearch:()=>{const Ke=!Se.fullMetaSearch;Xe(Z(Ke)),Pe({...Ee,fullMetaSearch:Ke}),Me(Se.fuzzySearchQuery,Ke)},onChangeIncludeNullMetadata:()=>{Xe(te(!Se.includeNullMetadata)),Pe({...Ee,includeNullMetadata:!Se.includeNullMetadata})},onChangeDisableTextWrap:()=>{Xe(ne()),Pe({...Ee,disableTextWrap:!Se.disableTextWrap}),(0,l.E5)("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",Se,"")},onChangeUseBackend:()=>{const Ke=!Se.useBackend;Xe(re(Ke)),Pe({...Ee,useBackend:Ke}),Ke===!1?$e():Se.fuzzySearchQuery!==""&&Te(Se.fuzzySearchQuery)}});return(0,t.jsxs)(d.a,{"data-testid":T.metricModal,isOpen:de,title:"Metrics explorer",onDismiss:me,"aria-label":"Browse metrics",className:we.modal,children:[(0,t.jsx)(b,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),(0,t.jsxs)("div",{className:we.inputWrapper,"data-testid":s.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer,children:[(0,t.jsx)("div",{className:(0,n.cx)(we.inputItem,we.inputItemFirst),children:(0,t.jsx)(u.p,{autoFocus:!0,"data-testid":T.searchMetric,placeholder:l.Ft.browse,value:Se.fuzzySearchQuery,onInput:Ke=>{const Ie=Ke.currentTarget.value??"";Xe(_(Ie)),Me(Ie,Se.fullMetaSearch)}})}),Se.hasMetadata&&(0,t.jsx)("div",{className:we.inputItem,children:(0,t.jsx)(g.KF,{"data-testid":T.selectType,inputId:"my-select",options:Fe,value:Se.selectedTypes,placeholder:l.Ft.type,onChange:Ke=>Xe(ae(Ke))})}),(0,t.jsx)("div",{children:(0,t.jsx)(o.y,{className:`${we.loadingSpinner} ${Se.isLoading?we.visible:""}`})}),(0,t.jsx)("div",{className:we.inputItem,children:(0,t.jsx)(E.G,{"aria-label":"Additional settings",content:De,placement:"bottom-end",closeButton:!1,children:(0,t.jsxs)(m.e,{className:we.settingsBtn,children:[(0,t.jsx)(f.$n,{variant:"secondary",size:"md",onClick:()=>Xe(ce()),"data-testid":T.showAdditionalSettings,className:we.noBorder,children:"Additional Settings"}),(0,t.jsx)(f.$n,{className:we.noBorder,variant:"secondary",icon:Se.showAdditionalSettings?"angle-up":"angle-down"})]})})})]}),(0,t.jsxs)("div",{className:we.resultsData,children:[Ee.metric&&(0,t.jsxs)("i",{className:we.currentlySelected,children:["Currently selected: ",Ee.metric]}),Ee.labels.length>0&&(0,t.jsxs)("div",{className:we.resultsDataFiltered,children:[(0,t.jsx)(p.I,{name:"info-circle",size:"sm"}),(0,t.jsx)("div",{className:we.resultsDataFilteredText,children:"\xA0These metrics have been pre-filtered by labels chosen in the label filters."})]})]}),(0,t.jsx)("div",{className:we.results,children:Se.metrics&&(0,t.jsx)(L,{metrics:(0,l.PV)(Se,Xe),onChange:Pe,onClose:me,query:Ee,state:Se,disableTextWrap:Se.disableTextWrap})}),(0,t.jsxs)("div",{className:we.resultsFooter,children:[(0,t.jsxs)("div",{className:we.resultsAmount,children:["Showing ",Se.filteredMetricCount," of ",Se.totalMetricCount," results"]}),(0,t.jsx)(h.d,{currentPage:Se.pageNum??1,numberOfPages:(0,l.EP)(Se).length,onNavigate:Ke=>{Xe(k(Ke??1))}}),(0,t.jsxs)("div",{className:we.resultsPerPageWrapper,children:[(0,t.jsx)("p",{className:we.resultsPerPageLabel,children:"# Results per page\xA0"}),(0,t.jsx)(u.p,{"data-testid":T.resultsPerPage,value:(0,l.fh)(Se.resultsPerPage,F.J3,F.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+F.yH,type:"number",onInput:Ke=>{const Ie=+Ke.currentTarget.value;isNaN(Ie)||Ie>=F.yH||Xe(X(Ie))}})]})]})]})},T={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},z=(0,r.Z0)({name:"metrics-modal-state",initialState:(0,F.ue)(),reducers:{filterMetricsBackend:(he,oe)=>{he.metrics=oe.payload.metrics,he.filteredMetricCount=oe.payload.filteredMetricCount,he.isLoading=oe.payload.isLoading},buildMetrics:(he,oe)=>{he.isLoading=oe.payload.isLoading,he.metrics=oe.payload.metrics,he.hasMetadata=oe.payload.hasMetadata,he.metaHaystackDictionary=oe.payload.metaHaystackDictionary,he.nameHaystackDictionary=oe.payload.nameHaystackDictionary,he.totalMetricCount=oe.payload.totalMetricCount,he.filteredMetricCount=oe.payload.filteredMetricCount},setIsLoading:(he,oe)=>{he.isLoading=oe.payload},setFilteredMetricCount:(he,oe)=>{he.filteredMetricCount=oe.payload},setResultsPerPage:(he,oe)=>{he.resultsPerPage=oe.payload},setPageNum:(he,oe)=>{he.pageNum=oe.payload},setFuzzySearchQuery:(he,oe)=>{he.fuzzySearchQuery=oe.payload,he.pageNum=1},setNameHaystack:(he,oe)=>{he.nameHaystackOrder=oe.payload[0],he.nameHaystackMatches=oe.payload[1]},setMetaHaystack:(he,oe)=>{he.metaHaystackOrder=oe.payload[0],he.metaHaystackMatches=oe.payload[1]},setFullMetaSearch:(he,oe)=>{he.fullMetaSearch=oe.payload,he.pageNum=1},setIncludeNullMetadata:(he,oe)=>{he.includeNullMetadata=oe.payload,he.pageNum=1},setSelectedTypes:(he,oe)=>{he.selectedTypes=oe.payload,he.pageNum=1},setUseBackend:(he,oe)=>{he.useBackend=oe.payload,he.fullMetaSearch=!1,he.pageNum=1},setDisableTextWrap:he=>{he.disableTextWrap=!he.disableTextWrap},showAdditionalSettings:he=>{he.showAdditionalSettings=!he.showAdditionalSettings}}}),{setIsLoading:w,buildMetrics:H,filterMetricsBackend:G,setResultsPerPage:X,setPageNum:k,setFuzzySearchQuery:_,setNameHaystack:ee,setMetaHaystack:J,setFullMetaSearch:Z,setIncludeNullMetadata:te,setSelectedTypes:ae,setUseBackend:re,setDisableTextWrap:ne,showAdditionalSettings:ce,setFilteredMetricCount:le}=z.actions},49130:(q,j,e)=>{"use strict";e.d(j,{E1:()=>i,E5:()=>E,EP:()=>d,Ft:()=>f,PV:()=>s,fh:()=>g,qn:()=>o,uq:()=>m});var t=e(56276),n=e(75257),r=e(25734),a=e(3132);async function i(p,h,D){let C=!0;const l=p.languageProvider.metricsMetadata;l&&Object.keys(l).length===0&&(C=!1);let v={},y={},P;return P=D?.map(b=>{const S=x(b,p),M=`${b}\xA6${S.description}`;return v[b]=S,y[M]=S,S}),{isLoading:!1,hasMetadata:C,metrics:P??[],metaHaystackDictionary:y,nameHaystackDictionary:v,totalMetricCount:P?.length??0,filteredMetricCount:P?.length??0}}function x(p,h){let D=(0,n.AU)(p,h.languageProvider.metricsMetadata);const C=(0,n.pK)(p,h.languageProvider.metricsMetadata);["histogram","summary"].forEach(y=>{C?.toLowerCase().includes(y)&&D!==y&&(D+=` (${y})`)});const l=p.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return D==="histogram"&&!l&&(D="native histogram"),{value:p,type:D,description:C}}function s(p,h){const D=c(p);return!p.isLoading&&p.filteredMetricCount!==D.length&&h((0,a.VL)(D.length)),u(D,p.pageNum,p.resultsPerPage)}function c(p){let h=p.metrics;return p.fuzzySearchQuery&&!p.useBackend&&(p.fullMetaSearch?h=p.metaHaystackOrder.map(D=>p.metaHaystackDictionary[D]):h=p.nameHaystackOrder.map(D=>p.nameHaystackDictionary[D])),p.selectedTypes.length>0&&(h=h.filter((D,C)=>p.selectedTypes.some(v=>D.type&&v.value?D.type.includes(v.value):!D.type&&v.value==="no type"))),p.includeNullMetadata||(h=h.filter(D=>D.type!==void 0&&D.description!==void 0)),h}function d(p){if(!p.metrics.length)return[];const h=p.resultsPerPage===0?1:p.resultsPerPage,D=Math.floor(c(p).length/h)+1;return[...Array(D).keys()].map(C=>C+1)}function u(p,h,D){const C=D===0?1:D,l=h===1?0:(h-1)*C,v=l+C;return p.slice(l,v)}const g=(p,h,D)=>p<1?1:p>D?D:p??h;async function o(p,h,D){const C=(0,r.b4)(p),l=h.map(P=>`,${P.label}="${P.value}"`),v=`label_values({__name__=~".*${C}"${h?l.join():""}},__name__)`;return await D.metricFindQuery(v).then(P=>P.map(b=>x(b.text,D)))}function E(p,h,D,C){switch(p){case"grafana_prom_metric_encycopedia_tracking":(0,t.rR)(p,{metric:D,hasMetadata:h?.hasMetadata,totalMetricCount:h?.totalMetricCount,fuzzySearchQuery:h?.fuzzySearchQuery,fullMetaSearch:h?.fullMetaSearch,selectedTypes:h?.selectedTypes,useRegexSearch:h?.useBackend,includeResultsWithoutMetadata:h?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,t.rR)(p,{disableTextWrap:h?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,t.rR)(p,{query:C})}}const m=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],f={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"}},10002:(q,j,e)=>{"use strict";e.d(j,{J3:()=>t,mt:()=>a,ue:()=>r,yH:()=>n});const t=100,n=1e3;function r(i){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:t,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:i?.fullMetaSearch??!1,includeNullMetadata:i?.includeNullMetadata??!0,selectedTypes:[],useBackend:i?.useBackend??!1,disableTextWrap:i?.disableTextWrap??!1,showAdditionalSettings:!1}}function a(i){return{useBackend:i?.useBackend??!1,disableTextWrap:i?.disableTextWrap??!1,fullMetaSearch:i?.fullMetaSearch??!1,includeNullMetadata:i.includeNullMetadata??!1}}},88093:(q,j,e)=>{"use strict";e.d(j,{DQ:()=>m,G3:()=>h,Kl:()=>g,OS:()=>f,iZ:()=>E,jC:()=>D,jY:()=>s,kf:()=>c,nU:()=>u,z2:()=>p});var t=e(2543),n=e.n(t),r=e(55127),a=e.n(r),i=e(76799),x=e(5091);function s(M,O,R){const L=o(M,O,R),B=M.id+"(";return R&&L.push(R),B+L.join(", ")+")"}function c(M,O,R){const L=o(M,O,R),B=M.id+"(";return R&&L.unshift(R),B+L.join(", ")+")"}function d(M,O,R,L){if(O.params.length<2)throw`Cannot render a function with params of length [${O.params.length}]`;let B=(M.params??[])[0]??"5m";const F=o({...M,params:M.params.slice(1)},{...O,params:O.params.slice(1),defaultParams:O.defaultParams.slice(1)},R),I=M.id+"(";return R&&(L?F.push(`${R}[${B}]`):F.unshift(`${R}[${B}]`)),I+F.join(", ")+")"}function u(M,O,R){return d(M,O,R,!1)}function g(M,O,R){return d(M,O,R,!0)}function o(M,O,R){return(M.params??[]).map((L,B)=>O.params[B]?.type==="string"?`"${L}"`:L)}function E(M,O){const R={id:M.id,params:M.defaultParams};return{...O,operations:[...O.operations,R]}}function m(M){return(0,t.capitalize)(M.replace(/_/g," "))}function f(M,O){return`operations.${M}.param.${O}`}function p(M=!1){const O=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return M&&O.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:O}}function h(M,O={}){return[{id:M,name:m(M),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:x.Ag.Aggregations,renderer:s,paramChangedHandler:b(`__${M}_by`),explainHandler:v(M,""),addOperationHandler:E,...O},{id:`__${M}_by`,name:`${m(M)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.r}],defaultParams:[""],alternativesKey:"aggregations by",category:x.Ag.Aggregations,renderer:C(M),paramChangedHandler:P(M),explainHandler:v(M,"by"),addOperationHandler:E,hideFromList:!0,...O},{id:`__${M}_without`,name:`${m(M)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.r}],defaultParams:[""],alternativesKey:"aggregations by",category:x.Ag.Aggregations,renderer:l(M),paramChangedHandler:P(M),explainHandler:v(M,"without"),addOperationHandler:E,hideFromList:!0,...O}]}function D(M,O,R={}){const L=h(M,R);return L[0].params.unshift(...O.params),L[1].params.unshift(...O.params),L[2].params.unshift(...O.params),L[0].defaultParams=O.defaultParams,L[1].defaultParams=[...O.defaultParams,""],L[2].defaultParams=[...O.defaultParams,""],L[1].renderer=y(M),L[2].renderer=y(M),L}function C(M){return function(R,L,B){return`${M} by(${R.params.join(", ")}) (${B})`}}function l(M){return function(R,L,B){return`${M} without(${R.params.join(", ")}) (${B})`}}function v(M,O){return function(L){const B=L.params.map(I=>`\`${I}\``).join(" and "),F=a()("label",L.params.length);switch(O){case"by":return`Calculates ${M} over dimensions while preserving ${F} ${B}.`;case"without":return`Calculates ${M} over the dimensions ${B}. All other labels are preserved.`;default:return`Calculates ${M} over the dimensions.`}}}function y(M){return function(R,L,B){const F=L.params.findIndex(W=>W.restParam),I=R.params.slice(0,F),U=R.params.slice(F);return`${M} by(${U.join(", ")}) (${I.map((W,A)=>L.params[A].type==="string"?`"${W}"`:W).join(", ")}, ${B})`}}function P(M){return function(R,L,B){return L.params.length<B.params.length?{...L,id:M}:L}}function b(M){return function(R,L,B){return L.params.length===B.params.length?{...L,id:M}:L}}function S(M,O){if(!M.label||!M.op||!M.value||O.length<2)return!1;const R=M.op.toString().startsWith("!");return O.filter(F=>F.label===M.label&&F.value===M.value&&F.op!==M.op).some(F=>!!(R&&F?.op?.toString().startsWith("!")===!1||R===!1&&F?.op?.toString().startsWith("!")))}},11222:(q,j,e)=>{"use strict";e.d(j,{u:()=>a});var t=e(21489),n=e(31879),r=e(25734);function a(p){const h=(0,r.qk)(p),C=t.K3.parse(h).topNode,v={query:{metric:"",labels:[],operations:[]},errors:[]};try{x(h,C,v)}catch(y){console.error(y),y instanceof Error&&v.errors.push({text:y.message})}return f(v.query)&&(v.errors=[]),i(p)&&(v.errors=[]),v}function i(p){const h={query:{metric:"",labels:[],operations:[]},errors:[]};p=p.replace(/\$__interval/g,"1s"),p=p.replace(/\$__interval_ms/g,"1000"),p=p.replace(/\$__rate_interval/g,"1s"),p=p.replace(/\$__range_ms/g,"1000"),p=p.replace(/\$__range_s/g,"1"),p=p.replace(/\$__range/g,"1s");const C=t.K3.parse(p).topNode;try{x(p,C,h)}catch{return!1}return h.errors.length===0}function x(p,h,D){const C=D.query;switch(h.type.id){case t.gw:{C.metric=(0,r.AA)(p,h);break}case t.c6:{if(C.metric===""){const l=h.getChild(t.LW),v=(0,r.AA)(p,l);C.metric=v.slice(1,-1)}break}case t.d2:{const l=c(p,h,t.c6);l.label=l.label.slice(1,-1),C.labels.push(l);const v=h.getChild(r.Ql);v&&D.errors.push((0,r.xz)(p,v));break}case t.Yq:{C.labels.push(c(p,h,t.IC));const l=h.getChild(r.Ql);l&&D.errors.push((0,r.xz)(p,l));break}case t.R6:{u(p,h,D);break}case t.Fn:{g(p,h,D);break}case t.df:{E(p,h,D);break}case r.Ql:{if(s(h))break;D.errors.push((0,r.xz)(p,h));break}default:{h.type.id===t.ek&&D.errors.push((0,r.xz)(p,h));let l=h.firstChild;for(;l;)x(p,l,D),l=l.nextSibling}}}function s(p){return p.prevSibling?.firstChild?.type.id===t.Fb}function c(p,h,D){const C=(0,r.AA)(p,h.getChild(D)),l=(0,r.AA)(p,h.getChild(t.Lf)),v=(0,r.AA)(p,h.getChild(t.LW)).replace(/^["'`]|["'`]$/g,"");return{label:C,op:l,value:v}}const d=["changes","rate","irate","increase","delta"];function u(p,h,D){const C=D.query,l=h.getChild(t.m3),v=(0,r.AA)(p,l),y=h.getChild(t.Dh),P=[];let b="";if(d.includes(v)||v.endsWith("_over_time")){let M=(0,r.AA)(p,h).match(/\[(.+)\]/);M?.[1]&&(b=M[1],P.push(M[1]))}const S={id:v,params:P};if(C.operations.unshift(S),y){if((0,r.AA)(p,y)==="(["+b+"])")return;o(p,y,D,S)}}function g(p,h,D){const C=D.query,l=h.getChild(t.xb);let v=(0,r.AA)(p,l);const y=h.getChild(t.hI),P=[];y&&(y.getChild("By")&&v&&(v=`__${v}_by`),y.getChild(t.xB)&&(v=`__${v}_without`),P.push(...(0,r.R1)(p,y,t.IC),...(0,r.R1)(p,y,t.c6)));const b=h.getChild(t.Dh),S={id:v,params:[]};C.operations.unshift(S),o(p,b,D,S),S.params.push(...P)}function o(p,h,D,C){if(h)switch(h.type.id){case t.Dh:{let l=h.firstChild;for(;l;){let v;l.type.id===t.df?v=l:v=l.getChild(t.df),v&&D.errors.push({text:"Query parsing is ambiguous.",from:v.from,to:v.to}),o(p,l,D,C),l=l.nextSibling}break}case t.j_:{C.params.push(parseFloat((0,r.AA)(p,h)));break}case t.LW:{C.params.push((0,r.AA)(p,h).replace(/"/g,""));break}default:x(p,h,D)}}function E(p,h,D){const C=D.query,l=h.firstChild,v=(0,r.AA)(p,l.nextSibling),y=m(p,h.getChild(t.eM)??h.getChild(t.Ue)),P=h.lastChild,b=n.AE[v],S=l.type.id===t.j_,M=P.type.id===t.j_,O=P.type.id===t.df;if(S||x(p,l,D),M)C.operations.push((0,r.rq)(b,p,P,!!y?.isBool));else if(O){const R=(0,r.z9)(P);R?.type.id===t.j_&&C.operations.push((0,r.rq)(b,p,R,!!y?.isBool)),x(p,P,D)}else{C.binaryQueries=C.binaryQueries||[];const R={operator:v,query:{metric:"",labels:[],operations:[]}};y?.isMatcher&&(R.vectorMatchesType=y.matchType,R.vectorMatches=y.matches),C.binaryQueries.push(R),x(p,P,{query:R.query,errors:D.errors})}}function m(p,h){if(h){if(h.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let D="";const C=h.getChild(t.x$);return C&&(D=(0,r.R1)(p,C,t.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:D,matchType:h.getChild(t.On)?"on":"ignoring"}}}}function f(p){return p.labels.length===0&&p.operations.length===0&&!p.metric}},25734:(q,j,e)=>{"use strict";e.d(j,{AA:()=>c,Ql:()=>t,R1:()=>u,b4:()=>g,qk:()=>i,rq:()=>d,xz:()=>r,z9:()=>n});const t=0;function n(o){return o.firstChild?n(o.firstChild):o}function r(o,E){return{text:c(o,E),from:E.from,to:E.to,parentType:E.parent?.name}}const a=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function i(o){return o.replace(a,(E,m,f,p,h,D,C)=>{const l=p||C;let v=m,y="0";return f&&(v=f,y="1"),h&&(v=h,y="2"),`__V_${y}__`+v+"__V__"+(l?"__F__"+l+"__F__":"")})}const x=[(o,E)=>`$${o}`,(o,E)=>`[[${o}${E?`:${E}`:""}]]`,(o,E)=>`\${${o}${E?`:${E}`:""}}`];function s(o){return o.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(E,m,f,p)=>x[parseInt(m,10)](f,p))}function c(o,E){return E?s(o.substring(E.from,E.to)):""}function d(o,E,m,f){const p=[parseFloat(c(E,m))];return o.comparison&&p.push(f),{id:o.id,params:p}}function u(o,E,m){if(E.type.id===m)return[c(o,E)];const f=[];let p=0,h=E.childAfter(p);for(;h;)f.push(...u(o,h,m)),p=h.to,h=E.childAfter(p);return f}const g=o=>o.split(" ").map(m=>`${m}.*`).join("")},48432:(q,j,e)=>{"use strict";e.d(j,{r:()=>i});var t=e(74848),n=e(22803),r=e(60997),a=e(29675);function i({title:s,stepNumber:c,markdown:d,children:u}){const g=(0,a.of)(x);return(0,t.jsxs)("div",{className:g.box,children:[c!==void 0&&(0,t.jsx)("div",{className:g.stepNumber,children:c}),(0,t.jsxs)("div",{className:g.boxInner,children:[s&&(0,t.jsx)("div",{className:g.header,children:(0,t.jsx)("span",{children:s})}),(0,t.jsxs)("div",{className:g.body,children:[d&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,r.G)(d)}}),u]})]})]})}const x=s=>({box:(0,n.css)({background:s.colors.background.secondary,padding:s.spacing(1),borderRadius:s.shape.radius.default,position:"relative"}),boxInner:(0,n.css)({marginLeft:s.spacing(4)}),stepNumber:(0,n.css)({fontWeight:s.typography.fontWeightMedium,background:s.colors.secondary.main,width:"20px",height:"20px",borderRadius:s.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:s.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:s.spacing(.5),display:"flex",alignItems:"center",fontFamily:s.typography.fontFamilyMonospace}),body:(0,n.css)({color:s.colors.text.secondary,"p:last-child":{margin:0},a:{color:s.colors.text.link,textDecoration:"underline"}})})},90375:(q,j,e)=>{"use strict";e.d(j,{k:()=>a});var t=e(74848),n=e(48432),r=e(37886);function a({query:i,queryModeller:x,stepNumber:s,lang:c,onMouseEnter:d,onMouseLeave:u}){return(0,t.jsx)(t.Fragment,{children:i.operations.map((g,o)=>{const E=x.getOperationDef(g.id);if(!E)return`Operation ${g.id} not found`;const m=E.renderer(g,E,"<expr>"),f=E.explainHandler?E.explainHandler(g,E):E.documentation??"no docs";return(0,t.jsx)("div",{onMouseEnter:()=>d?.(g,o),onMouseLeave:()=>u?.(g,o),children:(0,t.jsx)(n.r,{stepNumber:o+s,title:(0,t.jsx)(r.Z,{query:m,lang:c}),markdown:f})},o)})})}},37886:(q,j,e)=>{"use strict";e.d(j,{Z:()=>x});var t=e(74848),n=e(22803),r=e(28848),a=e.n(r),i=e(29675);function x({query:c,lang:d,className:u}){const g=(0,i.$j)(),o=s(g),E=a().highlight(c,d.grammar,d.name);return(0,t.jsx)("div",{className:(0,n.cx)(o.editorField,"prism-syntax-highlight",u),"aria-label":"selector",dangerouslySetInnerHTML:{__html:E}})}const s=c=>({editorField:(0,n.css)({fontFamily:c.typography.fontFamilyMonospace,fontSize:c.typography.bodySmall.fontSize})})},5091:(q,j,e)=>{"use strict";e.d(j,{Ag:()=>t,jN:()=>n,n5:()=>r});var t=(a=>(a.Aggregations="Aggregations",a.RangeFunctions="Range functions",a.Functions="Functions",a.BinaryOps="Binary operations",a.Trigonometric="Trigonometric",a.Time="Time Functions",a))(t||{}),n=(a=>(a.Abs="abs",a.Absent="absent",a.AbsentOverTime="absent_over_time",a.Acos="acos",a.Acosh="acosh",a.Asin="asin",a.Asinh="asinh",a.Atan="atan",a.Atanh="atanh",a.Avg="avg",a.AvgOverTime="avg_over_time",a.BottomK="bottomk",a.Ceil="ceil",a.Changes="changes",a.Clamp="clamp",a.ClampMax="clamp_max",a.ClampMin="clamp_min",a.Cos="cos",a.Cosh="cosh",a.Count="count",a.CountOverTime="count_over_time",a.CountScalar="count_scalar",a.CountValues="count_values",a.DayOfMonth="day_of_month",a.DayOfWeek="day_of_week",a.DayOfYear="day_of_year",a.DaysInMonth="days_in_month",a.Deg="deg",a.Delta="delta",a.Deriv="deriv",a.DoubleExponentialSmoothing="double_exponential_smoothing",a.DropCommonLabels="drop_common_labels",a.Exp="exp",a.Floor="floor",a.Group="group",a.HistogramQuantile="histogram_quantile",a.HistogramAvg="histogram_avg",a.HistogramCount="histogram_count",a.HistogramSum="histogram_sum",a.HistogramFraction="histogram_fraction",a.HistogramStddev="histogram_stddev",a.HistogramStdvar="histogram_stdvar",a.HoltWinters="holt_winters",a.Hour="hour",a.Idelta="idelta",a.Increase="increase",a.Irate="irate",a.LabelJoin="label_join",a.LabelReplace="label_replace",a.Last="last",a.LastOverTime="last_over_time",a.Ln="ln",a.Log10="log10",a.Log2="log2",a.Max="max",a.MaxOverTime="max_over_time",a.Min="min",a.MinOverTime="min_over_time",a.Minute="minute",a.Month="month",a.Pi="pi",a.PredictLinear="predict_linear",a.Present="present",a.PresentOverTime="present_over_time",a.Quantile="quantile",a.QuantileOverTime="quantile_over_time",a.Rad="rad",a.Rate="rate",a.Resets="resets",a.Round="round",a.Scalar="scalar",a.Sgn="sgn",a.Sin="sin",a.Sinh="sinh",a.Sort="sort",a.SortDesc="sort_desc",a.Sqrt="sqrt",a.Stddev="stddev",a.StddevOverTime="stddev_over_time",a.Sum="sum",a.SumOverTime="sum_over_time",a.Tan="tan",a.Tanh="tanh",a.Time="time",a.Timestamp="timestamp",a.TopK="topk",a.Vector="vector",a.Year="year",a.Addition="__addition",a.Subtraction="__subtraction",a.MultiplyBy="__multiply_by",a.DivideBy="__divide_by",a.Modulo="__modulo",a.Exponent="__exponent",a.NestedQuery="__nested_query",a.EqualTo="__equal_to",a.NotEqualTo="__not_equal_to",a.GreaterThan="__greater_than",a.LessThan="__less_than",a.GreaterOrEqual="__greater_or_equal",a.LessOrEqual="__less_or_equal",a))(n||{}),r=(a=>(a.Rate="rate",a.Histogram="histogram",a.Binary="binary",a))(r||{})},23417:(q,j,e)=>{"use strict";e.d(j,{$i:()=>c,Dr:()=>x});var t=e(66102),n=e(3202),r=e(27844),a=e(63884),i=e(59577);const x="10m",s=u=>`${u.type}|${u.name}|${JSON.stringify(u.labels??"")}`;class c{constructor(g){this.applyInterpolation=(E,m)=>E,this.cache=new Map;const o=g.overlapString;if((0,t.di)(o)){const E=(0,t.E9)(o);this.overlapWindowMs=(0,t.WT)(E)}else{const E=(0,t.E9)(x);this.overlapWindowMs=(0,t.WT)(E)}this.getTargetSignature=g.getTargetSignature,g.applyInterpolation&&(this.applyInterpolation=g.applyInterpolation)}requestInfo(g){const o=g.range.from.valueOf(),E=g.range.to.valueOf(),m=g.rangeRaw?.to?.toString()==="now";let f=m,p;const h=new Map;g.targets.forEach(D=>{let C=`${g.dashboardUID}|${g.panelId}|${D.refId}`,l=this.getTargetSignature(g,D);h.set(C,l)});for(const[D,C]of h){let l=this.cache.get(D);if(l?.signature!==C?f=!1:(p=l?.prevTo??1/0,f=E>p&&o<=p),!f)break}if(f&&p){let D=Math.max(p-this.overlapWindowMs,o);const C=(0,n.KQ)(E),l=(0,n.KQ)((0,r.rs)(D,g.intervalMs));g={...g,range:{...g.range,from:l,to:C}}}else h.forEach((D,C)=>{this.cache.delete(C)});return{requests:[g],targetSignatures:h,shouldCache:m}}procFrames(g,o,E){if(o?.shouldCache){const m=g.range.from.valueOf(),f=g.range.to.valueOf(),p=new Map;E.forEach(D=>{let C=`${g.dashboardUID}|${g.panelId}|${D.refId}`,l=p.get(C);l||(l=[],p.set(C,l)),l.push(D)});let h=[];p.forEach((D,C)=>{let l=(C?this.cache.get(C)?.frames:null)??[];D.forEach(y=>{if(y.length===0||y.fields.length===0)return;let P=s(y.fields[1]),b=l.find(S=>s(S.fields[1])===P);if(!b)l.push(y);else{let S=b.fields.map(R=>R.values),M=y.fields.map(R=>R.values),O=(0,a.c)(S,M);if(O){for(let R=0;R<O.length;R++)b.fields[R].values=O[R],b.fields[R].config.displayNameFromDS!==y.fields[R].config.displayNameFromDS&&(b.fields[R].config.displayNameFromDS=y.fields[R].config.displayNameFromDS);b.length=b.fields[0].values.length}}});let v=[];l.forEach(y=>{let P=y.fields.map(M=>M.values);const b=d(g,D,this.applyInterpolation);let S=(0,a.F)(P,m-b,f);if(S[0].length>0){for(let M=0;M<S.length;M++)y.fields[M].values=S[M];v.push(y)}}),this.cache.set(C,{signature:o.targetSignatures.get(C),frames:v,prevTo:f}),h.push(...v)}),E=h.map(D=>({...D,fields:D.fields.map(C=>({...C,config:{...C.config},values:C.values.slice()}))}))}return E}}function d(u,g,o){if(u.targets[0].datasource?.type!=="prometheus")return 0;const E=u.targets.find(f=>f.refId===g[0].refId);let m=u.intervalMs;if(E?.interval){const f=i.intervalToMs(o(E.interval));f>u.intervalMs&&(m=f)}return m}},1391:(q,j,e)=>{"use strict";e.d(j,{Bm:()=>S,J3:()=>m,L:()=>M,hF:()=>y});var t=e(2543),n=e.n(t),r=e(16753),a=e(47370),i=e(63739),x=e(23570),s=e(7500),c=e(4038),d=e(16869),u=e(98437);const g=/^[+-]?inf(?:inity)?$/i,o=(O,R)=>R.app===r.Jk.Explore&&(O.meta?.custom?.resultType==="vector"||O.meta?.custom?.resultType==="scalar")?!0:R.targets.find(B=>B.refId===O.refId)?.format==="table",E=(O,R)=>O.meta?.type===a.m.HeatmapCells?!1:R.targets.find(B=>B.refId===O.refId)?.format==="heatmap";function m(O,R,L){O.data.forEach(G=>{const X=R.targets.find(k=>k.refId===G.refId);X&&X.legendFormat==="__auto"&&G.fields.forEach(k=>{if(k.labels?.__name__&&k.labels?.__name__===k.name){const _={...k,name:i.Bc};k.config.displayNameFromDS=(0,x.Ct)(_,G,O.data)}})});const[B,F]=(0,t.partition)(O.data,G=>o(G,R)),I=p(B),[U,W]=(0,t.partition)(F,G=>G.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:A}=L,N=U.map(G=>{if(A?.length)for(const X of A){const k=G.fields.find(_=>_.name===X.name);if(k){const _=D(X);k.config.links=k.config.links?.length?[...k.config.links,..._]:_}}return{...G,meta:{...G.meta,dataTopic:s.QR.Annotations}}}),[K,V]=(0,t.partition)(W,G=>E(G,R));K.forEach(G=>{if(G.name==null){let X=G.fields.find(k=>k.type===i.PU.number);if(X){let k=X.labels?.le;k&&(G.name=k,X.config.displayNameFromDS=k)}}});const T=(0,t.groupBy)(K,G=>G.refId);let z=[];for(const G in T){const X=T[G],k=(0,t.groupBy)(X,_=>{const ee=_.fields.find(J=>J.type===i.PU.number);if(ee?.labels&&f in ee.labels){const{le:J,...Z}=ee?.labels;return Object.values(Z).join()}return Object.values(ee?.labels??[]).join()});(0,t.forOwn)(k,(_,ee)=>{const J=_.sort(S);z.push(P(b(J)))})}const w=V.map(G=>({...G,meta:{...G.meta,preferredVisualisationType:"graph"}})),H=(0,t.flatten)(z);return{...O,data:[...w,...I,...H,...N]}}const f="le";function p(O){if(O.length===0||O.length===1&&O[0].length===0)return O;const R=(0,t.groupBy)(O,"refId"),L=Object.keys(R);return L.map(F=>{const I=h(L.length,F),U=v({data:[],valueName:I}),W=l([]),A=[];R[F].forEach(z=>{const H=z.fields[1]?.labels??{};Object.keys(H).sort().forEach(G=>{A.some(X=>X.name===G)||A.push({name:G,config:{filterable:!0},type:i.PU.string,values:[]})})});let N=-1/0,K=!1;R[F].forEach(z=>{W.config.interval??=z.fields[0]?.config.interval;const w=z.fields[0]?.values??[],H=z.fields[1]?.values??[];w.forEach(G=>{W.values.push(G),G<N&&(K=!0),N=G}),H.forEach(G=>{U.values.push(M(G));const X=z.fields[1].labels??{};A.forEach(k=>k.values.push(C(X,k.name)))})});const V=[W,...A,U],T={refId:F,fields:V,meta:{...R[F][0].meta,preferredVisualisationType:"rawPrometheus"},length:W.values.length};return K?(0,c.ES)(T,0):T})}function h(O,R=""){return O>1?`Value #${R}`:"Value"}function D(O){const R=[];if(O.datasourceUid){const B=(0,u.l)().getInstanceSettings(O.datasourceUid);B&&R.push({title:O.urlDisplayLabel||`Query with ${B?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:O.datasourceUid,datasourceName:B?.name??"Data source not found"}})}return O.url&&R.push({title:O.urlDisplayLabel||`Go to ${O.url}`,url:O.url,targetBlank:!0}),R}function C(O,R){return O.hasOwnProperty(R)?O[R]:""}function l(O,R=!1){return{name:i.LE,type:i.PU.time,config:{},values:O.map(L=>R?L[0]:L[0]*1e3)}}function v({data:O,valueName:R=i.Bc,parseValue:L=!0,labels:B,displayNameFromDS:F}){return{name:R,type:i.PU.number,display:(0,d.J)(),config:{displayNameFromDS:F},labels:B,values:O.map(I=>L?M(I[1]):I[1])}}function y(O){const R=O.__name__||"";delete O.__name__;const L=Object.entries(O).map(B=>`${B[0]}="${B[1]}"`).join(",");return`${R}{${L}}`}function P(O){if(O.length===0||O.length===1&&O[0].length===0)return[];const R=O[0].fields.find(B=>B.type===i.PU.time),L=O.map(B=>{let F=B.fields.find(I=>I.type===i.PU.number);return{...F,name:F.config.displayNameFromDS}});return[{...O[0],meta:{...O[0].meta,type:a.m.HeatmapRows},fields:[R,...L]}]}function b(O){for(let R=O.length-1;R>0;R--){const L=O[R].fields.find(F=>F.type===i.PU.number),B=O[R-1].fields.find(F=>F.type===i.PU.number);if(!L||!B)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let F=0;F<L.values.length;F++){const I=B.values[F]||[0];L.values[F]-=I,L.values[F]<1e-9&&(L.values[F]=0)}}return O}function S(O,R){let L,B;try{L=M(O.fields[1].state?.displayName??O.name??O.fields[1].name),B=M(R.fields[1].state?.displayName??R.name??R.fields[1].name)}catch(F){return console.error(F),0}return L>B?1:L<B?-1:0}function M(O){return g.test(O)?O[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(O)}},83909:(q,j,e)=>{"use strict";e.d(j,{B4:()=>a,N1:()=>n,fD:()=>t,m_:()=>r});var t=(i=>(i.Low="Low",i.Medium="Medium",i.High="High",i.None="None",i))(t||{}),n=(i=>(i.Cortex="Cortex",i.Mimir="Mimir",i.Prometheus="Prometheus",i.Thanos="Thanos",i))(n||{}),r=(i=>(i.Auto="__auto",i.Verbose="__verbose",i.Custom="__custom",i))(r||{}),a=(i=>(i[i.LabelNames=0]="LabelNames",i[i.LabelValues=1]="LabelValues",i[i.MetricNames=2]="MetricNames",i[i.VarQueryResult=3]="VarQueryResult",i[i.SeriesQuery=4]="SeriesQuery",i[i.ClassicQuery=5]="ClassicQuery",i))(a||{})},23401:(q,j,e)=>{"use strict";e.d(j,{$H:()=>n,Nc:()=>t,Rq:()=>r,p0:()=>x});const t=s=>s===""||r(s)?s:`"${s}"`,n=s=>{if(r(s))return s;let d="U__";for(let u=0;u<s.length;u++){const g=s[u],o=s.codePointAt(u);g==="_"?d+="__":o!==void 0&&a(g,u)?d+=g:o===void 0||!i(o)?d+="_FFFD_":(d+="_",d+=o.toString(16),d+="_"),o!==void 0&&o>65535&&u++}return d},r=s=>{if(s.length===0)return!1;for(let c=0;c<s.length;c++){const d=s[c];if(!a(d,c))return!1}return!0},a=(s,c)=>{const d=s.codePointAt(0);return d===void 0?!1:d>=97&&d<=122||d>=65&&d<=90||d===95||d===58||d>=48&&d<=57&&c>0},i=s=>s>=0&&s<=1114111,x=s=>{const c=[],d=/(=~|!=|!~|=)/;let u="",g="",o=!1,E="";const m=()=>{const f=E.match(d);if(f){const p=f[0];[u,g]=E.split(p),c.push(`${t(u.trim())}${p}"${g.slice(1,-1)}"`)}};for(const f of s)f==='"'&&E[E.length-1]!=="\\"?(o=!o,E+=f):f===","&&!o?(m(),E=""):E+=f;return E&&m(),c.join(",")}},63239:(q,j,e)=>{"use strict";e.d(j,{L:()=>n,y:()=>r});var t=e(32370);function n(a){return{grafana_version:t.$.buildInfo.version,plugin_type:String(a.type),plugin_version:a.info.version,plugin_id:a.id,plugin_name:a.name}}function r(a){return{...n(a.meta),datasource_uid:a.uid}}},14065:(q,j,e)=>{"use strict";e.d(j,{G:()=>s});var t=e(96540),n=e(79748),r=e(35617),a=e(56276),i=e(63239);const x="grafana_plugin_";function s(){const d=(0,n.Q)();return(0,t.useMemo)(()=>{if(!d)throw new Error("No PluginContext found. The usePluginInteractionReporter() hook can only be used from a plugin.");const u=(0,r.S)(d)?(0,i.y)(d.instanceSettings):(0,i.L)(d.meta);return(g,o)=>{if(!c(g))throw new Error(`Interactions reported in plugins should start with: "${x}".`);return(0,a.rR)(g,{...o,...u})}},[d])}function c(d){return d.startsWith(x)&&d.length>x.length}},22136:(q,j,e)=>{"use strict";e.d(j,{fX:()=>r,nB:()=>n,n_:()=>t,p6:()=>a});var t=(i=>(i.DashboardView="dashboard-view",i.DataRequest="data-request",i))(t||{});const n=i=>!!i.payload.page,r=i=>!!i.payload.interactionName,a=i=>!!i.payload.experimentId},56276:(q,j,e)=>{"use strict";e.d(j,{G$:()=>a,Jy:()=>i,Xp:()=>s,rR:()=>x});var t=e(32370),n=e(53027),r=e(3353);const a=c=>{(0,r.x$)().addEvent({type:r.on.MetaAnalytics,payload:c})},i=()=>{const c=n.Ny.getLocation(),d=`${t.$.appSubUrl??""}${c.pathname}${c.search}${c.hash}`;(0,r.x$)().addEvent({type:r.on.Pageview,payload:{page:d}})},x=(c,d)=>{t.$.reportingStaticContext&&t.$.reportingStaticContext instanceof Object&&(d={...d,...t.$.reportingStaticContext}),(0,r.x$)().addEvent({type:r.on.Interaction,payload:{interactionName:c,properties:d}})},s=(c,d,u)=>{(0,r.x$)().addEvent({type:r.on.ExperimentView,payload:{experimentId:c,experimentGroup:d,experimentVariant:u}})}},30912:(q,j,e)=>{"use strict";e.d(j,{s:()=>g});var t=e(74848),n=e(96540),r=e(61809),a=e(3021),i=e(58779),x=e(44826),s=e(48583),c=e(50278),d=e(98437),u=e(65502);class g extends n.PureComponent{constructor(E){super(E),this.dataSourceSrv=(0,d.l)(),this.state={},this.onChange=(m,f)=>{if(f.action==="clear"&&this.props.onClear){this.props.onClear();return}const p=this.dataSourceSrv.getInstanceSettings(m.value);p&&(this.props.onChange(p),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:E}=this.props;this.dataSourceSrv.getInstanceSettings(E)||this.setState({error:"Could not find data source "+E})}getCurrentValue(){const{current:E,hideTextValue:m,noDefault:f}=this.props;if(!E&&f)return;const p=this.dataSourceSrv.getInstanceSettings(E);if(p)return{label:p.name.slice(0,37),value:p.uid,imgUrl:p.meta.info.logos.small,hideText:m,meta:p.meta};const h=(0,r.Iz)(E);return h===u.dR.uid||h===u.dR.name?{label:h,value:h,hideText:m}:{label:(h??"no name")+" - not found",value:h??void 0,imgUrl:"",hideText:m}}getDataSourceOptions(){const{alerting:E,tracing:m,metrics:f,mixed:p,dashboard:h,variables:D,annotations:C,pluginId:l,type:v,filter:y,logs:P}=this.props;return this.dataSourceSrv.getList({alerting:E,tracing:m,metrics:f,logs:P,dashboard:h,mixed:p,variables:D,annotations:C,pluginId:l,filter:y,type:v}).map(S=>({value:S.name,label:`${S.name}${S.isDefault?" (default)":""}`,imgUrl:S.meta.info.logos.small,meta:S.meta}))}render(){const{autoFocus:E,onBlur:m,onClear:f,openMenuOnFocus:p,placeholder:h,width:D,inputId:C,disabled:l=!1,isLoading:v=!1}=this.props,{error:y}=this.state,P=this.getDataSourceOptions(),b=this.getCurrentValue(),S=typeof f=="function";return(0,t.jsx)("div",{"aria-label":"Data source picker select container","data-testid":i.Tp.components.DataSourcePicker.container,children:(0,t.jsx)(x.l6,{isLoading:v,disabled:l,"aria-label":"Select a data source","data-testid":i.Tp.components.DataSourcePicker.inputV2,inputId:C||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:S,backspaceRemovesValue:!1,onChange:this.onChange,options:P,autoFocus:E,onBlur:m,width:D,openMenuOnFocus:p,maxMenuHeight:500,placeholder:h,noOptionsMessage:"No datasources found",value:b??null,invalid:!!y||!!this.props.invalid,getOptionLabel:M=>M.meta&&(0,a.x)(M.meta.signature)&&M!==b?(0,t.jsxs)(s.B,{alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)("span",{children:M.label})," ",(0,t.jsx)(c.B,{status:M.meta.signature})]}):M.label||""})})}}},83835:(q,j,e)=>{"use strict";e.d(j,{f:()=>t,p:()=>n});let t=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function n(r){t=r}},350:(q,j,e)=>{"use strict";e.d(j,{a:()=>n,e:()=>r});var t=e(74848);let n=({message:a})=>(0,t.jsxs)("div",{children:["Unable to render data: ",a,"."]});function r(a){n=a}},47454:(q,j,e)=>{"use strict";e.d(j,{Y:()=>r,m:()=>n});var t=e(74848);let n=()=>(0,t.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function r(a){n=a}},12417:(q,j,e)=>{"use strict";e.d(j,{V:()=>n,l:()=>r});var t=e(74848);let n=({children:a})=>(0,t.jsx)("div",{children:a});function r(a){n=a}},2243:(q,j,e)=>{"use strict";e.r(j),e.d(j,{CopyPanelEvent:()=>u.ah,DataSourcePicker:()=>H.s,DataSourceWithBackend:()=>A.iy,EchoEventType:()=>i.on,EmbeddedDashboard:()=>ee.f,FakeEchoSrv:()=>i.c_,GrafanaBootConfig:()=>L.p,HealthCheckError:()=>A.b1,HealthStatus:()=>A.VQ,HistoryWrapper:()=>d.K9,LocationServiceProvider:()=>d._K,MetaAnalyticsEventName:()=>B.n_,PanelDataErrorView:()=>V.a,PanelRenderer:()=>K.m,PluginPage:()=>w.V,QueryEditorWithMigration:()=>he,RefreshEvent:()=>u._,RuntimeDataSource:()=>P,ScopesContext:()=>O,SidecarContext_EXPERIMENTAL:()=>o.K,SidecarService_EXPERIMENTAL:()=>g.M,StreamingFrameAction:()=>c.Kh,ThemeChangedEvent:()=>u.E8,TimeRangeUpdatedEvent:()=>u.sR,config:()=>L.$,createDataSourcePluginEventProperties:()=>G.y,createMonitoringLogger:()=>W.DW,createPluginEventProperties:()=>G.L,createQueryRunner:()=>z.d,featureEnabled:()=>U.a,frameToMetricFindValue:()=>N.$h,getAngularLoader:()=>n.E,getAppEvents:()=>u.J7,getBackendSrv:()=>t.AI,getCorrelationsService:()=>Xe.r,getDataSourceSrv:()=>r.l,getEchoSrv:()=>i.x$,getGrafanaLiveSrv:()=>c.oF,getLegacyAngularInjector:()=>s.C,getLocationSrv:()=>a.X,getPluginComponentExtensions:()=>E.Dp,getPluginExtensions:()=>E.O3,getPluginImportUtils:()=>F.o,getPluginLinkExtensions:()=>E.Kf,getRunRequest:()=>z.XJ,getTemplateSrv:()=>x.w,hasAllPermissions:()=>ae,hasAnyPermission:()=>re,hasPermission:()=>Z,hasPermissionInMetadata:()=>te,isExperimentViewEvent:()=>B.p6,isExpressionReference:()=>A.s9,isFetchError:()=>t.NF,isInteractionEvent:()=>B.fX,isMigrationHandler:()=>le.LZ,isPageviewEvent:()=>B.nB,isPluginExtensionComponent:()=>C.a,isPluginExtensionLink:()=>C.D,loadPluginCss:()=>F.PL,locationSearchToObject:()=>d.SE,locationService:()=>d.Ny,logDebug:()=>W.MD,logError:()=>W.vV,logInfo:()=>W.fH,logMeasurement:()=>W.l$,logWarning:()=>W.FF,migrateQuery:()=>le.aX,migrateRequest:()=>le.xt,navigationLogger:()=>d.Lc,registerEchoBackend:()=>i.pl,reportExperimentView:()=>I.Xp,reportInteraction:()=>I.rR,reportMetaAnalytics:()=>I.G$,reportPageview:()=>I.Jy,setAngularLoader:()=>n.w,setAppEvents:()=>u.H8,setBackendSrv:()=>t.u5,setChromeHeaderHeightHook:()=>_._,setCorrelationsService:()=>Xe.l,setCurrentUser:()=>l.l,setDataSourceSrv:()=>r.h,setEchoSrv:()=>i.H2,setEmbeddedDashboard:()=>ee.p,setGrafanaLiveSrv:()=>c.S8,setLegacyAngularInjector:()=>s.j,setLocationService:()=>d.vG,setLocationSrv:()=>a.T,setPluginComponentHook:()=>f.A,setPluginComponentsHook:()=>p.R,setPluginExtensionGetter:()=>E.cE,setPluginExtensionsHook:()=>m.Vu,setPluginFunctionsHook:()=>D.U,setPluginImportUtils:()=>F.se,setPluginLinksHook:()=>h.q,setQueryRunnerFactory:()=>z.HC,setReturnToPreviousHook:()=>k._,setRunRequest:()=>z.pC,setTemplateSrv:()=>x.d,sidecarServiceSingleton_EXPERIMENTAL:()=>g.R,toDataQueryError:()=>T.u,toDataQueryResponse:()=>N.bE,useChromeHeaderHeight:()=>_.k,useLocationService:()=>d.at,usePluginComponent:()=>f.S,usePluginComponentExtensions:()=>m.kr,usePluginComponents:()=>p.f,usePluginExtensions:()=>m.pc,usePluginFunctions:()=>D.W,usePluginInteractionReporter:()=>X.G,usePluginLinkExtensions:()=>m.vl,usePluginLinks:()=>h.U,usePluginUserStorage:()=>Se,useReturnToPrevious:()=>k.i,useScopes:()=>R,useSidecar_EXPERIMENTAL:()=>o.M});var t=e(28082),n=e(4050),r=e(98437),a=e(22239),i=e(3353),x=e(39736),s=e(94888),c=e(37633),d=e(53027),u=e(86833),g=e(31906),o=e(10586),E=e(58820),m=e(70415),f=e(23269),p=e(75177),h=e(29012),D=e(25612),C=e(71792),l=e(14372),v=e(29997),y=e(41007);class P extends v.mA{constructor(we,$e){const Fe={name:"RuntimeDataSource-"+we,uid:$e,type:we,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:we,name:"RuntimeDataSource-"+we,type:y.QE.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}};super(Fe),this.instanceSettings=Fe}testDatasource(){return Promise.resolve({status:"success",message:""})}}var b=e(96540),S=e(24120),M=e(88483);const O=(0,b.createContext)(void 0);function R(){const Qe=(0,b.useContext)(O);return(0,S.A)(Qe?.stateObservable??new M.c,Qe?.state),Qe?{state:Qe.state,stateObservable:Qe.stateObservable,changeScopes:Qe.changeScopes,setReadOnly:Qe.setReadOnly,setEnabled:Qe.setEnabled}:void 0}var L=e(32370),B=e(22136),F=e(5885),I=e(56276),U=e(32864),W=e(18729),A=e(65502),N=e(23919),K=e(47454),V=e(350),T=e(64121),z=e(87425),w=e(12417),H=e(30912),G=e(63239),X=e(14065),k=e(51312),_=e(57862),ee=e(83835),J=e(7553);const Z=Qe=>(0,J.ZU)(Qe,(0,l.H)()),te=(Qe,we)=>(0,J.T6)(Qe,we),ae=Qe=>(0,J.Fj)(Qe,(0,l.H)()),re=Qe=>(0,J.jW)(Qe,(0,l.H)());var ne=e(74848),ce=e(70255),le=e(9174);function he(Qe){return $e=>{const[Fe,Te]=(0,b.useState)(!1),[Le,Ge]=(0,b.useState)($e.query);return(0,b.useEffect)(()=>{$e.query&&(0,le.LZ)($e.datasource)?(0,le.aX)($e.datasource,$e.query).then(Me=>{$e.onChange(Me),Ge(Me),Te(!0)}):Te(!0)},[]),(0,b.useEffect)(()=>{Ge($e.query)},[$e.query]),Fe?(0,ne.jsx)(Qe,{...$e,query:Le}):(0,ne.jsx)(ce.A,{containerTestId:"react-loading-skeleton-testid",height:75})}}var oe=e(2543),de=e(75505),me=e(79748);const Pe=`/apis/userstorage.grafana.app/v0alpha1/namespaces/${L.$.namespace}/user-storage`;async function Ee(Qe){try{const{data:we,...$e}=await(0,de.s)((0,t.AI)().fetch({...Qe,url:Pe+Qe.url,data:Qe.body}));return{data:we,meta:$e}}catch(we){return Qe.manageError?Qe.manageError(we):{error:we}}}class be{constructor(we){this.service=we,this.userUID=L.$.bootData.user.uid===""?L.$.bootData.user.id.toString():L.$.bootData.user.uid,this.resourceName=`${we}:${this.userUID}`,this.canUseUserStorage=L.$.featureToggles.userStorageAPI===!0&&L.$.bootData.user.isSignedIn}async init(){if(this.storageSpec!==void 0)return;const we=await Ee({url:`/${this.resourceName}`,method:"GET",showErrorAlert:!1});"error"in we?((0,oe.get)(we,"error.status")!==404&&console.error("Failed to get user storage",we.error),this.storageSpec=null):this.storageSpec=we.data.spec}async getItem(we){return this.canUseUserStorage?(await this.init(),this.storageSpec?this.storageSpec.data[we]:localStorage.getItem(this.resourceName)):localStorage.getItem(this.resourceName)}async setItem(we,$e){if(!this.canUseUserStorage){localStorage.setItem(we,$e);return}const Fe={data:{[we]:$e}};if(await this.init(),!this.storageSpec){await Ee({url:"/",method:"POST",body:{metadata:{name:this.resourceName,labels:{user:this.userUID,service:this.service}},spec:Fe}}),this.storageSpec=Fe;return}this.storageSpec.data[we]=$e,await Ee({headers:{"Content-Type":"application/merge-patch+json"},url:`/${this.resourceName}`,method:"PATCH",body:{spec:Fe}})}}function Se(){const Qe=(0,me.Q)();if(!Qe)throw new Error("No PluginContext found. The usePluginUserStorage() hook can only be used from a plugin.");return new be(Qe?.meta.id)}var Xe=e(83911)},4050:(q,j,e)=>{"use strict";e.d(j,{E:()=>r,w:()=>n});let t;function n(a){t=a}function r(){return t}},83911:(q,j,e)=>{"use strict";e.d(j,{l:()=>n,r:()=>r});let t;function n(a){t=a}function r(){return t}},3353:(q,j,e)=>{"use strict";e.d(j,{H2:()=>r,c_:()=>x,on:()=>t,pl:()=>i,x$:()=>a});var t=(s=>(s.Performance="performance",s.MetaAnalytics="meta-analytics",s.Pageview="pageview",s.Interaction="interaction",s.ExperimentView="experimentview",s.GrafanaJavascriptAgent="grafana-javascript-agent",s))(t||{});let n;function r(s){if(n instanceof x)for(const c of n.buffer)s.addEvent(c.event,c.meta);n=s}function a(){return n||(n=new x),n}const i=s=>{a().addBackend(s)};class x{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(c){}addEvent(c,d){this.buffer.push({event:c,meta:d})}}},53027:(q,j,e)=>{"use strict";e.d(j,{K9:()=>u,Lc:()=>f,Ny:()=>o,SE:()=>g,_K:()=>D,at:()=>h,vG:()=>E});var t=e(74848),n=e(44499),r=e(96540),a=e(49426),i=e(93407),x=e(33262),s=e(61978),c=e(77595),d=e(32370);class u{constructor(l){this.history=l||n.zR({basename:d.$.appSubUrl??"/"}),this.locationObservable=new a.t(this.history.location),this.history.listen(v=>{this.locationObservable.next(v)}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getLocationObservable(){return this.locationObservable.asObservable()}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(l,v){const y=this.history.location,P=this.getSearchObject();for(const S in l)l[S]===null||l[S]===void 0?delete P[S]:P[S]=l[S];const b=i.kM.renderUrl(y.pathname,P);v?this.history.replace(b,this.history.location.state):this.history.push(b,this.history.location.state)}push(l){this.history.push(l)}replace(l){this.history.replace(l)}reload(){const l=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:l?l+1:1}})}getLocation(){return this.history.location}getSearchObject(){return g(this.history.location.search)}update(l){if((0,x.l)("LocationSrv","update","partial, push or replace"),l.partial&&l.query)this.partial(l.query,l.partial);else{const v={pathname:l.path};l.query&&(v.search=i.kM.toUrlParams(l.query)),l.replace?this.replace(v):this.push(v)}}}function g(C){let l=typeof C=="number"?String(C):C;return l.length>0?l.startsWith("?")?i.kM.parseKeyValue(l.substring(1)):i.kM.parseKeyValue(l):{}}let o=new u;const E=C=>{throw new Error("locationService can be only overriden in test environment")},m=(0,s.h)("Router"),f=m.logger;(0,c.h)("location",o,m);const p=r.createContext(void 0);function h(){const C=(0,r.useContext)(p);if(!C)throw new Error("useLocationService must be used within a LocationServiceProvider");return C}const D=({service:C,children:l})=>(0,t.jsx)(p.Provider,{value:C,children:l})},22239:(q,j,e)=>{"use strict";e.d(j,{T:()=>n,X:()=>r});let t;function n(a){t=a}function r(){return t}},87425:(q,j,e)=>{"use strict";e.d(j,{HC:()=>n,XJ:()=>x,d:()=>r,pC:()=>i});let t;const n=s=>{if(t)throw new Error("Runner should only be set when Grafana is starting.");t=s},r=()=>{if(!t)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return t()};let a;function i(s){if(a)throw new Error("runRequest function should only be set once, when Grafana is starting.");a=s}function x(){if(!a)throw new Error("getRunRequest can only be used after Grafana instance has started.");return a}},10586:(q,j,e)=>{"use strict";e.d(j,{K:()=>a,M:()=>i});var t=e(96540),n=e(24120),r=e(31906);const a=(0,t.createContext)(r.R);function i(){const x=(0,t.useContext)(a);if(!x)throw new Error("No SidecarContext found");const s=(0,n.A)(x.initialContextObservable,x.initialContext),c=(0,n.A)(x.activePluginIdObservable,x.activePluginId),d=x.getLocationService();return{activePluginId:c,initialContext:s,locationService:d,openApp:(u,g)=>x.openApp(u,g),openAppV2:(u,g)=>x.openAppV2(u,g),openAppV3:u=>x.openAppV3(u),closeApp:()=>x.closeApp(),isAppOpened:u=>x.isAppOpened(u)}}},31906:(q,j,e)=>{"use strict";e.d(j,{M:()=>u,R:()=>f});var t=e(44499),n=e(2543),r=e.n(n),a=e(49426),i=e(81160),x=e(56276),s=e(32370),c=e(53027);const d=[/(^\/d\/)/,/^\/explore/,/^\/a\/[^\/]+/,/^\/alerting/];class u{constructor(h){this.follow=!1,this.mainOnAllowedRoute=!1,this._initialContext=new a.t(void 0),this.mainLocationService=h,this.sidecarLocationService=new c.K9(m({storageKey:"grafana.sidecar.history"})),this.handleMainLocationChanges()}assertFeatureEnabled(){return s.$.featureToggles.appSidecar?!0:(console.warn("The `appSidecar` feature toggle is not enabled, doing nothing."),!1)}updateMainLocationWhenOpened(){const h=this.mainLocationService.getLocation().pathname;for(const D of d){const C=h.match(D)?.[0];if(C){this.mainLocationWhenOpened=C;return}}}handleMainLocationChanges(){this.mainOnAllowedRoute=d.some(h=>this.mainLocationService.getLocation().pathname.match(h)),this.mainLocationService.getLocationObservable().subscribe(h=>{if(this.mainOnAllowedRoute=d.some(C=>h.pathname.match(C)),!this.activePluginId)return;if(!this.mainOnAllowedRoute){this.closeApp();return}!!(this.mainLocationWhenOpened&&h.pathname.startsWith(this.mainLocationWhenOpened))||this.follow||this.closeApp()})}get activePluginIdObservable(){return this.sidecarLocationService.getLocationObservable().pipe((0,i.T)(h=>o(h?.pathname||"")))}get initialContextObservable(){return this._initialContext.asObservable()}get initialContext(){return this._initialContext.getValue()}get activePluginId(){return o(this.sidecarLocationService.getLocation().pathname)}getLocationService(){return this.sidecarLocationService}openApp(h,D){this.assertFeatureEnabled()&&this.mainOnAllowedRoute&&(this._initialContext.next(D),this.openAppV3({pluginId:h,follow:!1}))}openAppV2(h,D){this.openAppV3({pluginId:h,path:D,follow:!1})}openAppV3(h){this.assertFeatureEnabled()&&this.mainOnAllowedRoute&&(this.follow=h.follow||!1,this.updateMainLocationWhenOpened(),this.sidecarLocationService.push({pathname:`/a/${h.pluginId}${h.path||""}`}),(0,x.rR)("sidecar_service_open_app",{pluginId:h.pluginId,follow:h.follow}))}closeApp(){this.assertFeatureEnabled()&&(this.follow=!1,this.mainLocationWhenOpened=void 0,this._initialContext.next(void 0),this.sidecarLocationService.replace({pathname:"/"}),(0,x.rR)("sidecar_service_close_app"))}isAppOpened(h){if(!this.assertFeatureEnabled())return!1;const D=!!(this.activePluginId&&(this.activePluginId===h||E()===h));return(0,x.rR)("sidecar_service_is_app_opened",{pluginId:h,isOpened:D}),D}}const g=/a\/([^\/]+)/;function o(p){return p.match(g)?.[1]}function E(){const{pathname:p}=c.Ny.getLocation();let h=o(p);return!h&&p.match(/\/explore/)&&(h="explore"),!h&&p.match(/\/d\//)&&(h="dashboards"),h||"unknown"}function m(p){const h=localStorage.getItem(p.storageKey),D=h?JSON.parse(h):"/",C=new a.t(D),l=t.sC({initialEntries:[D]});let v=l.location;function y(){l.location!==v&&(localStorage.setItem(p.storageKey,JSON.stringify((0,n.pick)(l.location,"pathname","search","hash"))),v=l.location,C.next(l.location))}return{...l,get index(){return l.index},get entries(){return l.entries},get length(){return l.length},get action(){return l.action},get location(){return l.location},push(P,b){l.push(P,b),y()},replace(P,b){l.replace(P,b),y()},go(P){l.go(P),y()},goBack(){l.goBack(),y()},goForward(){l.goForward(),y()},getLocationObservable(){return C.asObservable()}}}const f=new u(c.Ny)},98437:(q,j,e)=>{"use strict";e.d(j,{h:()=>n,l:()=>r});let t;function n(a){t=a}function r(){return t}},94888:(q,j,e)=>{"use strict";e.d(j,{C:()=>r,j:()=>n});let t;const n=a=>{t=a},r=()=>t},37633:(q,j,e)=>{"use strict";e.d(j,{Kh:()=>t.Kh,S8:()=>r,oF:()=>a});var t=e(59765);let n;const r=i=>{n=i},a=()=>n},58820:(q,j,e)=>{"use strict";e.d(j,{Dp:()=>s,Kf:()=>x,O3:()=>i,cE:()=>r});var t=e(71792);let n;function r(c){if(n)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");n=c}function a(){if(!n)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return n}const i=c=>a()(c),x=c=>{const{extensions:d}=i(c);return{extensions:d.filter(t.D)}},s=c=>{const{extensions:d}=i(c);return{extensions:d.filter(t.a)}}},23269:(q,j,e)=>{"use strict";e.d(j,{A:()=>n,S:()=>r});let t;function n(a){if(t)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");t=a}function r(a){if(!t)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return t(a)}},75177:(q,j,e)=>{"use strict";e.d(j,{R:()=>n,f:()=>r});let t;function n(a){if(t)throw new Error("setPluginComponentsHook() function should only be called once, when Grafana is starting.");t=a}function r(a){if(!t)throw new Error("setPluginComponentsHook(options) can only be used after the Grafana instance has started.");return t(a)}},70415:(q,j,e)=>{"use strict";e.d(j,{Vu:()=>a,kr:()=>s,pc:()=>i,vl:()=>x});var t=e(96540),n=e(71792);let r;function a(c){if(r)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");r=c}function i(c){if(!r)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return r(c)}function x(c){const{extensions:d,isLoading:u}=i(c);return(0,t.useMemo)(()=>({extensions:d.filter(n.D),isLoading:u}),[d,u])}function s(c){const{extensions:d,isLoading:u}=i(c);return(0,t.useMemo)(()=>({extensions:d.filter(n.a),isLoading:u}),[d,u])}},25612:(q,j,e)=>{"use strict";e.d(j,{U:()=>n,W:()=>r});let t;function n(a){if(t)throw new Error("setUsePluginFunctionsHook() function should only be called once, when Grafana is starting.");t=a}function r(a){if(!t)throw new Error("usePluginFunctions(options) can only be used after the Grafana instance has started.");return t(a)}},29012:(q,j,e)=>{"use strict";e.d(j,{U:()=>r,q:()=>n});let t;function n(a){if(t)throw new Error("setPluginLinksHook() function should only be called once, when Grafana is starting.");t=a}function r(a){if(!t)throw new Error("setPluginLinksHook(options) can only be used after the Grafana instance has started.");return t(a)}},71792:(q,j,e)=>{"use strict";e.d(j,{D:()=>n,a:()=>r});var t=e(93253);function n(a){return a?a.type===t.u.link&&("path"in a||"onClick"in a):!1}function r(a){return a?a.type===t.u.component&&"component"in a:!1}},39736:(q,j,e)=>{"use strict";e.d(j,{d:()=>n,w:()=>r});let t;const n=a=>{t=a},r=()=>t},14372:(q,j,e)=>{"use strict";e.d(j,{H:()=>r,l:()=>n});let t=null;function n(a){if(t)throw new Error("User should only be set once, when Grafana is starting.");t=a}function r(){if(!t)throw new Error("User can only be used after Grafana instance has started.");return t}},65502:(q,j,e)=>{"use strict";e.d(j,{iy:()=>b,dR:()=>C,b1:()=>v,VQ:()=>y,s9:()=>l,ph:()=>M,x7:()=>S});var t=e(62467),n=e(75505),r=e(44240),a=e(63720),i=e(66847),x=e(29997),s=e(61809),c=e(17162),d=e(26701),u=e(26023),g=e(56276),o=e(32370),E=e(98437),m=e(37633),f=e(28082),p=e(59765),h=e(23919);function D(O){const{intervalMs:R,maxDataPoints:L,requestId:B,panelId:F,queryCachingTTL:I,range:{from:U,to:W}}=O;if(!O.targets.length)return(0,t.of)({data:[]});const A={intervalMs:R,maxDataPoints:L,queryCachingTTL:I,timeRange:{from:U.valueOf().toString(),to:W.valueOf().toString(),timezone:O.timezone}};return(0,f.AI)().fetch({url:`/api/public/dashboards/${o.$.publicDashboardAccessToken}/panels/${F}/query`,method:"POST",data:A,requestId:B}).pipe((0,a.n)(N=>(0,t.of)((0,h.bE)(N,O.targets))),(0,i.W)(N=>(0,t.of)((0,h.bE)(N))))}const C=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function l(O){if(!O)return!1;const R=typeof O=="string"?O:O.type;return R===C.type||R===C.name||R==="-100"}class v extends Error{constructor(R,L){super(R),this.details=L,this.name="HealthCheckError"}}var y=(O=>(O.Unknown="UNKNOWN",O.OK="OK",O.Error="ERROR",O))(y||{}),P=(O=>(O.PluginID="X-Plugin-Id",O.DatasourceUID="X-Datasource-Uid",O.DashboardUID="X-Dashboard-Uid",O.PanelID="X-Panel-Id",O.PanelPluginId="X-Panel-Plugin-Id",O.QueryGroupID="X-Query-Group-Id",O.FromExpression="X-Grafana-From-Expr",O.SkipQueryCache="X-Cache-Skip",O))(P||{});class b extends x.mA{constructor(R){super(R),this.streamOptionsProvider=M}query(R){if(o.$.publicDashboardAccessToken)return D(R);const{intervalMs:L,maxDataPoints:B,queryCachingTTL:F,range:I,requestId:U,hideFromInspector:W=!1}=R;let A=R.targets,N=!1;const K=new Set,V=new Set,T=A.map(G=>{let X=this.getRef(),k=this.id,_=!0;if(l(G.datasource))return N=!0,{...G,datasource:C};if(G.datasource){const ee=(0,E.l)().getInstanceSettings(G.datasource,R.scopedVars);if(!ee)throw new Error(`Unknown Datasource: ${JSON.stringify(G.datasource)}`);const J=ee.rawRef??(0,s.p$)(ee),Z=ee.id;(J.uid!==X.uid||k!==Z)&&(X=J,k=Z,_=!1)}return X.type?.length&&K.add(X.type),X.uid?.length&&V.add(X.uid),{..._?this.applyTemplateVariables(G,R.scopedVars,R.filters):G,datasource:X,datasourceId:k,intervalMs:L,maxDataPoints:B,queryCachingTTL:F}});if(!T.length)return(0,t.of)({data:[]});const z={queries:T,from:I?.from.valueOf().toString(),to:I?.to.valueOf().toString()};if(o.$.featureToggles.queryOverLive)return(0,m.oF)().getQueryData({request:R,body:z});const w=R.headers??{};w["X-Plugin-Id"]=Array.from(K).join(", "),w["X-Datasource-Uid"]=Array.from(V).join(", ");let H="/api/ds/query?ds_type="+this.type;return o.$.featureToggles.queryServiceFromUI&&(o.$.featureToggles.queryService||o.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!N&&V.size,H=`/apis/query.grafana.app/v0alpha1/namespaces/${o.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),N&&(w["X-Grafana-From-Expr"]="true",H+="&expression=true"),U&&(H+=`&requestId=${U}`),R.dashboardUID&&(w["X-Dashboard-Uid"]=R.dashboardUID,R.panelId&&(w["X-Panel-Id"]=`${R.panelId}`)),R.panelPluginId&&(w["X-Panel-Plugin-Id"]=`${R.panelPluginId}`),R.queryGroupId&&(w["X-Query-Group-Id"]=`${R.queryGroupId}`),R.skipQueryCache&&(w["X-Cache-Skip"]="true"),(0,f.AI)().fetch({url:H,method:"POST",data:z,requestId:U,hideFromInspector:W,headers:w}).pipe((0,a.n)(G=>{const X=(0,h.bE)(G,T);return X.data?.length&&X.data.find(k=>k.meta?.channel)?S(X,R,this.streamOptionsProvider):(0,t.of)(X)}),(0,i.W)(G=>(0,t.of)((0,h.bE)(G))))}getRequestHeaders(){const R={};return R["X-Plugin-Id"]=this.type,R["X-Datasource-Uid"]=this.uid,R}interpolateVariablesInQueries(R,L,B){return R.map(F=>this.applyTemplateVariables(F,L,B))}applyTemplateVariables(R,L,B){return R}async getResource(R,L,B){const F=this.getRequestHeaders();return(await(0,n.s)((0,f.AI)().fetch({...B,method:"GET",headers:B?.headers?{...B.headers,...F}:F,params:L??B?.params,url:`/api/datasources/uid/${this.uid}/resources/${R}`}))).data}async postResource(R,L,B){const F=this.getRequestHeaders();return(await(0,n.s)((0,f.AI)().fetch({...B,method:"POST",headers:B?.headers?{...B.headers,...F}:F,data:L??{...L},url:`/api/datasources/uid/${this.uid}/resources/${R}`}))).data}async callHealthCheck(){return(0,n.s)((0,f.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(R=>R.data).catch(R=>{let L={plugin_id:this.meta?.id||"",plugin_version:this.meta?.info?.version||"",datasource_healthcheck_status:R?.data?.status||"error",datasource_healthcheck_message:R?.data?.message||""};return(0,g.rR)("datasource_health_check_completed",L),R.data})}async testDatasource(){return this.callHealthCheck().then(R=>R.status==="OK"?{status:"success",message:R.message}:Promise.reject({status:"error",message:R.message,error:new v(R.message,R.details)}))}}function S(O,R,L){const B=(0,m.oF)();if(!B)return(0,t.of)(O);const F=[],I=[];for(const U of O.data){const W=(0,c.DG)(U.meta?.channel);if(W){const A=U;I.push(B.getDataStream({addr:W,buffer:L(R,A),frame:(0,d.Nw)(U)}))}else F.push(U)}return F.length&&I.push((0,t.of)({...O,data:F})),I.length===1?I[0]:(0,r.h)(...I)}const M=(O,R)=>{const L={maxLength:O.maxDataPoints??500,action:p.Kh.Append};return O.rangeRaw?.to==="now"&&(L.maxDelta=O.range.to.valueOf()-O.range.from.valueOf()),L};b=(0,u.Y)(b)},57862:(q,j,e)=>{"use strict";e.d(j,{_:()=>n,k:()=>r});let t;const n=a=>{t=a},r=()=>(t||console.error("useChromeHeaderHeight hook not found"),t?.())},18729:(q,j,e)=>{"use strict";e.d(j,{DW:()=>d,FF:()=>i,MD:()=>x,fH:()=>a,l$:()=>c,vV:()=>s});var t=e(32631),n=e(37930),r=e(32370);function a(u,g){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([u],{level:n.$b.INFO,context:g})}function i(u,g){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([u],{level:n.$b.WARN,context:g})}function x(u,g){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([u],{level:n.$b.DEBUG,context:g})}function s(u,g){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushError(u,{context:g})}function c(u,g,o){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushMeasurement({type:u,values:g},{context:o})}function d(u,g){const o=E=>({source:u,...g,...E});return{logDebug:(E,m)=>x(E,o(m)),logInfo:(E,m)=>a(E,o(m)),logWarning:(E,m)=>i(E,o(m)),logError:(E,m)=>s(E,o(m)),logMeasurement:(E,m,f)=>c(E,m,o(f))}}},9174:(q,j,e)=>{"use strict";e.d(j,{LZ:()=>a,aX:()=>x,xt:()=>s});var t=e(32370),n=e(28082),r=e(65502);function a(c){return c instanceof r.iy&&"hasBackendMigration"in c&&"shouldMigrate"in c}async function i(c){if(!(t.$.featureToggles.grafanaAPIServerWithExperimentalAPIs||t.$.featureToggles.datasourceAPIServers))return console.warn("migrateQuery is only available with the experimental API server"),c;const o=`/apis/${`${c[0].datasource?.type?.replace(/^(grafana-)?(.*?)(-datasource)?$/,"$2")}.datasource.grafana.app`}/v0alpha1/namespaces/${t.$.namespace}/queryconvert`,E={queries:c.map(f=>({...f,JSON:f}))};return(await(0,n.AI)().post(o,E)).queries.map(f=>f.JSON)}async function x(c,d){return!c.hasBackendMigration||!c.shouldMigrate(d)?d:(await i([d]))[0]}async function s(c,d){if(!c.hasBackendMigration||!d.targets.some(g=>c.shouldMigrate(g)))return d;const u=await i(d.targets);return{...d,targets:u}}},5885:(q,j,e)=>{"use strict";e.d(j,{PL:()=>n,o:()=>i,se:()=>a});var t=e(32370);async function n(x){try{const s=t.$.bootData.user.theme==="light"?x.light:x.dark;return window.System.import(s)}catch(s){console.error(s)}}let r;function a(x){if(r)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");r=x}function i(){if(!r)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return r}},23919:(q,j,e)=>{"use strict";e.d(j,{$h:()=>g,bE:()=>s});var t=e(8392),n=e(26701),r=e(4038),a=e(63739),i=e(64121);const x={severity:"info",text:"Cached response"};function s(o,E){const m={data:[],state:t.Gu.Done},f="traceId"in o?o.traceId:void 0;f!=null&&(m.traceIds=[f]);const p=o;if(p.data?.results){const h=p.data.results,D=E?.length?E.map(v=>v.refId):Object.keys(h),C=c(p),l=[];for(const v of D){const y=h[v];y&&(y.refId=v,l.push(y))}for(const v of l){if(v.error){const y={refId:v.refId,message:v.error,status:v.status};f!=null&&(y.traceId=f),m.error||(m.error={...y}),m.errors?m.errors.push({...y}):m.errors=[{...y}],m.state=t.Gu.Error}if(v.frames?.length){for(let y of v.frames){C&&(y=d(y));const P=(0,n.or)(y);P.refId||(P.refId=v.refId),m.data.push(P)}continue}if(v.series?.length)for(const y of v.series)y.refId||(y.refId=v.refId),m.data.push((0,r.Vc)(y));if(v.tables?.length)for(const y of v.tables)y.refId||(y.refId=v.refId),m.data.push((0,r.Vc)(y))}}return p.status&&p.status!==200&&(m.state!==t.Gu.Error&&(m.state=t.Gu.Error),m.error||(m.error=(0,i.u)(o))),m}function c(o){const E=o?.headers;return!E||!E.get?!1:E.get("X-Cache")==="HIT"}function d(o){return{...o,schema:{...o.schema,fields:[...o.schema?.fields??[]],meta:{...o.schema?.meta,notices:[...o.schema?.meta?.notices??[],x],isCachedResponse:!0}}}}function u(o){const E=s(o);if(E.error?.data?.message)return{status:"error",message:E.error.data.message,details:E.error?.data?.error?{message:E.error.data.error}:void 0};if(E.error?.refId&&E.error?.message)return{status:"error",message:E.error.message};throw o}function g(o){if(!o||!o.length)return[];const E=[];let m=o.fields.find(f=>f.type===a.PU.string);if(m||(m=o.fields.find(f=>f.type!==a.PU.time)),m)for(let f=0;f<m.values.length;f++)E.push({text:""+m.values[f]});return E}},51312:(q,j,e)=>{"use strict";e.d(j,{_:()=>n,i:()=>r});let t;const n=a=>{t=a},r=()=>t?t():()=>console.error("ReturnToPrevious hook not found")},10665:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>r,QB:()=>a});var t=e(7500);const n="11.6.0-pre",r={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:t.wV.Auto,showValue:t.yL.Auto,stacking:t.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},a={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},57533:(q,j,e)=>{"use strict";e.d(j,{K:()=>r});var t=e(7500);const n="11.6.0-pre",r={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},63149:(q,j,e)=>{"use strict";e.d(j,{K:()=>n});const t="11.6.0-pre",n={selectedSeries:0}},28885:(q,j,e)=>{"use strict";e.d(j,{K:()=>r});var t=e(7500);const n="11.6.0-pre",r={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:t.T6.Auto}},66929:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>n});const t="11.6.0-pre",n={layers:[]},r={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var a=(x=>(x.Details="details",x.None="none",x))(a||{}),i=(x=>(x.Coords="coords",x.Fit="fit",x.Zero="zero",x))(i||{})},26403:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>x});var t=e(7500);const n="11.6.0-pre";var r=(s=>(s.Opacity="opacity",s.Scheme="scheme",s))(r||{}),a=(s=>(s.Exponential="exponential",s.Linear="linear",s))(a||{}),i=(s=>(s.X="x",s.Xy="xy",s.Y="y",s))(i||{});const x={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},88887:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>r,QB:()=>a});var t=e(7500);const n="11.6.0-pre",r={bucketCount:30,bucketOffset:0},a={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},27785:(q,j,e)=>{"use strict";e.d(j,{K:()=>n});const t="11.6.0-pre",n={showImage:!0}},48977:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>x});const t="11.6.0-pre";var n=(s=>(s.Donut="donut",s.Pie="pie",s))(n||{}),r=(s=>(s.Name="name",s.Percent="percent",s.Value="value",s))(r||{}),a=(s=>(s.Percent="percent",s.Value="value",s))(a||{});const i={values:[]},x={displayLabels:[]}},20849:(q,j,e)=>{"use strict";e.d(j,{K:()=>r});var t=e(7500);const n="11.6.0-pre",r={colorMode:t.yp.Value,graphMode:t.$p.Area,justifyMode:t.F8.Auto,percentChangeColorMode:t.CD.Standard,showPercentChange:!1,textMode:t.SV.Auto,wideLayout:!0}},57495:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>r,QB:()=>a});var t=e(7500);const n="11.6.0-pre",r={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:t.yL.Auto},a={fillOpacity:70,lineWidth:0}},88091:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>r,QB:()=>a});var t=e(7500);const n="11.6.0-pre",r={colWidth:.9,perPage:20,rowHeight:.9,showValue:t.yL.Auto},a={fillOpacity:70,lineWidth:1}},11751:(q,j,e)=>{"use strict";e.d(j,{K:()=>r});var t=e(7500);const n="11.6.0-pre",r={cellHeight:t.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},90569:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>x});const t="11.6.0-pre";var n=(s=>(s.Code="code",s.HTML="html",s.Markdown="markdown",s))(n||{}),r=(s=>(s.Go="go",s.Html="html",s.Json="json",s.Markdown="markdown",s.Plaintext="plaintext",s.Sql="sql",s.Typescript="typescript",s.Xml="xml",s.Yaml="yaml",s))(r||{});const a="plaintext",i={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},x={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},68985:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>s,QB:()=>x});const t="11.6.0-pre";var n=(c=>(c.Circle="circle",c.Square="square",c))(n||{}),r=(c=>(c.Auto="auto",c.Manual="manual",c))(r||{}),a=(c=>(c.Lines="lines",c.Points="points",c.PointsAndLines="points+lines",c))(a||{});const i={id:""},x={fillOpacity:50,show:"points"},s={series:[]}},13076:(q,j,e)=>{"use strict";e.d(j,{$C:()=>D,CO:()=>x,GW:()=>P,OA:()=>C,Ol:()=>o,QB:()=>y,WL:()=>f,Yb:()=>u,Ye:()=>b,ZG:()=>c,aD:()=>r,bf:()=>a,bt:()=>l,dM:()=>m,lt:()=>p,rw:()=>i,ss:()=>v,yV:()=>h});const t={tags:[]},n={exclude:!1,ids:[]},r={list:[]},a={builtIn:0,enable:!0,hide:!1},i={allowCustomValue:!0,includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var x=(S=>(S[S.never=0]="never",S[S.onDashboardLoad=1]="onDashboardLoad",S[S.onTimeRangeChanged=2]="onTimeRangeChanged",S))(x||{}),s=(S=>(S[S.dontHide=0]="dontHide",S[S.hideLabel=1]="hideLabel",S[S.hideVariable=2]="hideVariable",S))(s||{}),c=(S=>(S[S.alphabeticalAsc=1]="alphabeticalAsc",S[S.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",S[S.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",S[S.alphabeticalDesc=2]="alphabeticalDesc",S[S.disabled=0]="disabled",S[S.naturalAsc=7]="naturalAsc",S[S.naturalDesc=8]="naturalDesc",S[S.numericalAsc=3]="numericalAsc",S[S.numericalDesc=4]="numericalDesc",S))(c||{});const d={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var u=(S=>(S.ContinuousBlPu="continuous-BlPu",S.ContinuousBlYlRd="continuous-BlYlRd",S.ContinuousBlues="continuous-blues",S.ContinuousGrYlRd="continuous-GrYlRd",S.ContinuousGreens="continuous-greens",S.ContinuousPurples="continuous-purples",S.ContinuousRdYlGr="continuous-RdYlGr",S.ContinuousReds="continuous-reds",S.ContinuousYlBl="continuous-YlBl",S.ContinuousYlRd="continuous-YlRd",S.Fixed="fixed",S.PaletteClassic="palette-classic",S.PaletteClassicByName="palette-classic-by-name",S.Shades="shades",S.Thresholds="thresholds",S))(u||{});const g={h:9,w:12,x:0,y:0};var o=(S=>(S.Absolute="absolute",S.Percentage="percentage",S))(o||{});const E={steps:[]};var m=(S=>(S.RangeToText="range",S.RegexToText="regex",S.SpecialValue="special",S.ValueToText="value",S))(m||{}),f=(S=>(S.Empty="empty",S.False="false",S.NaN="nan",S.Null="null",S.NullAndNan="null+nan",S.True="true",S))(f||{});const p={hidden:!1,quick_ranges:[],refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]};var h=(S=>(S[S.Crosshair=1]="Crosshair",S[S.Off=0]="Off",S[S.Tooltip=2]="Tooltip",S))(h||{});const D=0,C={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},l={overrides:[]},v={id:""},y={links:[],mappings:[]},P={collapsed:!1,panels:[]},b={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:41,tags:[],timezone:"browser"}},46004:(q,j,e)=>{"use strict";e.d(j,{Bj:()=>ze,ET:()=>Je,FM:()=>ve,G9:()=>ie,IP:()=>ht,SR:()=>fe,X1:()=>Ze,bt:()=>o,ft:()=>X,hM:()=>t,l_:()=>un,m6:()=>Ve,ns:()=>yt,pK:()=>Re,t1:()=>Oe,uB:()=>st});const t=()=>({annotations:[],cursorSync:"Off",editable:!0,elements:{},layout:ce(),links:[],preload:!1,tags:[],timeSettings:X(),title:"",variables:[]}),n=()=>Fe(),r=()=>({kind:"LibraryPanel",spec:a()}),a=()=>({id:0,title:"",libraryPanel:i()}),i=()=>({name:"",uid:""}),x=()=>({exclude:!1,ids:[]}),s=()=>"Off",c=()=>({title:"",type:"link",icon:"",tooltip:"",tags:[],asDropdown:!1,targetBlank:!1,includeVars:!1,keepTime:!1}),d=()=>({}),u=()=>({id:"",options:{}}),g=()=>({title:"",url:""}),o=()=>({defaults:E(),overrides:[]}),E=()=>({}),m=()=>({id:""}),f=()=>({id:""}),p=()=>({value:0,color:""}),h=()=>"absolute",D=()=>({mode:"absolute",steps:[]}),C=()=>v(),l=()=>"value",v=()=>({type:"value",options:{}}),y=()=>({type:"range",options:{from:0,to:0,result:M()}}),P=()=>({type:"regex",options:{pattern:"",result:M()}}),b=()=>({type:"special",options:{match:"true",result:M()}}),S=()=>"true",M=()=>({}),O=()=>"thresholds",R=()=>"min",L=()=>({mode:"thresholds"}),B=()=>"link",F=()=>({kind:"",spec:{}}),I=()=>({pluginVersion:"",options:{},fieldConfig:o()}),U=()=>({kind:"",spec:I()}),W=()=>({enable:!1,hide:!1,iconColor:"",name:"",builtIn:!1}),A=()=>({kind:"AnnotationQuery",spec:W()}),N=()=>({}),K=()=>({kind:"",spec:{}}),V=()=>({query:K(),refId:"",hidden:!1}),T=()=>({kind:"PanelQuery",spec:V()}),z=()=>({kind:"",spec:u()}),w=()=>({queries:[],transformations:[],queryOptions:N()}),H=()=>({kind:"QueryGroup",spec:w()}),G=()=>({display:"Last 6 hours",from:"now-6h",to:"now"}),X=()=>({timezone:"browser",from:"now-6h",to:"now",autoRefresh:"",autoRefreshIntervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],hideTimepicker:!1,fiscalYearStartMonth:0}),k="variable",_=()=>({mode:k,value:""}),ee=()=>({mode:k,value:""}),J=()=>({mode:k,value:""}),Z=()=>({x:0,y:0,width:0,height:0,element:Te()}),te=()=>({kind:"GridLayoutItem",spec:Z()}),ae=()=>({kind:"GridLayoutRow",spec:re()}),re=()=>({y:0,collapsed:!1,title:"",elements:[]}),ne=()=>({items:[]}),ce=()=>({kind:"GridLayout",spec:ne()}),le=()=>({kind:"RowsLayout",spec:he()}),he=()=>({rows:[]}),oe=()=>({kind:"RowsLayoutRow",spec:de()}),de=()=>({collapsed:!1,layout:ce()}),me=()=>({kind:"ResponsiveGridLayout",spec:Pe()}),Pe=()=>({row:"",col:"",items:[]}),Ee=()=>({kind:"ResponsiveGridLayoutItem",spec:be()}),be=()=>({element:Te()}),Se=()=>({kind:"TabsLayout",spec:Xe()}),Xe=()=>({tabs:[]}),Qe=()=>({kind:"TabsLayoutTab",spec:we()}),we=()=>({layout:ce()}),$e=()=>({id:0,title:"",description:"",links:[],data:H(),vizConfig:U()}),Fe=()=>({kind:"Panel",spec:$e()}),Te=()=>({kind:"ElementReference",name:""}),Le=()=>Ge(),Ge=()=>"",Me=()=>({name:"",type:"query",multi:!1,includeAll:!1}),De=()=>({formatter:""}),Ke=()=>({value:{},legacyVariableModel:{name:"",type:"query",multi:!1,includeAll:!1}}),Ie=()=>"query",Ne=()=>Ve(),ie=()=>"disabled",ve=()=>"never",fe=()=>"dontHide",ge=()=>({label:"",value:Ge()}),xe=()=>({text:"",value:""}),je=()=>({name:"",current:{text:"",value:""},hide:"dontHide",refresh:"never",skipUrlSync:!1,query:K(),regex:"",sort:"disabled",options:[],multi:!1,includeAll:!1}),Ve=()=>({kind:"QueryVariable",spec:je()}),ke=()=>({name:"",current:{text:"",value:""},query:"",hide:"dontHide",skipUrlSync:!1}),Oe=()=>({kind:"TextVariable",spec:ke()}),nt=()=>({name:"",query:"",current:{text:"",value:""},hide:"dontHide",skipUrlSync:!1}),Je=()=>({kind:"ConstantVariable",spec:nt()}),Be=()=>({name:"",pluginId:"",refresh:"never",regex:"",current:{text:"",value:""},options:[],multi:!1,includeAll:!1,hide:"dontHide",skipUrlSync:!1}),Ze=()=>({kind:"DatasourceVariable",spec:Be()}),tt=()=>({name:"",query:"",current:{text:"",value:""},options:[],auto:!1,auto_min:"",auto_count:0,refresh:"never",hide:"dontHide",skipUrlSync:!1}),Re=()=>({kind:"IntervalVariable",spec:tt()}),at=()=>({name:"",query:"",current:xe(),options:[],multi:!1,includeAll:!1,hide:"dontHide",skipUrlSync:!1}),yt=()=>({kind:"CustomVariable",spec:at()}),ze=()=>({name:"",current:{text:"",value:""},options:[],multi:!1,hide:"dontHide",skipUrlSync:!1}),st=()=>({kind:"GroupByVariable",spec:ze()}),ht=()=>({name:"",baseFilters:[],filters:[],defaultKeys:[],hide:"dontHide",skipUrlSync:!1}),It=()=>({text:""}),Gt=()=>({key:"",operator:"",value:""}),un=()=>({kind:"AdhocVariable",spec:ht()})},67553:(q,j,e)=>{"use strict";e.d(j,{Gu:()=>r,gB:()=>n});var t=e(7500);const n={align:"auto",inspect:!1,cellOptions:{type:t.ob.Auto}};var r=(a=>(a.NotStarted="NotStarted",a.Loading="Loading",a.Streaming="Streaming",a.Done="Done",a.Error="Error",a))(r||{})},39344:(q,j,e)=>{"use strict";e.d(j,{Ye:()=>r,lt:()=>i,rw:()=>a,zL:()=>n});var t=e(13076),n=(E=>(E[E.dontHide=0]="dontHide",E[E.hideLabel=1]="hideLabel",E[E.hideVariable=2]="hideVariable",E))(n||{});const r=t.Ye,a={...t.rw},i=t.lt,x=t.OA,s=t.GW,c=t.QB,d=t.bt,u=t.ss,g=t.bf,o=t.aD},76313:(q,j,e)=>{"use strict";e.d(j,{l:()=>u});var t=e(74848),n=e(22803),r=e(73287),a=e(56276),i=e(29675),x=e(99764),s=e(86489),c=e(3886),d=e(12597);function u({rawSql:o,datasourceType:E}){const[m,f]=(0,r.A)(),p=(0,i.of)(g),h=C=>{f(C),(0,a.rR)("grafana_sql_preview_copied",{datasource:E})},D=(0,t.jsxs)("div",{className:p.labelWrapper,children:[(0,t.jsx)("span",{className:p.label,children:"Preview"}),(0,t.jsx)(x.K,{tooltip:"Copy to clipboard",onClick:()=>h(o),name:"copy"})]});return(0,t.jsx)(s.D,{label:D,className:p.grow,children:(0,t.jsx)(c.B,{language:"sql",height:80,value:(0,d.s)(o),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function g(o){return{grow:(0,n.css)({flexGrow:1}),label:(0,n.css)({fontSize:12,fontWeight:o.typography.fontWeightMedium}),labelWrapper:(0,n.css)({display:"flex",justifyContent:"space-between",paddingBottom:o.spacing(.5)})}}},12597:(q,j,e)=>{"use strict";e.d(j,{s:()=>n});var t=e(27633);function n(r){return t.default.format(r).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,a=>a.replace(/\s/g,""))}},32879:(q,j,e)=>{"use strict";e.d(j,{r:()=>x});var t=e(74848),n=e(96540),r=e(70462),a=e(54594),i=e(65164);function x({action:s,...c}){const[d,u]=(0,n.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.$n,{variant:"primary",size:"sm",onClick:()=>u(!0),...c,style:{width:"fit-content"},children:s.title}),d&&(0,t.jsx)(i.u,{isOpen:!0,title:(0,r.t)("grafana-ui.action-editor.button.confirm-action","Confirm action"),body:s.confirmation,confirmText:(0,r.t)("grafana-ui.action-editor.button.confirm","Confirm"),confirmButtonVariant:"primary",onConfirm:()=>{u(!1),s.onClick(new MouseEvent("click"))},onDismiss:()=>{u(!1)}})]})}},37e3:(q,j,e)=>{"use strict";e.d(j,{F:()=>u});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(54594),s=e(79784),c=e(90231),d=e(45565);const u=r.forwardRef(({title:E,onRemove:m,children:f,buttonContent:p,elevated:h,bottomSpacing:D,topSpacing:C,className:l,severity:v="error",...y},P)=>{const b=(0,i.$j)(),M=o(b,v,!!E,h,D,C),O={error:"alert",warning:"alert",info:"status",success:"status"},R=y.role||O[v],L=y["aria-label"]||E;return(0,t.jsx)("div",{ref:P,className:(0,n.cx)(M.wrapper,l),role:R,"aria-label":L,...y,children:(0,t.jsxs)(c.a,{"data-testid":a.Tp.components.Alert.alertV2(v),display:"flex",backgroundColor:v,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:v,alignItems:"stretch",boxShadow:h?"z3":void 0,children:[(0,t.jsx)(c.a,{paddingTop:1,paddingRight:2,children:(0,t.jsx)("div",{className:M.icon,children:(0,t.jsx)(s.I,{size:"xl",name:g(v)})})}),(0,t.jsxs)(c.a,{paddingY:1,grow:1,children:[(0,t.jsx)(d.E,{color:"primary",weight:"medium",children:E}),f&&(0,t.jsx)("div",{className:M.content,children:f})]}),m&&!p&&(0,t.jsx)("div",{className:M.close,children:(0,t.jsx)(x.$n,{"aria-label":"Close alert",icon:"times",onClick:m,type:"button",fill:"text",variant:"secondary"})}),m&&p&&(0,t.jsx)(c.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,t.jsx)(x.$n,{"aria-label":"Close alert",variant:"secondary",onClick:m,type:"button",children:p})})]})})});u.displayName="Alert";const g=E=>{switch(E){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},o=(E,m,f,p,h,D)=>{const C=E.colors[m];return{wrapper:(0,n.css)({flexGrow:1,marginBottom:E.spacing(h??2),marginTop:E.spacing(D??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:E.colors.background.primary,zIndex:-1}}),icon:(0,n.css)({color:C.text,position:"relative",top:"-1px"}),content:(0,n.css)({color:E.colors.text.primary,paddingTop:f?E.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,n.css)({position:"relative",color:E.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},66384:(q,j,e)=>{"use strict";e.d(j,{E:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(70255),i=e(84140),x=e(29675),s=e(71815),c=e(79784),d=e(6736);const u=r.memo(({icon:f,color:p,text:h,tooltip:D,className:C,...l})=>{const v=(0,x.of)(m,p),y=(0,t.jsxs)("div",{className:(0,n.cx)(v.wrapper,C),...l,children:[f&&(0,t.jsx)(c.I,{name:f,size:"sm"}),h]});return D?(0,t.jsx)(d.m,{content:D,placement:"auto",children:y}):y});u.displayName="Badge";const g=({rootProps:f})=>{const p=(0,x.of)(E);return(0,t.jsx)(a.A,{width:60,height:22,containerClassName:p.container,...f})},o=(0,s.j)(u,g),E=()=>({container:(0,n.css)({lineHeight:1})}),m=(f,p)=>{let h=f.visualization.getColorByName(p),D="",C="",l="";return f.isDark?(C=(0,i.A)(h).setAlpha(.15).toString(),D=(0,i.A)(h).setAlpha(.25).toString(),l=(0,i.A)(h).lighten(15).toString()):(C=(0,i.A)(h).setAlpha(.15).toString(),D=(0,i.A)(h).setAlpha(.25).toString(),l=(0,i.A)(h).darken(20).toString()),{wrapper:(0,n.css)({display:"inline-flex",padding:"1px 4px",borderRadius:f.shape.radius.default,background:C,border:`1px solid ${D}`,color:l,fontWeight:f.typography.fontWeightRegular,gap:"2px",fontSize:f.typography.bodySmall.fontSize,lineHeight:f.typography.bodySmall.lineHeight,alignItems:"center"})}}},22662:(q,j,e)=>{"use strict";e.d(j,{xE:()=>P});var t=e(74848),n=e(22803),r=e(96540),a=e(84140),i=e(21288),x=e(99116),s=e(8919),c=e(59141),d=e(62931),u=e(18752),g=e(58779),o=e(7500),E=e(91371),m=e(54594),f=e(48092);const p=18,h=50,D=150,C=1.5,l=1,v=10,y=15;class P extends r.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:o.eX.Gradient,orientation:i.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:x.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0,isOverflow:!1}}render(){const{onClick:A,className:N,theme:K}=this.props,{title:V}=this.props.value,T=M(this.props);return A?(0,t.jsxs)("button",{type:"button",style:T.wrapper,onClick:A,className:(0,n.cx)((0,m.my)(K),N),children:[(0,t.jsx)("div",{style:T.title,children:V}),this.renderBarAndValue()]}):(0,t.jsxs)("div",{style:T.wrapper,className:N,children:[V&&(0,t.jsx)("div",{style:T.title,children:V}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:A,showUnfilled:N,valueDisplayMode:K}=this.props,V=B(this.props);return(0,t.jsxs)("div",{style:V.wrapper,children:[K!==o.$l.Hidden&&(0,t.jsx)(f.i,{"data-testid":g.Tp.components.Panels.Visualization.BarGauge.valueV2,value:A,style:V.value}),N&&(0,t.jsx)("div",{style:V.emptyBar}),(0,t.jsx)("div",{style:V.bar})]})}renderRetroBars(){const{display:A,field:N,value:K,itemSpacing:V,alignmentFactors:T,orientation:z,lcdCellWidth:w,text:H,valueDisplayMode:G,theme:X,isOverflow:k}=this.props,{valueHeight:_,valueWidth:ee,maxBarHeight:J,maxBarWidth:Z,wrapperWidth:te,wrapperHeight:ae}=O(this.props),re=N.min??s.tw,ne=N.max??s.d1,ce=b(z),le=ne-re,he=ce?J:Z,oe=V,de=Math.floor(he/w),me=Math.floor((he-oe*de)/de),Pe=I(this.props),be=U(T||K,Pe,ee,_,z,k,H),Se={width:`${te}px`,height:`${ae}px`,display:"flex"};ce?(Se.flexDirection="column-reverse",Se.alignItems="center"):(Se.flexDirection="row",Se.alignItems="center",be.justifyContent="flex-end");const Xe=[];for(let Qe=0;Qe<de;Qe++){const we=re+le/de*Qe,$e=R(we,K,A),Fe={borderRadius:X.shape.radius.default};$e.isLit?Fe.backgroundImage=`radial-gradient(${$e.background} 10%, ${$e.backgroundShade})`:Fe.backgroundColor=$e.background,ce?(Fe.height=`${me}px`,Fe.width=`${Z}px`,Fe.marginTop=`${oe}px`):(Fe.width=`${me}px`,Fe.height=`${J}px`,Fe.marginRight=`${oe}px`),Xe.push((0,t.jsx)("div",{style:Fe},Qe.toString()))}return(0,t.jsxs)("div",{style:Se,children:[Xe,G!==o.$l.Hidden&&(0,t.jsx)(f.i,{"data-testid":g.Tp.components.Panels.Visualization.BarGauge.valueV2,value:K,style:be})]})}}function b(W){return W===i.wV.Vertical}function S(W){const{height:A,width:N,alignmentFactors:K,orientation:V,text:T,namePlacement:z}=W,w=K?K.title:W.value.title;if(!w)return{fontSize:0,width:0,height:0,placement:"above"};if(z===o.TZ.Hidden)return{fontSize:0,width:0,height:0,placement:o.TZ.Hidden};if(b(V)){const J=T?.titleSize??14;return{fontSize:J,width:N,height:J*C,placement:"below"}}if(A>40&&z===o.TZ.Auto||z===o.TZ.Top){if(T?.titleSize)return{fontSize:T?.titleSize,width:0,height:T.titleSize*C,placement:"above"};const Z=Math.max(Math.min(A*.45,h),17);return{fontSize:Z/C,width:0,height:Z,placement:"above"}}const k=Math.max(A*.6,p)/C,_=(0,E.kD)(w,k),ee=Math.min(_.width+15,N*.4);return{fontSize:T?.titleSize??k,height:0,width:ee,placement:"left"}}function M(W){const A={display:"flex",overflow:"hidden",width:"100%"},N=S(W),K={fontSize:`${N.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return N.placement==="hidden"?K.display="none":b(W.orientation)?(A.flexDirection="column-reverse",K.textAlign="center"):N.placement==="above"?A.flexDirection="column":(A.flexDirection="row",K.width=`${N.width}px`,K.textAlign="right",K.paddingRight="10px"),{wrapper:A,title:K}}function O(W){const{height:A,width:N,orientation:K,text:V,alignmentFactors:T,valueDisplayMode:z}=W,w=S(W),H=T??W.value,G=(0,c.cN)(H);let X=0,k=0,_=0,ee=0,J=0,Z=0;const te=V?.valueSize??Math.max(w.fontSize,12),re=(0,E.kD)(G,te).width+v*2;return b(K)?(V?.valueSize?_=V.valueSize*l:_=Math.min(Math.max(A*.1,p),h),ee=N,z===o.$l.Hidden&&(_=0,ee=0),X=A-(w.height+_),k=N,J=N,Z=A-w.height):(z===o.$l.Hidden?(_=0,ee=0):(_=A-w.height,ee=Math.max(Math.min(N*.2,D),re)),X=A-w.height,k=N-ee-w.width,w.placement==="above"?(J=N,Z=A-w.height):(J=N-w.width,Z=A)),{valueWidth:ee,valueHeight:_,maxBarWidth:k,maxBarHeight:X,wrapperHeight:Z,wrapperWidth:J}}function R(W,A,N){if(W===null)return{background:d.F,border:d.F};const K=N?N(W).color:null;return K?A===null||isNaN(A.numeric)||W!==null&&W>A.numeric?{background:(0,a.A)(K).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,a.A)(K).setAlpha(.95).toRgbString(),backgroundShade:(0,a.A)(K).setAlpha(.55).toRgbString(),border:(0,a.A)(K).setAlpha(.9).toRgbString(),isLit:!0}:{background:d.F,border:d.F}}function L(W,A,N){const K=Math.min((W-A)/(N-A),1);return isNaN(K)?0:K}function B(W){const{displayMode:A,field:N,value:K,alignmentFactors:V,orientation:T,theme:z,text:w,isOverflow:H}=W,{valueWidth:G,valueHeight:X,maxBarHeight:k,maxBarWidth:_}=O(W),ee=N.min??s.tw,J=N.max??s.d1,Z=L(K.numeric,ee,J),te=I(W),ae=K.color??d.F,ne=U(V||K,te,G,X,T,H,w),ce=A==="basic",le={display:"flex",flexGrow:1},he={borderRadius:z.shape.radius.default,position:"relative",zIndex:1},oe={background:z.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:z.shape.radius.default,position:"relative"};if(b(T)){const de=Math.max(Z*k,1);le.flexDirection="column",le.justifyContent="flex-end",he.transition="height 1s",he.height=`${de}px`,he.width=`${_}px`,oe.bottom="-3px",oe.width=`${G}px`,ce?(he.background=`${(0,a.A)(ae).setAlpha(.35).toRgbString()}`,he.borderTop=`2px solid ${ae}`):he.background=F(W,k)}else{const de=Math.max(Z*_,1);le.flexDirection="row-reverse",le.justifyContent="flex-end",le.alignItems="stretch",he.transition="width 1s",he.height=`${k}px`,he.width=`${de}px`,oe.left="-3px",oe.height=`${X}px`,ce?(he.background=`${(0,a.A)(ae).setAlpha(.35).toRgbString()}`,he.borderRight=`2px solid ${ae}`):he.background=F(W,_)}return{wrapper:le,bar:he,value:ne,emptyBar:oe}}function F(W,A){const{field:N,value:K,orientation:V,theme:T}=W,z=b(V)?"0deg":"90deg",w=N.min,H=N.max;let G="",X=0,k=(0,u.Hs)(N.color?.mode);if(k.id===d.Y.Thresholds){const _=N.thresholds;for(let ee=0;ee<_.steps.length;ee++){const J=_.steps[ee],Z=W.theme.visualization.getColorByName(J.color),te=_.mode===x.O.Percentage?J.value/100:L(J.value,w,H),ae=te*A,re=Math.round(ae-(ae-X)/2),ne=_.mode===x.O.Percentage?w+(H-w)*te:J.value;if(G==="")G=`linear-gradient(${z}, ${Z}, ${Z}`;else{if(K.numeric<ne)break;X=ae,G+=` ${re}px, ${Z}`}}return G+")"}if(k.isContinuous&&k.getColors){const _=k.getColors(T);for(let ee=0;ee<_.length;ee++){const J=_[ee];if(G==="")G=`linear-gradient(${z}, ${J} 0px`;else{const te=ee/(_.length-1)*A;G+=`, ${J} ${te}px`}}return G+")"}return K.color??d.F}function I(W){if(W.valueDisplayMode==="text")return W.theme.colors.text.primary;const{value:A}=W;return A.color?A.color:d.F}function U(W,A,N,K,V,T,z){const w={color:A,height:`${K}px`,width:`${N}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:l};let H=N;const G=(0,c.cN)(W);return b(V)?(w.fontSize=z?.valueSize??(0,E.Vr)(G,H,K,l),w.justifyContent="center"):(w.fontSize=z?.valueSize??(0,E.Vr)(G,H-v*2,K,l),w.justifyContent="flex-end",w.paddingLeft=`${v}px`,w.paddingRight=`${v+(T?y:0)}px`,H-=v),w}},5958:(q,j,e)=>{"use strict";e.d(j,{yV:()=>I,yp:()=>R,$p:()=>L,F8:()=>B,SV:()=>F});var t=e(74848),n=e(22803),r=e(96540),a=e(54594),i=e(48092),x=e(84140),s=e(63739),c=e(59141),d=e(7500),u=e(41090),g=e(91371),o=e(392),E=e(79784);const m=({percentChange:U,styles:W})=>{let A;return U>0?A="arrow-up":U<0&&(A="arrow-down"),(0,t.jsxs)("div",{style:W.containerStyles,children:[A&&(0,t.jsx)(E.I,{name:A,height:W.iconSize,width:W.iconSize,viewBox:"6 6 12 12"}),f(U)]})},f=U=>(U/100).toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3}),p=1.2,h=30,D=500;class C{constructor(W){this.props=W;const{width:A,height:N,value:K,text:V}=W;this.valueColor=K.color??"gray",this.panelPadding=N>100?12:8,this.textValues=M(W),this.justifyCenter=S(W.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.percentFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=A-this.panelPadding*2,this.maxTextHeight=N-this.panelPadding*2,V&&(V.titleSize&&(this.titleFontSize=V.titleSize,this.titleToAlignTo=void 0),V.valueSize&&(this.valueFontSize=V.valueSize,this.valueToAlignTo=""),V.percentSize&&(this.percentFontSize=V.percentSize))}getTitleStyles(){const W={fontSize:`${this.titleFontSize}px`,lineHeight:p};return(this.props.colorMode===R.Background||this.props.colorMode===R.BackgroundSolid)&&(W.color=(0,u.mZ)(this.valueColor,this.props.theme.isDark)),W}getValueStyles(){const W={fontSize:this.valueFontSize,fontWeight:D,lineHeight:p,position:"relative",zIndex:1};switch(this.justifyCenter&&(W.textAlign="center"),this.props.colorMode){case R.Value:W.color=this.valueColor;break;case R.Background:case R.BackgroundSolid:W.color=(0,u.mZ)(this.valueColor,this.props.theme.isDark);break;case R.None:W.color=this.props.theme.colors.text.primary;break}return W}getPercentChangeStyles(W,A,N){const V=this.getValueAndTitleContainerStyles(),T=this.percentFontSize||Math.max(this.valueFontSize/2.5,12);let z=this.percentFontSize?this.percentFontSize-3:Math.max(this.valueFontSize/3,10);const w=this.props.theme.visualization,H=O(W,A,N,w),G={fontSize:T,fontWeight:D,lineHeight:p,position:"relative",display:"flex",alignItems:"center",gap:Math.max(T/3,4),zIndex:1,color:H};switch(this.justifyCenter&&(G.textAlign="center"),V.flexDirection==="column"&&T>12&&(G.marginTop=-(T/4)),V.flexDirection==="row"&&(G.alignItems="baseline",G.lineHeight=p*2.5),this.props.colorMode){case R.Background:case R.BackgroundSolid:G.color=(0,u.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===F.None&&(G.fontSize=(0,g.Vr)(f(W),this.maxTextWidth*.8,this.maxTextHeight*.8,p,void 0,D),z=G.fontSize*.8),{containerStyles:G,iconSize:z}}getValueAndTitleContainerStyles(){const W={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(W.alignItems="center",W.justifyContent="center",W.flexGrow=1,W.gap="0.75ch"),W}getPanelStyles(){const{width:W,height:A,theme:N,colorMode:K,textMode:V}=this.props,T={width:`${W}px`,height:`${A}px`,padding:`${V===F.None?2:this.panelPadding}px`,borderRadius:N.shape.radius.default,position:"relative",display:"flex"},z=N.isDark?1:-.7;switch(K){case R.Background:const w=(0,x.A)(this.valueColor).darken(15*z).spin(8).toRgbString(),H=(0,x.A)(this.valueColor).darken(5*z).spin(-8).toRgbString();T.background=`linear-gradient(120deg, ${w}, ${H})`;break;case R.BackgroundSolid:T.background=(0,x.A)(this.valueColor).toString();break;case R.Value:T.background="transparent";break}return this.justifyCenter&&(T.alignItems="center",T.flexDirection="row"),T}renderChart(){const{sparkline:W,colorMode:A}=this.props;if(!W||W.y?.type!==s.PU.number)return null;let N,K;switch(A){case R.Background:case R.BackgroundSolid:N="rgba(255,255,255,0.4)",K=(0,x.A)(this.valueColor).brighten(40).toRgbString();break;case R.None:case R.Value:default:K=this.valueColor,N=(0,x.A)(this.valueColor).setAlpha(.2).toRgbString();break}const V={custom:{drawStyle:d.GR.Line,lineWidth:1,fillColor:N,lineColor:K}};return(0,t.jsx)("div",{style:this.getChartStyles(),children:(0,t.jsx)(o.O,{height:this.chartHeight,width:this.chartWidth,sparkline:W,config:V,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class l extends C{constructor(W){super(W);const A=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth*A,this.maxTextHeight,p,void 0,D)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,p,h),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="row",W.alignItems="center",W.flexGrow=1,this.justifyCenter||(W.justifyContent="space-between"),W}renderChart(){return null}getPanelStyles(){const W=super.getPanelStyles();return W.alignItems="center",W}}class v extends C{constructor(W){super(W);const{width:A,height:N}=W,K=.5,V=.6,T=1-V,z=.4;this.chartWidth=A,this.chartHeight=N*K,this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth*V,this.maxTextHeight*z,p,h)),this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth*T,this.maxTextHeight*K,p,void 0,D))}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="row",W.flexGrow=1,this.justifyCenter||(W.justifyContent="space-between"),W}getPanelStyles(){const W=super.getPanelStyles();return W.flexDirection="row",W.justifyContent="space-between",W}}class y extends C{constructor(W){super(W);const{width:A,height:N}=W,K=.15,V=.25;let T=0;this.chartHeight=N*V,this.chartWidth=A,this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth,N*K,p,h),T=this.titleFontSize*p),this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-T,p,void 0,D)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=N-this.titleFontSize*p-this.valueFontSize*p}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="column",W.justifyContent="center",W}getPanelStyles(){const W=super.getPanelStyles();return W.flexDirection="column",W}}class P extends C{constructor(W){super(W);const{height:A}=W,N=.15;let K=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth,A*N,p,h),K=this.titleFontSize*p),this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-K,p,void 0,D)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const W=super.getValueAndTitleContainerStyles();return W.flexDirection="column",W.flexGrow=1,W}renderChart(){return null}getPanelStyles(){const W=super.getPanelStyles();return W.alignItems="center",W}}function b(U){const{width:W,height:A,sparkline:N}=U;return W/A>2.5&&!U.disableWideLayout?A>50&&N&&N.y.values.length>1?new v(U):new l(U):A>100&&N&&N.y.values.length>1?new y(U):new P(U)}function S(U,W){return U===B.Center?!0:(W??"").length===0}function M(U){const{value:W,alignmentFactors:A,count:N}=U;let{textMode:K}=U;const V=A?A.title:W.title,T=(0,c.cN)(A||W);switch(K===F.Auto&&(N??1)===1&&(K=F.Value),K){case F.Name:return{...W,title:void 0,prefix:void 0,suffix:void 0,text:W.title||"",titleToAlignTo:void 0,valueToAlignTo:V??"",tooltip:(0,c.cN)(W)};case F.Value:return{...W,title:void 0,titleToAlignTo:void 0,valueToAlignTo:T,tooltip:W.title};case F.None:return{numeric:W.numeric,color:W.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${W.title}
Value: ${(0,c.cN)(W)}`};case F.ValueAndName:default:return{...W,titleToAlignTo:V,valueToAlignTo:T}}}function O(U,W,A,N){return W===d.CD.SameAsValue?A.color:U*(W===d.CD.Inverted?-1:1)>0?N.getColorByName("green"):N.getColorByName("red")}var R=(U=>(U.Background="background",U.BackgroundSolid="background_solid",U.None="none",U.Value="value",U))(R||{}),L=(U=>(U.None="none",U.Line="line",U.Area="area",U))(L||{}),B=(U=>(U.Auto="auto",U.Center="center",U))(B||{}),F=(U=>(U.Auto="auto",U.Value="value",U.ValueAndName="value_and_name",U.Name="name",U.None="none",U))(F||{});class I extends r.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:W,className:A,hasLinks:N,theme:K}=this.props,V=b(this.props),T=V.getPanelStyles(),z=V.getValueAndTitleContainerStyles(),w=V.getValueStyles(),H=V.getTitleStyles(),G=V.textValues,X=this.props.value.percentChange,k=this.props.percentChangeColorMode,_=X!=null&&!Number.isNaN(X),ee=N?void 0:G.tooltip;return W?(0,t.jsxs)("button",{type:"button",className:(0,n.cx)((0,a.my)(K),A),style:T,onClick:W,title:ee,children:[(0,t.jsxs)("div",{style:z,children:[G.title&&(0,t.jsx)("div",{style:H,children:G.title}),(0,t.jsx)(i.i,{value:G,style:w})]}),V.renderChart()]}):(0,t.jsxs)("div",{className:A,style:T,title:ee,children:[(0,t.jsxs)("div",{style:z,children:[G.title&&(0,t.jsx)("div",{style:H,children:G.title}),(0,t.jsx)(i.i,{value:G,style:w}),_&&(0,t.jsx)(m,{percentChange:X,styles:V.getPercentChangeStyles(X,k,w)})]}),V.renderChart()]})}}},53112:(q,j,e)=>{"use strict";e.d(j,{J:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(23257),i=e.n(a),x=e(29675),s=e(90411);const c=(0,r.forwardRef)(({name:u,value:g,hidden:o,facets:E,onClick:m,className:f,loading:p,searchTerm:h,active:D,style:C,title:l,highlightParts:v,...y},P)=>{const b=(0,x.$j)(),S=d(b),M=h?[h]:[],O=(0,r.useCallback)(L=>{m&&!o&&m(u,g,L)},[m,u,o,g]);let R=g||u;return E&&(R=`${R} (${E})`),(0,t.jsx)("button",{ref:P,onClick:O,style:C,title:l||R,type:"button",role:"option","aria-selected":!!D,className:(0,n.cx)(S.base,D&&S.active,p&&S.loading,o&&S.hidden,f,m&&!o&&S.hover),...y,children:v!==void 0?(0,t.jsx)(s.z,{text:R,highlightClassName:S.matchHighLight,highlightParts:v}):(0,t.jsx)(i(),{textToHighlight:R,searchWords:M,autoEscape:!0,highlightClassName:S.matchHighLight})},R)});c.displayName="Label";const d=u=>({base:(0,n.css)({display:"inline-block",cursor:"pointer",fontSize:u.typography.size.sm,lineHeight:u.typography.bodySmall.lineHeight,backgroundColor:u.colors.background.secondary,color:u.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:u.spacing(.5),borderRadius:u.shape.radius.default,border:"none",marginRight:u.spacing(1),marginBottom:u.spacing(.5)}),loading:(0,n.css)({fontWeight:u.typography.fontWeightMedium,backgroundColor:u.colors.primary.shade,color:u.colors.text.primary,[u.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:u.colors.text.primary},"50%":{color:u.colors.text.secondary},"100%":{color:u.colors.text.disabled}}}),active:(0,n.css)({fontWeight:u.typography.fontWeightMedium,backgroundColor:u.colors.primary.main,color:u.colors.primary.contrastText}),matchHighLight:(0,n.css)({background:"inherit",color:u.components.textHighlight.text,backgroundColor:u.components.textHighlight.background}),hidden:(0,n.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},90333:(q,j,e)=>{"use strict";e.d(j,{e:()=>i});var t=e(74848),n=e(22803),r=e(96540),a=e(29675);const i=(0,r.forwardRef)(({className:s,children:c,...d},u)=>{const g=(0,a.of)(x);return(0,t.jsx)("div",{ref:u,className:(0,n.cx)("button-group",g.wrapper,s),...d,children:c})});i.displayName="ButtonGroup";const x=s=>({wrapper:(0,n.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},78464:(q,j,e)=>{"use strict";e.d(j,{c:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({message:x,callToActionElement:s,footer:c,className:d})=>{const u=(0,r.of)(i);return(0,t.jsxs)("div",{className:(0,n.cx)([u.wrapper,d]),children:[x&&(0,t.jsx)("div",{className:u.message,children:x}),s,c&&(0,t.jsx)("div",{className:u.footer,children:c})]})},i=x=>({wrapper:(0,n.css)({label:"call-to-action-card",background:x.colors.background.secondary,borderRadius:x.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:x.spacing(3),[x.breakpoints.down("sm")]:{padding:x.spacing(3,1)}}),message:(0,n.css)({marginBottom:x.spacing(3),fontStyle:"italic"}),footer:(0,n.css)({marginTop:x.spacing(3)})})},6210:(q,j,e)=>{"use strict";e.d(j,{H:()=>P,Z:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(94963),x=e(51081);const s=r.createContext(null),c=({disabled:b,href:S,onClick:M,children:O,isSelected:R,isCompact:L,className:B,...F})=>{const I=(0,r.useMemo)(()=>r.Children.toArray(O).some(N=>r.isValidElement(N)&&N.type===d),[O]),U=b||!M&&!S,W=M&&!b?M:void 0,A=(0,a.of)(x.i,b,U,R,L);return(0,t.jsx)(x.Q,{disableEvents:b,disableHover:U,isSelected:R,className:(0,n.cx)(A.container,B),...F,children:(0,t.jsxs)(s.Provider,{value:{href:S,onClick:W,disabled:b,isSelected:R},children:[!I&&(0,t.jsx)(d,{}),O]})})};c.displayName="Card";const d=({children:b,className:S,"aria-label":M})=>{const O=(0,r.useContext)(s),R=(0,a.of)(u),{href:L,onClick:B,isSelected:F}=O??{href:void 0,onClick:void 0,isSelected:void 0};return(0,t.jsxs)("h2",{className:(0,n.cx)(R.heading,S),children:[L?(0,t.jsx)("a",{href:L,className:R.linkHack,"aria-label":M,onClick:B,children:b}):B?(0,t.jsx)("button",{onClick:B,className:R.linkHack,"aria-label":M,type:"button",children:b}):(0,t.jsx)(t.Fragment,{children:b}),F!==void 0&&(0,t.jsx)("input",{"aria-label":"option",type:"radio",checked:F,readOnly:!0})]})};d.displayName="Heading";const u=b=>({heading:(0,n.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:b.typography.size.md,letterSpacing:"inherit",lineHeight:b.typography.body.lineHeight,color:b.colors.text.primary,fontWeight:b.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,n.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:b.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,i.getFocusStyles)(b),zIndex:1}}})}),g=({children:b,className:S})=>{const M=(0,a.of)(o);return(0,t.jsx)("div",{className:(0,n.cx)(M.tagList,S),children:b})};g.displayName="Tags";const o=b=>({tagList:(0,n.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),E=({children:b,className:S})=>{const M=(0,a.of)(m),O=typeof b=="string"?"p":"div";return(0,t.jsx)(O,{className:(0,n.cx)(M.description,S),children:b})};E.displayName="Description";const m=b=>({description:(0,n.css)({width:"100%",gridArea:"Description",margin:b.spacing(1,0,0),color:b.colors.text.secondary,lineHeight:b.typography.body.lineHeight})}),f=({children:b,align:S="start",className:M})=>{const O=(0,a.of)(p);return(0,t.jsx)("div",{className:(0,n.cx)(O.media,M,(0,n.css)({alignSelf:S})),children:b})};f.displayName="Figure";const p=b=>({media:(0,n.css)({position:"relative",gridArea:"Figure",marginRight:b.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),h=(0,r.memo)(({children:b,className:S,separator:M="|"})=>{const O=(0,a.of)(D);let R=b;const L=r.Children.toArray(b).filter(Boolean);return L.length?(R=L.map((B,F)=>(0,t.jsx)("div",{className:O.metadataItem,children:B},`element_${F}`)),L.length>1&&M&&(R=L.reduce((B,F,I)=>[B,(0,t.jsx)("span",{className:O.separator,children:M},`separator_${I}`),F])),(0,t.jsx)("div",{className:(0,n.cx)(O.metadata,S),children:R})):null});h.displayName="Meta";const D=b=>({metadata:(0,n.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:b.typography.size.sm,color:b.colors.text.secondary,margin:b.spacing(.5,0,0),lineHeight:b.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,n.css)({zIndex:0}),separator:(0,n.css)({margin:`0 ${b.spacing(1)}`})}),C=({children:b,disabled:S,variant:M,className:O})=>{const R=(0,a.of)(l),B=(0,r.useContext)(s)?.disabled||S,F=M==="primary"?R.actions:R.secondaryActions;return(0,t.jsx)("div",{className:(0,n.cx)(F,O),children:r.Children.map(b,I=>r.isValidElement(I)?(0,r.cloneElement)(I,{disabled:B,...I.props}):null)})},l=b=>({actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:b.spacing(1),gridArea:"Actions",marginTop:b.spacing(2)}),secondaryActions:(0,n.css)({alignSelf:"center",color:b.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:b.spacing(1),gridArea:"Secondary",marginTop:b.spacing(2)})}),v=({children:b,disabled:S,className:M})=>(0,t.jsx)(C,{variant:"primary",disabled:S,className:M,children:b});v.displayName="Actions";const y=({children:b,disabled:S,className:M})=>(0,t.jsx)(C,{variant:"secondary",disabled:S,className:M,children:b});y.displayName="SecondaryActions";const P=b=>({inner:(0,n.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...u(b),...D(b),...m(b),...p(b),...l(b),...o(b)});c.Heading=d,c.Tags=g,c.Figure=f,c.Meta=h,c.Actions=v,c.SecondaryActions=y,c.Description=E},51081:(q,j,e)=>{"use strict";e.d(j,{Q:()=>s,i:()=>c});var t=e(74848),n=e(22803),r=e(29675),a=e(94963);const i=({children:d,href:u})=>{const{inner:g}=(0,r.of)(x);return u?(0,t.jsx)("a",{className:g,href:u,children:d}):(0,t.jsx)(t.Fragment,{children:d})},x=d=>({inner:(0,n.css)({display:"flex",width:"100%",padding:d.spacing(2)})}),s=({children:d,disableEvents:u,disableHover:g,isSelected:o,className:E,href:m,...f})=>{const{oldContainer:p}=(0,r.of)(c,u,g,o);return(0,t.jsx)("div",{...f,className:(0,n.cx)(p,E),children:(0,t.jsx)(i,{href:m,children:d})})},c=(d,u=!1,g=!1,o,E)=>{const m=o!==void 0;return{container:(0,n.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:d.spacing(E?1:2),background:d.colors.background.secondary,borderRadius:d.shape.radius.default,marginBottom:"8px",pointerEvents:u?"none":"auto",[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create(["background-color","box-shadow","border-color","color"],{duration:d.transitions.duration.short})},...!g&&{"&:hover":{background:d.colors.emphasize(d.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":a.getFocusStyles(d)},...m&&{cursor:"pointer"},...o&&{outline:`solid 2px ${d.colors.primary.border}`}}),oldContainer:(0,n.css)({display:"flex",width:"100%",background:d.colors.background.secondary,borderRadius:d.shape.radius.default,position:"relative",pointerEvents:u?"none":"auto",marginBottom:d.spacing(1),[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create(["background-color","box-shadow","border-color","color"],{duration:d.transitions.duration.short})},...!g&&{"&:hover":{background:d.colors.emphasize(d.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":a.getFocusStyles(d)}})}}},530:(q,j,e)=>{"use strict";e.d(j,{v:()=>D});var t=e(74848),n=e(22803),r=e(47078),a=e.n(r),i=e(80441),x=e(96540),s=e(29675),c=e(79784),d=e(99764),u=e(34128),g=e(48583),o=e(44826),E=e(70348),m=e(94632);const f=(0,n.css)({"&:focus":{outline:"none"}}),p=" / ";class h extends x.PureComponent{constructor(l){super(l),this.flattenOptions=(b,S=[])=>{let M=[];for(const O of b){const R=[...S];R.push(O),!O.items||O.items.length===0?M.push({singleLabel:R[R.length-1].label,label:R.map(L=>L.label).join(this.props.separator||p),value:R.map(L=>L.value)}):M=[...M,...this.flattenOptions(O.items,R)]}return M},this.getSearchableOptions=a()(b=>this.flattenOptions(b)),this.onChange=(b,S)=>{const M=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?S.map(R=>R.label).join(this.props.separator||p):S[S.length-1].label,O={rcValue:{value:b,label:M},focusCascade:!0,activeLabel:M,isSearching:!1,inputValue:M};this.setState(O),this.props.onSelect(S[S.length-1].value)},this.onSelect=b=>{const S=b.value||[],M=this.props.displayAllSelectedLevels?b.label:b.singleLabel||"",O={activeLabel:M,inputValue:M,rcValue:{value:S,label:M},isSearching:!1,focusCascade:!1};this.setState(O),this.props.onSelect(S[S.length-1])},this.onCreateOption=b=>{this.setState({activeLabel:b,inputValue:b,rcValue:[],isSearching:!1}),this.props.onSelect(b)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=b=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(b.key))return;const{activeLabel:S}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:S})},this.onSelectInputChange=b=>{this.setState({inputValue:b})};const v=this.getSearchableOptions(l.options),{rcValue:y,activeLabel:P}=this.setInitialValue(v,l.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:y,activeLabel:P,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(l,v){if(!v)return{rcValue:[],activeLabel:""};for(const y of l){const P=y.value||[];if(P[P.length-1]===v)return{rcValue:P,activeLabel:this.props.displayAllSelectedLevels?y.label:y.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:v}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:l,formatCreateLabel:v,placeholder:y,width:P,changeOnSelect:b,options:S,disabled:M,id:O,isClearable:R,theme:L}=this.props,{focusCascade:B,isSearching:F,rcValue:I,activeLabel:U,inputValue:W}=this.state,A=this.getSearchableOptions(S),N=(0,m.T)(L);return(0,t.jsx)("div",{children:F?(0,t.jsx)(o.l6,{allowCustomValue:l,placeholder:y,autoFocus:!B,onChange:this.onSelect,onBlur:this.onBlur,options:A,onCreateOption:this.onCreateOption,formatCreateLabel:v,width:P,onInputChange:this.onSelectInputChange,disabled:M,inputValue:W,inputId:O}):(0,t.jsx)(i.A,{onChange:(0,E.k)(this.onChange),options:S,changeOnSelect:b,value:I.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:M,dropdownClassName:N.dropdown,children:(0,t.jsx)("div",{className:f,children:(0,t.jsx)(u.p,{autoFocus:this.props.autoFocus,width:P,placeholder:y,onBlur:this.onBlurCascade,value:U,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,t.jsxs)(g.B,{gap:.5,children:[R&&U!==""&&(0,t.jsx)(d.K,{name:"times","aria-label":"Clear selection",onClick:K=>{K.preventDefault(),K.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,t.jsx)(c.I,{name:B?"angle-up":"angle-down"})]}),disabled:M,id:O})})})})}}const D=(0,s.cV)(h)},70348:(q,j,e)=>{"use strict";e.d(j,{W:()=>n,k:()=>t});const t=i=>(x,s)=>{i&&i(x.map(c=>String(c)),r(s))},n=i=>x=>{i&&i(r(x))},r=i=>i.map(a),a=i=>{const x=i.value?String(i.value):"";return{value:x,label:typeof i.label=="string"?i.label:x}}},94632:(q,j,e)=>{"use strict";e.d(j,{T:()=>x});var t=e(22803);const n=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),r=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),a=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),i=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),x=s=>({dropdown:(0,t.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:s.colors.background.elevated,border:"none",borderRadius:s.shape.radius.default,boxShadow:s.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:n,animationPlayState:"running"},"&-topLeft":{animationName:a,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:r,animationPlayState:"running"},"&-topLeft":{animationName:i,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:s.spacing(.5),borderRight:`1px solid ${s.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:s.spacing(4),lineHeight:s.spacing(4),padding:s.spacing(0,4,0,2),borderRadius:s.shape.radius.default,cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:s.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:s.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:s.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:s.colors.text.maxContrast,background:s.colors.background.secondary,"&:hover":{background:s.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:s.colors.background.secondary,content:"''",height:s.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:s.spacing(.5),width:s.spacing(3)}}}}}})})},77576:(q,j,e)=>{"use strict";e.d(j,{N:()=>r});var t=e(74848),n=e(96540);class r extends n.PureComponent{constructor(){super(...arguments),this.myRef=(0,n.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=i=>{const x=this.myRef.current;(!x||i.target instanceof Node&&!x.contains(i.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,t.jsx)("div",{ref:this.myRef,children:this.props.children})}}},93604:(q,j,e)=>{"use strict";e.d(j,{b:()=>u});var t=e(74848),n=e(22803),r=e(96540),a=e(70462),i=e(29675),x=e(54594),s=e(79784),c=e(96260);const d=2*1e3;function u({onClipboardCopy:E,onClipboardError:m,children:f,getText:p,icon:h,variant:D,...C}){const l=(0,i.of)(o),[v,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let M;return v&&(M=setTimeout(()=>{y(!1)},d)),()=>{window.clearTimeout(M)}},[v]);const P=(0,r.useRef)(null),b=(0,r.useCallback)(async()=>{const M=p();try{await g(M,P),y(!0),E?.(M)}catch(O){m?.(M,O)}},[p,E,m]),S=(0,a.t)("clipboard-button.inline-toast.success","Copied");return(0,t.jsxs)(t.Fragment,{children:[v&&(0,t.jsx)(c.r,{placement:"top",referenceElement:P.current,children:S}),(0,t.jsxs)(x.$n,{onClick:b,icon:h,variant:v?"success":D,"aria-label":v?S:void 0,...C,className:(0,n.cx)(l.button,v&&l.successButton,C.className),ref:P,children:[f,v&&(0,t.jsx)("div",{className:l.successOverlay,children:(0,t.jsx)(s.I,{name:"check"})})]})]})}const g=async(E,m)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(E);{const f=document.createElement("textarea");m.current?.appendChild(f),f.value=E,f.focus(),f.select(),document.execCommand("copy"),f.remove()}},o=E=>({button:(0,n.css)({position:"relative"}),successButton:(0,n.css)({"> *":(0,n.css)({visibility:"hidden"})}),successOverlay:(0,n.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},91036:(q,j,e)=>{"use strict";e.d(j,{M:()=>u});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(96540),x=e(29675),s=e(94963),c=e(79784),d=e(20968);const u=({label:o,isOpen:E,onToggle:m,className:f,contentClassName:p,children:h,labelId:D,loading:C=!1,headerDataTestId:l,contentDataTestId:v})=>{const[y,P]=(0,i.useState)(E),b=(0,x.of)(g),S=R=>{R.target instanceof HTMLElement&&R.target.tagName==="A"||(R.preventDefault(),R.stopPropagation(),m?.(!y),P(!y))},{current:M}=(0,i.useRef)((0,r.uniqueId)()),O=D??`collapse-label-${M}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{onClick:S,className:(0,n.cx)(b.header,f),children:[(0,t.jsx)("button",{type:"button",id:`collapse-button-${M}`,className:b.button,onClick:S,"aria-expanded":y&&!C,"aria-controls":`collapse-content-${M}`,"aria-labelledby":O,children:C?(0,t.jsx)(d.y,{className:b.spinner}):(0,t.jsx)(c.I,{name:y?"angle-up":"angle-down",className:b.icon})}),(0,t.jsx)("div",{className:b.label,id:`collapse-label-${M}`,"data-testid":l,children:o})]}),y&&(0,t.jsx)("div",{id:`collapse-content-${M}`,className:(0,n.cx)(b.content,p),"data-testid":v,children:h})]})},g=o=>({header:(0,n.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:o.typography.size.lg,padding:`${o.spacing(.5)} 0`,"&:focus-within":(0,s.getFocusStyles)(o)}),button:(0,n.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,n.css)({color:o.colors.text.secondary}),content:(0,n.css)({padding:`${o.spacing(2)} 0`}),spinner:(0,n.css)({display:"flex",alignItems:"center",width:o.spacing(2)}),label:(0,n.css)({display:"flex"})})},43192:(q,j,e)=>{"use strict";e.d(j,{S:()=>d,a:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(54594),x=e(79784);const s=u=>({collapse:(0,n.css)({label:"collapse",marginBottom:u.spacing(1),backgroundColor:u.colors.background.primary,border:`1px solid ${u.colors.border.weak}`,position:"relative",borderRadius:u.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,n.css)({label:"collapse__body",padding:u.spacing(u.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,n.css)({label:"bodyContentWrapper",flex:1}),loader:(0,n.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:u.spacing(.5)}),loaderActive:(0,n.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:u.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,n.css)({label:"collapse__header",padding:u.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,n.css)({label:"collapse__header--collapsed",padding:u.spacing(1,2,1,2)}),headerLabel:(0,n.css)({label:"collapse__header-label",fontWeight:u.typography.fontWeightMedium,marginRight:u.spacing(1),fontSize:u.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,n.css)({label:"collapse__icon",margin:u.spacing(.25,1,0,-1)})}),c=({isOpen:u,onToggle:g,...o})=>{const[E,m]=(0,r.useState)(u);return(0,t.jsx)(d,{isOpen:E,collapsible:!0,...o,onToggle:()=>{m(!E),g&&g(!E)}})},d=({isOpen:u,label:g,loading:o,collapsible:E,onToggle:m,className:f,children:p})=>{const h=(0,a.of)(i.my),D=(0,a.of)(s),C=()=>{m&&m(!u)},l=(0,n.cx)([D.collapse,f]),v=o?(0,n.cx)([D.loader,D.loaderActive]):(0,n.cx)([D.loader]),y=E?(0,n.cx)([D.header]):(0,n.cx)([D.headerCollapsed]);return(0,t.jsxs)("div",{className:l,children:[(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(h,y),onClick:C,children:[E&&(0,t.jsx)(x.I,{className:D.icon,name:u?"angle-down":"angle-right"}),(0,t.jsx)("div",{className:(0,n.cx)([D.headerLabel]),children:g})]}),u&&(0,t.jsxs)("div",{className:(0,n.cx)([D.collapseBody]),children:[(0,t.jsx)("div",{className:v}),(0,t.jsx)("div",{className:D.bodyContentWrapper,children:p})]})]})};d.displayName="Collapse"},95108:(q,j,e)=>{"use strict";e.d(j,{A:()=>u});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(96540),x=e(84140),s=e(29675),c=e(34128);const d=(0,i.forwardRef)(({color:E,onChange:m,isClearable:f=!1,onClick:p,onBlur:h,disabled:D,buttonAriaLabel:C,...l},v)=>{const[y,P]=(0,i.useState)(E),[b,S]=(0,i.useState)(E),M=(0,i.useMemo)(()=>(0,r.debounce)(m,100),[]);(0,i.useEffect)(()=>{const L=(0,x.A)(E);L.isValid()&&E!==b&&(P(L.toString()),S(E))},[E,b]);const O=L=>{const{value:B}=L.currentTarget;if(P(B),B===""&&f){M(B);return}const F=(0,x.A)(B);F.isValid()&&M(F.toString())},R=L=>{(0,x.A)(y).isValid()||P(E),h?.(L)};return(0,t.jsx)(c.p,{...l,value:y,onChange:O,disabled:D,onClick:p,onBlur:R,addonBefore:(0,t.jsx)(g,{onClick:p,ariaLabel:C,disabled:D,color:E}),ref:v})});d.displayName="ColorInput";const u=d,g=({color:E,onClick:m,disabled:f,ariaLabel:p})=>{const h=(0,s.of)(o);return(0,t.jsx)("button",{type:"button",onClick:m,"aria-label":p,disabled:f||!m,className:(0,n.cx)(h,(0,n.css)({backgroundColor:E}))})},o=E=>(0,n.css)({height:"100%",width:`${E.spacing.gridSize*4}px`,borderRadius:`${E.shape.radius.default} 0 0 ${E.shape.radius.default}`,border:`1px solid ${E.colors.border.medium}`})},57836:(q,j,e)=>{"use strict";e.d(j,{Dp:()=>m,sk:()=>E});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(90617),x=e(66631),s=e(95486),c=e(52706),d=e(92613),u=e(82738),g=e(30446);const o=(p,h="ColorPicker")=>class extends r.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,r.createRef)()}static{this.displayName=h}render(){const{theme:C,children:l,onChange:v,color:y}=this.props,P=f(C),b=r.createElement(p,{...this.props,children:null,onChange:v});return(0,t.jsx)(c.I,{content:b,hideAfter:300,children:(S,M,O)=>(0,t.jsxs)(t.Fragment,{children:[this.pickerTriggerRef.current&&(0,t.jsx)(s.A,{...O,referenceElement:this.pickerTriggerRef.current,wrapperClassName:P.colorPicker,onMouseLeave:M,onMouseEnter:S,onKeyDown:R=>(0,x.Q)(R,M)}),l?l({ref:this.pickerTriggerRef,showColorPicker:S,hideColorPicker:M}):(0,t.jsx)(u.q,{ref:this.pickerTriggerRef,onClick:S,onMouseLeave:M,color:C.visualization.getColorByName(y||"#000000"),"aria-label":y})]})})}},E=(0,a.cV)(o(d.$,"ColorPicker")),m=(0,a.cV)(o(g.o,"SeriesColorPicker")),f=(0,i.N)(p=>({colorPicker:(0,n.css)({position:"absolute",zIndex:p.zIndex.tooltip,color:p.colors.text.primary,maxWidth:"400px",fontSize:p.typography.size.sm})}))},92613:(q,j,e)=>{"use strict";e.d(j,{$:()=>v});var t=e(74848),n=e(22803),r=e(85690),a=e(96540),i=e(87190),x=e(29675),s=e(90617),c=e(70462),d=e(88849),u=e(10247),g=e(82738),o=e(2543);function E(P,b){const S=new Array(P.length);for(let M=0;M<P.length;M++){const O=P.length-1-M;S[M]=b(P[O],O,P)}return S}const f=({hue:P,selectedColor:b,onColorSelect:S,...M})=>{const O=(0,o.upperFirst)(P.name),R=(0,x.of)(p);return(0,t.jsxs)("div",{className:R.colorRow,children:[(0,t.jsx)("div",{className:R.colorLabel,children:O}),(0,t.jsx)("div",{...M,className:R.swatchRow,children:E(P.shades,L=>(0,t.jsx)(g.q,{"aria-label":L.name,variant:L.primary?g.h.Large:g.h.Small,isSelected:L.name===b,color:L.color,onClick:()=>S(L.name)},L.name))})]})},p=P=>({colorRow:(0,n.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:P.spacing(2),padding:P.spacing(.5,0),"&:hover":{background:P.colors.background.secondary}}),colorLabel:(0,n.css)({paddingLeft:P.spacing(1),display:"flex",alignItems:"center"}),swatchRow:(0,n.css)({display:"flex",gap:P.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),h=({color:P,onChange:b})=>{const S=(0,x.$j)(),M=(0,x.of)(D),O=[];for(const R of S.visualization.hues)O.push((0,t.jsx)(f,{selectedColor:P,hue:R,onColorSelect:b},R.name));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:M.swatches,children:O}),(0,t.jsxs)("div",{className:M.extraColors,children:[(0,t.jsx)(g.q,{isSelected:P==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>b("transparent")}),(0,t.jsx)(g.q,{isSelected:P==="text",color:S.colors.text.primary,label:"Text color",onClick:()=>b("text")})]})]})},D=P=>({container:(0,n.css)({display:"flex",flexDirection:"column"}),extraColors:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:P.spacing(1),padding:P.spacing(1,0)}),swatches:(0,n.css)({display:"grid",flexGrow:1})});var C=e(54061);class l extends a.Component{constructor(b){super(b),this.handleChange=S=>{const{onChange:M,enableNamedColors:O,theme:R}=this.props;if(O)return M(S);M(i.MV.asHexString(R.visualization.getColorByName(S)))},this.onTabChange=S=>()=>this.setState({activePicker:S}),this.renderPicker=()=>{const{activePicker:S}=this.state,{color:M}=this.props;switch(S){case"spectrum":return(0,t.jsx)(C.A,{color:M,onChange:this.handleChange});case"palette":return(0,t.jsx)(h,{color:M,onChange:this.handleChange});default:return this.renderCustomPicker(S)}},this.renderCustomPicker=S=>{const{customPickers:M,color:O,theme:R}=this.props;return M?a.createElement(M[S].tabComponent,{color:O,theme:R,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:S}=this.props;return S?(0,t.jsx)(t.Fragment,{children:Object.keys(S).map(M=>(0,t.jsx)(d.o,{label:S[M].name,onChangeTab:this.onTabChange(M)},M))}):null},this.state={activePicker:"palette"}}render(){const{theme:b}=this.props,{activePicker:S}=this.state,M=y(b);return(0,t.jsx)(r.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsxs)("div",{tabIndex:-1,className:M.colorPickerPopover,children:[(0,t.jsxs)(u.U,{children:[(0,t.jsx)(d.o,{label:(0,c.t)("grafana-ui.color-picker-popover.palette-tab","Colors"),onChangeTab:this.onTabChange("palette"),active:S==="palette"}),(0,t.jsx)(d.o,{label:(0,c.t)("grafana-ui.color-picker-popover.spectrum-tab","Custom"),onChangeTab:this.onTabChange("spectrum"),active:S==="spectrum"}),this.renderCustomPickerTabs()]}),(0,t.jsx)("div",{className:M.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const v=(0,x.cV)(l);v.displayName="ColorPickerPopover";const y=(0,s.N)(P=>({colorPickerPopover:(0,n.css)({borderRadius:P.shape.radius.default,boxShadow:P.shadows.z3,background:P.colors.background.elevated,padding:P.spacing(.5),border:`1px solid ${P.colors.border.weak}`}),colorPickerPopoverContent:(0,n.css)({width:"246px",fontSize:P.typography.bodySmall.fontSize,minHeight:"184px",padding:P.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${P.shape.radius.default} ${P.shape.radius.default} 0 0`})}))},82738:(q,j,e)=>{"use strict";e.d(j,{h:()=>c,q:()=>d});var t=e(74848),n=e(22803),r=e(73001),a=e(96540),i=e(84140),x=e(58779),s=e(29675),c=(g=>(g.Small="small",g.Large="large",g))(c||{});const d=a.forwardRef(({color:g,label:o,variant:E="small",isSelected:m,"aria-label":f,...p},h)=>{const D=(0,s.$j)(),{isFocusVisible:C,focusProps:l}=(0,r.o)(),v=u(D,E,g,C,m),y=!!o,P=f||o;return(0,t.jsxs)("div",{ref:h,className:v.wrapper,"data-testid":x.Tp.components.ColorSwatch.name,...p,children:[y&&(0,t.jsx)("span",{className:v.label,children:o}),(0,t.jsx)("button",{className:v.swatch,...l,"aria-label":P?`${P} color`:"Pick a color",type:"button"})]})}),u=(g,o,E,m,f)=>{const p=(0,i.A)(E),D=o==="small"?"16px":"32px";let C="none";return p.getAlpha()<.1&&(C=`2px solid ${g.colors.border.medium}`),{wrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,n.css)({marginRight:g.spacing(1)}),swatch:(0,n.css)({width:D,height:D,background:`${E}`,border:C,borderRadius:g.shape.radius.circle,outlineOffset:"1px",outline:m?`2px solid  ${g.colors.primary.main}`:"none",boxShadow:f?`inset 0 0 0 2px ${E}, inset 0 0 0 4px ${g.colors.getContrastText(E)}`:"none",[g.transitions.handleMotion("no-preference")]:{transition:g.transitions.create(["transform"],{duration:g.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};d.displayName="ColorSwatch"},30446:(q,j,e)=>{"use strict";e.d(j,{o:()=>x,t:()=>s});var t=e(74848),n=e(29675),r=e(60484),a=e(29010),i=e(92613);const x=c=>{const{yaxis:d,onToggleAxis:u,color:g,...o}=c,E=u?{yaxis:{name:"Y-Axis",tabComponent(){return(0,t.jsx)(r.I,{labelWidth:20,label:"Use right y-axis",children:(0,t.jsx)(a.K,{value:d===2,label:"Use right y-axis",onChange:u})})}}}:void 0;return(0,t.jsx)(i.$,{...o,color:g||"#000000",customPickers:E})},s=(0,n.cV)(x)},54061:(q,j,e)=>{"use strict";e.d(j,{$:()=>g,A:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(7612),i=e(65229),x=e(84140),s=e(87190),c=e(29675),d=e(95108);const u=({color:E,onChange:m})=>{const[f,p]=(0,r.useState)(E);(0,i.A)(l=>{m(s.MV.asHexString(h.visualization.getColorByName(l)))},500,[f]);const h=(0,c.$j)(),D=(0,c.of)(g),C=(0,r.useMemo)(()=>f.startsWith("rgba")?f:(0,x.A)(h.visualization.getColorByName(E)).toRgbString(),[f,h,E]);return(0,t.jsxs)("div",{className:D.wrapper,children:[(0,t.jsx)(a.p9,{className:D.root,color:C,onChange:p}),(0,t.jsx)(d.A,{theme:h,color:C,onChange:p,className:D.colorInput})]})},g=E=>({wrapper:(0,n.css)({flexGrow:1}),root:(0,n.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${E.shape.radius.default} ${E.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${E.shape.radius.default} ${E.shape.radius.default}`},"&__alpha, &__hue":{height:E.spacing(2),position:"relative"},"&__pointer":{height:E.spacing(2),width:E.spacing(2)}}}),colorInput:(0,n.css)({marginTop:E.spacing(2)})}),o=u},51064:(q,j,e)=>{"use strict";e.d(j,{G:()=>S,X:()=>b});var t=e(74848),n=e(22803),r=e(72181),a=e(76698),i=e(2543),x=e.n(i),s=e(96540),c=e(29675),d=e(4438),u=e(70462),g=e(79784),o=e(95722),E=e(34128),m=e(75606),f=e(99134),p=e(47059),h=e(52977),D=e(70694),C=e(59497),l=e(96691);const v=1e5,y=()=>{},P=()=>Promise.resolve([]),b=4,S=M=>{const{options:O,onChange:R,value:L,placeholder:B,isClearable:F=!1,createCustomValue:I=!1,id:U,width:W,minWidth:A,maxWidth:N,"aria-labelledby":K,autoFocus:V,onBlur:T,disabled:z,loading:w,invalid:H}=M,G=typeof L=="object"?L?.value:L,X=typeof O=="function",k=(0,l.V)(X?O:P),[_,ee]=(0,s.useState)(!1),[J,Z]=(0,s.useState)(!1),[te,ae]=(0,s.useState)(X?[]:O),re=(0,s.useCallback)((Ne,ie)=>{let ve=Ne;if((0,d.D)(ve.length,v,U,K),ie&&I&&!Ne.find(ge=>ge.value===ie)){const ge={label:ie,value:ie,description:(0,u.t)("combobox.custom-value.description","Use custom value")};ve=Ne.slice(0),ve.unshift(ge)}ae(ve)},[I,U,K]),ne=(0,s.useMemo)(()=>X?[]:O.map(Ne=>(0,h.yl)(Ne)),[O,X]),ce=(0,s.useMemo)(()=>{if(X||L==null)return null;const Ne=O.findIndex(ie=>ie.value===G);return Ne===-1?null:Ne},[L,O,G,X]),le=(0,s.useMemo)(()=>L==null?null:ce!==null&&!X?O[ce]:typeof L=="object"?L:{value:L,label:L.toString()},[ce,X,L,O]),he=`downshift-${(0,s.useId)().replace(/:/g,"--")}-menu`,oe=`downshift-${(0,s.useId)().replace(/:/g,"--")}-label`,de=(0,c.of)(D.C3),me={count:te.length,getScrollElement:()=>Ge.current,estimateSize:Ne=>te[Ne].description?D.pg:D.Aj,overscan:b},Pe=(0,r.Te)(me),Ee=(0,s.useMemo)(()=>(0,i.debounce)(Ne=>{k(Ne).then(ie=>{re(ie,Ne),ee(!1),Z(!1)}).catch(ie=>{ie instanceof l.N||(Z(!0),ee(!1))})},200),[k,re]),{isOpen:be,highlightedIndex:Se,getInputProps:Xe,getMenuProps:Qe,getItemProps:we,selectItem:$e}=(0,a.Bp)({menuId:he,labelId:oe,inputId:U,items:te,itemToString:h.yl,selectedItem:le,onSelectedItemChange:({selectedItem:Ne})=>{R(Ne)},defaultHighlightedIndex:ce??0,scrollIntoView:()=>{},onInputValueChange:({inputValue:Ne,isOpen:ie})=>{if(!ie){X&&re([],"");return}if(X)Ne&&I&&re([],Ne),ee(!0),Ee(Ne);else{const ve=(0,h.op)(O,ne,Ne);re(ve,Ne)}},onIsOpenChange:({isOpen:Ne,inputValue:ie})=>{X&&Ne&&ie===""&&(ee(!0),k(ie).then(ve=>{re(ve,ie),ee(!1),Z(!1)}).catch(ve=>{ve instanceof l.N||(Z(!0),ee(!1))}))},onHighlightedIndexChange:({highlightedIndex:Ne,type:ie})=>{ie!==a.Bp.stateChangeTypes.MenuMouseLeave&&Pe.scrollToIndex(Ne)},stateReducer(Ne,ie){let{changes:ve}=ie;const fe=Ne.isOpen===!1&&ve.isOpen===!0,ge=Ne.isOpen===!0&&ve.isOpen===!1;return fe&&ve.inputValue===Ne.inputValue&&(ve={...ve,inputValue:""}),ge&&(ve.selectedItem?ve={...ve,inputValue:(0,h.yl)(ve.selectedItem)}:ve.inputValue!==""&&(ve={...ve,inputValue:""})),ve}}),{inputRef:Fe,floatingRef:Te,floatStyles:Le,scrollRef:Ge}=(0,C.l)(te,be),Me=W==="auto",De=Me?o.D:E.p,Ke=_?"spinner":be?"search":"angle-down",Ie=(be?(0,h.yl)(le):null)||B;return(0,t.jsxs)("div",{className:Me?de.addaptToParent:void 0,children:[(0,t.jsx)(De,{width:Me?void 0:W,...Me?{minWidth:A,maxWidth:N}:{},autoFocus:V,onBlur:T,disabled:z,loading:w,invalid:H,className:de.input,suffix:(0,t.jsxs)(t.Fragment,{children:[!!G&&G===le?.value&&F&&(0,t.jsx)(g.I,{name:"times",className:de.clear,title:(0,u.t)("combobox.clear.title","Clear value"),tabIndex:0,role:"button",onClick:()=>{$e(null)},onKeyDown:Ne=>{(Ne.key==="Enter"||Ne.key===" ")&&$e(null)}}),(0,t.jsx)(g.I,{name:Ke})]}),...Xe({ref:Fe,onChange:y,"aria-labelledby":K,placeholder:Ie})}),(0,t.jsx)(m.ZL,{children:(0,t.jsx)("div",{className:(0,n.cx)(de.menu,!be&&de.menuClosed),style:{...Le},...Qe({ref:Te,"aria-labelledby":K}),children:be&&(0,t.jsxs)(f.P,{showScrollIndicators:!0,maxHeight:"inherit",ref:Ge,padding:.5,children:[!J&&(0,t.jsx)("ul",{style:{height:Pe.getTotalSize()},className:de.menuUlContainer,children:Pe.getVirtualItems().map(Ne=>(0,t.jsx)("li",{"data-index":Ne.index,className:(0,n.cx)(de.optionBasic,de.option,le&&te[Ne.index].value===le.value&&de.optionSelected,Se===Ne.index&&de.optionFocused),style:{height:Ne.size,transform:`translateY(${Ne.start}px)`},...we({item:te[Ne.index],index:Ne.index}),children:(0,t.jsxs)("div",{className:de.optionBody,children:[(0,t.jsx)("span",{className:de.optionLabel,children:te[Ne.index].label??te[Ne.index].value}),te[Ne.index].description&&(0,t.jsx)("span",{className:de.optionDescription,children:te[Ne.index].description})]})},`${te[Ne.index].value}-${Ne.index}`))}),(0,t.jsxs)("div",{"aria-live":"polite",children:[J&&(0,t.jsx)(p.N,{}),te.length===0&&!J&&(0,t.jsx)(p.m,{})]})]})})})]})}},47059:(q,j,e)=>{"use strict";e.d(j,{N:()=>s,m:()=>c});var t=e(74848),n=e(70462),r=e(79784),a=e(90231),i=e(48583),x=e(45565);const s=()=>(0,t.jsxs)(d,{children:[(0,t.jsx)(x.E,{color:"warning",children:(0,t.jsx)(r.I,{name:"exclamation-triangle",size:"md"})}),(0,t.jsx)(n.x,{i18nKey:"combobox.async.error",children:"An error occurred while loading options."})]}),c=()=>(0,t.jsx)(d,{children:(0,t.jsx)(n.x,{i18nKey:"combobox.options.no-found",children:"No options found."})}),d=({children:u})=>(0,t.jsx)(a.a,{padding:2,children:(0,t.jsx)(i.B,{justifyContent:"center",alignItems:"center",direction:"column",children:u})})},52977:(q,j,e)=>{"use strict";e.d(j,{EB:()=>g,op:()=>o,yl:()=>u});var t=e(84139),n=e(82486);const r=/[^ -~]/m,a=/^[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+$/m,i=5,x=25,s=5,c=1e4,d=new t.A({intraMode:1});function u(E){return E==null?"":E.label??E.value.toString()}function g(E){const m=E.toLowerCase();return f=>!E||f.label?.toLowerCase().includes(m)||f.value?.toString().toLowerCase().includes(m)||f.value.toString()===n.A}function o(E,m,f){let p=[];if(f==="")p=E;else if(r.test(f)||a.test(f)||f.length>x||d.split(f).length>s)for(let h=0;h<m.length;h++)m[h].includes(f)&&p.push(E[h]);else{const[h,D,C]=d.search(m,f,i,c);h?.length&&(D&&C?p=C.map(l=>E[D.idx[l]]):p=h.map(l=>E[l]))}return p}},70694:(q,j,e)=>{"use strict";e.d(j,{AK:()=>a,Aj:()=>x,C3:()=>d,pg:()=>s,sh:()=>n,xB:()=>c,zx:()=>r});var t=e(22803);const n=14,r=500,a=8,i=1.5,x=a*2+n*i,s=x+i*n,c=x*8.5,d=u=>({menuClosed:(0,t.css)({display:"none"}),menu:(0,t.css)({label:"combobox-menu",background:u.components.dropdown.background,boxShadow:u.shadows.z3,zIndex:u.zIndex.dropdown,position:"relative",borderRadius:u.shape.radius.default,overflow:"hidden"}),menuUlContainer:(0,t.css)({label:"combobox-menu-ul-container",listStyle:"none"}),optionBasic:(0,t.css)({label:"combobox-option",position:"absolute",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",width:"100%",overflow:"hidden"}),option:(0,t.css)({padding:a,cursor:"pointer",borderRadius:u.shape.radius.default,width:"100%","&:hover":{background:u.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${u.colors.primary.border}`}}}),optionGroup:(0,t.css)({cursor:"default",padding:a,borderTop:`1px solid ${u.colors.border.weak}`}),optionBody:(0,t.css)({label:"combobox-option-body",display:"flex",fontWeight:u.typography.fontWeightMedium,flexDirection:"column",flexGrow:1,overflow:"hidden"}),optionLabel:(0,t.css)({label:"combobox-option-label",textOverflow:"ellipsis",overflow:"hidden",fontSize:n,fontWeight:r,letterSpacing:0}),optionLabelGroup:(0,t.css)({label:"combobox-option-label-group",color:u.colors.text.secondary,fontSize:u.typography.bodySmall.fontSize,fontWeight:u.typography.fontWeightLight}),optionDescription:(0,t.css)({label:"combobox-option-description",fontWeight:u.typography.fontWeightRegular,fontSize:u.typography.bodySmall.fontSize,color:u.colors.text.secondary,lineHeight:i,textOverflow:"ellipsis",overflow:"hidden"}),optionFocused:(0,t.css)({label:"combobox-option-focused",top:0,background:u.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${u.colors.primary.border}`}}),optionSelected:(0,t.css)({background:u.colors.action.selected,"&::before":{backgroundImage:u.colors.gradients.brandVertical,borderRadius:u.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:u.spacing(.5),left:0,top:0}}),clear:(0,t.css)({label:"combobox-clear",cursor:"pointer",pointerEvents:"auto","&:hover":{color:u.colors.text.primary}}),input:(0,t.css)({label:"combobox-input","> div > div:last-child":{pointerEvents:"none"},"& input":{cursor:"pointer"},"& input:focus":{cursor:"text"}}),addaptToParent:(0,t.css)({label:"combobox-addapt-to-parent",maxWidth:"100%",'[class*="input-wrapper-combobox-input"]':{maxWidth:"100%"}})})},82486:(q,j,e)=>{"use strict";e.d(j,{A:()=>t});const t="__GRAFANA_INTERNAL_MULTICOMBOBOX_ALL_OPTION__"},59497:(q,j,e)=>{"use strict";e.d(j,{l:()=>d});var t=e(34743),n=e(83505),r=e(46885),a=e(96540),i=e(91371),x=e(70694);const s=1e5,c=16,d=(g,o)=>{const E=(0,a.useRef)(null),m=(0,a.useRef)(null),f=(0,a.useRef)(null),[p,h]=(0,a.useState)({width:0,height:0}),D=(0,a.useMemo)(()=>u(),[]),C=[(0,t.UU)({crossAxis:!0,boundary:document.body}),(0,t.Ej)({apply({availableWidth:b,availableHeight:S}){const M=b-c,O=S-c,R=Math.max(M,0),L=Math.min(Math.max(O,x.Aj*6),x.xB);h({width:R,height:L})}})],l={reference:E.current,floating:m.current},{floatingStyles:v}=(0,n.we)({strategy:"fixed",open:o,placement:"bottom-start",middleware:C,elements:l,whileElementsMounted:r.ll}),y=(0,a.useMemo)(()=>{let b="";const S=Math.min(g.length,s);for(let O=0;O<S;O++){const R=g[O].label??g[O].value.toString();b=R.length>b.length?R:b}return(0,i.kD)(b,x.sh,x.zx).width+x.AK*2+D},[g,D]),P={...v,width:y,maxWidth:p.width,minWidth:E.current?.offsetWidth,maxHeight:p.height};return{inputRef:E,floatingRef:m,scrollRef:f,floatStyles:P}};function u(){const g=document.createElement("div");g.style.visibility="hidden",g.style.overflow="scroll",document.body.appendChild(g);const o=document.createElement("div");g.appendChild(o);const E=g.offsetWidth-o.offsetWidth;return g.parentNode?.removeChild(g),E}},96691:(q,j,e)=>{"use strict";e.d(j,{N:()=>r,V:()=>n});var t=e(96540);function n(a){const i=(0,t.useRef)(0);return(0,t.useCallback)(s=>{i.current++;const c=i.current;return new Promise((d,u)=>{a(s).then(g=>{c===i.current?d(g):u(new r)}).catch(u)})},[a])}class r extends Error{constructor(){super("This result is stale and is discarded"),this.name="StaleResultError",Object.setPrototypeOf(this,new.target.prototype)}}},91396:(q,j,e)=>{"use strict";e.d(j,{Z:()=>s});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(70462),x=e(54594);const s=({children:d,className:u,closeOnConfirm:g,confirmText:o="Save",confirmVariant:E="primary",disabled:m=!1,onCancel:f,onClick:p,onConfirm:h,size:D="md"})=>{const C=(0,r.useRef)(null),l=(0,r.useRef)(null),[v,y]=(0,r.useState)(!1),[P,b]=(0,r.useState)(!1),S=(0,a.of)(c);(0,r.useEffect)(()=>{v?(l.current?.focus(),b(!0)):P&&(C.current?.focus(),b(!1))},[P,v]);const M=I=>{I&&I.preventDefault(),y(!0),p?.()},O=I=>{I&&I.preventDefault(),y(!1),C.current?.focus(),f?.()},R=I=>{I&&I.preventDefault(),h?.(),g&&y(!1)},L=(0,n.cx)(u,S.mainButton,{[S.mainButtonHide]:v}),B=(0,n.cx)(S.confirmButton,{[S.confirmButtonHide]:!v}),F=(0,n.cx)(S.confirmButtonContainer,{[S.confirmButtonContainerHide]:!v});return(0,t.jsxs)("div",{className:S.container,children:[(0,t.jsx)("span",{className:L,children:typeof d=="string"?(0,t.jsx)(x.$n,{disabled:m,size:D,fill:"text",onClick:M,ref:C,children:d}):r.cloneElement(d,{disabled:m,onClick:M,ref:C})}),(0,t.jsx)("div",{className:F,children:(0,t.jsxs)("span",{className:B,children:[(0,t.jsx)(x.$n,{size:D,variant:E,onClick:R,ref:l,children:o}),(0,t.jsx)(x.$n,{size:D,fill:"text",onClick:O,children:(0,t.jsx)(i.x,{i18nKey:"grafana-ui.confirm-button.cancel",children:"Cancel"})})]})})]})};s.displayName="ConfirmButton";const c=d=>({container:(0,n.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,n.css)({opacity:1,[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,n.css)({opacity:0,[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","visibility"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,n.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,n.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,n.css)({alignItems:"flex-start",background:d.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","transform"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,n.css)({opacity:0,transform:"translateX(100%)",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","transform","visibility"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeIn})},visibility:"hidden"})})},87731:(q,j,e)=>{"use strict";e.d(j,{e:()=>a});var t=e(74848),n=e(54594),r=e(91396);const a=({size:i,disabled:x,onConfirm:s,"aria-label":c,closeOnConfirm:d})=>(0,t.jsx)(r.Z,{confirmText:"Delete",confirmVariant:"destructive",size:i||"md",disabled:x,onConfirm:s,closeOnConfirm:d,children:(0,t.jsx)(n.$n,{"aria-label":c,variant:"destructive",icon:"times",size:i||"sm"})})},57472:(q,j,e)=>{"use strict";e.d(j,{k:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(49785),i=e(58779),x=e(29675),s=e(54594),c=e(86489),d=e(34128),u=e(48583);const g=({body:E,confirmPromptText:m,confirmButtonLabel:f,confirmButtonVariant:p,dismissButtonVariant:h,dismissButtonLabel:D,onConfirm:C,onDismiss:l,onAlternative:v,alternativeButtonLabel:y,description:P,justifyButtons:b="flex-end",disabled:S})=>{const[M,O]=(0,r.useState)(S),R=(0,x.of)(o),L=(0,r.useRef)(null),B=U=>{O(m?.toLowerCase().localeCompare(U.currentTarget.value.toLowerCase())!==0)};(0,r.useEffect)(()=>{L.current?.focus()},[]),(0,r.useEffect)(()=>{O(S?!0:!!m)},[m,S]);const F=async()=>{S===void 0&&O(!0);try{await C()}finally{S===void 0&&O(!1)}},{handleSubmit:I}=(0,a.mN)();return(0,t.jsxs)("form",{onSubmit:I(F),children:[(0,t.jsxs)("div",{className:R.text,children:[E,P?(0,t.jsx)("div",{className:R.description,children:P}):null,m?(0,t.jsx)("div",{className:R.confirmationInput,children:(0,t.jsx)(u.B,{alignItems:"flex-start",children:(0,t.jsx)(c.D,{disabled:S,children:(0,t.jsx)(d.p,{placeholder:`Type "${m}" to confirm`,onChange:B})})})}):null]}),(0,t.jsx)("div",{className:R.buttonsContainer,children:(0,t.jsxs)(u.B,{justifyContent:b,gap:2,wrap:"wrap",children:[(0,t.jsx)(s.$n,{variant:h,onClick:l,fill:"outline",children:D}),(0,t.jsx)(s.$n,{type:"submit",variant:p,disabled:M,ref:L,"data-testid":i.Tp.pages.ConfirmModal.delete,children:f}),v?(0,t.jsx)(s.$n,{variant:"primary",onClick:v,children:y}):null]})})]})},o=E=>({text:(0,n.css)({fontSize:E.typography.h5.fontSize,color:E.colors.text.primary}),description:(0,n.css)({fontSize:E.typography.body.fontSize}),confirmationInput:(0,n.css)({paddingTop:E.spacing(1)}),buttonsContainer:(0,n.css)({paddingTop:E.spacing(3)})})},65164:(q,j,e)=>{"use strict";e.d(j,{u:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(25356),i=e(57472);const x=({isOpen:c,title:d,body:u,description:g,confirmText:o,confirmVariant:E="destructive",confirmationText:m,dismissText:f="Cancel",dismissVariant:p="secondary",alternativeText:h,modalClass:D,icon:C="exclamation-triangle",onConfirm:l,onDismiss:v,onAlternative:y,confirmButtonVariant:P="destructive",disabled:b})=>{const S=(0,r.of)(s);return(0,t.jsx)(a.a,{className:(0,n.cx)(S.modal,D),title:d,icon:C,isOpen:c,onDismiss:v,children:(0,t.jsx)(i.k,{body:u,description:g,confirmButtonLabel:o,dismissButtonLabel:f,dismissButtonVariant:p,confirmPromptText:m,alternativeButtonLabel:h,confirmButtonVariant:P,onConfirm:l,onDismiss:v,onAlternative:y,disabled:b})})},s=()=>({modal:(0,n.css)({width:"500px"})})},41784:(q,j,e)=>{"use strict";e.d(j,{t:()=>s});var t=e(74848),n=e(96540),r=e(29647),a=e(58779),i=e(19224),x=e(75606);const s=n.memo(({x:c,y:d,onClose:u,focusOnOpen:g=!0,renderMenuItems:o,renderHeader:E})=>{const m=(0,n.useRef)(null),[f,p]=(0,n.useState)({});(0,n.useLayoutEffect)(()=>{const v=m.current;if(v){const y=v.getBoundingClientRect(),P=5,b={right:window.innerWidth<c+y.width,bottom:window.innerHeight<d+y.height+P};p({position:"fixed",left:b.right?c-y.width-P:c-P,top:Math.max(0,b.bottom?d-y.height-P:d+P)})}},[c,d]),(0,r.A)(m,()=>{u?.()});const h=E?.(),D=o?.(),C=v=>{g&&v(0)},l=v=>{v.key==="Escape"&&(v.preventDefault(),v.stopPropagation(),u?.())};return(0,t.jsx)(x.ZL,{children:(0,t.jsx)(i.W,{header:h,ref:m,style:f,ariaLabel:a.Tp.components.Menu.MenuComponent("Context"),onOpen:C,onClick:u,onKeyDown:l,children:D})})});s.displayName="ContextMenu"},56016:(q,j,e)=>{"use strict";e.d(j,{n:()=>a});var t=e(74848),n=e(96540),r=e(41784);const a=({children:i,renderMenuItems:x,focusOnOpen:s=!0})=>{const[c,d]=(0,n.useState)(!1),[u,g]=(0,n.useState)({x:0,y:0});return(0,t.jsxs)(t.Fragment,{children:[i({openMenu:o=>{d(!0),g({x:o.pageX,y:o.pageY-window.scrollY})}}),c&&(0,t.jsx)(r.t,{onClose:()=>d(!1),x:u.x,y:u.y,renderMenuItems:x,focusOnOpen:s})]})}},67893:(q,j,e)=>{"use strict";e.d(j,{E:()=>c,A:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(62295),i=e(29675);const x=({children:o})=>{const[E,m]=(0,r.useState)(!1),[f,p]=(0,r.useState)(!1),h=(0,r.useRef)(null),D=(0,r.useRef)(null),C=(0,i.of)(s);return(0,r.useEffect)(()=>{const l=new IntersectionObserver(v=>{v.forEach(y=>{y.target===h.current?m(!y.isIntersecting):y.target===D.current&&p(!y.isIntersecting)})});return[h,D].forEach(v=>{v.current&&l.observe(v.current)}),()=>l.disconnect()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,n.cx)(C.scrollIndicator,C.scrollTopIndicator,{[C.scrollIndicatorVisible]:E})}),(0,t.jsxs)("div",{className:C.scrollContent,children:[(0,t.jsx)("div",{ref:h}),o,(0,t.jsx)("div",{ref:D})]}),(0,t.jsx)("div",{className:(0,n.cx)(C.scrollIndicator,C.scrollBottomIndicator,{[C.scrollIndicatorVisible]:f})})]})},s=o=>({scrollContent:(0,n.css)({flex:1,position:"relative"}),scrollIndicator:(0,n.css)({height:o.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[o.transitions.handleMotion("no-preference","reduce")]:{transition:o.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,n.css)({background:`linear-gradient(0deg, transparent, ${o.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,n.css)({background:`linear-gradient(180deg, transparent, ${o.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,n.css)({opacity:1})}),c=({autoHide:o=!1,autoHideTimeout:E=200,setScrollTop:m,className:f,testId:p,autoHeightMin:h="0",autoHeightMax:D="100%",hideTracksWhenNotNeeded:C=!1,hideHorizontalTrack:l,hideVerticalTrack:v,scrollRefCallback:y,showScrollIndicators:P=!1,updateAfterMountMs:b,scrollTop:S,onScroll:M,children:O,divId:R})=>{const L=(0,r.useRef)(null),B=(0,i.of)(u);(0,r.useEffect)(()=>{L.current&&y&&y(L.current.view)},[L,y]),g(L.current,S),(0,r.useEffect)(()=>{b&&setTimeout(()=>{const V=L.current;V?.update&&V.update()},b)},[b]);function F(V,T,z){return z.style&&T&&(z.style.display="none"),(0,t.jsx)("div",{...z,className:V})}const I=(0,r.useCallback)(V=>F("track-horizontal",l,V),[l]),U=(0,r.useCallback)(V=>F("track-vertical",v,V),[v]),W=(0,r.useCallback)(V=>(0,t.jsx)("div",{...V,className:"thumb-horizontal"}),[]),A=(0,r.useCallback)(V=>(0,t.jsx)("div",{...V,className:"thumb-vertical"}),[]),N=(0,r.useCallback)(V=>(V.style&&V.style.WebkitOverflowScrolling==="touch"&&(V.style.WebkitOverflowScrolling="auto"),(0,t.jsx)("div",{...V,className:"scrollbar-view",id:R})),[R]),K=(0,r.useCallback)(()=>{L.current&&m&&m(L.current.getValues())},[m]);return(0,t.jsx)(a.Ay,{"data-testid":p,ref:L,className:(0,n.cx)(B.customScrollbar,f,{[B.scrollbarWithScrollIndicators]:P}),onScrollStop:K,autoHeight:!0,autoHide:o,autoHideTimeout:E,hideTracksWhenNotNeeded:C,autoHeightMax:D,autoHeightMin:h,renderTrackHorizontal:I,renderTrackVertical:U,renderThumbHorizontal:W,renderThumbVertical:A,renderView:N,onScroll:M,children:P?(0,t.jsx)(x,{children:O}):O})},d=c,u=o=>({customScrollbar:(0,n.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:o.shape.borderRadius(2),width:`${o.spacing(1)} !important`,right:0,bottom:o.spacing(.25),top:o.spacing(.25)},".track-horizontal":{borderRadius:o.shape.borderRadius(2),height:`${o.spacing(1)} !important`,right:o.spacing(.25),bottom:o.spacing(.25),left:o.spacing(.25)},".thumb-vertical":{background:o.colors.action.focus,borderRadius:o.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:o.colors.action.focus,borderRadius:o.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,n.css)({".scrollbar-view":{position:"static !important"}})});function g(o,E){(0,r.useEffect)(()=>{o&&E!=null&&o.scrollTop(E)},[E,o])}},21891:(q,j,e)=>{"use strict";e.d(j,{R:()=>r});var t=e(74848),n=e(54594);function r({link:a,buttonProps:i}){return(0,t.jsx)("a",{href:a.href,target:a.target,rel:"noreferrer",onClick:a.onClick?x=>{!(x.ctrlKey||x.metaKey||x.shiftKey)&&a.onClick&&(x.preventDefault(),a.onClick(x))}:void 0,children:(0,t.jsx)(n.$n,{icon:a.target==="_blank"?"external-link-alt":"link",variant:"primary",size:"sm",...i,children:a.title})})}},76174:(q,j,e)=>{"use strict";e.d(j,{l:()=>M});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(28848),s=e.n(x),c=e(96540),d=e(80292),u=e(75226),g=e(29317),o=e(47180),E=e(46399),m=e(32254),f=e(29675),p=e(21573),h=e(34128),D=e(75606),C=e(99134),l=e(79712);class v{getBoundingClientRect(){const L=window.getSelection(),B=L&&L.anchorNode;return B&&B.parentElement?B.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const y=(R,L)=>R-L*Math.floor(R/L),P={builtInVariable:{pattern:/(\${\S+?})/}},b=[(0,m.D)({onlyIn:R=>"type"in R&&R.type==="code_block",getSyntax:()=>"links"},{...s().languages,links:P})],S=R=>({input:(0,h.n)({theme:R,invalid:!1}).input,editor:(0,n.css)({".token.builtInVariable":{color:R.colors.success.text},".token.variable":{color:R.colors.primary.text}}),suggestionsWrapper:(0,n.css)({boxShadow:R.shadows.z2}),wrapperOverrides:(0,n.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),M=(0,c.memo)(({value:R,onChange:L,suggestions:B,placeholder:F="http://your-grafana.com/d/000000010/annotations"})=>{const I=(0,c.useRef)(null),U=(0,f.of)(S),[W,A]=(0,c.useState)(!1),[N,K]=(0,c.useState)(0),[V,T]=(0,c.useState)((0,p.mO)(R)),z=(0,d.A)(V),[w,H]=(0,c.useState)(0),G=(0,c.useRef)(null);(0,c.useEffect)(()=>{G.current?.scrollTo(0,w)},[w]);const X=[(0,r.cY)(({rects:ne})=>({alignmentAxis:ne.reference.width})),(0,r.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:k,floatingStyles:_}=(0,a.we)({open:W,placement:"bottom-start",onOpenChange:A,middleware:X,whileElementsMounted:i.ll,strategy:"fixed"}),ee=(0,c.useRef)({showingSuggestions:W,suggestions:B,suggestionsIndex:N,linkUrl:V,onChange:L});ee.current={showingSuggestions:W,suggestions:B,suggestionsIndex:N,linkUrl:V,onChange:L};const J=(0,c.useRef)(null);(0,c.useEffect)(()=>{H(O(J.current,N))},[N]);const Z=c.useCallback((ne,ce)=>{if(!ee.current.showingSuggestions){if(ne.key==="="||ne.key==="$"||ne.keyCode===32&&ne.ctrlKey){const le=new v;return k.setReference(le),A(!0)}return ce()}switch(ne.key){case"Backspace":ee.current.linkUrl.focusText.getText().length===1&&ce();case"Escape":return A(!1),K(0);case"Enter":return ne.preventDefault(),ae(ee.current.suggestions[ee.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ne.preventDefault();const le=ne.key==="ArrowDown"?1:-1;return K(he=>y(he+le,ee.current.suggestions.length));default:return ce()}},[]);(0,c.useEffect)(()=>{z&&z.selection.isFocused&&!V.selection.isFocused&&ee.current.onChange(u.default.serialize(V))},[V,z]);const te=c.useCallback(({value:ne})=>{T(ne)},[]),ae=(ne,ce=I.current)=>{const he=re()==="$";ne.origin!==o.$0.Template||ne.value===E.c.includeVars?ce.insertText(`${he?"":"$"}{${ne.value}}`):ce.insertText(`${he?"":"$"}{${ne.value}:queryparam}`),T(ce.value),A(!1),K(0),ee.current.onChange(u.default.serialize(ce.value))},re=()=>{const ne=document.getElementById("data-link-input");let ce="",le,he;return window.getSelection&&(le=window.getSelection(),le&&le.rangeCount>0&&(he=le.getRangeAt(0).cloneRange(),he.collapse(!0),he.setStart(ne,0),ce=he.toString().slice(-1))),ce};return(0,t.jsx)("div",{className:U.wrapperOverrides,children:(0,t.jsx)("div",{className:"slate-query-field__wrapper",children:(0,t.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[W&&(0,t.jsx)(D.ZL,{children:(0,t.jsx)("div",{ref:k.setFloating,style:_,children:(0,t.jsx)(C.P,{maxHeight:"300px",ref:G,onScroll:ne=>H(ne.currentTarget.scrollTop),children:(0,t.jsx)(l.k,{activeRef:J,suggestions:ee.current.suggestions,onSuggestionSelect:ae,onClose:()=>A(!1),activeIndex:N})})})}),(0,t.jsx)(g.Editor,{schema:p.yx,ref:I,placeholder:F,value:ee.current.linkUrl,onChange:te,onKeyDown:(ne,ce,le)=>Z(ne,le),plugins:b,className:(0,n.cx)(U.editor,U.input,(0,n.css)({padding:"3px 8px"}))})]})})})});M.displayName="DataLinkInput";function O(R,L){return(R?.clientHeight??0)*L}},79712:(q,j,e)=>{"use strict";e.d(j,{k:()=>u});var t=e(74848),n=e(96540),r=e(22803),a=e(2543),i=e.n(a),x=e(37151),s=e(29675),c=e(79878);const d=o=>({list:(0,r.css)({borderBottom:`1px solid ${o.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,r.css)({background:o.colors.background.primary,width:"250px"}),item:(0,r.css)({background:"none",padding:"2px 8px",userSelect:"none",color:o.colors.text.primary,cursor:"pointer","&:hover":{background:o.colors.action.hover}}),label:(0,r.css)({color:o.colors.text.secondary}),activeItem:(0,r.css)({background:o.colors.background.secondary,"&:hover":{background:o.colors.background.secondary}}),itemValue:(0,r.css)({fontFamily:o.typography.fontFamilyMonospace,fontSize:o.typography.size.sm})}),u=({suggestions:o,...E})=>{const m=(0,n.useRef)(null);(0,x.A)(m,()=>{E.onClose&&E.onClose()});const f=(0,n.useMemo)(()=>(0,a.groupBy)(o,h=>h.origin),[o]),p=(0,s.of)(d);return(0,t.jsx)("div",{role:"menu",ref:m,className:p.wrapper,children:Object.keys(f).map((h,D)=>{const C=D===0?0:Object.keys(f).reduce((l,v,y)=>y>=D?l:l+f[v].length,0);return(0,n.createElement)(g,{...E,suggestions:f[h],label:`${(0,a.capitalize)(h)}`,activeIndex:E.activeIndex,activeIndexOffset:C,key:h})})})};u.displayName="DataLinkSuggestions";const g=n.memo(({activeIndex:o,activeIndexOffset:E,label:m,onClose:f,onSuggestionSelect:p,suggestions:h,activeRef:D})=>{const C=(0,s.of)(d);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(c.B,{className:C.list,items:h,renderItem:(l,v)=>{const y=v+E===o;return(0,t.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,r.cx)(C.item,y&&C.activeItem),ref:y?D:void 0,onClick:()=>{p(l)},title:l.documentation,children:(0,t.jsxs)("span",{className:C.itemValue,children:[(0,t.jsx)("span",{className:C.label,children:m})," ",l.label]})})}})})});g.displayName="DataLinkSuggestionsList"},63006:(q,j,e)=>{"use strict";e.d(j,{e:()=>d});var t=e(74848),n=e(22803),r=e(58779),a=e(29675),i=e(27821),x=e(56016),s=e(76795),c=e(36529);const d=({children:g,links:o,actions:E,style:m})=>{const f=(0,a.of)(u),p=[{items:(0,i.J)(o),label:o().length?"Data links":""}],h=!!E?.length;h&&p.push({items:(0,i.H)(E),label:"Actions"});const D=p[0].items.length,C=()=>p.map((v,y)=>(0,t.jsx)(s.r,{label:v.label,children:(v.items||[]).map((P,b)=>(0,t.jsx)(c.D,{url:P.url,label:P.label,target:P.target,icon:P.icon,active:P.active,onClick:P.onClick,className:f.itemWrapper},`${v.label}-${y}-${b}}`))},`${v.label}${y}`)),l=(0,n.css)({cursor:"context-menu"});if(D>1||h)return(0,t.jsx)(x.n,{renderMenuItems:C,children:({openMenu:v})=>g({openMenu:v,targetClassName:l})});{const v=o()[0];return(0,t.jsx)("a",{href:v.href,onClick:v.onClick,target:v.target,title:v.title,style:{...m,overflow:"hidden",display:"flex"},"data-testid":r.Tp.components.DataLinksContextMenu.singleLink,children:g({})})}},u=g=>({itemWrapper:(0,n.css)({fontSize:12})})},99153:(q,j,e)=>{"use strict";e.d(j,{e:()=>p});var t=e(74848),n=e(96540),r=e(70462),a=e(54594),i=e(25356),x=e(22803),s=e(29675),c=e(86489),d=e(34128),u=e(29010),g=e(76174);const o=h=>({listItem:(0,x.css)({marginBottom:h.spacing()}),infoText:(0,x.css)({paddingBottom:h.spacing(2),marginLeft:"66px",color:h.colors.text.secondary})}),E=(0,n.memo)(({index:h,value:D,onChange:C,suggestions:l,isLast:v,showOneClick:y=!1})=>{const P=(0,s.of)(o),b=(R,L)=>{C(h,{...D,url:R},L)},S=R=>{C(h,{...D,title:R.target.value})},M=()=>{C(h,{...D,targetBlank:!D.targetBlank})},O=()=>{C(h,{...D,oneClick:!D.oneClick})};return(0,t.jsxs)("div",{className:P.listItem,children:[(0,t.jsx)(c.D,{label:"Title",children:(0,t.jsx)(d.p,{value:D.title,onChange:S,placeholder:"Show details"})}),(0,t.jsx)(c.D,{label:"URL",children:(0,t.jsx)(g.l,{value:D.url,onChange:b,suggestions:l})}),(0,t.jsx)(c.D,{label:"Open in new tab",children:(0,t.jsx)(u.d,{value:D.targetBlank||!1,onChange:M})}),y&&(0,t.jsx)(c.D,{label:(0,r.t)("grafana-ui.data-link-inline-editor.one-click","One click"),description:(0,r.t)("grafana-ui.data-link-editor-modal.one-click-description","Only one link can have one click enabled at a time"),children:(0,t.jsx)(u.d,{value:D.oneClick||!1,onChange:O})}),v&&(0,t.jsx)("div",{className:P.infoText,children:(0,t.jsx)(r.x,{i18nKey:"grafana-ui.data-link-editor.info",children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})})]})});E.displayName="DataLinkEditor";const m=({link:h,index:D,onSave:C,onCancel:l,getSuggestions:v,showOneClick:y})=>{const[P,b]=(0,n.useState)(h);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E,{value:P,index:D,isLast:!1,onChange:(S,M)=>{b(M)},suggestions:v(),showOneClick:y}),(0,t.jsxs)(i.a.ButtonRow,{children:[(0,t.jsx)(a.$n,{variant:"secondary",onClick:()=>l(D),fill:"outline",children:(0,t.jsx)(r.x,{i18nKey:"grafana-ui.data-link-editor-modal.cancel",children:"Cancel"})}),(0,t.jsx)(a.$n,{onClick:()=>{C(D,P)},disabled:P.title.trim()===""||P.url.trim()==="",children:(0,t.jsx)(r.x,{i18nKey:"grafana-ui.data-link-editor-modal.save",children:"Save"})})]})]})};var f=e(48205);const p=({links:h,getSuggestions:D,showOneClick:C=!1,...l})=>(0,t.jsx)(f.J,{type:"link",items:h,...l,children:(v,y,P,b)=>(0,t.jsx)(m,{index:y,link:v??{title:"",url:""},data:l.data,onSave:P,onCancel:b,getSuggestions:D,showOneClick:C})})},48205:(q,j,e)=>{"use strict";e.d(j,{J:()=>f});var t=e(74848),n=e(22803),r=e(57095),a=e(2543),i=e(96540),x=e(29675),s=e(70462),c=e(54594),d=e(25356),u=e(66384),g=e(79784),o=e(99764);function E({item:h,onEdit:D,onRemove:C,index:l,itemKey:v}){const y=(0,x.of)(m),{title:P="",oneClick:b=!1}=h,S=h.url??h.fetch?.url??"",M=P.trim()!=="",O=S.trim()!=="";return(0,t.jsx)(r.Draggable,{draggableId:v,index:l,children:R=>(0,i.createElement)("div",{className:(0,n.cx)(y.wrapper,y.dragRow),ref:R.innerRef,...R.draggableProps,key:l},(0,t.jsxs)("div",{className:y.linkDetails,children:[(0,t.jsx)("div",{className:(0,n.cx)(y.url,!M&&y.notConfigured),children:M?P:(0,s.t)("grafana-ui.data-links-inline-editor.title-not-provided","Title not provided")}),(0,t.jsx)("div",{className:(0,n.cx)(y.url,!O&&y.notConfigured),title:S,children:O?S:(0,s.t)("grafana-ui.data-links-inline-editor.url-not-provided","Data link url not provided")})]}),(0,t.jsxs)("div",{className:y.icons,children:[b&&(0,t.jsx)(u.E,{color:"blue",text:(0,s.t)("grafana-ui.data-links-inline-editor.one-click","One click"),tooltip:(0,s.t)("grafana-ui.data-links-inline-editor.one-click-enabled","One click enabled")}),(0,t.jsx)(o.K,{name:"pen",onClick:D,className:y.icon,tooltip:(0,s.t)("grafana-ui.data-links-inline-editor.tooltip-edit","Edit")}),(0,t.jsx)(o.K,{name:"trash-alt",onClick:C,className:y.icon,tooltip:(0,s.t)("grafana-ui.data-links-inline-editor.tooltip-remove","Remove")}),(0,t.jsx)("div",{className:y.dragIcon,...R.dragHandleProps,children:(0,t.jsx)(g.I,{name:"draggabledots",size:"lg"})})]}))},v)}const m=h=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",padding:"5px 0 5px 10px",borderRadius:h.shape.radius.default,background:h.colors.background.secondary,gap:8}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,n.css)({color:h.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:h.colors.text.primary,fontSize:h.typography.size.sm,fontWeight:h.typography.fontWeightMedium}),url:(0,n.css)({color:h.colors.text.secondary,fontSize:h.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,n.css)({position:"relative",margin:"8px"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,n.css)({cursor:"grab",color:h.colors.text.secondary,margin:h.spacing(0,.5)}),icon:(0,n.css)({color:h.colors.text.secondary})});function f({type:h,items:D,onChange:C,data:l,children:v}){const[y,P]=(0,i.useState)(null),[b,S]=(0,i.useState)(!1),[M,O]=(0,i.useState)([]);(0,i.useEffect)(()=>{O(D??[])},[D]);const R=(0,x.of)(p),L=y!==null,B=(N,K)=>{if(b){const T=K.title,z=K.url??K.fetch?.url??"";if(T.trim()===""&&z.trim()===""){S(!1),P(null);return}else P(null),S(!1)}K.oneClick===!0&&M.forEach(T=>{T.oneClick&&(T.oneClick=!1)});const V=(0,a.cloneDeep)(M);V[N]=K,C(V),P(null)},F=N=>{b&&S(!1),P(null)},I=()=>{let N=(0,a.cloneDeep)(M);P(N.length),S(!0)},U=N=>{const K=(0,a.cloneDeep)(M);K.splice(N,1),C(K)},W=N=>{if(D==null||N.destination==null)return;const K=(0,a.cloneDeep)(M),V=K[N.source.index];K.splice(N.source.index,1),K.splice(N.destination.index,0,V),O(K),C(K)},A=N=>{let K="";switch(h){case"link":K=N==="edit"?(0,s.t)("grafana-ui.data-links-inline-editor.edit-link","Edit link"):(0,s.t)("grafana-ui.data-links-inline-editor.add-link","Add link");break;case"action":K=N==="edit"?(0,s.t)("grafana-ui.action-editor.inline.edit-action","Edit action"):(0,s.t)("grafana-ui.action-editor.inline.add-action","Add action");break}return K};return(0,t.jsxs)("div",{className:R.container,children:[(0,t.jsx)(r.DragDropContext,{onDragEnd:W,children:(0,t.jsx)(r.Droppable,{droppableId:"sortable-links",direction:"vertical",children:N=>(0,t.jsxs)("div",{className:R.wrapper,ref:N.innerRef,...N.droppableProps,children:[M.map((K,V)=>{const T=`${K.title}/${V}`;return(0,t.jsx)(E,{index:V,item:K,onChange:B,onEdit:()=>P(V),onRemove:()=>U(V),data:l,itemKey:T},T)}),N.placeholder]})})}),L&&y!==null&&(0,t.jsx)(d.a,{title:A(b?"add":"edit"),isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{F(y)},children:v(M[y],y,B,F)}),(0,t.jsx)(c.$n,{size:"sm",icon:"plus",onClick:I,variant:"secondary",className:R.button,children:A("add")})]})}const p=h=>({container:(0,n.css)({position:"relative"}),wrapper:(0,n.css)({marginBottom:h.spacing(2),display:"flex",flexDirection:"column"}),button:(0,n.css)({marginLeft:h.spacing(1)})})},66265:(q,j,e)=>{"use strict";e.d(j,{K:()=>c});var t=e(74848),n=e(70462),r=e(54594),a=e(60484),i=e(77222),x=e(34128),s=e(50926);const c=({hasCert:d,label:u,onChange:g,onClick:o,placeholder:E})=>(0,t.jsxs)(i.C,{children:[(0,t.jsx)(a.I,{label:u,labelWidth:14,disabled:d,children:d?(0,t.jsx)(x.p,{type:"text",value:"configured",width:24}):(0,t.jsx)(s.f,{rows:7,onChange:g,placeholder:E,required:!0})}),d&&(0,t.jsx)(r.$n,{variant:"secondary",onClick:o,style:{marginLeft:4},children:(0,t.jsx)(n.x,{i18nKey:"grafana-ui.data-source-settings.cert-key-reset",children:"Reset"})})]})},5790:(q,j,e)=>{"use strict";e.d(j,{P:()=>m});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(96540),x=e(29675),s=e(70462),c=e(54594),d=e(65360),u=e(79784),g=e(25476);const o=()=>({layout:(0,n.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),E=({header:p,onBlur:h,onChange:D,onRemove:C,onReset:l})=>{const v=(0,x.of)(o);return(0,t.jsxs)("div",{className:v.layout,children:[(0,t.jsx)(d.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:p.name||"",onChange:y=>D({...p,name:y.target.value}),onBlur:h}),(0,t.jsx)(g.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:p.configured,value:p.value,labelWidth:5,inputWidth:p.configured?11:12,placeholder:"Header Value",onReset:()=>l(p.id),onChange:y=>D({...p,value:y.target.value}),onBlur:h}),(0,t.jsx)(c.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:y=>C(p.id),children:(0,t.jsx)(u.I,{name:"trash-alt"})})]})};E.displayName="CustomHeaderRow";class m extends i.PureComponent{constructor(h){super(h),this.state={headers:[]},this.updateSettings=()=>{const{headers:v}=this.state,y=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([b,S])=>!b.startsWith("httpHeaderName"))),P=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([b,S])=>!b.startsWith("httpHeaderValue")));for(const[b,S]of v.entries())y[`httpHeaderName${b+1}`]=S.name,S.configured||(P[`httpHeaderValue${b+1}`]=S.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:y,secureJsonData:P})},this.onHeaderAdd=()=>{this.setState(v=>({headers:[...v.headers,{id:(0,r.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(v,y)=>{this.setState(({headers:P})=>({headers:P.map((b,S)=>v!==S?b:{...y})}))},this.onHeaderReset=v=>{this.setState(({headers:y})=>({headers:y.map((P,b)=>P.id!==v?P:{...P,value:"",configured:!1})}))},this.onHeaderRemove=v=>{this.setState(({headers:y})=>({headers:y.filter(P=>P.id!==v)}),this.updateSettings)};const{jsonData:D,secureJsonData:C,secureJsonFields:l}=this.props.dataSourceConfig;this.state={headers:Object.keys(D).sort().filter(v=>v.startsWith("httpHeaderName")).map((v,y)=>({id:(0,r.uniqueId)(),name:D[v],value:C!==void 0?C[v]:"",configured:l&&l[`httpHeaderValue${y+1}`]||!1}))}}render(){const{headers:h}=this.state,{dataSourceConfig:D}=this.props;return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)("h6",{children:(0,t.jsx)(s.x,{i18nKey:"grafana-ui.data-source-settings.custom-headers-title",children:"Custom HTTP Headers"})})}),(0,t.jsx)("div",{children:h.map((C,l)=>(0,t.jsx)(E,{header:C,onChange:v=>{this.onHeaderChange(l,v)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},C.id))}),!D.readOnly&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(c.$n,{variant:"secondary",icon:"plus",type:"button",onClick:C=>{this.onHeaderAdd()},children:(0,t.jsx)(s.x,{i18nKey:"grafana-ui.data-source-settings.custom-headers-add",children:"Add header"})})})]})}}var f=null},98378:(q,j,e)=>{"use strict";e.d(j,{t:()=>R});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(70462),s=e(37e3),c=e(65360),d=e(79172),u=e(60484),g=e(92732),o=e(79784),E=e(44826),m=e(29010),f=e(32319),p=e(45565),h=e(25476);const D=({dataSourceConfig:L,onChange:B})=>{const F=L.secureJsonData?L.secureJsonData.basicAuthPassword:"",I=()=>{B({...L,secureJsonData:{...L.secureJsonData,basicAuthPassword:""},secureJsonFields:{...L.secureJsonFields,basicAuthPassword:!1}})},U=W=>{B({...L,secureJsonData:{...L.secureJsonData,basicAuthPassword:W.currentTarget.value}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.I,{disabled:L.readOnly,children:(0,t.jsx)(c.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:L.basicAuthUser,onChange:W=>B({...L,basicAuthUser:W.currentTarget.value})})}),(0,t.jsx)(u.I,{disabled:L.readOnly,children:(0,t.jsx)(h.L,{isConfigured:!!(L.secureJsonFields&&L.secureJsonFields.basicAuthPassword),value:F||"",inputWidth:18,labelWidth:10,onReset:I,onChange:U})})]})};var C=e(5790);const l=26,v=({dataSourceConfig:L,onChange:B,showForwardOAuthIdentityOption:F=!0})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(u.I,{label:"TLS Client Auth",labelWidth:l,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-tls-client-auth",value:L.jsonData.tlsAuth||!1,onChange:I=>B({...L.jsonData,tlsAuth:I.currentTarget.checked})})}),(0,t.jsx)(u.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:l,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-ca-cert",value:L.jsonData.tlsAuthWithCACert||!1,onChange:I=>B({...L.jsonData,tlsAuthWithCACert:I.currentTarget.checked})})})]}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(u.I,{label:"Skip TLS Verify",labelWidth:l,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-skip-tls-verify",value:L.jsonData.tlsSkipVerify||!1,onChange:I=>B({...L.jsonData,tlsSkipVerify:I.currentTarget.checked})})})}),F&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(u.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:l,disabled:L.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-forward-oauth",value:L.jsonData.oauthPassThru||!1,onChange:I=>B({...L.jsonData,oauthPassThru:I.currentTarget.checked})})})})]});var y=e(75863),P=e(82330);const b=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],S={label:"Server (default)",value:"proxy"},M=()=>(0,t.jsxs)(s.F,{severity:"info",title:"",topSpacing:3,children:[(0,t.jsx)("p",{children:(0,t.jsxs)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.access-help-details",children:["Access mode controls how requests to the data source will be handled.",(0,t.jsxs)("strong",{children:["\xA0",(0,t.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]})}),(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.server-mode-title",children:(0,t.jsx)(p.E,{weight:"medium",children:"Server access mode (Default):"})}),(0,t.jsx)("p",{children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.server-mode-description",children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."})}),(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.browser-mode-title",children:(0,t.jsx)(p.E,{weight:"medium",children:"Browser access mode:"})}),(0,t.jsx)("p",{children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.browser-mode-description",children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})})]}),O=26,R=L=>{const{defaultUrl:B,dataSourceConfig:F,onChange:I,showAccessOptions:U,sigV4AuthToggleEnabled:W,showForwardOAuthIdentityOption:A,azureAuthSettings:N,renderSigV4Editor:K,secureSocksDSProxyEnabled:V,urlLabel:T,urlDocs:z}=L,[w,H]=(0,r.useState)(!1),[G,X]=(0,r.useState)(!1),k=(0,i.$j)();let _;const ee=(0,r.useCallback)(ce=>{const le=N?.azureAuthSupported&&N.getAzureAuthEnabled(F)||!1;if(X(le),le){const he=F.jsonData.oauthPassThru!==void 0?F.jsonData.oauthPassThru:!1;ce={...ce,jsonData:{...F.jsonData,oauthPassThru:le?!1:he}}}I({...F,...ce})},[N,F,I]);switch(F.access){case"direct":_=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.direct-url-tooltip",children:["Your access method is ",(0,t.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser."]}),z]});break;case"proxy":_=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.proxy-url-tooltip",children:["Your access method is ",(0,t.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server."]}),z]});break;default:_=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.default-url-tooltip",children:"Specify a complete HTTP URL (for example http://your_server:8080)"}),z]})}const J=(0,t.jsx)(E.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:b,value:b.filter(ce=>ce.value===F.access)[0]||S,onChange:ce=>ee({access:ce.value}),disabled:F.readOnly}),Z=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(F.url),te=(0,n.css)({boxShadow:`inset 0 0px 5px ${k.v1.palette.red}`}),ae=(0,n.cx)({"width-20":!0,[te]:!Z}),re=(0,r.useId)(),ne=(0,t.jsx)(g.p,{id:re,className:ae,placeholder:B,value:F.url,"data-testid":a.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:ce=>ee({url:ce.currentTarget.value}),disabled:F.readOnly});return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.heading",children:"HTTP"})}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(c.z,{interactive:!!z,label:T??"URL",labelWidth:13,tooltip:_,inputEl:ne})}),U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(c.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:J})}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>H(ce=>!ce),children:(0,t.jsxs)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.access-help",children:["Help\xA0",(0,t.jsx)(o.I,{name:w?"angle-down":"angle-right",style:{marginBottom:0}})]})})})]}),w&&(0,t.jsx)(M,{})]}),F.access==="proxy"&&(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(d.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.allowed-cookies",children:"Allowed cookies"})}),(0,t.jsx)(f.u,{tags:F.jsonData.keepCookies,width:40,onChange:ce=>ee({jsonData:{...F.jsonData,keepCookies:ce}}),disabled:F.readOnly})]}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(c.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:F.jsonData.timeout,onChange:ce=>{ee({jsonData:{...F.jsonData,timeout:parseInt(ce.currentTarget.value,10)}})},disabled:F.readOnly})})]})]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.auth",children:"Auth"})}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(u.I,{label:"Basic auth",labelWidth:O,disabled:F.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-basic-auth",value:F.basicAuth,onChange:ce=>{ee({basicAuth:ce.currentTarget.checked})}})}),(0,t.jsx)(u.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:O,disabled:F.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-with-credentials",value:F.withCredentials,onChange:ce=>{ee({withCredentials:ce.currentTarget.checked})}})})]}),N?.azureAuthSupported&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(u.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:O,disabled:F.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-azure-auth",value:G,onChange:ce=>{ee(N.setAzureAuthEnabled(F,ce.currentTarget.checked))}})})}),W&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(u.I,{label:"SigV4 auth",labelWidth:O,disabled:F.readOnly,children:(0,t.jsx)(m.K,{id:"http-settings-sigv4-auth",value:F.jsonData.sigV4Auth||!1,onChange:ce=>{ee({jsonData:{...F.jsonData,sigV4Auth:ce.currentTarget.checked}})}})})}),F.access==="proxy"&&(0,t.jsx)(v,{dataSourceConfig:F,onChange:ce=>ee({jsonData:ce}),showForwardOAuthIdentityOption:G?!1:A})]}),F.basicAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h6",{children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.data-source-http-settings.basic-auth",children:"Basic Auth Details"})}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)(D,{...L})})]}),N?.azureAuthSupported&&G&&N.azureSettingsUI&&(0,t.jsx)(N.azureSettingsUI,{dataSourceConfig:F,onChange:I}),F.jsonData.sigV4Auth&&W&&K,(F.jsonData.tlsAuth||F.jsonData.tlsAuthWithCACert)&&(0,t.jsx)(P.j,{dataSourceConfig:F,onChange:I}),F.access==="proxy"&&(0,t.jsx)(C.P,{dataSourceConfig:F,onChange:I})]}),V&&(0,t.jsx)(y.Y,{options:F,onOptionsChange:I})]})}},75863:(q,j,e)=>{"use strict";e.d(j,{Y:()=>i});var t=e(74848),n=e(29010),r=e(70462),a=e(60484);function i({options:x,onOptionsChange:s}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:(0,t.jsx)(r.x,{i18nKey:"grafana-ui.data-source-settings.secure-socks-heading",children:"Secure Socks Proxy"})}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy.",children:(0,t.jsx)(n.K,{value:x.jsonData.enableSecureSocksProxy??!1,onChange:c=>s({...x,jsonData:{...x.jsonData,enableSecureSocksProxy:c.currentTarget.checked}})})})})})})]})}},82330:(q,j,e)=>{"use strict";e.d(j,{j:()=>c});var t=e(74848),n=e(22803),r=e(70462),a=e(65360),i=e(79784),x=e(6736),s=e(66265);const c=({dataSourceConfig:d,onChange:u})=>{const g=d.secureJsonFields&&d.secureJsonFields.tlsCACert,o=d.secureJsonFields&&d.secureJsonFields.tlsClientCert,E=d.secureJsonFields&&d.secureJsonFields.tlsClientKey,m=d.jsonData&&d.jsonData.serverName,f=D=>C=>{C.preventDefault();const l={...d.secureJsonFields};l[D]=!1,u({...d,secureJsonFields:l})},p=D=>C=>{const l={...d.secureJsonData};l[D]=C.currentTarget.value,u({...d,secureJsonData:l})},h=D=>{const C={...d.jsonData,serverName:D.currentTarget.value};u({...d,jsonData:C})};return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:(0,n.cx)("gf-form",(0,n.css)({alignItems:"baseline"})),children:[(0,t.jsx)("h6",{children:(0,t.jsx)(r.x,{i18nKey:"grafana-ui.data-source-settings.tls-heading",children:"TLS/SSL Auth Details"})}),(0,t.jsx)(x.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info",children:(0,t.jsx)(i.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{children:[d.jsonData.tlsAuthWithCACert&&(0,t.jsx)(s.K,{hasCert:!!g,onChange:p("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:f("tlsCACert")}),d.jsonData.tlsAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:m&&d.jsonData.serverName,onChange:h})}),(0,t.jsx)(s.K,{hasCert:!!o,label:"Client Cert",onChange:p("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:f("tlsClientCert")}),(0,t.jsx)(s.K,{hasCert:!!E,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:p("tlsClientKey"),onClick:f("tlsClientKey")})]})]})]})}},34783:(q,j,e)=>{"use strict";e.d(j,{l:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(21497),i=e(29675),x=e(77576),s=e(79784),c=e(33627);const d=(0,r.memo)(o=>{const E=(0,i.of)(g),{isOpen:m,onClose:f}=o;return m?(0,t.jsx)(x.N,{useCapture:!0,includeButtonPress:!1,onClick:f,children:(0,t.jsx)("div",{className:E.modal,"data-testid":"date-picker",children:(0,t.jsx)(u,{...o})})}):null});d.displayName="DatePicker";const u=(0,r.memo)(({value:o,minDate:E,maxDate:m,onChange:f})=>{const p=(0,i.of)(c.h2);return(0,t.jsx)(a.Ay,{className:p.body,tileClassName:p.title,value:o||new Date,minDate:E,maxDate:m,nextLabel:(0,t.jsx)(s.I,{name:"angle-right"}),prevLabel:(0,t.jsx)(s.I,{name:"angle-left"}),onChange:h=>{h&&!Array.isArray(h)&&f(h)},locale:"en"})});u.displayName="Body";const g=o=>({modal:(0,n.css)({zIndex:o.zIndex.modal,boxShadow:o.shadows.z3,backgroundColor:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,borderTopLeftRadius:o.shape.radius.default,borderBottomLeftRadius:o.shape.radius.default,"button:disabled":{color:o.colors.text.disabled}})})},45225:(q,j,e)=>{"use strict";e.d(j,{l:()=>o});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(96540),s=e(3202),c=e(29675),d=e(34128),u=e(34783);const g=m=>(0,s.KQ)(m).format("L"),o=({value:m,minDate:f,maxDate:p,onChange:h,closeOnSelect:D,placeholder:C="Date",...l})=>{const[v,y]=(0,x.useState)(!1),P=(0,c.of)(E),b=[(0,r.UU)({crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:S,refs:M,floatingStyles:O}=(0,a.we)({open:v,placement:"bottom-start",onOpenChange:y,middleware:b,whileElementsMounted:i.ll,strategy:"fixed"}),R=(0,a.kp)(S),L=(0,a.s9)(S),{getReferenceProps:B,getFloatingProps:F}=(0,a.bv)([L,R]);return(0,t.jsxs)("div",{className:P.container,children:[(0,t.jsx)(d.p,{ref:M.setReference,type:"text",autoComplete:"off",placeholder:C,value:m&&g(m),onChange:I=>{I.target.value===""&&h("")},className:P.input,...l,...B()}),(0,t.jsx)("div",{className:P.popover,ref:M.setFloating,style:O,...F(),children:(0,t.jsx)(u.l,{isOpen:v,value:m&&typeof m!="string"?m:(0,s.KQ)().toDate(),minDate:f,maxDate:p,onChange:I=>{h(I),D&&y(!1)},onClose:()=>y(!1)})})]})},E=m=>({container:(0,n.css)({position:"relative"}),input:(0,n.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,n.css)({zIndex:m.zIndex.tooltip})})},52961:(q,j,e)=>{"use strict";e.d(j,{K:()=>L});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(18828),s=e(85690),c=e(93225),d=e(96540),u=e(21497),g=e(49045),o=e(88090),E=e(3202),m=e(35023),f=e(58779),p=e(29675),h=e(70462),D=e(54594),C=e(60484),l=e(79784),v=e(34128),y=e(48583),P=e(15506),b=e(75606),S=e(21144),M=e(33627),O=e(233),R=e(56599);const L=({date:U,maxDate:W,minDate:A,label:N,onChange:K,disabledHours:V,disabledMinutes:T,disabledSeconds:z,timeZone:w,showSeconds:H=!0,clearable:G=!1})=>{const[X,k]=(0,d.useState)(!1),_=(0,d.useRef)(null),{overlayProps:ee,underlayProps:J}=(0,c.e)({onClose:()=>k(!1),isDismissable:!0,isOpen:X,shouldCloseOnInteractOutside:me=>{const Pe=document.getElementsByClassName(S.i)[0];return!(Pe&&Pe.contains(me))}},_),{dialogProps:Z}=(0,x.s)({},_),te=(0,p.$j)(),{modalBackdrop:ae}=(0,p.of)(P.o),re=(0,g.A)(`(min-width: ${te.breakpoints.values.lg}px)`),ne=(0,p.of)(I),ce=[(0,r.UU)({crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:le,floatingStyles:he}=(0,a.we)({open:X,placement:"bottom-start",onOpenChange:k,middleware:ce,whileElementsMounted:i.ll,strategy:"fixed"}),oe=(0,d.useCallback)(me=>{k(!1),K(me)},[K]),de=(0,d.useCallback)(me=>{me.preventDefault(),k(!0)},[k]);return(0,t.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,t.jsx)(B,{date:U,onChange:K,isFullscreen:re,onOpen:de,label:N,ref:le.setReference,showSeconds:H,clearable:G,timeZone:w}),X?re?(0,t.jsx)(b.ZL,{children:(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:_,...ee,...Z,children:(0,t.jsx)(F,{date:U,onChange:oe,isFullscreen:!0,onClose:()=>k(!1),maxDate:W,minDate:A,ref:le.setFloating,style:he,showSeconds:H,disabledHours:V,disabledMinutes:T,disabledSeconds:z,timeZone:w})})})}):(0,t.jsxs)(b.ZL,{children:[(0,t.jsx)("div",{className:ae,...J}),(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:_,...ee,...Z,children:(0,t.jsx)("div",{className:ne.modal,children:(0,t.jsx)(F,{date:U,maxDate:W,minDate:A,onChange:oe,isFullscreen:!1,onClose:()=>k(!1),showSeconds:H,disabledHours:V,disabledMinutes:T,disabledSeconds:z,timeZone:w})})})})]}):null]})},B=d.forwardRef(({date:U,label:W,onChange:A,onOpen:N,timeZone:K,showSeconds:V=!0,clearable:T=!1},z)=>{const w=(0,p.of)(I),H=V?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[G,X]=(0,d.useState)(()=>({value:U?(0,o.LE)(U,{timeZone:K}):T?"":(0,o.LE)((0,E.KQ)(),{timeZone:K}),invalid:!1}));(0,d.useEffect)(()=>{if(U){const Z=(0,o.LE)(U,{format:H,timeZone:K});X({invalid:!(0,O.f)(Z),value:(0,E.Ar)(U)?Z:U})}},[U,H,K]);const k=(0,d.useCallback)(Z=>{const te=!(0,O.f)(Z.currentTarget.value);X({value:Z.currentTarget.value,invalid:te})},[]),_=(0,d.useCallback)(()=>{if(!G.invalid&&G.value){const Z=(0,E.oZ)((0,m.O)({timeZone:K}),G.value);A(Z)}},[G,A,K]),ee=(0,d.useCallback)(()=>{X({value:"",invalid:!1}),A()},[A]),J=(0,t.jsx)(D.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:N});return(0,t.jsx)(C.I,{label:W,invalid:!!(G.value&&G.invalid),className:w.field,children:(0,t.jsx)(v.p,{onChange:k,addonAfter:J,value:G.value,onBlur:_,"data-testid":f.XF.DateTimePicker.input,placeholder:"Select date/time",ref:z,suffix:T&&G.value&&(0,t.jsx)(l.I,{name:"times",className:w.clearIcon,onClick:ee})})})});B.displayName="DateTimeInput";const F=d.forwardRef(({date:U,onClose:W,onChange:A,isFullscreen:N,maxDate:K,minDate:V,style:T,showSeconds:z=!0,disabledHours:w,disabledMinutes:H,disabledSeconds:G,timeZone:X},k)=>{const _=(0,p.of)(M.h2),ee=(0,p.of)(I),[J,Z]=(0,d.useState)(()=>U&&U.isValid()?(0,E.oZ)((0,m.O)({timeZone:X}),U):(0,E.oZ)((0,m.O)({timeZone:X}),new Date)),[te,ae]=(0,d.useState)(()=>U&&U.isValid()?(0,R.Q)(U.toDate(),(0,m.O)({timeZone:X})):(0,R.Q)(new Date,(0,m.O)({timeZone:X}))),re=(0,d.useCallback)(le=>{le&&!Array.isArray(le)&&ae(le)},[]),ne=(0,d.useCallback)(le=>{Z(le)},[]),ce=()=>{const le=(0,E.KQ)(J);le.set("date",te.getDate()),le.set("month",te.getMonth()),le.set("year",te.getFullYear()),A(le)};return(0,t.jsxs)("div",{className:(0,n.cx)(ee.container,{[ee.fullScreen]:N}),style:T,ref:k,children:[(0,t.jsx)(u.Ay,{next2Label:null,prev2Label:null,value:te,nextLabel:(0,t.jsx)(l.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:(0,t.jsx)(l.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:re,locale:"en",className:_.body,tileClassName:_.title,maxDate:K,minDate:V}),(0,t.jsx)("div",{className:ee.time,children:(0,t.jsx)(S.R,{showSeconds:z,onChange:ne,value:J,disabledHours:w,disabledMinutes:H,disabledSeconds:G})}),(0,t.jsxs)(y.B,{children:[(0,t.jsx)(D.$n,{type:"button",onClick:ce,children:(0,t.jsx)(h.x,{i18nKey:"grafana-ui.date-time-picker.apply",children:"Apply"})}),(0,t.jsx)(D.$n,{variant:"secondary",type:"button",onClick:W,children:(0,t.jsx)(h.x,{i18nKey:"grafana-ui.date-time-picker.cancel",children:"Cancel"})})]})]})});F.displayName="DateTimeCalendar";const I=U=>({container:(0,n.css)({padding:U.spacing(1),border:`1px ${U.colors.border.weak} solid`,borderRadius:U.shape.radius.default,backgroundColor:U.colors.background.primary,zIndex:U.zIndex.modal}),fullScreen:(0,n.css)({position:"absolute"}),time:(0,n.css)({marginBottom:U.spacing(2)}),modal:(0,n.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:U.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,n.css)({cursor:"pointer"}),field:(0,n.css)({marginBottom:0,width:"100%"})})},13409:(q,j,e)=>{"use strict";e.d(j,{N:()=>F});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(18828),s=e(85690),c=e(93225),d=e(96540),u=e(29675),g=e(70462),o=e(54594),E=e(86489),m=e(79784),f=e(34128),p=e(99134),h=e(6736),D=e(68196),C=e(88707),l=e(16978);const v=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,y=N=>({from:M(N.from),to:M(N.to)}),P=N=>{const K=R(N.from),V=R(N.to);return{from:K,to:V,display:`${K} to ${V}`}},b=(N,K=Date.now())=>S(N)?M(N)>Math.ceil(K/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},S=N=>v.test(N),M=N=>{const K=v.exec(N);if(!K||K.length!==4)return 0;const[,V,T,z]=K,w=parseInt(T,10);if(isNaN(w))return 0;const H=w*O[z];return V==="+"?H*-1:H},O={w:604800,d:86400,h:3600,m:60,s:1},R=N=>{if(N===0)return"now";const K=Math.abs(N);return N<0?`now+${L(K)}`:`now-${L(K)}`};function L(N){const K=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:T,value:z}of K)if(N%z===0)return`${N/z}${T}`;const V=K[K.length-1];return`${N}${V.unit}`}const B=l.o.filter(N=>S(N.from));function F(N){const{timeRange:K,onChange:V}=N,[T,z]=(0,d.useState)(!1),w=(0,d.useCallback)(()=>z(!1),[]),H=P(K),[G,X]=(0,d.useState)({value:H.from,validation:b(H.from)}),[k,_]=(0,d.useState)({value:H.to,validation:b(H.to)}),ee=(0,d.useRef)(null),{overlayProps:J,underlayProps:Z}=(0,c.e)({onClose:()=>z(!1),isDismissable:!0,isOpen:T},ee),{dialogProps:te}=(0,x.s)({},ee),ae=[(0,r.UU)({crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:re,refs:ne,floatingStyles:ce}=(0,a.we)({open:T,placement:"bottom-start",onOpenChange:z,middleware:ae,whileElementsMounted:i.ll,strategy:"fixed"}),le=(0,a.kp)(re),he=(0,a.s9)(re),{getReferenceProps:oe,getFloatingProps:de}=(0,a.bv)([he,le]),me=(0,u.of)(W(G.validation.errorMessage,k.validation.errorMessage)),Pe=Qe=>{const we=y(Qe);we&&(w(),X({...G,value:Qe.from}),_({...k,value:Qe.to}),V(we))},Ee=(0,d.useCallback)(Qe=>{Qe.stopPropagation(),Qe.preventDefault(),z(!T)},[T]),be=Qe=>{if(Qe.preventDefault(),!k.validation.isValid||!G.validation.isValid)return;const we=y({from:G.value,to:k.value,display:""});we&&(V(we),z(!1))},{from:Se,to:Xe}=H;return(0,t.jsxs)("div",{className:me.container,children:[(0,t.jsxs)("button",{ref:ne.setReference,className:me.pickerInput,type:"button",onClick:Ee,...oe(),children:[(0,t.jsx)("span",{className:me.clockIcon,children:(0,t.jsx)(m.I,{name:"clock-nine"})}),(0,t.jsx)("span",{children:(0,t.jsxs)(g.x,{i18nKey:"time-picker.time-range.from-to",children:[{timeOptionFrom:Se}," to ",{timeOptionTo:Xe}]})}),(0,t.jsx)("span",{className:me.caretIcon,children:(0,t.jsx)(m.I,{name:T?"angle-up":"angle-down",size:"lg"})})]}),T&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{role:"presentation",className:me.backdrop,...Z}),(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:ee,...J,...te,children:(0,t.jsx)("div",{className:me.content,ref:ne.setFloating,style:ce,...de(),children:(0,t.jsxs)("div",{className:me.body,children:[(0,t.jsx)("div",{className:me.leftSide,children:(0,t.jsx)(p.P,{showScrollIndicators:!0,children:(0,t.jsx)(C.l,{title:(0,g.t)("time-picker.time-range.example-title","Example time ranges"),options:B,onChange:Pe,value:H})})}),(0,t.jsxs)("div",{className:me.rightSide,children:[(0,t.jsx)("div",{className:me.title,children:(0,t.jsx)(D.e,{children:(0,t.jsx)(h.m,{content:(0,t.jsx)(I,{}),placement:"bottom",theme:"info",children:(0,t.jsx)("div",{children:(0,t.jsxs)(g.x,{i18nKey:"time-picker.time-range.specify",children:["Specify time range ",(0,t.jsx)(m.I,{name:"info-circle"})]})})})})}),(0,t.jsx)(E.D,{label:"From",invalid:!G.validation.isValid,error:G.validation.errorMessage,children:(0,t.jsx)(f.p,{onClick:Qe=>Qe.stopPropagation(),onBlur:()=>X({...G,validation:b(G.value)}),onChange:Qe=>X({...G,value:Qe.currentTarget.value}),value:G.value})}),(0,t.jsx)(E.D,{label:"To",invalid:!k.validation.isValid,error:k.validation.errorMessage,children:(0,t.jsx)(f.p,{onClick:Qe=>Qe.stopPropagation(),onBlur:()=>_({...k,validation:b(k.value)}),onChange:Qe=>_({...k,value:Qe.currentTarget.value}),value:k.value})}),(0,t.jsx)(o.$n,{"aria-label":"TimePicker submit button",onClick:be,children:(0,t.jsx)(g.x,{i18nKey:"time-picker.time-range.apply",children:"Apply time range"})})]})]})})})})]})]})}const I=()=>{const N=(0,u.of)(U);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:N.supported,children:(0,t.jsxs)(g.x,{i18nKey:"time-picker.time-range.supported-formats",children:["Supported formats: ",(0,t.jsx)("code",{className:N.tooltip,children:"now-[digit]s/m/h/d/w"})]})}),(0,t.jsx)("div",{children:(0,t.jsx)(g.x,{i18nKey:"time-picker.time-range.example",children:"Example: to select a time range from 10 minutes ago to now"})}),(0,t.jsx)("code",{className:N.tooltip,children:(0,t.jsx)(g.x,{i18nKey:"time-picker.time-range.example-details",children:"From: now-10m To: now"})}),(0,t.jsx)("div",{className:N.link,children:(0,t.jsxs)(g.x,{i18nKey:"time-picker.time-range.more-info",children:["For more information see"," ",(0,t.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/",children:["docs ",(0,t.jsx)(m.I,{name:"external-link-alt"})]}),"."]})})]})},U=N=>({supported:(0,n.css)({marginBottom:N.spacing(1)}),tooltip:(0,n.css)({margin:0}),link:(0,n.css)({marginTop:N.spacing(1)})}),W=(N,K)=>V=>{const T=(0,f.n)({theme:V,invalid:!1}),w=250+A(V,N)+A(V,K);return{backdrop:(0,n.css)({position:"fixed",zIndex:V.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,n.css)({display:"flex",position:"relative"}),pickerInput:(0,n.cx)(T.input,T.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${V.spacing.gridSize*V.components.height.md-2}px`})),caretIcon:(0,n.cx)(T.suffix,(0,n.css)({position:"relative",marginLeft:V.spacing(.5)})),clockIcon:(0,n.cx)(T.prefix,(0,n.css)({position:"relative",marginRight:V.spacing(.5)})),content:(0,n.css)({background:V.colors.background.primary,boxShadow:V.shadows.z3,position:"absolute",zIndex:V.zIndex.modal,width:"500px",top:"100%",borderRadius:V.shape.radius.default,border:`1px solid ${V.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,n.css)({display:"flex",height:`${w}px`}),description:(0,n.css)({color:V.colors.text.secondary,fontSize:V.typography.size.sm}),leftSide:(0,n.css)({width:"50% !important",borderRight:`1px solid ${V.colors.border.medium}`}),rightSide:(0,n.css)({width:"50%",padding:V.spacing(1)}),title:(0,n.css)({marginBottom:V.spacing(1)})}};function A(N,K){return K?K.length>34?N.spacing.gridSize*6.5:N.spacing.gridSize*4:0}},21144:(q,j,e)=>{"use strict";e.d(j,{R:()=>o,i:()=>g});var t=e(74848),n=e(22803),r=e(65740),a=e(34235),i=e(24938),x=e(3202),s=e(29675),c=e(94963),d=e(89256),u=e(79784);const g="time-of-day-picker-panel",o=({minuteStep:p=1,showHour:h=!0,showSeconds:D=!1,value:C,size:l="auto",disabled:v,disabledHours:y,disabledMinutes:P,disabledSeconds:b,placeholder:S,...M})=>{const O=(0,s.of)(f),R=M.allowEmpty??!1;return(0,t.jsx)(r.Ay,{generateConfig:a.A,locale:i.A,allowClear:R&&{clearIcon:(0,t.jsx)(u.I,{name:"times",className:O.clearIcon})},className:(0,n.cx)((0,d.lH)()[l],O.input),classNames:{popup:(0,n.cx)(O.picker,g)},defaultValue:M.allowEmpty?void 0:(0,x.AN)(),disabled:v,disabledTime:()=>({disabledHours:y,disabledMinutes:P,disabledSeconds:b}),format:E(h,D),minuteStep:p,onChange:L=>{if((0,x.u8)(L))return M.allowEmpty?M.onChange(L?(0,x.KQ)(L):void 0):M.onChange((0,x.KQ)(L))},picker:"time",placeholder:S,showNow:!1,needConfirm:!1,suffixIcon:(0,t.jsx)(m,{wrapperStyle:O.caretWrapper}),value:C&&(0,x.AN)(C)})};function E(p=!0,h=!1){const D=p?"HH:":"",C=h?":ss":"";return D+"mm"+C}const m=({wrapperStyle:p=""})=>(0,t.jsx)("div",{className:p,children:(0,t.jsx)(u.I,{name:"angle-down"})}),f=p=>{const h=p.components.input.background,D=p.colors.action.hover,C=p.shape.radius.default,l=p.components.input.borderColor;return{caretWrapper:(0,n.css)({position:"relative",top:"50%",transform:"translateY(-50%)",display:"inline-block",color:p.colors.text.secondary}),clearIcon:(0,n.css)({color:p.colors.text.secondary,"&:hover":{color:p.colors.text.maxContrast}}),picker:(0,n.css)({"&.rc-picker-dropdown":{boxShadow:"none",zIndex:p.zIndex.portal},".rc-picker-time-panel-column":{fontSize:p.typography.htmlFontSize,backgroundColor:h,color:p.colors.text.secondary,padding:"unset",overflowY:"auto",scrollbarWidth:"thin",width:p.spacing(8),li:{paddingRight:p.spacing(2),width:"auto","&.rc-picker-time-panel-cell-selected":{backgroundColor:"inherit",border:`1px solid ${p.colors.action.selectedBorder}`,borderRadius:C,color:p.colors.text.primary},"&:hover":{background:D,color:p.colors.text.primary},"&.rc-picker-time-panel-cell-disabled":{color:p.colors.action.disabledText}},".rc-picker-time-panel-cell-inner":{color:"inherit"},"&:not(:last-of-type)":{borderRight:`1px solid ${l}`}},".rc-picker-panel":{boxShadow:p.shadows.z3,backgroundColor:h,borderColor:l,borderRadius:C,overflow:"hidden"}}),input:(0,n.css)({"&.rc-picker-focused":{border:"none",".rc-picker-input":(0,c.getFocusStyles)(p)},"&.rc-picker-disabled":{".rc-picker-input":{backgroundColor:p.colors.action.disabledBackground,color:p.colors.action.disabledText,border:`1px solid ${p.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}},".rc-picker-input":{backgroundColor:h,borderRadius:C,borderColor:l,borderStyle:"solid",borderWidth:"1px",color:p.colors.text.primary,height:p.spacing(4),padding:p.spacing(0,1),input:{color:"unset",backgroundColor:"unset","&:focus":{outline:"none"},"&::placeholder":{color:p.colors.text.disabled}}},".rc-picker-clear":{alignItems:"center",display:"flex",insetInlineEnd:"unset",position:"relative"}})}}},2041:(q,j,e)=>{"use strict";e.d(j,{A:()=>a,X:()=>i});var t=e(74848),n=e(96540);const r=(0,n.createContext)(void 0);function a({children:x}){const[s,c]=(0,n.useState)(0),[d,u]=(0,n.useState)(),g=(0,n.useMemo)(()=>({sync:o=>u(o),unSync:()=>u(void 0),addPicker:()=>c(o=>o+1),removePicker:()=>{c(o=>{const E=o-1;return E<2&&u(void 0),E})},syncPossible:s>1,synced:!!d,syncedValue:d}),[s,d]);return(0,t.jsx)(r.Provider,{value:g,children:x})}function i(x){const s=(0,n.useContext)(r);return(0,n.useEffect)(()=>s?(s.addPicker(),x&&s.sync(x),()=>{s.removePicker()}):()=>{},[]),(0,n.useMemo)(()=>s&&{sync:s.sync,unSync:s.unSync,syncPossible:s.syncPossible,synced:s.synced,syncedValue:s.syncedValue},[s])}},7224:(q,j,e)=>{"use strict";e.d(j,{b:()=>D});var t=e(74848),n=e(22803),r=e(18828),a=e(85690),i=e(93225),x=e(96540),s=e(3202),c=e(55801),d=e(58779),u=e(29675),g=e(79784),o=e(34128),E=e(21097),m=e(64229),f=e(16978),p=e(233);const h=()=>{},D=({value:l,onChange:v,onChangeTimeZone:y=h,clearable:P,weekStart:b,hideTimeZone:S=!0,timeZone:M="browser",placeholder:O="Select time range",isReversed:R=!0,hideQuickRanges:L=!1,disabled:B=!1,showIcon:F=!1})=>{const[I,U]=(0,x.useState)(!1),W=(0,u.of)(C,B),A=G=>{G.stopPropagation(),G.preventDefault(),!B&&U(!I)},N=()=>{U(!1)},K=G=>{N(),v(G)},V=G=>{G.stopPropagation();const X=(0,s.KQ)(null),k=(0,s.KQ)(null);v({from:X,to:k,raw:{from:X,to:k}})},T=(0,x.createRef)(),z=(0,x.createRef)(),{dialogProps:w}=(0,r.s)({},T),{overlayProps:H}=(0,i.e)({onClose:N,isDismissable:!0,isOpen:I,shouldCloseOnInteractOutside:G=>!z.current?.contains(G)},T);return(0,t.jsxs)("div",{className:W.container,children:[(0,t.jsxs)("button",{type:"button",className:W.pickerInput,"data-testid":d.Tp.components.TimePicker.openButton,onClick:A,ref:z,children:[F&&(0,t.jsx)(g.I,{name:"clock-nine",size:"sm",className:W.icon}),(0,t.jsx)(m.f,{value:l,timeZone:M,placeholder:O}),!B&&(0,t.jsxs)("span",{className:W.caretIcon,children:[(0,p.X)(l)&&P&&(0,t.jsx)(g.I,{className:W.clearIcon,name:"times",size:"lg",onClick:V}),(0,t.jsx)(g.I,{name:I?"angle-up":"angle-down",size:"lg"})]})]}),I&&(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:W.content,ref:T,...H,...w,children:(0,t.jsx)(E.r,{timeZone:M,value:(0,p.X)(l)?l:(0,c.E2)(),onChange:K,quickOptions:f.o,onChangeTimeZone:y,className:W.content,hideTimeZone:S,isReversed:R,hideQuickRanges:L,weekStart:b})})})]})},C=(l,v=!1)=>{const y=(0,o.n)({theme:l,invalid:!1});return{container:(0,n.css)({display:"flex",position:"relative"}),content:(0,n.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:l.zIndex.dropdown}),pickerInput:(0,n.cx)(y.input,v&&y.inputDisabled,y.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${l.spacing.gridSize*4-2}px`})),caretIcon:(0,n.cx)(y.suffix,(0,n.css)({position:"relative",top:"-1px",marginLeft:l.spacing(.5)})),clearIcon:(0,n.css)({marginRight:l.spacing(.5),"&:hover":{color:l.colors.text.maxContrast}}),placeholder:(0,n.css)({color:l.colors.text.disabled,opacity:1}),icon:(0,n.css)({marginRight:l.spacing(.5)})}}},78968:(q,j,e)=>{"use strict";e.d(j,{_8:()=>R,xS:()=>O,$6:()=>S});var t=e(74848),n=e(22803),r=e(18828),a=e(85690),i=e(93225),x=e(96540),s=e(59577),c=e(88090),d=e(58064),u=e(30468),g=e(58779),o=e(29675),E=e(70462),m=e(90333),f=e(15506),p=e(75606),h=e(52120),D=e(6736),C=e(21097),l=e(16978),v=e(84596),y=e(2041);function P(I){const{onClick:U,isSynced:W}=I,A=()=>{const N=W?"Unsync all views":"Sync all views to this time range";return(0,t.jsx)(t.Fragment,{children:N})};return(0,t.jsx)(D.m,{content:A,placement:"bottom",children:(0,t.jsx)(h.I,{icon:"link",variant:W?"active":"canvas","aria-label":W?"Un sync times":"Sync times",onClick:U})})}function b(I){const{value:U,onChangeProp:W,isSyncedProp:A,initialIsSynced:N,timeSyncButtonProp:K}=I,V=(0,y.X)(N&&U?U:void 0),T=V?.synced,z=V?.syncedValue,w=V?.sync,H=!!(I.isSyncedProp===void 0&&V),G=(0,x.useCallback)(J=>{W(J),H&&T&&w?.(J)},[W,H,w,T]),X=(0,v.A)(U),k=(0,v.A)(V?.syncedValue);(0,x.useEffect)(()=>{H&&T&&(U!==X&&U!==z?w?.(U):z&&z!==k&&z!==U&&W(z))},[H,T,z,w,k,U,X,W]);const _=H?V?.synced:A,ee=H?V?.syncPossible&&(0,t.jsx)(P,{isSynced:V?.synced,onClick:()=>V?.synced?V.unSync():V.sync(U)}):K;return{onChangeWithSync:G,isSynced:_,timeSyncButton:ee}}function S(I){const[U,W]=(0,x.useState)(!1),{value:A,onMoveBackward:N,onMoveForward:K,onZoom:V,onError:T,timeZone:z,fiscalYearStartMonth:w,history:H,onChangeTimeZone:G,onChangeFiscalYearStartMonth:X,quickRanges:k,hideQuickRanges:_,widthOverride:ee,isOnCanvas:J,onToolbarTimePickerClick:Z,weekStart:te,initialIsSynced:ae}=I,{onChangeWithSync:re,isSynced:ne,timeSyncButton:ce}=b({initialIsSynced:ae,value:A,onChangeProp:I.onChange,isSyncedProp:I.isSynced,timeSyncButtonProp:I.timeSyncButton}),le=Le=>{re(Le),W(!1)};(0,x.useEffect)(()=>{U&&Z&&Z()},[U,Z]);const he=()=>{W(Le=>!Le)},oe=()=>{W(!1)},de=(0,x.createRef)(),me=(0,x.createRef)(),{overlayProps:Pe,underlayProps:Ee}=(0,i.e)({onClose:oe,isDismissable:!0,isOpen:U,shouldCloseOnInteractOutside:Le=>{const Ge=(0,p.gF)();return!me.current?.contains(Le)&&!Ge.contains(Le)}},de),{dialogProps:be}=(0,r.s)({},de),Se=(0,o.of)(B),{modalBackdrop:Xe}=(0,o.of)(f.o),Qe=!s.isRelativeTime(A.raw.from)||!s.isRelativeTime(A.raw.to),we=ne?"active":J?"canvas":"default",Fe=A?.to?.isBefore(A.from)?"exclamation-triangle":"clock-nine",Te=L(A,z,k);return(0,t.jsxs)(m.e,{className:Se.container,children:[Qe&&(0,t.jsx)(h.I,{"aria-label":(0,E.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:we,onClick:N,icon:"angle-left",type:"button",narrow:!0}),(0,t.jsx)(D.m,{ref:me,content:(0,t.jsx)(O,{timeRange:A,timeZone:z}),placement:"bottom",interactive:!0,children:(0,t.jsx)(h.I,{"data-testid":g.Tp.components.TimePicker.openButton,"aria-label":(0,E.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:Te}),"aria-controls":"TimePickerContent",onClick:he,icon:Fe,isOpen:U,type:"button",variant:we,children:(0,t.jsx)(R,{...I})})}),U&&(0,t.jsxs)("div",{"data-testid":g.Tp.components.TimePicker.overlayContent,children:[(0,t.jsx)("div",{role:"presentation",className:(0,n.cx)(Xe,Se.backdrop),...Ee}),(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:Se.content,ref:de,...Pe,...be,children:(0,t.jsx)(C.r,{timeZone:z,fiscalYearStartMonth:w,value:A,onChange:le,quickOptions:k||l.o,history:H,showHistory:!0,widthOverride:ee,onChangeTimeZone:G,onChangeFiscalYearStartMonth:X,hideQuickRanges:_,onError:T,weekStart:te})})})]}),ce,Qe&&(0,t.jsx)(h.I,{"aria-label":(0,E.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:K,icon:"angle-right",narrow:!0,type:"button",variant:we}),(0,t.jsx)(D.m,{content:M,placement:"bottom",children:(0,t.jsx)(h.I,{"aria-label":(0,E.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:V,icon:"search-minus",type:"button",variant:we})})]})}S.displayName="TimeRangePicker";const M=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(E.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,t.jsx)("br",{})," CTRL+Z"]})}),O=({timeRange:I,timeZone:U})=>{const W=(0,o.of)(F);return(0,t.jsxs)(t.Fragment,{children:[(0,c.LE)(I.from,{timeZone:U}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(E.x,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,c.LE)(I.to,{timeZone:U}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("span",{className:W.utc,children:(0,d.le)(U)})})]})},R=(0,x.memo)(({hideText:I,value:U,timeZone:W,quickRanges:A})=>{const N=(0,o.of)(F);return I?null:(0,t.jsxs)("span",{className:N.container,"aria-live":"polite","aria-atomic":"true",children:[(0,t.jsx)("span",{children:L(U,W,A)}),(0,t.jsx)("span",{className:N.utc,children:s.describeTimeRangeAbbreviation(U,W)})]})});R.displayName="TimePickerButtonLabel";const L=(I,U,W)=>{const A={to:u.isMathString(I.raw.to)?I.raw.to:I.to,from:u.isMathString(I.raw.from)?I.raw.from:I.from};return s.describeTimeRange(A,U,W)},B=I=>({container:(0,n.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,n.css)({display:"none",[I.breakpoints.down("sm")]:{display:"block"}}),content:(0,n.css)({position:"absolute",right:0,top:"116%",zIndex:I.zIndex.dropdown,[I.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:I.zIndex.modal}})}),F=I=>({container:(0,n.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,n.css)({color:I.v1.palette.orange,fontSize:I.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:I.typography.fontWeightMedium})})},33627:(q,j,e)=>{"use strict";e.d(j,{h2:()=>p,nB:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(21497),i=e(59457),x=e(29675),s=e(70462),c=e(79784),d=e(45282),u=e(56599);const g={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function o({onChange:h,from:D,to:C,timeZone:l,weekStart:v}){const y=E(D,C,new Date,l),P=m(h,l),b=(0,x.of)(p),S=(0,d.r)(v);return(0,t.jsx)(a.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:b.body,tileClassName:b.title,value:y,nextLabel:(0,t.jsx)(c.I,{name:"angle-right"}),nextAriaLabel:(0,s.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,t.jsx)(c.I,{name:"angle-left"}),prevAriaLabel:(0,s.t)("time-picker.calendar.previous-month","Previous month"),onChange:P,locale:"en",calendarType:g[S]})}o.displayName="Body";function E(h,D,C=new Date,l){let v=h.isValid()?h.toDate():C,y=D.isValid()?D.toDate():C;return l&&(v=(0,u.Q)(v,l),y=(0,u.Q)(y,l)),v>y?[y,v]:[v,y]}function m(h,D){return(0,r.useCallback)(C=>{if(!Array.isArray(C))return console.error("onCalendarChange: should be run in selectRange={true}");if(C[0]&&C[1]){const l=(0,i.b)(f(C[0]),{timeZone:D}),v=(0,i.b)(f(C[1]),{timeZone:D});h(l,v)}},[h,D])}function f(h){return[h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds()]}const p=h=>{const D=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,n.css)({color:h.colors.text.primary,backgroundColor:h.colors.background.primary,fontSize:h.typography.size.md,border:"1px solid transparent","&:hover, &:focus":{position:"relative"},"&:disabled":{color:h.colors.action.disabledText}}),body:(0,n.css)({zIndex:h.zIndex.modal,backgroundColor:h.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:h.colors.text.primary,border:0,fontWeight:h.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:h.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${D}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:h.colors.primary.contrastText,fontWeight:h.typography.fontWeightMedium,background:h.colors.primary.main,border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:h.colors.primary.contrastText,fontWeight:h.typography.fontWeightMedium,background:h.colors.primary.main,abbr:{backgroundColor:h.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${D}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${D}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},21097:(q,j,e)=>{"use strict";e.d(j,{r:()=>he});var t=e(74848),n=e(22803),r=e(96540),a=e(3202),i=e(59577),x=e(58779),s=e(29675),c=e(94963),d=e(70462),u=e(22560),g=e(79784),o=e(2543),E=e(58064),m=e(54594),f=e(51064),p=e(86489),h=e(10247),D=e(88849),C=e(11238),l=e(14749),v=e(49577),y=e(91262),P=e(53453),b=e(16978);const S=we=>{const{timeZone:$e,fiscalYearStartMonth:Fe,timestamp:Te=Date.now(),onChangeTimeZone:Le,onChangeFiscalYearStartMonth:Ge}=we,[Me,De]=(0,r.useState)(!1),[Ke,Ie]=(0,r.useState)("tz"),Ne=(0,r.useId)(),ie=(0,r.useId)(),ve=(0,r.useId)(),fe=(0,r.useCallback)(je=>{je&&je.stopPropagation(),De(!Me)},[Me,De]),ge=(0,s.of)(M);if(!(0,o.isString)($e))return null;const xe=(0,E.QZ)($e,Te);return xe?(0,t.jsxs)("div",{children:[(0,t.jsxs)("section",{"aria-label":(0,d.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:ge.container,children:[(0,t.jsxs)("div",{className:ge.timeZoneContainer,children:[(0,t.jsxs)("div",{className:ge.timeZone,children:[(0,t.jsx)(P.U,{title:xe.name}),(0,t.jsx)("div",{className:ge.spacer}),(0,t.jsx)(v.E,{info:xe})]}),(0,t.jsx)(y.X,{timeZone:$e,timestamp:Te})]}),(0,t.jsx)("div",{className:ge.spacer}),(0,t.jsx)(m.$n,{"data-testid":x.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:fe,size:"sm","aria-expanded":Me,"aria-controls":Ne,icon:Me?"angle-up":"angle-down",children:(0,t.jsx)(d.x,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),Me?(0,t.jsxs)("div",{className:ge.editContainer,id:Ne,children:[(0,t.jsxs)(h.U,{children:[(0,t.jsx)(D.o,{label:(0,d.t)("time-picker.footer.time-zone-option","Time zone"),active:Ke==="tz",onChangeTab:()=>{Ie("tz")},"aria-controls":ie}),(0,t.jsx)(D.o,{label:(0,d.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:Ke==="fy",onChangeTab:()=>{Ie("fy")},"aria-controls":ve})]}),(0,t.jsx)(C.J,{children:Ke==="tz"?(0,t.jsx)("section",{role:"tabpanel","data-testid":x.Tp.components.TimeZonePicker.containerV2,id:ie,className:(0,n.cx)(ge.timeZoneContainer,ge.timeSettingContainer),children:(0,t.jsx)(l.U,{includeInternal:!0,onChange:je=>{fe(),(0,o.isString)(je)&&Le(je)},onBlur:fe,menuShouldPortal:!1})}):(0,t.jsx)("section",{role:"tabpanel","data-testid":x.Tp.components.TimeZonePicker.containerV2,id:ve,className:(0,n.cx)(ge.timeZoneContainer,ge.timeSettingContainer),children:(0,t.jsx)(p.D,{className:ge.fiscalYearField,label:(0,d.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,t.jsx)(f.G,{value:Fe??null,options:b.Z,onChange:je=>{Ge&&Ge(je?.value??0)}})})})})]}):null]}):null},M=we=>({container:(0,n.css)({borderTop:`1px solid ${we.colors.border.weak}`,padding:we.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,n.css)({borderTop:`1px solid ${we.colors.border.weak}`,padding:we.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,n.css)({marginLeft:"7px"}),timeSettingContainer:(0,n.css)({paddingTop:we.spacing(1)}),fiscalYearField:(0,n.css)({marginBottom:0}),timeZoneContainer:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var O=e(68196),R=e(59457),L=e(88090),B=e(34128),F=e(6736),I=e(233),U=e(18828),W=e(85690),A=e(93225),N=e(59875),K=e(15506),V=e(33627),T=e(48583);function z({onClose:we,onApply:$e}){return(0,t.jsxs)(T.B,{gap:2,justifyContent:"space-between",children:[(0,t.jsx)(m.$n,{variant:"secondary",onClick:we,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,t.jsx)(m.$n,{onClick:$e,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}z.displayName="Footer";var w=e(99764);function H({onClose:we}){return(0,t.jsxs)(T.B,{justifyContent:"space-between",children:[(0,t.jsx)(O.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,t.jsx)(w.K,{"data-testid":x.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,d.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:we})]})}H.displayName="Header";const G=(we,$e=!1)=>({container:(0,n.css)({top:0,position:"absolute",[`${$e?"left":"right"}`]:"546px"}),modalContainer:(0,n.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,n.css)({display:"flex",flexDirection:"column",gap:we.spacing(1),padding:we.spacing(1),label:"calendar",boxShadow:we.shadows.z3,backgroundColor:we.colors.background.primary,border:`1px solid ${we.colors.border.weak}`,borderRadius:we.shape.radius.default}),modal:(0,n.css)({label:"modal",boxShadow:we.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:we.zIndex.modal})});function X(we){const $e=(0,s.$j)(),{modalBackdrop:Fe}=(0,s.of)(K.o),Te=G($e,we.isReversed),{isOpen:Le,isFullscreen:Ge,onClose:Me}=we,De=(0,r.createRef)(),{dialogProps:Ke}=(0,U.s)({"aria-label":x.Tp.components.TimePicker.calendar.label},De),{overlayProps:Ie}=(0,A.e)({isDismissable:!0,isOpen:Le,onClose:Me},De),Ne=!Ge;if(!Le)return null;const ie=(0,t.jsxs)("section",{className:Te.calendar,ref:De,...Ie,...Ke,"data-testid":x.Tp.components.TimePicker.calendar.label,children:[(0,t.jsx)(H,{...we}),(0,t.jsx)(V.nB,{...we}),Ne&&(0,t.jsx)(z,{...we})]});return Ne?(0,t.jsxs)(N.Sf,{children:[(0,t.jsx)("div",{className:Fe}),(0,t.jsx)(W.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{className:Te.modal,children:(0,t.jsx)("div",{className:Te.modalContainer,children:ie})})})]}):(0,t.jsx)(W.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:Te.container,children:ie})})}const k=(0,r.memo)(X);X.displayName="TimePickerCalendar";const _={default:()=>(0,d.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,d.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},ee=we=>{const{value:$e,isFullscreen:Fe=!1,timeZone:Te,onApply:Le,isReversed:Ge,fiscalYearStartMonth:Me,onError:De,weekStart:Ke}=we,[Ie,Ne]=Z($e.raw.from,$e.raw.to,Te),ie=(0,s.of)(ae),[ve,fe]=(0,r.useState)(Ie),[ge,xe]=(0,r.useState)(Ne),[je,Ve]=(0,r.useState)(!1),ke=(0,r.useId)(),Oe=(0,r.useId)();(0,r.useEffect)(()=>{const[ht,It]=Z($e.raw.from,$e.raw.to,Te);fe(ht),xe(It)},[$e.raw.from,$e.raw.to,Te]);const nt=(0,r.useCallback)(ht=>{ht.preventDefault(),Ve(!0)},[Ve]),Je=(0,r.useCallback)(()=>{if(ge.invalid||ve.invalid)return;const ht={from:ve.value,to:ge.value},It=i.convertRawToRange(ht,Te,Me);Le(It)},[ve.invalid,ve.value,Le,Te,ge.invalid,ge.value,Me]),Be=(0,r.useCallback)((ht,It)=>{const[Gt,un]=Z(ht,It,Te);fe(Gt),xe(un)},[Te]),Ze=ht=>{ht.key==="Enter"&&Je()},tt=()=>{const ht={from:ve.value,to:ge.value};navigator.clipboard.writeText(JSON.stringify(ht))},Re=async()=>{const ht=await navigator.clipboard.readText();let It;try{It=JSON.parse(ht)}catch{De&&De(ht);return}const[Gt,un]=Z(It.from,It.to,Te);fe(Gt),xe(un)},at=i.convertRawToRange({from:"now/fy",to:"now/fy"},Te,Me),yt=(0,d.t)("time-picker.range-content.fiscal-year","Fiscal year"),ze=(0,t.jsx)("div",{className:ie.tooltip,children:i.isFiscal($e)?(0,t.jsx)(F.m,{content:`${yt}: ${at.from.format("MMM-DD")} - ${at.to.format("MMM-DD")}`,children:(0,t.jsx)(g.I,{name:"info-circle"})}):null}),st=(0,t.jsx)(m.$n,{"aria-label":(0,d.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":x.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:nt});return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:ie.fieldContainer,children:[(0,t.jsx)(p.D,{label:(0,d.t)("time-picker.range-content.from-input","From"),invalid:ve.invalid,error:ve.errorMessage,children:(0,t.jsx)(B.p,{id:ke,onClick:ht=>ht.stopPropagation(),onChange:ht=>Be(ht.currentTarget.value,ge.value),addonAfter:st,onKeyDown:Ze,"data-testid":x.Tp.components.TimePicker.fromField,value:ve.value})}),ze]}),(0,t.jsxs)("div",{className:ie.fieldContainer,children:[(0,t.jsx)(p.D,{label:(0,d.t)("time-picker.range-content.to-input","To"),invalid:ge.invalid,error:ge.errorMessage,children:(0,t.jsx)(B.p,{id:Oe,onClick:ht=>ht.stopPropagation(),onChange:ht=>Be(ve.value,ht.currentTarget.value),addonAfter:st,onKeyDown:Ze,"data-testid":x.Tp.components.TimePicker.toField,value:ge.value})}),ze]}),(0,t.jsxs)("div",{className:ie.buttonsContainer,children:[(0,t.jsx)(m.$n,{"data-testid":x.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,d.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:tt}),(0,t.jsx)(m.$n,{"data-testid":x.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,d.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:Re}),(0,t.jsx)(m.$n,{"data-testid":x.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:Je,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,t.jsx)(k,{isFullscreen:Fe,isOpen:je,from:(0,R.b)(ve.value,{timeZone:Te}),to:(0,R.b)(ge.value,{timeZone:Te}),onApply:Je,onClose:()=>Ve(!1),onChange:Be,timeZone:Te,isReversed:Ge,weekStart:Ke})]})};function J(we,$e,Fe){const Te={from:we,to:$e},Le=i.convertRawToRange(Te,Fe);return!(Le.from.isSame(Le.to)||Le.from.isBefore(Le.to))}function Z(we,$e,Fe){const Te=te(we,Fe),Le=te($e,Fe),Ge=!(0,I.f)(Te,!1,Fe),Me=!(0,I.f)(Le,!0,Fe),De=J(Te,Le,Fe)&&!Me;return[{value:Te,invalid:Ge||De,errorMessage:De&&!Ge?_.range():_.default()},{value:Le,invalid:Me,errorMessage:_.default()}]}function te(we,$e){if((0,a.Ar)(we))return(0,L.LE)(we,{timeZone:$e});if(we.endsWith("Z")){const Fe=(0,R.b)(we,{timeZone:"utc",format:"YYYY-MM-DDTHH:mm:ss.SSSZ"});return(0,L.LE)(Fe,{timeZone:$e})}return we}function ae(we){return{fieldContainer:(0,n.css)({display:"flex"}),buttonsContainer:(0,n.css)({display:"flex",gap:we.spacing(.5),marginTop:we.spacing(1)}),tooltip:(0,n.css)({paddingLeft:we.spacing(1),paddingTop:we.spacing(3)})}}var re=e(88707);const ne=(we,$e)=>i.convertRawToRange({from:we.from,to:we.to},$e),ce=(we,$e)=>{const Fe=(0,L.LE)(we.from,{timeZone:$e}),Te=(0,L.LE)(we.to,{timeZone:$e});return{from:Fe,to:Te,display:`${Fe} to ${Te}`}},le=we=>{const{quickOptions:$e=[],isReversed:Fe,isFullscreen:Te,hideQuickRanges:Le,timeZone:Ge,fiscalYearStartMonth:Me,value:De,onChange:Ke,history:Ie,showHistory:Ne,className:ie,hideTimeZone:ve,onChangeTimeZone:fe,onChangeFiscalYearStartMonth:ge}=we,xe=!Ie?.length,je=Te&&Ne||!Te&&(Ne&&!xe||!Le),Ve=(0,s.of)(be,Fe,Le,je,Te),ke=Pe(Ie,Ge),Oe=Ee(De.raw,$e),[nt,Je]=(0,r.useState)(""),Be=$e.filter(tt=>tt.display.toLowerCase().includes(nt.toLowerCase())),Ze=tt=>Ke(ne(tt));return(0,t.jsxs)("div",{id:"TimePickerContent",className:(0,n.cx)(Ve.container,ie),children:[(0,t.jsxs)("div",{className:Ve.body,children:[(!Te||!Le)&&(0,t.jsxs)("div",{className:Ve.rightSide,children:[(0,t.jsx)("div",{className:Ve.timeRangeFilter,children:(0,t.jsx)(u.Z,{width:0,value:nt,onChange:Je,placeholder:(0,d.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,t.jsxs)("div",{className:Ve.scrollContent,children:[!Te&&(0,t.jsx)(oe,{...we,historyOptions:ke}),!Le&&(0,t.jsx)(re.l,{options:Be,onChange:Ze,value:Oe})]})]}),Te&&(0,t.jsx)("div",{className:Ve.leftSide,children:(0,t.jsx)(de,{...we,historyOptions:ke})})]}),!ve&&Te&&(0,t.jsx)(S,{timeZone:Ge,fiscalYearStartMonth:Me,onChangeTimeZone:fe,onChangeFiscalYearStartMonth:ge})]})},he=we=>{const{widthOverride:$e}=we,Fe=(0,s.$j)(),Te=($e||window.innerWidth)>=Fe.breakpoints.values.lg;return(0,t.jsx)(le,{...we,isFullscreen:Te})},oe=we=>{const{value:$e,hideQuickRanges:Fe,onChange:Te,timeZone:Le,historyOptions:Ge=[],showHistory:Me,onError:De,weekStart:Ke}=we,Ie=(0,s.of)(Se),Ne=(0,a.Ar)($e.raw.from)||(0,a.Ar)($e.raw.to),[ie,ve]=(0,r.useState)(!Ne),fe=Fe?!1:ie,ge=xe=>Te(ne(xe,Le));return(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:Ie.header,children:(0,t.jsxs)("button",{type:"button",className:Ie.expandButton,onClick:()=>{Fe||ve(!fe)},"data-testid":x.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!fe,"aria-controls":"expanded-timerange",children:[(0,t.jsx)(O.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!Fe&&(0,t.jsx)(g.I,{name:fe?"angle-down":"angle-up"})]})}),!fe&&(0,t.jsxs)("div",{className:Ie.body,id:"expanded-timerange",children:[(0,t.jsx)("div",{className:Ie.form,children:(0,t.jsx)(ee,{value:$e,onApply:Te,timeZone:Le,isFullscreen:!1,onError:De,weekStart:Ke})}),Me&&(0,t.jsx)(re.l,{title:(0,d.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Ge,onChange:ge,placeholderEmpty:null})]})]})},de=we=>{const{onChange:$e,value:Fe,timeZone:Te,fiscalYearStartMonth:Le,isReversed:Ge,historyOptions:Me,onError:De,weekStart:Ke}=we,Ie=(0,s.of)(Xe,we.hideQuickRanges),Ne=ie=>$e(ne(ie,Te));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Ie.container,children:[(0,t.jsx)("div",{className:Ie.title,"data-testid":x.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,t.jsx)(O.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,t.jsx)(ee,{value:Fe,timeZone:Te,fiscalYearStartMonth:Le,onApply:$e,isFullscreen:!0,isReversed:Ge,onError:De,weekStart:Ke})]}),we.showHistory&&(0,t.jsx)("div",{className:Ie.recent,children:(0,t.jsx)(re.l,{title:(0,d.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Me||[],onChange:Ne,placeholderEmpty:(0,t.jsx)(me,{})})})]})},me=(0,r.memo)(()=>{const we=(0,s.of)(Qe),$e=(0,d.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,t.jsxs)("div",{className:we.container,children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{children:$e})}),(0,t.jsx)(d.x,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{className:we.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,t.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function Pe(we,$e){return!Array.isArray(we)||we.length===0?[]:we.map(Fe=>ce(Fe,$e))}me.displayName="EmptyRecentList";const Ee=(we,$e)=>(0,r.useMemo)(()=>{if(i.isRelativeTimeRange(we))return $e.find(Fe=>Fe.from===we.from&&Fe.to===we.to)},[we,$e]),be=(we,$e,Fe,Te,Le)=>({container:(0,n.css)({background:we.colors.background.elevated,boxShadow:we.shadows.z3,width:`${Le?"546px":"262px"}`,borderRadius:we.shape.radius.default,border:`1px solid ${we.colors.border.weak}`,[`${$e?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,n.css)({display:"flex",flexDirection:"row-reverse",height:`${Te?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,n.css)({display:"flex",flexDirection:"column",borderRight:`${$e?"none":`1px solid ${we.colors.border.weak}`}`,width:`${Fe?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:$e?1:0}),rightSide:(0,n.css)({width:`${Le?"40%":"100%"}; !important`,borderRight:$e?`1px solid ${we.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,n.css)({padding:we.spacing(1)}),spacing:(0,n.css)({marginTop:"16px"}),scrollContent:(0,n.css)({overflowY:"auto",scrollbarWidth:"thin"})}),Se=we=>({header:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${we.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,n.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,c.getFocusStyles)(we)}),body:(0,n.css)({borderBottom:`1px solid ${we.colors.border.weak}`}),form:(0,n.css)({padding:"7px 9px 7px 9px"})}),Xe=(we,$e)=>({container:(0,n.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:$e?"11px":"20%"}),title:(0,n.css)({marginBottom:"11px"}),recent:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:we.spacing(1)})}),Qe=we=>({container:(0,n.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,n.css)({color:we.colors.text.link})})},68196:(q,j,e)=>{"use strict";e.d(j,{e:()=>x});var t=e(74848),n=e(22803),r=e(96540),a=e(29675);const i=s=>({text:(0,n.css)({fontSize:s.typography.size.md,fontWeight:s.typography.fontWeightMedium,color:s.colors.text.primary,margin:0,display:"flex"})}),x=(0,r.memo)(({children:s})=>{const c=(0,a.of)(i);return(0,t.jsx)("h3",{className:c.text,children:s})});x.displayName="TimePickerTitle"},64229:(q,j,e)=>{"use strict";e.d(j,{f:()=>s});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(78968),x=e(233);const s=(0,r.memo)(function({hideText:u,value:g,timeZone:o="browser",placeholder:E="No time range selected",className:m}){const f=(0,a.of)(c);return u?null:(0,t.jsx)("span",{className:m,children:(0,x.X)(g)?(0,t.jsx)(i._8,{value:g,timeZone:o}):(0,t.jsx)("span",{className:f.placeholder,children:E})})}),c=d=>({placeholder:(0,n.css)({color:d.colors.text.disabled,opacity:1})})},88707:(q,j,e)=>{"use strict";e.d(j,{l:()=>m});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(70462),x=e(68196),s=e(24726),c=e(94963);const d=l=>({container:(0,n.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between",position:"relative"}),radio:(0,n.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,c.getFocusStyles)(l)}),label:(0,n.css)({cursor:"pointer",flex:1,padding:l.spacing(1),borderRadius:l.shape.radius.default,"&:hover":{background:l.colors.action.hover,cursor:"pointer"}}),labelSelected:(0,n.css)({background:l.colors.action.selected,"&::before":{backgroundImage:l.colors.gradients.brandVertical,borderRadius:l.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:l.spacing(.5),left:0,top:0}})}),u=(0,r.memo)(({value:l,onSelect:v,selected:y=!1,name:P})=>{const b=(0,a.of)(d),S=(0,s.A)();return(0,t.jsxs)("li",{className:b.container,children:[(0,t.jsx)("input",{className:b.radio,checked:y,name:P,type:"checkbox","data-role":"item",tabIndex:-1,id:S,onChange:()=>v(l)}),(0,t.jsx)("label",{className:(0,n.cx)(b.label,y&&b.labelSelected),htmlFor:S,children:l.display})]})});u.displayName="TimeRangeOption";const g=(l,v)=>(l%v+v)%v,o=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],E=({localRef:l,options:v})=>{const[y,P]=(0,r.useState)(0);return(0,r.useEffect)(()=>{const S=l.current?.querySelectorAll('[data-role="item"]')||[],M=Array.from(S).findIndex(R=>R.checked),O=M>=0?M:0;S.forEach((R,L)=>{R.tabIndex=L===O?0:-1}),P(O)},[l,v]),[S=>{const M=l?.current?.querySelectorAll('[data-role="item"]'),O=M?.length??0;o.indexOf(S.key)>-1&&(S.preventDefault(),S.key!=="Tab"&&S.stopPropagation());let R=null;switch(S.key){case"ArrowUp":R=g(y-1,O);break;case"ArrowDown":R=g(y+1,O);break;case"Home":R=0;break;case"End":R=O-1;break;case"Enter":M?.[y]?.click();break;default:break}R!==null&&(P(R),M?.[R]?.focus(),M?.forEach((L,B)=>{L.tabIndex=B===R?0:-1}))}]},m=l=>{const v=(0,a.of)(D),{title:y,options:P,placeholderEmpty:b}=l;return typeof b<"u"&&P.length<=0?(0,t.jsx)(t.Fragment,{children:b}):y?(0,t.jsx)("section",{"aria-label":y,children:(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:v.title,children:(0,t.jsx)(x.e,{children:y})}),(0,t.jsx)(f,{...l})]})}):(0,t.jsx)(f,{...l})},f=({options:l,value:v,onChange:y,title:P})=>{const b=(0,a.of)(C),S=(0,r.useRef)(null),[M]=E({localRef:S,options:l});return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("ul",{role:"presentation",onKeyDown:M,ref:S,"aria-roledescription":(0,i.t)("time-picker.time-range.aria-role","Time range selection"),className:b.list,children:l.map((O,R)=>(0,t.jsx)(u,{value:O,selected:h(O,v),onSelect:y,name:P??(0,i.t)("time-picker.time-range.default-title","Time ranges")},p(O,R)))})})};function p(l,v){return`${l.from}-${l.to}-${v}`}function h(l,v){return!v||!l?!1:v.from===l.from&&v.to===l.to}const D=()=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),C=l=>({list:(0,n.css)({padding:l.spacing(.5)})})},14749:(q,j,e)=>{"use strict";e.d(j,{U:()=>l});var t=e(74848),n=e(2543),r=e(96540),a=e(58064),i=e(70462),x=e(44826),s=e(22803),c=e(29675);const d=M=>{const{children:O,label:R}=M,L=(0,c.of)(u);return R?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:L.header,children:(0,t.jsx)("span",{className:L.label,children:R})}),O]}):(0,t.jsx)("div",{children:O})},u=M=>({header:(0,s.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${M.colors.border.weak}`,textTransform:"capitalize"}),label:(0,s.css)({fontSize:M.typography.size.sm,color:M.colors.text.secondary,fontWeight:M.typography.fontWeightMedium})});var g=e(91262),o=e(58779),E=e(79784),m=e(49577),f=e(53453);const p="tz-utc-offset",h=M=>{const{children:O,innerProps:R,innerRef:L,data:B,isSelected:F,isFocused:I}=M,U=(0,c.of)(C),W=Date.now(),A=(0,s.cx)(U.container,I&&U.containerFocused);if(!(0,n.isString)(B.value))return null;const N=(0,a.QZ)(B.value,W);return(0,t.jsx)("div",{className:A,...R,ref:L,"data-testid":o.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:(0,s.cx)(U.leftColumn,U.row),children:[(0,t.jsxs)("div",{className:(0,s.cx)(U.leftColumn,U.wideRow),children:[(0,t.jsx)(f.U,{title:O}),(0,t.jsx)("div",{className:U.spacer}),(0,t.jsx)(m.E,{info:N})]}),(0,t.jsxs)("div",{className:U.rightColumn,children:[(0,t.jsx)(g.X,{timeZone:N?.ianaName||B.value,timestamp:W,className:p}),F&&(0,t.jsx)("span",{children:(0,t.jsx)(E.I,{name:"check"})})]})]})})},D=M=>{const{children:O,innerProps:R,innerRef:L,data:B,isSelected:F,isFocused:I}=M,U=(0,c.of)(C),W=Date.now(),A=(0,s.cx)(U.container,I&&U.containerFocused);if(!(0,n.isString)(B.value))return null;const N=(0,a.QZ)(B.value,W);return(0,t.jsx)("div",{className:A,...R,ref:L,"data-testid":o.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:U.body,children:[(0,t.jsxs)("div",{className:U.row,children:[(0,t.jsx)("div",{className:U.leftColumn,children:(0,t.jsx)(f.U,{title:O})}),(0,t.jsx)("div",{className:U.rightColumn,children:F&&(0,t.jsx)("span",{children:(0,t.jsx)(E.I,{name:"check"})})})]}),(0,t.jsxs)("div",{className:U.row,children:[(0,t.jsx)("div",{className:U.leftColumn,children:(0,t.jsx)(m.E,{info:N})}),(0,t.jsx)("div",{className:U.rightColumn,children:(0,t.jsx)(g.X,{timestamp:W,timeZone:N?.ianaName||B.value,className:p})})]})]})})},C=M=>({container:(0,s.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:M.colors.action.hover}}),containerFocused:(0,s.css)({background:M.colors.action.hover}),body:(0,s.css)({display:"flex",fontWeight:M.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,s.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,s.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,s.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,s.css)({marginLeft:"6px"})}),l=M=>{const{onChange:O,width:R,autoFocus:L=!1,onBlur:B,value:F,includeInternal:I=!1,disabled:U=!1,inputId:W,menuShouldPortal:A=!0,openMenuOnFocus:N=!0}=M,K=v(I),V=y(K,F),T=b(),z=R&&R<=45?D:h,w=(0,r.useCallback)(H=>{if(!H||!(0,n.isString)(H.value))return O(F);O(H.value)},[O,F]);return(0,t.jsx)(x.l6,{inputId:W,value:V,placeholder:(0,i.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:L,menuShouldPortal:A,openMenuOnFocus:N,width:R,filterOption:T,options:K,onChange:w,onBlur:B,components:{Option:z,Group:d},disabled:U,"aria-label":(0,i.t)("time-picker.zone.select-aria-label","Time zone picker")})},v=M=>{const O=Date.now();return(0,a.U3)(M).map(L=>{const B=L.zones.reduce((F,I)=>{const U=(0,a.QZ)(I,O);return U&&F.push({label:U.name,value:U.zone,searchIndex:S(U,O)}),F},[]);return{label:L.name,options:B}})},y=(M,O)=>(0,r.useMemo)(()=>{if(O===void 0)return;const R=(0,n.toLower)(O);return M.find(B=>B.label?R.startsWith((0,n.toLower)(B.label)):P(R))?.options.find(B=>(0,n.isEmpty)(R)?B.value===a.g$.default:(0,n.toLower)(B.value)===R)},[M,O]),P=M=>{switch(M){case a.g$.default:case a.g$.localBrowserTime:case a.g$.utc:return!0;default:return!1}},b=()=>(0,r.useCallback)((M,O)=>!O||!M.data||!M.data.searchIndex?!0:M.data.searchIndex.indexOf((0,n.toLower)(O))>-1,[]),S=(M,O)=>{const R=[(0,n.toLower)(M.name),(0,n.toLower)(M.abbreviation),(0,n.toLower)((0,g.t)(O,M.zone))];for(const L of M.countries)R.push((0,n.toLower)(L.name)),R.push((0,n.toLower)(L.code));return R.join("|")}},49577:(q,j,e)=>{"use strict";e.d(j,{E:()=>i});var t=e(74848),n=e(22803),r=e(96540),a=e(29675);const i=({info:c})=>{const d=(0,a.of)(s),u=x(c);return c?(0,t.jsx)("div",{className:d.description,children:u}):null},x=c=>(0,r.useMemo)(()=>{const d=[];if(!c)return"";if(c.name==="Europe/Simferopol")return"Ukraine, EEST";if(c.countries.length>0){const u=c.countries[0];d.push(u.name)}return c.abbreviation&&d.push(c.abbreviation),d.join(", ")},[c]),s=c=>({description:(0,n.css)({fontWeight:"normal",fontSize:c.typography.size.sm,color:c.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},91262:(q,j,e)=>{"use strict";e.d(j,{X:()=>s,t:()=>c});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(88090),x=e(29675);const s=u=>{const{timestamp:g,timeZone:o,className:E}=u,m=(0,x.of)(d);return(0,r.isString)(o)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:(0,n.cx)(m.offset,E),children:c(g,o)})}):null},c=(u,g)=>`UTC${(0,i.LE)(u,{timeZone:g,format:"Z"})}`,d=u=>{const g=(0,n.css)({fontWeight:"normal",fontSize:u.typography.size.sm,color:u.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,n.css)(g,{color:u.colors.text.primary,background:u.colors.background.secondary,padding:"2px 5px",borderRadius:u.shape.radius.default,marginLeft:"4px"})}}},53453:(q,j,e)=>{"use strict";e.d(j,{U:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({title:x})=>{const s=(0,r.of)(i);return x?(0,t.jsx)("span",{className:s.title,children:x}):null},i=x=>({title:(0,n.css)({fontWeight:x.typography.fontWeightRegular,textOverflow:"ellipsis"})})},45282:(q,j,e)=>{"use strict";e.d(j,{l:()=>c,r:()=>s});var t=e(74848),n=e(96540),r=e(58779),a=e(51064);const i=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],x=d=>["saturday","sunday","monday"].includes(d);function s(d){if(d&&x(d))return d;const u=window?.grafanaBootData?.user?.weekStart;return u&&x(u)?u:"monday"}const c=d=>{const{onChange:u,width:g,autoFocus:o=!1,onBlur:E,value:m,disabled:f=!1,inputId:p}=d,h=(0,n.useCallback)(C=>{C&&C.value!==void 0&&u(C.value)},[u]),D=(0,n.useMemo)(()=>i.find(C=>C.value===m)?.value??null,[m]);return(0,t.jsx)(a.G,{id:p,value:D,placeholder:r.Tp.components.WeekStartPicker.placeholder,autoFocus:o,width:g,options:i,onChange:h,onBlur:E,disabled:f})}},16978:(q,j,e)=>{"use strict";e.d(j,{Z:()=>n,o:()=>t});const t=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],n=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},233:(q,j,e)=>{"use strict";e.d(j,{X:()=>i,f:()=>a});var t=e(3202),n=e(30468),r=e(59457);function a(x,s,c){return(0,t.Ar)(x)?x.isValid():n.isMathString(x)?n.isValid(x):(0,r.b)(x,{roundUp:s,timeZone:c}).isValid()}function i(x){return n.isValid(x.from)&&n.isValid(x.to)}},56599:(q,j,e)=>{"use strict";e.d(j,{Q:()=>n});var t=e(58064);function n(r,a){const i=(0,t.HD)(a);if(!i)return r;const x=i.utcOffset(r.getTime()),s=r.getTimezoneOffset(),c=x-s;return new Date(r.getTime()-c*1e3*60)}},76080:(q,j,e)=>{"use strict";e.d(j,{c:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({direction:x="horizontal",spacing:s=2})=>{const c=(0,r.of)(i,s);return x==="vertical"?(0,t.jsx)("div",{className:c.verticalDivider}):(0,t.jsx)("hr",{className:c.horizontalDivider})};a.displayName="Divider";const i=(x,s)=>({horizontalDivider:(0,n.css)({borderTop:`1px solid ${x.colors.border.weak}`,margin:x.spacing(s,0),width:"100%"}),verticalDivider:(0,n.css)({borderRight:`1px solid ${x.colors.border.weak}`,margin:x.spacing(0,s),height:"100%"})})},14382:(q,j,e)=>{"use strict";e.d(j,{l:()=>n});var t=e(22803);const n=(r,a)=>{const i=a||"middle",x=r.colors.emphasize(r.colors.background.secondary,.15),s=r.colors.primary.border,c=r.spacing(2),d=4,u=200;let g="50%",o="50%";switch(i){case"start":{g="0%",o="0%";break}case"end":{g="100%",o="100%";break}}const E=(0,t.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:r.transitions.create("border-color"),zIndex:1},"&:after":{background:x,content:'""',position:"absolute",transition:r.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:r.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:s},"&:after":{background:s}}});return{dragHandleVertical:(0,t.cx)(E,(0,t.css)({cursor:"col-resize",width:c,"&:before":{borderRight:"1px solid transparent",height:"100%",left:g,transform:"translateX(-50%)"},"&:after":{left:g,top:"50%",height:u,width:d}})),dragHandleHorizontal:(0,t.cx)(E,(0,t.css)({height:c,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:o,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:o,height:d,width:u}}))}}},58528:(q,j,e)=>{"use strict";e.d(j,{_:()=>p});var t=e(74848),n=e(22803),r=e(18828),a=e(85690),i=e(93225),x=e(50848),s=e(96540),c=e(58779),d=e(29675),u=e(70462),g=e(14382),o=e(99764),E=e(99134),m=e(45565);const f={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function p({children:y,onClose:P,closeOnMaskClick:b=!0,scrollableContent:S=!0,title:M,subtitle:O,width:R,size:L="md",tabs:B}){const[F,I,U]=h(),W=(0,d.of)(l),A=(0,d.of)(v,L),N=(0,d.of)(g.l),K=s.useRef(null),{dialogProps:V,titleProps:T}=(0,r.s)({},K),{overlayProps:z}=(0,i.e)({isDismissable:!1,isOpen:!0,onClose:P},K);C();const w=(0,t.jsx)("div",{className:W.content,children:y}),H=F??R??f[L].width,G=f[L].minWidth;return(0,t.jsx)(x.A,{open:!0,onClose:P,placement:"right",getContainer:".main-view",className:W.drawerContent,rootClassName:W.drawer,classNames:{wrapper:A},styles:{wrapper:{width:H,minWidth:G}},width:"",motion:{motionAppear:!0,motionName:W.drawerMotion},maskClassName:W.mask,maskClosable:b,maskMotion:{motionAppear:!0,motionName:W.maskMotion},children:(0,t.jsx)(a.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,t.jsxs)("div",{"aria-label":typeof M=="string"?c.Tp.components.Drawer.General.title(M):c.Tp.components.Drawer.General.title("no title"),className:W.container,...z,...V,ref:K,children:[(0,t.jsx)("div",{className:(0,n.cx)(N.dragHandleVertical,W.resizer),onMouseDown:I,onTouchStart:U}),typeof M=="string"&&(0,t.jsxs)("div",{className:(0,n.cx)(W.header,!!B&&W.headerWithTabs),children:[(0,t.jsx)("div",{className:W.actions,children:(0,t.jsx)(o.K,{name:"times",variant:"secondary",onClick:P,"data-testid":c.Tp.components.Drawer.General.close,tooltip:(0,u.t)("grafana-ui.drawer.close","Close")})}),(0,t.jsxs)("div",{className:W.titleWrapper,children:[(0,t.jsx)(m.E,{element:"h3",...T,children:M}),O&&(0,t.jsx)("div",{className:W.subtitle,"data-testid":c.Tp.components.Drawer.General.subtitle,children:O}),B&&(0,t.jsx)("div",{className:W.tabsWrapper,children:B})]})]}),typeof M!="string"&&M,S?(0,t.jsx)(E.P,{showScrollIndicators:!0,children:w}):w]})})})}function h(){const[y,P]=(0,s.useState)(void 0),b=(0,s.useCallback)(B=>{P(D(B.clientX))},[]),S=(0,s.useCallback)(B=>{const F=B.touches[0];P(D(F.clientX))},[]),M=(0,s.useCallback)(B=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",M)},[b]),O=(0,s.useCallback)(B=>{document.removeEventListener("touchmove",S),document.removeEventListener("touchend",O)},[S]);function R(B){B.stopPropagation(),B.preventDefault(),document.addEventListener("mousemove",b),document.addEventListener("mouseup",M)}function L(B){B.stopPropagation(),B.preventDefault(),document.addEventListener("touchmove",S),document.addEventListener("touchend",O)}return[y,R,L]}function D(y){let P=document.body.offsetWidth-(y-document.body.offsetLeft);return`${Math.min(P/document.body.clientWidth*100,98).toFixed(2)}vw`}function C(){(0,s.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const l=y=>({container:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,n.css)({top:0,".rc-drawer-content-wrapper":{boxShadow:y.shadows.z3}}),drawerContent:(0,n.css)({backgroundColor:`${y.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,n.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${y.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,n.css)({backgroundColor:"transparent !important",position:"fixed !important","&:before":{backgroundColor:`${y.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,top:0}}),maskMotion:(0,n.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:y.transitions.create("opacity")}}}),header:(0,n.css)({label:"drawer-header",flexGrow:0,padding:y.spacing(2,2,3),borderBottom:`1px solid ${y.colors.border.weak}`}),headerWithTabs:(0,n.css)({borderBottom:"none"}),actions:(0,n.css)({position:"absolute",right:y.spacing(1),top:y.spacing(1)}),titleWrapper:(0,n.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,n.css)({label:"drawer-subtitle",color:y.colors.text.secondary,paddingTop:y.spacing(1)}),content:(0,n.css)({padding:y.spacing(2),height:"100%",flexGrow:1,minHeight:0}),tabsWrapper:(0,n.css)({label:"drawer-tabs",paddingLeft:y.spacing(2),margin:y.spacing(1,-1,-3,-3)}),resizer:(0,n.css)({top:0,left:y.spacing(-1),bottom:0,position:"absolute",zIndex:y.zIndex.modal})});function v(y,P){return(0,n.css)({label:`drawer-content-wrapper-${P}`,overflow:"unset !important",[y.breakpoints.down("md")]:{width:`calc(100% - ${y.spacing(2)}) !important`,minWidth:"0 !important"}})}},31035:(q,j,e)=>{"use strict";e.d(j,{f:()=>E});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(85690),s=e(96540),c=e(29675),d=e(19224),u=e(36529),g=e(52120);const o=f=>{const{className:p,options:h,value:D,onChange:C,narrow:l,variant:v,...y}=f,P=(0,c.of)(m),[b,S]=(0,s.useState)(!1),M=[(0,r.cY)(0),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:O,refs:R,floatingStyles:L}=(0,a.we)({open:b,placement:"bottom-end",onOpenChange:S,middleware:M,whileElementsMounted:i.ll}),B=(0,a.kp)(O),F=(0,a.s9)(O),{getReferenceProps:I,getFloatingProps:U}=(0,a.bv)([F,B]),W=A=>{C(A),S(!1)};return(0,t.jsxs)("div",{className:P.wrapper,children:[(0,t.jsx)(g.I,{className:p,isOpen:b,narrow:l,variant:v,ref:R.setReference,...I(),...y,children:D?.label||(D?.value!=null?String(D?.value):null)}),b&&(0,t.jsx)("div",{className:P.menuWrapper,ref:R.setFloating,...U(),style:L,children:(0,t.jsx)(x.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)(d.W,{tabIndex:-1,onClose:()=>S(!1),children:h.map(A=>(0,t.jsx)(u.D,{label:A.label??String(A.value),onClick:()=>W(A),active:A.value===D?.value,ariaChecked:A.value===D?.value,ariaLabel:A.ariaLabel||A.label,disabled:A.isDisabled,component:A.component,role:"menuitemradio"},`${A.value}`))})})})]})};o.displayName="ButtonSelect";const E=(0,s.memo)(o),m=f=>({wrapper:(0,n.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,n.css)({zIndex:f.zIndex.dropdown})})},60232:(q,j,e)=>{"use strict";e.d(j,{m:()=>o});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(96540),s=e(86634),c=e(29675),d=e(98842),u=e(89806),g=e(75606);const o=x.memo(({children:m,overlay:f,placement:p,offset:h,onVisibleChange:D})=>{const[C,l]=(0,x.useState)(!1),v=(0,x.useRef)(null),y=(0,x.useCallback)(A=>{l(A),D?.(A)},[D]),P=[(0,r.cY)({mainAxis:h?.[0]??8,crossAxis:h?.[1]??0}),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:b,refs:S,floatingStyles:M}=(0,a.we)({open:C,placement:(0,u.O)(p),onOpenChange:y,middleware:P,whileElementsMounted:i.ll}),O=(0,a.kp)(b),R=(0,a.s9)(b),{getReferenceProps:L,getFloatingProps:B}=(0,a.bv)([R,O]),F=150,I=(0,c.of)(E,F),U=()=>{y(!1)},W=A=>{A.key==="Tab"&&y(!1)};return(0,t.jsxs)(t.Fragment,{children:[x.cloneElement(m,{ref:S.setReference,...L()}),C&&(0,t.jsx)(g.ZL,{children:(0,t.jsx)(a.s3,{context:b,children:(0,t.jsx)("div",{ref:S.setFloating,style:M,onClick:U,onKeyDown:W,children:(0,t.jsx)(s.A,{nodeRef:v,appear:!0,in:!0,timeout:{appear:F,exit:0,enter:0},classNames:I,children:(0,t.jsx)("div",{ref:v,children:d.renderOrCallToRender(f,{...B()})})})})})})]})});o.displayName="Dropdown";const E=(m,f)=>({appear:(0,n.css)({opacity:"0",position:"relative",transformOrigin:"top",[m.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,n.css)({opacity:"1",[m.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${f}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${f}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},79592:(q,j,e)=>{"use strict";e.d(j,{_:()=>n,y:()=>r});var t=e(96540);const n=(0,t.createContext)(void 0);function r(a){if(!a)return{};const i=(0,t.useContext)(n);if(!i)return{};const x=i.selected.some(c=>c.id===a),s=(0,t.useCallback)(c=>{i.enabled&&(c.stopPropagation(),i.onSelect({id:a},c.shiftKey))},[i,a]);return{isSelected:x,onSelect:s,isSelectable:i.enabled}}},3844:(q,j,e)=>{"use strict";e.d(j,{Z:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x})=>{const s=(0,r.of)(i);return(0,t.jsx)("div",{className:s.container,children:x})},i=x=>({container:(0,n.css)({borderLeft:`3px solid ${x.colors.info.main}`,backgroundColor:`${x.colors.background.secondary}`,padding:x.spacing(2),minWidth:"350px",borderRadius:x.shape.radius.default,marginBottom:x.spacing(4)})})},59830:(q,j,e)=>{"use strict";e.d(j,{p:()=>v});var t=e(74848),n=e(22803),r=e(13686),a=e(29675),i=e(90231),x=e(48583),s=e(45565),c=e(36348);const d=({width:b="auto",height:S})=>{const M=(0,a.of)(u);return(0,t.jsx)(r.default,{src:c,className:M.svg,height:S,width:b})};d.displayName="GrotCTA";const u=b=>({svg:(0,n.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:b.isDark?"#58558c":"#c9c5f4"}})});var g=e(96540),o=e(22687);const E=-20,m=5,f=-5,p=5,h=({width:b="auto",height:S})=>{const M=(0,g.useRef)(null),O=(0,a.of)(D);return(0,g.useEffect)(()=>{const R=L=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const B=M.current?.querySelector("#grot-not-found-arm"),F=M.current?.querySelector("#grot-not-found-magnifier"),{clientX:I,clientY:U}=L,{innerWidth:W,innerHeight:A}=window,N=U/A,K=I/W,V=C(N,E,m),T=C(K,f,p);window.requestAnimationFrame(()=>{B?.setAttribute("style",`transform: rotate(${V}deg) translateX(${T}%)`),F?.setAttribute("style",`transform: rotate(${V}deg) translateX(${T}%)`)})};return window.addEventListener("mousemove",R),()=>{window.removeEventListener("mousemove",R)}},[]),(0,t.jsx)(r.default,{innerRef:M,src:o,className:O.svg,height:S,width:b})};h.displayName="GrotNotFound";const D=b=>({svg:(0,n.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),C=(b,S,M)=>b*(M-S)+S;var l=e(9886);const v=({button:b,children:S,image:M,message:O,hideImage:R=!1,variant:L,role:B})=>{const F=(0,a.of)(P),I=M??y(L);return(0,t.jsx)(i.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:B,children:(0,t.jsxs)("div",{className:F.container,children:[!R&&I,(0,t.jsxs)(x.B,{direction:"column",alignItems:"center",children:[(0,t.jsx)(s.E,{variant:"h4",textAlignment:"center",children:O}),S&&(0,t.jsx)(s.E,{color:"secondary",textAlignment:"center",children:S})]}),b]})})};function y(b){switch(b){case"call-to-action":return(0,t.jsx)(d,{width:300});case"not-found":return(0,t.jsx)(h,{width:300});case"completed":return(0,t.jsx)(r.default,{src:l,width:300});default:throw new Error(`Unknown variant: ${b}`)}}const P=b=>({container:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:b.spacing(4),maxWidth:"600px"})})},49816:(q,j,e)=>{"use strict";e.d(j,{Xc:()=>c,Xw:()=>s,tH:()=>x});var t=e(74848),n=e(96540),r=e(32631),a=e(37e3),i=e(32336);class x extends n.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(u,g){const o=this.props.errorLogger??r.P?.api?.pushError;o&&o(u),this.setState({error:u,errorInfo:g}),this.props.onError&&this.props.onError(u)}componentDidUpdate(u){const{dependencies:g,onRecover:o}=this.props;if(this.state.error&&g&&u.dependencies){for(let E=0;E<g.length;E++)if(g[E]!==u.dependencies[E]){this.setState({error:null,errorInfo:null}),o&&o();break}}}render(){const{children:u}=this.props,{error:g,errorInfo:o}=this.state;return u({error:g,errorInfo:o})}}class s extends n.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:u,children:g,style:o,dependencies:E,errorLogger:m}=this.props;return(0,t.jsx)(x,{dependencies:E,errorLogger:m,children:({error:f,errorInfo:p})=>p?o==="alertbox"?(0,t.jsx)(a.F,{title:u||"",children:(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[f&&f.toString(),(0,t.jsx)("br",{}),p.componentStack]})}):(0,t.jsx)(i.D,{title:u||"",error:f,errorInfo:p}):g})}}function c(d,u={}){const g=o=>(0,t.jsx)(s,{...u,children:(0,t.jsx)(d,{...o})});return g.displayName="WithErrorBoundary",g}},83508:(q,j,e)=>{"use strict";e.d(j,{y:()=>a});var t=e(74848),n=e(16753),r=e(66384);const a=({featureState:x,tooltip:s})=>{const c=i(x);return(0,t.jsx)(r.E,{text:c.text,color:c.color,icon:c.icon,tooltip:s})};function i(x){switch(x){case n.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case n.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case n.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case n.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case n.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},50876:(q,j,e)=>{"use strict";e.d(j,{gH:()=>m,wI:()=>h});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(96540),x=e(6264),s=e(47172),c=e(59141),d=e(29675),u=e(70462),g=e(37e3),o=e(79784),E=e(75860);function m({options:y,children:P,readAs:b,onLoad:S,fileListRenderer:M,onFileRemove:O}){const[R,L]=(0,i.useState)([]),[B,F]=(0,i.useState)([]),I=(0,c.j_)("decbytes")(y?.maxSize?y?.maxSize:0),U=(0,i.useCallback)((k,_)=>{L(ee=>ee.map(J=>(J.id===k.id&&_(J),J)))},[]),W=(0,i.useCallback)((k,_,ee)=>{let J=k.map(l);if(y?.multiple===!1?L(J):L(Z=>[...Z,...J]),H(_),y?.onDrop)y.onDrop(k,_,ee);else for(const Z of J){const te=new FileReader,ae=()=>{b?te[b](Z.file):te.readAsText(Z.file)};U(Z,re=>{re.abortUpload=()=>{te.abort()},re.retryUpload=()=>{U(Z,ne=>{ne.error=null,ne.progress=void 0}),ae()}}),te.onabort=()=>{U(Z,re=>{re.error=new DOMException("Aborted")})},te.onprogress=re=>{U(Z,ne=>{ne.progress=re.loaded})},te.onload=()=>{S?.(te.result)},te.onerror=()=>{U(Z,re=>{re.error=te.error})},ae()}},[S,y,b,U]),A=k=>{const _=R.filter(ee=>k.id!==ee.id);L(_),O?.(k)},{getRootProps:N,getInputProps:K,isDragActive:V}=(0,x.VB)({...y,useFsAccessApi:!1,onDrop:W,accept:p(y?.accept)}),T=(0,d.$j)(),z=v(T,V),w=R.map(k=>M?M(k,A):(0,t.jsx)(E.I,{file:k,removeFile:A},k.id)),H=k=>{let _=[];k.map(ee=>{ee.errors.map(J=>{_.findIndex(Z=>Z.code===J.code&&Z.message===J.message)===-1&&_.push(J)})}),F(_)},G=k=>{const _=(0,c.cN)(I);return(0,t.jsx)("div",{className:z.errorAlert,children:(0,t.jsx)(g.F,{title:"Upload failed",severity:"error",onRemove:X,children:k.map(ee=>{switch(ee.code){case s.O4.FileTooLarge:return(0,t.jsx)("div",{children:(0,t.jsxs)(u.x,{i18nKey:"grafana-ui.file-dropzone.file-too-large",children:["File is larger than ",{size:_}]})},ee.message+ee.code);default:return(0,t.jsx)("div",{children:ee.message},ee.message+ee.code)}})})})},X=()=>{F([])};return(0,t.jsxs)("div",{className:z.container,children:[(0,t.jsxs)("div",{"data-testid":"dropzone",...N({className:z.dropzone}),children:[(0,t.jsx)("input",{...K()}),P??(0,t.jsx)(h,{primaryText:D(R,y)})]}),B.length>0&&G(B),(0,t.jsxs)("small",{className:(0,n.cx)(z.small,z.acceptContainer),children:[y?.maxSize&&`Max file size: ${(0,c.cN)(I)}`,y?.maxSize&&y?.accept&&(0,t.jsx)("span",{className:z.acceptSeparator,children:"|"}),y?.accept&&C(y.accept)]}),w]})}function f(y){return["txt","json","csv","xls","yml"].some(P=>y.match(P))?"text/plain":"application/octet-stream"}function p(y){return(0,r.isString)(y)?{[f(y)]:[y]}:Array.isArray(y)?y.reduce((P,b)=>{const S=f(b);return P[S]=P[S]?[...P[S],b]:[b],P},{}):y}function h({primaryText:y="Drop file here or click to upload",secondaryText:P=""}){const b=(0,d.$j)(),S=v(b);return(0,t.jsxs)("div",{className:(0,n.cx)(S.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,t.jsx)(o.I,{className:(0,n.cx)(S.icon),name:"upload",size:"xl"}),(0,t.jsx)("h6",{className:(0,n.cx)(S.primaryText),children:y}),(0,t.jsx)("small",{className:S.small,children:P})]})}function D(y,P){return P?.multiple===void 0||P?.multiple?"Upload file":y.length?"Replace file":"Upload file"}function C(y){return(0,r.isString)(y)?`Accepted file type: ${y}`:Array.isArray(y)?`Accepted file types: ${y.join(", ")}`:`Accepted file types: ${Object.values(y).flat().join(", ")}`}function l(y){return{id:(0,r.uniqueId)("file"),file:y,error:null}}function v(y,P){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",padding:y.spacing(2),borderRadius:y.shape.radius.default,border:`1px dashed ${y.colors.border.strong}`,backgroundColor:P?y.colors.background.secondary:y.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,n.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,n.css)({textAlign:"center"}),icon:(0,n.css)({marginBottom:y.spacing(1)}),primaryText:(0,n.css)({marginBottom:y.spacing(1)}),acceptContainer:(0,n.css)({textAlign:"center",margin:0}),acceptSeparator:(0,n.css)({margin:`0 ${y.spacing(1)}`}),small:(0,n.css)({color:y.colors.text.secondary}),errorAlert:(0,n.css)({paddingTop:"10px"})}}},75860:(q,j,e)=>{"use strict";e.d(j,{I:()=>g});var t=e(74848),n=e(22803),r=e(59141),a=e(29675),i=e(93644),x=e(70462),s=e(54594),c=e(79784),d=e(99764);const u="Remove file";function g({file:E,removeFile:m}){const f=(0,a.of)(o),{file:p,progress:h,error:D,abortUpload:C,retryUpload:l}=E,v=()=>D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:f.error,children:D.message}),l&&(0,t.jsx)(d.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:l}),m&&(0,t.jsx)(d.K,{className:l?f.marginLeft:"",name:"trash-alt",onClick:()=>m(E),tooltip:u})]}):h&&p.size>h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("progress",{className:f.progressBar,max:p.size,value:h}),(0,t.jsxs)("span",{className:f.paddingLeft,children:[Math.round(h/p.size*100),"%"]}),C&&(0,t.jsx)(s.$n,{variant:"secondary",type:"button",fill:"text",onClick:C,children:(0,t.jsx)(x.x,{i18nKey:"grafana-ui.file-dropzone.cancel-upload",children:"Cancel upload"})})]}):m&&(0,t.jsx)(d.K,{name:"trash-alt",onClick:()=>m(E),tooltip:u,tooltipPlacement:"top"}),y=(0,r.j_)("decbytes")(p.size);return(0,t.jsxs)("div",{className:f.fileListContainer,children:[(0,t.jsxs)("span",{className:f.fileNameWrapper,children:[(0,t.jsx)(c.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,t.jsx)("span",{className:f.padding,children:(0,i.i)(p.name)}),(0,t.jsx)("span",{children:(0,r.cN)(y)})]}),(0,t.jsx)("div",{className:f.fileNameWrapper,children:v()})]})}function o(E){return{fileListContainer:(0,n.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:E.spacing(2),border:`1px dashed ${E.colors.border.medium}`,backgroundColor:`${E.colors.background.secondary}`,marginTop:E.spacing(1)}),fileNameWrapper:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,n.css)({padding:E.spacing(0,1)}),paddingLeft:(0,n.css)({paddingLeft:E.spacing(2)}),marginLeft:(0,n.css)({marginLeft:E.spacing(1)}),error:(0,n.css)({paddingRight:E.spacing(2),color:E.colors.error.text}),progressBar:(0,n.css)({borderRadius:E.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:E.colors.border.weak,borderRadius:E.shape.radius.default},"::-webkit-progress-value":{backgroundColor:E.colors.primary.main,borderRadius:E.shape.radius.default}})}}},22560:(q,j,e)=>{"use strict";e.d(j,{Z:()=>d});var t=e(74848),n=e(96540),r=e(67793),a=e(70462);function i(...u){const g=n.useRef(null);return n.useEffect(()=>{u.forEach(o=>{o&&(typeof o=="function"?o(g.current):o.current=g.current)})},[u]),g}var x=e(54594),s=e(79784),c=e(34128);const d=(0,n.forwardRef)(({value:u,width:g,onChange:o,escapeRegex:E=!0,...m},f)=>{const p=(0,n.useRef)(null),h=i(f,p),D=u!==""?(0,t.jsx)(x.$n,{icon:"times",fill:"text",size:"sm",onClick:C=>{p.current?.focus(),o(""),C.stopPropagation()},children:(0,t.jsx)(a.x,{i18nKey:"grafana-ui.filter-input.clear",children:"Clear"})}):null;return(0,t.jsx)(c.p,{prefix:(0,t.jsx)(s.I,{name:"search"}),suffix:D,width:g,type:"text",value:E?(0,r.xb)(u??""):u,onChange:C=>o(E?(0,r.jD)(C.currentTarget.value):C.currentTarget.value),...m,ref:h})});d.displayName="FilterInput"},99076:(q,j,e)=>{"use strict";e.d(j,{m:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(54594),i=e(79784);const x=({label:c,selected:d,onClick:u,icon:g="check"})=>{const o=(0,r.of)(s),E=(0,r.of)(a.my);return(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(E,o.wrapper,d&&o.selected),onClick:u,children:[(0,t.jsx)("span",{children:c}),d&&(0,t.jsx)(i.I,{name:g,className:o.icon})]})},s=c=>({wrapper:(0,n.css)({background:c.colors.background.secondary,borderRadius:c.shape.radius.pill,padding:c.spacing(0,2),fontSize:c.typography.bodySmall.fontSize,fontWeight:c.typography.fontWeightMedium,lineHeight:c.typography.bodySmall.lineHeight,color:c.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${c.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:c.colors.action.hover,color:c.colors.text.primary}}),selected:(0,n.css)({color:c.colors.text.primary,background:c.colors.action.selected,"&:hover":{background:c.colors.action.focus}}),icon:(0,n.css)({marginLeft:c.spacing(.5)})})},65360:(q,j,e)=>{"use strict";e.d(j,{z:()=>a});var t=e(74848),n=e(22803),r=e(79172);const a=({label:x,tooltip:s,labelWidth:c=6,inputWidth:d=12,inputEl:u,className:g,interactive:o,...E})=>{const m=i();return(0,t.jsxs)("div",{className:(0,n.cx)(m.formField,g),children:[(0,t.jsx)(r.I,{width:c,tooltip:s,interactive:o,children:x}),u||(0,t.jsx)("input",{type:"text",className:`gf-form-input ${d?`width-${d}`:""}`,...E,disabled:E.disabled})]})};a.displayName="FormField";const i=()=>({formField:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},79172:(q,j,e)=>{"use strict";e.d(j,{I:()=>s});var t=e(74848),n=e(46942),r=e.n(n),a=e(79784),i=e(6736);const s=({children:c,isFocused:d,isInvalid:u,className:g,htmlFor:o,tooltip:E,width:m,interactive:f,...p})=>{const h=r()(g,`gf-form-label width-${m||"10"}`,{"gf-form-label--is-focused":d,"gf-form-label--is-invalid":u});return(0,t.jsxs)("label",{className:h,...p,htmlFor:o,children:[c,E&&(0,t.jsx)(i.m,{placement:"top",content:E,theme:"info",interactive:f,children:(0,t.jsx)(a.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},48092:(q,j,e)=>{"use strict";e.d(j,{i:()=>r});var t=e(74848);function n(a){return a<20?.9:a<26?.8:.6}const r=({value:a,className:i,style:x,...s})=>{const c=(a.prefix??"").length>0,d=(a.suffix??"").length>0;let u;if(x&&typeof x.fontSize=="number"&&!Number.isNaN(x.fontSize)){const g=x.fontSize,o=n(g);u={fontSize:g*o}}return(0,t.jsx)("div",{className:i,style:x,...s,children:(0,t.jsxs)("div",{children:[c&&(0,t.jsx)("span",{children:a.prefix}),(0,t.jsx)("span",{children:a.text}),d&&(0,t.jsx)("span",{style:u,children:a.suffix})]})})};r.displayName="FormattedDisplayValue"},81942:(q,j,e)=>{"use strict";e.d(j,{S:()=>s});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(94963),x=e(40271);const s=r.forwardRef(({label:d,description:u,value:g,htmlValue:o,onChange:E,disabled:m,className:f,indeterminate:p,invalid:h,...D},C)=>{const l=(0,r.useCallback)(P=>{E&&E(P)},[E]),v=(0,a.of)(c,h),y=p?"mixed":void 0;return(0,t.jsxs)("label",{className:(0,n.cx)(v.wrapper,f),children:[(0,t.jsxs)("div",{className:v.checkboxWrapper,children:[(0,t.jsx)("input",{type:"checkbox",className:(0,n.cx)(v.input,p&&v.inputIndeterminate),checked:g,disabled:m,onChange:l,value:o,"aria-checked":y,...D,ref:C}),(0,t.jsx)("span",{className:v.checkmark})]}),d&&(0,t.jsx)("span",{className:v.label,children:d}),u&&(0,t.jsx)("span",{className:v.description,children:u})]})}),c=(d,u=!1)=>{const g=(0,x.f)(d),o=2,E=1,m=f=>u?d.colors.error.border:f;return{wrapper:(0,n.css)({display:"inline-grid",alignItems:"center",columnGap:d.spacing(E),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,n.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,i.getFocusStyles)(d),"&:focus:not(:focus-visible) + span":(0,i.getMouseFocusStyles)(d),"&:checked + span":{background:d.colors.primary.main,border:`1px solid ${m(d.colors.primary.main)}`,"&:hover":{background:d.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:d.spacing(.5),top:0,width:d.spacing(.75),height:d.spacing(1.5),border:`solid ${d.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:d.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${m(d.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:d.colors.action.disabledBackground},"&:after":{borderColor:d.colors.action.disabledText}}}),inputIndeterminate:(0,n.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${m(d.colors.primary.main)}`,background:d.colors.primary.main,"&:hover":{background:d.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${d.colors.primary.contrastText}`,backgroundColor:d.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:d.colors.action.disabledBackground,border:`1px solid ${m(d.colors.error.transparent)}`,"&:after":{borderColor:d.colors.action.disabledText}}}),checkboxWrapper:(0,n.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,n.css)({position:"relative",zIndex:2,display:"inline-block",width:d.spacing(o),height:d.spacing(o),borderRadius:d.shape.radius.default,background:d.components.input.background,border:`1px solid ${m(d.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:m(d.components.input.borderHover)}}),label:(0,n.cx)(g.label,(0,n.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:d.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,n.cx)(g.description,(0,n.css)({gridColumnStart:2,gridRowStart:2,lineHeight:d.typography.bodySmall.lineHeight,marginTop:0}))}};s.displayName="Checkbox"},86489:(q,j,e)=>{"use strict";e.d(j,{D:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(98842),x=e(64467),s=e(40271);const c=r.forwardRef(({label:g,description:o,horizontal:E,invalid:m,loading:f,disabled:p,required:h,error:D,children:C,className:l,validationMessageHorizontalOverflow:v,htmlFor:y,...P},b)=>{const S=(0,a.of)(u),M=y??(0,i.getChildId)(C),O=typeof g=="string"?(0,t.jsx)(s.J,{htmlFor:M,description:o,children:`${g}${h?" *":""}`}):g,R=d({invalid:m,disabled:p,loading:f});return(0,t.jsxs)("div",{className:(0,n.cx)(S.field,E&&S.fieldHorizontal,l),...P,children:[O,(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{ref:b,children:r.cloneElement(C,R)}),m&&D&&!E&&(0,t.jsx)("div",{className:(0,n.cx)(S.fieldValidationWrapper,{[S.validationMessageHorizontalOverflow]:!!v}),children:(0,t.jsx)(x.P,{children:D})})]}),m&&D&&E&&(0,t.jsx)("div",{className:(0,n.cx)(S.fieldValidationWrapper,S.fieldValidationWrapperHorizontal,{[S.validationMessageHorizontalOverflow]:!!v}),children:(0,t.jsx)(x.P,{children:D})})]})});c.displayName="Field";function d(g){for(const o in g)g[o]===void 0&&delete g[o];return g}const u=g=>({field:(0,n.css)({display:"flex",flexDirection:"column",marginBottom:g.spacing(2)}),fieldHorizontal:(0,n.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,n.css)({marginTop:g.spacing(.5)}),fieldValidationWrapperHorizontal:(0,n.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},44617:(q,j,e)=>{"use strict";e.d(j,{n:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(99178);const i=({label:s,children:c,className:d,...u})=>{const g=(0,r.of)(x);return(0,t.jsxs)("fieldset",{className:(0,n.cx)(g.wrapper,d),...u,children:[s&&(0,t.jsx)(a.s,{children:s}),c]})},x=s=>({wrapper:(0,n.css)({marginBottom:s.spacing(4),"&:last-child":{marginBottom:0}})})},64467:(q,j,e)=>{"use strict";e.d(j,{P:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(79784);const i=({children:s,horizontal:c,className:d})=>{const u=(0,r.of)(x),g=(0,n.cx)(c?u.horizontal:u.vertical,d);return(0,t.jsxs)("div",{role:"alert",className:g,children:[(0,t.jsx)(a.I,{className:u.fieldValidationMessageIcon,name:"exclamation-triangle"}),s]})},x=s=>{const c=`
      font-size: ${s.typography.size.sm};
      font-weight: ${s.typography.fontWeightMedium};
      padding: ${s.spacing(.5,1)};
      color: ${s.colors.error.contrastText};
      background: ${s.colors.error.main};
      border-radius: ${s.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${s.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,n.css)(c,{margin:s.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${s.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,n.css)(c,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,n.css)({marginRight:s.spacing()})}}},80619:(q,j,e)=>{"use strict";e.d(j,{l:()=>i});var t=e(74848),n=e(22803),r=e(96540),a=e(49785);function i({defaultValues:x,onSubmit:s,validateOnMount:c=!1,validateFieldsOnMount:d,children:u,validateOn:g="onSubmit",maxWidth:o=600,...E}){const{handleSubmit:m,trigger:f,formState:p,...h}=(0,a.mN)({mode:g,defaultValues:x});return(0,r.useEffect)(()=>{c&&f(d)},[f,d,c]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:o!=="none"?o+"px":o,width:"100%"}),onSubmit:m(s),...E,children:u({errors:p.errors,formState:p,trigger:f,...h})})}},60484:(q,j,e)=>{"use strict";e.d(j,{I:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(98842),x=e(64467),s=e(76302);const c=({children:u,label:g,tooltip:o,labelWidth:E="auto",invalid:m,loading:f,disabled:p,required:h,className:D,htmlFor:C,grow:l,shrink:v,error:y,transparent:P,interactive:b,validationMessageHorizontalOverflow:S,...M})=>{const O=(0,a.$j)(),R=d(O,l,v),L=C??(0,i.getChildId)(u),B=typeof g=="string"?(0,t.jsx)(s.c,{interactive:b,width:E,tooltip:o,htmlFor:L,transparent:P,children:`${g}${h?" *":""}`}):g;return(0,t.jsxs)("div",{className:(0,n.cx)(R.container,D),...M,children:[B,(0,t.jsxs)("div",{className:R.childContainer,children:[(0,r.cloneElement)(u,{invalid:m,disabled:p,loading:f}),m&&y&&(0,t.jsx)("div",{className:(0,n.cx)(R.fieldValidationWrapper,{[R.validationMessageHorizontalOverflow]:!!S}),children:(0,t.jsx)(x.P,{children:y})})]})]})};c.displayName="InlineField";const d=(u,g,o)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${g?1:0} ${o?1:0} auto`,margin:`0 ${u.spacing(.5)} ${u.spacing(.5)} 0`}),childContainer:(0,n.css)({flex:`${g?1:0} ${o?1:0} auto`}),fieldValidationWrapper:(0,n.css)({marginTop:u.spacing(.5)}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},77222:(q,j,e)=>{"use strict";e.d(j,{C:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x,className:s,...c})=>{const d=(0,r.of)(i);return(0,t.jsx)("div",{className:(0,n.cx)(d.container,s),...c,children:x})},i=x=>({container:(0,n.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:x.spacing(.5)})})},76302:(q,j,e)=>{"use strict";e.d(j,{c:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(79784),i=e(6736);const x=({children:c,className:d,tooltip:u,width:g,transparent:o,interactive:E,as:m="label",...f})=>{const p=(0,r.of)(s,o,g);return(0,t.jsxs)(m,{className:(0,n.cx)(p.label,d),...f,children:[c,u&&(0,t.jsx)(i.m,{interactive:E,placement:"top",content:u,theme:"info",children:(0,t.jsx)(a.I,{tabIndex:0,name:"info-circle",size:"sm",className:p.icon})})]})},s=(c,d=!1,u)=>({label:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:c.spacing(0,1),fontWeight:c.typography.fontWeightMedium,fontSize:c.typography.size.sm,backgroundColor:d?"transparent":c.colors.background.secondary,height:c.spacing(c.components.height.md),lineHeight:c.spacing(c.components.height.md),marginRight:c.spacing(.5),borderRadius:c.shape.radius.default,border:"none",width:u?u!=="auto"?`${8*u}px`:u:"100%",color:c.colors.text.primary}),icon:(0,n.css)({color:c.colors.text.secondary,marginLeft:"10px",":hover":{color:c.colors.text.primary}})})},54394:(q,j,e)=>{"use strict";e.d(j,{e:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x,className:s,grow:c,...d})=>{const u=(0,r.of)(i,c);return(0,t.jsx)("div",{className:(0,n.cx)(u.container,s),...d,children:x})};a.displayName="InlineSegmentGroup";const i=(x,s)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${s?1:0} 0 auto`,marginBottom:x.spacing(.5)})})},40271:(q,j,e)=>{"use strict";e.d(j,{J:()=>i,f:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(79784);const i=({children:s,description:c,className:d,category:u,...g})=>{const o=(0,r.of)(x),E=u?.map((m,f)=>(0,t.jsxs)("span",{className:o.categories,children:[(0,t.jsx)("span",{children:m}),(0,t.jsx)(a.I,{name:"angle-right",className:o.chevron})]},`${m}/${f}`));return(0,t.jsx)("div",{className:(0,n.cx)(o.label,d),children:(0,t.jsxs)("label",{...g,children:[(0,t.jsxs)("div",{className:o.labelContent,children:[E,s]}),c&&(0,t.jsx)("span",{className:o.description,children:c})]})})},x=s=>({label:(0,n.css)({label:"Label",fontSize:s.typography.size.sm,fontWeight:s.typography.fontWeightMedium,lineHeight:1.25,marginBottom:s.spacing(.5),color:s.colors.text.primary,maxWidth:"480px"}),labelContent:(0,n.css)({display:"flex",alignItems:"center"}),description:(0,n.css)({label:"Label-description",color:s.colors.text.secondary,fontSize:s.typography.size.sm,fontWeight:s.typography.fontWeightRegular,marginTop:s.spacing(.25),display:"block"}),categories:(0,n.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,n.css)({margin:s.spacing(0,.25)})})},92732:(q,j,e)=>{"use strict";e.d(j,{O:()=>x,p:()=>s});var t=e(74848),n=e(46942),r=e.n(n),a=e(96540),i=e(87916),x=(c=>(c.Invalid="invalid",c.Valid="valid",c))(x||{});class s extends a.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=d=>u=>{const g=(0,i.tf)(u.target.value,d);this.setState(o=>({...o,error:g?g[0]:null}))},this.populateEventPropsWithStatus=(d,u)=>{const g={...d};return u&&Object.keys(i.Pw).forEach(o=>{((0,i.K)(o,u)||d[o])&&(g[o]=async E=>{E.persist(),(0,i.K)(o,u)&&await this.validatorAsync(u[o]).apply(this,[E]),d[o]&&d[o].apply(null,[E,this.status])})}),g}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:d,className:u,hideErrorMessage:g,inputRef:o,...E}=this.props,{error:m}=this.state,f=r()("gf-form-input",{invalid:this.isInvalid},u),p=this.populateEventPropsWithStatus(E,d);return(0,t.jsxs)("div",{style:{flexGrow:1},children:[(0,t.jsx)("input",{...p,ref:o,className:f}),m&&!g&&(0,t.jsx)("span",{children:m})]})}}},99178:(q,j,e)=>{"use strict";e.d(j,{s:()=>i});var t=e(74848),n=e(22803),r=e(29675);const a=x=>({legend:(0,n.css)({fontSize:x.typography.h3.fontSize,fontWeight:x.typography.fontWeightRegular,margin:x.spacing(0,0,2,0)})}),i=({children:x,className:s,...c})=>{const d=(0,r.of)(a);return(0,t.jsx)("legend",{className:(0,n.cx)(d.legend,s),...c,children:x})}},60641:(q,j,e)=>{"use strict";e.d(j,{z:()=>m});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(5005),x=e(29675),s=e(79784),c=e(58779),d=e(94963),u=e(6736),g=e(89256);const o=a.forwardRef(({children:p,active:h=!1,disabled:D=!1,size:C="md",onChange:l,onClick:v,id:y,name:P=void 0,description:b,fullWidth:S,"aria-label":M},O)=>{const R=(0,x.of)(E,C,S),L=(0,t.jsx)("input",{type:"radio",className:R.radio,onChange:l,onClick:v,disabled:D,id:y,checked:h,name:P,"aria-label":M,ref:O});return b?(0,t.jsxs)("div",{className:R.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[(0,t.jsx)(u.m,{content:b,placement:"bottom",children:L}),(0,t.jsx)("label",{className:R.radioLabel,htmlFor:y,title:b||M,children:p})]}):(0,t.jsxs)("div",{className:R.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[L,(0,t.jsx)("label",{className:R.radioLabel,htmlFor:y,title:b||M,children:p})]})});o.displayName="RadioButton";const E=(p,h,D)=>{const{fontSize:C,height:l,padding:v}=(0,g.SM)(h,p),y=p.colors.text.secondary,P=p.colors.text.primary,b=l*p.spacing.gridSize-4-2;return{radioOption:(0,n.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:D?"1 0 0":"none",textAlign:"center"}),radio:(0,n.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:p.colors.text.primary,fontWeight:p.typography.fontWeightMedium,background:p.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,d.getFocusStyles)(p),"&:focus:not(:focus-visible) + label":(0,d.getMouseFocusStyles)(p),"&:disabled + label":{color:p.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:C,height:`${b}px`,lineHeight:`${b}px`,color:y,padding:p.spacing(0,v),borderRadius:p.shape.radius.default,background:p.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:P}})}};function m({options:p,value:h,onChange:D,onClick:C,disabled:l,disabledOptions:v,size:y="md",id:P,className:b,fullWidth:S=!1,autoFocus:M=!1,"aria-label":O,invalid:R=!1}){const L=(0,a.useCallback)(A=>()=>{D&&D(A.value)},[D]),B=(0,a.useCallback)(A=>()=>{C&&C(A.value)},[C]),F=P??(0,r.uniqueId)("radiogroup-"),I=(0,a.useRef)(F),U=(0,x.of)(f),W=(0,a.useRef)(null);return(0,a.useEffect)(()=>{M&&W.current&&W.current.focus()},[M]),(0,t.jsx)("div",{role:"radiogroup","aria-label":O,className:(0,n.cx)(U.radioGroup,S&&U.fullWidth,R&&U.invalid,b),children:p.map((A,N)=>{const K=v&&A.value&&v.includes(A.value),V=A.icon?(0,i.Uo)(A.icon):void 0,T=!!(A.imgUrl||A.label||A.component);return(0,t.jsxs)(o,{size:y,disabled:K||l,active:h===A.value,"aria-label":A.ariaLabel,onChange:L(A),onClick:B(A),id:`option-${A.value}-${F}`,name:I.current,description:A.description,fullWidth:S,ref:h===A.value?W:void 0,children:[V&&(0,t.jsx)(s.I,{name:V,className:(0,n.cx)(T&&U.icon)}),A.imgUrl&&(0,t.jsx)("img",{src:A.imgUrl,alt:A.label,className:U.img}),A.label," ",A.component?(0,t.jsx)(A.component,{}):null]},`o.label-${N}`)})})}m.displayName="RadioButtonGroup";const f=p=>({radioGroup:(0,n.css)({backgroundColor:p.colors.background.primary,display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${p.components.input.borderColor}`,borderRadius:p.shape.radius.default,padding:"2px","&:hover":{borderColor:p.components.input.borderHover}}),fullWidth:(0,n.css)({display:"flex"}),icon:(0,n.css)({marginRight:"6px"}),img:(0,n.css)({width:p.spacing(2),height:p.spacing(2),marginRight:p.spacing(1)}),invalid:(0,n.css)({border:`1px solid ${p.colors.error.border}`})})},34511:(q,j,e)=>{"use strict";e.d(j,{J:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({id:x,name:s,label:c,checked:d,value:u,disabled:g,description:o,onChange:E,...m})=>{const f=(0,r.of)(i);return(0,t.jsxs)("label",{title:o,className:f.label,children:[(0,t.jsx)("input",{...m,id:x,name:s,type:"radio",checked:d,value:u,disabled:g,className:f.input,onChange:()=>E&&E(x)}),(0,t.jsxs)("div",{children:[c,o&&(0,t.jsx)("div",{className:f.description,children:o})]})]})},i=x=>({input:(0,n.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:x.colors.background.canvas,width:`${x.spacing(2)} !important`,height:x.spacing(2),border:`1px solid ${x.colors.border.medium}`,borderRadius:x.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:x.v1.palette.white,border:`5px solid ${x.colors.primary.main}`},":disabled":{backgroundColor:`${x.colors.action.disabledBackground} !important`,borderColor:x.colors.border.weak},":disabled:checked":{border:`1px solid ${x.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:x.colors.text.disabled,borderRadius:x.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${x.colors.background.canvas}, 0 0 0 3px ${x.colors.primary.main}`}}),label:(0,n.css)({fontSize:x.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${x.spacing(2)} auto`,gap:x.spacing(1)}),description:(0,n.css)({fontSize:x.typography.size.sm,color:x.colors.text.secondary})})},22084:(q,j,e)=>{"use strict";e.d(j,{a:()=>s});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(29675),x=e(34511);function s({name:d,id:u,options:g,value:o,onChange:E,className:m,disabled:f,disabledOptions:p=[]}){const h=(0,i.of)(c),D=u??(0,r.uniqueId)("radiogroup-list-");return(0,t.jsx)("div",{id:u,className:(0,n.cx)(h.container,m),role:"radiogroup",children:g.map((C,l)=>{const v=`${D}-${l}`,y=o&&o===C.value,P=f||p.some(S=>S===C.value),b=()=>E&&C.value&&E(C.value);return(0,t.jsx)(x.J,{id:v,name:d,label:C.label,description:C.description,checked:y,value:C.value,disabled:P,onChange:b},l)})})}const c=d=>({container:(0,n.css)({display:"grid",gap:d.spacing(1)})})},39841:(q,j,e)=>{"use strict";e.d(j,{_:()=>p});var t=e(74848),n=e(34796),r=e.n(n),a=e(96540),i=e(59141),x=e(8919),s=e(99116),c=e(7500),d=e(91371),u=e(54594),g=e(62931),o=e(42483);const E={mode:s.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function m(h,D,C,l){const v=C!=null,y=l===c.wV.Vertical?D:h,P=Math.min(y*.15/1.5,20),b=P*1.5,S=v?D-b:D,M=Math.min(S,h);return{showLabel:v,gaugeHeight:M,titleFontSize:P}}function f(h,D,C,l){if(D.color?.mode!==g.Y.Thresholds)return[{value:D.min??x.tw,color:C.color??g.F}];const v=D.thresholds??E,y=v.mode===s.O.Percentage,P=v.steps;let b=D.min??x.tw,S=D.max??x.d1;y&&(b=0,S=100);const M=(0,o.yQ)(b,P),O=(0,o.yQ)(S,P),R=[{value:+b.toFixed(h),color:l.visualization.getColorByName(M.color)}];let L=!0;for(let B=0;B<P.length;B++){const F=P[B];if(L){M===F&&(L=!1);continue}const I=P[B-1];if(R.push({value:F.value,color:l.visualization.getColorByName(I.color)}),F===O)break}return R.push({value:+S.toFixed(h),color:l.visualization.getColorByName(O.color)}),R}class p extends a.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:D,value:C,height:l,onClick:v,text:y,theme:P,orientation:b}=this.props,S=m(D,l,C.title,b),M=b===c.wV.Vertical?`${S.gaugeHeight}px`:"100%",O=(0,t.jsx)("div",{style:{height:`${S.gaugeHeight}px`,width:M},ref:R=>this.canvasElement=R});return(0,t.jsxs)(t.Fragment,{children:[v?(0,t.jsx)("button",{className:(0,u.my)(P),type:"button",onClick:v,children:O}):O,S.showLabel&&(0,t.jsx)("div",{style:{textAlign:"center",fontSize:y?.titleSize??S.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:M,top:"-4px",cursor:"default"},children:C.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:E}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:D,showThresholdLabels:C,showThresholdMarkers:l,width:v,height:y,theme:P,value:b,orientation:S}=this.props,M=m(v,y,b.title),O=S===c.wV.Vertical?M.gaugeHeight:v,R=Math.min(O,M.gaugeHeight),L=P.colors.background.secondary,B=C?1.5:1,F=Math.min(R/5.5,40)/B,I=F/5,U=(0,i.cN)(b),A=Math.min(O,R*1.3)*.9-((F+(l?I:0)+(C?10:0))*2+10),N=this.props.text?.valueSize??(0,d.Vr)(U,A,R,1,F*1.7),K=Math.max(N/2.5,12);let V=D.min??x.tw,T=D.max??x.d1,z=b.numeric;D.thresholds?.mode===s.O.Percentage&&(V=0,T=100,b.percent===void 0?z=(z-V)/(T-V)*100:z=b.percent*100);const w=D.decimals===void 0?2:D.decimals;l&&(V=+V.toFixed(w),T=+T.toFixed(w));const H={series:{gauges:{gauge:{min:V,max:T,neutralValue:D.custom?.neutral,background:{color:L},border:{color:null},shadow:{show:!1},width:F},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:f(w,D,b,P),label:{show:C,margin:I+1,font:{size:K}},show:l,width:I},value:{color:b.color,formatter:()=>U,font:{size:N,family:P.typography.fontFamily}},show:!0}}},G={data:[[0,z]],label:b.title};try{this.canvasElement&&r().plot(this.canvasElement,[G],H)}catch(X){console.error("Gauge rendering error",X,H,b)}}render(){return(0,t.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},85836:(q,j,e)=>{"use strict";e.d(j,{w:()=>s});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(37e3),x=e(79784);const s=r.memo(r.forwardRef(({title:d,className:u,children:g,branded:o,url:E,urlTitle:m,onDismiss:f,severity:p="info",...h},D)=>{const C=(0,a.of)(c);return(0,t.jsxs)(i.F,{severity:p,className:u,...h,ref:D,title:d,children:[(0,t.jsx)("div",{children:g}),E&&(0,t.jsxs)("a",{href:E,className:(0,n.cx)("external-link",C.docsLink),target:"_blank",rel:"noreferrer",children:[(0,t.jsx)(x.I,{name:"book"})," ",m||"Read more"]})]})}));s.displayName="InfoBox";const c=d=>({docsLink:(0,n.css)({display:"inline-block",marginTop:d.spacing(2)})})},96260:(q,j,e)=>{"use strict";e.d(j,{r:()=>u});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(96540),s=e(29675),c=e(79784),d=e(75606);function u({referenceElement:E,children:m,suffixIcon:f,placement:p}){const h=(0,s.of)(g),D=(0,s.$j)(),C=[(0,r.cY)(8),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:l,refs:v,floatingStyles:y}=(0,a.we)({open:!0,placement:p,middleware:C,whileElementsMounted:i.ll,strategy:"fixed"});(0,x.useLayoutEffect)(()=>{v.setReference(E)},[E,v]);const{styles:P}=(0,a.DL)(l,{initial:({side:b})=>({opacity:0,transform:o(b,D)}),duration:D.transitions.duration.shortest});return(0,t.jsx)(d.ZL,{children:(0,t.jsx)("div",{style:{display:"inline-block",...y},ref:v.setFloating,"aria-live":"polite",children:(0,t.jsxs)("span",{className:(0,n.cx)(h.root),style:P,children:[m&&(0,t.jsx)("span",{children:m}),f&&(0,t.jsx)(c.I,{name:f})]})})})}const g=E=>({root:(0,n.css)({...E.typography.bodySmall,willChange:"transform",background:E.components.tooltip.background,color:E.components.tooltip.text,padding:E.spacing(.5,1.5),borderRadius:E.shape.radius.pill,display:"inline-flex",gap:E.spacing(.5),alignItems:"center"})}),o=(E,m)=>{switch(E){case"top":return`translateY(${m.spacing(1)})`;case"bottom":return`translateY(-${m.spacing(1)})`;case"left":return`translateX(${m.spacing(1)})`;case"right":return`translateX(-${m.spacing(1)})`}}},95722:(q,j,e)=>{"use strict";e.d(j,{D:()=>x});var t=e(74848),n=e(96540),r=e(91371),a=e(67935),i=e(34128);const x=n.forwardRef((d,u)=>{const{defaultValue:g="",minWidth:o=10,maxWidth:E,onCommitChange:m,onChange:f,onKeyDown:p,onBlur:h,value:D,placeholder:C,...l}=d,[v,y]=c(D,f),P=v??g,b=(0,n.useMemo)(()=>{const S=P||C||"",M=typeof S=="string"?S:S.toString();return s(M,o,E)},[C,P,o,E]);return(0,t.jsx)(a.W.Provider,{value:!0,children:(0,t.jsx)(i.p,{...l,placeholder:C,ref:u,value:P.toString(),onChange:S=>{f&&f(S),y(S.currentTarget.value)},width:b,onBlur:S=>{h?h(S):m&&m(S)},onKeyDown:S=>{p?p(S):S.key==="Enter"&&m&&m(S)},"data-testid":"autosize-input"})})});function s(d,u,g){if(!d)return u;const E=(0,r.kD)(d.toString(),14).width/8+3;return u&&E<u?u:g&&E>g?g:E}x.displayName="AutoSizeInput";function c(d,u){const g=d!==void 0&&u!==void 0,o=(0,n.useRef)(g),E=(0,n.useRef)(!1);g!==o.current&&!E.current&&(console.warn("An AutoSizeInput is changing from an uncontrolled to a controlled input. If you want to control the input, the empty value should be an empty string."),E.current=!0);const[m,f]=n.useState(d);(0,n.useEffect)(()=>{o.current||f(d)},[d]);const p=(0,n.useCallback)(D=>{o.current||f(D)},[]);return[o.current?d:m,p]}},23302:(q,j,e)=>{"use strict";e.d(j,{e:()=>n});var t=e(49785);const n=t.xI},14123:(q,j,e)=>{"use strict";e.d(j,{j:()=>D});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(32885),x=e(8392),s=e(29675),c=e(79784),d=e(16110),u=e(6736),g=e(99764);const o=(0,n.css)({display:"flex",alignItems:"center",height:"100%"});function E({row:y,__rowID:P}){return(0,t.jsx)("div",{className:o,children:(0,t.jsx)(g.K,{tooltip:"toggle row expanded","aria-controls":P,name:y.isExpanded?"angle-down":"angle-right","aria-expanded":y.isExpanded,...y.getToggleRowExpandedProps(),size:"lg"})})}function m({isAllRowsExpanded:y,toggleAllRowsExpanded:P}){return(0,t.jsx)("div",{className:o,children:(0,t.jsx)(g.K,{"aria-label":y?"Collapse all rows":"Expand all rows",name:y?"table-collapse-all":"table-expand-all",onClick:()=>P(),size:"lg",tooltip:y?"Collapse all rows":"Expand all rows",variant:"secondary"})})}const f="__expander";function p(y,P=!1){return[{id:f,Cell:E,...P&&{Header:m},disableSortBy:!0,width:0},...y.map(b=>({id:b.id,accessor:b.id,Header:b.header||(()=>null),sortType:b.sortType||"alphanumeric",disableSortBy:!b.sortType,width:b.disableGrow?0:void 0,visible:b.visible,...b.cell&&{Cell:b.cell}}))]}const h=y=>{const P=y.colors.emphasize(y.colors.background.primary,.03);return{container:(0,n.css)({display:"flex",gap:y.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,n.css)({padding:y.spacing(1),minWidth:y.spacing(3)}),table:(0,n.css)({borderRadius:y.shape.radius.default,width:"100%"}),disableGrow:(0,n.css)({width:0}),header:(0,n.css)({borderBottom:`1px solid ${y.colors.border.weak}`,minWidth:y.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:y.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:y.spacing(2.5),textAlign:"left",fontWeight:y.typography.fontWeightMedium}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${y.colors.border.weak}`,"&:hover":{backgroundColor:P},"&:last-child":{borderBottom:0}}),expandedRow:(0,n.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,n.css)({borderBottom:`1px solid ${y.colors.border.weak}`,position:"relative",padding:y.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:y.spacing(2),background:y.colors.border.medium}}),expandedContentRow:(0,n.css)({label:"expanded-row-content"}),sortableHeader:(0,n.css)({"&&":{padding:0}})}};function D({className:y,columns:P,data:b,getRowId:S,headerTooltips:M,pageSize:O=0,renderExpandedRow:R,showExpandAll:L=!1,fetchData:B,initialSortBy:F=[]}){const I=(0,s.of)(h),U=(0,a.useMemo)(()=>p(P,L),[P,L]),W=C(),A=(0,a.useCallback)(k=>`${W}-${k.id}`.replace(/\s/g,""),[W]),N=[i.useSortBy,i.useExpanded],K=b.length>O,V=O>0;V&&N.push(i.usePagination);const T=(0,i.useTable)({columns:U,data:b,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!B,getRowId:S,initialState:{hiddenColumns:[!R&&f,...U.filter(k=>!(!k.visible||k.visible(b))).map(k=>k.id).filter(x.zz)].filter(x.zz),sortBy:F}},...N),{getTableProps:z,getTableBodyProps:w,headerGroups:H,prepareRow:G}=T,{sortBy:X}=T.state;return(0,a.useEffect)(()=>{B&&B({sortBy:X})},[X,B]),(0,a.useEffect)(()=>{V&&T.setPageSize(O)},[V,O,T.setPageSize,T]),(0,t.jsxs)("div",{className:I.container,children:[(0,t.jsxs)("table",{...z(),className:(0,n.cx)(I.table,y),children:[(0,t.jsx)("thead",{children:H.map(k=>{const{key:_,...ee}=k.getHeaderGroupProps();return(0,t.jsx)("tr",{...ee,children:k.headers.map(J=>{const{key:Z,...te}=J.getHeaderProps(),ae=M?.[J.id];return(0,t.jsx)("th",{className:(0,n.cx)(I.header,{[I.disableGrow]:J.width===0,[I.sortableHeader]:J.canSort}),...te,...J.isSorted&&{"aria-sort":J.isSortedDesc?"descending":"ascending"},children:(0,t.jsx)(v,{column:J,headerTooltip:ae})},Z)})},_)})}),(0,t.jsx)("tbody",{...w(),children:(V?T.page:T.rows).map(k=>{G(k);const{key:_,...ee}=k.getRowProps(),J=A(k),Z=k.isExpanded;return(0,t.jsxs)(a.Fragment,{children:[(0,t.jsx)("tr",{...ee,className:(0,n.cx)(I.row,Z&&I.expandedRow),children:k.cells.map(te=>{const{key:ae,...re}=te.getCellProps();return(0,t.jsx)("td",{className:I.cell,...re,children:te.render("Cell",{__rowID:J})},ae)})}),Z&&R&&(0,t.jsx)("tr",{...ee,id:J,className:I.expandedContentRow,children:(0,t.jsx)("td",{className:I.expandedContentCell,colSpan:k.cells.length,children:R(k.original)})})]},_)})})]}),V&&K&&(0,t.jsx)("span",{children:(0,t.jsx)(d.d,{currentPage:T.state.pageIndex+1,numberOfPages:T.pageOptions.length,onNavigate:k=>T.gotoPage(k-1)})})]})}const C=()=>(0,a.useMemo)(()=>(0,r.uniqueId)("InteractiveTable"),[]),l=y=>({sortIcon:(0,n.css)({position:"absolute",top:y.spacing(1)}),headerTooltipIcon:(0,n.css)({marginLeft:y.spacing(.5)})});function v({column:{canSort:y,render:P,isSorted:b,isSortedDesc:S,getSortByToggleProps:M},headerTooltip:O}){const R=(0,s.of)(l),{onClick:L}=M(),B=(0,t.jsxs)(t.Fragment,{children:[P("Header"),O&&(0,t.jsx)(u.m,{theme:"info-alt",content:O.content,placement:"top-end",children:(0,t.jsx)(c.I,{className:R.headerTooltipIcon,name:O.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),b&&(0,t.jsx)("span",{"aria-hidden":"true",className:R.sortIcon,children:(0,t.jsx)(c.I,{name:S?"angle-down":"angle-up"})})]});return y?(0,t.jsx)("button",{type:"button",onClick:L,children:B}):B}},67676:(q,j,e)=>{"use strict";e.d(j,{B:()=>a});var t=e(74848),n=e(96540),r=e(16703);class a extends n.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,n.createRef)(),this.renderJson=()=>{const{json:x,config:s,open:c,onDidRender:d}=this.props,u=this.wrapperRef.current,g=new r.O(x,c,s);u.hasChildNodes()?u.replaceChild(g.render(),u.lastChild):u.appendChild(g.render()),d&&d(g.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:x}=this.props;return(0,t.jsx)("div",{className:x,ref:this.wrapperRef})}}},16703:(q,j,e)=>{"use strict";e.d(j,{O:()=>h});var t=e(2543);function n(D){return D.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function r(D){return!!D&&typeof D==="object"}function a(D){if(D===void 0)return"";if(D===null||typeof D=="object"&&!D.constructor)return"Object";const l=/function ([^(]*)/.exec(D.constructor.toString());return l&&l.length>1?l[1]:""}function i(D){return D===null?"null":typeof D}function x(D,C){const l=i(D);return l==="null"||l==="undefined"?l:(l==="string"&&(C='"'+n(C)+'"'),l==="function"?D.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":C)}let s="";function c(D){return r(D)?(s=a(D),Array.isArray(D)&&(s+="["+D.length+"]")):s=x(D,D.toString()),s}function d(D){return`json-formatter-${D}`}function u(D,C,l){const v=document.createElement(D);return C&&v.classList.add(d(C)),l!==void 0&&(l instanceof Node?v.appendChild(l):v.appendChild(document.createTextNode(String(l)))),v}const g=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,o=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,E=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,m=10,f=typeof window<"u"&&window.requestAnimationFrame||(D=>(D(),0)),p={animateOpen:!0,animateClose:!0};class h{constructor(C,l=1,v=p,y){this.json=C,this.open=l,this.config=v,this.key=y,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(C){this._isOpen=C}get isDate(){return this.type==="string"&&(g.test(this.json)||E.test(this.json)||o.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return r(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return a(this.json)}get type(){return i(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(C=>C||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(d("open")))}openAtDepth(C=1){C<0||(this.open=C,this.isOpen=C!==0,this.element&&(this.removeChildren(!1),C===0?this.element.classList.remove(d("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(d("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,t.isNumber)(this.json[0])||(0,t.isNumber)(this.json[1]))}renderArray(){const C=u("span");return C.appendChild(u("span","bracket","[")),this.isNumberArray()?(this.json.forEach((l,v)=>{v>0&&C.appendChild(u("span","array-comma",",")),C.appendChild(u("span","number",l))}),this.skipChildren=!0):C.appendChild(u("span","number",this.json.length)),C.appendChild(u("span","bracket","]")),C}render(C=!1){this.element=u("div","row");const l=u("a","toggler-link"),v=u("span","toggler");if(this.isObject&&l.appendChild(v),this.hasKey&&l.appendChild(u("span","key",`${this.key}:`)),this.isObject){const P=u("span","value"),b=u("span"),S=u("span","constructor-name",this.constructorName);if(b.appendChild(S),this.isArray){const M=this.renderArray();b.appendChild(M)}P.appendChild(b),l.appendChild(P)}else{const P=this.isUrl?u("a"):u("span");P.classList.add(d(this.type)),this.isDate&&P.classList.add(d("date")),this.isUrl&&(P.classList.add(d("url")),P.setAttribute("href",this.json));const b=x(this.json,this.json);P.appendChild(document.createTextNode(b)),l.appendChild(P)}const y=u("div","children");return this.isObject&&y.classList.add(d("object")),this.isArray&&y.classList.add(d("array")),this.isEmpty&&y.classList.add(d("empty")),this.config&&this.config.theme&&this.element.classList.add(d(this.config.theme)),this.isOpen&&this.element.classList.add(d("open")),C||this.element.appendChild(l),this.skipChildren?l.removeChild(v):this.element.appendChild(y),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&l.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(C=!1){const l=this.element&&this.element.querySelector(`div.${d("children")}`);if(!(!l||this.isEmpty))if(C){let v=0;const y=()=>{const P=this.keys[v],b=new h(this.json[P],this.open-1,this.config,P);l.appendChild(b.render()),v+=1,v<this.keys.length&&(v>m?y():f(y))};f(y)}else this.keys.forEach(v=>{const y=new h(this.json[v],this.open-1,this.config,v);l.appendChild(y.render())})}removeChildren(C=!1){const l=this.element&&this.element.querySelector(`div.${d("children")}`);if(C){let v=0;const y=()=>{l&&l.children.length&&(l.removeChild(l.children[0]),v+=1,v>m?y():f(y))};f(y)}else l&&(l.innerHTML="")}}},98349:(q,j,e)=>{"use strict";e.d(j,{x:()=>x});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(26777);const x=(0,r.forwardRef)((c,d)=>{const{alignItems:u,children:g,gap:o,columns:E,minColumnWidth:m,...f}=c,p=(0,a.of)(s,o,E,m,u);return(0,t.jsx)("div",{ref:d,...f,className:p.grid,children:g})});x.displayName="Grid";const s=(c,d,u,g,o)=>({grid:(0,n.css)([{display:"grid"},(0,i.Y)(c,d,E=>({gap:c.spacing(E)})),g&&(0,i.Y)(c,g,E=>({gridTemplateColumns:`repeat(auto-fill, minmax(${c.spacing(E)}, 1fr))`})),u&&(0,i.Y)(c,u,E=>({gridTemplateColumns:`repeat(${E}, 1fr)`})),(0,i.Y)(c,o,E=>({alignItems:E}))])})},19550:(q,j,e)=>{"use strict";e.d(j,{Gy:()=>s,PE:()=>x,gW:()=>c,mc:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=(E=>(E[E.Horizontal=0]="Horizontal",E[E.Vertical=1]="Vertical",E))(i||{});const x=({children:E,orientation:m=0,spacing:f="sm",justify:p="flex-start",align:h="normal",wrap:D=!1,width:C="100%",height:l="100%",...v})=>{const y=(0,a.of)(u,m,f,p,h,D);return(0,t.jsx)("div",{className:y.layout,style:{width:C,height:l},...v,children:r.Children.toArray(E).filter(Boolean).map((P,b)=>(0,t.jsx)("div",{className:y.childWrapper,children:P},b))})},s=({children:E,spacing:m,justify:f,align:p="center",wrap:h,width:D,height:C})=>(0,t.jsx)(x,{spacing:m,justify:f,orientation:0,align:p,width:D,height:C,wrap:h,children:E}),c=({children:E,spacing:m,justify:f,align:p,width:h,height:D})=>(0,t.jsx)(x,{spacing:m,justify:f,orientation:1,align:p,width:h,height:D,children:E}),d=({children:E,padding:m,margin:f,grow:p,shrink:h})=>{const D=(0,a.of)(o,m,f);return(0,t.jsx)("div",{className:(0,n.cx)(D.wrapper,p!==void 0&&(0,n.css)({flexGrow:p}),h!==void 0&&(0,n.css)({flexShrink:h})),children:E})},u=(E,m,f,p,h,D)=>{const C=f!=="none"?E.spacing(g[f]):0,l=m===0&&!D||m===1?0:`-${C}`,v=m===1?"vertical-group":"horizontal-group";return{layout:(0,n.css)({label:v,display:"flex",flexDirection:m===1?"column":"row",flexWrap:D?"wrap":"nowrap",justifyContent:p,alignItems:h,height:"100%",maxWidth:"100%",marginBottom:l}),childWrapper:(0,n.css)({label:"layoutChildrenWrapper",marginBottom:m===0&&!D?0:C,marginRight:m===0?C:0,display:"flex",alignItems:h,"&:last-child":{marginBottom:m===1?0:void 0,marginRight:m===0?0:void 0}})}},g={none:0,xs:.5,sm:1,md:2,lg:3},o=(E,m,f)=>{const p=m&&m!=="none"&&E.spacing(g[m])||0,h=f&&f!=="none"&&E.spacing(g[f])||0;return{wrapper:(0,n.css)({label:"container",margin:h,padding:p})}}},9968:(q,j,e)=>{"use strict";e.d(j,{$:()=>r});var t=e(74848),n=e(90231);const r=({v:a=0,h:i=0,layout:x})=>(0,t.jsx)(n.a,{paddingRight:i,paddingBottom:a,display:x==="inline"?"inline-block":"block"})},8270:(q,j,e)=>{"use strict";e.d(j,{N:()=>x});var t=e(74848),n=e(96540),r=e(35557),a=e(2567),i=e(84099);const x=(0,n.forwardRef)(({href:s,children:c,...d},u)=>{const g=a.I.stripBaseFromUrl(i.sQ.sanitizeUrl(s??""));return(0,t.jsx)(r.Link,{ref:u,to:g,...d,children:c})});x.displayName="Link"},54731:(q,j,e)=>{"use strict";e.d(j,{Y:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(84099),i=e(2567),x=e(29675),s=e(79784),c=e(43246),d=e(8270);const u={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},g=(0,r.forwardRef)(({href:E,color:m="link",external:f=!1,inline:p=!0,variant:h="body",weight:D,icon:C,children:l,...v},y)=>{const P=a.sQ.sanitizeUrl(E??""),b=(0,x.$j)(),S=o(b,p,h,D,m),M=C||"external-link-alt";if(f)return(0,t.jsxs)("a",{href:P,ref:y,...v,target:"_blank",rel:"noreferrer",className:S,children:[l,(0,t.jsx)(s.I,{size:u[h]||"md",name:M})]});const O=i.I.stripBaseFromUrl(P);return(0,t.jsxs)(d.N,{ref:y,href:O,...v,className:S,children:[l,C&&(0,t.jsx)(s.I,{name:C,size:u[h]||"md"})]})});g.displayName="TextLink";const o=(E,m,f,p,h)=>(0,n.css)([f&&{...E.typography[f]},p&&{fontWeight:(0,c.iV)(p,E)},h&&{color:E.colors.text[h]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:E.colors.text.link}},m&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},76036:(q,j,e)=>{"use strict";e.d(j,{p:()=>x});var t=e(74848),n=e(22803),r=e(96540),a=e(90617);const i=(0,a.N)((s=!1)=>({list:(0,n.css)({listStyleType:"none",margin:0,padding:0}),item:(0,n.css)({display:s&&"inline-block"||"block"})}));class x extends r.PureComponent{constructor(c){super(c)}render(){const{items:c,renderItem:d,getItemKey:u,className:g,inline:o}=this.props,E=i(o);return(0,t.jsx)("ul",{className:(0,n.cx)(E.list,g),children:c.map((m,f)=>(0,t.jsx)("li",{className:E.item,children:d(m,f)},u?u(m):f))})}}},94653:(q,j,e)=>{"use strict";e.d(j,{c:()=>a});var t=e(74848),n=e(96540),r=e(76036);class a extends n.PureComponent{render(){return(0,t.jsx)(r.p,{inline:!0,...this.props})}}},79878:(q,j,e)=>{"use strict";e.d(j,{B:()=>a});var t=e(74848),n=e(96540),r=e(76036);class a extends n.PureComponent{render(){return(0,t.jsx)(r.p,{...this.props})}}},37008:(q,j,e)=>{"use strict";e.d(j,{G:()=>u});var t=e(74848),n=e(22803),r=e(29675);const a=28,i=2.4,x=500,s=4e3,c=300,d=100/a*100;function u({width:o,delay:E=c,ariaLabel:m="Loading bar"}){const f=Math.min(Math.max(Math.round(o*i),x),s),p=(0,r.of)(g,E,f),h={overflow:"hidden"};return(0,t.jsx)("div",{style:h,children:(0,t.jsx)("div",{"aria-label":m,className:p.bar})})}const g=(o,E,m)=>{const f=(0,n.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${d}%)`}});return{bar:(0,n.css)({width:a+"%",height:1,background:`linear-gradient(90deg, transparent 0%, ${o.colors.primary.main} 80.75%, transparent 100%)`,transform:"translateX(-100%)",willChange:"transform",[o.transitions.handleMotion("no-preference")]:{animationName:f,animationDelay:`${E}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${m}ms`},[o.transitions.handleMotion("reduce")]:{animationName:f,animationDelay:`${E}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*m}ms`}})}}},59748:(q,j,e)=>{"use strict";e.d(j,{O:()=>i});var t=e(74848),n=e(96540),r=e(44826),a=e(51396);const i=({value:x,onChange:s,context:c,item:d})=>{const u=d.settings??{},g=(0,a.sE)(c.data,u?.filter),o=(0,a.m3)(g,x,void 0,void 0,u.baseNameMode),E=(0,n.useCallback)(f=>{if(!(f&&!(0,a.v3)(f.value,g)))return s(f?.value)},[g,s]),m=o.find(f=>f.value===x);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.l6,{value:m,placeholder:u.placeholderText??"Select field",options:o,onChange:E,noOptionsMessage:u.noFieldsMessage,width:u.width,isClearable:u.isClearable!==!1})})}},31642:(q,j,e)=>{"use strict";e.d(j,{bx:()=>d,cH:()=>o});var t=e(74848),n=e(96540),r=e(63739),a=e(38075),i=e(40462),x=e(22399),s=e(44826);const c=(0,n.memo)(E=>{const{data:m,options:f,onChange:p,id:h}=E,D=u(m),C=g(D,f),l=(0,n.useCallback)(y=>p(y.value),[p]),v=C.find(y=>y.value===f);return(0,t.jsx)(s.l6,{inputId:h,value:v,options:C,onChange:l})});c.displayName="FieldTypeMatcherEditor";const d=[{value:r.PU.number,label:"Number",icon:(0,x.lV)(r.PU.number)},{value:r.PU.string,label:"String",icon:(0,x.lV)(r.PU.string)},{value:r.PU.time,label:"Time",icon:(0,x.lV)(r.PU.time)},{value:r.PU.boolean,label:"Boolean",icon:(0,x.lV)(r.PU.boolean)},{value:r.PU.trace,label:"Traces",icon:(0,x.lV)(r.PU.trace)},{value:r.PU.enum,label:"Enum",icon:(0,x.lV)(r.PU.enum)},{value:r.PU.other,label:"Other",icon:(0,x.lV)(r.PU.other)}],u=E=>(0,n.useMemo)(()=>{const m=new Map;for(const f of d)m.set(f.value,0);for(const f of E)for(const p of f.fields){const h=p.type||r.PU.other;let D=m.get(h);D||(D=0),m.set(h,D+1)}return m},[E]),g=(E,m)=>(0,n.useMemo)(()=>{let f=!1;const p=[];for(const h of d){const D=E.get(h.value),C=m===h.value;(D||C)&&p.push({...h,label:`${h.label} (${E.get(h.value)})`}),C&&(f=!0)}return m&&!f&&p.push({value:m,label:`${m} (No matches)`}),p},[E,m]),o={id:a.Ct.byType,component:c,matcher:i.sJ.get(a.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:E=>E}},9312:(q,j,e)=>{"use strict";e.d(j,{N:()=>g,r1:()=>f});var t=e(74848),n=e(22803),r=e(96540),a=e(91357),i=e(38075),x=e(40462),s=e(7500),c=e(29675),d=e(34128),u=e(44826);const g=[{label:"==",value:s.zT.EQ},{label:"!=",value:s.zT.NEQ},{label:">",value:s.zT.GT},{label:">=",value:s.zT.GTE},{label:"<",value:s.zT.LT},{label:"<=",value:s.zT.LTE}];function o(p){return p===a.gy.allIsNull||p===a.gy.allIsZero}const E=({options:p,onChange:h})=>{const D=(0,c.of)(m),C=(0,r.useMemo)(()=>a.AS.selectOptions([p?.reducer]),[p?.reducer]),l=(0,r.useCallback)(S=>h({...p,reducer:S.value}),[p,h]),v=(0,r.useCallback)(S=>h({...p,op:S.value}),[p,h]),y=(0,r.useCallback)(S=>{const M=S.currentTarget.valueAsNumber;return h({...p,value:M})},[p,h]),P=p??{},b=o(P.reducer);return(0,t.jsxs)("div",{className:D.spot,children:[(0,t.jsx)(u.l6,{value:C.current,options:C.options,onChange:l,placeholder:"Select field reducer"}),P.reducer&&!b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.l6,{value:g.find(S=>S.value===P.op),options:g,onChange:v,"aria-label":"Comparison operator",width:19}),(0,t.jsx)(d.p,{type:"number",value:P.value,onChange:y})]})]})},m=p=>({spot:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),f={id:i.Ct.byValue,component:E,matcher:x.sJ.get(i.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:p=>`${p?.reducer} ${p?.op} ${p?.value}`}},97062:(q,j,e)=>{"use strict";e.d(j,{RQ:()=>m,XL:()=>d,gK:()=>g,h:()=>h});var t=e(74848),n=e(96540),r=e(35095),a=e(23570),i=e(38075),x=e(40462),s=e(44826);const c=(D,C,l)=>{if(!l)return;let v=D.find(y=>!C.some(P=>y===P));if(v)return v};function d({value:D,data:C,onChange:l,placeholder:v}){const y=(0,n.useMemo)(()=>o(C),[C]),[P,b]=(0,n.useState)({refIds:[],value:void 0}),S=(0,n.useMemo)(()=>y.find(O=>O.value===D)??c(y,P.refIds,P.value),[D,y,P]),M=(0,n.useCallback)(O=>{l(O?.value)},[l]);return(y!==P.refIds||S?.value!==P.value)&&b({refIds:y,value:S?.value}),(0,t.jsx)(s.l6,{options:y,onChange:M,isClearable:!0,placeholder:v??"Select query refId",value:S})}const u=(D,C,l)=>{if(!l||!l.length)return;const v=D.filter(y=>C.some(P=>y===P));if(v.length)return v};function g({value:D,data:C,onChange:l,placeholder:v}){const y=(0,n.useMemo)(()=>o(C),[C]),[P,b]=(0,n.useState)({refIds:[],value:void 0}),S=(0,n.useMemo)(()=>{let O=new Set;if(D)if(D.startsWith("/^"))try{O=new Set(p(D))}catch{O.add(D)}else D.includes("|")?O=new Set(D.split("|")):O.add(D);const R=y.filter(B=>O.has(B.value||""));if(R.length)return R;const L=[...O].map(r.z);return u(L,P.refIds,P.value)},[D,y,P]),M=(0,n.useCallback)(O=>{l(O.map(R=>R.value))},[l]);return(y!==P.refIds||S?.length!==P.value?.length)&&b({refIds:y,value:S}),(0,t.jsx)(s.KF,{options:y,onChange:M,isClearable:!0,placeholder:v??"Select query refId",value:S})}function o(D){const C=new Map;for(const v of D){const y=v.refId??"",P=C.get(y)??[];P.length===0&&C.set(y,P),P.push(v)}const l=[];for(const[v,y]of C.entries())l.push({value:v,label:`Query: ${v??"(missing refId)"}`,description:E(y)});return l}function E(D){return`Frames (${D.length}):
    ${D.slice(0,Math.min(3,D.length)).map(C=>(0,a.Ri)(C)).join(", ")} ${D.length>3?"...":""}`}const m={id:i.Ct.byFrameRefID,component:D=>(0,t.jsx)(d,{value:D.options,data:D.data,onChange:D.onChange}),matcher:x.sJ.get(i.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:D=>D};function f(D){return D.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const p=D=>D.slice(5,-3).split(/(?<!\\)\|/g).map(C=>C.replace(/\\(.)/g,"$1")),h=D=>`/^(?:${D.map(C=>f(C)).join("|")})$/`},13286:(q,j,e)=>{"use strict";e.d(j,{g:()=>D});var t=e(64015),n=e(74848),r=e(96540),a=e(38075),i=e(40462),x=e(34128);const s=(0,r.memo)(C=>{const{options:l,onChange:v}=C,y=(0,r.useCallback)(P=>v(P.target.value),[v]);return(0,n.jsx)(x.p,{placeholder:"Enter regular expression",defaultValue:l,onBlur:y})});s.displayName="FieldNameByRegexMatcherEditor";const c={id:a.Ct.byRegexp,component:s,matcher:i.sJ.get(a.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:C=>C};var d=e(44826),u=e(51396);const g=(0,r.memo)(C=>{const{data:l,options:v,onChange:y,id:P}=C,b=(0,u.sE)(l),S=(0,u.m3)(b,v),M=(0,r.useCallback)(R=>{if((0,u.v3)(R.value,b))return y(R.value)},[b,y]),O=S.find(R=>R.value===v);return(0,n.jsx)(d.l6,{value:O,options:S,onChange:M,inputId:P})});g.displayName="FieldNameMatcherEditor";const o={id:a.Ct.byName,component:g,matcher:i.sJ.get(a.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:C=>C},E=(0,r.memo)(C=>{const{data:l,options:v,onChange:y}=C,{readOnly:P,prefix:b}=v,S=(0,u.sE)(l),M=(0,u.m3)(S,void 0),O=(0,r.useCallback)(R=>{if(Array.isArray(R))return y({...v,names:R.reduce((L,B)=>((0,u.v3)(B.value,S)&&L.push(B.value),L),[])})},[S,y,v]);if(P){const R=(v.names??[]).join(", ");return(0,n.jsx)(x.p,{value:R,readOnly:!0,disabled:!0,prefix:b})}return(0,n.jsx)(d.KF,{value:v.names,options:M,onChange:O})});E.displayName="FieldNameMatcherEditor";const m={id:a.Ct.byNames,component:E,matcher:i.sJ.get(a.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:C=>(C.names??[]).join(", "),excludeFromPicker:!0};var f=e(31642),p=e(9312),h=e(97062);const D=new t.O(()=>[o,c,f.cH,h.RQ,m,p.r1])},51396:(q,j,e)=>{"use strict";e.d(j,{BP:()=>x,m3:()=>c,sE:()=>s,v3:()=>i});var t=e(96540),n=e(23570),r=e(49448),a=e(22399);function i(d,u){return d?u.display.has(d)||u.raw.has(d):!1}function x(d,u){const g={display:new Set,raw:new Set,fields:new Map};for(const o of d)for(const E of o.fields){if(u&&!u(E))continue;const m=(0,n.Ct)(E,o,d);g.display.add(m),g.fields.set(m,E),E.name&&m!==E.name&&(g.raw.add(E.name),g.fields.set(E.name,E))}return g}function s(d,u){return(0,t.useMemo)(()=>x(d,u),[d,u])}function c(d,u,g,o,E){return(0,t.useMemo)(()=>{let m=!1;const f=[];if(g&&f.push(g),E===r.X4.OnlyBaseNames)for(const p of d.raw)!m&&p===u&&(m=!0),f.push({value:p,label:`${p} (base field name)`});else{for(const p of d.display){!m&&p===u&&(m=!0);const h=d.fields.get(p);(!o||o===h?.type)&&f.push({value:p,label:p,icon:h?(0,a.SS)(h):void 0})}if(E!==r.X4.ExcludeBaseNames)for(const p of d.raw)d.display.has(p)||(!m&&p===u&&(m=!0),f.push({value:p,label:`${p} (base field name)`}))}return u&&!m&&f.push({value:u,label:`${u} (not found)`}),f},[d,u,g,o,E])}},19224:(q,j,e)=>{"use strict";e.d(j,{W:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(90231),x=e(39801),s=e(76795),c=e(36529),d=e(6399);const u=r.forwardRef(({header:E,children:m,ariaLabel:f,onOpen:p,onClose:h,onKeyDown:D,...C},l)=>{const v=(0,a.of)(o),y=(0,r.useRef)(null);(0,r.useImperativeHandle)(l,()=>y.current);const[P]=(0,d.t)({isMenuOpen:!0,localRef:y,onOpen:p,onClose:h,onKeyDown:D});return(0,t.jsxs)(i.a,{...C,"aria-label":f,backgroundColor:"elevated",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:P,paddingX:.5,paddingY:.5,ref:y,role:"menu",tabIndex:-1,children:[E&&(0,t.jsx)("div",{className:(0,n.cx)(v.header,!!m&&r.Children.toArray(m).length>0&&v.headerBorder),children:E}),m]})});u.displayName="Menu";const g=Object.assign(u,{Item:c.D,Divider:x.N,Group:s.r}),o=E=>({header:(0,n.css)({padding:E.spacing(.5,.5,1,.5)}),headerBorder:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,marginBottom:E.spacing(.5)})})},39801:(q,j,e)=>{"use strict";e.d(j,{N:()=>a});var t=e(74848),n=e(22803),r=e(29675);function a(){const x=(0,r.of)(i);return(0,t.jsx)("div",{className:x.divider})}const i=x=>({divider:(0,n.css)({height:1,backgroundColor:x.colors.border.weak,margin:x.spacing(.5,0)})})},76795:(q,j,e)=>{"use strict";e.d(j,{r:()=>x});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(29675);const x=({label:c,ariaLabel:d,children:u})=>{const g=(0,i.of)(s),o=`group-label-${(0,r.uniqueId)()}`;return(0,t.jsxs)("div",{role:"group","aria-labelledby":!d&&c?o:void 0,"aria-label":d,children:[c&&(0,t.jsx)("label",{id:o,className:g.groupLabel,"aria-hidden":!0,children:c}),u]})};x.displayName="MenuGroup";const s=c=>({groupLabel:(0,n.css)({color:c.colors.text.secondary,fontSize:c.typography.size.sm,padding:c.spacing(.5,1)})})},36529:(q,j,e)=>{"use strict";e.d(j,{D:()=>E});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(94963),x=e(79784),s=e(48583),c=e(58779),d=e(6399);const u=f=>{if(!f)return!1;const p=f.parentElement.getBoundingClientRect(),h=f.getBoundingClientRect();return h.width!==0&&p.right+h.width+10>window.innerWidth},g=(0,r.memo)(({items:f,isOpen:p,close:h,customStyle:D})=>{const C=(0,a.of)(o),l=(0,r.useRef)(null),[v]=(0,d.t)({localRef:l,isMenuOpen:p,close:h}),[y,P]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{p&&l.current&&P(u(l.current))},[p]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:C.iconWrapper,"aria-hidden":!0,"data-testid":c.Tp.components.Menu.SubMenu.icon,children:(0,t.jsx)(x.I,{name:"angle-right",className:C.icon})}),p&&(0,t.jsx)("div",{ref:l,className:(0,n.cx)(C.subMenu,{[C.pushLeft]:y}),"data-testid":c.Tp.components.Menu.SubMenu.container,style:D,children:(0,t.jsx)("div",{tabIndex:-1,className:C.itemsWrapper,role:"menu",onKeyDown:v,children:f})})]})});g.displayName="SubMenu";const o=f=>({iconWrapper:(0,n.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,n.css)({opacity:.7,marginLeft:f.spacing(1),color:f.colors.text.secondary}),itemsWrapper:(0,n.css)({background:f.colors.background.elevated,padding:f.spacing(.5),boxShadow:f.shadows.z3,display:"inline-block",borderRadius:f.shape.radius.default}),pushLeft:(0,n.css)({right:"100%",left:"unset"}),subMenu:(0,n.css)({position:"absolute",top:0,left:"100%",zIndex:f.zIndex.dropdown})}),E=r.memo(r.forwardRef((f,p)=>{const{url:h,icon:D,label:C,description:l,ariaLabel:v,ariaChecked:y,target:P,onClick:b,className:S,active:M,disabled:O,destructive:R,childItems:L,role:B,tabIndex:F=-1,customSubMenuContainerStyles:I,shortcut:U,testId:W}=f,A=(0,a.of)(m),[N,K]=(0,r.useState)(M),[V,T]=(0,r.useState)(!1),z=(0,r.useCallback)(()=>{O||(T(!0),K(!0))},[O]),w=(0,r.useCallback)(()=>{O||(T(!1),K(!1))},[O]),H=L&&L.length>0,G=H?"div":h===void 0?"button":"a",X=(0,n.cx)({[A.item]:!0,[A.active]:N,[A.disabled]:O,[A.destructive]:R&&!O},S),k={[G==="button"?"disabled":"aria-disabled"]:O,...G==="a"&&O&&{href:void 0,onClick:void 0},...O&&{tabIndex:-1,"data-disabled":O}},_=(0,r.useRef)(null);(0,r.useImperativeHandle)(p,()=>_.current);const ee=te=>{switch(te.key){case"ArrowRight":te.preventDefault(),te.stopPropagation(),H&&(T(!0),K(!0));break;default:break}},J=()=>{T(!1),K(!1),_?.current?.focus()},Z=!!(U&&U.length>0);return(0,t.jsxs)(G,{target:P,className:X,rel:P==="_blank"?"noopener noreferrer":void 0,href:h,onClick:te=>{H&&!V&&(te.preventDefault(),te.stopPropagation()),b?.(te)},onMouseEnter:z,onMouseLeave:w,onKeyDown:ee,role:h?B:B||"menuitem","data-role":"menuitem",ref:_,"data-testid":W,"aria-label":v,"aria-checked":y,tabIndex:F,...k,children:[(0,t.jsxs)(s.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[D&&(0,t.jsx)(x.I,{name:D,className:A.icon,"aria-hidden":!0}),(0,t.jsx)("span",{className:A.ellipsis,children:C}),(0,t.jsxs)("div",{className:(0,n.cx)(A.rightWrapper,{[A.withShortcut]:Z}),children:[Z&&(0,t.jsxs)("div",{className:A.shortcut,children:[(0,t.jsx)(x.I,{name:"keyboard",title:"keyboard shortcut"}),U]}),H&&(0,t.jsx)(g,{items:L,isOpen:V,close:J,customStyle:I})]})]}),l&&(0,t.jsx)("div",{className:(0,n.cx)(A.description,A.ellipsis,{[A.descriptionWithIcon]:D!==void 0}),children:l}),f.component?(0,t.jsx)(f.component,{}):null]})}));E.displayName="MenuItem";const m=f=>({item:(0,n.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:f.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"center",padding:f.spacing(.5,1.5),minHeight:f.spacing(4),borderRadius:f.shape.radius.default,margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:f.colors.action.hover,color:f.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,i.getFocusStyles)(f)}),active:(0,n.css)({background:f.colors.action.hover}),destructive:(0,n.css)({color:f.colors.error.text,svg:{color:f.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:f.colors.error.main,color:f.colors.error.contrastText,svg:{color:f.colors.error.contrastText}}}),disabled:(0,n.css)({color:f.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:f.colors.action.disabledText}}),icon:(0,n.css)({opacity:.7,color:f.colors.text.secondary}),rightWrapper:(0,n.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,n.css)({minWidth:f.spacing(10.5)}),shortcut:(0,n.css)({display:"flex",alignItems:"center",gap:f.spacing(1),marginLeft:f.spacing(2),color:f.colors.text.secondary,opacity:.7}),description:(0,n.css)({...f.typography.bodySmall,color:f.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,n.css)({marginLeft:f.spacing(3)}),ellipsis:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},6399:(q,j,e)=>{"use strict";e.d(j,{t:()=>i});var t=e(96540),n=e(94701);const r=(x,s)=>(x%s+s)%s,a=-1,i=({localRef:x,isMenuOpen:s,close:c,onOpen:d,onClose:u,onKeyDown:g})=>{const[o,E]=(0,t.useState)(a);return(0,t.useEffect)(()=>{s&&E(0)},[s]),(0,t.useEffect)(()=>{const f=x?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');f?.[o]?.focus(),f?.forEach((p,h)=>{p.tabIndex=h===o?0:-1})},[x,o]),(0,n.A)(()=>{d?.(E)}),[f=>{const p=x?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),h=p?.length??0;switch(f.key){case"ArrowUp":f.preventDefault(),f.stopPropagation(),E(r(o-1,h));break;case"ArrowDown":f.preventDefault(),f.stopPropagation(),E(r(o+1,h));break;case"ArrowLeft":f.preventDefault(),f.stopPropagation(),E(a),c?.();break;case"Home":f.preventDefault(),f.stopPropagation(),E(0);break;case"End":f.preventDefault(),f.stopPropagation(),E(h-1);break;case"Enter":f.preventDefault(),f.stopPropagation(),p?.[o]?.click();break;case"Escape":u?.();break;case"Tab":f.preventDefault(),u?.();break;default:break}g?.(f)}]}},25356:(q,j,e)=>{"use strict";e.d(j,{a:()=>m});var t=e(74848),n=e(22803),r=e(18828),a=e(85690),i=e(93225),x=e(59875),s=e(96540),c=e(29675),d=e(70462),u=e(99764),g=e(48583),o=e(2107),E=e(15506);function m(h){const{title:D,children:C,isOpen:l=!1,closeOnEscape:v=!0,closeOnBackdropClick:y=!0,className:P,contentClassName:b,onDismiss:S,onClickBackdrop:M,trapFocus:O=!0}=h,R=(0,c.of)(E.o),L=(0,s.useRef)(null),{overlayProps:B,underlayProps:F}=(0,i.e)({isKeyboardDismissDisabled:!v,isOpen:l,onClose:S},L),{dialogProps:I,titleProps:U}=(0,r.s)({},L);if(!l)return null;const W=(0,n.cx)(R.modalHeader,typeof D!="string"&&R.modalHeaderWithTabs);return(0,t.jsxs)(x.Sf,{children:[(0,t.jsx)("div",{role:"presentation",className:R.modalBackdrop,onClick:M||(y?S:void 0),...F}),(0,t.jsx)(a.n1,{contain:O,autoFocus:!0,restoreFocus:!0,children:(0,t.jsxs)("div",{className:(0,n.cx)(R.modal,P),ref:L,...B,...I,children:[(0,t.jsxs)("div",{className:W,children:[typeof D=="string"&&(0,t.jsx)(p,{...h,title:D,id:U.id}),typeof D!="string"&&D,(0,t.jsx)("div",{className:R.modalHeaderClose,children:(0,t.jsx)(u.K,{name:"times",size:"xl",onClick:S,"aria-label":(0,d.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,t.jsx)("div",{className:(0,n.cx)(R.modalContent,b),children:C})]})})]})}function f({leftItems:h,children:D}){const C=(0,c.of)(E.o);return h?(0,t.jsx)("div",{className:C.modalButtonRow,children:(0,t.jsxs)(g.B,{justifyContent:"space-between",children:[(0,t.jsx)(g.B,{justifyContent:"flex-start",gap:2,children:h}),(0,t.jsx)(g.B,{justifyContent:"flex-end",gap:2,children:D})]})}):(0,t.jsx)("div",{className:C.modalButtonRow,children:(0,t.jsx)(g.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:D})})}m.ButtonRow=f;function p({icon:h,iconTooltip:D,title:C,id:l}){return(0,t.jsx)(o.r,{icon:h,iconTooltip:D,title:C,id:l})}},2107:(q,j,e)=>{"use strict";e.d(j,{r:()=>a});var t=e(74848),n=e(29675),r=e(15506);const a=({icon:i,iconTooltip:x,title:s,children:c,id:d})=>{const u=(0,n.of)(r.o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:u.modalHeaderTitle,id:d,children:s}),c]})}},37443:(q,j,e)=>{"use strict";e.d(j,{J:()=>i});var t=e(74848),n=e(88849),r=e(10247),a=e(2107);const i=({icon:x,title:s,tabs:c,activeTab:d,onChangeTab:u})=>(0,t.jsx)(a.r,{icon:x,title:s,children:(0,t.jsx)(r.U,{hideBorder:!0,children:c.map((g,o)=>(0,t.jsx)(n.o,{label:g.label,icon:g.icon,suffix:g.tabSuffix,active:g.value===d,onChangeTab:()=>u(g)},`${g.value}-${o}`))})})},43908:(q,j,e)=>{"use strict";e.d(j,{$s:()=>x,EO:()=>i,YO:()=>a,wE:()=>r});var t=e(74848),n=e(96540);const r=n.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class a extends n.Component{constructor(c){super(c),this.showModal=(d,u)=>{this.setState({component:d,props:u})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:c.component||null,props:c.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,t.jsx)(r.Provider,{value:this.state,children:this.props.children})}}const i=()=>(0,t.jsx)(r.Consumer,{children:({component:s,props:c})=>s?(0,t.jsx)(s,{...c}):null}),x=r.Consumer},15506:(q,j,e)=>{"use strict";e.d(j,{o:()=>n});var t=e(22803);const n=r=>{const a=r.shape.radius.default;return{modal:(0,t.css)({position:"fixed",zIndex:r.zIndex.modal,background:r.colors.background.primary,boxShadow:r.shadows.z3,borderRadius:a,border:`1px solid ${r.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,t.css)({position:"fixed",zIndex:r.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:r.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,t.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:r.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,t.css)({borderBottom:`1px solid ${r.colors.border.weak}`}),modalHeaderTitle:(0,t.css)({fontSize:r.typography.size.lg,margin:r.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,t.css)({marginRight:r.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,t.css)({height:"100%",display:"flex",alignItems:"center",color:r.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,t.css)({overflow:"auto",padding:r.spacing(3),width:"100%"}),modalButtonRow:(0,t.css)({paddingTop:r.spacing(3)})}}},86266:(q,j,e)=>{"use strict";e.d(j,{O:()=>n});var t=e(34566);function n(r){const a="${"+r.value+"}",i=r.value===r.label?r.origin:`${r.label} / ${r.origin}`;return{label:a,kind:t.q.Property,detail:i,documentation:r.documentation}}},39645:(q,j,e)=>{"use strict";e.d(j,{d:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(94963),s=e(79784),c=e(99764),d=e(8270),u=e(48194);const g=(0,r.memo)(({title:E,section:m,parent:f,pageIcon:p,onGoBack:h,children:D,titleHref:C,parentHref:l,leftItems:v,isFullscreen:y,className:P,"aria-label":b,buttonOverflowAlignment:S="right",forceShowLeftItems:M=!1})=>{const O=(0,i.of)(o),R=(0,n.cx)("page-toolbar",O.toolbar,{"page-toolbar--fullscreen":y,[O.noPageIcon]:!p},P),L=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:O.truncateText,children:E}),m&&(0,t.jsxs)("span",{className:O.pre,children:[" / ",m]})]});return(0,t.jsxs)("nav",{className:R,"aria-label":b,children:[(0,t.jsxs)("div",{className:O.leftWrapper,children:[p&&!h&&(0,t.jsx)("div",{className:O.pageIcon,children:(0,t.jsx)(s.I,{name:p,size:"lg","aria-hidden":!0})}),h&&(0,t.jsx)("div",{className:O.pageIcon,children:(0,t.jsx)(c.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":a.Tp.components.BackButton.backArrow,onClick:h})}),(0,t.jsxs)("nav",{"aria-label":"Search links",className:O.navElement,children:[f&&l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.N,{"aria-label":`Search dashboard in the ${f} folder`,className:(0,n.cx)(O.titleText,O.parentLink,O.titleLink,O.truncateText),href:l,children:[f," ",(0,t.jsx)("span",{className:O.parentIcon})]}),C&&(0,t.jsx)("span",{className:(0,n.cx)(O.titleText,O.titleDivider),"aria-hidden":!0,children:"/"})]}),(E||!!v?.length)&&(0,t.jsxs)("div",{className:O.titleWrapper,children:[E&&(0,t.jsx)("h1",{className:O.h1Styles,children:C?(0,t.jsx)(d.N,{"aria-label":"Search dashboard by name",className:(0,n.cx)(O.titleText,O.titleLink),href:C,children:L}):(0,t.jsx)("div",{className:O.titleText,children:L})}),v?.map((B,F)=>(0,t.jsx)("div",{className:(0,n.cx)(O.leftActionItem,{[O.forceShowLeftActionItems]:M}),children:B},F))]})]})]}),(0,t.jsx)(u.U,{alignment:S,children:r.Children.toArray(D).filter(Boolean)})]})});g.displayName="PageToolbar";const o=E=>{const{spacing:m,typography:f}=E,p=(0,x.getFocusStyles)(E);return{pre:(0,n.css)({whiteSpace:"pre"}),toolbar:(0,n.css)({alignItems:"center",background:E.colors.background.canvas,display:"flex",gap:E.spacing(2),justifyContent:"space-between",padding:E.spacing(1.5,2),[E.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,n.css)({[E.breakpoints.down("md")]:{paddingLeft:E.spacing(2)}}),leftWrapper:(0,n.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,n.css)({display:"none",[E.breakpoints.up("sm")]:{display:"flex",paddingRight:E.spacing(1),alignItems:"center"}}),truncateText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,n.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,n.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,n.css)({margin:m(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,n.css)({marginLeft:E.spacing(.5)}),titleText:(0,n.css)({display:"flex",fontSize:f.size.lg,margin:0,borderRadius:E.shape.radius.default}),titleLink:(0,n.css)({"&:focus-visible":p}),titleDivider:(0,n.css)({padding:m(0,.5,0,.5),display:"none",[E.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,n.css)({display:"none",[E.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,n.css)({display:"none",alignItems:"center",paddingRight:m(.5),[E.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,n.css)({display:"flex"})}}},16110:(q,j,e)=>{"use strict";e.d(j,{d:()=>s});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(54594),x=e(79784);const s=({currentPage:d,numberOfPages:u,onNavigate:g,hideWhenSinglePage:o,showSmallVersion:E,className:m})=>{const f=(0,a.of)(c),p=E?1:8,h=(0,r.useMemo)(()=>{const D=[...new Array(u).keys()],C=u>p,l=(v,y)=>(0,t.jsx)("li",{className:f.item,children:(0,t.jsx)(i.$n,{size:"sm",variant:y,onClick:()=>g(v),children:v})},v);return D.reduce((v,y)=>{const P=y+1,b=P===d?"primary":"secondary",S=p,M=u-p+1,O=M-S,R=P===1||P===u,L=O>-1&&d>=S&&d<=M,B=E?1:3,F=E?0:2;return C?R||d<S&&P<S||O>=0&&d>M&&P>M||O<0&&d>=S&&P>M||L&&P>=d-F&&P<=d+F?v.push(l(P,b)):(P===S&&d<S||P===M&&d>M||L&&(P===d-B||P===d+B))&&v.push((0,t.jsx)("li",{className:f.item,children:(0,t.jsx)(x.I,{className:f.ellipsis,name:"ellipsis-v"})},P)):v.push(l(P,b)),v},[])},[d,u,g,p,E,f.ellipsis,f.item]);return o&&u<=1?null:(0,t.jsx)("div",{className:(0,n.cx)(f.container,m),children:(0,t.jsxs)("ol",{children:[(0,t.jsx)("li",{className:f.item,children:(0,t.jsx)(i.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>g(d-1),disabled:d===1,children:(0,t.jsx)(x.I,{name:"angle-left"})})}),h,(0,t.jsx)("li",{className:f.item,children:(0,t.jsx)(i.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>g(d+1),disabled:d===u,children:(0,t.jsx)(x.I,{name:"angle-right"})})})]})})},c=()=>({container:(0,n.css)({float:"right"}),item:(0,n.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,n.css)({transform:"rotate(90deg)"})})},28065:(q,j,e)=>{"use strict";e.d(j,{I:()=>s});var t=e(74848),n=e(22803),r=e(58779),a=e(29675),i=e(79784),x=e(6736);const s=({onCancel:u,loading:g})=>{const o=window.matchMedia("(prefers-reduced-motion: reduce)").matches,E=(0,a.of)(d);return g?(0,t.jsx)(x.m,{content:"Cancel query",children:(0,t.jsx)(i.I,{className:(0,n.cx)(E.spin,{[E.clickable]:!!u}),name:o?"hourglass":"sync",size:"sm",onClick:u,"data-testid":r.Tp.components.LoadingIndicator.icon})}):null},c=(0,n.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),d=u=>({clickable:(0,n.css)({cursor:"pointer"}),spin:(0,n.css)({[u.transitions.handleMotion("no-preference")]:{animation:`${c} 3s linear infinite`}})})},90415:(q,j,e)=>{"use strict";e.d(j,{XF:()=>a,d2:()=>i,e4:()=>r});var t=e(96540),n=e(10112);const r=(0,t.createContext)({eventsScope:"global",eventBus:new n.o}),a=r.Provider,i=()=>(0,t.useContext)(r)},96325:(q,j,e)=>{"use strict";e.d(j,{NR:()=>W});var t=e(28065),n=e(74848),r=e(22803),a=e(96540),i=e(42941),x=e(49185),s=e(8392),c=e(58779),d=e(29675),u=e(94963);function g({children:A,delay:N}){const[K,V]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{window.setTimeout(()=>{V(!0)},N)},[A,N]),(0,n.jsx)(n.Fragment,{children:K?A:null})}var o=e(79592),E=e(79784),m=e(37008),f=e(45565),p=e(6736),h=e(60232),D=e(52120);function C({menu:A,title:N,placement:K="bottom",offset:V,dragClassCancel:T,menuButtonClass:z,onOpenMenu:w}){const H=N?c.Tp.components.Panels.Panel.menu(N):"panel-menu-button",G=(0,a.useCallback)(X=>{X&&w&&w()},[w]);return(0,n.jsx)(h.m,{overlay:A,placement:K,offset:V,onVisibleChange:G,children:(0,n.jsx)(D.I,{"aria-label":`Menu for panel with ${N?`title ${N}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":H,className:(0,r.cx)(z,T)})})}function l({menu:A,title:N,dragClass:K,children:V,offset:T=-32,onOpenMenu:z}){const w=(0,d.of)(v),H=(0,a.useRef)(null),G=c.Tp.components.Panels.Panel.HoverWidget,X=(0,a.useCallback)(_=>{H.current?.setPointerCapture(_.pointerId)},[]),k=(0,a.useCallback)(_=>{H.current?.releasePointerCapture(_.pointerId)},[]);return V===void 0||a.Children.count(V)===0?null:(0,n.jsxs)("div",{className:(0,r.cx)(w.container,"show-on-hover"),style:{top:T},"data-testid":G.container,children:[K&&(0,n.jsx)("div",{className:(0,r.cx)(w.square,w.draggable,K),onPointerDown:X,onPointerUp:k,ref:H,"data-testid":G.dragIcon,children:(0,n.jsx)(E.I,{name:"expand-arrows",className:w.draggableIcon})}),V,A&&(0,n.jsx)(C,{menu:A,title:N,placement:"bottom",menuButtonClass:w.menuButton,onOpenMenu:z})]})}function v(A){return{container:(0,r.css)({label:"hover-container-widget",[A.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:A.colors.background.secondary,color:A.colors.text.primary,border:`1px solid ${A.colors.border.weak}`,borderRadius:A.shape.radius.default,height:A.spacing(4),boxShadow:A.shadows.z1}),square:(0,r.css)({display:"flex",justifyContent:"center",alignItems:"center",width:A.spacing(4),height:"100%"}),draggable:(0,r.css)({cursor:"move",[A.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,r.css)({background:"inherit",border:"none","&:hover":{background:A.colors.secondary.main}}),draggableIcon:(0,r.css)({transform:"rotate(45deg)",color:A.colors.text.secondary,"&:hover":{color:A.colors.text.primary}})}}var y=e(54594);const P=(0,a.forwardRef)(({className:A,children:N,href:K,onClick:V,target:T,title:z,...w},H)=>{const G=(0,d.of)(b);return K?(0,n.jsx)("a",{ref:H,href:K,onClick:V,target:T,title:z,className:(0,r.cx)(G.linkItem,A),...w,children:N}):V?(0,n.jsx)(y.$n,{ref:H,className:(0,r.cx)(G.item,A),variant:"secondary",fill:"text",onClick:V,children:N}):(0,n.jsx)("span",{ref:H,className:(0,r.cx)(G.item,A),...w,children:N})});P.displayName="TitleItem";const b=A=>{const N=(0,r.css)({color:`${A.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${A.shape.radius.default}`,padding:`${A.spacing(0,1)}`,height:`${A.spacing(A.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,u.getFocusStyles)(A),zIndex:1},"&: focus:not(:focus-visible)":(0,u.getMouseFocusStyles)(A),"&:hover ":{boxShadow:`${A.shadows.z1}`,background:`${A.colors.background.secondary}`,color:`${A.colors.text.primary}`}});return{item:N,linkItem:(0,r.cx)(N,(0,r.css)({cursor:"pointer"}))}};function S({description:A,className:N}){const K=(0,d.of)(M),V=()=>{const T=typeof A=="function"?A():A;return(0,n.jsx)("div",{className:"panel-info-content markdown-html",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:T}})})};return A!==""?(0,n.jsx)(p.m,{interactive:!0,content:V,children:(0,n.jsx)(P,{className:(0,r.cx)(N,K.description),children:(0,n.jsx)(E.I,{name:"info-circle",size:"md"})})}):null}const M=A=>({description:(0,r.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function O({message:A,onClick:N,ariaLabel:K="status"}){const V=(0,d.of)(R);return(0,n.jsx)(D.I,{className:V.buttonStyles,onClick:N,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:A||"","aria-label":K,"data-testid":c.Tp.components.Panels.Panel.status("error")})}const R=A=>{const{headerHeight:N,padding:K}=A.components.panel;return{buttonStyles:(0,r.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:A.spacing(K),width:A.spacing(N),height:A.spacing(N),borderRadius:A.shape.radius.default})}};function L({width:A,height:N,children:K,padding:V="md",title:T="",description:z="",displayMode:w="default",titleItems:H,menu:G,dragClass:X,dragClassCancel:k,hoverHeader:_=!1,hoverHeaderOffset:ee,loadingState:J,statusMessage:Z,statusMessageOnClick:te,leftItems:ae,actions:re,selectionId:ne,onCancelQuery:ce,onOpenMenu:le,collapsible:he=!1,collapsed:oe,onToggleCollapse:de,onFocus:me,onMouseMove:Pe,onMouseEnter:Ee,onDragStart:be,showMenuAlways:Se=!1}){const Xe=(0,d.$j)(),Qe=(0,d.of)(U),we=(0,a.useId)(),$e=(0,a.useId)().replace(/:/g,"_"),{isSelected:Fe,onSelect:Te}=(0,o.y)(ne),Le=(0,a.useRef)(null),Ge=!_,[Me,De]=(0,i.A)(!0);oe===void 0&&(oe=!Me);const Ke=Se?"always-show":"show-on-hover",Ie=w==="transparent",Ne=F(Xe,Ge),{contentStyle:ie,innerWidth:ve,innerHeight:fe}=I(V,Xe,Ne,oe,N,A),ge={height:Ne,cursor:X?"move":"auto"},xe={width:A,height:oe?void 0:N},[je,{width:Ve}]=(0,x.A)();ae&&(re=ae);const ke=typeof T=="string"?c.Tp.components.Panels.Panel.title(T):"Panel",Oe=(0,n.jsxs)(n.Fragment,{children:[!he&&T&&(0,n.jsx)("div",{className:Qe.title,children:(0,n.jsx)(f.E,{element:"h2",variant:"h6",truncate:!0,title:typeof T=="string"?T:void 0,id:$e,children:T})}),he&&(0,n.jsx)("div",{className:Qe.title,children:(0,n.jsx)(f.E,{element:"h2",variant:"h6",children:(0,n.jsxs)("button",{type:"button",className:Qe.clearButtonStyles,onClick:()=>{De(),de&&de(!oe)},"aria-expanded":!oe,"aria-controls":oe?void 0:we,children:[(0,n.jsx)(E.I,{name:oe?"angle-right":"angle-down","aria-hidden":!!T,"aria-label":T?void 0:"toggle collapse panel"}),(0,n.jsx)(f.E,{variant:"h6",truncate:!0,id:$e,children:T})]})})}),(0,n.jsxs)("div",{className:(0,r.cx)(Qe.titleItems,k),"data-testid":"title-items-container",children:[(0,n.jsx)(S,{description:z,className:k}),H]}),J===s.Gu.Streaming&&(0,n.jsx)(p.m,{content:ce?"Stop streaming":"Streaming",children:(0,n.jsx)(P,{className:k,"data-testid":"panel-streaming",onClick:ce,children:(0,n.jsx)(E.I,{name:"circle-mono",size:"md",className:Qe.streaming})})}),J===s.Gu.Loading&&ce&&(0,n.jsx)(g,{delay:2e3,children:(0,n.jsx)(p.m,{content:"Cancel query",children:(0,n.jsx)(P,{className:(0,r.cx)(k,Qe.pointer),"data-testid":"panel-cancel-query",onClick:ce,children:(0,n.jsx)(E.I,{name:"sync-slash",size:"md"})})})}),(0,n.jsx)("div",{className:Qe.rightAligned,children:re&&(0,n.jsx)("div",{className:Qe.rightActions,children:B(re,nt=>nt)})})]});return(0,n.jsxs)("section",{className:(0,r.cx)(Qe.container,Ie&&Qe.transparentContainer,Fe&&"dashboard-selected-element"),style:xe,"aria-labelledby":T?$e:void 0,"data-testid":ke,tabIndex:0,onFocus:me,onMouseMove:Pe,onMouseEnter:Ee,ref:je,children:[(0,n.jsx)("div",{className:Qe.loadingBarContainer,children:J===s.Gu.Loading?(0,n.jsx)(m.G,{width:Ve,ariaLabel:"Panel loading bar"}):null}),_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{menu:G,title:typeof T=="string"?T:void 0,offset:ee,dragClass:X,onOpenMenu:le,children:Oe}),Z&&(0,n.jsx)("div",{className:Qe.errorContainerFloating,children:(0,n.jsx)(O,{message:Z,onClick:te,ariaLabel:"Panel status"})})]}),Ge&&(0,n.jsxs)("div",{className:(0,r.cx)(Qe.headerContainer,X),style:ge,"data-testid":"header-container",onPointerDown:nt=>{nt.stopPropagation(),Le.current=nt},onPointerMove:()=>{Le.current&&(be?.(Le.current),Le.current=null)},onPointerUp:nt=>{nt.stopPropagation(),Le.current&&k&&nt.target instanceof HTMLElement&&!nt.target.closest(`.${k}`)&&(Te?.(Le.current),Le.current=null)},children:[Z&&(0,n.jsx)("div",{className:k,children:(0,n.jsx)(O,{message:Z,onClick:te,ariaLabel:"Panel status"})}),Oe,G&&(0,n.jsx)(C,{menu:G,title:typeof T=="string"?T:void 0,placement:"bottom-end",menuButtonClass:(0,r.cx)(Qe.menuItem,k,Ke),onOpenMenu:le})]}),!oe&&(0,n.jsx)("div",{id:we,"data-testid":c.Tp.components.Panels.Panel.content,className:(0,r.cx)(Qe.content,N===void 0&&Qe.containNone),style:ie,children:typeof K=="function"?K(ve,fe):K})]})}const B=(A,N)=>{const K=a.Children.toArray(A).filter(Boolean);return K.length>0?N(K):null},F=(A,N)=>N?A.spacing.gridSize*A.components.panel.headerHeight:0,I=(A,N,K,V,T,z)=>{const w=(A==="md"?N.components.panel.padding:0)*N.spacing.gridSize,H=w*2,G=1*2;let X=0;z&&(X=z-H-G);let k=0;return T&&(k=T-K-H-G),V&&(k=K),{contentStyle:{padding:w},innerWidth:X,innerHeight:k}},U=A=>{const{background:N,borderColor:K,padding:V}=A.components.panel;return{container:(0,r.css)({label:"panel-container",backgroundColor:N,border:`1px solid ${K}`,position:"relative",borderRadius:A.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".always-show":{background:"none","&:focus-visible, &:hover":{background:A.colors.secondary.shade}},".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,u.getFocusStyles)(A),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,r.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${K}`}}),loadingBarContainer:(0,r.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,r.css)({contain:"none"}),content:(0,r.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,r.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,r.css)({cursor:"pointer"}),streaming:(0,r.css)({label:"panel-streaming",marginRight:0,color:A.colors.success.text,"&:hover":{color:A.colors.success.text}}),title:(0,r.css)({label:"panel-title",display:"flex",padding:A.spacing(0,V),minWidth:0,"& > h2":{minWidth:0}}),items:(0,r.css)({display:"flex"}),item:(0,r.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,r.css)({visibility:"hidden"}),menuItem:(0,r.css)({label:"panel-menu",border:"none",background:A.colors.secondary.main,"&:hover":{background:A.colors.secondary.shade}}),errorContainerFloating:(0,r.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,r.css)({display:"flex",padding:A.spacing(0,V),gap:A.spacing(1)}),rightAligned:(0,r.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,r.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,r.css)({alignItems:"center",display:"flex",gap:A.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},W=L;W.LoadingIndicator=t.I,W.TitleItem=P},25205:(q,j,e)=>{"use strict";e.d(j,{B:()=>t});var t=(n=>(n.ToggleSelection="select",n.AppendToSelection="append",n))(t||{})},40612:(q,j,e)=>{"use strict";e.d(j,{_:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x,className:s,...c})=>{const d=(0,r.of)(i);return(0,t.jsx)("div",{className:(0,n.cx)(d,s),...c,children:x})},i=x=>(0,n.css)({backgroundColor:x.components.panel.background,border:`1px solid ${x.components.panel.borderColor}`,borderRadius:x.shape.radius.default})},50278:(q,j,e)=>{"use strict";e.d(j,{B:()=>i});var t=e(74848),n=e(41007),r=e(66384);const a={[n.kv.grafana]:"grafana",[n.kv.commercial]:"shield",[n.kv.community]:"shield",DEFAULT:"shield-exclamation"},i=({status:s,color:c,signatureType:d,signatureOrg:u,...g})=>{const o=x(s,d,u);return(0,t.jsx)(r.E,{text:o.text,color:o.color,icon:o.icon,tooltip:o.tooltip,...g})};i.displayName="PluginSignatureBadge";function x(s,c,d){s||(s=n.Ac.invalid);const u=a[c||""]||a.DEFAULT;switch(s){case n.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.Ac.valid:return{text:c||"Signed",icon:c?u:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},54874:(q,j,e)=>{"use strict";e.d(j,{X:()=>y});var t=e(74848),n=e(22803),r=e(46942),a=e.n(r),i=e(2543),x=e.n(i),s=e(96540),c=e(75226),d=e(29317),u=e(58779),g=e(41980),o=e(36643),E=e(2949),m=e(54436),f=e(80687),p=e(65473),h=e(26007),D=e(29675),C=e(94963),l=e(21573);class v extends s.PureComponent{constructor(S){super(S),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(B,F)=>{const I=B.document!==this.state.value.document,U=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(B),this.setState({value:B},()=>{if(I){const W=c.default.serialize(U)!==c.default.serialize(B);W&&F&&this.runOnChangeAndRunQuery(),W&&!F&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:B}=this.props,F=c.default.serialize(this.state.value);B&&B(this.cleanText(F))},this.runOnRunQuery=()=>{const{onRunQuery:B}=this.props;B&&(B(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(B,F,I)=>{const{onBlur:U}=this.props;if(U)U();else{const W=this.lastExecutedValue?c.default.serialize(this.lastExecutedValue):"",A=c.default.serialize(F.value);W!==A&&this.runOnChangeAndRunQuery()}return I()},this.runOnChangeDebounced=(0,i.debounce)(this.runOnChange,500);const{onTypeahead:M,cleanText:O,portalOrigin:R,onWillApplySuggestion:L}=S;this.plugins=[(0,g.Pz)({onTypeahead:M,cleanText:O,portalOrigin:R,onWillApplySuggestion:L}),(0,o.U)({handler:this.runOnChangeAndRunQuery}),(0,E.O)(),(0,m.v)(),(0,f.l)(),(0,p.T)(),(0,h.s)(),...S.additionalPlugins||[]].filter(B=>B),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,l.mO)(S.query||"",S.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(S,M){const{query:O,syntax:R,syntaxLoaded:L}=this.props;if(!S.syntaxLoaded&&L&&this.editor){const F=this.editor.insertText(" ").deleteBackward(1);this.onChange(F.value,!0)}const{value:B}=this.state;O!==S.query&&O!==c.default.serialize(B)&&this.setState({value:(0,l.mO)(O||"",R)})}cleanText(S){return S.replace(/[\r]/g,"")}render(){const{disabled:S,theme:M}=this.props,O=a()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":S}),R=P(M);return(0,t.jsx)("div",{className:(0,n.cx)(O,R.wrapper),children:(0,t.jsx)("div",{className:"slate-query-field","data-testid":u.Tp.components.QueryField.container,children:(0,t.jsx)(d.Editor,{ref:L=>this.editor=L,schema:l.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:L=>{this.onChange(L.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const y=(0,D.cV)(v),P=b=>{const S=(0,C.getFocusStyles)(b);return{wrapper:(0,n.css)({"&:focus-within":S})}}},98140:(q,j,e)=>{"use strict";e.d(j,{cC:()=>o,cb:()=>g});var t=e(74848),n=e(22803),r=e(58521),a=e(96540),i=e(66102),x=e(58779),s=e(70462),c=e(90333),d=e(31035),u=e(52120);const g=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class o extends a.PureComponent{constructor(p){super(p),this.onChangeSelect=h=>{const{onIntervalChanged:D}=this.props;D&&h.value!=null&&D(h.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=p=>p===o.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:p,intervals:h,tooltip:D,value:C,text:l,isLoading:v,noIntervalPicker:y,width:P,showAutoInterval:b}=this.props,S=C||"",M=this.getVariant(),O=m({intervals:h,showAutoInterval:b}),R=O.find(({value:V})=>V===S),L=E(o.offOption.value);let B=R||L;B.label===L.label&&(B={value:""});const F=B.ariaLabel,I=(0,s.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:F}),U=(0,s.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),W=B.value===""?U:I,A=(0,s.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),N=(0,s.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),K=B.value===""?N:A;return(0,t.jsxs)(c.e,{className:"refresh-picker",children:[(0,t.jsx)(u.I,{"aria-label":l,tooltip:D,onClick:p,variant:M,icon:v?"spinner":"sync",style:P?{width:P}:void 0,"data-testid":x.Tp.components.RefreshPicker.runButtonV2,children:l}),!y&&(0,t.jsx)(d.f,{className:(0,n.css)({borderTopLeftRadius:0,borderBottomLeftRadius:0}),value:B,options:O,onChange:this.onChangeSelect,variant:M,"data-testid":x.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":W,tooltip:K})]})}}function E(f){switch(f){case o.liveOption.value:return{label:(0,s.t)("refresh-picker.live-option.label","Live"),value:f,ariaLabel:(0,s.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case o.offOption.value:return{label:(0,s.t)("refresh-picker.off-option.label","Off"),value:f,ariaLabel:(0,s.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case o.autoOption.value:return{label:(0,s.t)("refresh-picker.auto-option.label",o.autoOption.label),value:f,ariaLabel:(0,s.t)("refresh-picker.auto-option.aria-label",o.autoOption.ariaLabel)}}return{label:f,value:f}}function m({intervals:f=g,showAutoInterval:p=!1}={}){const h=f.map(D=>{const C=(0,i.E9)(D),l=(0,r.a)(C);return{label:D,value:D,ariaLabel:l}});return p&&h.unshift(E(o.autoOption.value)),h.unshift(E(o.offOption.value)),h}},15600:(q,j,e)=>{"use strict";e.d(j,{I:()=>r});var t=e(96540),n=e(84099);function r({component:a,content:i,...x}){return t.createElement(a||"span",{dangerouslySetInnerHTML:{__html:n.sQ.sanitize(i)},...x})}},25476:(q,j,e)=>{"use strict";e.d(j,{L:()=>d});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(70462),x=e(54594),s=e(65360);const c=()=>({noRadiusInput:(0,n.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,n.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),d=({label:u="Password",labelWidth:g,inputWidth:o=12,onReset:E,isConfigured:m,tooltip:f,placeholder:p="Password",interactive:h,...D})=>{const C=c();return(0,t.jsx)(s.z,{label:u,tooltip:f,interactive:h,labelWidth:g,inputEl:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:(0,n.cx)(`gf-form-input width-${o}`,C.noRadiusInput),disabled:!0,value:"configured",...(0,r.omit)(D,"value")}),(0,t.jsx)(x.$n,{onClick:E,variant:"secondary",type:"button",children:(0,t.jsx)(i.x,{i18nKey:"grafana-ui.secret-form-field.reset",children:"Reset"})})]}):(0,t.jsx)("input",{type:"password",className:`gf-form-input width-${o}`,placeholder:p,...D})})};d.displayName="SecretFormField"},79232:(q,j,e)=>{"use strict";e.d(j,{L4:()=>s});var t=e(74848),n=e(54594),r=e(34128),a=e(48583);const i="configured",x="Reset",s=({isConfigured:c,onReset:d,...u})=>(0,t.jsxs)(a.B,{children:[!c&&(0,t.jsx)(r.p,{...u,type:"password"}),c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{...u,type:"text",disabled:!0,value:i}),(0,t.jsx)(n.$n,{onClick:d,variant:"secondary",children:x})]})]})},72978:(q,j,e)=>{"use strict";e.d(j,{lp:()=>g});var t=e(74848),n=e(22803),r=e(29675),a=e(54594),i=e(90231),x=e(48583),s=e(50926);const c="configured",d="Reset",u=o=>({configuredStyle:(0,n.css)({minHeight:o.spacing(o.components.height.md),paddingTop:o.spacing(.5),resize:"none"})}),g=({isConfigured:o,onReset:E,...m})=>{const f=(0,r.of)(u);return(0,t.jsxs)(x.B,{children:[(0,t.jsxs)(i.a,{children:[!o&&(0,t.jsx)(s.f,{...m}),o&&(0,t.jsx)(s.f,{...m,rows:1,disabled:!0,value:c,className:(0,n.cx)(f.configuredStyle)})]}),o&&(0,t.jsx)(a.$n,{onClick:E,variant:"secondary",children:d})]})}},67692:(q,j,e)=>{"use strict";e.d(j,{Y:()=>u});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(29675),x=e(76302),s=e(84900),c=e(63295),d=e(72878);function u({options:g,value:o,onChange:E,Component:m,className:f,allowCustomValue:p,allowEmptyValue:h,placeholder:D,disabled:C,inputMinWidth:l,inputPlaceholder:v,onExpandedChange:y,autofocus:P=!1,...b}){const[S,M,O,R]=(0,d.Q)(P,y),L=l?Math.max(l,M):M,B=(0,i.of)(c.m);if(!O){const F=(0,r.isObject)(o)?o.label:o,I=F!=null?String(F):void 0;return(0,t.jsx)(S,{disabled:C,Component:m||(0,t.jsx)(x.c,{className:(0,n.cx)(B.segment,{[B.queryPlaceholder]:D!==void 0&&!o,[B.disabled]:C},f),children:I||D})})}return(0,t.jsx)(s.a,{...b,value:o&&!(0,r.isObject)(o)?{value:o}:o,placeholder:v,options:g,width:L,onClickOutside:()=>R(!1),allowCustomValue:p,allowEmptyValue:h,onChange:F=>{R(!1),E(F)}})}},80762:(q,j,e)=>{"use strict";e.d(j,{s:()=>o});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(41053),x=e(29675),s=e(70462),c=e(76302),d=e(84900),u=e(63295),g=e(72878);function o({value:m,onChange:f,loadOptions:p,reloadOptionsOnChange:h=!1,Component:D,className:C,allowCustomValue:l,allowEmptyValue:v,disabled:y,placeholder:P,inputMinWidth:b,inputPlaceholder:S,autofocus:M=!1,onExpandedChange:O,noOptionMessageHandler:R=E,...L}){const[B,F]=(0,i.A)(p,[p]),[I,U,W,A]=(0,g.Q)(M,O),N=b?Math.max(b,U):U,K=(0,x.of)(u.m);if(!W){const V=(0,r.isObject)(m)?m.label:m,T=V!=null?String(V):void 0;return(0,t.jsx)(I,{onClick:h?void 0:F,disabled:y,Component:D||(0,t.jsx)(c.c,{className:(0,n.cx)(K.segment,{[K.queryPlaceholder]:P!==void 0&&!m,[K.disabled]:y},C),children:T||P})})}return(0,t.jsx)(d.a,{...L,value:m&&!(0,r.isObject)(m)?{value:m}:m,placeholder:S,options:B.value??[],loadOptions:h?F:void 0,width:N,noOptionsMessage:R(B),allowCustomValue:l,allowEmptyValue:v,onClickOutside:()=>{A(!1)},onChange:V=>{A(!1),f(V)}})}function E(m){return m.loading?(0,s.t)("grafana-ui.segment-async.loading","Loading options..."):m.error?(0,s.t)("grafana-ui.segment-async.error","Failed to load options"):(0,s.t)("grafana-ui.segment-async.no-options","No options found")}},83278:(q,j,e)=>{"use strict";e.d(j,{o:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(37151),i=e(29675),x=e(91371),s=e(76302),c=e(63295),d=e(72878);const u=14;function g({value:o,onChange:E,Component:m,className:f,placeholder:p,inputPlaceholder:h,disabled:D,autofocus:C=!1,onExpandedChange:l,...v}){const y=(0,r.useRef)(null),[P,b]=(0,r.useState)(o),[S,M]=(0,r.useState)((0,x.kD)((o||"").toString(),u).width),[O,,R,L]=(0,d.Q)(C,l),B=(0,i.of)(c.m);if((0,a.A)(y,()=>{L(!1),E(P)}),!R)return(0,t.jsx)(O,{disabled:D,Component:m||(0,t.jsx)(s.c,{className:(0,n.cx)(B.segment,{[B.queryPlaceholder]:p!==void 0&&!P,[B.disabled]:D},f),children:o||p})});const F=(0,n.css)({width:`${Math.max(S+20,32)}px`});return(0,t.jsx)("input",{...v,ref:y,autoFocus:!0,className:(0,n.cx)("gf-form gf-form-input",F),value:P,placeholder:h,onChange:I=>{const{width:U}=(0,x.kD)(I.target.value,u);M(U),b(I.target.value)},onBlur:()=>{L(!1),E(P)},onKeyDown:I=>{[13,27].includes(I.keyCode)&&(L(!1),E(P))}})}},94479:(q,j,e)=>{"use strict";e.d(j,{L:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(77222),i=e(76302);const x=({label:c,htmlFor:d,children:u,fill:g})=>{const o=(0,r.of)(s);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(a.C,{children:[(0,t.jsx)(i.c,{htmlFor:d,width:12,className:o.label,children:c}),u,g&&(0,t.jsx)("div",{className:o.fill,children:(0,t.jsx)(i.c,{children:""})})]})})},s=c=>({label:(0,n.css)({color:c.colors.primary.text}),fill:(0,n.css)({flexGrow:1,marginBottom:c.spacing(.5)})})},84900:(q,j,e)=>{"use strict";e.d(j,{a:()=>i});var t=e(74848),n=e(96540),r=e(29675),a=e(44826);function i({value:x,placeholder:s="",options:c=[],onChange:d,onClickOutside:u,loadOptions:g=void 0,width:o,noOptionsMessage:E="",allowCustomValue:m=!1,allowEmptyValue:f=!1,...p}){const h=(0,n.useRef)(null),D=(0,r.$j)();let C=o>0?o/D.spacing.gridSize:void 0,l,v={};return g?(l=a.DW,v={loadOptions:g,defaultOptions:!0}):l=a.l6,(0,t.jsx)("div",{...p,ref:h,children:(0,t.jsx)(l,{width:C,noOptionsMessage:E,placeholder:s,autoFocus:!0,isOpen:!0,onChange:d,options:c,value:x,closeMenuOnSelect:!1,onCloseMenu:()=>{if(h&&h.current){const y=h.current.querySelector('input[id^="react-select-"]');y&&(y.value||f)?d({value:y.value,label:y.value}):u()}},allowCustomValue:m,...v})})}},63295:(q,j,e)=>{"use strict";e.d(j,{m:()=>n});var t=e(22803);const n=r=>{const a="v1"in r?r.v1.palette:r.palette;return{segment:(0,t.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,t.css)({color:a.gray2}),disabled:(0,t.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},72878:(q,j,e)=>{"use strict";e.d(j,{Q:()=>i});var t=e(74848),n=e(96540),r=e(29675),a=e(54594);const i=(x,s)=>{const c=(0,n.useRef)(null),d=(0,r.of)(a.my),[u,g]=(0,n.useState)(x),[o,E]=(0,n.useState)(0),m=p=>{g(p),s&&s(p)};return[({Component:p,onClick:h,disabled:D})=>(0,t.jsx)("button",{type:"button",className:d,ref:c,disabled:D,onClick:()=>{m(!0),c&&c.current&&E(c.current.clientWidth*1.25),h?.()},children:p}),o,u,m]}},83736:(q,j,e)=>{"use strict";e.d(j,{u:()=>E});var t=e(2543),n=e.n(t),r=e(96540),a=e(13752),i=e(62467),x=e(11150),s=e(96083),c=e(63720),d=e(59099),u=e(67793),g=e(98140);function o(m){return{label:m,value:stringToMs(m)}}class E extends r.PureComponent{constructor(f){super(f),this.propsSubject=new a.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,c.n)(f=>g.cC.isLive(f.interval)?(0,i.of)({}):f.loading?x.t:(0,s.Y)((0,u.dc)(f.interval))),(0,d.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(f){g.cC.isLive(f.interval)&&g.cC.isLive(this.props.interval)||(0,t.isEqual)(f,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},37256:(q,j,e)=>{"use strict";e.d(j,{I1:()=>C,_$:()=>f,gl:()=>o});var t=e(2543),n=e.n(t),r=e(21288),a=e(91357),i=e(99116),x=e(16060),s=e(62931),c=e(47286),d=e(42483),u=e(7500);const g=["reduceOptions","orientation"];function o(y,P,b){let S=y.options;if(y.fieldConfig=y.fieldConfig||{defaults:{},overrides:[]},P==="singlestat"&&b.angular)return m(y,b);if(P==="graph")return E(y,b);for(const M of g)b.hasOwnProperty(M)&&(S[M]=(0,t.cloneDeep)(b[M]));return S}function E(y,P){const b=P.angular,S={orientation:r.wV.Auto,reduceOptions:{values:!1,calcs:[]},legend:{displayMode:u.lm.List,showLegend:!0,placement:"bottom",calcs:[]}};if(b.xaxis?.mode==="series"){y.fieldConfig={...y.fieldConfig,defaults:{...y.fieldConfig.defaults,color:{mode:"palette-classic"}}},b.xaxis.values&&(S.reduceOptions.calcs=v(b.xaxis.values));const M=b.legend;if(M){if(M.show?S.legend.displayMode=M.alignAsTable?u.lm.Table:u.lm.List:S.legend.showLegend=!1,M.rightSide&&(S.legend.placement="right"),M.values){const O=(0,t.pickBy)(M,t.identity);S.legend.calcs=l(O)}M.sideWidth&&(S.legend.width=M.sideWidth)}}return S}function m(y,P){const b=P.angular,S=a.AS.getIfExists(b.valueName),M={reduceOptions:{calcs:[S?S.id:a.gy.mean]},orientation:r.wV.Horizontal},O={};if(b.format&&(O.unit=b.format),b.tableColumn&&(M.reduceOptions.fields=`/^${b.tableColumn}$/`),b.nullPointMode&&(O.nullValueMode=b.nullPointMode),b.nullText&&(O.noValue=b.nullText),(b.decimals||b.decimals===0)&&(O.decimals=b.decimals),b.thresholds&&b.colors){const L=b.thresholds.split(",").map(F=>Number(F.trim())),B=[];for(const F of b.colors){const I=B.length-1;I>=0?B.push({value:L[I],color:F}):B.push({value:-1/0,color:F})}O.thresholds={mode:i.O.Absolute,steps:B}}const R=(0,x.bh)(b,O.thresholds);return R&&R.length&&(O.mappings=R),b.gauge&&b.gauge.show&&(O.min=b.gauge.minValue,O.max=b.gauge.maxValue),y.fieldConfig.defaults=O,M}function f(y){if(!y.options)return{};const P=parseFloat(y.pluginVersion||"6.1");let b=y.options;P<6.2&&(b=h(b)),P<6.3&&(b=p(b));const{fieldOptions:S}=b;if(P<6.6&&S){if(S&&S.override){const{override:R,...L}=b.fieldOptions;b={...b,fieldOptions:{...L,overrides:[]}}}let M=S?.defaults?.thresholds;M?delete S.defaults.thresholds:(M=S?.thresholds,delete S.thresholds),M&&(S.defaults.thresholds={mode:i.O.Absolute,steps:M});const{defaults:O}=S;O.color&&typeof O.color=="string"&&(O.color={mode:s.Y.Fixed,fixedColor:O.color}),(0,c.BF)(O)}if(P<7&&(y.fieldConfig=y.fieldConfig||{defaults:{},overrides:[]},y.fieldConfig={defaults:S&&S.defaults?{...y.fieldConfig.defaults,...S.defaults}:y.fieldConfig.defaults,overrides:S&&S.overrides?[...y.fieldConfig.overrides,...S.overrides]:y.fieldConfig.overrides},S&&(b.reduceOptions={values:S.values,limit:S.limit,calcs:S.calcs}),delete b.fieldOptions),P<7.1){const M=y.fieldConfig.defaults.title;M!=null&&(y.fieldConfig.defaults.displayName=M,delete y.fieldConfig.defaults.title)}if(P<8){const M=y.fieldConfig?.defaults;let O=M?.unit;O==="percent"?((0,t.isNumber)(M.min)||(M.min=0),(0,t.isNumber)(M.max)||(M.max=100)):O==="percentunit"&&((0,t.isNumber)(M.min)||(M.min=0),(0,t.isNumber)(M.max)||(M.max=1))}return b}function p(y){const{fieldOptions:P}=y;if(!P)return y;const{mappings:b,...S}=y.fieldOptions;let M;return y.thresholds&&(M={mode:i.O.Absolute,steps:D(y.thresholds)}),{...y,fieldOptions:{...S,defaults:{...P.defaults,mappings:b,thresholds:M}}}}function h(y){const{valueOptions:P}=y;if(!P)return y;const b={},S={};if(b.mappings=y.valueMappings,b.thresholds=y.thresholds,b.defaults=S,S.unit=P.unit,S.decimals=P.decimals,P.stat){const O=a.AS.get(P.stat);O&&(b.calcs=[O.id])}S.min=y.minValue,S.max=y.maxValue;const M={...y,fieldOptions:b};return(0,t.omit)(M,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function D(y){if(!y||!y.length)return;const P=y.map(b=>({value:b.value===null?-1/0:b.value,color:b.color}));return(0,d.RU)(P),P[0].value=-1/0,P}function C(y){return(0,x.bh)(y)}function l(y){const P=[];for(const b in y){const S=a.AS.getIfExists(b);S&&P.push(S.id)}return P}function v(y){const P=[];return y?.forEach(b=>{Object.values(a.gy).includes(b)?P.push(b):b==="current"?P.push(a.gy.lastNotNull):b==="total"?P.push(a.gy.sum):b==="avg"&&P.push(a.gy.mean)}),y?P:[a.gy.sum]}},83437:(q,j,e)=>{"use strict";e.d(j,{F:()=>o});var t=e(74848),n=e(22803),r=e(17437),a=e(55168),i=e(96540),x=e(29675),s=e(80427);const c=E=>{const{value:m,children:f,visible:p,placement:h,tipFormatter:D,...C}=E,l=(0,i.useRef)(null),v=(0,i.useRef)(null),y=(0,x.of)(d);function P(){v.current!==null&&cancelAnimationFrame(v.current)}function b(){v.current=requestAnimationFrame(()=>{l.current?.forceAlign()})}return(0,i.useEffect)(()=>(p?b():P(),P),[m,p]),(0,t.jsx)(s.A,{overlayClassName:y.tooltip,placement:h,overlay:D??m,overlayInnerStyle:{minHeight:"auto"},ref:l,visible:p,...C,children:f})},d=E=>({tooltip:(0,n.css)({position:"absolute",display:"block",visibility:"visible",fontSize:E.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:E.zIndex.tooltip})}),u=c;var g=e(19331);const o=({min:E,max:m,onChange:f,onAfterChange:p,orientation:h="horizontal",reverse:D,step:C,formatTooltipResult:l,value:v,tooltipAlwaysVisible:y=!0})=>{const P=(0,i.useCallback)(R=>{f?.(typeof R=="number"?[R,R]:R)},[f]),b=(0,i.useCallback)(R=>{p?.(typeof R=="number"?[R,R]:R)},[p]),S=h==="horizontal",M=(0,x.of)(g.$,S),O=(R,L)=>(0,t.jsx)(u,{value:L.value,visible:y||L.dragging,tipFormatter:l?()=>l(L.value):void 0,placement:S?"top":"right",children:R});return(0,t.jsxs)("div",{className:(0,n.cx)(M.container,M.slider),children:[(0,t.jsx)(r.Global,{styles:M.tooltip}),(0,t.jsx)(a.A,{min:E,max:m,step:C,defaultValue:v,range:!0,onChange:P,onChangeComplete:b,vertical:!S,reverse:D,handleRender:O})]})};o.displayName="RangeSlider"},19331:(q,j,e)=>{"use strict";e.d(j,{$:()=>r});var t=e(22803),n=e(17437);const r=(a,i,x=!1)=>{const{spacing:s}=a,c=a.colors.border.strong,d=a.colors.primary.main,u=a.colors.primary.main,o=`box-shadow: 0px 0px 0px 6px ${a.colors.primary.transparent}`;return{container:(0,t.css)({width:"100%",margin:i?"inherit":s(1,3,1,1),paddingBottom:i&&x?a.spacing(1):"inherit",height:i?"auto":"100%"}),slider:(0,t.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${a.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${a.colors.text.disabled};
        font-size: ${a.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${a.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${u};
        box-shadow: ${a.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${o};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${a.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${a.colors.text.primary};
        border-color: ${a.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${d};
      }
      .rc-slider-rail {
        background-color: ${c};
        cursor: pointer;
      }
    `,tooltip:(0,n.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${a.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${a.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,t.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,t.css)({marginLeft:a.spacing(3),input:{textAlign:"center"}}),sliderInputFieldVertical:(0,t.css)({margin:`0 0 ${a.spacing(3)} 0`,order:1})}}},392:(q,j,e)=>{"use strict";e.d(j,{O:()=>h});var t=e(74848),n=e(2543),r=e(96540),a=e(54430),i=e(2049),x=e(63739),s=e(18752),c=e(7500),d=e(87579),u=e(5858),g=e(7257),o=e(77230),E=e(4038),m=e(66380);function f(D,C){const l=D.y.values.length,v={...D.y.config,...C},y=D.x??{name:"",values:[...Array(l).keys()],type:x.PU.number,config:{}};let P={refId:"sparkline",fields:[y,{...D.y,config:v}],length:l};return(0,o.g2)(y.values)||(P=(0,E.ES)(P,0)),(0,m.M)({frame:P,refFieldPseudoMin:D.timeRange?.from.valueOf(),refFieldPseudoMax:D.timeRange?.to.valueOf()})}const p={drawStyle:c.GR.Line,showPoints:c.yL.Auto,axisPlacement:c.vM.Hidden,pointSize:2};class h extends r.PureComponent{constructor(C){super(C);const l=f(C.sparkline,C.config);this.state={data:(0,g.bq)(l,(0,g.ro)(l)),alignedDataFrame:l,configBuilder:this.prepareConfig(l)}}static getDerivedStateFromProps(C,l){const v=f(C.sparkline,C.config),y=(0,a.C)(v);return y?{...l,data:(0,g.bq)(y,(0,g.ro)(y)),alignedDataFrame:y}:{...l}}componentDidUpdate(C,l){const{alignedDataFrame:v}=this.state;if(!v)return;let y=!1;if(C.sparkline!==this.props.sparkline){const P=!(0,i.bW)(this.state.alignedDataFrame,l.alignedDataFrame),b=!(0,n.isEqual)(v.fields[1].state?.range,l.alignedDataFrame.fields[1].state?.range);y=P||b}else y=!(0,n.isEqual)(C.config,this.props.config);y&&this.setState({configBuilder:this.prepareConfig(v)})}getYRange(C){let{min:l,max:v}=this.state.alignedDataFrame.fields[1].state?.range;const y=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(y)||(l=Math.min(l,+y),v=Math.max(v,+y)),l===v?(l===0?v=100:(l=0,v*=2),[l,v]):[Math.max(l,C.config.min??-1/0),Math.min(v,C.config.max??1/0)]}prepareConfig(C){const{theme:l}=this.props,v=new u.e;v.setCursor({show:!1,x:!1,y:!1});const y=C.fields[0];v.addScale({scaleKey:"x",orientation:c.Lt.Horizontal,direction:c.ON.Right,isTime:!1,range:()=>{const{sparkline:P}=this.props;if(P.x){if(P.timeRange&&P.x.type===x.PU.time)return[P.timeRange.from.valueOf(),P.timeRange.to.valueOf()];const b=P.x.values;return[b[0],b[b.length-1]]}return[0,P.y.values.length-1]}}),v.addAxis({scaleKey:"x",theme:l,placement:c.vM.Hidden});for(let P=0;P<C.fields.length;P++){const b=C.fields[P],S=b.config,M={...p,...S.custom};if(b===y||b.type!==x.PU.number)continue;const O=S.unit||"__fixed";v.addScale({scaleKey:O,orientation:c.Lt.Vertical,direction:c.ON.Up,range:()=>this.getYRange(b)}),v.addAxis({scaleKey:O,theme:l,placement:c.vM.Hidden});const R=(0,s.Qi)(b),L=R.getCalculator(b,l)(0,0),B=M.drawStyle===c.GR.Points?c.yL.Always:M.showPoints;v.addSeries({pxAlign:!1,scaleKey:O,theme:l,colorMode:R,thresholds:S.thresholds,drawStyle:M.drawStyle,lineColor:M.lineColor??L,lineWidth:M.lineWidth,lineInterpolation:M.lineInterpolation,showPoints:B,pointSize:M.pointSize,fillOpacity:M.fillOpacity,fillColor:M.fillColor,lineStyle:M.lineStyle,gradientMode:M.gradientMode,spanNulls:M.spanNulls})}return v}render(){const{data:C,configBuilder:l}=this.state,{width:v,height:y}=this.props;return(0,t.jsx)(d.Z,{data:C,config:l,width:v,height:y})}}},13147:(q,j,e)=>{"use strict";e.d(j,{h:()=>g});var t=e(22803),n=e(2543),r=e.n(n),a=e(96540),i=e(29675),x=e(14382);const s=.3,c=new Set(["ArrowUp","ArrowDown"]),d=new Set(["ArrowLeft","ArrowRight"]),u={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function g(h){const{direction:D,initialSize:C=.5,dragPosition:l="middle",onResizing:v,onSizeChanged:y}=h,P=p(h.handleSize),b=(0,a.useRef)(null),S=(0,a.useRef)(null),M=(0,a.useRef)(null),O=(0,a.useRef)(null),R=(0,a.useRef)(null),L=(0,a.useRef)("1fr"),B=(0,a.useRef)(void 0),F=(0,a.useRef)(void 0),I=u[D].dim,U=u[D].axis,W=u[D].min,A=u[D].max;m(O.current,ne=>{for(const ce of ne){if(!ce.target.isSameNode(O.current)||!S.current)return;const le=S.current.getBoundingClientRect()[I],he=E(S.current);b.current.ariaValueNow=o(le,he[W],he[A])}},500,[A,W,D,I]);const N=(0,a.useRef)(null),K=(0,a.useCallback)(ne=>{S.current&&(L.current=S.current.getBoundingClientRect()[I],R.current=O.current.getBoundingClientRect()[I],N.current=ne[U],b.current.setPointerCapture(ne.pointerId),B.current=E(S.current),F.current=void 0)},[I,U]),V=(0,a.useCallback)(ne=>{if(N.current!==null&&L.current!=="1fr"){const ce=ne[U]-N.current,le=B.current,he=(0,n.clamp)(L.current+ce,le[W],le[A]),oe=he/(R.current-P);S.current.style.flexGrow=`${oe}`,M.current.style.flexGrow=`${1-oe}`,b.current.ariaValueNow=o(he,le[W],le[A]),v?.(oe,he)}},[P,U,W,A,v]),T=(0,a.useCallback)(ne=>{ne.preventDefault(),ne.stopPropagation(),b.current.releasePointerCapture(ne.pointerId),N.current=null,typeof L.current=="number"&&y?.(parseFloat(S.current.style.flexGrow),L.current)},[y]),z=(0,a.useRef)(new Set),w=(0,a.useRef)(null),H=(0,a.useCallback)(ne=>{if(z.current.size===0){w.current=null;return}else if(L.current==="1fr")return;const he=(ne-(w.current??ne))*s;let oe=0;D==="row"?(z.current.has("ArrowLeft")&&(oe-=he),z.current.has("ArrowRight")&&(oe+=he)):(z.current.has("ArrowUp")&&(oe-=he),z.current.has("ArrowDown")&&(oe+=he));const de=B.current,me=S.current.getBoundingClientRect()[I],Pe=(0,n.clamp)(me+oe,de[W],de[A]),Ee=Pe/(R.current-P);S.current.style.flexGrow=`${Ee}`,M.current.style.flexGrow=`${1-Ee}`,b.current.ariaValueNow=o(Pe,de[W],de[A]),v?.(Ee,Pe),w.current=ne,window.requestAnimationFrame(H)},[D,P,W,A,I,v]),G=(0,a.useCallback)(ne=>{if(!S.current||!M.current||!b.current||!O.current)return;if(ne.key==="Enter"){F.current===void 0?(F.current=S.current.style.flexGrow,S.current.style.flexGrow="0",M.current.style.flexGrow="1"):(S.current.style.flexGrow=F.current,M.current.style.flexGrow=`${1-parseFloat(F.current)}`,F.current=void 0);return}else if(ne.key==="Home"){B.current=E(S.current),R.current=O.current.getBoundingClientRect()[I];const le=B.current[W]/(R.current-P);S.current.style.flexGrow=`${le}`,M.current.style.flexGrow=`${1-le}`,b.current.ariaValueNow="0";return}else if(ne.key==="End"){B.current=E(S.current),R.current=O.current.getBoundingClientRect()[I];const le=B.current[A]/(R.current-P);S.current.style.flexGrow=`${le}`,M.current.style.flexGrow=`${1-le}`,b.current.ariaValueNow="100";return}if(!(D==="column"&&c.has(ne.key)||D==="row"&&d.has(ne.key))||z.current.has(ne.key))return;if(F.current=void 0,ne.preventDefault(),ne.stopPropagation(),L.current=S.current.getBoundingClientRect()[I],R.current=O.current.getBoundingClientRect()[I],B.current=E(S.current),!z.current.has(ne.key)){const le=z.current.size===0;z.current.add(ne.key),le&&window.requestAnimationFrame(H)}},[D,H,P,A,I,W]),X=(0,a.useCallback)(ne=>{D==="row"&&!d.has(ne.key)||D==="column"&&!c.has(ne.key)||(z.current.delete(ne.key),typeof L.current=="number"&&y?.(parseFloat(S.current.style.flexGrow),L.current))},[D,y]),k=(0,a.useCallback)(()=>{if(!S.current||!M.current)return;S.current.style.flexGrow="0.5",M.current.style.flexGrow="0.5";const ne=E(S.current);B.current=ne,L.current=S.current.getBoundingClientRect()[I],b.current.ariaValueNow=`${o(L.current,ne[W],ne[A])}`},[A,I,W]),_=(0,a.useCallback)(()=>{z.current.size>0&&(z.current.clear(),N.current=null,typeof L.current=="number"&&y?.(parseFloat(S.current.style.flexGrow),L.current))},[y]),ee=(0,i.of)(f,D),J=(0,i.of)(x.l,l),Z=D==="column"?J.dragHandleHorizontal:J.dragHandleVertical,te=(0,a.useId)(),ae={flexGrow:(0,n.clamp)(C??.5,0,1),[W]:"min-content"},re={flexGrow:(0,n.clamp)(1-C,0,1),[W]:"min-content"};return{containerProps:{ref:O,className:ee.container},primaryProps:{ref:S,className:ee.panel,style:ae},secondaryProps:{ref:M,className:ee.panel,style:re},splitterProps:{onPointerUp:T,onPointerDown:K,onPointerMove:V,onKeyDown:G,onKeyUp:X,onDoubleClick:k,onBlur:_,ref:b,style:{[I]:`${P}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":C*100,"aria-controls":`start-panel-${te}`,"aria-label":"Pane resize widget",tabIndex:0,className:Z}}}function o(h,D,C){return`${(0,n.clamp)((h-D)/(C-D)*100,0,100)}`}function E(h){const D=document.body.style.overflow,C=h.style.width,l=h.style.height,v=h.style.flexGrow;document.body.style.overflow="hidden",h.style.flexGrow="0";const{width:y,height:P}=h.getBoundingClientRect();h.style.flexGrow="100";const{width:b,height:S}=h.getBoundingClientRect();return document.body.style.overflow=D,h.style.width=C,h.style.height=l,h.style.flexGrow=v,{minWidth:y,maxWidth:b,minHeight:P,maxHeight:S}}function m(h,D,C=0,l){const v=(0,n.throttle)(D,C);(0,a.useLayoutEffect)(()=>{if(!h)return;const y=new ResizeObserver(v);return y.observe(h,{box:"device-pixel-content-box"}),()=>y.disconnect()},l)}function f(h,D){return{container:(0,t.css)({display:"flex",flexDirection:D==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}function p(h="md"){return{xs:4,sm:8,md:16,lg:32}[h]}},54852:(q,j,e)=>{"use strict";e.d(j,{S:()=>s});var t=e(74848),n=e(2543),r=e.n(n),a=e(96540),i=e(91357),x=e(44826);class s extends a.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:d,allowMultiple:u,defaultStat:g,onChange:o}=this.props,E=i.AS.list(d);if(E.length!==d.length){const m=E.map(p=>p.id),f=(0,n.difference)(d,m);console.warn("Unknown stats",f,d),o(E.map(p=>p.id))}!u&&d.length>1&&(console.warn("Removing extra stat",d),o([d[0]])),g&&d.length<1&&o([g])},this.onSelectionChange=d=>{const{onChange:u}=this.props;Array.isArray(d)?u(d.map(g=>g.value)):u(d&&d.value?[d.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(d){this.checkInput()}render(){const{stats:d,allowMultiple:u,defaultStat:g,placeholder:o,className:E,menuPlacement:m,width:f,inputId:p,filterOptions:h}=this.props,D=i.AS.selectOptions(d,h);return(0,t.jsx)(x.l6,{value:D.current,className:E,isClearable:!g,isMulti:u,width:f,isSearchable:!0,options:D.options,placeholder:o,onChange:this.onSelectionChange,menuPlacement:m,inputId:p})}}},29010:(q,j,e)=>{"use strict";e.d(j,{K:()=>g,d:()=>u});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(96540),x=e(33262),s=e(29675),c=e(94963),d=e(79784);const u=(0,i.forwardRef)(({value:E,checked:m,onChange:f,id:p,label:h,disabled:D,invalid:C=!1,...l},v)=>{m&&(0,x.l)("Switch","checked prop","value");const y=(0,s.of)(o),P=(0,i.useRef)(p||(0,r.uniqueId)("switch-"));return(0,t.jsxs)("div",{className:(0,n.cx)(y.switch,C&&y.invalid),children:[(0,t.jsx)("input",{type:"checkbox",role:"switch",disabled:D,checked:E,onChange:b=>{!D&&f?.(b)},id:P.current,...l,ref:v}),(0,t.jsx)("label",{htmlFor:P.current,"aria-label":h,children:(0,t.jsx)(d.I,{name:"check",size:"xs"})})]})});u.displayName="Switch";const g=(0,i.forwardRef)(({transparent:E,className:m,showLabel:f,label:p,value:h,id:D,invalid:C,...l},v)=>{const y=(0,s.of)(o,E);return(0,t.jsxs)("div",{className:(0,n.cx)(y.inlineContainer,m,l.disabled&&y.disabled,C&&y.invalid),children:[f&&(0,t.jsx)("label",{htmlFor:D,className:(0,n.cx)(y.inlineLabel,h&&y.inlineLabelEnabled,"inline-switch-label"),children:p}),(0,t.jsx)(u,{...l,id:D,label:p,ref:v,value:h})]})});g.displayName="Switch";const o=(E,m)=>({switch:(0,n.css)({width:E.spacing(4),height:E.spacing(2),position:"relative",lineHeight:1,input:{height:"100%",width:"100% !important",opacity:0,zIndex:-1e3,position:"absolute","&:checked + label":{background:E.colors.primary.main,borderColor:E.colors.primary.main,"&:hover":{background:E.colors.primary.shade},svg:{transform:`translate3d(${E.spacing(2.25)}, -50%, 0)`,background:E.colors.primary.contrastText,color:E.colors.primary.main}},"&:disabled + label":{background:E.colors.action.disabledBackground,borderColor:E.colors.border.weak,cursor:"not-allowed",svg:{background:E.colors.text.disabled}},"&:disabled:checked + label":{background:E.colors.primary.transparent,svg:{color:E.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,c.getFocusStyles)(E),"&:focus:not(:focus-visible) + label":(0,c.getMouseFocusStyles)(E)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:E.shape.radius.pill,background:E.components.input.background,border:`1px solid ${E.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:E.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:E.spacing(1.5),height:E.spacing(1.5),borderRadius:E.shape.radius.circle,background:E.colors.text.secondary,boxShadow:E.shadows.z1,left:0,top:"50%",transform:`translate3d(${E.spacing(.25)}, -50%, 0)`,transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${E.colors.primary.contrastText}`}}}}),inlineContainer:(0,n.css)({padding:E.spacing(0,1),height:E.spacing(E.components.height.md),display:"inline-flex",alignItems:"center",background:m?"transparent":E.components.input.background,border:`1px solid ${m?"transparent":E.components.input.borderColor}`,borderRadius:E.shape.radius.default,"&:hover":{border:`1px solid ${m?"transparent":E.components.input.borderHover}`,".inline-switch-label":{color:E.colors.text.primary}}}),disabled:(0,n.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,n.css)({cursor:"pointer",paddingRight:E.spacing(1),color:E.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,n.css)({color:E.colors.text.primary}),invalid:(0,n.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${E.colors.error.border}`}})})},3567:(q,j,e)=>{"use strict";e.d(j,{q:()=>u});var t=e(74848),n=e(22803),r=e(96540),a=e(99764),i=e(10247),x=e(88849),s=e(11238),c=e(29675),d=e(99134);function u({tabs:o,defaultTab:E,closeIconTooltip:m,onClose:f,testId:p}){const[h,D]=(0,r.useState)(o.some(P=>P.value===E)?E:o[0].value),C=(0,c.of)(g),l=(0,c.$j)(),v=P=>{D(P.value)},y=`calc(100% - (${l.spacing(l.components.menuTabs.height)} + ${l.spacing(1)}))`;return(0,t.jsxs)("div",{className:C.container,"data-testid":p,children:[(0,t.jsxs)(i.U,{className:C.tabs,children:[o.map(P=>(0,t.jsx)(x.o,{label:P.label,active:P.value===h,onChangeTab:()=>v(P),icon:P.icon},P.value)),(0,t.jsx)(a.K,{className:C.close,onClick:f,name:"times",tooltip:m??"Close"})]}),(0,t.jsx)(d.P,{height:y,children:(0,t.jsx)(s.J,{className:C.tabContent,children:o.find(P=>P.value===h)?.content})})]})}const g=o=>({container:(0,n.css)({height:"100%"}),tabContent:(0,n.css)({padding:o.spacing(2),backgroundColor:o.colors.background.primary,height:"100%"}),close:(0,n.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:o.typography.size.lg}),tabs:(0,n.css)({paddingTop:o.spacing(1),borderColor:o.colors.border.weak,ul:{marginLeft:o.spacing(2)}})})},21990:(q,j,e)=>{"use strict";e.d(j,{u:()=>c,d:()=>u});var t=e(74848),n=e(96540),r=e(91357),a=e(58779),i=e(22803);const x=g=>{const o=(0,i.css)({width:"100%",listStyle:"none"}),E=(0,i.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return g.value&&!Array.isArray(g.value)?(0,t.jsx)("span",{children:g.value}):g.value&&Array.isArray(g.value)&&g.value.length>0?(0,t.jsx)("ul",{className:o,children:g.value.map((m,f)=>{const p=Object.keys(m)[0];return(0,t.jsxs)("li",{className:E,children:[(0,t.jsx)("span",{children:p}),(0,t.jsx)("span",{children:m[p]})]},f)})}):s},s=()=>(0,t.jsx)("span",{children:"\xA0"});function c(g){const{totalColumnsWidth:o,footerGroups:E,isPaginationVisible:m,tableStyles:f}=g,p=a.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{style:{position:m?"relative":"absolute",width:o?`${o}px`:"100%",bottom:"0px"},children:E.map(h=>{const{key:D,...C}=h.getFooterGroupProps();return(0,n.createElement)("div",{className:f.tfoot,...C,key:D,"data-testid":p.footer},h.headers.map(l=>d(l,f)))})})}function d(g,o){const{key:E,...m}=g.getHeaderProps();return m?(m.style=m.style??{},m.style.position="absolute",m.style.justifyContent=g.justifyContent,(0,t.jsx)("div",{className:o.headerCell,...m,children:g.render("Footer")},E)):null}function u(g,o,E){if(o===void 0)return s;if(E){if(o[g]===void 0)return s;const m=r.AS.get(r.gy.count).name;return x({value:[{[m]:String(o[g])}]})}return x({value:o[g]})}},97225:(q,j,e)=>{"use strict";e.d(j,{a:()=>E,t:()=>o});var t=e(74848),n=e(42825),r=e(4038),a=e(59141),i=e(63739),x=e(7500),s=e(29675),c=e(91371),d=e(48092),u=e(392),g=e(95547);const o={type:x.ob.Sparkline,drawStyle:x.GR.Line,lineInterpolation:x.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:x.on.Hue,pointSize:2,barAlignment:x.Nj.Center,showPoints:x.yL.Never,hideValue:!1},E=p=>{const{field:h,innerWidth:D,tableStyles:C,cell:l,cellProps:v,timeRange:y}=p,P=m(l.value),b=(0,s.$j)();if(!P)return(0,t.jsx)("div",{...v,className:C.cellContainer,children:h.config.noValue||"no data"});P.x&&!P.x.config.interval&&P.x.values.length>1&&(P.x.config.interval=P.x.values[1]-P.x.values[0]),P.y.values=P.y.values.map(F=>Number.isFinite(F)?F:null);const S=(0,n.AP)(P.y);P.y.config.min=S.min,P.y.config.max=S.max,P.y.state={range:S},P.timeRange=y;const M=f(h),O={color:h.config.color,custom:{...o,...M}},R=h.config.custom?.cellOptions?.hideValue;let L=0,B=null;if(!R){const F=(0,r.LI)(l.value)?l.value.value:null,I=h.display(F),U=(0,g.zi)(h,I,l.row.index);L=(0,c.kD)((0,a.cN)(U),16).width+b.spacing.gridSize,B=(0,t.jsx)(d.i,{style:{width:`${L-b.spacing.gridSize}px`,textAlign:"right",marginRight:b.spacing(1)},value:I})}return(0,t.jsxs)("div",{...v,className:C.cellContainer,children:[B,(0,t.jsx)("div",{children:(0,t.jsx)(u.O,{width:D-L,height:C.cellHeightInner,sparkline:P,config:O,theme:C.theme})})]})};function m(p){if(Array.isArray(p))return{y:{name:"test",type:i.PU.number,values:p,config:{}}};if((0,r.ci)(p)){const h=p.fields.find(C=>C.type===i.PU.time),D=p.fields.find(C=>C.type===i.PU.number);if(h&&D)return{x:h,y:D}}}function f(p){let h=(0,g.bk)(p);if(h.type===x.ob.Auto&&(h={...h,type:x.ob.Sparkline}),h.type===x.ob.Sparkline)return h;throw new Error(`Expected options type ${x.ob.Sparkline} but got ${h.type}`)}},32991:(q,j,e)=>{"use strict";e.d(j,{X:()=>we});var t=e(74848),n=e(96540),r=e(32885),a=e(91357),i=e(63739),x=e(67555),s=e(40462),c=e(58779),d=e(7500),u=e(29675),g=e(70462),o=e(67893),E=e(16110),m=e(21990),f=e(22399),p=e(79784),h=e(22803),D=e(95486),C=e(91793),l=e(59141),v=e(48583),y=e(22560),P=e(31035),b=e(81942),S=e(40271);const M=28,O=M*5,R={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},L=Object.values(R),B=R.Contains,F=R.Expression,I=$e=>{if($e=$e.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test($e)){const Le=new Date($e);if(!isNaN(Le.getTime())){const Ge=(0,l.j_)("dateTimeAsIso");return(0,l.cN)(Ge(Le.getTime()))}}const Fe=parseFloat($e);if(!isNaN(Fe))return Fe;const Te=$e.toLowerCase();return Te==="true"||Te==="false"?Te==="true":$e},U=({options:$e,values:Fe,caseSensitive:Te,showOperators:Le,onChange:Ge,searchFilter:Me,setSearchFilter:De,operator:Ke,setOperator:Ie})=>{const Ne=(0,n.useMemo)(()=>new RegExp(Me,Te?void 0:"i"),[Me,Te]),ie=(0,n.useMemo)(()=>$e.filter(Ze=>{if(!Le||!Me||Ke.value===B.value)return Ze.label===void 0?!1:Ne.test(Ze.label);if(Ke.value===F.value){if(Ze.value===void 0)return!1;try{const tt=Me.replace(/\\/g,""),Re=new Function("$",`'use strict'; return ${tt};`),at=I(Ze.value);return Re(at)}catch{}return!1}else{if(Ze.value===void 0)return!1;const tt=I(Ze.value),Re=I(Me);switch(Ke.value){case"=":return tt===Re;case"!=":return tt!==Re;case">":return tt>Re;case">=":return tt>=Re;case"<":return tt<Re;case"<=":return tt<=Re}return!1}}),[$e,Ne,Le,Ke,Me]),ve=(0,n.useMemo)(()=>ie.filter(Ze=>Fe.includes(Ze)),[ie,Fe]),fe=(0,n.useMemo)(()=>ie.length===ve.length,[ie,ve]),ge=(0,n.useMemo)(()=>ve.length>0&&ie.length>ve.length,[ie,ve]),xe=(0,n.useMemo)(()=>ve.length?`${ve.length} selected`:"Select all",[ve]),je=(0,n.useMemo)(()=>ie.length!==ve.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[ie,ve]),Ve=(0,u.of)(A),Oe=(0,u.$j)().spacing.gridSize,nt=(0,n.useMemo)(()=>Math.min(ie.length*M,O)+Oe,[Oe,ie.length]),Je=(0,n.useCallback)(Ze=>tt=>{const Re=tt.currentTarget.checked?Fe.concat(Ze):Fe.filter(at=>at.value!==Ze.value);Ge(Re)},[Ge,Fe]),Be=(0,n.useCallback)(()=>{if(ie.length===ve.length){const Ze=Fe.filter(tt=>!ie.includes(tt));Ge(Ze)}else{const Ze=[...new Set([...Fe,...ie])];Ge(Ze)}},[Ge,Fe,ie,ve]);return(0,t.jsxs)(v.B,{direction:"column",gap:.25,children:[!Le&&(0,t.jsx)(y.Z,{placeholder:"Filter values",onChange:De,value:Me}),Le&&(0,t.jsxs)(v.B,{direction:"row",gap:0,children:[(0,t.jsx)(P.f,{variant:"canvas",options:L,onChange:Ie,value:Ke,tooltip:Ke.description}),(0,t.jsx)(y.Z,{placeholder:"Filter values",onChange:De,value:Me})]}),ie.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Y1,{height:nt,itemCount:ie.length,itemSize:M,itemData:{items:ie,values:ve,onCheckedChanged:Je,className:Ve.filterListRow},width:"100%",className:Ve.filterList,children:W}),(0,t.jsxs)(v.B,{direction:"column",gap:.25,children:[(0,t.jsx)("div",{className:(0,h.cx)(Ve.selectDivider)}),(0,t.jsx)("div",{className:(0,h.cx)(Ve.filterListRow),children:(0,t.jsx)(b.S,{value:fe,indeterminate:ge,label:xe,description:je,onChange:Be})})]})]}):(0,t.jsx)(S.J,{className:Ve.noValuesLabel,children:(0,t.jsx)(g.x,{i18nKey:"grafana-ui.table.no-values-label",children:"No values"})})]})};function W({index:$e,style:Fe,data:{onCheckedChanged:Te,items:Le,values:Ge,className:Me}}){const De=Le[$e],{value:Ke,label:Ie}=De,Ne=Ge.find(ie=>ie.value===Ke)!==void 0;return(0,t.jsx)("div",{className:Me,style:Fe,title:Ie,children:(0,t.jsx)(b.S,{value:Ne,label:Ie,onChange:Te(De)})})}const A=$e=>({filterList:(0,h.css)({label:"filterList"}),filterListRow:(0,h.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:$e.spacing(.5),":hover":{backgroundColor:$e.colors.action.hover}}),selectDivider:(0,h.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${$e.colors.border.medium}`,padding:$e.spacing(.5,2)}),noValuesLabel:(0,h.css)({paddingTop:$e.spacing(1)})});var N=e(77576),K=e(99764),V=e(54594),T=e(95547);const z=({column:{preFilteredRows:$e,filterValue:Fe,setFilter:Te},onClose:Le,field:Ge,searchFilter:Me,setSearchFilter:De,operator:Ke,setOperator:Ie})=>{const Ne=(0,u.$j)(),ie=(0,n.useMemo)(()=>(0,T.MY)($e,Ge),[$e,Ge]),ve=(0,n.useMemo)(()=>(0,T.Yz)(ie),[ie]),fe=(0,n.useMemo)(()=>(0,T.Sj)(ve,Fe),[ve,Fe]),[ge,xe]=(0,n.useState)(fe),[je,Ve]=(0,n.useState)(!1),ke=(0,n.useCallback)(Ze=>Le(),[Le]),Oe=(0,n.useCallback)(Ze=>{const tt=ge.length?ge:void 0;Te(tt),Le()},[Te,ge,Le]),nt=(0,n.useCallback)(Ze=>{Te(void 0),Le()},[Te,Le]),Je=(0,n.useMemo)(()=>Fe!==void 0,[Fe]),Be=(0,u.of)(w);return(0,t.jsx)(N.N,{onClick:ke,useCapture:!0,children:(0,t.jsx)("div",{className:(0,h.cx)(Be.filterContainer),onClick:H,children:(0,t.jsxs)(v.B,{direction:"column",gap:3,children:[(0,t.jsxs)(v.B,{direction:"column",gap:.5,children:[(0,t.jsxs)(v.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)(S.J,{className:Be.label,children:(0,t.jsx)(g.x,{i18nKey:"grafana-ui.table.filter-popup-heading",children:"Filter by values:"})}),(0,t.jsx)(K.K,{name:"text-fields",tooltip:"Match case",style:{color:je?Ne.colors.text.link:Ne.colors.text.disabled},onClick:()=>{Ve(Ze=>!Ze)}})]}),(0,t.jsx)("div",{className:(0,h.cx)(Be.listDivider)}),(0,t.jsx)(U,{onChange:xe,values:ge,options:ve,caseSensitive:je,showOperators:!0,searchFilter:Me,setSearchFilter:De,operator:Ke,setOperator:Ie})]}),(0,t.jsxs)(v.B,{gap:3,children:[(0,t.jsxs)(v.B,{children:[(0,t.jsx)(V.$n,{size:"sm",onClick:Oe,children:(0,t.jsx)(g.x,{i18nKey:"grafana-ui.table.filter-popup-apply",children:"Ok"})}),(0,t.jsx)(V.$n,{size:"sm",variant:"secondary",onClick:ke,children:(0,t.jsx)(g.x,{i18nKey:"grafana-ui.table.filter-popup-cancel",children:"Cancel"})})]}),Je&&(0,t.jsx)(v.B,{children:(0,t.jsx)(V.$n,{fill:"text",size:"sm",onClick:nt,children:(0,t.jsx)(g.x,{i18nKey:"grafana-ui.table.filter-popup-clear",children:"Clear filter"})})})]})]})})})},w=$e=>({filterContainer:(0,h.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:$e.colors.background.primary,border:`1px solid ${$e.colors.border.weak}`,padding:$e.spacing(2),boxShadow:$e.shadows.z3,borderRadius:$e.shape.radius.default}),listDivider:(0,h.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${$e.colors.border.medium}`,padding:$e.spacing(.5,2)}),label:(0,h.css)({marginBottom:0})}),H=$e=>{$e.stopPropagation()},G=({column:$e,field:Fe,tableStyles:Te})=>{const Le=(0,n.useRef)(null),[Ge,Me]=(0,n.useState)(!1),De=(0,u.of)(X),Ke=(0,n.useMemo)(()=>!!$e.filterValue,[$e.filterValue]),Ie=(0,n.useCallback)(()=>Me(!0),[Me]),Ne=(0,n.useCallback)(()=>Me(!1),[Me]),[ie,ve]=(0,n.useState)(""),[fe,ge]=(0,n.useState)(B);return!Fe||!Fe.config.custom?.filterable?null:(0,t.jsxs)("button",{className:(0,h.cx)(Te.headerFilter,Ke?De.filterIconEnabled:De.filterIconDisabled),ref:Le,type:"button",onClick:Ie,children:[(0,t.jsx)(p.I,{name:"filter"}),Ge&&Le.current&&(0,t.jsx)(D.A,{content:(0,t.jsx)(z,{column:$e,tableStyles:Te,field:Fe,onClose:Ne,searchFilter:ie,setSearchFilter:ve,operator:fe,setOperator:ge}),placement:"bottom-start",referenceElement:Le.current,show:!0})]})},X=$e=>({filterIconEnabled:(0,h.css)({label:"filterIconEnabled",color:$e.colors.primary.text}),filterIconDisabled:(0,h.css)({label:"filterIconDisabled",color:$e.colors.text.disabled})}),k=$e=>{const{headerGroups:Fe,showTypeIcons:Te,tableStyles:Le}=$e,Ge=c.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{role:"rowgroup",className:Le.headerRow,children:Fe.map(Me=>{const{key:De,...Ke}=Me.getHeaderGroupProps();return(0,n.createElement)("div",{className:Le.thead,...Ke,key:De,"aria-label":Ge.header,role:"row"},Me.headers.map((Ie,Ne)=>_(Ie,Le,Te)))})})};function _($e,Fe,Te){const{key:Le,...Ge}=$e.getHeaderProps(),Me=$e.field??null,De=Me?.config.custom;$e.canResize&&(Ge.style.userSelect=$e.isResizing?"none":"auto"),Ge.style.position="absolute",Ge.style.justifyContent=$e.justifyContent,Ge.style.left=$e.totalLeft;let Ke=$e.render("Header"),Ie=$e.canSort&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{...$e.getSortByToggleProps(),className:Fe.headerCellLabel,children:[Te&&(0,t.jsx)(p.I,{name:(0,f.SS)(Me),title:Me?.type,size:"sm",className:Fe.typeIcon}),(0,t.jsx)("div",{children:Ke}),$e.isSorted&&($e.isSortedDesc?(0,t.jsx)(p.I,{size:"lg",name:"arrow-down",className:Fe.sortIcon}):(0,t.jsx)(p.I,{name:"arrow-up",size:"lg",className:Fe.sortIcon}))]}),$e.canFilter&&(0,t.jsx)(G,{column:$e,tableStyles:Fe,field:Me})]});return Ie&&De?.headerComponent?Ie=(0,t.jsx)(De.headerComponent,{field:Me,defaultContent:Ie}):De?.headerComponent&&(Ke=(0,t.jsx)(De.headerComponent,{field:Me,defaultContent:Ke})),(0,t.jsxs)("div",{className:Fe.headerCell,...Ge,role:"columnheader",children:[$e.canSort&&Ie,!$e.canSort&&Ke,!$e.canSort&&$e.canFilter&&(0,t.jsx)(G,{column:$e,tableStyles:Fe,field:Me}),$e.canResize&&(0,t.jsx)("div",{...$e.getResizerProps(),className:Fe.resizeHandle})]},Le)}var ee=e(64423),J=e(56978),Z=e(35383),te=e(90415);function ae({tableStyles:$e,nestedData:Fe,rowIndex:Te,width:Le,cellHeight:Ge}){const Me=Fe.values,De=[],Ke=(0,u.$j)(),Ie=(0,u.of)(re);let Ne=$e.rowHeight+Ke.spacing.gridSize;return Me[Te].forEach((ie,ve)=>{const fe=!!ie.meta?.custom?.noHeader,ge=$e.rowHeight*(ie.length+(fe?0:1)),xe={height:ge,paddingLeft:T.jV,position:"absolute",top:Ne,backgroundColor:Ke.colors.background.primary,color:Ke.colors.text.primary};Ne+=ge+Ke.spacing.gridSize,De.push((0,t.jsx)("div",{style:xe,children:(0,t.jsx)(we,{data:ie,width:Le-T.jV,height:$e.rowHeight*(ie.length+1),noHeader:fe,cellHeight:Ge})},`subTable_${Te}_${ve}`))}),(0,t.jsx)("div",{className:Ie.subTables,children:De})}const re=$e=>({subTables:(0,h.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:$e.spacing(5),left:$e.spacing(1),bottom:$e.spacing(2),background:$e.colors.border.medium}})});function ne($e,Fe,Te){return $e.values[Fe].reduce((Me,De)=>{if(De.length){const Ke=!!De.meta?.custom?.noHeader;return Me+Te.rowHeight*(De.length+(Ke?0:1))+8}return Me},Te.rowHeight)??Te.rowHeight}var ce=e(83180);const le=$e=>{const{data:Fe,rows:Te,headerHeight:Le,footerPaginationEnabled:Ge,rowHeight:Me,itemCount:De,pageIndex:Ke,tableState:Ie,prepareRow:Ne,onCellFilterAdded:ie,width:ve,cellHeight:fe=d.qM.Sm,timeRange:ge,tableStyles:xe,nestedDataField:je,listHeight:Ve,listRef:ke,enableSharedCrosshair:Oe=!1,initialRowIndex:nt=void 0,headerGroups:Je,longestField:Be,textWrapField:Ze,getActions:tt,replaceVariables:Re,setInspectCell:at}=$e,[yt,ze]=(0,n.useState)(nt);nt===void 0&&yt!==void 0&&ze(void 0);const st=(0,u.$j)(),ht=(0,te.d2)();let It=null;window.OffscreenCanvas!==void 0&&(It=new OffscreenCanvas(256,1024).getContext("2d")),It!=null&&(It.font=`${st.typography.fontSize}px ${st.typography.body.fontFamily}`);const Gt=(0,n.useMemo)(()=>{const lt=Fe.fields.find(Pt=>Pt.type===i.PU.time);return lt?(0,T.HY)(lt):0},[Fe]),un=(0,n.useCallback)((lt,Pt)=>{if(!ht||!Oe)return;const Bt=Pt.fields.find(Jt=>Jt.type===i.PU.time);Bt&&ht.eventBus.publish(new Z.b_({point:{time:Bt.values[lt]}}))},[Oe,ht]),vn=(0,n.useCallback)(()=>{!ht||!Oe||ht.eventBus.publish(new Z.ql)},[Oe,ht]),pn=(0,n.useCallback)(lt=>{if(lt.payload.point?.time&&lt.payload.rowIndex!==void 0){const Pt=Fe.fields.find(gn=>gn.type===i.PU.time),Bt=Pt.values[lt.payload.rowIndex],Jt=lt.payload.point.time;if((0,T.Iy)(Jt,Bt,Gt)){ze(lt.payload.rowIndex);return}const qt=Pt.values.findIndex(gn=>(0,T.Iy)(Jt,gn,Gt));if(qt!==-1){ze(qt);return}ze(void 0)}},[Fe.fields,Gt]);(0,n.useEffect)(()=>{if(!ht||!Oe||!(0,x.S1)(Fe)||Ge)return;const lt=new ee.yU;return lt.add(ht.eventBus.getStream(Z.b_).pipe((0,J.B)(250)).subscribe({next:Pt=>{ht.eventBus!==Pt.origin&&pn(Pt)}})),lt.add(ht.eventBus.getStream(Z.ql).pipe((0,J.B)(250)).subscribe({next:Pt=>{ht.eventBus!==Pt.origin&&ze(void 0)}})),()=>{lt.unsubscribe()}},[Fe,Oe,Ge,pn,ht]);let xn;if(yt!==void 0){const lt=Te.findIndex(Pt=>Pt.index===yt);lt!==-1&&(xn=Le+(lt-1)*Me)}const cn=(0,n.useCallback)(lt=>Ie.pageIndex*Ie.pageSize+lt,[Ie.pageIndex,Ie.pageSize]);let jn,_n;for(const lt of Fe.fields){const Pt=lt.config.custom;Pt!==void 0&&Pt.cellOptions!==void 0&&Pt.cellOptions.type===d.ob.ColorBackground&&Pt.cellOptions.applyToRow&&(jn=Jt=>{const qt=lt.display(lt.values.get(Jt));return(0,T.HW)(xe,Pt.cellOptions,qt)}),Ze!==void 0?_n=Ze:Be!==void 0&&(_n=Be)}const Ot=(0,n.useCallback)(({index:lt,style:Pt,rowHighlightIndex:Bt})=>{const Jt=cn(lt),qt=Te[Jt];let gn={};Ne(qt);const On=Ie.expanded[qt.id]?(0,h.css)({"&:hover":{background:"inherit"}}):{},Tn=je&&Ie.expanded[qt.id];if(Bt!==void 0&&qt.index===Bt&&(Pt={...Pt,backgroundColor:st.components.table.rowSelected},gn={"aria-selected":"true"}),jn){const{bgColor:es,textColor:ls}=jn(qt.index);Pt.background=es,Pt.color=ls,Pt.borderLeft=`2px solid ${es}`}if(_n){const ls=Fe.fields.filter(nn=>!nn.config.custom?.hidden).findIndex(nn=>nn.name===_n.name),Lt=st.typography.body.lineHeight*st.typography.fontSize,$t=(0,T.M2)(_n.values[qt.index],Je[0].headers[ls],It,Lt,xe.rowHeight,xe.cellPadding);Pt.height=$t.height}const{key:wn,...ps}=qt.getRowProps({style:Pt,...gn});return(0,t.jsxs)("div",{...ps,className:(0,h.cx)(xe.row,On),onMouseEnter:()=>un(qt.index,Fe),onMouseLeave:vn,children:[Tn&&(0,t.jsx)(ae,{nestedData:je,tableStyles:xe,rowIndex:qt.index,width:ve,cellHeight:fe}),qt.cells.map((es,ls)=>(0,t.jsx)(ce.n,{tableStyles:xe,cell:es,onCellFilterAdded:ie,columnIndex:ls,columnCount:qt.cells.length,timeRange:ge,frame:Fe,rowStyled:jn!==void 0,rowExpanded:Tn,textWrapped:_n!==void 0,height:Number(Pt.height),getActions:tt,replaceVariables:Re,setInspectCell:at},ls))]},wn)},[cn,Te,Ne,Ie.expanded,je,jn,_n,xe,vn,ve,fe,st.components.table.rowSelected,st.typography.body.lineHeight,st.typography.fontSize,Fe,Je,It,un,ie,ge,tt,Re,at]),Rt=lt=>{const Pt=cn(lt),Bt=Te[Pt];if(Ie.expanded[Bt.id]&&je)return ne(je,Bt.index,xe);if(_n){const qt=Fe.fields.filter(On=>!On.config.custom?.hidden).findIndex(On=>On.name===_n.name),gn=st.typography.fontSize*st.typography.body.lineHeight;return(0,T.M2)(_n.values[Bt.index],Je[0].headers[qt],It,gn,xe.rowHeight,xe.cellPadding).height}return xe.rowHeight},Ye=lt=>{const{scrollTop:Pt}=lt.currentTarget;ke.current!==null&&ke.current.scrollTo(Pt)},dt=Object.keys(Ie.expanded).join("|");return(0,n.useEffect)(()=>{ke.current&&ke.current.resetAfterIndex(0)},[Te,ke]),(0,t.jsx)(o.A,{onScroll:Ye,hideHorizontalTrack:!0,scrollTop:xn,children:(0,t.jsx)(C._m,{height:Ve,itemCount:De,itemSize:Rt,width:"100%",ref:ke,style:{overflow:void 0},children:({index:lt,style:Pt})=>Ot({index:lt,style:Pt,rowHighlightIndex:yt})},`${Me}${Ke}${dt}`)})};var he=e(77469);function oe($e,Fe){(0,n.useEffect)(()=>{if($e.current&&Fe.current){const Te=$e.current.querySelector(".track-vertical"),Le=Fe.current.firstChild;Le&&Te&&(Te.remove(),Le instanceof HTMLElement&&(Le.querySelector(":scope > .track-vertical")?.remove(),Le.append(Te)))}})}function de($e,Fe,Te,Le){const Ge=JSON.stringify(Object.keys($e.expanded));(0,n.useEffect)(()=>{let Me=0;Le||(Number.isFinite($e.lastExpandedOrCollapsedIndex)&&(Me=$e.lastExpandedOrCollapsedIndex),Me=$e.pageIndex===0?Me-1:Me-$e.pageIndex-$e.pageIndex*$e.pageSize),Fe.current?.resetAfterIndex(Math.max(Me,0))},[$e.lastExpandedOrCollapsedIndex,$e.pageSize,$e.pageIndex,Fe,Te,Ge,Le])}var me=e(23570);function Pe({onColumnResize:$e,onSortByChange:Fe,data:Te}){return(0,n.useCallback)((Le,Ge)=>{switch(Ge.type){case"columnDoneResizing":if($e){const De=Le.columnResizing?.headerIdWidths?.[0]?.[0],Ke=parseInt(De,10),Ie=Math.round(Le.columnResizing.columnWidths?.[De]),Ne=Te.fields?.[Ke];if(!Ne)return Le;const ie=(0,me.Ct)(Ne,Te);$e(ie,Ie)}case"toggleSortBy":if(Fe){const Me=[];for(const De of Le.sortBy){const Ke=Te.fields[parseInt(De.id,10)];Ke&&Me.push({displayName:(0,me.Ct)(Ke,Te),desc:De.desc})}Fe(Me)}case"toggleRowExpanded":if(Ge.id)return{...Le,lastExpandedOrCollapsedIndex:parseInt(Ge.id,10)}}return Le},[Te,$e,Fe])}function Ee($e,Fe){const Te={};if($e){Te.sortBy=[];for(const Le of $e)for(const Ge of Fe)Ge.Header===Le.displayName&&Te.sortBy.push({id:Ge.id,desc:Le.desc})}return Te}var be=e(22316);const Se=150,Xe=36,Qe="No data",we=(0,n.memo)($e=>{const{ariaLabel:Fe,data:Te,height:Le,onCellFilterAdded:Ge,onColumnResize:Me,width:De,columnMinWidth:Ke=Se,noHeader:Ie,resizable:Ne=!0,initialSortBy:ie,footerOptions:ve,showTypeIcons:fe,footerValues:ge,enablePagination:xe,cellHeight:je=d.qM.Sm,timeRange:Ve,enableSharedCrosshair:ke=!1,initialRowIndex:Oe=void 0,fieldConfig:nt,getActions:Je,replaceVariables:Be}=$e,Ze=(0,n.useRef)(null),tt=(0,n.useRef)(null),Re=(0,n.useRef)(null),at=(0,u.$j)(),yt=(0,be.k)(at,je),ze=Ie?0:yt.rowHeight,[st,ht]=(0,n.useState)(ge),It=nt?.defaults?.noValue??Qe,[Gt,un]=(0,n.useState)(null),vn=(0,n.useMemo)(()=>{const St=Xe;let zt=0;if(!st)return 0;for(const Qt of st)Array.isArray(Qt)&&Qt.length>zt&&(zt=Qt.length);return zt>1?St*zt:St},[st]),pn=(0,n.useMemo)(()=>Te.fields.length?Array(Te.length).fill(0):[],[Te]),xn=!!(ve?.countRows&&ve.reducer&&ve.reducer.length&&ve.reducer[0]===a.gy.count),cn=Te.fields.find(St=>St.type===i.PU.nestedFrames),jn=cn!==void 0,_n=(0,n.useMemo)(()=>(0,T.GH)(Te,De,Ke,jn,st,xn),[Te,De,Ke,jn,st,xn]),Ot=(0,n.useRef)(),Rt=Pe({onColumnResize:Me,onSortByChange:St=>{Ot.current(!1),$e.onSortByChange&&$e.onSortByChange(St)},data:Te}),Ye=!!Te.meta?.uniqueRowIdFields?.length,dt=(0,n.useMemo)(()=>{const St={columns:_n,data:pn,disableResizing:!Ne,stateReducer:Rt,autoResetPage:!1,initialState:Ee(ie,_n),autoResetFilters:!1,sortTypes:{number:T.Ok,"alphanumeric-insensitive":T.IM}};return Ye&&(St.getRowId=(zt,Qt)=>(0,x.t9)(Te,Qt),St.autoResetExpanded=!1),St},[ie,_n,pn,Ne,Rt,Ye,Te]),{getTableProps:lt,headerGroups:Pt,footerGroups:Bt,rows:Jt,prepareRow:qt,totalColumnsWidth:gn,page:On,state:Tn,gotoPage:wn,setPageSize:ps,pageOptions:es,toggleAllRowsExpanded:ls}=(0,r.useTable)(dt,r.useFilters,r.useSortBy,r.useAbsoluteLayout,r.useResizeColumns,r.useExpanded,r.usePagination),Lt=Tn;Ot.current=ls,(0,n.useEffect)(()=>{ve||ht(ge)},[ge,ve]),(0,n.useEffect)(()=>{if(!ve)return;if(!ve.show){ht(void 0);return}if(xn){const zt=[];zt[0]=Jt.length.toString()??Te.length.toString(),ht(zt);return}const St=(0,T.Ux)(Pt[0].headers,(0,T.XX)(Jt),ve,at);ht(St)},[ve,at,Tn.filters,Te]);let $t=Le-(ze+vn);xe&&($t-=yt.cellHeight);const nn=Math.round($t/yt.rowHeight)-1;(0,n.useEffect)(()=>{nn<=0||ps(nn)},[nn,ps]),(0,n.useEffect)(()=>{Te.length/nn<Tn.pageIndex&&wn(0)},[Te]),de(Lt,Ze,Te,Ye),oe(Re,tt);const on=(0,n.useCallback)(St=>{wn(St-1)},[wn]),bn=xe?On.length:Jt.length;let In=null;if(xe){const St=Tn.pageIndex*Tn.pageSize+1;let zt=St+Tn.pageSize-1;const Qt=De<550;zt>Te.length&&(zt=Te.length);const an=Jt.length,mn=zt<Jt.length?zt:Jt.length;In=(0,t.jsxs)("div",{className:yt.paginationWrapper,children:[(0,t.jsx)(E.d,{currentPage:Tn.pageIndex+1,numberOfPages:es.length,showSmallVersion:Qt,onNavigate:on}),Qt?null:(0,t.jsx)("div",{className:yt.paginationSummary,children:(0,t.jsxs)(g.x,{i18nKey:"grafana-ui.table.pagination-summary",children:[{itemsRangeStart:St}," - ",{displayedEnd:mn}," of ",{numRows:an}," rows"]})})]})}let Yn,zn;return nt&&(Yn=(0,T.O4)(nt,Te),Te.fields.forEach(St=>{nt.overrides.forEach(zt=>{if((0,s.NS)(zt.matcher)(St,Te,[Te]))for(const an of zt.properties)an.id==="custom.cellOptions"&&an.value.wrapText&&(zn=St)})})),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{...lt(),className:yt.table,"aria-label":Fe,role:"table",ref:tt,style:{width:De,height:Le},children:[(0,t.jsx)(o.E,{hideVerticalTrack:!0,children:(0,t.jsxs)("div",{className:yt.tableContentWrapper(gn),children:[!Ie&&(0,t.jsx)(k,{headerGroups:Pt,showTypeIcons:fe,tableStyles:yt}),bn>0?(0,t.jsx)("div",{"data-testid":c.Tp.components.Panels.Visualization.Table.body,ref:Re,children:(0,t.jsx)(le,{headerGroups:Pt,data:Te,rows:Jt,width:De,cellHeight:je,headerHeight:ze,rowHeight:yt.rowHeight,itemCount:bn,pageIndex:Tn.pageIndex,listHeight:$t,listRef:Ze,tableState:Tn,prepareRow:qt,timeRange:Ve,onCellFilterAdded:Ge,nestedDataField:cn,tableStyles:yt,footerPaginationEnabled:!!xe,enableSharedCrosshair:ke,initialRowIndex:Oe,longestField:Yn,textWrapField:zn,getActions:Je,replaceVariables:Be,setInspectCell:un})}):(0,t.jsx)("div",{style:{height:Le-ze,width:De},className:yt.noData,children:It}),st&&(0,t.jsx)(m.u,{isPaginationVisible:!!xe,footerValues:st,footerGroups:Bt,totalColumnsWidth:gn,tableStyles:yt})]})}),In]}),Gt!==null&&(0,t.jsx)(he.s,{mode:Gt.mode,value:Gt.value,onDismiss:()=>{un(null)}})]})});we.displayName="Table"},83180:(q,j,e)=>{"use strict";e.d(j,{n:()=>n});var t=e(74848);const n=({cell:r,tableStyles:a,onCellFilterAdded:i,timeRange:x,userProps:s,frame:c,rowStyled:d,rowExpanded:u,textWrapped:g,height:o,getActions:E,replaceVariables:m,setInspectCell:f})=>{const p=r.getCellProps(),h=r.column.field;if(!h?.display)return null;if(p.style){p.style.wordBreak="break-word",p.style.minWidth=p.style.width;const l=r.column.justifyContent;l==="flex-end"&&!h.config.unit?(p.style.textAlign="right",p.style.direction="rtl",p.style.unicodeBidi="plaintext"):p.style.justifyContent=l}let D=(typeof r.column.width=="number"?r.column.width:24)-a.cellPadding*2;const C=E?E(c,h,r.row.index,m):[];return(0,t.jsx)(t.Fragment,{children:r.render("Cell",{field:h,tableStyles:a,onCellFilterAdded:i,cellProps:p,innerWidth:D,timeRange:x,userProps:s,frame:c,rowStyled:d,rowExpanded:u,textWrapped:g,height:o,actions:C,setInspectCell:f})})}},77469:(q,j,e)=>{"use strict";e.d(j,{B:()=>o,s:()=>E});var t=e(74848),n=e(2543),r=e.n(n),a=e(96540),i=e(70462),x=e(93604),s=e(58528),c=e(48583),d=e(3886),u=e(10247),g=e(88849),o=(m=>(m.code="code",m.text="text",m))(o||{});function E({value:m,onDismiss:f,mode:p}){let h=m;const[D,C]=(0,a.useState)(p);if((0,n.isString)(m)){const b=m.trim();if(b[0]==="{"||b[0]==="["||p==="code")try{m=JSON.parse(m),h=JSON.stringify(m,null,"  ")}catch(S){console.log("Failed to parse JSON in Table cell inspector (this will cause JSON to not print nicely): ",S.message)}}else h=JSON.stringify(m);let l=h;const v=[{label:"Plain text",value:"text"},{label:"Code editor",value:"code"}],y=()=>{C(D==="text"?"code":"text")},P=(0,t.jsx)(u.U,{children:v.map((b,S)=>(0,t.jsx)(g.o,{label:b.label,active:b.value===D,onChangeTab:y},`${b.value}-${S}`))});return(0,t.jsx)(s._,{onClose:f,title:"Inspect value",tabs:P,children:(0,t.jsxs)(c.B,{direction:"column",gap:2,children:[(0,t.jsx)(x.b,{icon:"copy",getText:()=>l,style:{marginLeft:"auto",width:"200px"},children:(0,t.jsx)(i.x,{i18nKey:"grafana-ui.table.copy",children:"Copy to Clipboard"})}),D==="code"?(0,t.jsx)(d.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(l&&l.length)>100,value:l,readOnly:!0,wordWrap:!0}):(0,t.jsx)("pre",{children:l})]})})}},22316:(q,j,e)=>{"use strict";e.d(j,{k:()=>n});var t=e(22803);function n(a,i){const x=a.colors.border.weak,s=a.colors.primary.border,c=6,d=r(a,i,c),u=d+2,g=28,o=(E,m,f,p,h,D,C,l,v)=>(0,t.css)({label:p?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${c}px`,width:"100%",height:v?"auto !important":`${u-1}px`,wordBreak:C?"break-all":"inherit",display:"flex",...h?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${x}`,color:l?"inherit":E??void 0,background:l?void 0:m??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:p&&!C?"visible":void 0,width:D||!p?"auto":"auto !important",height:(D||p)&&!C?"auto !important":`${u-1}px`,minHeight:`${u-1}px`,wordBreak:D?"break-word":void 0,whiteSpace:D&&p?"normal":"nowrap",boxShadow:p?`0 0 2px ${a.colors.primary.main}`:void 0,background:l?"inherit":f??a.colors.background.primary,zIndex:1,".cellActions":{background:a.components.tooltip.background,color:a.components.tooltip.text,visibility:"visible",opacity:1,width:"auto",borderRadius:a.shape.radius.default}},a:{color:"inherit"},".cellActions":{display:"flex",position:p?void 0:"absolute",top:p?void 0:"1px",right:p?void 0:0,margin:p?a.spacing(0,0,0,1):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:a.spacing(.5,0,.5,.5),background:a.components.tooltip.background,color:a.components.tooltip.text},".cellActionsLeft":{right:"auto !important",left:0}});return{theme:a,cellHeight:d,buildCellContainerStyle:o,cellPadding:c,cellHeightInner:d-c*2,rowHeight:u,table:(0,t.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,t.css)({label:"thead",height:`${g}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,t.css)({label:"tfoot",height:`${g}px`,borderTop:`1px solid ${x}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,t.css)({label:"row",borderBottom:`1px solid ${x}`}),headerCell:(0,t.css)({height:"100%",padding:`0 ${c}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:a.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,t.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:a.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:a.spacing(.5),"&:hover":{textDecoration:"underline",color:a.colors.text.link}}),cellContainerText:o(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:o(void 0,void 0,void 0,!1,!0),cellContainer:o(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:o(void 0,void 0,void 0,!1,!1),cellText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",cursor:"text"}),sortIcon:(0,t.css)({marginLeft:a.spacing(.5)}),cellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:a.colors.text.link,fontWeight:a.typography.fontWeightMedium,paddingRight:a.spacing(1.5),"&:hover":{textDecoration:"underline",color:a.colors.text.link}}),cellLinkForColoredCell:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:a.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,t.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,t.css)({display:"flex",height:`${d}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,t.css)({color:a.colors.text.secondary,fontSize:a.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:a.spacing(0,1,0,2)}),tableContentWrapper:E=>{const m=E!==void 0?`${E}px`:"100%";return(0,t.css)({label:"tableContentWrapper",width:m,display:"flex",flexDirection:"column"})},row:(0,t.css)({label:"row",borderBottom:`1px solid ${x}`,"&:hover":{backgroundColor:a.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,t.css)({height:"100%"}),resizeHandle:(0,t.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:s,opacity:0,[a.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:a.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,t.css)({marginRight:a.spacing(1),color:a.colors.text.secondary}),noData:(0,t.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${u}px`,cursor:"pointer"})}}function r(a,i,x){const s=a.typography.fontSize,c=a.typography.body.lineHeight;switch(i){case"md":return 42;case"lg":return 48;case"sm":default:return x*2+s*c}}},85913:(q,j,e)=>{"use strict";e.d(j,{Zi:()=>n,mc:()=>t});const t="=",n="!="},95547:(q,j,e)=>{"use strict";e.d(j,{jV:()=>Z,HY:()=>Ge,MY:()=>ce,XX:()=>Xe,zi:()=>Te,HW:()=>Me,bk:()=>we,GH:()=>ae,Sj:()=>de,Ux:()=>be,j1:()=>te,O4:()=>Ke,M2:()=>De,Iy:()=>Le,o7:()=>$e,IM:()=>me,Ok:()=>Pe,Yz:()=>he});var t=e(2543),n=e(47078),r=e.n(n),a=e(84140),i=e(63739),x=e(23570),s=e(4038),c=e(67555),d=e(59141),u=e(91357),g=e(16869),o=e(7500),E=e(41090),m=e(74848),f=e(22803),p=e(29675),h=e(32879);const D=Ie=>{const{cellProps:Ne,tableStyles:ie,actions:ve}=Ie,fe=(0,p.of)(C);return(0,m.jsx)("div",{...Ne,className:(0,f.cx)(ie.cellContainerText,fe.buttonsGap),children:ve&&ve.map((ge,xe)=>(0,m.jsx)(h.r,{action:ge,variant:"secondary"},xe))})},C=Ie=>({buttonsGap:(0,f.css)({gap:6})});var l=e(99116),v=e(42825),y=e(21288),P=e(22662),b=e(63006);const S={mode:l.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},M=Ie=>{const{field:Ne,innerWidth:ie,tableStyles:ve,cell:fe,cellProps:ge,row:xe,actions:je}=Ie,Ve=Ne.display(fe.value),ke=we(Ne);let Oe=(0,v.xg)(Ne,!1);Oe.thresholds||(Oe={...Oe,thresholds:S});let nt=o.eX.Gradient,Je;ke.type===o.ob.Gauge&&(nt=ke.mode??o.eX.Gradient,Je=ke.valueDisplayMode!==void 0?ke.valueDisplayMode:o.$l.Text);const Be=()=>(0,t.isFunction)(Ne.getLinks)?Ne.getLinks({valueRowIndex:xe.index}):[],Ze=!!Be().length,tt=!!je?.length,Re=Te(Ne,Ve,fe.row.index),at=yt=>{const{openMenu:ze,targetClassName:st}=yt;return(0,m.jsx)(P.xE,{width:ie,height:ve.cellHeightInner,field:Oe,display:Ne.display,text:{valueSize:14},value:Ve,orientation:y.wV.Horizontal,theme:ve.theme,alignmentFactors:Re,onClick:ze,className:st,itemSpacing:1,lcdCellWidth:8,displayMode:nt,valueDisplayMode:Je})};return(0,m.jsx)("div",{...ge,className:ve.cellContainer,children:Ze||tt?(0,m.jsx)(b.e,{links:Be,actions:je,style:{display:"flex",width:"100%"},children:yt=>at(yt)}):at({})})};var O=e(17444);const R=Ie=>{const{field:Ne,row:ie,cellProps:ve,tableStyles:fe}=Ie,ge=(0,O.k)(Ne,ie);return(0,m.jsx)("div",{...ve,className:fe.cellContainerText,children:ge&&ge.map((xe,je)=>(0,m.jsx)("span",{className:fe.cellLink,onClick:xe.onClick,children:(0,m.jsx)("a",{href:xe.href,target:xe.target,children:xe.title})},je))})};var L=e(96540),B=e(54594),F=e(99764),I=e(48583),U=e(85913);function W({field:Ie,cell:Ne,previewMode:ie,showFilters:ve,onCellFilterAdded:fe,setInspectCell:ge}){const xe=te(Ie)==="flex-end",je=!!Ie.config.custom?.inspect,Ve={size:"sm",tooltipPlacement:"top"},ke=(0,L.useCallback)(nt=>{fe&&fe({key:Ie.name,operator:U.mc,value:Ne.value})},[Ne,Ie,fe]),Oe=(0,L.useCallback)(nt=>{fe&&fe({key:Ie.name,operator:U.Zi,value:Ne.value})},[Ne,Ie,fe]);return(0,m.jsx)("div",{className:`cellActions${xe?" cellActionsLeft":""}`,children:(0,m.jsxs)(I.B,{gap:.5,children:[je&&(0,m.jsx)(F.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{ge&&ge({value:Ne.value,mode:ie})},...Ve}),ve&&(0,m.jsx)(F.K,{name:"search-plus",onClick:ke,tooltip:"Filter for value",...Ve}),ve&&(0,m.jsx)(F.K,{name:"search-minus",onClick:Oe,tooltip:"Filter out value",...Ve})]})})}var A=e(77469);const N=Ie=>{const{field:Ne,cell:ie,tableStyles:ve,row:fe,cellProps:ge,frame:xe,rowStyled:je,rowExpanded:Ve,textWrapped:ke,height:Oe,actions:nt}=Ie,Je=!!Ne.config.custom?.inspect,Be=Ne.display(ie.value),Ze=Ie.onCellFilterAdded&&Ne.config.filterable,tt=Ze&&ie.value!==void 0||Je,Re=we(Ne),at=!!(0,O.k)(Ne,fe)?.length,yt=!!nt?.length,ze=(0,p.of)(B.Ez);let st;const ht=140;if(Re.type===o.ob.Custom){const xn=Re.cellComponent;st=(0,m.jsx)(xn,{field:Ne,value:ie.value,rowIndex:fe.index,frame:xe})}else L.isValidElement(ie.value)?st=ie.value:st=(0,d.cN)(Be);const It=typeof st=="string",Gt=Be.text.length<=ht&&/\s/.test(Be.text),un=K(ve,Re,Be,Je,It,Gt,ke,je,Ve);if(It){let xn=ge.style?.justifyContent;xn==="flex-end"?ge.style={...ge.style,textAlign:"right"}:xn==="center"&&(ge.style={...ge.style,textAlign:"center"})}Oe&&(ge.style={...ge.style,height:Oe}),ke&&(ge.style={...ge.style,textWrap:"wrap"});const{key:vn,...pn}=ge;return(0,m.jsxs)("div",{...pn,className:un,children:[at||yt?(0,m.jsx)(b.e,{links:()=>(0,O.k)(Ne,fe)||[],actions:nt,children:xn=>xn.openMenu?(0,m.jsx)("button",{className:(0,f.cx)(ze,V(ve,Re,xn.targetClassName)),onClick:xn.openMenu,children:st}):(0,m.jsx)("div",{className:V(ve,Re,xn.targetClassName),children:st})}):It?`${st}`:(0,m.jsx)("div",{className:ve.cellText,children:st}),tt&&(0,m.jsx)(W,{...Ie,previewMode:A.B.text,showFilters:Ze})]},vn)};function K(Ie,Ne,ie,ve=!1,fe=!1,ge=!1,xe=!1,je=!1,Ve=!1){let ke,Oe,nt;const Je=Me(Ie,Ne,ie);return ke=Je.textColor,Oe=Je.bgColor,nt=Je.bgHoverColor,Ie.buildCellContainerStyle(ke,Oe,nt,!ve,fe,ge,xe,je,Ve)}function V(Ie,Ne,ie){return Ne.type===o.ob.Auto?(0,f.cx)(Ie.cellLink,ie):(0,f.cx)(Ie.cellLinkForColoredCell,ie)}var T=e(21990),z=e(64136),w=e(27430);function H(Ie){const{cell:Ne,tableStyles:ie,cellProps:ve}=Ie;let fe="";return Ne.value instanceof w.A?fe=new z.A().writeGeometry(Ne.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):Ne.value!=null&&(fe=`${Ne.value}`),(0,m.jsx)("div",{...ve,className:ie.cellContainer,children:(0,m.jsx)("div",{className:ie.cellText,style:{fontFamily:"monospace"},children:fe})})}const G=10,X=Ie=>{const{field:Ne,cell:ie,tableStyles:ve,row:fe,cellProps:ge,actions:xe}=Ie,je=we(Ne),{title:Ve,alt:ke}=je.type===o.ob.Image?je:{title:void 0,alt:void 0},Oe=Ne.display(ie.value),nt=!!(0,O.k)(Ne,fe)?.length,Je=!!xe?.length,Be=(0,m.jsx)("img",{style:{height:ve.cellHeight-G,width:"auto"},src:Oe.text,className:ve.imageCell,alt:ke,title:Ve});return(0,m.jsx)("div",{...ge,className:ve.cellContainer,children:nt||Je?(0,m.jsx)(b.e,{style:{height:ve.cellHeight-G,width:"auto"},links:()=>(0,O.k)(Ne,fe)||[],actions:xe,children:Ze=>Ze.openMenu?(0,m.jsx)("div",{onClick:Ze.openMenu,role:"button",tabIndex:0,onKeyDown:tt=>{tt.key==="Enter"&&Ze.openMenu&&Ze.openMenu(tt)},children:Be}):Be}):Be})};function k(Ie){const{cell:Ne,tableStyles:ie,cellProps:ve,field:fe,row:ge,actions:xe}=Ie,je=!!fe.config.custom?.inspect,Ve=(0,f.css)({cursor:"pointer",fontFamily:"monospace"});let ke=Ne.value,Oe=ke;if((0,t.isString)(ke))try{ke=JSON.parse(ke)}catch{}else Oe=JSON.stringify(ke,null," ");const nt=!!(0,O.k)(fe,ge)?.length,Je=!!xe?.length,Be=(0,p.of)(B.Ez);return(0,m.jsxs)("div",{...ve,className:je?ie.cellContainerNoOverflow:ie.cellContainer,children:[(0,m.jsx)("div",{className:(0,f.cx)(ie.cellText,Ve),children:nt||Je?(0,m.jsx)(b.e,{links:()=>(0,O.k)(fe,ge)||[],actions:xe,children:Ze=>Ze.openMenu?(0,m.jsx)(B.$n,{className:(0,f.cx)(Be),onClick:Ze.openMenu,children:Oe}):(0,m.jsx)(m.Fragment,{children:Oe})}):(0,m.jsx)("div",{className:ie.cellText,children:Oe})}),je&&(0,m.jsx)(W,{...Ie,previewMode:A.B.code})]})}var _=e(79784);function ee({row:Ie,tableStyles:Ne}){return(0,m.jsx)("div",{className:Ne.expanderCell,...Ie.getToggleRowExpandedProps(),children:(0,m.jsx)(_.I,{"aria-label":Ie.isExpanded?"Collapse row":"Expand row",name:Ie.isExpanded?"angle-down":"angle-right",size:"lg"})})}var J=e(97225);const Z=50;function te(Ie){if(!Ie)return"flex-start";if(Ie.config.custom)switch(Ie.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return Ie.type===i.PU.number?"flex-end":"flex-start"}function ae(Ie,Ne,ie,ve,fe,ge){const xe=[];let je=0;ve&&(xe.push({Header:()=>null,id:"expander",Cell:ee,width:Z,minWidth:Z,filter:(ke,Oe,nt)=>[],justifyContent:"left",field:Ie.fields[0],sortType:"basic"}),Ne-=Z);for(const[ke,Oe]of Ie.fields.entries()){const nt=Oe.config.custom||{};if(nt.hidden||Oe.type===i.PU.nestedFrames)continue;nt.width?Ne-=nt.width:je++;const Je=Ze=>{switch(Ze){case i.PU.number:case i.PU.frame:return"number";case i.PU.time:return"basic";default:return"alphanumeric-insensitive"}},Be=re(nt.cellOptions?.type,Oe);xe.push({Cell:Be,id:ke.toString(),field:Oe,Header:nt.hideHeader?"":(0,x.Ct)(Oe,Ie),accessor:(Ze,tt)=>Oe.values[tt],sortType:Je(Oe.type),width:nt.width,minWidth:nt.minWidth??ie,filter:r()(ne(Oe)),justifyContent:te(Oe),Footer:(0,T.d)(ke,fe,ge)})}let Ve=Ne/je;for(let ke=je;ke>0;ke--)for(const Oe of xe)!Oe.width&&Oe.minWidth>Ve&&(Oe.width=Oe.minWidth,Ne-=Oe.width,je-=1,Ve=Ne/je);for(const ke of xe)ke.width||(ke.width=Ve),ke.minWidth=50;return xe}function re(Ie,Ne){switch(Ie){case o.ob.Custom:case o.ob.ColorText:case o.ob.ColorBackground:return N;case o.ob.Image:return X;case o.ob.Gauge:return M;case o.ob.Sparkline:return J.a;case o.ob.JSONView:return k;case o.ob.DataLinks:return R;case o.ob.Actions:return D}if(Ne.type===i.PU.geo)return H;if(Ne.type===i.PU.frame){const ie=Ne.values[0];return(0,s.ci)(ie)&&(0,c.aH)(ie)?J.a:k}return Ne.type===i.PU.other?k:N}function ne(Ie){return function(Ne,ie,ve){return Ne.length===0||!ve||!Ie?Ne:Ne.filter(fe=>{if(!fe.values.hasOwnProperty(ie))return!1;const ge=le(fe,Ie);return ve.find(xe=>xe.value===ge)!==void 0})}}function ce(Ie,Ne){if(!Ne||Ie.length===0)return{};const ie={};for(let ve=0;ve<Ie.length;ve++){const fe=le(Ie[ve],Ne);ie[fe||"(Blanks)"]=fe}return ie}function le(Ie,Ne){if(!Ne||!Ie)return"";const ie=Ne.values[Ie.index],ve=Ne.display?Ne.display(ie):ie;return Ne.display?(0,d.cN)(ve):ve}function he(Ie){return Object.keys(Ie).reduce((Ne,ie)=>Ne.concat({value:Ie[ie],label:ie}),[]).sort(oe)}function oe(Ie,Ne){return Ie.label===void 0&&Ne.label===void 0?0:Ie.label===void 0&&Ne.label!==void 0?-1:Ie.label!==void 0&&Ne.label===void 0?1:Ie.label<Ne.label?-1:Ie.label>Ne.label?1:0}function de(Ie,Ne){return Ne?Ie.filter(ie=>Ne.some(ve=>ve.value===ie.value)):[]}function me(Ie,Ne,ie){return String(Ie.values[ie]).localeCompare(String(Ne.values[ie]),void 0,{sensitivity:"base"})}function Pe(Ie,Ne,ie){const ve=Ee(Ie.values[ie]),fe=Ee(Ne.values[ie]);return ve===fe?0:ve>fe?1:-1}function Ee(Ie){return(0,s.LI)(Ie)?Ie.value??Number.NEGATIVE_INFINITY:Ie==null||Ie===""||isNaN(Ie)?Number.NEGATIVE_INFINITY:typeof Ie=="number"?Ie:Number(Ie)}function be(Ie,Ne,ie,ve){return Fe(Ie),Ie.map((fe,ge)=>{if(fe?.field?.type!==i.PU.number)return ge===0&&ie.reducer&&ie.reducer.length>0?u.AS.get(ie.reducer[0]).name:void 0;let xe=(0,t.clone)(fe.field);return xe.values=Ne[fe.id],xe.state=void 0,fe.field=xe,ie.fields&&ie.fields.length>0?ie.fields.find(Ve=>Ve===fe?.field?.name)?Se(fe.field,ie.reducer,ve):void 0:Se(fe.field,ie.reducer||[],ve)})}function Se(Ie,Ne,ie){const ve=Ne[0];if(ve===void 0)return"";const fe=Ie.display??(0,g.J)({field:Ie,theme:ie}),ge=(0,u.Nw)({field:Ie,reducers:Ne})[ve];return u.AS.get(ve).preservesUnits?(0,d.cN)(fe(ge)):(0,d.cN)({text:ge})}function Xe(Ie){const Ne=[];for(const ie in Ie)for(const[ve,fe]of Object.entries(Ie[ie].values))Ne[ve]===void 0&&(Ne[ve]=[]),Ne[ve].push(fe);return Ne}const Qe={type:o.ob.Auto};function we(Ie){return Ie.config.custom?.displayMode?$e(Ie.config.custom?.displayMode):Ie.config.custom?.cellOptions?Ie.config.custom.cellOptions:Qe}function $e(Ie){switch(Ie){case"basic":case"gradient-gauge":case"lcd-gauge":let Ne=o.eX.Basic;return Ie==="gradient-gauge"?Ne=o.eX.Gradient:Ie==="lcd-gauge"&&(Ne=o.eX.Lcd),{type:o.ob.Gauge,mode:Ne};case"color-background":case"color-background-solid":let ie=o.Wq.Basic;return Ie==="color-background"&&(ie=o.Wq.Gradient),{type:o.ob.ColorBackground,mode:ie};default:return{type:Ie}}}function Fe(Ie){const Ne=Ie.findIndex((ie,ve)=>ie?.id!==String(ve));Ne===-1||Ie[Ne]?.id==="expander"||(Ie.splice(Ne,0,{id:String(Ne)}),Fe(Ie))}function Te(Ie,Ne,ie){let ve=Ie.state?.alignmentFactors;if(ve)return(0,d.cN)(ve).length<(0,d.cN)(Ne).length&&(ve={...Ne},Ie.state.alignmentFactors=ve),ve;{ve={...Ne};const fe=Math.min(Ie.values.length,ie+1e3);for(let ge=ie+1;ge<fe;ge++){const xe=Ie.display(Ie.values[ge]);(0,d.cN)(ve).length>(0,d.cN)(xe).length&&(ve.text=Ne.text)}return Ie.state?Ie.state.alignmentFactors=ve:Ie.state={alignmentFactors:ve},ve}}function Le(Ie,Ne,ie){return Math.abs(Math.floor(Ie)-Ne)<ie}function Ge(Ie){let Ne=-Number.MAX_VALUE,ie=Number.MAX_VALUE;if(Ie.values.length<2)return 0;for(let ve=0;ve<Ie.values.length;ve++){const fe=Ie.values[ve];fe>Ne&&(Ne=fe),fe<ie&&(ie=fe)}return(Ne-ie)/Ie.values.length}function Me(Ie,Ne,ie){const ve=Ie.theme.isDark?1:-.7;let fe,ge,xe;if(Ne.type===o.ob.ColorText)fe=ie.color;else if(Ne.type===o.ob.ColorBackground){const je=Ne.mode??o.Wq.Gradient;if(je===o.Wq.Basic)fe=(0,E.mZ)(ie.color,Ie.theme.isDark),ge=(0,a.A)(ie.color).toRgbString(),xe=(0,a.A)(ie.color).setAlpha(1).toRgbString();else if(je===o.Wq.Gradient){const Ve=(0,a.A)(ie.color).setAlpha(1).toRgbString(),ke=(0,a.A)(ie.color).darken(10*ve).spin(5);fe=(0,E.mZ)(ie.color,Ie.theme.isDark),ge=`linear-gradient(120deg, ${ke.toRgbString()}, ${ie.color})`,xe=`linear-gradient(120deg, ${ke.setAlpha(1).toRgbString()}, ${Ve})`}}return{textColor:fe,bgColor:ge,bgHoverColor:xe}}function De(Ie,Ne,ie,ve,fe,ge=0){const xe=Number(Ne?.width??300),je=1.17,Ve=42,ke=ge*2;if(ie!==null&&typeof Ie=="string"){const Oe=Ie.split(/\s/),nt=[];let Je="",Be=0,Ze=0;for(let at=0;at<Oe.length;at++){const yt=Oe[at];let ze=ie.measureText(Je+" "+yt).width;ze<xe-ke?(Je+=" "+yt,Be++):(nt.push({width:ze,line:Je}),Je=yt,Be=0)}for(let at=0;at<nt.length;at++)if(nt[at].width>xe){let yt=Math.floor(nt[at].width/xe)-1;Ze+=yt}let tt=nt.length+Ze,Re=38;return tt>5?Re=tt*ve*je:Re=tt*ve+Ve,Re+=ke,{width:xe,height:Re}}return{width:xe,height:fe}}function Ke(Ie,Ne){let ie;if(Ie.defaults.custom?.cellOptions?.wrapText){const fe=Ne.fields.filter(ge=>ge.type===i.PU.string);if(fe.length>=1&&fe[0].values.length>0){const ge=fe[0].values.length;let xe=0;if(ge<=30)for(const je of fe){const Ve=je.values[0].length;Ve>xe&&(xe=Ve,ie=je)}else for(const je of fe){const Ve=(0,t.sampleSize)(je.values,3),ke=(Ve[0]?.length+Ve[1]?.length+Ve[2]?.length)/3;ke>xe&&(xe=ke,ie=je)}}}return ie}},13676:(q,j,e)=>{"use strict";e.d(j,{p:()=>i});var t=e(74848),n=e(22803),r=e(59141),a=e(29675);const i=({value:s})=>{const c=(0,a.of)(x);return(0,t.jsx)("span",{className:c.counter,children:(0,r.Hg)(s,0).text})},x=s=>({counter:(0,n.css)({label:"counter",marginLeft:s.spacing(1),borderRadius:s.spacing(3),backgroundColor:s.colors.action.hover,padding:s.spacing(.25,1),color:s.colors.text.secondary,fontWeight:s.typography.fontWeightMedium,fontSize:s.typography.size.sm})})},88849:(q,j,e)=>{"use strict";e.d(j,{o:()=>u});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(94963),s=e(54594),c=e(79784),d=e(13676);const u=r.forwardRef(({label:o,active:E,icon:m,onChangeTab:f,counter:p,suffix:h,className:D,href:C,...l},v)=>{const y=(0,i.of)(g),P=(0,i.of)(s.my),b=()=>(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)(c.I,{name:m}),o,typeof p=="number"&&(0,t.jsx)(d.p,{value:p}),h&&(0,t.jsx)(h,{className:y.suffix})]}),M={className:(0,n.cx)(P,y.link,E?y.activeStyle:y.notActive),"data-testid":a.Tp.components.Tab.title(o),...l,onClick:f,role:"tab","aria-selected":E};return C?(0,t.jsx)("div",{className:(0,n.cx)(y.item,D),children:(0,t.jsx)("a",{...M,href:C,ref:v,children:b()})}):(0,t.jsx)("div",{className:(0,n.cx)(y.item,D),children:(0,t.jsx)("button",{...M,type:"button",ref:v,children:b()})})});u.displayName="Tab";const g=o=>({item:(0,n.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:o.spacing(.5)}),link:(0,n.css)({color:o.colors.text.secondary,padding:o.spacing(1,1.5,.5),borderRadius:o.shape.radius.default,display:"block",height:"100%",svg:{marginRight:o.spacing(1)},"&:focus-visible":(0,x.getFocusStyles)(o),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:o.shape.radius.default,bottom:0}}),notActive:(0,n.css)({"a:hover, &:hover, &:focus":{color:o.colors.text.primary,"&::before":{backgroundColor:o.colors.action.hover}}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:o.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:o.colors.gradients.brandHorizontal}}),suffix:(0,n.css)({marginLeft:o.spacing(1)})})},11238:(q,j,e)=>{"use strict";e.d(j,{J:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x,className:s,...c})=>{const d=(0,r.of)(i);return(0,t.jsx)("div",{...c,className:(0,n.cx)(d.tabContent,s),children:x})},i=x=>({tabContent:(0,n.css)({background:x.colors.background.primary})})},10247:(q,j,e)=>{"use strict";e.d(j,{U:()=>i});var t=e(74848),n=e(22803),r=e(96540),a=e(29675);const i=(0,r.forwardRef)(({children:s,className:c,hideBorder:d=!1},u)=>{const g=(0,a.of)(x);return(0,t.jsx)("div",{className:(0,n.cx)(g.tabsWrapper,d&&g.noBorder,c),ref:u,children:(0,t.jsx)("div",{className:g.tabs,role:"tablist",children:s})})}),x=s=>({tabsWrapper:(0,n.css)({borderBottom:`1px solid ${s.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,n.css)({borderBottom:0}),tabs:(0,n.css)({position:"relative",display:"flex",height:s.spacing(s.components.menuTabs.height),alignItems:"stretch"})});i.displayName="TabsBar"},73903:(q,j,e)=>{"use strict";e.d(j,{v:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(70255),i=e(29675),x=e(27671),s=e(71815),c=e(79784);const d=(0,r.forwardRef)(({name:m,onClick:f,icon:p,className:h,colorIndex:D,...C},l)=>{const v=(0,i.$j)(),y=E(v,m,D),P=S=>{S.preventDefault(),S.stopPropagation(),f?.(m,S)},b=(0,n.cx)(y.wrapper,h,{[y.hover]:f!==void 0});return f?(0,t.jsxs)("button",{...C,className:b,onClick:P,ref:l,children:[p&&(0,t.jsx)(c.I,{name:p}),m]}):(0,t.jsxs)("span",{...C,className:b,ref:l,children:[p&&(0,t.jsx)(c.I,{name:p}),m]})});d.displayName="Tag";const u=({rootProps:m})=>{const f=(0,i.of)(o);return(0,t.jsx)(a.A,{width:60,height:22,containerClassName:f.container,...m})},g=(0,s.j)(d,u),o=()=>({container:(0,n.css)({lineHeight:1})}),E=(m,f,p)=>{let h;return p===void 0?h=(0,x.MC)(f):h=(0,x.yC)(p),{wrapper:(0,n.css)({appearance:"none",borderStyle:"none",fontWeight:m.typography.fontWeightMedium,fontSize:m.typography.size.sm,lineHeight:m.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:h.color,color:m.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:m.shape.radius.default}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},95015:(q,j,e)=>{"use strict";e.d(j,{L:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(71815),x=e(73903);const s=(0,r.memo)((0,r.forwardRef)(({displayMax:o,tags:E,icon:m,onClick:f,className:p,getAriaLabel:h,getColorIndex:D},C)=>{const l=(0,a.$j)(),v=g(l,!!(o&&o>0)),y=E.length,P=o?E.slice(0,o):E;return(0,t.jsxs)("ul",{className:(0,n.cx)(v.wrapper,p),"aria-label":"Tags",ref:C,children:[P.map((b,S)=>(0,t.jsx)("li",{className:v.li,children:(0,t.jsx)(x.v,{name:b,icon:m,onClick:f,"aria-label":h?.(b,S),"data-tag-id":S,colorIndex:D?.(b,S)})},b)),o&&o>0&&y-o>0&&(0,t.jsxs)("span",{className:v.moreTagsLabel,children:["+ ",y-o]})]})}));s.displayName="TagList";const c=({rootProps:o})=>{const E=(0,a.of)(u);return(0,t.jsxs)("div",{className:E.container,...o,children:[(0,t.jsx)(x.v.Skeleton,{}),(0,t.jsx)(x.v.Skeleton,{})]})},d=(0,i.j)(s,c),u=o=>({container:(0,n.css)({display:"flex",gap:o.spacing(1)})}),g=(o,E)=>({wrapper:(0,n.css)({position:"relative",alignItems:E?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:E?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,n.css)({color:o.colors.text.secondary,fontSize:o.typography.size.sm}),li:(0,n.css)({listStyle:"none"})})},32319:(q,j,e)=>{"use strict";e.d(j,{u:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(70462),x=e(54594),s=e(34128),c=e(27671),d=e(99764);const u=({name:m,disabled:f,onRemove:p})=>{const{color:h,borderColor:D}=(0,r.useMemo)(()=>(0,c.MC)(m),[m]),C=(0,a.of)(g);return(0,t.jsxs)("li",{className:C.itemStyle,style:{backgroundColor:h,borderColor:D},children:[(0,t.jsx)("span",{className:C.nameStyle,children:m}),(0,t.jsx)(d.K,{name:"times",size:"lg",disabled:f,tooltip:`Remove "${m}" tag`,onClick:()=>p(m),className:C.buttonStyles})]})},g=m=>{const f=m.spacing.gridSize*3;return{itemStyle:(0,n.css)({display:"flex",gap:"3px",alignItems:"center",height:`${f}px`,lineHeight:`${f-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:m.shape.radius.default,padding:`0 ${m.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:m.typography.size.sm}),nameStyle:(0,n.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,n.css)({margin:0,"&:hover::before":{display:"none"}})}},o=({placeholder:m="New tag (enter key to add)",tags:f=[],onChange:p,width:h,className:D,disabled:C,addOnBlur:l,invalid:v,id:y})=>{const[P,b]=(0,r.useState)(""),S=(0,a.of)(E),M=(0,a.$j)(),O=(0,r.useCallback)(I=>{b(I.target.value)},[]),R=I=>{p(f.filter(U=>U!==I))},L=I=>{I?.preventDefault(),f.includes(P)||p(f.concat(P)),b("")},B=()=>{l&&P&&L()},F=I=>{I.key==="Enter"&&P!==""&&L(I)};return(0,t.jsxs)("div",{className:(0,n.cx)(S.wrapper,D,h?(0,n.css)({width:M.spacing(h)}):""),children:[(0,t.jsx)(s.p,{id:y,disabled:C,placeholder:m,onChange:O,value:P,onKeyDown:F,onBlur:B,invalid:v,suffix:(0,t.jsx)(x.$n,{fill:"text",className:S.addButtonStyle,onClick:L,size:"md",disabled:P.length<=0,children:(0,t.jsx)(i.x,{i18nKey:"grafana-ui.tags-input.add",children:"Add"})})}),f?.length>0&&(0,t.jsx)("ul",{className:S.tags,children:f.map(I=>(0,t.jsx)(u,{name:I,onRemove:R,disabled:C},I))})]})},E=m=>({wrapper:(0,n.css)({minHeight:m.spacing(4),display:"flex",flexDirection:"column",gap:m.spacing(1),flexWrap:"wrap"}),tags:(0,n.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:m.spacing(.5)}),addButtonStyle:(0,n.css)({margin:`0 -${m.spacing(1)}`})})},50926:(q,j,e)=>{"use strict";e.d(j,{f:()=>x});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(89256);const x=(0,r.forwardRef)(({invalid:c,className:d,...u},g)=>{const o=(0,a.of)(s,c);return(0,t.jsx)("textarea",{...u,className:(0,n.cx)(o.textarea,d),ref:g})}),s=(c,d=!1)=>({textarea:(0,n.cx)((0,i.Xb)(c),(0,i.gm)(c),(0,n.css)({display:"block",borderRadius:c.shape.radius.default,padding:`${c.spacing.gridSize/4}px ${c.spacing.gridSize}px`,width:"100%",borderColor:d?c.colors.error.border:c.components.input.borderColor}))});x.displayName="TextArea"},26676:(q,j,e)=>{"use strict";e.d(j,{G:()=>u});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(96540),s=e(29675),c=e(89806),d=e(99764);const u=(0,x.memo)(({children:o,theme:E="info",placement:m="auto",content:f,title:p,closeButton:h=!0,onClose:D,footer:C,fitContent:l=!1,onOpen:v,show:y})=>{const P=(0,x.useRef)(null),b=(0,s.$j)(),S=(0,s.of)(g),M=S[E],[O,R]=(0,x.useState)(y),L=y??O,B=[(0,r.cY)(8),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)(),(0,r.UE)({element:P})],{context:F,refs:I,floatingStyles:U}=(0,a.we)({open:L,placement:(0,c.O)(m),onOpenChange:V=>{y===void 0&&R(V),V?v?.():D?.()},middleware:B,whileElementsMounted:i.ll,strategy:"fixed"}),W=(0,a.kp)(F),A=(0,a.s9)(F),{getReferenceProps:N,getFloatingProps:K}=(0,a.bv)([A,W]);return(0,t.jsxs)(t.Fragment,{children:[(0,x.cloneElement)(o,{ref:I.setReference,tabIndex:0,"aria-expanded":L,...N()}),L&&(0,t.jsx)(a.s3,{context:F,modal:!1,closeOnFocusOut:!1,children:(0,t.jsxs)("div",{"data-testid":"toggletip-content",className:(0,n.cx)(M.container,{[S.fitContent]:l}),ref:I.setFloating,style:U,...K(),children:[(0,t.jsx)(a.ie,{strokeWidth:.3,stroke:b.colors.border.weak,className:M.arrow,ref:P,context:F}),!!p&&(0,t.jsx)("div",{className:M.header,children:p}),h&&(0,t.jsx)("div",{className:M.headerClose,children:(0,t.jsx)(d.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{R(!1),D?.()}})}),(0,t.jsxs)("div",{className:M.body,children:[(typeof f=="string"||(0,x.isValidElement)(f))&&f,typeof f=="function"&&f({})]}),!!C&&(0,t.jsx)("div",{className:M.footer,children:C})]})})]})});u.displayName="Toggletip";const g=o=>{const E=(0,c.f)(o,o.colors.background.primary,o.colors.border.weak,o.components.tooltip.text,{topBottom:2,rightLeft:2}),m=(0,c.f)(o,o.colors.error.main,o.colors.error.main,o.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:E,error:m,fitContent:(0,n.css)({maxWidth:"fit-content"})}}},52120:(q,j,e)=>{"use strict";e.d(j,{I:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(5005),i=e(58779),x=e(29675),s=e(94963),c=e(54594),d=e(79784),u=e(6736);const g=(0,r.forwardRef)(({tooltip:f,icon:p,iconSize:h,className:D,children:C,imgSrc:l,imgAlt:v,fullWidth:y,isOpen:P,narrow:b,variant:S="default",iconOnly:M,"aria-label":O,isHighlighted:R,...L},B)=>{const F=(0,x.of)(m),I=(0,n.cx)({[F.button]:!0,[F.buttonFullWidth]:y,[F.narrow]:b},F[S],D),U=(0,n.cx)({[F.content]:!0,[F.contentWithIcon]:!!p,[F.contentWithRightIcon]:P!==void 0}),W=(0,t.jsxs)("button",{ref:B,className:I,"aria-label":o(O,f),"aria-expanded":P,...L,children:[E(p,h),l&&(0,t.jsx)("img",{className:F.img,src:l,alt:v??""}),C&&!M&&(0,t.jsx)("div",{className:U,children:C}),P===!1&&(0,t.jsx)(d.I,{name:"angle-down"}),P===!0&&(0,t.jsx)(d.I,{name:"angle-up"}),R&&(0,t.jsx)("div",{className:F.highlight})]});return f?(0,t.jsx)(u.m,{ref:B,content:f,placement:"bottom",children:W}):W});g.displayName="ToolbarButton";function o(f,p){return f||(p?i.Tp.components.PageToolbar.item(p):void 0)}function E(f,p){return f?(0,a.n6)(f)?(0,t.jsx)(d.I,{name:f,size:`${p||"lg"}`}):f:null}const m=f=>{const p=(0,c.U_)(f,"primary","solid"),h=(0,c.U_)(f,"destructive","solid"),D=(0,n.css)({color:f.colors.text.primary,background:f.colors.secondary.main,"&:hover":{color:f.colors.text.primary,background:f.colors.secondary.shade,border:`1px solid ${f.colors.border.medium}`}});return{button:(0,n.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:f.spacing(f.components.height.md),padding:f.spacing(0,1),borderRadius:f.shape.radius.default,lineHeight:`${f.components.height.md*f.spacing.gridSize-2}px`,fontWeight:f.typography.fontWeightMedium,border:`1px solid ${f.colors.secondary.border}`,whiteSpace:"nowrap",[f.transitions.handleMotion("no-preference","reduce")]:{transition:f.transitions.create(["background","box-shadow","border-color","color"],{duration:f.transitions.duration.short})},[f.breakpoints.down("md")]:{width:"auto !important"},"&:focus, &:focus-visible":{...(0,s.getFocusStyles)(f),zIndex:1},"&:focus:not(:focus-visible)":(0,s.getMouseFocusStyles)(f),"&[disabled], &:disabled":{cursor:"not-allowed",opacity:f.colors.action.disabledOpacity,background:f.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:f.colors.text.disabled,background:f.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,n.css)({color:f.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:f.colors.text.primary,background:f.colors.action.hover}}),canvas:D,active:(0,n.cx)(D,(0,n.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:f.shape.radius.default,backgroundImage:f.colors.gradients.brandHorizontal}})),primary:(0,n.css)(p),destructive:(0,n.css)(h),narrow:(0,n.css)({padding:f.spacing(0,.5)}),img:(0,n.css)({width:"16px",height:"16px",marginRight:f.spacing(1)}),buttonFullWidth:(0,n.css)({flexGrow:1}),content:(0,n.css)({display:"flex",flexGrow:1}),contentWithIcon:(0,n.css)({display:"none",paddingLeft:f.spacing(1),[`@media ${s.mediaUp(f.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,n.css)({paddingRight:f.spacing(.5)}),highlight:(0,n.css)({backgroundColor:f.colors.success.main,borderRadius:f.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},48194:(q,j,e)=>{"use strict";e.d(j,{U:()=>u});var t=e(74848),n=e(22803),r=e(18828),a=e(85690),i=e(93225),x=e(96540),s=e(29675),c=e(75606),d=e(52120);const u=(0,x.forwardRef)(({alignment:o="left",className:E,children:m,...f},p)=>{const h=x.Children.toArray(m).filter(B=>B!=null),[D,C]=(0,x.useState)(Array(h.length).fill(!1)),l=(0,x.useRef)(null),[v,y]=(0,x.useState)(!1),P=(0,x.useRef)(null),b=(0,x.createRef)(),{overlayProps:S}=(0,i.e)({onClose:()=>y(!1),isDismissable:!0,isOpen:v,shouldCloseOnInteractOutside:B=>{const F=(0,c.gF)();return!P.current?.contains(B)&&!F.contains(B)}},b),{dialogProps:M}=(0,r.s)({},b),O=(0,s.$j)(),R=o==="left"?D.indexOf(!1)-1:D.length,L=g(O,R,o);return(0,x.useLayoutEffect)(()=>{const B=new IntersectionObserver(F=>{F.forEach(I=>{if(I.target instanceof HTMLElement&&I.target.parentNode){const U=Array.prototype.indexOf.call(I.target.parentNode.children,I.target);C(W=>{const A=[...W];return A[U]=I.isIntersecting,A})}})},{threshold:1,root:l.current});return l.current&&Array.from(l.current.children).forEach(F=>{F instanceof HTMLElement&&F!==P.current&&B.observe(F)}),()=>B.disconnect()},[m]),(0,t.jsxs)("div",{ref:l,className:(0,n.cx)(L.container,E),...f,children:[h.map((B,F)=>(0,t.jsx)("div",{style:{order:F,visibility:D[F]?"visible":"hidden"},className:L.childWrapper,children:B},F)),D.includes(!1)&&(0,t.jsxs)("div",{ref:P,className:L.overflowButton,children:[(0,t.jsx)(d.I,{variant:v?"active":"default",tooltip:"Show more items",onClick:()=>y(!v),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),v&&(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:L.overflowItems,ref:b,...S,...M,children:h.map((B,F)=>!D[F]&&B)})})]})]})});u.displayName="ToolbarButtonRow";const g=(o,E,m)=>({overflowButton:(0,n.css)({order:E}),overflowItems:(0,n.css)({alignItems:"center",backgroundColor:o.colors.background.primary,borderRadius:o.shape.radius.default,boxShadow:o.shadows.z2,display:"flex",flexWrap:"wrap",gap:o.spacing(1),marginTop:o.spacing(1),maxWidth:"80vw",padding:o.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:o.zIndex.dropdown}),container:(0,n.css)({alignItems:"center",display:"flex",gap:o.spacing(1),justifyContent:m==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:o.spacing(1)})})},95486:(q,j,e)=>{"use strict";e.d(j,{A:()=>d});var t=e(74848),n=e(34743),r=e(83505),a=e(46885),i=e(96540),x=e(29675),s=e(89806),c=e(75606);function d({content:u,show:g,placement:o,className:E,wrapperClassName:m,referenceElement:f,renderArrow:p,hidePopper:h,...D}){const C=(0,x.$j)(),l=(0,i.useRef)(null),v=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()];p&&v.push((0,n.UE)({element:l}));const{context:y,refs:P,floatingStyles:b}=(0,r.we)({open:g,placement:(0,s.O)(o),middleware:v,whileElementsMounted:a.ll,strategy:"fixed"});(0,i.useLayoutEffect)(()=>{P.setReference(f)},[f,P]);const{styles:S}=(0,r.DL)(y,{initial:()=>({opacity:0}),duration:C.transitions.duration.enteringScreen});return g?(0,t.jsx)(c.ZL,{children:(0,t.jsx)("div",{ref:P.setFloating,style:{...b,...S},className:m,...D,children:(0,t.jsxs)("div",{className:E,children:[p&&(0,t.jsx)(r.ie,{fill:C.colors.border.weak,ref:l,context:y}),typeof u=="string"&&u,i.isValidElement(u)&&i.cloneElement(u),typeof u=="function"&&u({hidePopper:h})]})})}):void 0}},52706:(q,j,e)=>{"use strict";e.d(j,{I:()=>n});var t=e(96540);class n extends t.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:a,content:i,placement:x="auto"}=this.props,{show:s}=this.state;return a(this.showPopper,this.hidePopper,{show:s,placement:x,content:i})}}},90411:(q,j,e)=>{"use strict";e.d(j,{z:()=>a});var t=e(74848),n=e(96540);function r(i,x){const s=[];return i.forEach(c=>{s.push(c.start,c.end+1)}),s[0]!==0&&s.unshift(0),s[s.length-1]!==x&&s.push(x),s}const a=i=>{let{highlightParts:x,text:s,highlightClassName:c}=i;if(!x?.length)return null;let d=[],u=r(x,s.length),g=x[0].start===0;for(let o=1;o<u.length;o++){let E=u[o-1],m=u[o];d.push((0,n.createElement)(g?"mark":"span",{key:o-1,className:g?c:void 0},s.substring(E,m))),g=!g}return(0,t.jsx)("div",{children:d})}},69942:(q,j,e)=>{"use strict";e.d(j,{p:()=>x});var t=e(74848),n=e(96540),r=e(59141),a=e(530);function i(s){return`Custom unit: ${s}`}class x extends n.PureComponent{constructor(){super(...arguments),this.onChange=c=>{this.props.onChange(c.value)}}render(){const{value:c,width:d}=this.props;let u;const o=(0,r.Ke)().map(E=>{const m=E.submenu.map(f=>{const p={label:f.text,value:f.value};return f.value===c&&(u=p),p});return{label:E.text,value:E.text,items:m}});return c&&!u&&(u={value:c,label:c}),(0,t.jsx)(a.v,{width:d,initialValue:u&&u.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:i,options:o,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},40232:(q,j,e)=>{"use strict";e.d(j,{e:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(26777);const i=({src:s,alt:c,width:d,height:u})=>{const g=(0,r.of)(x,d,u);return(0,t.jsx)("img",{className:g.image,src:s,alt:c})},x=(s,c=3,d=3)=>({image:(0,n.css)([(0,a.Y)(s,c,u=>({width:s.spacing(u)})),(0,a.Y)(s,d,u=>({height:s.spacing(u)})),{borderRadius:s.shape.radius.circle}])})},31952:(q,j,e)=>{"use strict";e.d(j,{i:()=>s});var t=e(74848),n=e(96540),r=e(58779),a=e(29675),i=e(54594),x=e(44826);function s({"aria-label":c,label:d,icon:u,options:g,onChange:o,variant:E,minWidth:m=16,size:f="sm",isFullWidth:p=!0,menuPlacement:h,fill:D,buttonCss:C}){const[l,v]=(0,n.useState)(!1),y=(0,a.$j)();return(0,t.jsxs)(t.Fragment,{children:[!l&&(0,t.jsx)(i.$n,{size:f||"sm",className:C,icon:u||"plus",onClick:()=>v(!0),variant:E,fill:D,fullWidth:p,"data-testid":r.Tp.components.ValuePicker.button(c??d),children:d}),l&&(0,t.jsx)("span",{style:{minWidth:y.spacing(m),flexGrow:p?1:void 0},children:(0,t.jsx)(x.l6,{placeholder:d,options:g,"aria-label":r.Tp.components.ValuePicker.select(c??d),isOpen:!0,onCloseMenu:()=>v(!1),autoFocus:!0,onChange:P=>{v(!1),o(P)},menuPlacement:h})})]})}},85832:(q,j,e)=>{"use strict";e.d(j,{KU:()=>s});var t=e(74848),n=e(22803),r=e(49185),a=e(29675),i=e(94963),x=e(99134);const s=({width:u,height:g,legend:o,children:E})=>{const m=(0,a.$j)(),f=(0,a.of)(c),p={display:"flex",width:`${u}px`,height:`${g}px`},[h,D]=(0,r.A)();if(!o)return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:p,className:f.viz,children:E(u,g)})});let{placement:C,maxHeight:l="35%",maxWidth:v="60%"}=o.props;document.body.clientWidth<m.breakpoints.values.lg&&(C="bottom");let y=null;const P={};switch(C){case"bottom":p.flexDirection="column",P.maxHeight=l,D.height&&(y={width:u,height:g-D.height});break;case"right":p.flexDirection="row",P.maxWidth=v,D.width&&(y={width:u-D.width,height:g}),o.props.width&&(P.width=o.props.width,y={width:u-o.props.width,height:g});break}return y?.width===0&&(y.width=u),y?.height===0&&(y.height=g),(0,t.jsxs)("div",{style:p,children:[(0,t.jsx)("div",{className:f.viz,children:y&&E(y.width,y.height)}),(0,t.jsx)("div",{style:P,ref:h,children:(0,t.jsx)(x.P,{children:o})})]})},c=u=>({viz:(0,n.css)({flexGrow:2,borderRadius:u.shape.radius.default,"&:focus-visible":(0,i.getFocusStyles)(u)})}),d=({children:u})=>(0,t.jsx)(t.Fragment,{children:u});s.Legend=d},61834:(q,j,e)=>{"use strict";e.d(j,{p:()=>x});var t=e(74848),n=e(22803),r=e(96540),a=e(18752),i=e(29675);const x=r.memo(r.forwardRef(({color:c,className:d,gradient:u,lineStyle:g,...o},E)=>{const m=(0,i.$j)(),f=(0,i.of)(s);let p;if(u){const D=a.uf.get(u).getColors?.(m);D?.length?p=`linear-gradient(90deg, ${D.join(", ")})`:p=m.visualization.getColorByName("")}else p=c;let h;return g?.fill==="dot"&&!u?h={backgroundImage:`radial-gradient(circle at 2px 2px, ${c} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:g?.fill==="dash"&&!u?h={backgroundImage:`linear-gradient(to right, ${c} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:h={background:p,borderRadius:m.shape.radius.pill},(0,t.jsx)("div",{"data-testid":"series-icon",ref:E,className:(0,n.cx)(d,f.forcedColors,f.container),style:h,...o})})),s=c=>({container:(0,n.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,n.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});x.displayName="SeriesIcon"},43987:(q,j,e)=>{"use strict";e.d(j,{t:()=>O});var t=e(74848),n=e(96540),r=e(35383),a=e(7500),i=e(90415),x=e(25205),s=e(22803),c=e(29675),d=e(94653),u=e(79878),g=e(83333);const o=({items:R,itemRenderer:L,onLabelMouseOver:B,onLabelMouseOut:F,onLabelClick:I,placement:U,className:W,readonly:A})=>{const N=(0,c.of)(E);L||(L=V=>(0,t.jsx)(g.M,{item:V,onLabelClick:I,onLabelMouseOver:B,onLabelMouseOut:F,readonly:A}));const K=V=>`${V.getItemKey?V.getItemKey():V.label}`;switch(U){case"right":{const V=(T,z)=>(0,t.jsx)("span",{className:N.itemRight,children:L(T,z)});return(0,t.jsx)("div",{className:(0,s.cx)(N.rightWrapper,W),children:(0,t.jsx)(u.B,{items:R,renderItem:V,getItemKey:K})})}case"bottom":default:{const V=R.filter(w=>w.yAxis===1),T=R.filter(w=>w.yAxis!==1),z=(w,H)=>(0,t.jsx)("span",{className:N.itemBottom,children:L(w,H)});return(0,t.jsxs)("div",{className:(0,s.cx)(N.bottomWrapper,W),children:[V.length>0&&(0,t.jsx)("div",{className:N.section,children:(0,t.jsx)(d.c,{items:V,renderItem:z,getItemKey:K})}),T.length>0&&(0,t.jsx)("div",{className:(0,s.cx)(N.section,N.sectionRight),children:(0,t.jsx)(d.c,{items:T,renderItem:z,getItemKey:K})})]})}}};o.displayName="VizLegendList";const E=R=>{const L=(0,s.css)({paddingRight:"10px",display:"flex",fontSize:R.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:L,itemRight:(0,s.cx)(L,(0,s.css)({marginBottom:R.spacing(.5)})),rightWrapper:(0,s.css)({padding:R.spacing(.5)}),bottomWrapper:(0,s.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",padding:R.spacing(.5),gap:"15px 25px"}),section:(0,s.css)({display:"flex"}),sectionRight:(0,s.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var m=e(79784),f=e(59141),p=e(94963),h=e(70462),D=e(50516);const C=({item:R,onLabelClick:L,onLabelMouseOver:B,onLabelMouseOut:F,className:I,readonly:U})=>{const W=(0,c.of)(l),A=(0,n.useCallback)(V=>{B&&B(R,V)},[R,B]),N=(0,n.useCallback)(V=>{F&&F(R,V)},[R,F]),K=(0,n.useCallback)(V=>{L&&L(R,V)},[R,L]);return(0,t.jsxs)("tr",{className:(0,s.cx)(W.row,I),children:[(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:W.itemWrapper,children:[(0,t.jsx)(D.R,{color:R.color,seriesName:R.fieldName??R.label,readonly:U,lineStyle:R.lineStyle}),(0,t.jsxs)("button",{disabled:U,type:"button",title:R.label,onBlur:N,onFocus:A,onMouseOver:A,onMouseOut:N,onClick:U?void 0:K,className:(0,s.cx)(W.label,R.disabled&&W.labelDisabled),children:[R.label," ",R.yAxis===2&&(0,t.jsx)("span",{className:W.yAxisLabel,children:(0,t.jsx)(h.x,{i18nKey:"grafana-ui.viz-legend.right-axis-indicator",children:"(right y-axis)"})})]})]})}),R.getDisplayValues&&R.getDisplayValues().map((V,T)=>(0,t.jsx)("td",{className:W.value,children:(0,f.cN)(V)},`${V.title}-${T}`))]})};C.displayName="LegendTableItem";const l=R=>{const L=p.hoverColor(R.colors.background.primary,R);return{row:(0,s.css)({label:"LegendRow",fontSize:R.v1.typography.size.sm,borderBottom:`1px solid ${R.colors.border.weak}`,td:{padding:R.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:L}}),label:(0,s.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,s.css)({label:"LegendLabelDisabled",color:R.colors.text.disabled}),itemWrapper:(0,s.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,s.css)({textAlign:"right"}),yAxisLabel:(0,s.css)({color:R.colors.text.secondary})}},v="Name",y=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,P=({items:R,sortBy:L,sortDesc:B,itemRenderer:F,className:I,onToggleSort:U,onLabelClick:W,onLabelMouseOver:A,onLabelMouseOut:N,readonly:K,isSortable:V})=>{const T=(0,c.of)(b),z={};V&&(z[v]="");for(const w of R)if(w.getDisplayValues)for(const H of w.getDisplayValues())z[H.title??"?"]=H.description??"";if(L!=null){let w=new Map;R.forEach(G=>{if(L!==v&&G.getDisplayValues){const X=G.getDisplayValues().find(_=>_.title===L),k=X==null||Number.isNaN(X.numeric)?-1/0:X.numeric;w.set(G,k)}});let H=B?-1:1;L===v?R.sort((G,X)=>H*y(G.label,X.label)):R.sort((G,X)=>{const k=w.get(G)??0,_=w.get(X)??0;return H*(k-_)})}return F||(F=(w,H)=>(0,t.jsx)(C,{item:w,onLabelClick:W,onLabelMouseOver:A,onLabelMouseOut:N,readonly:K},`${w.label}-${H}`)),(0,t.jsxs)("table",{className:(0,s.cx)(T.table,I),children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[!V&&(0,t.jsx)("th",{}),Object.keys(z).map(w=>(0,t.jsxs)("th",{title:z[w],className:(0,s.cx)(T.header,U&&T.headerSortable,V&&T.nameHeader,{[T.withIcon]:L===w}),onClick:()=>{U&&U(w)},children:[w,L===w&&(0,t.jsx)(m.I,{size:"xs",name:B?"angle-down":"angle-up"})]},w))]})}),(0,t.jsx)("tbody",{children:R.map(F)})]})},b=R=>({table:(0,s.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${R.colors.border.weak}`}}),header:(0,s.css)({color:R.colors.primary.text,fontWeight:R.typography.fontWeightMedium,borderBottom:`1px solid ${R.colors.border.weak}`,padding:R.spacing(.25,1,.25,1),fontSize:R.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,s.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,s.css)({paddingRight:"4px"}),headerSortable:(0,s.css)({cursor:"pointer"})});var S=e(58001),M=e(9733);function O({items:R,thresholdItems:L,mappingItems:B,displayMode:F,sortBy:I,seriesVisibilityChangeBehavior:U=S.K.Isolate,sortDesc:W,onLabelClick:A,onToggleSort:N,placement:K,className:V,itemRenderer:T,readonly:z,isSortable:w}){const{eventBus:H,onToggleSeriesVisibility:G,onToggleLegendSort:X}=(0,i.d2)(),k=(0,n.useCallback)((Z,te)=>{H?.publish({type:r.b_.type,payload:{raw:te,x:0,y:0,dataId:Z.label}})},[H]),_=(0,n.useCallback)((Z,te)=>{H?.publish({type:r.ql.type,payload:{raw:te,x:0,y:0,dataId:Z.label}})},[H]),ee=(0,n.useCallback)((Z,te)=>{A&&A(Z,te),G&&G(Z.fieldName??Z.label,U===S.K.Hide?x.B.AppendToSelection:(0,M.W)(te))},[G,A,U]),J=(0,n.useCallback)(Z=>(0,t.jsx)(o,{className:V,placement:K,onLabelMouseOver:k,onLabelMouseOut:_,onLabelClick:ee,itemRenderer:T,readonly:z,items:Z}),[V,K,k,_,ee,T,z]);switch(F){case a.lm.Table:return(0,t.jsx)(P,{className:V,items:R,placement:K,sortBy:I,sortDesc:W,onLabelClick:ee,onToggleSort:N||X,onLabelMouseOver:k,onLabelMouseOut:_,itemRenderer:T,readonly:z,isSortable:w});case a.lm.List:const Z=L&&L.length>1,te=B&&B.length>0;return(0,t.jsxs)(t.Fragment,{children:[!Z&&(!te||R.length>1)&&J(R),Z&&J(L),te&&J(B)]});default:return null}}O.displayName="VizLegend"},83333:(q,j,e)=>{"use strict";e.d(j,{M:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(50516),s=e(2543),c=e(59141),d=e(94653);const u=({stats:m})=>{const f=(0,i.of)(g);return m.length===0?null:(0,t.jsx)(d.c,{className:f.list,items:m,renderItem:p=>(0,t.jsxs)("div",{className:f.item,title:p.description,children:[p.title&&`${(0,s.capitalize)(p.title)}:`," ",(0,c.cN)(p)]})})},g=()=>({list:(0,n.css)({flexGrow:1,textAlign:"right"}),item:(0,n.css)({marginLeft:"8px"})});u.displayName="VizLegendStatsList";const o=({item:m,onLabelClick:f,onLabelMouseOver:p,onLabelMouseOut:h,className:D,readonly:C})=>{const l=(0,i.of)(E),v=(0,r.useCallback)(b=>{p&&p(m,b)},[m,p]),y=(0,r.useCallback)(b=>{h&&h(m,b)},[m,h]),P=(0,r.useCallback)(b=>{f&&f(m,b)},[m,f]);return(0,t.jsxs)("div",{className:(0,n.cx)(l.itemWrapper,m.disabled&&l.itemDisabled,D),"data-testid":a.Tp.components.VizLegend.seriesName(m.label),children:[(0,t.jsx)(x.R,{seriesName:m.fieldName??m.label,color:m.color,gradient:m.gradient,readonly:C,lineStyle:m.lineStyle}),(0,t.jsx)("button",{disabled:C,type:"button",onBlur:y,onFocus:v,onMouseOver:v,onMouseOut:y,onClick:P,className:l.label,children:m.label}),m.getDisplayValues&&(0,t.jsx)(u,{stats:m.getDisplayValues()})]})};o.displayName="VizLegendListItem";const E=m=>({label:(0,n.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,n.css)({label:"LegendLabelDisabled",color:m.colors.text.disabled}),itemWrapper:(0,n.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,n.css)({textAlign:"right"}),yAxisLabel:(0,n.css)({color:m.v1.palette.gray2})})},50516:(q,j,e)=>{"use strict";e.d(j,{R:()=>x});var t=e(74848),n=e(96540),r=e(57836),a=e(90415),i=e(61834);const x=(0,n.memo)(({seriesName:s,color:c,gradient:d,readonly:u,lineStyle:g})=>{const{onSeriesColorChange:o}=(0,a.d2)(),E=(0,n.useCallback)(m=>o(s,m),[s,o]);return s&&o&&c&&!u?(0,t.jsx)(r.Dp,{color:c,onChange:E,enableNamedColors:!0,children:({ref:m,showColorPicker:f,hideColorPicker:p})=>(0,t.jsx)(i.p,{color:c,className:"pointer",ref:m,onClick:f,onMouseLeave:p,lineStyle:g})}):(0,t.jsx)(i.p,{color:c,gradient:d,lineStyle:g})});x.displayName="VizLegendSeriesIcon"},58001:(q,j,e)=>{"use strict";e.d(j,{K:()=>t});var t=(n=>(n[n.Isolate=0]="Isolate",n[n.Hide=1]="Hide",n))(t||{})},9733:(q,j,e)=>{"use strict";e.d(j,{W:()=>n});var t=e(25205);function n(r){return r.ctrlKey||r.metaKey||r.shiftKey?t.B.AppendToSelection:t.B.ToggleSelection}},53633:(q,j,e)=>{"use strict";e.d(j,{S:()=>s});var t=e(74848),n=e(2543),r=e(96540),a=e(21288);const i=(d,u,g,o)=>{const E=x(d,u,o),m=x(u,d,o),f=Math.max(E,m);let p=Math.floor(d/f),h=Math.ceil(o/p);p=Math.ceil(o/h);const D=p-(p*h-o),C=d/D-g+g/D;return{width:d/p-g+g/p,height:u/h-g+g/h,widthOnLastRow:C,xCount:p,yCount:h}};function x(d,u,g){const o=Math.ceil(Math.sqrt(g*d/u));return Math.floor(o*u/d)*o<g?u/Math.ceil(o*u/d):d/o}class s extends r.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(u){super(u),this.state={values:u.getValues()}}componentDidUpdate(u){const{renderCounter:g,source:o}=this.props;(g!==u.renderCounter||o!==u.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:u,width:g,height:o}=this.props;return u===a.wV.Auto?g>o?a.wV.Vertical:a.wV.Horizontal:u}renderGrid(){const{renderValue:u,height:g,width:o,itemSpacing:E,getAlignmentFactors:m,orientation:f}=this.props,{values:p}=this.state,h=i(o,g,E,p.length),D=m?m(p,h.width,h.height):{};let C=0,l=0,v=[];for(let y=0;y<p.length;y++){const P=p[y],S=l===h.yCount-1?h.widthOnLastRow:h.width,M=h.height,O=C*S+E*C,R=l*M+E*l,L={position:"absolute",left:O,top:R,width:`${S}px`,height:`${M}px`};v.push((0,t.jsx)("div",{style:L,children:u({value:P,width:S,height:M,alignmentFactors:D,orientation:f,count:p.length})},y)),C++,C===h.xCount&&(C=0,l++)}return(0,t.jsx)("div",{style:{position:"relative"},children:v})}render(){const{renderValue:u,height:g,width:o,itemSpacing:E,getAlignmentFactors:m,autoGrid:f,orientation:p,maxVizHeight:h,minVizWidth:D,minVizHeight:C}=this.props,{values:l}=this.state;if(f&&p===a.wV.Auto)return this.renderGrid();const v={display:"flex"},y={display:"flex",overflow:`${D?"auto":"hidden"} ${C?"auto":"hidden"}`};let P=g,b=o;const S=this.getOrientation();switch(S){case a.wV.Horizontal:const O=(g+E)/l.length-E;y.flexDirection="column",y.height=`${g}px`,y.overflowX="hidden",y.scrollbarWidth="thin",v.marginBottom=`${E}px`,b=o,P=(0,n.clamp)(O,C??0,h??O);break;case a.wV.Vertical:y.flexDirection="row",y.justifyContent="space-between",y.overflowY="hidden",v.marginRight=`${E}px`,P=g,b=Math.max(o/l.length-E+E/l.length,D??0)}v.width=`${b}px`,v.height=`${P}px`;const M=m?m(l,b,P):{};return(0,t.jsx)("div",{style:y,children:l.map((O,R)=>(0,t.jsx)("div",{style:c(v,R,l.length),children:u({value:O,width:b,height:P,alignmentFactors:M,orientation:S,count:l.length})},R))})}}function c(d,u,g){return u===g-1?{...d,marginRight:0,marginBottom:0}:d}},31925:(q,j,e)=>{"use strict";e.d(j,{g:()=>x,o:()=>s});var t=e(74848),n=e(22803),r=e(29675),a=e(61834);const i=c=>({icon:(0,n.css)({marginRight:c.spacing(1),verticalAlign:"middle"}),seriesTable:(0,n.css)({display:"table"}),seriesTableRow:(0,n.css)({display:"table-row",fontSize:c.typography.bodySmall.fontSize}),seriesTableCell:(0,n.css)({display:"table-cell"}),label:(0,n.css)({wordBreak:"break-all"}),value:(0,n.css)({paddingLeft:c.spacing(2),textAlign:"right"}),activeSeries:(0,n.css)({fontWeight:c.typography.fontWeightBold,color:c.colors.text.maxContrast}),timestamp:(0,n.css)({fontWeight:c.typography.fontWeightBold,fontSize:c.typography.bodySmall.fontSize})}),x=({color:c,label:d,value:u,isActive:g})=>{const o=(0,r.of)(i);return(0,t.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,n.cx)(o.seriesTableRow,g&&o.activeSeries),children:[c&&(0,t.jsx)("div",{className:o.seriesTableCell,children:(0,t.jsx)(a.p,{color:c,className:o.icon})}),d&&(0,t.jsx)("div",{className:(0,n.cx)(o.seriesTableCell,o.label),children:d}),u&&(0,t.jsx)("div",{className:(0,n.cx)(o.seriesTableCell,o.value),children:u})]})},s=({timestamp:c,series:d})=>{const u=(0,r.of)(i);return(0,t.jsxs)(t.Fragment,{children:[c&&(0,t.jsx)("div",{className:u.timestamp,"aria-label":"Timestamp",children:c}),d.map((g,o)=>(0,t.jsx)(x,{isActive:g.isActive,label:g.label,color:g.color,value:g.value},`${g.label}-${o}`))]})}},31765:(q,j,e)=>{"use strict";e.d(j,{o:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(52908),i=e(29675),x=e(94963),s=e(37813);const c=({position:{x:u,y:g},offset:{x:o,y:E},children:m,allowPointerEvents:f=!1,className:p,...h})=>{const D=(0,r.useRef)(null),[C,l]=(0,r.useState)({width:0,height:0}),{width:v,height:y}=(0,a.A)(),[P,b]=(0,r.useState)({x:u+o,y:g+E}),S=(0,r.useMemo)(()=>new ResizeObserver(O=>{for(let R of O){const L=Math.floor(R.contentRect.width+16),B=Math.floor(R.contentRect.height+2*8);(C.width!==L||C.height!==B)&&l({width:Math.min(L,v),height:Math.min(B,y)})}}),[C,v,y]);(0,r.useLayoutEffect)(()=>(D.current&&S.observe(D.current),()=>{S.disconnect()}),[S]),(0,r.useLayoutEffect)(()=>{if(D&&D.current){const{x:O,y:R}=(0,s.Ju)(u,g,C.width,C.height,o,E,v,y);b({x:O,y:R})}},[v,y,u,o,g,E,C]);const M=(0,i.of)(d);return(0,t.jsx)("div",{ref:D,style:{position:"fixed",left:0,pointerEvents:f?"auto":"none",top:0,transform:`translate(${P.x}px, ${P.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...h,className:(0,n.cx)(M.wrapper,p),children:m})};c.displayName="VizTooltipContainer";const d=u=>({wrapper:(0,n.css)((0,x.getTooltipContainerStyles)(u))})},85217:(q,j,e)=>{"use strict";e.d(j,{Ev:()=>r,fX:()=>t,lJ:()=>n});var t=(a=>(a.series="series",a.value="value",a.hexagon="hexagon",a.pie_1_4="pie_1_4",a.pie_2_4="pie_2_4",a.pie_3_4="pie_3_4",a.marker_sm="marker_sm",a.marker_md="marker_md",a.marker_lg="marker_lg",a))(t||{}),n=(a=>(a.hidden="hidden",a.first="first",a.leading="leading",a.trailing="trailing",a))(n||{});const r="series"},37813:(q,j,e)=>{"use strict";e.d(j,{Ju:()=>s,L$:()=>c,cp:()=>o});var t=e(63739),n=e(18752),r=e(59141),a=e(62931),i=e(7500),x=e(85217);const s=(E=0,m=0,f=0,p=0,h=0,D=0,C=0,l=0)=>{let v=E,y=m;const P=Math.max(E+h+f-(C-h),0),b=Math.abs(Math.min(E-h-f-h,0)),S=P>0,M=b>0,O=Math.max(m+D+p-(l-D),0),R=Math.abs(Math.min(m-D-p-D,0)),L=O>0,B=R>0;return S&&M?v=P>b?h:C-h-f:S?v=E-h-f:v=E+h,L&&B?y=O>R?D:l-D-p:L?y=m-D-p:y=m+D,{x:v,y}},c=(E,m)=>{switch(E){case x.fX.value:return m.value;case x.fX.hexagon:return m.hexagon;case x.fX.pie_1_4:return m.pie_1_4;case x.fX.pie_2_4:return m.pie_2_4;case x.fX.pie_3_4:return m.pie_3_4;case x.fX.marker_sm:return m.marker_sm;case x.fX.marker_md:return m.marker_md;case x.fX.marker_lg:return m.marker_lg;default:return m.value}},d=(E,m)=>E.numeric-m.numeric,u=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),g=(E,m)=>u.compare(`${E.value}`,`${m.value}`),o=(E,m,f,p,h,D,C=v=>!0,l=!1)=>{let v=[],y=!0;for(let P=0;P<E.length;P++){const b=E[P];if(b===m||b.type===t.PU.time||!C(b)||b.config.custom?.hideFrom?.tooltip||b.config.custom?.hideFrom?.viz||h===i.$N.Single&&p!==P)continue;let S=f[P];if(S==null)continue;b.type===t.PU.number||b.type===t.PU.boolean||b.type===t.PU.enum||(y=!1);const M=E[P].values[S];if(M==null&&b.config.noValue==null||l&&M===0)continue;const O=b.display(M),R=Number.isNaN(O.numeric)?D===i.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:O.numeric,L=(0,n.Qi)(b);let B=x.fX.series,F=x.lJ.first;L.isByValue&&(B=x.fX.value,F=x.lJ.trailing),v.push({label:b.state?.displayName??b.name,value:(0,r.cN)(O),color:O.color??a.F,colorIndicator:B,colorPlacement:F,isActive:h===i.$N.Multi&&p===P,numeric:R,lineStyle:b.config.custom?.lineStyle})}if(D!==i.xB.None&&v.length>1){const P=y?d:g,b=D===i.xB.Descending?-1:1;v.sort((S,M)=>b*P(S,M))}return v}},40947:(q,j,e)=>{"use strict";e.d(j,{FcD:()=>Cn.F,ibS:()=>Rs,Ivu:()=>er.Iv,DWK:()=>er.DW,gZN:()=>er.gZ,p0K:()=>ze,Dd_:()=>Vo.D,euF:()=>cr.e,Exy:()=>ji.E,xEy:()=>Qt.xE,eX$:()=>bs.eX,yVm:()=>zn.yV,ypG:()=>zn.yp,$p8:()=>zn.$p,F8C:()=>zn.F8,SV3:()=>zn.SV,azJ:()=>Oo.a,jQM:()=>ei.J,$nd:()=>ae.$n,HRi:()=>ce,e2v:()=>hi.e,fHW:()=>Qo.f,cbd:()=>Kt.c,ZpM:()=>Go.Z,Q_j:()=>Ki.Q,vxQ:()=>Z.v,KmA:()=>pt.K,Sc0:()=>ro.S,NqN:()=>Se.N,bLJ:()=>J.b,BYM:()=>xn.B,q0m:()=>jn.q,MU_:()=>ms.M,SDm:()=>ts.S,skP:()=>me.sk,itl:()=>we,G3_:()=>ir.G,ZFl:()=>z.Z,uoB:()=>vn.u,mcf:()=>co.mc,tzH:()=>Zt.t,a2C:()=>ts.a,phK:()=>nn.p,Pli:()=>Ha.P,EZm:()=>_.E,Rsn:()=>us.R,lZ_:()=>cs.l,ebG:()=>vs.e,eHD:()=>Hn.e,Jb3:()=>Qn.J,tco:()=>sa.t,lrV:()=>ge.l,lS2:()=>xe.l,K7n:()=>je.K,etH:()=>w.e,cGx:()=>Jo.c,_s:()=>_s._,msM:()=>ko.m,_V2:()=>Sl._,Z7I:()=>Te.Z,ppr:()=>Le.p,tHk:()=>na.tH,XwR:()=>na.Xw,DaU:()=>Zs.D,Kur:()=>ar.K,aaz:()=>Hi.a,sN5:()=>po.s,AVJ:()=>hn.A,yKR:()=>As.y,ep7:()=>Ys,D0$:()=>Je.D,ED_:()=>da,nA8:()=>Yt,nVY:()=>Ao.n,PgM:()=>Ro.P,gHy:()=>uo.gH,wIj:()=>uo.wI,IBq:()=>Ho.I,ef9:()=>Wi,ZYI:()=>$o.Z,mKT:()=>un.m,lVW:()=>ui.l,i7I:()=>$r.i,Vpd:()=>ct,_I2:()=>zt._,TS0:()=>qa,Hdp:()=>mo.H,io8:()=>mo.i,ovZ:()=>At,MTY:()=>Un,IK5:()=>Dr,xA9:()=>Io.x,GyY:()=>co.Gy,Int:()=>i.I,K0:()=>T.K,w4Q:()=>Vs.w,IP5:()=>fa.I,CeB:()=>xi.C,IjS:()=>Vi.I,c2B:()=>yi.c,e8d:()=>vi.e,KYK:()=>Ma.K,r0T:()=>he.r,pde:()=>Ea.p,eyo:()=>Br.e,jDF:()=>ke.j,BJ$:()=>Da.B,OoN:()=>Sa.O,Z7z:()=>vr.Z,JU7:()=>Ua.J,rRI:()=>Ml,OYG:()=>n.O,s$2:()=>Fr.s,N_E:()=>mi.N,z9$:()=>ae.z9,B8B:()=>Ve.B,GmG:()=>de.G,_ae:()=>oe._,pH9:()=>go.p,W1t:()=>tn.W,rXV:()=>En.r,Drp:()=>Ln.D,aFV:()=>Ot.a,rQ0:()=>Rt.r,EOs:()=>Pt.EO,OHP:()=>dt,JXd:()=>Ye.J,wEe:()=>Pt.wE,$sz:()=>Pt.$s,YO7:()=>Pt.YO,fpH:()=>lr,KFt:()=>er.KF,dAS:()=>Bt.d,dKS:()=>ht.d,NRL:()=>Et.NR,oQQ:()=>Ut.I,_wj:()=>_i._,XFg:()=>Wt.XF,e4W:()=>Wt.e4,$sV:()=>fo.$,Bjr:()=>wi.B,AMh:()=>G.A,IE3:()=>H.I,ZLI:()=>k.ZL,qB2:()=>k.qB,Xjo:()=>pn.X,JBW:()=>nr.J,zWQ:()=>mr.z,a0s:()=>wo.a,F16:()=>To.F,m3b:()=>cn.m,cCp:()=>De.cC,NBP:()=>Fi.N,IUm:()=>Yn.I,L47:()=>bs.L4,PaW:()=>h.P,L44:()=>Vr.L4,lpq:()=>Bi.lp,YAX:()=>xa.Y,Y4n:()=>Wn.Y,sYD:()=>Jn.s,oyW:()=>fs.o,Lrm:()=>Cs.L,a$h:()=>qn.a,l6P:()=>er.l6,KAb:()=>er.KA,o5c:()=>Ei.o5,Dpi:()=>me.Dp,o0L:()=>Fe.o,tJM:()=>Fe.t,pMY:()=>hs.p,o95:()=>Ct.o,gNl:()=>Ct.g,KHN:()=>Vt.K,Bd:()=>yr.B,u3P:()=>Jt.u,nfS:()=>Sn.n,Apm:()=>Wa,$xS:()=>Wr.$,OW$:()=>St.O,y$y:()=>Xt.y,BJc:()=>Nr.B,SPA:()=>Me.S,dOG:()=>Ma.d,jDu:()=>fr.j,ozo:()=>Lt.o,JSC:()=>In.J,qtX:()=>ee.q,XIK:()=>qt.X,sRj:()=>gn.s,Btl:()=>gn.B,bwN:()=>ps,U05:()=>ls.U,vwO:()=>It.v,LYX:()=>Gt.L,um3:()=>Oe.u,EYj:()=>Mo.E,fs1:()=>Tn.f,YqK:()=>So.Y,R3l:()=>ie.R,xSz:()=>Ke.xS,bYj:()=>_o.b,fD2:()=>Ne.f,$64:()=>Ke.$6,AjF:()=>Ie.A,ZOC:()=>ga,U7r:()=>ve.U,XNj:()=>Di.X,Gff:()=>X.G,IBt:()=>fi.I,Uhs:()=>gi.U,m_M:()=>l.m,TkQ:()=>Dl,xlH:()=>zr.xl,piP:()=>Ra.pi,ZCE:()=>Zo.Z,eEE:()=>Xo.e,pKo:()=>Ge.p,nys:()=>Za.n,qeh:()=>ho,iyp:()=>Ur.i,gWJ:()=>co.gW,sMJ:()=>on,ipx:()=>er.ip,KUk:()=>gt.KU,tZ2:()=>Ft.t,MJh:()=>dn.M,SdN:()=>ut.S,nRt:()=>mn,oNG:()=>an.o,l69:()=>fe.l,nuT:()=>Gn.n,_XZ:()=>qo._,jnT:()=>Ca,Myc:()=>pe,myI:()=>ae.my,I1_:()=>vt.I1,cbf:()=>De.cb,gso:()=>pi.g,Hut:()=>Go.H,lBN:()=>$i.l,na7:()=>Ea.n,gF8:()=>k.gF,Jq4:()=>Pi.J,rLY:()=>fe.r,ti9:()=>zi.t,YnM:()=>yo,JcZ:()=>Hr,mYT:()=>Ae,aLN:()=>C.A,Xb:()=>jr.Xb,_$q:()=>vt._$,glJ:()=>vt.gl,yff:()=>Sl.y,IyU:()=>aa,d2s:()=>Wt.d2,hrX:()=>sr.h,OOt:()=>_n.O,Xc0:()=>na.Xc});var t=e(65360),n=e(92732),r=e(74848),a=e(15777),i=e(79784);const x=qe=>{const mt=qe.selectProps.menuIsOpen;return(0,r.jsx)(a.c.IndicatorsContainer,{...qe,children:(0,r.jsx)(i.I,{name:mt?"angle-up":"angle-down",style:{marginTop:"7px"}})})},s=x,c=qe=>{const{children:mt}=qe;return(0,r.jsx)(a.c.NoOptionsMessage,{...qe,children:(0,r.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,r.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:mt})})})},d=c;var u=e(46942),g=e.n(u),o=e(96540),E=e(46005),m=e(8539),f=e(66963),p=e(15580),h=e(99134),D=e(140),C=e(81681),l=e(6736);const v=qe=>{const{children:mt,isSelected:bt,data:Ht}=qe;return(0,r.jsx)(a.c.Option,{...qe,children:(0,r.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[Ht.imgUrl&&(0,r.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:Ht.imgUrl,alt:""}),(0,r.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,r.jsx)("div",{children:mt}),Ht.description&&(0,r.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:Ht.description})]}),bt&&(0,r.jsx)(i.I,{name:"check","aria-hidden":"true"})]})})},y=null;var P=e(22803),b=e(90617),S=e(29675);const M=(0,b.N)(qe=>({header:(0,P.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${qe.colors.background.secondary}`,"&:hover":{color:qe.colors.text.maxContrast}}),label:(0,P.css)({flexGrow:1}),icon:(0,P.css)({paddingRight:"2px"})}));class O extends o.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(mt=>({expanded:!mt.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:mt}=this.props.selectProps.value;mt&&this.props.options.some(bt=>bt.value===mt)&&this.setState({expanded:!0})}}componentDidUpdate(mt){mt.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:mt,label:bt,theme:Ht}=this.props,{expanded:kt}=this.state,jt=M(Ht);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:jt.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,r.jsx)("span",{className:jt.label,children:bt}),(0,r.jsx)(i.I,{className:jt.icon,name:kt?"angle-up":"angle-down"})]}),kt&&mt]})}}const R=(0,S.cV)(O),L=qe=>(0,r.jsx)(a.c.MenuList,{...qe,children:(0,r.jsx)(h.P,{showScrollIndicators:!0,overflowX:"hidden",maxHeight:"inherit",children:qe.children})});class B extends o.PureComponent{static{this.contextType=p.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:v,SingleValue:D.K,IndicatorsContainer:s,MenuList:L,Group:R}}}render(){const{defaultValue:mt,getOptionLabel:bt,getOptionValue:Ht,onChange:kt,options:jt,placeholder:fn,width:ln,value:Mn,className:Pn,isDisabled:Fn,isLoading:Xn,isSearchable:Kn,isClearable:Zn,backspaceRemovesValue:Ds,isMulti:Ts,autoFocus:gs,openMenuOnFocus:Fs,onBlur:Ss,maxMenuHeight:js,noOptionsMessage:Es,isOpen:Ms,components:ds,tooltipContent:Vn,tabSelectsValue:Os,onCloseMenu:ns,onOpenMenu:Bs,allowCustomValue:Ns,formatCreateLabel:Ws,"aria-label":Is}=this.props;let Gs="";ln&&(Gs="width-"+ln);let ea=E.Ay;const ba={};Ns&&(ea=f.A,ba.formatCreateLabel=Ws??(Ka=>Ka));const Oa=g()("gf-form-input","gf-form-input--form-dropdown",Gs,Pn),pa={...B.defaultProps.components,...ds};return(0,r.jsx)(I,{onCloseMenu:ns,onOpenMenu:Bs,tooltipContent:Vn,isOpen:Ms,children:(Ka,Qr)=>(0,r.jsx)(ea,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Oa,components:pa,defaultValue:mt,value:Mn,getOptionLabel:bt,getOptionValue:Ht,menuShouldScrollIntoView:!1,isSearchable:Kn,onChange:kt,options:jt,placeholder:fn||"Choose",styles:(0,C.A)(this.context),isDisabled:Fn,isLoading:Xn,isClearable:Zn,autoFocus:gs,onBlur:Ss,openMenuOnFocus:Fs,maxMenuHeight:js,noOptionsMessage:Es,isMulti:Ts,backspaceRemovesValue:Ds,menuIsOpen:Ms,onMenuOpen:Ka,onMenuClose:Qr,tabSelectsValue:Os,"aria-label":Is,...ba})})}}class F extends o.PureComponent{static{this.contextType=p.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:mt,getOptionLabel:bt,getOptionValue:Ht,onChange:kt,placeholder:jt,width:fn,value:ln,className:Mn,loadOptions:Pn,defaultOptions:Fn,isLoading:Xn,loadingMessage:Kn,noOptionsMessage:Zn,isDisabled:Ds,isSearchable:Ts,isClearable:gs,backspaceRemovesValue:Fs,autoFocus:Ss,onBlur:js,openMenuOnFocus:Es,maxMenuHeight:Ms,isMulti:ds,tooltipContent:Vn,onCloseMenu:Os,onOpenMenu:ns,isOpen:Bs}=this.props;let Ns="";fn&&(Ns="width-"+fn);const Ws=g()("gf-form-input","gf-form-input--form-dropdown",Ns,Mn);return(0,r.jsx)(I,{onCloseMenu:Os,onOpenMenu:ns,tooltipContent:Vn,isOpen:Bs,children:(Is,Gs)=>(0,r.jsx)(m.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Ws,components:{Option:v,SingleValue:D.K,IndicatorsContainer:s,NoOptionsMessage:d},defaultValue:mt,value:ln,getOptionLabel:bt,getOptionValue:Ht,menuShouldScrollIntoView:!1,onChange:kt,loadOptions:Pn,isLoading:Xn,defaultOptions:Fn,placeholder:jt||"Choose",styles:(0,C.A)(this.context),loadingMessage:Kn,noOptionsMessage:Zn,isDisabled:Ds,isSearchable:Ts,isClearable:gs,autoFocus:Ss,onBlur:js,openMenuOnFocus:Es,maxMenuHeight:Ms,isMulti:ds,backspaceRemovesValue:Fs})})}}class I extends o.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:mt}=this.props;mt&&mt(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:mt}=this.props;mt&&mt(),this.setState({isOpenInternal:!1})}}render(){const{children:mt,isOpen:bt,tooltipContent:Ht}=this.props,{isOpenInternal:kt}=this.state;let jt;return(kt||bt)&&(jt=!1),Ht?(0,r.jsx)(l.m,{show:jt,content:Ht,placement:"bottom",children:(0,r.jsx)("div",{children:mt(this.onOpenMenu,this.onCloseMenu)})}):(0,r.jsx)("div",{children:mt(this.onOpenMenu,this.onCloseMenu)})}}const U=null;var W=e(2543);class A extends o.PureComponent{constructor(){super(...arguments),this.state={id:(0,W.uniqueId)()},this.internalOnChange=mt=>{mt.stopPropagation(),this.props.onChange(mt)}}render(){const{labelClass:mt="",switchClass:bt="",label:Ht,checked:kt,disabled:jt,transparent:fn,className:ln,theme:Mn,tooltip:Pn,tooltipPlacement:Fn}=this.props,Xn=K(Mn),Kn=this.state.id,Zn=`gf-form-label ${mt} ${fn?"gf-form-label--transparent":""} pointer`,Ds=(0,P.cx)(Xn.switch,bt,{[Xn.switchTransparent]:fn});return(0,r.jsx)("div",{className:Xn.container,children:(0,r.jsxs)("label",{htmlFor:Kn,className:(0,P.cx)("gf-form",Xn.labelContainer,ln),children:[Ht&&(0,r.jsxs)("div",{className:Zn,children:[Ht,Pn&&(0,r.jsx)(l.m,{placement:Fn||"auto",content:Pn,theme:"info",children:(0,r.jsx)(i.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,r.jsxs)("div",{className:Ds,children:[(0,r.jsx)("input",{disabled:jt,id:Kn,type:"checkbox",checked:kt,onChange:this.internalOnChange}),(0,r.jsx)("span",{className:Xn.slider})]})]})})}}const N=(0,S.cV)(A),K=qe=>{const mt=(0,P.css)({background:qe.v1.palette.gray1,borderRadius:qe.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:qe.components.input.background,transition:"0.4s",borderRadius:qe.shape.radius.circle,boxShadow:qe.shadows.z1}});return{container:(0,P.css)({display:"flex",flexShrink:0}),labelContainer:(0,P.css)({display:"flex",cursor:"pointer",marginRight:qe.spacing(.5)}),switch:(0,P.css)({display:"flex",position:"relative",width:"56px",height:qe.spacing(4),background:qe.components.input.background,border:`1px solid ${qe.components.input.borderColor}`,borderRadius:qe.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${mt}`]:{background:qe.colors.primary.main},[`input:checked + .${mt}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,P.css)({background:"transparent",border:0,width:"40px"}),slider:mt}};var V=e(25476),T=e(99764),z=e(91396),w=e(87731),H=e(52706),G=e(95486),X=e(26676),k=e(75606),_=e(67893),ee=e(3567),J=e(93604),Z=e(530),te=e(80441),ae=e(54594),re=e(70348),ne=e(94632);const ce=qe=>{const{onChange:mt,className:bt,loadData:Ht,icon:kt,buttonProps:jt,hideDownIcon:fn,variant:ln,disabled:Mn,...Pn}=qe,Fn=(0,S.of)(le),Xn=(0,S.of)(ne.T);let Kn=qe.children;return fn||(Kn=[qe.children,(0,r.jsx)(i.I,{name:"angle-down",className:Fn.icons.right},"down-icon")]),(0,r.jsx)(te.A,{onChange:(0,re.k)(mt),loadData:(0,re.W)(Ht),dropdownClassName:(0,P.cx)(Xn.dropdown,Fn.popup),...Pn,expandIcon:null,children:(0,r.jsx)(ae.$n,{icon:kt,disabled:Mn,variant:ln,...jt??{},children:Kn})})};ce.displayName="ButtonCascader";const le=qe=>({popup:(0,P.css)({label:"popup",zIndex:qe.zIndex.dropdown}),icons:{right:(0,P.css)({margin:"1px 0 0 4px"}),left:(0,P.css)({margin:"-1px 4px 0 0"})}});var he=e(96260),oe=e(81876),de=e(37008),me=e(57836),Pe=e(7612),Ee=e(65229),be=e(87190),Se=e(77576),Xe=e(95108),Qe=e(54061);const we=(0,o.forwardRef)(({value:qe="",onChange:mt,returnColorAs:bt="rgb",...Ht},kt)=>{const[jt,fn]=(0,o.useState)(qe),[ln,Mn]=(0,o.useState)(!1),Pn=(0,S.$j)(),Fn=(0,S.of)($e),Xn=(0,S.of)(Qe.$);return(0,Ee.A)(Kn=>{if(Kn===qe)return;if(!Kn){mt("");return}const Zn=Pn.visualization.getColorByName(Kn);mt(bt==="rgb"?be.MV.asRgbString(Zn):be.MV.asHexString(Zn))},500,[jt]),(0,r.jsx)(Se.N,{onClick:()=>Mn(!1),children:(0,r.jsxs)("div",{className:Fn.wrapper,children:[ln&&!Ht.disabled&&(0,r.jsx)(Pe.p9,{"data-testid":"color-popover",color:jt,onChange:fn,className:(0,P.cx)(Xn.root,Fn.picker)}),(0,r.jsx)(Xe.A,{...Ht,theme:Pn,color:jt,onChange:fn,buttonAriaLabel:"Open color picker",onClick:()=>Mn(!0),onBlur:()=>Mn(!1),ref:kt,isClearable:!0})]})})});we.displayName="ColorPickerInput";const $e=qe=>({wrapper:(0,P.css)({position:"relative"}),picker:(0,P.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,P.css)({position:"absolute"})});var Fe=e(30446),Te=e(3844),Le=e(59830),Ge=e(69942),Me=e(54852),De=e(98140),Ke=e(78968),Ie=e(2041),Ne=e(64229),ie=e(21144),ve=e(14749),fe=e(45282),ge=e(34783),xe=e(45225),je=e(52961),Ve=e(79878),ke=e(14123),Oe=e(32319),nt=e(70462),Je=e(86489);const Be=(0,o.memo)(()=>{const qe=(0,S.of)(Ze);return(0,r.jsxs)("div",{className:qe.ellipsis,children:[(0,r.jsx)("span",{className:qe.firstDot,children:"."}),(0,r.jsx)("span",{className:qe.secondDot,children:"."}),(0,r.jsx)("span",{className:qe.thirdDot,children:"."})]})});Be.displayName="EllipsisAnimated";const Ze=qe=>({ellipsis:(0,P.css)({display:"inline"}),firstDot:(0,P.css)({[qe.transitions.handleMotion("no-preference","reduce")]:{animation:`${tt} 2s linear infinite`}}),secondDot:(0,P.css)({[qe.transitions.handleMotion("no-preference","reduce")]:{animation:`${Re} 2s linear infinite`}}),thirdDot:(0,P.css)({[qe.transitions.handleMotion("no-preference","reduce")]:{animation:`${at} 2s linear infinite`}})}),tt=(0,P.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Re=(0,P.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,at=(0,P.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,yt=2*1e3;function ze(qe){const{invalid:mt,loading:bt,onFinishChange:Ht,saveErrorMessage:kt="Error saving this value",error:jt,children:fn,disabled:ln,...Mn}=qe,[Pn,Fn]=o.useState({isLoading:!1,showSuccess:!1,showError:mt}),Xn=(0,o.useRef)(null);o.useEffect(()=>{let gs;if(Pn.showSuccess){const Fs=Pn.showError?0:yt;gs=setTimeout(()=>{Fn({...Pn,showSuccess:!1})},Fs)}return()=>{window.clearTimeout(gs)}},[Pn]);const Kn=(0,o.useCallback)(gs=>{mt||(Fn({...Pn,isLoading:!0,showSuccess:!1}),Ht(gs).then(()=>{Fn({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{Fn({...Pn,isLoading:!1,showError:!0})}))},[mt,Pn,Ht]),Zn=(0,o.useMemo)(()=>(0,W.debounce)(Kn,600,{leading:!1}),[Kn]),Ds=mt||Pn.showError||void 0,Ts=(0,S.of)(st);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Je.D,{...Mn,loading:bt||void 0,invalid:Ds,disabled:ln,error:jt||Pn.showError&&kt,ref:Xn,className:Ts.widthFitContent,children:o.cloneElement(fn(gs=>{Zn(gs)}))}),Pn.isLoading&&(0,r.jsx)(he.r,{referenceElement:Xn.current,placement:"right",children:(0,r.jsxs)(nt.x,{i18nKey:"grafana-ui.auto-save-field.saving",children:["Saving ",(0,r.jsx)(Be,{})]})}),Pn.showSuccess&&(0,r.jsx)(he.r,{suffixIcon:"check",referenceElement:Xn.current,placement:"right",children:(0,r.jsx)(nt.x,{i18nKey:"grafana-ui.auto-save-field.saved",children:"Saved!"})})]})}ze.displayName="AutoSaveField";const st=()=>({widthFitContent:(0,P.css)({width:"fit-content"})});var ht=e(16110),It=e(73903),Gt=e(95015),un=e(99076),vn=e(65164),pn=e(54874),xn=e(3886),cn=e(86618),jn=e(34566),_n=e(86266),Ot=e(25356),Rt=e(2107),Ye=e(37443);const dt=({children:qe})=>{const mt=(0,S.of)(lt);return(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:mt.header,children:(0,r.jsx)("div",{className:mt.content,children:qe})})})},lt=qe=>({header:(0,P.css)({display:"flex",margin:qe.spacing(0,0,3,0)}),content:(0,P.css)({flexGrow:1})});var Pt=e(43908),Bt=e(39645),Jt=e(83736),qt=e(32991),gn=e(77469),On=e(60590),Tn=e(50926);class wn extends o.PureComponent{constructor(mt){super(mt),this.readCSV=(0,W.debounce)(()=>{const{config:kt}=this.props,{text:jt}=this.state;this.setState({data:(0,On.Jh)(jt,{config:kt})})},150),this.onTextChange=kt=>{this.setState({text:kt.target.value})};const{text:bt,config:Ht}=mt;this.state={text:bt,data:(0,On.Jh)(bt,{config:Ht})}}componentDidUpdate(mt,bt){const{text:Ht}=this.state;(Ht!==bt.text||this.props.config!==mt.config)&&this.readCSV(),this.props.text!==mt.text&&this.props.text!==Ht&&this.setState({text:this.props.text}),this.state.data!==bt.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:mt,height:bt,theme:Ht}=this.props,{data:kt}=this.state,jt=es(Ht);return(0,r.jsxs)("div",{className:jt.tableInputCsv,children:[(0,r.jsx)(Tn.f,{style:{width:mt,height:bt},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:jt.textarea}),kt&&(0,r.jsx)("footer",{className:jt.footer,children:kt.map((fn,ln)=>{const Mn=fn.length,Pn=fn.fields.length;return(0,r.jsx)("span",{children:(0,r.jsxs)(nt.x,{i18nKey:"grafana-ui.table.csv-counts",children:["Rows:",{rows:Mn},", Columns:",{columns:Pn}," \xA0",(0,r.jsx)(i.I,{name:"check-circle"})]})},ln)})})]})}}const ps=(0,S.cV)(wn);ps.displayName="TableInputCSV";const es=(0,b.N)(qe=>({tableInputCsv:(0,P.css)({position:"relative"}),textarea:(0,P.css)({height:"100%",width:"100%"}),footer:(0,P.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:qe.colors.success.main,padding:`1px ${qe.spacing(.5)}`,fontSize:"80%"})}));var ls=e(10247),Lt=e(88849),$t=e(58779),nn=e(13676);const on=(0,o.forwardRef)(({label:qe,active:mt,icon:bt,counter:Ht,className:kt,suffix:jt,onChangeTab:fn,href:ln,...Mn},Pn)=>{const Fn=(0,S.of)(bn),Xn=()=>(0,r.jsxs)(r.Fragment,{children:[bt&&(0,r.jsx)(i.I,{name:bt}),qe,typeof Ht=="number"&&(0,r.jsx)(nn.p,{value:Ht}),jt&&(0,r.jsx)(jt,{className:Fn.suffix})]}),Kn=(0,P.cx)(Fn.link,mt&&Fn.activeStyle);return(0,r.jsx)("a",{href:ln,className:Kn,...Mn,onClick:fn,"aria-label":Mn["aria-label"]||$t.Tp.components.Tab.title(qe),role:"tab","aria-selected":mt,ref:Pn,children:Xn()})});on.displayName="Tab";const bn=qe=>({link:(0,P.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:qe.colors.text.primary,svg:{marginRight:qe.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,P.css)({label:"activeTabStyle",color:qe.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:qe.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,P.css)({marginLeft:qe.spacing(1)})});var In=e(11238),Yn=e(15600),zn=e(5958),St=e(392),zt=e(39841),Qt=e(22662),an=e(31765);const mn=({content:qe,position:mt,offset:bt})=>{const Ht=(0,S.of)(yn);return mt?(0,r.jsx)(k.ZL,{className:Ht.portal,children:(0,r.jsx)(an.o,{position:mt,offset:bt||{x:0,y:0},children:qe})}):null};mn.displayName="VizTooltip";const yn=()=>({portal:(0,P.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})});var Ct=e(31925),ut=e(53633),Et=e(96325),Ut=e(28065),Wt=e(90415),gt=e(85832),Vt=e(58001),Ft=e(43987),dn=e(83333),Cn=e(37e3);class Un extends o.Component{constructor(mt){super(mt),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:mt.series}}componentDidUpdate(mt){const{series:bt}=this.props;(0,W.isEqual)(mt.series,bt)||this.setState({hiddenSeries:[],toggledSeries:bt})}onSeriesToggle(mt,bt){const{series:Ht,onHiddenSeriesChanged:kt}=this.props,{hiddenSeries:jt}=this.state;if(bt.ctrlKey||bt.metaKey||bt.shiftKey){const Pn=jt.indexOf(mt)>-1?jt.filter(Xn=>Xn!==mt):jt.concat([mt]),Fn=Ht.map(Xn=>({...Xn,isVisible:Pn.indexOf(Xn.label)===-1}));this.setState({hiddenSeries:Pn,toggledSeries:Fn},()=>kt?kt(Pn):void 0);return}const fn=Ht.map(Pn=>Pn.label),ln=jt.length+1===fn.length?[]:(0,W.difference)(fn,[mt]),Mn=Ht.map(Pn=>({...Pn,isVisible:ln.indexOf(Pn.label)===-1}));this.setState({hiddenSeries:ln,toggledSeries:Mn},()=>kt?kt(ln):void 0)}render(){const{children:mt}=this.props,{toggledSeries:bt}=this.state;return mt({onSeriesToggle:this.onSeriesToggle,toggledSeries:bt})}}var ts=e(43192),ms=e(91036),us=e(21891);function Yt({links:qe}){const mt=(0,S.of)(ot);if(qe.length===1)return(0,r.jsx)(us.R,{link:qe[0]});const bt=qe.filter(kt=>kt.target==="_blank"),Ht=qe.filter(kt=>kt.target==="_self");return(0,r.jsxs)(r.Fragment,{children:[Ht.map((kt,jt)=>(0,r.jsx)(us.R,{link:kt},jt)),(0,r.jsxs)("div",{className:mt.wrapper,children:[(0,r.jsx)("p",{className:mt.externalLinksHeading,children:(0,r.jsx)(nt.x,{i18nKey:"grafana-ui.field-link-list.external-links-heading",children:"External links"})}),bt.map((kt,jt)=>(0,r.jsxs)("a",{href:kt.href,target:kt.target,className:mt.externalLink,children:[(0,r.jsx)(i.I,{name:"external-link-alt"}),kt.title]},jt))]})]})}const ot=qe=>({wrapper:(0,P.css)({flexBasis:"150px",width:"100px",marginTop:qe.spacing(1)}),externalLinksHeading:(0,P.css)({color:qe.colors.text.secondary,fontWeight:qe.typography.fontWeightRegular,fontSize:qe.typography.size.sm,margin:0}),externalLink:(0,P.css)({color:qe.colors.text.link,fontWeight:qe.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:qe.spacing(1)}})}),ct=({className:qe,children:mt})=>{const bt=(0,S.of)(ft);return(0,r.jsx)("div",{className:(0,P.cx)(bt,qe),children:mt})},ft=()=>(0,P.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}});var vt=e(37256),Kt=e(78464),Zt=e(41784),tn=e(19224),En=e(76795),Ln=e(36529),Gn=e(56016),Hn=e(99153),Qn=e(48205),cs=e(76174),vs=e(63006),hs=e(61834),Vs=e(85836),As=e(83508);const Ys=(0,o.memo)((0,o.forwardRef)(({title:qe,featureState:mt,...bt},Ht)=>{const kt=(0,S.of)(ha),jt=mt?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:kt.badge,children:(0,r.jsx)(As.y,{featureState:mt})}),(0,r.jsx)("h3",{children:qe})]}):(0,r.jsx)("h3",{children:qe});return(0,r.jsx)(Vs.w,{branded:!0,title:jt,urlTitle:"Read documentation",ref:Ht,...bt})}));Ys.displayName="FeatureInfoBox";const ha=qe=>({badge:(0,P.css)({marginBottom:qe.spacing(1)})});var Da=e(67676),Sa=e(16703),na=e(49816),Zs=e(32336),sa=e(98378),Ha=e(5790),Ma=e(29010),fa=e(60484);function Rs({options:qe,onOptionsChange:mt}){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"page-heading",children:(0,r.jsx)(nt.x,{i18nKey:"grafana-ui.data-source-settings.alerting-settings-heading",children:"Alerting"})}),(0,r.jsx)("div",{className:"gf-form-group",children:(0,r.jsx)("div",{className:"gf-form-inline",children:(0,r.jsx)("div",{className:"gf-form",children:(0,r.jsx)(fa.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:qe.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,r.jsx)(Ma.K,{value:qe.jsonData.manageAlerts!==!1,onChange:bt=>mt({...qe,jsonData:{...qe.jsonData,manageAlerts:bt.currentTarget.checked}})})})})})})]})}var xa=e(75863),fr=e(82330),pt=e(66265),Xt=e(20968),hn=e(66529),Sn=e(8798),Wn=e(67692),Jn=e(80762),fs=e(83278),qn=e(84900),Cs=e(94479),_s=e(58528),Ls=e(17437),$s=e(55168),Ea=e(34128),Ga=e(19331);const Wa=({min:qe,max:mt,onChange:bt,onAfterChange:Ht,orientation:kt="horizontal",reverse:jt,step:fn,value:ln,ariaLabelForHandle:Mn,marks:Pn,included:Fn})=>{const Xn=kt==="horizontal",Kn=(0,S.of)(Ga.$,Xn,!!Pn),Zn=$s.A,[Ds,Ts]=(0,o.useState)(ln??qe),gs=(0,o.useCallback)(ds=>{const Vn=typeof ds=="number"?ds:ds[0];Ts(Vn),bt?.(Vn)},[Ts,bt]),Fs=(0,o.useCallback)(ds=>{let Vn=+ds.target.value;Number.isNaN(Vn)&&(Vn=0),Ts(Vn),bt&&bt(Vn),Ht&&Ht(Vn)},[bt,Ht]),Ss=(0,o.useCallback)(ds=>{const Vn=+ds.target.value;Vn>mt?Ts(mt):Vn<qe&&Ts(qe)},[mt,qe]),js=(0,o.useCallback)(ds=>{const Vn=typeof ds=="number"?ds:ds[0];Ht?.(Vn)},[Ht]),Es=Xn?[]:[Kn.sliderInputVertical],Ms=Xn?[]:[Kn.sliderInputFieldVertical];return(0,r.jsxs)("div",{className:(0,P.cx)(Kn.container,Kn.slider),children:[(0,r.jsx)(Ls.Global,{styles:Kn.tooltip}),(0,r.jsxs)("div",{className:(0,P.cx)(Kn.sliderInput,...Es),children:[(0,r.jsx)(Zn,{min:qe,max:mt,step:fn,defaultValue:ln,value:Ds,onChange:gs,onChangeComplete:js,vertical:!Xn,reverse:jt,ariaLabelForHandle:Mn,marks:Pn,included:Fn}),(0,r.jsx)(Ea.p,{type:"text",width:7.5,className:(0,P.cx)(Kn.sliderInputField,...Ms),value:Ds,onChange:Fs,onBlur:Ss,min:qe,max:mt})]})]})};Wa.displayName="Slider";var To=e(83437),ui=e(80619),jr=e(89256),Br=e(23302),hi=e(90333),fi=e(52120),gi=e(48194),Ur=e(31952),pi=e(13286),mi=e(8270),So=e(54731),Mo=e(45565),Oo=e(90231),Nr=e(48583),Io=e(98349),Wr=e(9968),Ua=e(40271),Fr=e(99178),Ao=e(44617),Ro=e(64467),vi=e(54394),yi=e(76302),xi=e(77222),gr=e(49785);const da=({name:qe,control:mt,children:bt,...Ht})=>{const{fields:kt,append:jt,prepend:fn,remove:ln,swap:Mn,move:Pn,insert:Fn}=(0,gr.jz)({control:mt,name:qe,...Ht});return bt({fields:kt,append:jt,prepend:fn,remove:ln,swap:Mn,move:Pn,insert:Fn})};var er=e(44826),Ei=e(77299),Pi=e(74162),Di=e(59509),ir=e(51064),Ci=e(72181),Pa=e(76698),ro=e(81942),bi=e(47059),Kr=e(70694);const Lo=({label:qe,description:mt,id:bt,isGroup:Ht=!1})=>{const kt=(0,S.of)(Kr.C3);return(0,r.jsxs)("div",{className:kt.optionBody,"aria-disabled":Ht,children:[(0,r.jsx)("span",{className:(0,P.cx)(kt.optionLabel,{[kt.optionLabelGroup]:Ht}),id:bt,children:qe}),mt&&(0,r.jsx)("span",{className:kt.optionDescription,children:mt})]})},Ti=({isLoading:qe,isOpen:mt})=>{const bt=qe?"spinner":mt?"search":"angle-down";return(0,r.jsx)(i.I,{name:bt})},oo=(0,o.forwardRef)(({children:qe,onRemove:mt,disabled:bt,...Ht},kt)=>{const jt=(0,S.of)(Si,bt);return(0,r.jsxs)("span",{className:jt.wrapper,...Ht,ref:kt,children:[(0,r.jsx)("span",{className:jt.text,children:qe}),!bt&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:jt.separator}),(0,r.jsx)(T.K,{name:"times",size:"md","aria-label":`Remove ${qe}`,onClick:fn=>{fn.stopPropagation(),mt()}})]})]})}),Si=(qe,mt)=>({wrapper:(0,P.css)({display:"inline-flex",borderRadius:qe.shape.radius.default,color:qe.colors.text.primary,background:qe.colors.background.secondary,padding:qe.spacing(.25),border:mt?`1px solid ${qe.colors.border.weak}`:"none",fontSize:qe.typography.bodySmall.fontSize,flexShrink:0,minWidth:"50px",alignItems:"center","&:first-child:has(+ div)":{flexShrink:1}}),text:(0,P.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:qe.spacing(0,1,0,.75)}),separator:(0,P.css)({background:qe.colors.border.weak,width:"2px",height:"100%",marginRight:qe.spacing(.5)})});var tr=e(52977),Na=e(94963);const Mi=(qe,mt,bt,Ht,kt,jt,fn,ln)=>{const Mn=(0,Ea.n)({theme:qe,invalid:bt}),Pn=(0,Na.getFocusStyles)(qe),Fn=kt&&kt!=="auto"?qe.spacing(kt):"100%",Xn=jt?qe.spacing(jt):"",Kn=fn?qe.spacing(fn):"";return{container:(0,P.css)({width:kt==="auto"?"auto":Fn,minWidth:Xn,maxWidth:Kn,display:kt==="auto"?"inline-block":"block"}),wrapper:(0,P.cx)(Mn.input,(0,P.css)({display:"flex",width:"100%",gap:qe.spacing(.5),padding:qe.spacing(.5),paddingRight:ln?qe.spacing(5):28,"&:focus-within":{...Pn}})),input:(0,P.css)({border:"none",outline:"none",background:"transparent",flexGrow:1,maxWidth:"100%",minWidth:40,"&::placeholder":{color:qe.colors.text.disabled},"&:focus":{outline:"none",cursor:"text"},cursor:"pointer"}),pillWrapper:(0,P.css)({display:"inline-flex",flexWrap:mt?"wrap":"nowrap",flexGrow:1,minWidth:"50px",gap:qe.spacing(.5)}),restNumber:(0,P.css)({display:"inline-flex",alignItems:"center",justifyContent:"center",padding:qe.spacing(0,1),border:Ht?`1px solid ${qe.colors.border.weak}`:"none",borderRadius:qe.shape.radius.default,backgroundColor:qe.colors.background.secondary,cursor:"pointer","&:hover":{backgroundColor:qe.colors.action.hover}}),suffix:Mn.suffix,disabled:Mn.inputDisabled}};var wr=e(82486),Oi=e(59497),io=e(49185),jo=e(91371);const Bo=12,Ii=50,Uo=10,pr=15;function No(qe,mt,bt){const[Ht,kt]=(0,o.useState)(qe.length),[jt,{width:fn}]=(0,io.A)(),[ln,{width:Mn}]=(0,io.A)(),[Pn,{width:Fn}]=(0,io.A)(),Xn=mt&&mt!=="auto"?mt:fn;return(0,o.useEffect)(()=>{const Kn=Xn-Mn-Fn;let Zn=0;for(let Ds=0;Ds<qe.length;Ds++){if(Zn+=(0,jo.kD)(qe[Ds].label||"",Bo).width+(bt?Uo:Ii),Zn>Kn){kt(Math.min(Ds,pr)||1);break}Ds===qe.length-1&&kt(qe.length)}},[Xn,Mn,Fn,qe,kt,bt]),{measureRef:jt,counterMeasureRef:ln,suffixMeasureRef:Pn,shownItems:Ht}}function Ai(qe){const mt=(0,o.useRef)(null),bt=(0,o.useRef)(0),[Ht,kt]=(0,o.useState)("");return(0,o.useLayoutEffect)(()=>{if(mt.current&&qe==null&&bt.current===0&&(bt.current=mt?.current.getBoundingClientRect().width),!mt.current||qe==null){kt("");return}const jt=window.getComputedStyle(mt.current).fontSize,fn=(0,jo.kD)(mt.current.value||"",parseInt(jt,10)).width;fn<bt.current?kt(""):kt(`${fn+5}px`)},[qe]),{inputRef:mt,inputWidth:Ht}}var Wo=e(96691);const Ri=()=>Promise.resolve([]);function Fo(qe,mt){const bt=typeof qe=="function",Ht=(0,Wo.V)(bt?qe:Ri),kt=(0,o.useMemo)(()=>(0,W.debounce)(Fs=>Ht(Fs).then(Ss=>{fn(Ss),Mn(!1),Fn(!1)}).catch(Ss=>{Ss instanceof Wo.N||(Fn(!0),Mn(!1),Ss&&console.error("Error loading async options for Combobox",Ss))}),200),[Ht]),[jt,fn]=(0,o.useState)([]),[ln,Mn]=(0,o.useState)(!1),[Pn,Fn]=(0,o.useState)(!1),[Xn,Kn]=(0,o.useState)(""),Zn=(0,o.useCallback)(Fs=>{let Ss=Fs;return mt&&Xn&&(Fs.some(Es=>Es.value===Xn)||(Ss=[{label:Xn,value:Xn,description:(0,nt.t)("combobox.custom-value.description","Use custom value")},...Ss])),Ss},[mt,Xn]),Ds=(0,o.useCallback)(Fs=>{if(!bt){Kn(Fs);return}Mn(!0),kt(Fs)},[kt,bt]),Ts=(0,o.useCallback)(Fs=>{const Ss=new Map;for(const Ms of Fs)Ss.has(Ms.group)?Ss.get(Ms.group)?.push(Ms):Ss.set(Ms.group,[Ms]);const js=[];for(const[Ms,ds]of Ss)Ms&&js.push(...ds);const Es=Ss.get(void 0);return Es&&js.push(...Es),js},[]);return{options:(0,o.useMemo)(()=>{const Fs=bt?jt:qe.filter((0,tr.EB)(Xn)),Ss=Ts(Fs);return Zn(Ss)},[bt,Ts,Zn,jt,qe,Xn]),updateOptions:Ds,asyncLoading:ln,asyncError:Pn}}const lr=qe=>{const{placeholder:mt,onChange:bt,value:Ht,width:kt,enableAllOption:jt,invalid:fn,disabled:ln,minWidth:Mn,maxWidth:Pn,isClearable:Fn,createCustomValue:Xn=!1}=qe,Kn=(0,S.of)(Kr.C3),[Zn,Ds]=(0,o.useState)(""),Ts=(0,o.useMemo)(()=>({label:Zn===""?(0,nt.t)("multicombobox.all.title","All"):(0,nt.t)("multicombobox.all.title-filtered","All (filtered)"),value:wr.A}),[Zn]),{options:gs,updateOptions:Fs,asyncLoading:Ss}=Fo(qe.options,Xn),js=(0,o.useMemo)(()=>jt&&gs.length>1?[Ts,...gs]:gs,[gs,jt,Ts]),Es=qe.loading||Ss,Ms=(0,o.useMemo)(()=>Ht?Li(Ht,typeof qe.options!="function"?qe.options:gs):[],[Ht,qe.options,gs]),{measureRef:ds,counterMeasureRef:Vn,suffixMeasureRef:Os,shownItems:ns}=No(Ms,kt,ln),Bs=(0,o.useCallback)(Ps=>Ms.some(ra=>ra.value===Ps.value),[Ms]),{getSelectedItemProps:Ns,getDropdownProps:Ws,setSelectedItems:Is,addSelectedItem:Gs,removeSelectedItem:ea,reset:ba}=(0,Pa.mH)({selectedItems:Ms,onStateChange:({type:Ps,selectedItems:ra})=>{switch(Ps){case Pa.mH.stateChangeTypes.SelectedItemKeyDownBackspace:case Pa.mH.stateChangeTypes.SelectedItemKeyDownDelete:case Pa.mH.stateChangeTypes.DropdownKeyDownBackspace:case Pa.mH.stateChangeTypes.FunctionRemoveSelectedItem:case Pa.mH.stateChangeTypes.FunctionAddSelectedItem:case Pa.mH.stateChangeTypes.FunctionSetSelectedItems:case Pa.mH.stateChangeTypes.FunctionReset:bt(ra??[]);break;default:break}},stateReducer:(Ps,ra)=>{const{changes:ca}=ra;return{...ca,activeIndex:-999}}}),{getToggleButtonProps:Oa,isOpen:pa,highlightedIndex:Ka,getMenuProps:Qr,getInputProps:oa,getItemProps:wa}=(0,Pa.Bp)({items:js,itemToString:tr.yl,inputValue:Zn,selectedItem:null,stateReducer:(Ps,ra)=>{const{type:ca}=ra;let{changes:Ks}=ra;switch(Ps.isOpen===!1&&Ks.isOpen===!0&&Ks.inputValue===Ps.inputValue&&(Ks={...Ks,inputValue:""}),ca){case Pa.Bp.stateChangeTypes.InputKeyDownEnter:case Pa.Bp.stateChangeTypes.ItemClick:return{...Ks,isOpen:!0,highlightedIndex:Ps.highlightedIndex};case Pa.Bp.stateChangeTypes.InputBlur:Ds("");default:return Ks}},onIsOpenChange:({isOpen:Ps,inputValue:ra})=>{Ps&&ra===""&&Fs(ra)},onStateChange:({inputValue:Ps,type:ra,selectedItem:ca})=>{switch(ra){case Pa.Bp.stateChangeTypes.InputKeyDownEnter:case Pa.Bp.stateChangeTypes.ItemClick:if(ca?.value===wr.A){const Ks=Ms.length===js.length-1,$a=js.slice(1);let Yr=Ks&&Zn===""?[]:$a;if(!Ks&&Zn!==""&&(Yr=[...new Set([...Ms,...$a])]),Ks&&Zn!==""){const Jr=new Set($a.map(Sr=>Sr.value));Yr=Ms.filter(Sr=>!Jr.has(Sr.value))}Is(Yr)}else ca&&Bs(ca)?ea(ca):ca&&Gs(ca);break;case Pa.Bp.stateChangeTypes.InputChange:Ds(Ps??""),Fs(Ps??"");break;default:break}}}),{inputRef:La,floatingRef:ma,floatStyles:ja,scrollRef:Ia}=(0,Oi.l)(js,pa),va=(0,S.of)(Mi,pa,fn,ln,kt,Mn,Pn,Fn),Va={count:js.length,getScrollElement:()=>Ia.current,estimateSize:Ps=>{const ra=Ko(js[Ps],Ps>0?js[Ps-1]:void 0),ca="description"in js[Ps];let Ks=Kr.Aj;return ca&&(Ks=Kr.pg),ra&&(Ks+=Kr.Aj),Ks},overscan:ir.X},Tr=(0,Ci.Te)(Va),Xa=pa?Ms.slice(0,pr):Ms.slice(0,ns),{inputRef:kr,inputWidth:hr}=Ai(Zn);return(0,r.jsxs)("div",{className:va.container,ref:La,children:[(0,r.jsx)("div",{className:(0,P.cx)(va.wrapper,{[va.disabled]:ln}),ref:ds,children:(0,r.jsxs)("span",{className:va.pillWrapper,children:[Xa.map((Ps,ra)=>(0,r.jsx)(oo,{disabled:ln,onRemove:()=>{ea(Ps)},...Ns({selectedItem:Ps,index:ra}),children:(0,tr.yl)(Ps)},`${Ps.value}${ra}`)),Ms.length>Xa.length&&(0,r.jsxs)(Oo.a,{display:"flex",direction:"row",marginLeft:.5,gap:1,ref:Vn,children:[(0,r.jsx)(Mo.E,{children:"..."}),(0,r.jsx)(l.m,{interactive:!0,content:(0,r.jsx)(r.Fragment,{children:Ms.slice(Xa.length).map(Ps=>(0,r.jsx)("div",{children:(0,tr.yl)(Ps)},Ps.value))}),children:(0,r.jsx)("div",{className:va.restNumber,children:Ms.length-ns})})]}),(0,r.jsx)("input",{className:va.input,...oa(Ws({disabled:ln,preventKeyAction:pa,placeholder:Xa.length===0?mt:"",ref:kr,style:{width:hr}}))}),(0,r.jsxs)("div",{className:va.suffix,ref:Os,...Oa(),children:[Fn&&Ms.length>0&&(0,r.jsx)(i.I,{name:"times",className:Kn.clear,title:(0,nt.t)("multicombobox.clear.title","Clear all"),tabIndex:0,role:"button",onClick:Ps=>{Ps.stopPropagation(),ba()},onKeyDown:Ps=>{(Ps.key==="Enter"||Ps.key===" ")&&ba()}}),(0,r.jsx)(Ti,{isLoading:Es||!1,isOpen:pa})]})]})}),(0,r.jsx)(k.ZL,{children:(0,r.jsx)("div",{className:(0,P.cx)(Kn.menu,!pa&&Kn.menuClosed),style:{...ja},...Qr({ref:ma}),children:pa&&(0,r.jsxs)(h.P,{showScrollIndicators:!0,maxHeight:"inherit",ref:Ia,padding:.5,children:[(0,r.jsx)("ul",{style:{height:Tr.getTotalSize()},className:Kn.menuUlContainer,children:Tr.getVirtualItems().map(Ps=>{const ra=Ko(js[Ps.index],js[Ps.index-1]),ca=Ps.index,Ks=js[ca],$a=wa({item:Ks,index:ca}),Yr=Bs(Ks),Jr="multicombobox-option-"+Ks.value.toString(),Sr=Ks.value===wr.A,cl=js[0]?.value===wr.A&&Ms.length===js.length-1;return(0,r.jsx)("li",{"data-index":ca,...$a,className:Kn.optionBasic,style:{height:Ps.size,transform:`translateY(${Ps.start}px)`},children:(0,r.jsxs)(Nr.B,{direction:"column",justifyContent:"space-between",width:"100%",height:"100%",gap:0,children:[ra&&(0,r.jsx)("div",{className:Kn.optionGroup,children:(0,r.jsx)(Lo,{label:Ks.group??(0,nt.t)("combobox.group.undefined","No group"),id:Jr,isGroup:!0})}),(0,r.jsx)("div",{className:(0,P.cx)(Kn.option,{[Kn.optionFocused]:Ka===ca}),children:(0,r.jsxs)(Nr.B,{direction:"row",alignItems:"center",children:[(0,r.jsx)(ro.S,{value:cl||Yr,indeterminate:Sr&&Ms.length>0&&!cl,"aria-labelledby":Jr,onClick:Ol=>{Ol.stopPropagation()}},Jr),(0,r.jsx)(Lo,{label:Sr?(Ks.label??Ks.value.toString())+(Sr&&Zn!==""?` (${js.length-1})`:""):Ks.label??Ks.value.toString(),description:Ks?.description,id:Jr})]})})]})},`${Ks.value}-${ca}`)})}),(0,r.jsx)("div",{"aria-live":"polite",children:js.length===0&&(0,r.jsx)(bi.m,{})})]})})})]})};function Li(qe,mt){if(lo(qe))return qe;const bt=new Map(qe.map((kt,jt)=>[kt,jt])),Ht=[];for(const kt of mt){const jt=bt.get(kt.value);if(jt!==void 0&&(Ht[jt]=kt,bt.delete(kt.value)),bt.size===0)break}for(const[kt,jt]of bt)Ht[jt]={value:kt};return Ht}function lo(qe){return typeof qe[0]=="object"}const Ko=(qe,mt)=>{const bt=qe.group;return bt?mt?mt.group!==bt:!0:!!mt?.group};var co=e(19550),ji=e(66384),mr=e(60641),nr=e(34511),wo=e(22084),Vo=e(95722),$o=e(22560),Vr=e(79232),Bi=e(72978),Ui=e(24726),Ni=e(93644);const Wi=({onFileUpload:qe,className:mt,children:bt="Upload file",accept:Ht="*",size:kt="md",showFileName:jt})=>{const fn=(0,S.of)(zo(kt)),[ln,Mn]=(0,o.useState)(""),Pn=(0,Ui.A)(),Fn=(0,o.useCallback)(Xn=>{const Kn=Xn.currentTarget?.files?.[0];Kn&&Mn(Kn.name??""),qe(Xn)},[qe]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"file",id:Pn,className:fn.fileUpload,onChange:Fn,multiple:!1,accept:Ht,"data-testid":$t.Tp.components.FileUpload.inputField}),(0,r.jsxs)("label",{htmlFor:Pn,className:(0,P.cx)(fn.labelWrapper,mt),children:[(0,r.jsx)(i.I,{name:"upload",className:fn.icon}),bt]}),jt&&ln&&(0,r.jsx)("span",{"aria-label":"File name",className:fn.fileName,"data-testid":$t.Tp.components.FileUpload.fileNameSpan,children:(0,Ni.i)(ln)})]})},zo=qe=>mt=>{const bt=(0,ae.hs)({theme:mt,variant:"primary",size:qe,iconOnly:!1}),Ht=(0,Na.getFocusStyles)(mt);return{fileUpload:(0,P.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":Ht,"&:focus-visible + label":Ht}),labelWrapper:bt.button,icon:bt.icon,fileName:(0,P.css)({marginLeft:mt.spacing(.5)})}};var uo=e(50876),Ho=e(75860),_o=e(7224),Fi=e(13409),Go=e(6210),Ki=e(51081),$r=e(48092),Qo=e(31035),ko=e(60232),wi=e(50278),Za=e(6489);const ho=({users:qe,onClick:mt,limit:bt=4})=>{const Ht=(0,S.of)(Yo);if(!qe.length)return null;bt=bt>0?bt:4;const kt=qe.length>bt,jt=qe.length-bt,fn=jt>99;return(0,r.jsxs)("div",{className:Ht.container,"aria-label":"Users indicator container",children:[kt&&(0,r.jsx)(Za.n,{onClick:mt,userView:{user:{name:"Extra users"},lastActiveAt:""},showTooltip:!1,children:fn?"...":`+${jt}`}),qe.slice(0,kt?bt:bt+1).reverse().map(ln=>(0,r.jsx)(Za.n,{userView:ln},ln.user.name))]})},Yo=qe=>({container:(0,P.css)({display:"flex",justifyContent:"center",flexDirection:"row-reverse",marginLeft:qe.spacing(1),"& > button":{marginLeft:qe.spacing(-1)}}),dots:(0,P.css)({marginBottom:"3px"})});var cr=e(40232),Vi=e(79172),Jo=e(76080),$i=e(14382),sr=e(13147),zi=e(97988),bs=e(7500),Xo=e(5858),Ra=e(73627),Zo=e(87579),fo=e(31376),Hi=e(86932),go=e(44625),qo=e(2762),zr=e(12963),ar=e(72778),vr=e(40923),po=e(16669),yr=e(25205),ei=e(53112),_i=e(40612),xr=e(34796),ti=e.n(xr),Qa=e(16557),mo=e(30665),ka=e(59141),Ya=e(23570),vo=e(88090),zs=e(90168);const ni=(qe,mt)=>{let bt=0,Ht=qe.values.length-1,kt;for(;;){if(bt>Ht)return Math.max(Ht,0);kt=Math.floor((bt+Ht)/2);const jt=qe.values[kt];if(jt===mt)return kt;jt&&jt<mt?bt=kt+1:Ht=kt-1}},Er=(qe,mt,bt,Ht)=>{let kt,jt,fn,ln,Mn;const Pn=[];let Fn,Xn;for(kt=0;kt<qe.length;kt++){jt=qe[kt];const Kn=mt[kt];fn=ni(Kn,bt),ln=bt-Kn.values[fn],Mn=Kn.values[fn],(Fn===void 0||ln>=0&&(ln<Fn||Fn<0)||ln<0&&ln>Fn)&&(Fn=ln,Xn=Kn.display?(0,ka.cN)(Kn.display(Mn)):Mn);const Zn=jt.display(jt.values[fn]);Pn.push({value:(0,ka.cN)(Zn),datapointIndex:fn,seriesIndex:kt,color:Zn.color,label:(0,Ya.Ct)(jt),time:Kn.display?(0,ka.cN)(Kn.display(Mn)):Mn})}return{results:Pn,time:Xn}},yo=(qe,mt)=>(0,vo.LE)(qe,{format:mt?.options?.timeformat,timeZone:mt?.options?.timezone}),Hr=(qe,mt,bt)=>{if(mt&&bt&&qe){const Ht=bt-mt,kt=Ht/qe/1e3,jt=86400010,fn=31536e6;return kt<=10?zs.WC.interval.millisecond:kt<=45?zs.WC.interval.second:Ht<=jt?zs.WC.interval.minute:kt<=8e4?zs.WC.interval.hour:Ht<=fn?zs.WC.interval.day:kt<=31536e3?zs.WC.interval.month:zs.WC.interval.year}return zs.WC.interval.minute},xo=({dimensions:qe,activeDimensions:mt,pos:bt,timeZone:Ht})=>{let kt=null;if(mt.xAxis===null)return null;mt.yAxis&&(kt=mt.yAxis[0]);const jt=mt.xAxis[1]?(0,Qa.WK)(qe.xAxis,mt.xAxis[0],mt.xAxis[1]):bt.x,fn=Er(qe.yAxis.columns,qe.xAxis.columns,jt,Ht),ln=fn.time,Mn=fn.results.map((Pn,Fn)=>({color:Pn.color,label:Pn.label,value:Pn.value,isActive:kt===Fn}));return(0,r.jsx)(Ct.o,{series:Mn,timestamp:ln})};xo.displayName="MultiModeGraphTooltip";const si=({dimensions:qe,activeDimensions:mt,timeZone:bt})=>{if(mt.yAxis===null||mt.yAxis[1]===void 0||mt.xAxis===null||mt.xAxis[1]===void 0)return null;const Ht=(0,Qa.WK)(qe.xAxis,mt.xAxis[0],mt.xAxis[1]),kt=(0,Qa.P4)(qe.xAxis,mt.xAxis[0]),jt=kt.display?(0,ka.cN)(kt.display(Ht)):Ht,fn=(0,Qa.P4)(qe.yAxis,mt.yAxis[0]),ln=(0,Qa.WK)(qe.yAxis,mt.yAxis[0],mt.yAxis[1]),Mn=fn.display,Pn=Mn(ln);return(0,r.jsx)(Ct.o,{series:[{color:Pn.color,label:(0,Ya.Ct)(fn),value:(0,ka.cN)(Pn)}],timestamp:jt})};si.displayName="SingleModeGraphTooltip";const Pr=({mode:qe=bs.$N.Single,dimensions:mt,activeDimensions:bt,pos:Ht,timeZone:kt})=>!bt||!bt.xAxis?null:qe==="single"?(0,r.jsx)(si,{dimensions:mt,activeDimensions:bt,timeZone:kt}):(0,r.jsx)(xo,{dimensions:mt,activeDimensions:bt,pos:Ht,timeZone:kt});Pr.displayName="GraphTooltip";class qa extends o.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(mt,bt)=>{const{onHorizontalRegionSelected:Ht}=this.props;Ht&&Ht(bt.xaxis.from,bt.xaxis.to)},this.onPlotHover=(mt,bt,Ht)=>{this.setState({isTooltipVisible:!0,activeItem:Ht,pos:bt})},this.onPlotClick=(mt,bt,Ht)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:Ht,contextPos:bt})},this.renderTooltip=()=>{const{children:mt,series:bt,timeZone:Ht}=this.props,{pos:kt,activeItem:jt,isTooltipVisible:fn}=this.state;let ln;if(!fn||!kt||bt.length===0||(o.Children.forEach(mt,gs=>{if(ln)return;(gs&&gs.type&&(gs.type.displayName||gs.type.name))===mn.displayName&&(ln=gs)}),!ln))return null;const Mn=ln.props,Pn=Mn.mode||"single";if(!jt&&Pn==="single")return null;const Fn=Mn.tooltipComponent||Pr,Xn=jt?jt.series.seriesIndex:0,Kn=jt?jt.dataIndex:void 0,Zn={xAxis:[Xn,Kn],yAxis:jt?[jt.series.seriesIndex,jt.dataIndex]:null},Ds={dimensions:{xAxis:(0,Qa.r4)("xAxis",bt.map(gs=>gs.timeField)),yAxis:(0,Qa.r4)("yAxis",bt.map(gs=>gs.valueField))},activeDimensions:Zn,pos:kt,mode:Mn.mode||bs.$N.Single,timeZone:Ht},Ts=o.createElement(Fn,{...Ds});return o.cloneElement(ln,{content:Ts,position:{x:kt.pageX,y:kt.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:mt}=this.props,{contextPos:bt,contextItem:Ht,isContextVisible:kt}=this.state;if(!kt||!bt||!Ht||mt.length===0)return null;const jt=Ht?Ht.series.seriesIndex:0,fn=Ht?Ht.dataIndex:void 0,ln={xAxis:[jt,fn],yAxis:Ht?[Ht.series.seriesIndex,Ht.dataIndex]:null},Mn={xAxis:(0,Qa.r4)("xAxis",mt.map(Kn=>Kn.timeField)),yAxis:(0,Qa.r4)("yAxis",mt.map(Kn=>Kn.valueField))},Pn=()=>this.setState({isContextVisible:!1}),Fn=()=>({datapoint:Ht.datapoint,dataIndex:Ht.dataIndex,series:Ht.series,seriesIndex:Ht.series.seriesIndex,pageX:bt.pageX,pageY:bt.pageY}),Xn={x:bt.pageX,y:bt.pageY,onClose:Pn,getContextMenuSource:Fn,timeZone:this.props.timeZone,dimensions:Mn,contextDimensions:ln};return(0,r.jsx)(mo.H,{...Xn})},this.getBarWidth=()=>{const{series:mt}=this.props;return Math.min(...mt.map(bt=>bt.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(mt,bt){mt!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=ti()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(mt){return mt.length===0?[{show:!0,min:-1,max:1}]:(0,W.uniqBy)(mt.map(bt=>{const Ht=bt.yAxis?bt.yAxis.index:1,kt=bt.yAxis&&bt.yAxis.min&&!isNaN(bt.yAxis.min)?bt.yAxis.min:null,jt=bt.yAxis&&bt.yAxis.tickDecimals&&!isNaN(bt.yAxis.tickDecimals)?bt.yAxis.tickDecimals:null;return{show:!0,index:Ht,position:Ht===1?"left":"right",min:kt,tickDecimals:jt}}),bt=>bt.index)}draw(){if(this.element===null)return;const{width:mt,series:bt,timeRange:Ht,showLines:kt,showBars:jt,showPoints:fn,isStacked:ln,lineWidth:Mn,timeZone:Pn,onHorizontalRegionSelected:Fn}=this.props;if(!mt)return;const Xn=mt/100,Kn=Ht.from.valueOf(),Zn=Ht.to.valueOf(),Ds=this.getYAxes(bt),Ts={legend:{show:!1},series:{stack:ln,lines:{show:kt,lineWidth:Mn,zero:!1},points:{show:fn,fill:1,fillColor:!1,radius:2},bars:{show:jt,fill:1,barWidth:jt?this.getBarWidth()/1.5:1,zero:!1,lineWidth:Mn},shadowSize:0},xaxis:{timezone:Pn,show:!0,mode:"time",min:Kn,max:Zn,label:"Datetime",ticks:Xn,timeformat:Hr(Xn,Kn,Zn),tickFormatter:yo},yaxes:Ds,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:Fn?"x":null,color:"#666"},crosshair:{mode:"x"}};try{ti().plot(this.element,bt.filter(gs=>gs.isVisible),Ts)}catch(gs){throw console.error("Graph rendering error",gs,Ts,bt),new Error("Error rendering panel")}}render(){const{ariaLabel:mt,height:bt,width:Ht,series:kt}=this.props,jt=kt.length===0,fn=this.renderTooltip(),ln=this.renderContextMenu();return(0,r.jsxs)("div",{className:"graph-panel","aria-label":mt,children:[(0,r.jsx)("div",{className:"graph-panel__chart",ref:Mn=>this.element=Mn,style:{height:bt,width:Ht},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),jt&&(0,r.jsx)("div",{className:"datapoints-warning",children:"No data"}),fn,ln]})}}const il=null,_r=(qe,mt=!1,bt=!1)=>{const Ht=qe.reduce((jt,fn)=>jt+(fn[1]||0),0)===0,kt=!qe.reduce((jt,fn)=>jt&&fn[1]!==null,!0);return mt&&kt||bt&&Ht},Dr=qe=>{const{series:mt,timeRange:bt,width:Ht,height:kt,showBars:jt,showLines:fn,showPoints:ln,sortLegendBy:Mn,sortLegendDesc:Pn,legendDisplayMode:Fn,legendVisibility:Xn,placement:Kn,onSeriesToggle:Zn,onToggleSort:Ds,hideEmpty:Ts,hideZero:gs,isStacked:Fs,lineWidth:Ss,onHorizontalRegionSelected:js,timeZone:Es,children:Ms,ariaLabel:ds}=qe,{graphContainer:Vn,wrapper:Os,legendContainer:ns}=(0,S.of)(dr,qe.placement),Bs=mt.reduce((Ns,Ws)=>_r(Ws.data,Ts,gs)?Ns:Ns.concat([{label:Ws.label,color:Ws.color||"",disabled:!Ws.isVisible,yAxis:Ws.yAxis.index,getDisplayValues:()=>Ws.info||[]}]),[]);return(0,r.jsxs)("div",{className:Os,"aria-label":ds,children:[(0,r.jsx)("div",{className:Vn,children:(0,r.jsx)(qa,{series:mt,timeRange:bt,timeZone:Es,showLines:fn,showPoints:ln,showBars:jt,width:Ht,height:kt,isStacked:Fs,lineWidth:Ss,onHorizontalRegionSelected:js,children:Ms})}),Xn&&(0,r.jsx)("div",{className:ns,children:(0,r.jsx)(_.E,{hideHorizontalTrack:!0,children:(0,r.jsx)(Ft.t,{items:Bs,displayMode:Fn,placement:Kn,sortBy:Mn,sortDesc:Pn,onLabelClick:(Ns,Ws)=>{Zn&&Zn(Ns.label,Ws)},onToggleSort:Ds})})})]})},dr=(qe,mt)=>({wrapper:(0,P.css)({display:"flex",flexDirection:mt==="bottom"?"column":"row"}),graphContainer:(0,P.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,P.css)({padding:"10px 0",maxHeight:mt==="bottom"?"35%":"none"})});var Gi=e(64423),Cr=e(99165),Eo=e(40462),Po=e(38075),Fa=e(63739),Gr=e(35383),ai=e(52718),Js=e(7257),ri=e(77230);const Ja={threshold:(qe,mt,bt)=>qe+bt,midpoint:(qe,mt,bt)=>(qe+mt)/2,plusone:(qe,mt,bt)=>qe+1};function qs(qe){if(qe.frame.length===0)return qe.frame;let mt=!0,{frame:bt,refFieldName:Ht,refFieldPseudoMax:kt,refFieldPseudoMin:jt,insertMode:fn}=qe;fn||(fn=Ja.threshold);const ln=oi(bt,Ht);if(ln==null)return bt;ln.state={...ln.state,nullThresholdApplied:!0};const Mn=bt.fields.map(Fn=>Fn.config.custom?.insertNulls||ln.config.interval||null),Pn=new Set(Mn);if(Pn.delete(null),Pn.size===0)return bt;if(Pn.size===1){const Fn=Pn.values().next().value;if(!Fn||Fn<=0)return bt;const Xn=ln.values,Kn=bt.fields.map(Ds=>Ds.values),Zn=_a(Xn,Kn,Fn,jt,kt,fn,mt);return Zn===Kn?bt:{...bt,length:Zn[0].length,fields:bt.fields.map((Ds,Ts)=>({...Ds,values:Zn[Ts]}))}}return bt}function _a(qe,mt,bt,Ht=null,kt=null,jt,fn){const ln=qe.length,Mn=[];if(Ht!=null&&Ht<qe[0]){let Kn=Math.ceil((qe[0]-Ht)/bt),Zn=qe[0]-Kn*bt;for(;Zn<qe[0];)Mn.push(jt(Zn-bt,Zn,bt)),Zn+=bt}Mn.push(qe[0]);let Pn=qe[0];for(let Kn=1;Kn<ln;Kn++){const Zn=qe[Kn];for(;Zn-Pn>bt&&(Mn.push(jt(Pn,Zn,bt)),Pn+=bt,!!fn););Mn.push(Zn),Pn=Zn}if(kt!=null&&kt>Pn)for(;Pn+bt<kt;)Mn.push(jt(Pn,kt,bt)),Pn+=bt;const Fn=Mn.length;if(Fn===ln)return mt;const Xn=[];for(let Kn of mt){let Zn;if(Kn!==qe){Zn=Array(Fn);for(let Ds=0,Ts=0;Ds<Fn;Ds++)Zn[Ds]=qe[Ts]===Mn[Ds]?Kn[Ts++]:null}else Zn=Mn;Xn.push(Zn)}return Xn}function Do(qe,mt,bt){let Ht,kt;for(let jt=0;jt<mt.length;jt++)if(mt[jt]==null)kt==null&&Ht!=null&&(kt=jt);else{if(kt!=null){if(qe[jt]-Ht<bt)for(;kt<jt;)mt[kt++]=void 0;kt=null}Ht=qe[jt]}return mt}function ur(qe){return qe.type===Fa.PU.number&&qe.config.custom?.drawStyle===bs.GR.Bars&&!qe.config.custom?.hideFrom?.viz}function oi(qe,mt){return qe.fields.find(bt=>mt!=null?bt.name===mt:bt.type===Fa.PU.time)}function Qi(qe,mt){const bt=oi(qe,mt);let Ht=bt?.values;for(let kt=0;kt<qe.fields.length;kt++){let jt=qe.fields[kt];if(jt===bt||ur(jt))continue;let fn=jt.config.custom?.spanNulls;typeof fn=="number"&&fn!==-1&&Ht&&(jt.values=Do(Ht,jt.values,fn))}return qe}function Ae(qe,mt,bt){let Ht;e:for(let ln of qe)for(let Mn of ln.fields)if(mt.x(Mn,ln,qe)){Ht=Mn;break e}qe=qe.map(ln=>Ht?.state?.nullThresholdApplied?ln:qs({frame:ln,refFieldName:Ht.name,refFieldPseudoMin:bt?.from.valueOf(),refFieldPseudoMax:bt?.to.valueOf()}));let kt=0;qe.forEach(ln=>{ln.fields.forEach(Mn=>{ur(Mn)&&(Mn.config.custom={...Mn.config.custom,spanNulls:-1},kt++)})});let jt=1/0;kt>1&&qe.forEach(ln=>{if(!ln.fields.some(ur))return;const Mn=Ht.values;for(let Pn=0;Pn<Mn.length;Pn++)Pn>0&&(jt=Math.min(jt,Mn[Pn]-Mn[Pn-1]))});let fn=(0,ri.Fd)({frames:qe,joinBy:mt.x,keep:mt.y,keepOriginIndices:!0});return fn?(fn=Qi(fn,Ht.name),jt!==1/0&&(fn.fields.forEach((ln,Mn)=>{let Pn=ln.values;if(Mn===0){let Fn=Pn[Pn.length-1];Pn.push(Fn+jt,Fn+2*jt)}else ur(ln)?Pn.push(null,null):Pn.push(void 0,void 0)}),fn.length+=2),fn):null}function pe(qe,mt){const bt="na",Ht=`${qe.min!==void 0?qe.min:bt}-${qe.max!==void 0?qe.max:bt}`,kt=`${qe.custom?.axisSoftMin!==void 0?qe.custom.axisSoftMin:bt}-${qe.custom?.axisSoftMax!==void 0?qe.custom.axisSoftMax:bt}`,jt=`${qe.custom?.axisPlacement!==void 0?qe.custom?.axisPlacement:bs.vM.Auto}`,fn=qe.unit??po.s,ln=qe.custom?.scaleDistribution?We(qe.custom.scaleDistribution):bs.L4.Linear,Mn=qe.custom?.axisLabel?qe.custom.axisLabel:bt;return`${fn}/${Ht}/${kt}/${jt}/${ln}/${Mn}/${mt}`}function We(qe){return qe.type===bs.L4.Log?`${qe.type}${qe.log}`:qe.type}function et(qe,mt,bt=[]){for(const Ht of bt)if(typeof Ht=="function"){if(!Ht(qe,mt))return!1}else if(mt[Ht]!==qe[Ht])return!1;return!0}class At extends o.Component{constructor(mt){super(mt),this.panelContext={},this.subscription=new Gi.yU,this.getTimeRange=()=>this.props.timeRange;let bt=this.prepState(mt);bt.alignedData=bt.config.prepData([bt.alignedFrame]),this.state=bt,this.plotInstance=o.createRef()}static{this.contextType=Wt.e4}prepState(mt,bt=!0){let Ht=null;const{frames:kt,fields:jt,preparePlotFrame:fn}=mt,Mn=(fn||Ae)(kt,jt||{x:Eo.sJ.get(Po.Ct.firstTimeField).get({}),y:Eo.sJ.get(Po.Ct.byTypes).get(new Set([Fa.PU.number,Fa.PU.enum]))},mt.timeRange);if((0,Js.uY)("GraphNG",!1,"data aligned",Mn),Mn){let Pn=this.state?.config;bt&&(Pn=mt.prepConfig(Mn,this.props.frames,this.getTimeRange),(0,Js.uY)("GraphNG",!1,"config prepared",Pn)),Ht={alignedFrame:Mn,config:Pn},(0,Js.uY)("GraphNG",!1,"data prepared",Ht.alignedData)}return Ht}handleCursorUpdate(mt){const bt=mt.payload?.point?.time,Ht=this.plotInstance.current;if(Ht&&bt){const kt=Ht.valToPos(bt,"x");let jt;if(kt&&(jt=(0,Js.sw)(Ht,Ht.posToIdx(kt))),!jt||!kt)return;Ht.setCursor({left:kt,top:jt})}}componentDidMount(){this.panelContext=this.context;const{eventBus:mt}=this.panelContext;this.subscription.add(mt.getStream(Gr.b_).pipe((0,Cr.c)(50)).subscribe({next:bt=>{mt!==bt.origin&&this.handleCursorUpdate(bt)}})),this.subscription.add(mt.getStream(ai.kb).pipe((0,Cr.c)(50)).subscribe({next:bt=>this.handleCursorUpdate(bt)})),this.subscription.add(mt.getStream(Gr.ql).pipe((0,Cr.c)(50)).subscribe({next:()=>{const bt=this.plotInstance?.current;bt&&!bt.cursor._lock&&bt.setCursor({left:-10,top:-10})}}))}componentDidUpdate(mt){const{frames:bt,structureRev:Ht,timeZone:kt,propsToDiff:jt}=this.props,fn=!et(mt,this.props,jt);if(bt!==mt.frames||fn||kt!==mt.timeZone){let ln=this.prepState(this.props,!1);ln&&((this.state.config===void 0||kt!==mt.timeZone||Ht!==mt.structureRev||!Ht||fn)&&(ln.config=this.props.prepConfig(ln.alignedFrame,this.props.frames,this.getTimeRange),(0,Js.uY)("GraphNG",!1,"config recreated",ln.config)),ln.alignedData=ln.config.prepData([ln.alignedFrame]),this.setState(ln))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:mt,height:bt,children:Ht,renderLegend:kt}=this.props,{config:jt,alignedFrame:fn,alignedData:ln}=this.state;return jt?(0,r.jsx)(gt.KU,{width:mt,height:bt,legend:kt(jt),children:(Mn,Pn)=>(0,r.jsx)(Zo.Z,{config:jt,data:ln,width:Mn,height:Pn,plotRef:Fn=>this.plotInstance.current=Fn,children:Ht?Ht(jt,fn):null})}):null}}var Nt=e(36613),_t=e(16869),rn=e(18752),An=e(62931),en=e(74958),Nn=e(5077);const as=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),os=Array(53);for(let qe=0;qe<os.length;qe++)os[qe]=2**qe;const Bn=(qe,mt=1)=>qe==null?"-":qe.toFixed(mt),Dn={drawStyle:bs.GR.Line,showPoints:bs.yL.Auto,axisPlacement:bs.vM.Auto},ys=({frame:qe,theme:mt,timeZones:bt,getTimeRange:Ht,sync:kt,allFrames:jt,renderers:fn,tweakScale:ln=Pn=>Pn,tweakAxis:Mn=Pn=>Pn})=>{const Pn="__global_",Fn=new Xo.e(bt[0]);let Xn;Fn.setPrepData(ds=>(Xn=ds[0],(0,Js.bq)(ds[0],Fn.getStackingGroups())));const Kn=qe.fields[0];if(!Kn)return Fn;const Zn="x";let Ds="";const Ts=Kn.config.custom?.axisPlacement!==bs.vM.Hidden?bs.vM.Bottom:bs.vM.Hidden,gs=Kn.config.custom?.axisPlacement!==bs.vM.Hidden;if(Kn.type===Fa.PU.time){Fn.addScale({scaleKey:Zn,orientation:bs.Lt.Horizontal,direction:bs.ON.Right,isTime:!0,range:()=>{const Vn=Ht();return[Vn.from.valueOf(),Vn.to.valueOf()]}});const ds=bt.length>1?(Vn,Os)=>Os.map((ns,Bs)=>Bs<2?null:ns):void 0;for(let Vn=0;Vn<bt.length;Vn++){const Os=bt[Vn];Fn.addAxis({scaleKey:Zn,isTime:!0,placement:Ts,show:gs,label:Kn.config.custom?.axisLabel,timeZone:Os,theme:mt,grid:{show:Vn===0&&Kn.config.custom?.axisGridShow},filter:ds})}bt.length>1&&Fn.addHook("drawAxes",Vn=>{Vn.ctx.save(),Vn.ctx.fillStyle=mt.colors.text.primary,Vn.ctx.textAlign="left",Vn.ctx.textBaseline="bottom";let Os=0;Vn.axes.forEach(ns=>{if(ns.side===2){let Bs=ns._pos+ns._size;Vn.ctx.fillText(bt[Os],Vn.bbox.left,Bs*Nt.A.pxRatio),Os++}}),Vn.ctx.restore()})}else Fn.addScale({scaleKey:Zn,orientation:bs.Lt.Horizontal,direction:bs.ON.Right,range:(ds,Vn,Os)=>[Kn.config.min??Vn,Kn.config.max??Os]}),Fn.addAxis({scaleKey:Zn,placement:Ts,show:gs,label:Kn.config.custom?.axisLabel,theme:mt,grid:{show:Kn.config.custom?.axisGridShow},formatValue:(ds,Vn)=>(0,ka.cN)(Kn.display(ds,Vn))});let Fs=fn?.flatMap(ds=>Object.values(ds.fieldMap).filter(Vn=>ds.indicesOnly.indexOf(Vn)===-1))??[],Ss;for(let ds=1;ds<qe.fields.length;ds++){const Vn=qe.fields[ds],Os={...Vn.config,custom:{...Dn,...Vn.config.custom}},ns=Os.custom;if(Vn===Kn||Vn.type!==Fa.PU.number&&Vn.type!==Fa.PU.enum)continue;let Bs=Vn.display??Bn;Vn.config.custom?.stacking?.mode===bs.gs.Percent&&(Bs=(0,_t.J)({field:{...Vn,config:{...Vn.config,unit:"percentunit"}},theme:mt}));const Ns=pe(Os,Vn.type),Ws=(0,rn.Qi)(Vn),Gs=(0,rn.lz)(Vn,mt).color;if(Fn.addScale(ln({scaleKey:Ns,orientation:bs.Lt.Vertical,direction:bs.ON.Up,distribution:ns.scaleDistribution?.type,log:ns.scaleDistribution?.log,linearThreshold:ns.scaleDistribution?.linearThreshold,min:Vn.config.min,max:Vn.config.max,softMin:ns.axisSoftMin,softMax:ns.axisSoftMax,centeredZero:ns.axisCenteredZero,range:ns.stacking?.mode===bs.gs.Percent?(oa,wa,La)=>(wa=wa<0?-1:0,La=La>0?1:0,[wa,La]):Vn.type===Fa.PU.enum?(oa,wa,La)=>[-1,Vn.config.type.enum.text.length]:void 0,decimals:Vn.config.decimals},Vn)),Ds||(Ds=Ns),ns.axisPlacement!==bs.vM.Hidden){let oa;ns.axisColorMode===bs.Y$.Series&&(Ws.isByValue&&Vn.config.custom?.gradientMode===bs.on.Scheme&&Ws.id===An.Y.Thresholds?oa=(0,Nn.pl)(1,mt,Ws,Vn.config.thresholds):oa=Gs);const wa={border:{show:ns.axisBorderShow||!1,width:1/devicePixelRatio,stroke:oa||mt.colors.text.primary},ticks:{show:ns.axisBorderShow||!1,stroke:oa||mt.colors.text.primary},color:oa||mt.colors.text.primary};let La,ma,ja;if(as.has(Os.unit))La=os;else if(Vn.type===Fa.PU.enum){let Ia=Vn.config.type.enum.text;ja=Ia.map((va,Va)=>Va),ma=Ia}Fn.addAxis(Mn({scaleKey:Ns,label:ns.axisLabel,size:ns.axisWidth,placement:ns.axisPlacement??bs.vM.Auto,formatValue:(Ia,va)=>(0,ka.cN)(Bs(Ia,va)),theme:mt,grid:{show:ns.axisGridShow},decimals:Vn.config.decimals,distr:ns.scaleDistribution?.type,splits:ja,values:ma,incrs:La,...wa},Vn))}const ea=ns.drawStyle===bs.GR.Points?bs.yL.Always:ns.showPoints;let ba=()=>null;ns.spanNulls!==!0&&(ba=(oa,wa,La,ma)=>{let ja=[],Ia=oa.series[wa];if(!La&&ma&&ma.length){const[va,Va]=Ia.idxs,Tr=oa.data[0],Xa=oa.data[wa],kr=Math.round(oa.valToPos(Tr[va],"x",!0)),hr=Math.round(oa.valToPos(Tr[Va],"x",!0));ma[0][0]===kr&&ja.push(va);for(let Ps=0;Ps<ma.length;Ps++){let ra=ma[Ps],ca=ma[Ps+1];if(ca&&ra[1]===ca[0]){let Ks=oa.posToIdx(ra[1],!0);if(Xa[Ks]==null)for(let $a=1;$a<100;$a++){if(Xa[Ks+$a]!=null){Ks+=$a;break}if(Xa[Ks-$a]!=null){Ks-=$a;break}}ja.push(Ks)}}ma[ma.length-1][1]===hr&&ja.push(Va)}return ja.length?ja:null});let{fillOpacity:Oa}=ns,pa=null,Ka=null;if(Vn.state?.origin){Ss||(Ss=is(qe,jt));const oa=jt[Vn.state.origin.frameIndex],wa=oa?.fields[Vn.state.origin.fieldIndex],La=(0,Ya.Ct)(wa??Vn,oa,jt);if(Fs.indexOf(La)>=0)pa=()=>null,Ka=()=>{};else if(ns.transform===bs.NU.Constant){const ma=Nt.A.paths.linear();pa=(ja,Ia)=>{const va=ja._data,Va=Ht();let Tr=[Va.from.valueOf(),Va.to.valueOf()],Xa=va[Ia].find(Ps=>Ps!=null),kr=[Xa,Xa],hr=va.slice();return hr[0]=Tr,hr[Ia]=kr,ma({...ja,_data:hr},Ia,0,1)}}if(ns.fillBelowTo){const ma=qe.fields.find(Va=>ns.fillBelowTo===Va.name||ns.fillBelowTo===Va.config?.displayNameFromDS||ns.fillBelowTo===(0,Ya.Ct)(Va,qe,jt)),ja=ma?(0,Ya.Ct)(ma,qe,jt):ns.fillBelowTo,Ia=Ss.get(La),va=Ss.get(ja);(0,W.isNumber)(va)&&(0,W.isNumber)(Ia)?(Fn.addBand({series:[Ia,va],fill:void 0}),Oa||(Oa=35)):Oa=0}}let Qr;Ws.id===An.Y.Thresholds&&(Qr=oa=>(0,rn.lz)(Xn.fields[oa],mt).color),Fn.addSeries({pathBuilder:pa,pointsBuilder:Ka,scaleKey:Ns,showPoints:ea,pointsFilter:ba,colorMode:Ws,fillOpacity:Oa,theme:mt,dynamicSeriesColor:Qr,drawStyle:ns.drawStyle,lineColor:ns.lineColor??Gs,lineWidth:ns.lineWidth,lineInterpolation:ns.lineInterpolation,lineStyle:ns.lineStyle,barAlignment:ns.barAlignment,barWidthFactor:ns.barWidthFactor,barMaxWidth:ns.barMaxWidth,pointSize:ns.pointSize,spanNulls:ns.spanNulls||!1,show:!ns.hideFrom?.viz,gradientMode:ns.gradientMode,thresholds:Os.thresholds,hardMin:Vn.config.min,hardMax:Vn.config.max,softMin:ns.axisSoftMin,softMax:ns.axisSoftMax,dataFrameFieldIndex:Vn.state?.origin}),ns.thresholdsStyle&&Os.thresholds&&(ns.thresholdsStyle.mode??bs.Ly.Off)!==bs.Ly.Off&&Fn.addThresholds({config:ns.thresholdsStyle,thresholds:Os.thresholds,scaleKey:Ns,theme:mt,hardMin:Vn.config.min,hardMax:Vn.config.max,softMin:ns.axisSoftMin,softMax:ns.axisSoftMax})}let js=(0,Js.ro)(qe);Fn.setStackingGroups(js),fn?.forEach(ds=>{Ss||(Ss=is(qe,jt));let Vn={};for(let Os in ds.fieldMap){let ns=ds.fieldMap[Os];Vn[Os]=Ss.get(ns)}ds.init(Fn,Vn)}),Fn.scaleKeys=[Zn,Ds];const Es=15;let Ms={dataIdx:(ds,Vn,Os,ns)=>{let Bs=ds.data[Vn];if(Bs[Os]==null){let Ns=null,Ws=null,Is;for(Is=Os;Ns==null&&Is-- >0;)Bs[Is]!=null&&(Ns=Is);for(Is=Os;Ws==null&&Is++<Bs.length;)Bs[Is]!=null&&(Ws=Is);let Gs=ds.data[0],ea=ds.valToPos(ns,"x"),ba=Ws==null?1/0:ds.valToPos(Gs[Ws],"x"),Oa=Ns==null?-1/0:ds.valToPos(Gs[Ns],"x"),pa=ea-Oa,Ka=ba-ea;pa<=Ka?pa<=Es&&(Os=Ns):Ka<=Es&&(Os=Ws)}return Os}};return kt&&kt()!==en.y.Off&&(Ms.sync={key:Pn,scales:[Zn,null]}),Fn.setCursor(Ms),Fn};function is(qe,mt){const bt=new Map;return qe.fields.forEach((Ht,kt)=>{const jt=Ht.state?.origin;if(jt){const fn=mt[jt.frameIndex]?.fields[jt.fieldIndex];fn&&bt.set((0,Ya.Ct)(fn,mt[jt.frameIndex],mt),kt)}}),bt}const Us=["legend","options","theme"];class Qs extends o.Component{constructor(){super(...arguments),this.prepConfig=(mt,bt,Ht)=>{const{sync:kt}=this.context,{theme:jt,timeZone:fn,renderers:ln,tweakAxis:Mn,tweakScale:Pn}=this.props;return ys({frame:mt,theme:jt,timeZones:Array.isArray(fn)?fn:[fn],getTimeRange:Ht,sync:kt,allFrames:bt,renderers:ln,tweakScale:Pn,tweakAxis:Mn})},this.renderLegend=mt=>{const{legend:bt,frames:Ht}=this.props;return!mt||bt&&!bt.showLegend||!(0,fo.t)(mt,Ht)?null:(0,r.jsx)(fo.$,{data:Ht,config:mt,...bt})}}static{this.contextType=Wt.e4}render(){return(0,r.jsx)(At,{...this.props,prepConfig:this.prepConfig,propsToDiff:Us,renderLegend:this.renderLegend})}}const ga=(0,S.cV)(Qs);ga.displayName="TimeSeries";const xs=(0,o.createContext)({}),aa=()=>{const{data:qe,dimFields:mt,mapSeriesIndexToDataFrameFieldIndex:bt}=(0,o.useContext)(xs),Ht=(0,o.useCallback)(()=>{const kt=mt.x;let jt=null;for(let fn=0;fn<qe.fields.length;fn++)if(kt(qe.fields[fn],qe,[qe])){jt=qe.fields[fn];break}return jt},[qe,mt]);return{dimFields:mt,mapSeriesIndexToDataFrameFieldIndex:bt,getXAxisField:Ht,alignedData:qe}},rr=5,ua=qe=>qe!=null&&!qe.ctrlKey&&!qe.metaKey,Ca=({onZoom:qe,config:mt,withZoomY:bt=!1})=>((0,o.useLayoutEffect)(()=>{let Ht=!1,kt=!1;bt&&mt.addHook("init",jt=>{jt.over.addEventListener("mousedown",fn=>{if(ua(fn)&&fn.button===0&&fn.shiftKey){kt=!0,jt.cursor.drag.x=!1,jt.cursor.drag.y=!0;let ln=Mn=>{jt.cursor.drag.x=!0,jt.cursor.drag.y=!1,document.removeEventListener("mouseup",ln,!0)};document.addEventListener("mouseup",ln,!0)}},!0)}),mt.addHook("setSelect",jt=>{const fn=jt.scales.x.ori===0;if(ua(jt.cursor.event)){if(bt&&kt){if(jt.select.height>=rr){for(let ln in jt.scales)if(ln!=="x"){const Mn=fn?jt.posToVal(jt.select.top,ln):jt.posToVal(jt.select.left+jt.select.width,ln),Pn=fn?jt.posToVal(jt.select.top+jt.select.height,ln):jt.posToVal(jt.select.left,ln);jt.setScale(ln,{min:Pn,max:Mn})}Ht=!0}kt=!1}else if(jt.select.width>=rr){const ln=fn?jt.posToVal(jt.select.left,"x"):jt.posToVal(jt.select.top+jt.select.height,"x"),Mn=fn?jt.posToVal(jt.select.left+jt.select.width,"x"):jt.posToVal(jt.select.top,"x");qe({from:ln,to:Mn}),Ht=!1}}jt.setSelect({left:0,width:0,top:0,height:0},!1)}),mt.setCursor({bind:{dblclick:jt=>()=>{if(!ua(jt.cursor.event))return null;if(bt&&Ht){for(let fn in jt.scales)fn!=="x"&&jt.setScale(fn,{min:null,max:null});Ht=!1}else{let fn=jt.scales.x;const ln=fn.min,Mn=fn.max,Pn=(Mn-ln)/2;qe({from:ln-Pn,to:Mn+Pn})}return null}}})},[mt,qe,bt]),null);var la=e(1604),br=e(6562);const ll=10,Dl=({mode:qe=bs.$N.Single,sortOrder:mt=bs.xB.None,sync:bt,timeZone:Ht,config:kt,renderTooltip:jt,...fn})=>{const ln=(0,o.useRef)(),Mn=(0,S.$j)(),[Pn,Fn]=(0,o.useState)(null),[Xn,Kn]=(0,o.useState)(null),[Zn,Ds]=(0,o.useState)([]),[Ts,gs]=(0,o.useState)(null),[Fs,Ss]=(0,o.useState)(!1),js=(0,la.A)();let Es=null;const Ms=(0,S.of)(Tl);if((0,o.useLayoutEffect)(()=>{let Bs;const Ns=()=>{js()&&(Ss(!0),ln.current?.root.classList.add("plot-active"))},Ws=()=>{js()&&(gs(null),Ss(!1),ln.current?.root.classList.remove("plot-active"))};return kt.addHook("syncRect",(Is,Gs)=>Bs=Gs),kt.addHook("init",Is=>{ln.current=Is,Is.over.addEventListener("mouseenter",Ns),Is.over.addEventListener("mouseleave",Ws),Es=Is.root.closest("[tabindex]"),Es&&(Es.addEventListener("focus",Ns),Es.addEventListener("blur",Ws)),bt&&bt()===en.y.Crosshair&&Is.root.classList.add("shared-crosshair")}),kt.addHook("setLegend",Is=>{js()&&(Kn(Is.legend.idx),Ds(Is.legend.idxs.slice()))}),kt.addHook("setCursor",Is=>{if(!Bs||!js())return;const{x:Gs,y:ea}=bl(Is,Bs);gs(Gs!==void 0&&ea!==void 0?{x:Gs,y:ea}:null)}),kt.addHook("setSeries",(Is,Gs)=>{js()&&Fn(Gs)}),()=>{gs(null),ln.current&&(ln.current.over.removeEventListener("mouseleave",Ws),ln.current.over.removeEventListener("mouseenter",Ns),Es&&(Es.removeEventListener("focus",Ns),Es.removeEventListener("blur",Ws)))}},[kt,gs,Ss,Kn,Ds]),Xn===null||!Fs&&bt&&bt()===en.y.Crosshair)return null;let ds=fn.data.fields[0];if(!ds)return null;const Vn=ds.display||(0,_t.J)({field:ds,timeZone:Ht,theme:Mn});let Os=null,ns=Vn(ds.values[Xn]).text;if(jt)Os=jt(fn.data,Pn,Xn);else{if(qe===bs.$N.Single&&Pn!==null){const Bs=fn.data.fields[Pn];if(!Bs)return null;const Ns=Zn?.[Pn]??Xn;ns=Vn(ds.values[Ns]).text;const Is=(Bs.display||(0,_t.J)({field:Bs,timeZone:Ht,theme:Mn}))(Bs.values[Ns]);Os=(0,r.jsx)(Ct.o,{series:[{color:Is.color||An.F,label:(0,Ya.Ct)(Bs,fn.data,fn.frames),value:Is?(0,ka.cN)(Is):null}],timestamp:ns})}if(qe===bs.$N.Multi){let Bs=[];const Ns=fn.data,Ws=Ns.fields,Is=[];for(let Gs=0;Gs<Ws.length;Gs++){const ea=Ns.fields[Gs];if(!ea||ea===ds||ea.type===Fa.PU.time||ea.type!==Fa.PU.number||ea.config.custom?.hideFrom?.tooltip||ea.config.custom?.hideFrom?.viz)continue;const ba=fn.data.fields[Gs].values[Zn[Gs]],Oa=ea.display(ba);Is.push(ba),Bs.push({color:Oa.color||An.F,label:(0,Ya.Ct)(ea,Ns,fn.frames),value:Oa?(0,ka.cN)(Oa):null,isActive:Pn===Gs})}if(mt!==bs.xB.None){const Gs=[...Bs],ea=br.sortValues(mt);Bs.sort((ba,Oa)=>{const pa=Gs.indexOf(ba),Ka=Gs.indexOf(Oa);return ea(Is[pa],Is[Ka])})}Os=(0,r.jsx)(Ct.o,{series:Bs,timestamp:ns})}}return(0,r.jsx)(k.ZL,{className:Fs?Ms.tooltipWrapper:void 0,children:Os&&Ts&&(0,r.jsx)(an.o,{position:{x:Ts.x,y:Ts.y},offset:{x:ll,y:ll},children:Os})})};function Cl({left:qe,top:mt},bt){return qe===void 0||mt===void 0?!1:qe<0||qe>bt.width||mt<0||mt>bt.height}function bl(qe,mt){let bt,Ht;const kt=qe.cursor.left||0,jt=qe.cursor.top||0;if(Cl(qe.cursor,mt)){const fn=qe.posToIdx(kt);if(jt<0||jt>mt.height){let ln=(0,Js.sw)(qe,fn);ln&&(Ht=mt.top+ln,kt>=0&&kt<=mt.width&&(bt=mt.left+qe.valToPos(qe.data[0][qe.posToIdx(kt)],qe.series[0].scale)))}}else bt=mt.left+kt,Ht=mt.top+jt;return{x:bt,y:Ht}}const Tl=qe=>({tooltipWrapper:(0,P.css)({"z-index":qe.zIndex.portal+1+" !important"})});var Sl=e(79592);const Ml={SecretFormField:V.L,FormField:t.z,Select:B,AsyncSelect:F,IndicatorsContainer:x,NoOptionsMessage:c,Input:n.p,Switch:N}},87579:(q,j,e)=>{"use strict";e.d(j,{Z:()=>c});var t=e(74848),n=e(96540),r=e(36613),a=e(7257);function i(d,u){return u.width===d.width&&u.height===d.height}function x(d,u){return u.data===d.data}function s(d,u){return u.config===d.config}class c extends n.Component{constructor(u){super(u),this.plotContainer=(0,n.createRef)(),this.plotCanvasBBox=(0,n.createRef)(),this.plotInstance=null}reinitPlot(){let{width:u,height:g,plotRef:o}=this.props;if(this.plotInstance?.destroy(),u===0&&g===0)return;this.props.config.addHook("setSize",f=>{f.over});const E={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,a.uY)("UPlot",!1,"Reinitializing plot",E);const m=new r.A(E,this.props.data,this.plotContainer.current);o&&o(m),this.plotInstance=m}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.plotInstance?.destroy()}componentDidUpdate(u){i(u,this.props)?s(u,this.props)?x(u,this.props)||this.plotInstance?.setData(this.props.data):this.reinitPlot():this.plotInstance?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},31376:(q,j,e)=>{"use strict";e.d(j,{$:()=>g,t:()=>u});var t=e(74848),n=e(96540),r=e(23570),a=e(18752),i=e(7500),x=e(29675),s=e(85832),c=e(43987),d=e(7257);function u(o,E){return o.getSeries().some(m=>{const f=m.props.dataFrameFieldIndex;if(!f)return!1;const p=E[f.frameIndex]?.fields[f.fieldIndex];return!(!p||p.config.custom?.hideFrom?.legend)})}const g=(0,n.memo)(({data:o,config:E,placement:m,calcs:f,displayMode:p,...h})=>{const D=(0,x.$j)(),C=E.getSeries().map(l=>{const v=l.props,y=v.dataFrameFieldIndex,P=E.getAxisPlacement(l.props.scaleKey);if(!y)return;const b=o[y.frameIndex]?.fields[y.fieldIndex];if(!b||b.config.custom?.hideFrom?.legend)return;const S=(0,r.Ct)(b,o[y.frameIndex],o),O=(0,a.lz)(b,D).color;return{disabled:!(v.show??!0),fieldIndex:y,color:O,label:S,yAxis:P===i.vM.Left||P===i.vM.Bottom?1:2,getDisplayValues:()=>(0,d.UO)(f,b,D),getItemKey:()=>`${S}-${y.frameIndex}-${y.fieldIndex}`,lineStyle:v.lineStyle}}).filter(l=>l!==void 0);return(0,t.jsx)(s.KU.Legend,{placement:m,...h,children:(0,t.jsx)(c.t,{placement:m,items:C,displayMode:p,sortBy:h.sortBy,sortDesc:h.sortDesc,isSortable:!0})})});g.displayName="PlotLegend"},97988:(q,j,e)=>{"use strict";e.d(j,{t:()=>n});var t=e(7500);const n={drawStyle:[{label:"Lines",value:t.GR.Line},{label:"Bars",value:t.GR.Bars},{label:"Points",value:t.GR.Points}],lineInterpolation:[{description:"Linear",value:t.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:t.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:t.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:t.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:t.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:t.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:t.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:t.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:t.yL.Always},{label:"Never",value:t.yL.Never}],axisPlacement:[{label:"Auto",value:t.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:t.vM.Left},{label:"Right",value:t.vM.Right},{label:"Hidden",value:t.vM.Hidden}],fillGradient:[{label:"None",value:t.on.None},{label:"Opacity",value:t.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:t.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:t.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:t.gs.None},{label:"Normal",value:t.gs.Normal},{label:"100%",value:t.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:t.Ly.Off},{label:"As lines",value:t.Ly.Line},{label:"As lines (dashed)",value:t.Ly.Dashed},{label:"As filled regions",value:t.Ly.Area},{label:"As filled regions and lines",value:t.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:t.Ly.DashedAndArea}]}},73627:(q,j,e)=>{"use strict";e.d(j,{Zj:()=>h,pi:()=>d,zH:()=>p});var t=e(59141),n=e(12936),r=e(90168),a=e(88090),i=e(7500),x=e(91371),s=e(16669),c=e(66786);const d=12,u=150,g=30,o=15,E=40,m=18,f=8;class p extends s.R{merge(P){this.props.size=(0,c.Y)("max",this.props.size,P.size),this.props.label||(this.props.label=P.label),this.props.placement===i.vM.Auto&&(this.props.placement=P.placement)}getConfig(){let{scaleKey:P,label:b,show:S=!0,placement:M=i.vM.Auto,grid:O={show:!0},ticks:R,space:L,filter:B,gap:F=5,formatValue:I,splits:U,values:W,incrs:A,isTime:N,timeZone:K,theme:V,tickLabelRotation:T,size:z,color:w,border:H,decimals:G,distr:X=i.L4.Linear}=this.props;const k=`${d}px ${V.typography.fontFamily}`,_=V.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,t.j9)(P)&&(U=[0,1]),G===0&&X===i.L4.Linear&&(B=(J,Z)=>Z.map(te=>Number.isInteger(te)?te:null));let ee={scale:P,show:S,stroke:w??V.colors.text.primary,side:v(M),font:k,size:z??((J,Z,te)=>l(J,Z,te)),rotate:T,gap:F,labelGap:0,grid:{show:O.show,stroke:_,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:H?.show?w??V.colors.text.primary:_,width:1/devicePixelRatio,size:4},R),splits:U,values:W,space:L??((J,Z,te,ae,re)=>C(J,Z,te,ae,re,I)),filter:B,incrs:A};return H?.show&&(ee.border={stroke:w??V.colors.text.primary,width:1/devicePixelRatio,...H}),b!=null&&b.length>0&&(ee.label=b,ee.labelSize=d+f,ee.labelFont=k,ee.labelGap=f),W?ee.values=W:N?ee.values=D:I&&(ee.values=(J,Z,te,ae,re)=>{let ne=(0,n.E)((0,n.h)(re,6));return Z.map(ce=>ce==null?null:I(ce,ne>0?ne:void 0))}),ee.timeZone=K,ee}}const h={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function D(y,P,b,S,M){const O=y.axes[b],R="timeZone"in O&&typeof O.timeZone=="string"?O.timeZone:void 0,L=y.scales.x,B=(L?.max??0)-(L?.min??0),F=Math.round(h.year/h.day)*h.day,I=Math.round(M/h.day)*h.day;let U=r.WC.interval.year;return M<h.second?U=r.WC.interval.millisecond:M<=h.minute?U=r.WC.interval.second:B<=h.day?U=r.WC.interval.minute:M<=h.day?U=r.WC.interval.hour:B<h.year?U=r.WC.interval.day:I===F?U=r.WC.interval.year:M<=h.year&&(U=r.WC.interval.month),P.map(W=>W==null?"":(0,a.LE)(W,{format:U,timeZone:R}))}function C(y,P,b,S,M,O){const R=y.axes[P],L=y.scales[R.scale];if(R.side!==2||!L)return M<=u?o:g;const B=M/E,F=(S-b)/B,I=Math.max(Math.abs(b),Math.abs(S));let U="";if(L.time)U=D(y,[I],P,E,F)[0];else if(O!=null)U=O(I);else return E;return(0,x.kD)(U,d).width+m}function l(y,P,b){const S=y.axes[b];let M=S.ticks.size;if(S.side===2)M+=S.gap+d;else if(P?.length){let O=P.reduce((L,B)=>Math.max(L,(0,x.kD)(B,d).width),0);const R=Math.min(y.width*.4,O);M+=S.gap+S.labelGap+R}return Math.ceil(M)}function v(y){switch(y){case i.vM.Top:return 0;case i.vM.Right:return 1;case i.vM.Bottom:return 2;case i.vM.Left:}return 3}},5858:(q,j,e)=>{"use strict";e.d(j,{e:()=>l});var t=e(2543),n=e(36613),r=e(55801),a=e(58064),i=e(7500),x=e(7257),s=e(73627),c=e(66786),d=e(62931),u=e(87190),g=e(16669),o=e(5077);class E extends g.R{getConfig(){const{facets:y,drawStyle:P,pathBuilder:b,pointsBuilder:S,pointsFilter:M,lineInterpolation:O,lineWidth:R,lineStyle:L,barAlignment:B,barWidthFactor:F,barMaxWidth:I,showPoints:U,pointSize:W,scaleKey:A,pxAlign:N,spanNulls:K,show:V=!0}=this.props;let T={},z=this.getLineColor();T.stroke=z,T.width=R,L&&L.fill!=="solid"&&(L.fill==="dot"&&(T.cap="round"),T.dash=L.dash??[10,10]),b!=null?T.paths=b:P===i.GR.Points?T.paths=()=>null:P!=null&&(T.paths=(G,X,k,_)=>f(P,O,B,F,I)(G,X,k,_));const w=typeof z=="string"?z:(G,X)=>G.series[X]._stroke,H={points:{stroke:w,fill:w,size:!W||W<R?void 0:W,filter:M}};return S!=null?H.points.show=S:P===i.GR.Points?H.points.show=!0:U===i.yL.Auto?P===i.GR.Bars&&(H.points.show=!1):U===i.yL.Never?H.points.show=!1:U===i.yL.Always&&(H.points.show=!0),{scale:A,facets:y,spanGaps:typeof K=="number"?!1:K,value:()=>"",pxAlign:N,show:V,fill:this.getFill(),...T,...H}}getLineColor(){const{lineColor:y,gradientMode:P,colorMode:b,thresholds:S,theme:M,hardMin:O,hardMax:R,softMin:L,softMax:B,dynamicSeriesColor:F}=this.props;return P===i.on.None&&F?(I,U)=>F(U)??y??d.F:P===i.on.Scheme&&b?.id!==d.Y.Fixed?(0,o.pl)(1,M,b,S,O,R,L,B):P===i.on.Hue?(0,o.B5)(y??d.F,1,M):y??d.F}getFill(){const{lineColor:y,fillColor:P,gradientMode:b,fillOpacity:S,colorMode:M,thresholds:O,theme:R,hardMin:L,hardMax:B,softMin:F,softMax:I,dynamicSeriesColor:U}=this.props;if(P)return P;const W=b??i.on.None,A=(S??0)/100;if(W===i.on.None&&U&&A>0)return(N,K)=>{let V=N.series[K]._stroke;return u.MV.alpha(V??"",A)};switch(W){case i.on.Opacity:return(0,o.WO)(P??y,A);case i.on.Hue:return(0,o.B5)(P??y,A,R);case i.on.Scheme:if(M?.id!==d.Y.Fixed)return(0,o.pl)(A,R,M,O,L,B,F,I);default:if(A>0)return u.MV.alpha(y??"",A)}}}let m;function f(v,y,P=i.Nj.Center,b=.6,S=200){const M=n.A.paths;if(m||(m={linear:M.linear(),smooth:M.spline(),stepBefore:M.stepped({align:-1}),stepAfter:M.stepped({align:1})}),v===i.GR.Bars){let O=`bars|${P}|${b}|${S}`;return m[O]||(m[O]=M.bars({size:[b,S],align:P})),m[O]}else if(v===i.GR.Line){if(y===i.dx.StepBefore)return m.stepBefore;if(y===i.dx.StepAfter)return m.stepAfter;if(y===i.dx.Smooth)return m.smooth}return m.linear}var p=e(84140),h=e(99116);function D(v){const y=v.config.mode===i.Ly.Dashed||v.config.mode===i.Ly.DashedAndArea?[10,10]:[];function P(U,W,A,N){let K=U.ctx,V=0;for(let T=0;T<A.length;T++)if(A[T].color==="transparent"){V=T;break}K.lineWidth=2,K.setLineDash(y);for(let T=1;T<A.length;T++){const z=A[T];let w;V>=T&&T>0?w=(0,p.A)(N.visualization.getColorByName(A[T-1].color)):w=(0,p.A)(N.visualization.getColorByName(z.color)),w.getAlpha()===1&&w.setAlpha(.7);const H=U.scales.x.ori===i.Lt.Horizontal,G=U.valToPos(z.value,W,!0);let X=Math.round(H?U.bbox.left:G),k=Math.round(H?G:U.bbox.top),_=Math.round(H?U.bbox.left+U.bbox.width:G),ee=Math.round(H?G:U.bbox.top+U.bbox.height);K.beginPath(),K.moveTo(X,k),K.lineTo(_,ee),K.strokeStyle=w.toString(),K.stroke()}}function b(U,W,A,N){let K=U.ctx,V=(0,o.Z8)(U,W,A.map(T=>{let z=(0,p.A)(N.visualization.getColorByName(T.color));return z.getAlpha()===1&&z.setAlpha(.15),[T.value,z.toString()]}),!0);K.fillStyle=V,K.fillRect(U.bbox.left,U.bbox.top,U.bbox.width,U.bbox.height)}const{scaleKey:S,thresholds:M,theme:O,config:R,hardMin:L,hardMax:B,softMin:F,softMax:I}=v;return U=>{const W=U.ctx,{min:A,max:N}=U.scales.x,{min:K,max:V}=U.scales[S];if(A==null||N==null||K==null||V==null)return;let{steps:T,mode:z}=M;if(z===h.O.Percentage){let[w,H]=(0,o.EJ)(U,S,L,B,F,I),G=H-w;T=T.map(X=>({...X,value:w+G*(X.value/100)}))}switch(W.save(),R.mode){case i.Ly.Line:case i.Ly.Dashed:P(U,S,T,O);break;case i.Ly.Area:b(U,S,T,O);break;case i.Ly.LineAndArea:case i.Ly.DashedAndArea:b(U,S,T,O),P(U,S,T,O)}W.restore()}}const C={drag:{setScale:!1},points:{size:(v,y)=>v.series[y].points.size*2,width:(v,y,P)=>P/4},focus:{prox:30}};class l{constructor(y=r.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=P=>{let b=new Date(P);return this.tz?n.A.tzDate(b,this.tz):b},this.tz=(0,a.QZ)(y,Date.now())?.ianaName}addHook(y,P){(0,x.uY)("UPlotConfigBuilder",!1,"addHook",y),this.hooks[y]||(this.hooks[y]=[]),this.hooks[y].push(P)}addThresholds(y){this.thresholds[y.scaleKey]||(this.thresholds[y.scaleKey]=y,this.addHook("drawClear",D(y)))}addAxis(y){y.placement=y.placement??i.vM.Auto,y.grid=y.grid??{};let P=y.scaleKey;if(P==="x"&&(P+=y.timeZone??""),this.axes[P]){this.axes[P].merge(y);return}y.placement===i.vM.Auto&&(y.placement=this.hasLeftAxis?i.vM.Right:i.vM.Left),y.placement===i.vM.Left&&(this.hasLeftAxis=!0),y.placement===i.vM.Hidden&&(y.grid.show=!1,y.size=0),this.axes[P]=new s.zH(y)}getAxisPlacement(y){return this.axes[y]?.props.placement??i.vM.Left}setCursor(y){this.cursor=(0,t.merge)({},this.cursor,y)}setMode(y){this.mode=y}setSelect(y){this.select=y}addSeries(y){this.series.push(new E(y))}getSeries(){return this.series}addScale(y){const P=this.scales.find(b=>b.props.scaleKey===y.scaleKey);if(P){P.merge(y);return}this.scales.push(new c.G(y))}addBand(y){this.bands.push(y)}setStackingGroups(y){this.stackingGroups=y}getStackingGroups(){return this.stackingGroups}setPrepData(y){this.prepData=P=>(this.frames=P,y(P,this.getStackingGroups()))}setPadding(y){this.padding=y}getConfig(){if(this.cachedConfig)return this.cachedConfig;const y={...x.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};y.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(b=>b.getConfig()),y.series=[...y.series,...this.series.map(b=>b.getConfig())],y.scales=this.scales.reduce((b,S)=>({...b,...S.getConfig()}),{}),y.hooks=this.hooks,y.select=this.select;const P=(b="")=>(S,M)=>{let O=S.series[M].points._stroke;if(typeof O!="string"){let R=this.frames[0].fields[M];O=R.display(R.values[S.cursor.idxs[M]]).color}return O+b};return y.cursor=(0,t.merge)({},C,{points:{stroke:P("80"),fill:P()}},this.cursor),y.tzDate=this.tzDate,Array.isArray(this.padding)&&(y.padding=this.padding),this.stackingGroups.forEach(b=>{(0,x.Tz)(b).forEach(S=>{this.addBand(S)})}),this.bands.length&&(y.bands=this.bands),this.cachedConfig=y,y}ensureNonOverlappingAxes(y){const P=y.find(M=>M.props.scaleKey==="x"),b=y.filter(M=>M.props.grid?.show===void 0),S=b.findIndex(M=>M.props.placement===i.vM.Left||M.props.placement===i.vM.Right||M.props.placement===i.vM.Bottom&&M!==P);for(let M=0;M<b.length;M++)b[M]===P||M===S?b[M].props.grid.show=!0:b[M].props.grid.show=!1;return y}}},66786:(q,j,e)=>{"use strict";e.d(j,{G:()=>x,Y:()=>s});var t=e(36613),n=e(27844),r=e(59141),a=e(7500),i=e(16669);class x extends i.R{merge(d){this.props.min=s("min",this.props.min,d.min),this.props.max=s("max",this.props.max,d.max)}getConfig(){let{isTime:d,scaleKey:u,min:g,max:o,softMin:E,softMax:m,range:f,direction:p,orientation:h,centeredZero:D,decimals:C,stackingMode:l}=this.props;l===a.gs.Percent&&(g==null&&E==null&&(E=0),o==null&&m==null&&(m=1));const v=this.props.distribution,y=d?{}:{distr:v===a.L4.Symlog?4:v===a.L4.Log?3:v===a.L4.Ordinal?2:1,log:v===a.L4.Log||v===a.L4.Symlog?this.props.log??2:void 0,asinh:v===a.L4.Symlog?this.props.linearThreshold??1:void 0};if(v===a.L4.Log){let F=this.props.log,I=F===2?Math.log2:Math.log10;g!=null&&(g<=0?g=null:g=F**Math.floor(I(g))),o!=null&&(o<=0?o=null:o=F**Math.ceil(I(o))),E!=null&&(E<=0?E=null:E=F**Math.floor(I(E))),m!=null&&(m<=0?m=null:m=F**Math.ceil(I(m)))}let P=E==null?3:1,b=m==null?3:1;const S={min:{pad:.1,hard:g??-1/0,soft:E||0,mode:P},max:{pad:.1,hard:o??1/0,soft:m||0,mode:b}};let M=E==null&&g!=null,O=m==null&&o!=null,R=M&&O;const L=(F,I,U,W)=>{const A=F.scales[W];let N=[I,U];if(!R&&I==null&&U==null)return N;let K=A.log??10;if(A.distr===1||A.distr===2||A.distr===4){if(D){let V=Math.abs(I),T=Math.abs(U),z=Math.max(V,T);z===0&&(z=80),I=-z,U=z}A.distr===4?N=t.A.rangeAsinh(I,U,K,!0):N=t.A.rangeNum(M?g:I,O?o:U,S)}else A.distr===3&&(N=t.A.rangeLog(g??I,o??U,K,!0));if(C===0)if(A.distr===1||A.distr===2)N[0]=(0,n.rs)(N[0],1),N[1]=(0,n.Uh)(N[1],1);else if(A.distr===3){let V=A.log===2?Math.log2:Math.log10;if(N[0]<=1)N[0]=1;else{let z=Math.floor(V(N[0]));N[0]=K**z}let T=Math.ceil(V(N[1]));N[1]=K**T,N[0]===N[1]&&(N[1]*=K)}else A.distr===4&&(N[0]=(0,n.rs)(N[0],1),N[1]=(0,n.Uh)(N[1],1));return(A.distr===1||A.distr===4)&&(M&&(N[0]=g),O&&(N[1]=o)),N[0]>=N[1]&&(N[0]=A.distr===3?1:0,N[1]=100),N};let B=!d&&!R;return(0,r.j9)(u)&&(B=!1,f=[0,1]),{[u]:{time:d,auto:B,range:f??L,dir:p,ori:h,...y}}}}function s(c,d,u){const g=d!=null,o=u!=null;return g?o?c==="min"?d<u?d:u:d>u?d:u:d:u}},5077:(q,j,e)=>{"use strict";e.d(j,{B5:()=>d,EJ:()=>E,WO:()=>c,Z8:()=>g,pl:()=>f});var t=e(84140),n=e(87190),r=e(62931),a=e(99116),i=e(7500),x=e(91371);function s(p,h,D){let C=0,l=0,v=0,y=0;return p===3?(l=h.top,y=h.top+h.height):p===2?(C=h.left+h.width,v=h.left):p===1?(l=h.top+h.height,y=h.top):p===0&&(C=h.left,v=h.left+h.width),D.createLinearGradient(C,l,v,y)}function c(p,h){return(D,C)=>{const l=(0,x.Yc)(),v=s(D.scales.x.ori===i.Lt.Horizontal?3:2,D.bbox,l);return v.addColorStop(0,n.MV.alpha(p,h)),v.addColorStop(1,n.MV.alpha(p,0)),v}}function d(p,h,D){return(C,l)=>{const v=(0,x.Yc)(),y=s(C.scales.x.ori===i.Lt.Horizontal?3:2,C.bbox,v),P=(0,t.A)(p).spin(-25).darken(5),b=(0,t.A)(p).saturate(20).spin(20).brighten(10);return D.isDark?(y.addColorStop(0,b.lighten(10).setAlpha(h).toString()),y.addColorStop(1,P.darken(10).setAlpha(h).toString())):(y.addColorStop(0,b.lighten(10).setAlpha(h).toString()),y.addColorStop(1,P.setAlpha(h).toString())),y}}var u=(p=>(p[p.Right=0]="Right",p[p.Up=1]="Up",p[p.Left=2]="Left",p[p.Down=3]="Down",p))(u||{});function g(p,h,D,C=!1){let l=p.scales[h],v=null,y=null;for(let A=0;A<D.length;A++){let N=D[A][0];if((N<=l.min||v==null)&&(v=A),y=A,N>=l.max)break}if(v===y)return D[v][1];let P=D[v][0],b=D[y][0];P===-1/0&&(P=l.min),b===1/0&&(b=l.max);let S=Math.round(p.valToPos(P,h,!0)),M=Math.round(p.valToPos(b,h,!0)),O=S-M;if(O===0)return D[y][1];let R,L,B,F;p.scales.x.ori===i.Lt.Horizontal?(R=B=0,L=S,F=M):(L=F=0,R=S,B=M);let U=(0,x.Yc)().createLinearGradient(R,L,B,F),W;for(let A=v;A<=y;A++){let N=D[A],K=A===v?S:A===y?M:Math.round(p.valToPos(N[0],h,!0)),V=(S-K)/O;C&&A>v&&U.addColorStop(V,W),U.addColorStop(V,W=N[1])}return U}function o(p,h){let D=p.scales[h],C=1/0,l=-1/0;return p.series.forEach((v,y)=>{if(v.show&&v.scale===h)if(v.min==null){let P=p.data[y];for(let b=0;b<P.length;b++)P[b]!=null&&(C=Math.min(C,P[b]),l=Math.max(l,P[b]))}else C=Math.min(C,v.min),l=Math.max(l,v.max)}),l===C&&(C=D.min,l=D.max),[C,l]}function E(p,h,D,C,l,v){let y=D??l??null,P=C??v??null;if(y==null||P==null){let[b,S]=o(p,h);y=y??b??0,P=P??S??100}return[y,P]}function m(p){return p==="transparent"||p[0]==="#"&&p.slice(-2)==="00"}function f(p,h,D,C,l,v,y,P){if(!D)throw Error("Missing colorMode required for color scheme gradients");if(!C)throw Error("Missing thresholds required for color scheme gradients");return(b,S)=>{let M=b.series[S].scale,O="";if(D.id===r.Y.Thresholds)if(C.mode===a.O.Absolute){const R=C.steps.map(L=>[L.value,m(L.color)?"#0000":n.MV.alpha(h.visualization.getColorByName(L.color),p)]);O=g(b,M,R,!0)}else{const[R,L]=E(b,M,l,v,y,P),B=L-R,F=C.steps.map(I=>[R+B*(I.value/100),n.MV.alpha(h.visualization.getColorByName(I.color),p)]);O=g(b,M,F,!0)}else if(D.getColors){const R=D.getColors(h),[L,B]=E(b,M,l,v,y,P),F=B-L,I=R.map((U,W)=>[L+F*(W/(R.length-1)),n.MV.alpha(h.visualization.getColorByName(U),p)]);O=g(b,M,I,!1)}return O}}},86932:(q,j,e)=>{"use strict";e.d(j,{a:()=>x});var t=e(74848),n=e(96540),r=e(1604),a=e(44625),i=e(2762);function x({id:s,events:c,renderEventMarker:d,mapEventToXYCoords:u,config:g}){const o=(0,n.useRef)(),[E,m]=(0,n.useState)(0),f=(0,r.A)();(0,n.useLayoutEffect)(()=>{g.addHook("init",h=>{o.current=h}),g.addHook("draw",()=>{f()&&m(h=>h+1)})},[g,m]);const p=(0,n.useMemo)(()=>{const h=[];if(!o.current||c.length===0)return h;for(let D=0;D<c.length;D++){const C=c[D];for(let l=0;l<C.length;l++){const v=u(C,{fieldIndex:l,frameIndex:D});v&&h.push((0,n.createElement)(a.p,{...v,key:`${s}-marker-${D}-${l}`},d(C,{fieldIndex:l,frameIndex:D})))}}return(0,t.jsx)(t.Fragment,{children:h})},[c,d,E]);return o.current?(0,t.jsx)(i._,{left:o.current.bbox.left/window.devicePixelRatio,top:o.current.bbox.top/window.devicePixelRatio,children:p}):null}},44625:(q,j,e)=>{"use strict";e.d(j,{p:()=>n});var t=e(74848);const n=({x:r,y:a,children:i})=>(0,t.jsx)("div",{style:{position:"absolute",top:`${a}px`,left:`${r}px`},children:i})},2762:(q,j,e)=>{"use strict";e.d(j,{_:()=>a});var t=e(74848),n=e(22803),r=e(96540);const a=({children:i,left:x,top:s})=>{const c=(0,r.useMemo)(()=>(0,n.css)({position:"absolute",overflow:"visible",left:`${x}px`,top:`${s}px`}),[x,s]);return(0,t.jsx)("div",{className:c,children:i})}},24415:(q,j,e)=>{"use strict";e.d(j,{M:()=>r});var t=e(7500),n=e(16669);function r(i,x){const s="na",c=`${i.min!==void 0?i.min:s}-${i.max!==void 0?i.max:s}`,d=`${i.custom?.axisSoftMin!==void 0?i.custom.axisSoftMin:s}-${i.custom?.axisSoftMax!==void 0?i.custom.axisSoftMax:s}`,u=`${i.custom?.axisPlacement!==void 0?i.custom?.axisPlacement:t.vM.Auto}`,g=i.unit??n.s,o=i.custom?.scaleDistribution?a(i.custom.scaleDistribution):t.L4.Linear,E=i.custom?.axisLabel?i.custom.axisLabel:s;return`${g}/${c}/${d}/${u}/${o}/${E}/${x}`}function a(i){return i.type===t.L4.Log?`${i.type}${i.log}`:i.type}},55209:(q,j,e)=>{"use strict";e.d(j,{J:()=>i});var t=e(74848),n=e(22803),r=e(99764),a=e(29675);const i=({onClick:s,"aria-label":c,style:d})=>{const u=(0,a.of)(x);return(0,t.jsx)(r.K,{"aria-label":c??"Close",className:u,name:"times",onClick:s,style:d})},x=s=>(0,n.css)({position:"absolute",margin:"0px",right:5,top:6})},72778:(q,j,e)=>{"use strict";e.d(j,{K:()=>c});var t=e(2543),n=e.n(t),r=e(96540),a=e(64423),i=e(99165),x=e(35383),s=e(52718);const c=({config:d,eventBus:u,frame:g})=>{const o=(0,r.useRef)(g);return o.current=g,(0,r.useLayoutEffect)(()=>{let E=null;const m={point:{time:null},data:o.current};d.addHook("init",y=>{E=y});let f=null;d.addHook("setSeries",(y,P)=>{f=P}),d.addHook("setLegend",()=>{if(!(E.cursor.event==null)){let P=E.cursor.idxs.find(b=>b!=null);if(P==null)v();else{let b=P,S=f,M=E.data[0]??E.data[1][0];m.point.time=M[b],m.rowIndex=b??void 0,m.columnIndex=S??void 0,m.data=o.current;let O=E.cursor.top;m.point.panelRelY=O===0?.001:O>0?O/E.rect.height:1,l()}}});function p(y){const P=y.payload?.point?.time;if(P){const b=E.valToPos(P,"x");E.setCursor({left:b,top:E.rect.height/2})}}const h=new a.yU,D=new x.b_(m).setTags(["uplot"]),C=new x.ql().setTags(["uplot"]);let l=(0,t.throttle)(()=>{u.publish(D)},100),v=(0,t.throttle)(()=>{u.publish(C)},100);return h.add(u.getStream(x.b_).subscribe({next:y=>{u===y.origin||y.tags?.has("uplot")||p(y)}})),h.add(u.getStream(s.kb).subscribe({next:y=>p(y)})),h.add(u.getStream(x.ql).pipe((0,i.c)(50)).subscribe({next:y=>{u===y.origin||y.tags?.has("uplot")||E.cursor._lock||E.setCursor({left:-10,top:-10})}})),()=>{h.unsubscribe()}},[d]),null}},40923:(q,j,e)=>{"use strict";e.d(j,{Z:()=>c});var t=e(2543),n=e.n(t),r=e(96540);const a=.1,i=2,x=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),s=d=>{let u=d.root,g=new Set,o=null,E=null;if(!u)return;u.tabIndex=0;const m=(v,y)=>{const{cursor:P}=d;if(P.left===void 0||P.top===void 0)return;const{width:b,height:S}=d.over.style,[M,O]=[Math.floor(parseFloat(b)),Math.floor(parseFloat(S))];d.setCursor({left:(0,t.clamp)(P.left+v,0,M),top:(0,t.clamp)(P.top+y,0,O)})},f=v=>{if(g.size===0||!d){E=null;return}const b=(v-(E??v))*a;let S=0,M=0;g.has("ArrowUp")&&(M-=b),g.has("ArrowDown")&&(M+=b),g.has("ArrowLeft")&&(S-=b),g.has("ArrowRight")&&(S+=b),g.has("Shift")&&(S*=i,M*=i),m(S,M);const{cursor:O}=d;if(g.has(" ")&&O){const R=Number(d.over.style.height.slice(0,-2));d.setSelect({left:O.left<o?O.left:o,top:0,width:Math.abs(O.left-(o??O.left)),height:R},!1)}E=v,window.requestAnimationFrame(f)},p=v=>{if(v.key==="Tab"){d.setCursor({left:-5,top:-5});return}if(!x.has(v.key))return;if(v.preventDefault(),v.stopPropagation(),!g.has(v.key)){const P=g.size===0;g.add(v.key),o=v.key===" "&&o===null?d.cursor.left:o,P&&window.requestAnimationFrame(f)}},h=v=>{x.has(v.key)&&(g.delete(v.key),v.key===" "&&(v.preventDefault(),v.stopPropagation(),d.setSelect(d.select),o=null))},D=()=>{if(!u?.matches(":focus-visible"))return;const v=parseFloat(d.over.style.width),y=parseFloat(d.over.style.height);d.setCursor({left:v/2,top:y/2})},C=()=>{E=null,o=null,g.clear(),d.setSelect({left:0,top:0,width:0,height:0},!1)};u.addEventListener("keydown",p),u.addEventListener("keyup",h),u.addEventListener("focus",D),u.addEventListener("blur",C);const l=()=>{u?.removeEventListener("keydown",p),u?.removeEventListener("keyup",h),u?.removeEventListener("focus",D),u?.removeEventListener("blur",C),u=null};(d.hooks.destroy??=[]).push(l)},c=({config:d})=>((0,r.useLayoutEffect)(()=>d.addHook("init",s),[d]),null)},12963:(q,j,e)=>{"use strict";e.d(j,{b3:()=>g,xl:()=>D});var t=e(74848),n=e(22803),r=e(96540),a=e(40961),i=e(13076),x=e(29675),s=e(75606),c=e(55209);const d=void 0,u=10;var g=(l=>(l[l.xOne=0]="xOne",l[l.xAll=1]="xAll",l[l.xyOne=2]="xyOne",l))(g||{});function o(l,v){return{...l,...v,style:{...l.style,...v.style}}}function E(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const m=5,f=l=>l!=null&&!l.ctrlKey&&!l.metaKey,p=()=>[],h=/Android|iPhone|iPad/i.test(navigator.userAgent),D=({config:l,hoverMode:v,render:y,clientZoom:P=!1,queryZoom:b,onSelectRange:S,maxWidth:M,syncMode:O=i.yV.Off,syncScope:R="global",getDataLinks:L=p})=>{const B=(0,r.useRef)(null),F=(0,r.useRef)(null);F.current==null&&(F.current=(0,s.gF)());const[{plot:I,isHovering:U,isPinned:W,contents:A,style:N,dismiss:K},V]=(0,r.useReducer)(o,null,E),T=(0,r.useRef)(),z=(0,x.of)(C,M),w=(0,r.useRef)(y);w.current=y;const H=(0,r.useRef)(L);return H.current=L,(0,r.useLayoutEffect)(()=>{T.current={width:0,height:0,observer:new ResizeObserver(De=>{let Ke=T.current;for(const Ie of De)Ie.borderBoxSize?.length>0?(Ke.width=Ie.borderBoxSize[0].inlineSize,Ke.height=Ie.borderBoxSize[0].blockSize):(Ke.width=Ie.contentRect.width,Ke.height=Ie.contentRect.height)})};let G=!1,X=!1,k=I,_=U,ee=!1,J=W,Z=N,te=!1;const ae=O===i.yV.Tooltip;O!==i.yV.Off&&l.scales[0].props.isTime&&l.setCursor({sync:{key:R,scales:["x",null]}});const re=()=>{de?_=te&&ee&&ae:_=oe!=null||v===1&&ee};let ne=0,ce=0,le=null,he=[],oe=null,de=!1,me=[],Pe=[],Ee=!1,be=!1;const Se=(De=!1)=>{Ee||(_?queueMicrotask(Qe):setTimeout(Qe,100),Ee=!0),De&&(be=!0)},Xe=De=>{B.current.contains(De.target)||we()},Qe=()=>{Ee=!1,be&&(Z={pointerEvents:J?"all":"none"},k.cursor._lock=J,J?(document.addEventListener("mousedown",Xe,!0),document.addEventListener("keydown",Xe,!0)):(document.removeEventListener("mousedown",Xe,!0),document.removeEventListener("keydown",Xe,!0)),be=!1);let De={style:Z,isPinned:J,isHovering:_,contents:_||le!=null?w.current(k,he,oe,J,we,le,de,J?me:oe!=null?Pe[oe]:[]):null,dismiss:we};V(De),le=null},we=()=>{let De=J;J=!1,_=!1,k.setCursor({left:-10,top:-10}),me=[],Se(De)};l.addHook("init",De=>{V({plot:k=De}),P&&De.over.addEventListener("mousedown",Ke=>{if(f(Ke)&&Ke.button===0&&Ke.shiftKey){X=!0,De.cursor.drag.x=!1,De.cursor.drag.y=!0;let Ie=Ne=>{De.cursor.drag.x=!0,De.cursor.drag.y=!1,document.removeEventListener("mouseup",Ie,!0)};document.addEventListener("mouseup",Ie,!0)}},!0),De.over.addEventListener("click",Ke=>{if(Ke.target===De.over){if(Ke.ctrlKey||Ke.metaKey){let Ie;De.scales.x.ori===0?Ie=De.posToVal(De.cursor.left,"x"):Ie=De.posToVal(De.select.top+De.select.height,"x"),le={from:Ie,to:Ie},Se(!1)}else if(_&&!J&&oe!=null){me=H.current(oe,he[oe]);const Ie=me.find(Ne=>Ne.oneClick===!0);Ie!=null?window.open(Ie.href,Ie.target??"_self"):setTimeout(()=>{J=!0,Se(!0)},0)}}})}),l.addHook("setSelect",De=>{const Ke=De.scales.x.ori===0;if(!de&&(P||b!=null))if(f(De.cursor.event)){if(S!=null){let Ie=[];const Ne=!!De.cursor.drag.y,ie=!!De.cursor.drag.x;let ve=null,fe=[];ie&&(ve={from:Ke?De.posToVal(De.select.left,"x"):De.posToVal(De.select.top+De.select.height,"x"),to:Ke?De.posToVal(De.select.left+De.select.width,"x"):De.posToVal(De.select.top,"x")}),Ne&&l.scales.forEach(ge=>{const xe=ge.props.scaleKey;if(xe!=="x"){let je={from:Ke?De.posToVal(De.select.top+De.select.height,xe):De.posToVal(De.select.left+De.select.width,xe),to:Ke?De.posToVal(De.select.top,xe):De.posToVal(De.select.left,xe)};fe.push(je)}}),ie?Ne?Ie=fe.map(ge=>({x:ve,y:ge})):Ie=[{x:ve}]:Ne&&(Ie=fe.map(ge=>({y:ge}))),S(Ie)}else if(P&&X){if(De.select.height>=m){for(let Ie in De.scales)if(Ie!=="x"){const Ne=Ke?De.posToVal(De.select.top,Ie):De.posToVal(De.select.left+De.select.width,Ie),ie=Ke?De.posToVal(De.select.top+De.select.height,Ie):De.posToVal(De.select.left,Ie);De.setScale(Ie,{min:ie,max:Ne})}G=!0}X=!1}else if(b!=null&&De.select.width>=m){const Ie=Ke?De.posToVal(De.select.left,"x"):De.posToVal(De.select.top+De.select.height,"x"),Ne=Ke?De.posToVal(De.select.left+De.select.width,"x"):De.posToVal(De.select.top,"x");b({from:Ie,to:Ne}),G=!1}}else le={from:Ke?De.posToVal(De.select.left,"x"):De.posToVal(De.select.top+De.select.height,"x"),to:Ke?De.posToVal(De.select.left+De.select.width,"x"):De.posToVal(De.select.top,"x")},Se(!0);De.setSelect({left:0,width:0,top:0,height:0},!1)}),(P||b!=null)&&l.setCursor({bind:{dblclick:De=>()=>{if(!f(De.cursor.event))return null;if(P&&G){for(let Ke in De.scales)Ke!=="x"&&De.setScale(Ke,{min:null,max:null});G=!1}else if(b!=null){let Ke=De.scales.x;const Ie=Ke.min,Ne=Ke.max,ie=(Ne-Ie)/2;b({from:Ie-ie,to:Ne+ie})}return null}}}),l.addHook("setData",De=>{G=!1,X=!1,J&&we()}),l.addHook("setSeries",(De,Ke)=>{oe=Ke,de=De.cursor.event==null,re(),Se()}),l.addHook("setLegend",De=>{he=k?.cursor.idxs.slice(),ee=he.some((Ie,Ne)=>Ne>0&&Ie!=null),Pe.length===0&&(Pe=he.map((Ie,Ne)=>{if(Ne>0){const ve=L(Ne,he[Ne]).find(fe=>fe.oneClick===!0);if(ve)return[ve]}return[]})),de=De.cursor.event==null;let Ke=_;re(),(_||_!==Ke)&&Se()});const $e=16;let Fe=0,Te=0;const Le=()=>{_&&!J&&we(),Fe=window.innerWidth-$e,Te=window.innerHeight-$e},Ge=()=>{te=k.rect.bottom<=Te&&k.rect.top>=0&&k.rect.left>=0&&k.rect.right<=Fe};Le(),l.addHook("ready",Ge),l.addHook("setCursor",De=>{if(de=De.cursor.event==null,!_)return;let{left:Ke=-10,top:Ie=-10}=De.cursor;if(Ke>=0||Ie>=0){let Ne=De.rect.left+Ke,ie=De.rect.top+Ie,ve="",{width:fe,height:ge}=T.current;fe+=u,ge+=u,ce!==0?ie+ge<Te||ie-ge<0?ce=0:ce!==-ge&&(ce=-ge):ie+ge>Te&&ie-ge>=0&&(ce=-ge),ne!==0?Ne+fe<Fe||Ne-fe<0?ne=0:ne!==-fe&&(ne=-fe):Ne+fe>Fe&&Ne-fe>=0&&(ne=-fe);const xe=Ne+(ne===0?u:-u),je=ie+(ce===0?u:-u);ve=`translateX(${xe}px) ${ne===0?"":"translateX(-100%)"} translateY(${je}px) ${ce===0?"":"translateY(-100%)"}`,B.current!=null?B.current.style.transform=ve:(Z.transform=ve,Se())}});const Me=De=>{Ge(),_&&De.target instanceof Node&&De.target.contains(k.root)&&we()};return window.addEventListener("resize",Le),window.addEventListener("scroll",Me,!0),()=>{window.removeEventListener("resize",Le),window.removeEventListener("scroll",Me,!0),document.removeEventListener("mousedown",Xe,!0),document.removeEventListener("keydown",Xe,!0)}},[l]),(0,r.useLayoutEffect)(()=>{const G=T.current;if(B.current!=null){G.observer.observe(B.current);const{width:X,height:k}=B.current.getBoundingClientRect();G.width=X,G.height=k;let _=I.cursor.event;if(_!=null){const ee=_.type!=="mousemove"||h;ee&&(_=new MouseEvent("mousemove",{view:window,bubbles:!0,cancelable:!0,clientX:_.clientX,clientY:_.clientY,screenX:_.screenX,screenY:_.screenY})),!(ee?!1:performance.now()-_.timeStamp>16)&&I.over.dispatchEvent(_)}else I.setCursor({left:I.cursor.left,top:I.cursor.top},!0)}else G.width=0,G.height=0},[U]),I&&U?(0,a.createPortal)((0,t.jsxs)("div",{className:(0,n.cx)(z.tooltipWrapper,W&&z.pinned),style:N,"aria-live":"polite","aria-atomic":"true",ref:B,children:[W&&(0,t.jsx)(c.J,{onClick:K}),A]}),F.current):null},C=(l,v)=>({tooltipWrapper:(0,n.css)({top:0,left:0,zIndex:l.zIndex.portal,whiteSpace:"pre",borderRadius:l.shape.radius.default,position:"fixed",background:l.colors.background.elevated,border:`1px solid ${l.colors.border.weak}`,boxShadow:l.shadows.z2,userSelect:"text",maxWidth:v??"none"}),pinned:(0,n.css)({boxShadow:l.shadows.z3})})},16669:(q,j,e)=>{"use strict";e.d(j,{R:()=>n,s:()=>t});const t="__fixed";class n{constructor(a){this.props=a}}},7257:(q,j,e)=>{"use strict";e.d(j,{NN:()=>u,Tz:()=>o,UO:()=>D,bq:()=>m,ro:()=>E,sw:()=>f,uY:()=>l});var t=e(63739),n=e(17177),r=e(91357),a=e(16869),i=e(7500),x=e(77595),s=e(61978),c=e(24415);const d=(v,y,P)=>{let b=y%2?P[0]||P[2]:P[1]||P[3];return P[y]||!b?0:8},u={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[d,d,d,d],series:[],hooks:{}};var g=(v=>(v[v.Pos=1]="Pos",v[v.Neg=-1]="Neg",v))(g||{});function o(v){let y=[],{series:P,dir:b}=v,S=P.length-1,M=P.slice().reverse();return M.forEach((O,R)=>{if(R!==S){let L=M[R+1];y.push({series:[O,L],dir:-1*b})}}),y}function E(v){let y=new Map;return v.fields.forEach(({config:P,values:b,type:S},M)=>{if(M===0)return;let{custom:O}=P;if(O==null||O.hideFrom?.viz)return;let{stacking:R}=O;if(R==null)return;let{mode:L,group:B}=R;if(L===i.gs.None)return;let F=O.transform,I=p(F,b),U=O.drawStyle,W=U===i.GR.Bars?O.barAlignment:U===i.GR.Line?O.lineInterpolation:null,A=`${I}|${L}|${B}|${(0,c.M)(P,S)}|${U}|${W}`,N=y.get(A);N==null&&(N={series:[],dir:I},y.set(A,N)),N.series.push(M)}),[...y.values()]}function m(v,y,P){let b=Array(v.fields.length),S=y.length,M=v.length,O=S>0?Array(M).fill(0):[],R=S>0?Array(M).fill(!1):[],L=Array.from({length:S},()=>O.slice()),B=Array.from({length:S},()=>R.slice());if(y.forEach((F,I)=>{let U=B[I];F.series.forEach(W=>{let A=v.fields[W];if(A.config.custom?.hideFrom?.viz)return;let N=A.values;for(let K=0;K<M;K++)N[K]!=null&&(U[K]=!0)})}),v.fields.forEach((F,I)=>{let U=F.values;if(I===0){F.type===t.PU.time?b[0]=(0,n.ks)(F).values:b[0]=U;return}let{custom:W}=F.config;if(!W||W.hideFrom?.viz){b[I]=U;return}if(W.transform===i.NU.Constant){let N=U.findIndex(V=>V!=null),K=U[N];U=Array(U.length).fill(void 0),U[N]=K}else if(U=U.slice(),W.transform===i.NU.NegativeY)for(let N=0;N<U.length;N++)U[N]!=null&&(U[N]*=-1);let A=W.stacking?.mode;if(!A||A===i.gs.None)b[I]=U;else{let N=y.findIndex(z=>z.series.indexOf(I)>-1),K=L[N],V=B[N],T=b[I]=Array(M);for(let z=0;z<M;z++){let w=U[z];w!=null?T[z]=K[z]+=w:T[z]=V[z]?K[z]:w}}}),P){let F=b.map((I,U)=>{let W=y.findIndex(A=>A.series.indexOf(U)>-1);return W!==-1?L[W]:I});P({totals:F})}return v.fields.forEach((F,I)=>{if(I===0||F.config.custom?.hideFrom?.viz)return;if(F.config.custom?.stacking?.mode===i.gs.Percent){let W=y.findIndex(V=>V.series.indexOf(I)>-1),A=L[W],N=y[W],K=b[I];for(let V=0;V<M;V++){let T=K[V];T!=null&&(K[V]=A[V]===0?0:N.dir*(T/A[V]))}}}),b}function f(v,y){let P,b=1,S=1,M=v.data[1][y],O=v.data[1][y];for(let R=1;R<v.data.length;R++){const B=v.data[R][y];B!=null&&(M==null?M=B:B>M&&(M=v.data[R][y],b=R),O==null?O=B:B<O&&(O=v.data[R][y],S=R))}return O==null&&M==null?P=void 0:O!=null&&M!=null?P=(v.valToPos(O,v.series[S].scale)+v.valToPos(M,v.series[b].scale))/2:P=v.valToPos(O||M,v.series[b||S].scale),P!==void 0&&P<0&&(P=v.bbox.height/devicePixelRatio),P}function p(v,y){const P=h(y);return v===i.NU.NegativeY?P?1:-1:P?-1:1}function h(v,y=100){const P=v.length;if(P===0)return!1;let b=0,S=P-1;for(;b<=S&&v[b]==null;)b++;for(;S>=b&&v[S]==null;)S--;let M=0,O=0;if(S>=b){const R=Math.max(1,Math.floor((S-b+1)/y));for(let L=b;L<=S;L+=R){const B=v[L];B!=null&&typeof B=="number"&&(B<0||Object.is(B,-0)?M++:B>0&&O++)}if(M>O)return!0}return!1}const D=(v,y,P)=>{if(!v?.length)return[];const b=R=>R==null?"-":R.toFixed(1),S=y.display??b;let M=null;const O=(0,r.Nw)({field:y,reducers:v});return v.map(R=>{const L=r.AS.get(R);let B=S;return L.id===r.gy.diffperc&&(B=(0,a.J)({field:{...y,config:{...y.config,unit:"percent"}},theme:P})),(L.id===r.gy.count||L.id===r.gy.changeCount||L.id===r.gy.distinctCount)&&(M||(M=(0,a.J)({field:{...y,config:{...y.config,unit:"none"}},theme:P})),B=M),{...B(O[R]),title:L.name,description:L.description}})},C=(0,s.h)("uPlot"),l=C.logger;(0,x.h)("graphng",void 0,C)},30665:(q,j,e)=>{"use strict";e.d(j,{H:()=>o,i:()=>E});var t=e(74848),n=e(22803),r=e(16557),a=e(88090),i=e(41784),x=e(48092),s=e(19550),c=e(76795),d=e(36529),u=e(61834),g=e(29675);const o=({getContextMenuSource:f,timeZone:p,itemsGroup:h,dimensions:D,contextDimensions:C,...l})=>{const v=f(),y=h?h.map(S=>({...S,items:S.items?.filter(M=>M.label)})):[],P=()=>{if(!v)return null;let S;if(D?.yAxis&&C?.yAxis?.[1]){const O=(0,r.WK)(D.yAxis,C.yAxis[0],C.yAxis[1]),R=v.series.valueField.display;S=R(O)}const M=(0,a.LE)(v.datapoint[0],{defaultWithMS:v.series.hasMsResolution,timeZone:p});return(0,t.jsx)(E,{timestamp:M,seriesColor:v.series.color,displayName:v.series.alias||v.series.label,displayValue:S})},b=()=>y?.map((S,M)=>(0,t.jsx)(c.r,{label:S.label,children:(S.items||[]).map(O=>(0,t.jsx)(d.D,{url:O.url,label:O.label,target:O.target,icon:O.icon,active:O.active,onClick:O.onClick},`${O.label}`))},`${S.label}${M}`));return(0,t.jsx)(i.t,{...l,renderMenuItems:b,renderHeader:P})},E=({timestamp:f,seriesColor:p,displayName:h,displayValue:D})=>{const C=(0,g.of)(m);return(0,t.jsxs)("div",{className:C.wrapper,children:[(0,t.jsx)("strong",{children:f}),(0,t.jsxs)(s.Gy,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.p,{color:p}),(0,t.jsx)("span",{className:C.displayName,children:h})]}),D&&(0,t.jsx)(x.i,{value:D})]})]})};function m(f){return{wrapper:(0,n.css)({padding:f.spacing(.5,1),fontSize:f.typography.size.sm,zIndex:f.zIndex.tooltip}),displayName:(0,n.css)({whiteSpace:"nowrap",paddingLeft:f.spacing(.5)})}}},38090:(q,j,e)=>{"use strict";e.r(j),e.d(j,{ALERTING_COLOR:()=>a.xj,Alert:()=>t.FcD,AlertingSettings:()=>t.ibS,AsyncMultiSelect:()=>t.Ivu,AsyncSelect:()=>t.DWK,AsyncVirtualizedSelect:()=>t.gZN,AutoSaveField:()=>t.p0K,AutoSizeInput:()=>t.Dd_,Avatar:()=>t.euF,AxisPlacement:()=>c.vM,Badge:()=>t.Exy,BarAlignment:()=>c.Nj,BarGauge:()=>t.xEy,BarGaugeDisplayMode:()=>t.eX$,BarValueVisibility:()=>c.TC,BigValue:()=>t.yVm,BigValueColorMode:()=>t.ypG,BigValueGraphMode:()=>t.$p8,BigValueJustifyMode:()=>t.F8C,BigValueTextMode:()=>t.SV3,Box:()=>t.azJ,BracesPlugin:()=>s.e1,BrowserLabel:()=>t.jQM,Button:()=>t.$nd,ButtonCascader:()=>t.HRi,ButtonGroup:()=>t.e2v,ButtonSelect:()=>t.fHW,CallToActionCard:()=>t.cbd,Card:()=>t.ZpM,CardContainer:()=>t.Q_j,Cascader:()=>t.vxQ,CertificationKey:()=>t.KmA,Checkbox:()=>t.Sc0,ClearPlugin:()=>s.vJ,ClickOutsideWrapper:()=>t.NqN,ClipboardButton:()=>t.bLJ,ClipboardPlugin:()=>s.sW,CodeEditor:()=>t.BYM,CodeEditorSuggestionItemKind:()=>t.q0m,CollapsableSection:()=>t.MU_,Collapse:()=>t.SDm,ColorPicker:()=>t.skP,ColorPickerInput:()=>t.itl,Combobox:()=>t.G3_,ConfirmButton:()=>t.ZFl,ConfirmModal:()=>t.uoB,Container:()=>t.mcf,ContextMenu:()=>t.tzH,ControlledCollapse:()=>t.a2C,Counter:()=>t.phK,CustomHeadersSettings:()=>t.Pli,CustomScrollbar:()=>t.EZm,DEFAULT_ANNOTATION_COLOR:()=>a.Mk,DOMUtil:()=>a.bk,DataLinkButton:()=>t.Rsn,DataLinkInput:()=>t.lZ_,DataLinksContextMenu:()=>t.ebG,DataLinksInlineEditor:()=>t.eHD,DataLinksInlineEditorBase:()=>t.Jb3,DataSourceHttpSettings:()=>t.tco,DatePicker:()=>t.lrV,DatePickerWithInput:()=>t.lS2,DateTimePicker:()=>t.K7n,DeleteButton:()=>t.etH,Divider:()=>t.cGx,DrawStyle:()=>c.yg,Drawer:()=>t._s,Dropdown:()=>t.msM,ElementSelectionContext:()=>t._V2,EmptySearchResult:()=>t.Z7I,EmptyState:()=>t.ppr,ErrorBoundary:()=>t.tHk,ErrorBoundaryAlert:()=>t.XwR,ErrorWithStack:()=>t.DaU,EventBusPlugin:()=>t.Kur,EventsCanvas:()=>t.aaz,EventsWithValidation:()=>a.Pw,FIXED_UNIT:()=>t.sN5,FadeTransition:()=>t.AVJ,FeatureBadge:()=>t.yKR,FeatureInfoBox:()=>t.ep7,Field:()=>t.D0$,FieldArray:()=>t.ED_,FieldLinkList:()=>t.nA8,FieldSet:()=>t.nVY,FieldValidationMessage:()=>t.PgM,FileDropzone:()=>t.gHy,FileDropzoneDefaultChildren:()=>t.wIj,FileListItem:()=>t.IBq,FileUpload:()=>t.ef9,FilterInput:()=>t.ZYI,FilterPill:()=>t.mKT,Form:()=>t.lVW,FormattedValueDisplay:()=>t.i7I,FullWidthButtonContainer:()=>t.Vpd,Gauge:()=>t._I2,GlobalStyles:()=>i.kH,Graph:()=>t.TS0,GraphContextMenu:()=>t.Hdp,GraphContextMenuHeader:()=>t.io8,GraphGradientMode:()=>c.on,GraphNG:()=>t.ovZ,GraphSeriesToggler:()=>t.MTY,GraphThresholdsStyleMode:()=>c.Ly,GraphWithLegend:()=>t.IK5,Grid:()=>t.xA9,HorizontalGroup:()=>t.GyY,Icon:()=>t.Int,IconButton:()=>t.K0,IndentationPlugin:()=>s.TA,InfoBox:()=>t.w4Q,InlineField:()=>t.IP5,InlineFieldRow:()=>t.CeB,InlineFormLabel:()=>t.IjS,InlineLabel:()=>t.c2B,InlineSegmentGroup:()=>t.e8d,InlineSwitch:()=>t.KYK,InlineToast:()=>t.r0T,Input:()=>t.pde,InputControl:()=>t.eyo,InteractiveTable:()=>t.jDF,JSONFormatter:()=>t.BJ$,JsonExplorer:()=>t.OoN,KeyboardPlugin:()=>t.Z7z,Label:()=>t.JU7,LegacyForms:()=>t.rRI,LegacyInputStatus:()=>t.OYG,Legend:()=>t.s$2,LegendDisplayMode:()=>c.lm,LineInterpolation:()=>c.dx,Link:()=>t.N_E,LinkButton:()=>t.z9$,List:()=>t.B8B,LoadingBar:()=>t.GmG,LoadingPlaceholder:()=>t._ae,Marker:()=>t.pH9,Menu:()=>t.W1t,MenuGroup:()=>t.rXV,MenuItem:()=>t.Drp,Modal:()=>t.aFV,ModalHeader:()=>t.rQ0,ModalRoot:()=>t.EOs,ModalTabContent:()=>t.OHP,ModalTabsHeader:()=>t.JXd,ModalsContext:()=>t.wEe,ModalsController:()=>t.$sz,ModalsProvider:()=>t.YO7,MultiCombobox:()=>t.fpH,MultiSelect:()=>t.KFt,NO_DATA_COLOR:()=>a.nO,NewlinePlugin:()=>s.Om,NodeGraphDataFrameFieldNames:()=>a.uc,OK_COLOR:()=>a.Xw,PENDING_COLOR:()=>a.ct,PageToolbar:()=>t.dAS,Pagination:()=>t.dKS,PanelChrome:()=>t.NRL,PanelChromeLoadingIndicator:()=>t.oQQ,PanelContainer:()=>t._wj,PanelContextProvider:()=>t.XFg,PanelContextRoot:()=>t.e4W,PlotLegend:()=>t.$sV,PluginSignatureBadge:()=>t.Bjr,PointVisibility:()=>c.nT,Popover:()=>t.AMh,PopoverController:()=>t.IE3,Portal:()=>t.ZLI,PortalContainer:()=>t.qB2,QueryField:()=>t.Xjo,REGION_FILL_ALPHA:()=>a.UJ,RadioButtonDot:()=>t.JBW,RadioButtonGroup:()=>t.zWQ,RadioButtonList:()=>t.a0s,RangeSlider:()=>t.F16,ReactMonacoEditor:()=>t.m3b,ReactUtils:()=>a.zt,RefreshPicker:()=>t.cCp,RelativeTimeRangePicker:()=>t.NBP,RenderUserContentAsHTML:()=>t.IUm,RunnerPlugin:()=>s.Ul,SCHEMA:()=>a.yx,ScaleDirection:()=>c.ON,ScaleDistribution:()=>t.L47,ScaleOrientation:()=>c.Lt,ScrollContainer:()=>t.PaW,SearchFunctionType:()=>a.Tt,SecretInput:()=>t.L44,SecretTextArea:()=>t.lpq,SecureSocksProxySettings:()=>t.YAX,Segment:()=>t.Y4n,SegmentAsync:()=>t.sYD,SegmentInput:()=>t.oyW,SegmentSection:()=>t.Lrm,SegmentSelect:()=>t.a$h,Select:()=>t.l6P,SelectContainer:()=>t.KAb,SelectMenuOptions:()=>t.o5c,SelectionShortcutsPlugin:()=>s.l9,SeriesColorPicker:()=>t.Dpi,SeriesColorPickerPopover:()=>t.o0L,SeriesColorPickerPopoverWithTheme:()=>t.tJM,SeriesIcon:()=>t.pMY,SeriesTable:()=>t.o95,SeriesTableRow:()=>t.gNl,SeriesVisibilityChangeBehavior:()=>t.KHN,SeriesVisibilityChangeMode:()=>t.Bd,SetInterval:()=>t.u3P,SlatePrism:()=>s.De,SlideOutTransition:()=>t.nfS,Slider:()=>t.Apm,Space:()=>t.$xS,Sparkline:()=>t.OW$,Spinner:()=>t.y$y,Stack:()=>t.BJc,StackingMode:()=>c.gs,StatsPicker:()=>t.SPA,SuggestionsPlugin:()=>s.Pz,Switch:()=>t.dOG,TLSAuthSettings:()=>t.jDu,Tab:()=>t.ozo,TabContent:()=>t.JSC,TabbedContainer:()=>t.qtX,Table:()=>t.XIK,TableCellDisplayMode:()=>c.ob,TableCellInspector:()=>t.sRj,TableCellInspectorMode:()=>t.Btl,TableInputCSV:()=>t.bwN,TabsBar:()=>t.U05,Tag:()=>t.vwO,TagList:()=>t.LYX,TagsInput:()=>t.um3,Text:()=>t.EYj,TextArea:()=>t.fs1,TextLink:()=>t.YqK,ThemeContext:()=>i.Dx,TimeOfDayPicker:()=>t.R3l,TimePickerTooltip:()=>t.xSz,TimeRangeInput:()=>t.bYj,TimeRangeLabel:()=>t.fD2,TimeRangePicker:()=>t.$64,TimeRangeProvider:()=>t.AjF,TimeSeries:()=>t.ZOC,TimeZonePicker:()=>t.U7r,ToggleAllState:()=>t.XNj,Toggletip:()=>t.Gff,ToolbarButton:()=>t.IBt,ToolbarButtonRow:()=>t.Uhs,Tooltip:()=>t.m_M,TooltipDisplayMode:()=>c.$N,TooltipPlugin:()=>t.TkQ,TooltipPlugin2:()=>t.xlH,UPLOT_AXIS_FONT_SIZE:()=>t.piP,UPlotChart:()=>t.ZCE,UPlotConfigBuilder:()=>t.eEE,UnitPicker:()=>t.pKo,UserIcon:()=>t.nys,UsersIndicator:()=>t.qeh,ValuePicker:()=>t.iyp,VerticalGroup:()=>t.gWJ,VerticalTab:()=>t.sMJ,VirtualizedSelect:()=>t.ipx,VizLayout:()=>t.KUk,VizLegend:()=>t.tZ2,VizLegendListItem:()=>t.MJh,VizRepeater:()=>t.SdN,VizTooltip:()=>t.nRt,VizTooltipContainer:()=>t.oNG,WeekStartPicker:()=>t.l69,WithContextMenu:()=>t.nuT,XYCanvas:()=>t._XZ,ZoomPlugin:()=>t.jnT,actionModelToContextMenuItems:()=>a.HD,attachDebugger:()=>a.hF,buildScaleKey:()=>t.Myc,calculateFontSize:()=>a.Vr,clearButtonStyles:()=>t.myI,colors:()=>a.Tj,commonOptionsBuilder:()=>x.j,convertOldAngularValueMapping:()=>t.I1_,createLogger:()=>a.h,defaultIntervals:()=>t.cbf,fieldMatchersUI:()=>t.gso,fuzzyMatch:()=>a.It,getCanvasContext:()=>a.Yc,getCardStyles:()=>t.Hut,getCellLinks:()=>a.kl,getDragStyles:()=>t.lBN,getInputStyles:()=>t.na7,getPortalContainer:()=>t.gF8,getScrollbarWidth:()=>a.XJ,getSelectStyles:()=>t.Jq4,getTagColor:()=>a.yC,getTagColorIndexFromName:()=>a.JF,getTagColorsFromName:()=>a.MC,getTextColorForAlphaBackground:()=>a.mZ,getTextColorForBackground:()=>a.sg,getTheme:()=>i.O4,getWeekStart:()=>t.rLY,graphFieldOptions:()=>t.ti9,graphTickFormatter:()=>t.YnM,graphTimeFormat:()=>t.JcZ,hasValidationEvent:()=>a.K,linkModelToContextMenuItems:()=>a.Jl,logOptions:()=>a.DD,makeFragment:()=>a.dF,makeValue:()=>a.mO,measureText:()=>a.kD,mockTheme:()=>i.mG,mockThemeContext:()=>i.fq,preparePlotFrame:()=>t.mYT,regexValidation:()=>a.RP,resetSelectStyles:()=>t.aLN,sharedInputStyle:()=>t.Xb,sharedSingleStatMigrationHandler:()=>t._$q,sharedSingleStatPanelChangedHandler:()=>t.glJ,sortedColors:()=>a.Ih,styleMixins:()=>i.YF,stylesFactory:()=>i.N3,useElementSelection:()=>t.yff,useForceUpdate:()=>a.CH,useGraphNGContext:()=>t.IyU,usePanelContext:()=>t.d2s,useSplitter:()=>t.hrX,useStyles:()=>i.IS,useStyles2:()=>i.of,useTheme:()=>i.DP,useTheme2:()=>i.$j,validate:()=>a.tf,variableSuggestionToCodeEditorSuggestion:()=>t.OOt,withErrorBoundary:()=>t.Xc0,withTheme:()=>i.SL,withTheme2:()=>i.cV});var t=e(40947),n=e(8404),r={};for(const d in n)["default","Alert","AlertingSettings","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","AutoSaveField","AutoSizeInput","Avatar","Badge","BarGauge","BarGaugeDisplayMode","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Box","BrowserLabel","Button","ButtonCascader","ButtonGroup","ButtonSelect","CallToActionCard","Card","CardContainer","Cascader","CertificationKey","Checkbox","ClickOutsideWrapper","ClipboardButton","CodeEditor","CodeEditorSuggestionItemKind","CollapsableSection","Collapse","ColorPicker","ColorPickerInput","Combobox","ConfirmButton","ConfirmModal","Container","ContextMenu","ControlledCollapse","Counter","CustomHeadersSettings","CustomScrollbar","DataLinkButton","DataLinkInput","DataLinksContextMenu","DataLinksInlineEditor","DataLinksInlineEditorBase","DataSourceHttpSettings","DatePicker","DatePickerWithInput","DateTimePicker","DeleteButton","Divider","Drawer","Dropdown","ElementSelectionContext","EmptySearchResult","EmptyState","ErrorBoundary","ErrorBoundaryAlert","ErrorWithStack","EventBusPlugin","EventsCanvas","FIXED_UNIT","FadeTransition","FeatureBadge","FeatureInfoBox","Field","FieldArray","FieldLinkList","FieldSet","FieldValidationMessage","FileDropzone","FileDropzoneDefaultChildren","FileListItem","FileUpload","FilterInput","FilterPill","Form","FormattedValueDisplay","FullWidthButtonContainer","Gauge","Graph","GraphContextMenu","GraphContextMenuHeader","GraphNG","GraphSeriesToggler","GraphWithLegend","Grid","HorizontalGroup","Icon","IconButton","InfoBox","InlineField","InlineFieldRow","InlineFormLabel","InlineLabel","InlineSegmentGroup","InlineSwitch","InlineToast","Input","InputControl","InteractiveTable","JSONFormatter","JsonExplorer","KeyboardPlugin","Label","LegacyForms","LegacyInputStatus","Legend","Link","LinkButton","List","LoadingBar","LoadingPlaceholder","Marker","Menu","MenuGroup","MenuItem","Modal","ModalHeader","ModalRoot","ModalTabContent","ModalTabsHeader","ModalsContext","ModalsController","ModalsProvider","MultiCombobox","MultiSelect","PageToolbar","Pagination","PanelChrome","PanelChromeLoadingIndicator","PanelContainer","PanelContextProvider","PanelContextRoot","PlotLegend","PluginSignatureBadge","Popover","PopoverController","Portal","PortalContainer","QueryField","RadioButtonDot","RadioButtonGroup","RadioButtonList","RangeSlider","ReactMonacoEditor","RefreshPicker","RelativeTimeRangePicker","RenderUserContentAsHTML","ScaleDistribution","ScrollContainer","SecretInput","SecretTextArea","SecureSocksProxySettings","Segment","SegmentAsync","SegmentInput","SegmentSection","SegmentSelect","Select","SelectContainer","SelectMenuOptions","SeriesColorPicker","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","SeriesIcon","SeriesTable","SeriesTableRow","SeriesVisibilityChangeBehavior","SeriesVisibilityChangeMode","SetInterval","SlideOutTransition","Slider","Space","Sparkline","Spinner","Stack","StatsPicker","Switch","TLSAuthSettings","Tab","TabContent","TabbedContainer","Table","TableCellInspector","TableCellInspectorMode","TableInputCSV","TabsBar","Tag","TagList","TagsInput","Text","TextArea","TextLink","TimeOfDayPicker","TimePickerTooltip","TimeRangeInput","TimeRangeLabel","TimeRangePicker","TimeRangeProvider","TimeSeries","TimeZonePicker","ToggleAllState","Toggletip","ToolbarButton","ToolbarButtonRow","Tooltip","TooltipPlugin","TooltipPlugin2","UPLOT_AXIS_FONT_SIZE","UPlotChart","UPlotConfigBuilder","UnitPicker","UserIcon","UsersIndicator","ValuePicker","VerticalGroup","VerticalTab","VirtualizedSelect","VizLayout","VizLegend","VizLegendListItem","VizRepeater","VizTooltip","VizTooltipContainer","WeekStartPicker","WithContextMenu","XYCanvas","ZoomPlugin","buildScaleKey","clearButtonStyles","convertOldAngularValueMapping","defaultIntervals","fieldMatchersUI","getCardStyles","getDragStyles","getInputStyles","getPortalContainer","getSelectStyles","getWeekStart","graphFieldOptions","graphTickFormatter","graphTimeFormat","preparePlotFrame","resetSelectStyles","sharedInputStyle","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","useElementSelection","useGraphNGContext","usePanelContext","useSplitter","variableSuggestionToCodeEditorSuggestion","withErrorBoundary"].indexOf(d)<0&&(r[d]=()=>n[d]);e.d(j,r);var a=e(27104),i=e(83319),x=e(88174),s=e(44980),c=e(63031)},59698:(q,j,e)=>{"use strict";e.d(j,{T4:()=>p,W1:()=>f,Wq:()=>h,rg:()=>o});var t=e(74848),n=e(63739),r=e(49448),a=e(7500),i=e(86489),x=e(60641),s=e(34128),c=e(48583),d=e(44826),u=e(97988);const g=["Axis"];function o(D,C){h(D),D.addTextInput({path:"axisLabel",name:"Label",category:g,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:l=>l.axisPlacement!==a.vM.Hidden,shouldApply:l=>l.type!==n.PU.time&&l.type!==n.PU.string}),p(D),D.addRadio({path:"axisGridShow",name:"Show grid lines",category:g,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:l=>l.axisPlacement!==a.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:g,defaultValue:a.Y$.Text,settings:{options:[{value:a.Y$.Text,label:"Text"},{value:a.Y$.Series,label:"Series"}]},showIf:l=>l.axisPlacement!==a.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:g,defaultValue:!1,showIf:l=>l.axisPlacement!==a.vM.Hidden}),D.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:g,editor:f,override:f,defaultValue:{type:a.L4.Linear},shouldApply:l=>l.type===n.PU.number,process:r.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:g,defaultValue:!1,showIf:l=>l.scaleDistribution?.type!==a.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:C.axisSoftMin,category:g,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:C.axisSoftMax,category:g,settings:{placeholder:"See: Standard options > Max"}})}const E=[{label:"Linear",value:a.L4.Linear},{label:"Logarithmic",value:a.L4.Log},{label:"Symlog",value:a.L4.Symlog}],m=[{label:"2",value:2},{label:"10",value:10}],f=({value:D,onChange:C})=>{const l=D?.type??a.L4.Linear,v=D?.log??2;return(0,t.jsxs)(c.B,{direction:"column",gap:2,children:[(0,t.jsx)(x.z,{value:l,options:E,onChange:y=>{C({...D,type:y,log:y===a.L4.Linear?void 0:v})}}),(l===a.L4.Log||l===a.L4.Symlog)&&(0,t.jsx)(i.D,{label:"Log base",children:(0,t.jsx)(d.l6,{options:m,value:v,onChange:y=>{C({...D,log:y.value})}})}),l===a.L4.Symlog&&(0,t.jsx)(i.D,{label:"Linear threshold",style:{marginBottom:0},children:(0,t.jsx)(s.p,{placeholder:"1",value:D?.linearThreshold,onChange:y=>{C({...D,linearThreshold:Number(y.currentTarget.value)})}})})]})};function p(D){D.addNumberInput({path:"axisWidth",name:"Width",category:g,settings:{placeholder:"Auto"},showIf:C=>C.axisPlacement!==a.vM.Hidden})}function h(D,C=l=>!0){D.addRadio({path:"axisPlacement",name:"Placement",category:g,defaultValue:u.t.axisPlacement[0].value,settings:{options:u.t.axisPlacement.filter(l=>C(l.value))}})}},95118:(q,j,e)=>{"use strict";e.d(j,{e:()=>c});var t=e(74848),n=e(2543),r=e.n(n),a=e(96540),i=e(99076),x=e(48583);const s=({value:d,onChange:u})=>{const g=(0,a.useCallback)(o=>{u({...d,[o]:!d[o]})},[d,u]);return(0,t.jsx)(x.B,{gap:.5,children:Object.keys(d).map(o=>{const E=o;return(0,t.jsx)(i.m,{icon:d[E]?"eye-slash":"eye",onClick:()=>g(E),label:(0,n.startCase)(E),selected:d[E]},E)})})};function c(d){d.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:s,override:s,shouldApply:()=>!0,hideFromDefaults:!0,process:u=>u})}},13678:(q,j,e)=>{"use strict";e.d(j,{H:()=>r});var t=e(79488),n=e(7500);function r(a,i=!0,x=!0){a.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:x}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:n.lm.List,settings:{options:[{value:n.lm.List,label:"List"},{value:n.lm.Table,label:"Table"}]},showIf:s=>s.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:s=>s.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:s=>s.legend.showLegend&&s.legend.placement==="right"}),i&&a.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:t.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:s=>s.legend.showLegend!==!1})}},10925:(q,j,e)=>{"use strict";e.d(j,{I:()=>g,m:()=>u});var t=e(74848),n=e(49448),r=e(63739),a=e(7500),i=e(60641),x=e(99764),s=e(34128),c=e(48583),d=e(97988);const u=({value:o,context:E,onChange:m,item:f})=>(0,t.jsxs)(c.B,{children:[(0,t.jsx)(i.z,{value:o?.mode||a.gs.None,options:f.settings?.options??[],onChange:p=>{m({...o,mode:p})}}),E.isOverride&&o?.mode&&o?.mode!==a.gs.None&&(0,t.jsx)(s.p,{type:"text",placeholder:"Group",suffix:(0,t.jsx)(x.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:o?.group,onChange:p=>{m({...o,group:p.currentTarget.value.trim()})}})]});function g(o,E,m=["Graph styles"]){o.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:m,defaultValue:E,editor:u,override:u,settings:{options:d.t.stacking},process:n.hS,shouldApply:f=>f.type===r.PU.number})}},46824:(q,j,e)=>{"use strict";e.d(j,{I:()=>t});function t(n,r=!0){r&&n.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.percentSize",category:["Text size"],name:"Percent change",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},30040:(q,j,e)=>{"use strict";e.d(j,{D:()=>r,U:()=>n});var t=e(7500);const n={tooltip:{mode:t.$N.Single,sort:t.xB.None,hideZeros:!1}};function r(a,i=!1,x=!1,s){const c=["Tooltip"],d=i?[{value:t.$N.Single,label:"Single"},{value:t.$N.None,label:"Hidden"}]:[{value:t.$N.Single,label:"Single"},{value:t.$N.Multi,label:"All"},{value:t.$N.None,label:"Hidden"}],u=[{value:t.xB.None,label:"None"},{value:t.xB.Ascending,label:"Ascending"},{value:t.xB.Descending,label:"Descending"}];a.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:c,defaultValue:s?.tooltip?.mode??t.$N.Single,settings:{options:d}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:c,defaultValue:s?.tooltip?.sort??t.xB.None,showIf:g=>g.tooltip?.mode===t.$N.Multi,settings:{options:u}}).addBooleanSwitch({path:"tooltip.hideZeros",name:"Hide zeros",category:c,defaultValue:!1,showIf:g=>s?.tooltip?.hideZeros!==void 0&&g.tooltip?.mode===t.$N.Multi}),x&&a.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:c,settings:{integer:!0},showIf:g=>g.tooltip?.mode!==t.$N.None}),a.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:c,settings:{integer:!0},showIf:g=>g.tooltip?.mode!==t.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:c,defaultValue:void 0,settings:{integer:!0},showIf:g=>g.tooltip?.mode===t.$N.Multi})}},88174:(q,j,e)=>{"use strict";e.d(j,{j:()=>t});var t={};e.r(t),e.d(t,{ScaleDistributionEditor:()=>n.W1,StackingEditor:()=>s.m,addAxisConfig:()=>n.rg,addAxisPlacement:()=>n.Wq,addAxisWidth:()=>n.T4,addHideFrom:()=>r.e,addLegendOptions:()=>a.H,addStackingConfig:()=>s.I,addTextSizeOptions:()=>x.I,addTooltipOptions:()=>i.D});var n=e(59698),r=e(95118),a=e(13678),i=e(30040),x=e(46824),s=e(10925)},63031:(q,j,e)=>{"use strict";e.d(j,{$N:()=>t.$N,Lt:()=>t.Lt,Ly:()=>t.Ly,Nj:()=>t.Nj,ON:()=>t.ON,TC:()=>t.yL,dx:()=>t.dx,gs:()=>t.gs,lm:()=>t.lm,nT:()=>t.yL,ob:()=>t.ob,on:()=>t.on,vM:()=>t.vM,yg:()=>t.GR});var t=e(7500)},54436:(q,j,e)=>{"use strict";e.d(j,{v:()=>t});function t(){return{onKeyDown(n,r,a){const i=r.value;if(i.selection.isExpanded)return a();if(n.key==="k"&&n.ctrlKey){n.preventDefault();const x=i.anchorText.text,s=i.selection.anchor.offset,d=x.length-s;return r.deleteForward(d),!0}return a()}}}},26007:(q,j,e)=>{"use strict";e.d(j,{s:()=>r});const t=(a,i,x)=>{if(!a.length)return;const s=a.slice(0,-1).join("").length+a.length-1;return a.join(`
`).slice(i,s+x)},n=a=>a?.replace(/[\uFEFF]/g,"");function r(){const a={onCopy(i,x,s){i.preventDefault();const{document:c,selection:d}=x.value,{start:{offset:u},end:{offset:g}}=d,o=c.getLeafBlocksAtRange(d).toArray().map(m=>m.text),E=n(t(o,u,g));return E&&i.clipboardData&&i.clipboardData.setData("Text",E),!0},onPaste(i,x,s){if(i.preventDefault(),i.clipboardData){const d=n(i.clipboardData.getData("Text"))?.split(`
`);if(d&&d.length){x.insertText(d[0]);for(const u of d.slice(1))x.splitBlock().insertText(u)}}return!0}};return{...a,onCut(i,x,s){return a.onCopy(i,x,s),x.deleteAtRange(x.value.selection),!0}}}},65473:(q,j,e)=>{"use strict";e.d(j,{T:()=>u});var t=e(57746),n=e(82611),r=e(75226);const a=(0,t.Sn)("mod+["),i=(0,t.Sn)("shift+tab"),x=(0,t.Sn)("mod+]"),s="  ",c=(g,o,E)=>{const{startBlock:m,endBlock:f,selection:{start:{offset:p,key:h},end:{offset:D,key:C}}}=o.value;if(r.default.serialize(o.value)==="")return;g.preventDefault();const l=m.getFirstText();l&&p===0&&h===l.key&&D===l.text.length&&C===l.key||!m.equals(f)?d(o,"right"):o.insertText(s)},d=(g,o)=>{const E=g.value.selection,m=g.value.document.getLeafBlocksAtRange(E).toArray();if(o==="left")for(const f of m){const p=f.text.length-f.text.trimLeft().length,h=f.getFirstText().key,D={anchor:{key:h,offset:p,path:[]},focus:{key:h,offset:p,path:[]}};g.deleteBackwardAtRange(n.Range.create(D),Math.min(s.length,p))}else{const{startText:f}=g.value,p=f.text.slice(0,E.start.offset),h=/^\s*$/.test(p);for(const D of m)g.insertTextByKey(D.getFirstText().key,0,s);h&&g.moveStartBackward(s.length)}};function u(){return{onKeyDown(g,o,E){if(a(g)||i(g))g.preventDefault(),d(o,"left");else if(x(g))g.preventDefault(),d(o,"right");else if(g.key==="Tab")c(g,o,E);else return E();return!0}}}},44980:(q,j,e)=>{"use strict";e.d(j,{e1:()=>a,vJ:()=>i.v,sW:()=>x.s,TA:()=>s.T,Om:()=>c.O,Ul:()=>d.U,l9:()=>u.l,De:()=>g.D,Pz:()=>o.Pz});var t=e(24726);const n={"[":"]","{":"}","(":")"},r="brace_match";function a(){return{onKeyDown(E,m,f){const{value:p}=m;switch(E.key){case"(":case"{":case"[":{const{start:{offset:h,key:D},end:{offset:C,key:l},focus:{offset:v}}=p.selection,y=p.focusText.text;if(p.selection.isExpanded)return E.preventDefault(),m.insertTextByKey(D,h,E.key).insertTextByKey(l,C+1,n[E.key]).moveEndBackward(1),!0;if(v===y.length||y[v]===" "||Object.values(n).includes(y[v])){E.preventDefault();const P=n[E.key],b={key:`${r}-${(0,t.A)()}`,type:`${r}-${P}`,anchor:{key:D,offset:h,object:"point"},focus:{key:l,offset:C+1,object:"point"},object:"annotation"};return m.insertText(E.key).insertText(P).addAnnotation(b).moveBackward(1),!0}break}case")":case"}":case"]":{const h=p.anchorText.text,D=p.selection.anchor.offset,C=h[D],l=E.key,v=`${r}-${l}`,y=p.annotations.find(P=>P?.type===v&&P.anchor.key===p.anchorText.key);if(y&&C===l&&!p.selection.isExpanded)return E.preventDefault(),m.moveFocusForward(1).removeAnnotation(y).moveAnchorForward(1),!0;break}case"Backspace":{const h=p.anchorText.text,D=p.selection.anchor.offset,C=h[D-1],l=h[D];if(n[C]&&n[C]===l)return E.preventDefault(),m.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return f()}}}var i=e(54436),x=e(26007),s=e(65473),c=e(2949),d=e(36643),u=e(80687),g=e(32254),o=e(41980)},2949:(q,j,e)=>{"use strict";e.d(j,{O:()=>n});function t(r){let a=r.length-r.trimLeft().length;if(a){let i=r[0];for(;--a;)i+=r[0];return i}return""}function n(){return{onKeyDown(r,a,i){const x=a.value;if(x.selection.isExpanded)return i();if(r.key==="Enter"){r.preventDefault();const{startBlock:s}=x,c=s.text,d=t(c);return a.splitBlock().insertText(d).focus()}return i()}}}},36643:(q,j,e)=>{"use strict";e.d(j,{U:()=>t});function t({handler:n}){return{onKeyDown(r,a,i){return n&&r.key==="Enter"&&(r.shiftKey||r.ctrlKey)?(r.preventDefault(),n(r),a):i()}}}},80687:(q,j,e)=>{"use strict";e.d(j,{l:()=>r});var t=e(57746);const n=(0,t.Sn)("mod+l");function r(){return{onKeyDown(a,i,x){if(n(a)){a.preventDefault();const{focusBlock:s,document:c}=i.value;i.moveAnchorToStartOfBlock(),c.getNextBlock(s.key)?i.moveFocusToStartOfNextBlock():i.moveFocusToEndOfText()}else return x();return!0}}}},28012:(q,j,e)=>{"use strict";e.d(j,{A:()=>n});const n="prism-token"},32254:(q,j,e)=>{"use strict";e.d(j,{D:()=>o,R:()=>p});var t=e(28848),n=e.n(t),r=e(82611),a=e(28012),i=e(74848),x=e(49568);function s(h){return h.object==="block"&&h.type==="code_block"}function c(h){return"javascript"}function d(h,D,C){const{decoration:l}=h;if(l.type!==a.A)return C();const v=l.data.get("className");return(0,i.jsx)("span",{className:v,children:h.children})}class u extends(0,x.Record)({onlyIn:s,getSyntax:c,renderDecoration:d}){constructor(D){super(D)}}const g=u;function o(h={},D=n().languages){const C=new g(h);return{decorateNode:(l,v,y)=>{if(!C.onlyIn(l))return y();const P=r.Block.create(l),b=C.getSyntax(P),S=D[b];if(!S)return[];const O=P.getTexts().map(F=>F&&F.getText()).join(`
`),R=n().tokenize(O,S),L=p(R),B=v.value.data.set("tokens",L);return v.setData(B),E(C,R,P)},renderDecoration:(l,v,y)=>C.renderDecoration({children:l.children,decoration:l.decoration},v,y)}}function E(h,D,C){const l=C.getTexts(),v=[];let y=0,P=0;return l.forEach(b=>{P=y+b.getText().length;let S=0;function M(O,R){if(typeof O=="string"){if(R){const L=m({text:b,textStart:y,textEnd:P,start:S,end:S+O.length,className:`prism-token token ${R}`,block:C});L&&v.push(L)}S+=O.length}else if(R=`${R} ${O.type}`,O.alias&&(R+=" "+O.alias),typeof O.content=="string"){const L=m({text:b,textStart:y,textEnd:P,start:S,end:S+O.content.length,className:`prism-token token ${R}`,block:C});L&&v.push(L),S+=O.content.length}else for(let L=0;L<O.content.length;L+=1)M(O.content[L],R)}D.forEach(M),y=P+1}),v}function m({text:h,textStart:D,textEnd:C,start:l,end:v,className:y,block:P}){return l>=C||v<=D?null:(l=Math.max(l,D),v=Math.min(v,C),l-=D,v-=D,P.createDecoration({object:"decoration",anchor:{key:h.key,offset:l,object:"point"},focus:{key:h.key,offset:v,object:"point"},type:a.A,data:{className:y}}))}function f(h){return typeof h=="string"?[{content:h,types:[],aliases:[]}]:Array.isArray(h)?h.flatMap(D=>f(D)):h instanceof n().Token?f(h.content).flatMap(D=>{let C=[];return typeof h.alias=="string"?C=[h.alias]:C=h.alias??[],{content:D.content,types:[h.type,...D.types],aliases:[...C,...D.aliases]}}):[]}function p(h){const D=f(h);if(!D.length)return[];const C=D[0];C.prev=null,C.next=D.length>=2?D[1]:null,C.offsets={start:0,end:C.content.length};for(let v=1;v<D.length-1;v++)D[v].prev=D[v-1],D[v].next=D[v+1],D[v].offsets={start:D[v-1].offsets.end,end:D[v-1].offsets.end+D[v].content.length};const l=D[D.length-1];return l.prev=D.length>=2?D[D.length-2]:null,l.next=null,l.offsets={start:D.length>=2?D[D.length-2].offsets.end:0,end:D.length>=2?D[D.length-2].offsets.end+l.content.length:l.content.length},D}},41980:(q,j,e)=>{"use strict";e.d(j,{Pz:()=>U});var t=e(74848),n=e(2543),r=e(22803),a=e(96540),i=e(40961),x=e(91793),s=e(15580),c=e(45696),d=e(49579);const u=N=>N.reduce((K,{items:V,label:T})=>(K.push({label:T,kind:c.I.GroupTitle}),V.reduce((z,w)=>(z.push(w),z),K)),[]),g=N=>N.reduce((K,V)=>K.length<V.label.length?V.label:K,""),o=(N,K,V)=>{const T=(0,d.A)(V,{font:N.typography.fontFamilyMonospace,fontSize:N.typography.bodySmall.fontSize,fontWeight:"normal"}),z=m(T.width,N),w=E(T.height,N),H=f(w,K);return{listWidth:z,listHeight:H,itemHeight:w}},E=(N,K)=>{const V=K.spacing.gridSize*2;return N+V},m=(N,K)=>{const V=K.spacing.gridSize*3;return Math.min(Math.max(N+V,200),800)},f=(N,K)=>{const V=Math.min(K.length,10),T=100,z=V*N;return Math.max(z,T)};var p=e(60997),h=e(29675);const D=(N,K,V)=>({typeaheadItem:(0,r.css)({label:"type-ahead-item",zIndex:11,padding:N.spacing(1,1,1,2),border:N.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:N.colors.background.secondary,color:N.colors.text.secondary,boxShadow:`0 0 20px ${N.v1.colors.dropdownShadow}`,visibility:V===!0?"visible":"hidden",width:"250px",minHeight:`${K+parseInt(N.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),C=({item:N,height:K})=>{const V=N&&!!N.documentation,T=N?N.label:"",z=(0,p.G)(N?.documentation),w=(0,h.$j)(),H=D(w,K,V);return(0,t.jsxs)("div",{className:(0,r.cx)([H.typeaheadItem]),children:[(0,t.jsx)("b",{children:T}),(0,t.jsx)("hr",{}),(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:z}})]})};var l=e(23257),v=e.n(l),y=e(90411);const P=N=>({typeaheadItem:(0,r.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:N.typography.fontFamilyMonospace,padding:N.spacing(1,1,1,2),fontSize:N.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[N.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,r.css)({label:"type-ahead-item-selected",backgroundColor:N.colors.background.secondary}),typeaheadItemMatch:(0,r.css)({label:"type-ahead-item-match",color:N.v1.palette.yellow,borderBottom:`1px solid ${N.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,r.css)({label:"type-ahead-item-group-title",color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize,lineHeight:N.typography.body.lineHeight,padding:N.spacing(1)})}),b=N=>{const K=(0,h.of)(P),{isSelected:V,item:T,prefix:z,style:w,onMouseEnter:H,onMouseLeave:G,onClickItem:X}=N,k=V?(0,r.cx)([K.typeaheadItem,K.typeaheadItemSelected]):(0,r.cx)([K.typeaheadItem]),_=(0,r.cx)([K.typeaheadItemMatch]),ee=(0,r.cx)([K.typeaheadItemGroupTitle]),J=T.label||"";return T.kind===c.I.GroupTitle?(0,t.jsx)("li",{className:ee,style:w,children:(0,t.jsx)("span",{children:J})}):(0,t.jsx)("li",{role:"none",children:(0,t.jsx)("button",{role:"menuitem",className:k,style:w,onMouseDown:X,onMouseEnter:H,onMouseLeave:G,type:"button",children:T.highlightParts!==void 0?(0,t.jsx)(y.z,{text:J,highlightClassName:_,highlightParts:T.highlightParts}):(0,t.jsx)(v(),{textToHighlight:J,searchWords:[z??""],autoEscape:!0,highlightClassName:_})})})},S=(N,K)=>N-K*Math.floor(N/K);class M extends a.PureComponent{constructor(){super(...arguments),this.listRef=(0,a.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const K=u(this.props.groupedItems),V=g(K),{listWidth:T,listHeight:z,itemHeight:w}=o(this.context,K,V);this.setState({listWidth:T,listHeight:z,itemHeight:w,allItems:K})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(K,V)=>{if(this.state.typeaheadIndex!==null&&V.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,n.isEqual)(K.groupedItems,this.props.groupedItems)===!1){const T=u(this.props.groupedItems),z=g(T),{listWidth:w,listHeight:H,itemHeight:G}=o(this.context,T,z);this.setState({listWidth:w,listHeight:H,itemHeight:G,allItems:T,typeaheadIndex:null})}},this.onMouseEnter=K=>{this.setState({hoveredItem:K})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=K=>{const V=this.state.allItems.length;if(V){const T=this.state.typeaheadIndex||0;let z=S(T+K,V);this.state.allItems[z].kind===c.I.GroupTitle&&(z=S(z+K,V)),this.setState({typeaheadIndex:z});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=s.D}get menuPosition(){if(!window.getSelection)return"";const K=window.getSelection(),V=K&&K.anchorNode;if(V&&V.parentElement){const T=V.parentElement.getBoundingClientRect(),z=window.scrollX,w=window.scrollY;return`position: absolute; display: flex; top: ${T.top+w+T.height+6}px; left: ${T.left+z-2}px`}return""}render(){const{prefix:K,isOpen:V=!1,origin:T}=this.props,{allItems:z,listWidth:w,listHeight:H,itemHeight:G,hoveredItem:X,typeaheadIndex:k}=this.state,_=R(this.context),ee=X||k,J=z[X||k||0];return(0,t.jsxs)(O,{origin:T,isOpen:V,style:this.menuPosition,children:[(0,t.jsx)("ul",{role:"menu",className:_.typeahead,"data-testid":"typeahead",children:(0,t.jsx)(x.Y1,{ref:this.listRef,itemCount:z.length,itemSize:G,itemKey:Z=>{const te=z&&z[Z];return te?`${Z}-${te.label}`:`${Z}`},width:w,height:H,children:({index:Z,style:te})=>{const ae=z&&z[Z];return ae?(0,t.jsx)(b,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(ae):{},isSelected:k===null?!1:z[k]===ae,item:ae,prefix:K,style:te,onMouseEnter:()=>this.onMouseEnter(Z),onMouseLeave:this.onMouseLeave}):null}})}),ee&&(0,t.jsx)(C,{height:H,item:J})]})}}class O extends a.PureComponent{constructor(K){super(K);const{index:V=0,origin:T="query",style:z}=K;this.node=document.createElement("div"),this.node.setAttribute("style",z),this.node.classList.add(`slate-typeahead-${T}-${V}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),i.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const R=N=>({typeahead:(0,r.css)({position:"relative",zIndex:N.zIndex.typeahead,borderRadius:N.shape.radius.default,border:`1px solid ${N.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:N.components.panel.background,color:N.colors.text.primary,boxShadow:N.shadows.z2,strong:{color:N.v1.palette.yellow}})});var L=e(21573),B=e(41297),F=e(28012);const I=250;function U({onTypeahead:N,cleanText:K,onWillApplySuggestion:V,portalOrigin:T}){let z,w={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const H=(0,n.debounce)(W,I),G=X=>{w={...w,...X}};return{onBlur:(X,k,_)=>(w={...w,groupedItems:[]},_()),onClick:(X,k,_)=>(w={...w,groupedItems:[]},_()),onKeyDown:(X,k,_)=>{const J=w.groupedItems.length;switch(X.key){case"Escape":{if(J)return X.preventDefault(),w={...w,groupedItems:[]},k.insertText("");break}case"ArrowDown":case"ArrowUp":if(J){X.preventDefault(),z.moveMenuIndex(X.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(X.shiftKey||X.ctrlKey)&&J)return X.preventDefault(),z.insertSuggestion();break}case"Tab":{if(J)return X.preventDefault(),z.insertSuggestion();break}default:{X.key.length===1&&H(k,G,N,K);break}}return _()},commands:{selectSuggestion:(X,k)=>{const _=w.groupedItems;if(!_||!_.length)return X;const ee=X.applyTypeahead(k);return H(X,G,N,K),ee},applyTypeahead:(X,k)=>{let _=k.insertText||k.label;const ee=k.kind==="function",J=k.move||0,Z=J>0?J:0,te=J<0?-J:0,{typeaheadPrefix:ae,typeaheadText:re,typeaheadContext:ne}=w;V&&(_=V(_,{groupedItems:w.groupedItems,typeaheadContext:ne,typeaheadPrefix:ae,typeaheadText:re}));const{forward:ce,backward:le}=A(_,ae,re,ee,k.deleteBackwards,K);if(_.match(/\n/)){const he=(0,L.dF)(_);return X.deleteBackward(le).deleteForward(ce).insertFragment(he).focus(),X}return w={...w,groupedItems:[]},X.snapshotSelection().deleteBackward(le).deleteForward(ce).insertText(_).moveForward(Z).moveBackward(te).focus(),X}},renderEditor(X,k,_){if(k.value.selection.isExpanded)return _();const ee=_();return(0,t.jsxs)(t.Fragment,{children:[ee,(0,t.jsx)(M,{menuRef:J=>z=J,origin:T,prefix:w.typeaheadPrefix,isOpen:!!w.groupedItems.length,groupedItems:w.groupedItems,onSelectSuggestion:k.selectSuggestion})]})}}}const W=async(N,K,V,T)=>{if(!V)return;const{value:z}=N,{selection:w}=z,H=z.document.getClosestBlock(z.focusBlock.key),G=z.selection.start.offset-1,X=H&&H.getDecorations(N),k=X?X.filter(le=>le.start.offset<=G&&le.end.offset>G&&le.type===F.A).toArray():[],_=X&&X.filter(le=>le.end.offset<=G&&le.type===F.A&&le.data.get("className").includes("label-key")).last(),ee=_&&z.focusText.text.slice(_.start.offset,_.end.offset),J=k.map(le=>le.data.get("className")).join(" ").split(" ").filter(le=>le.length);let Z=z.focusText.text,te=Z.slice(0,w.focus.offset);k.length&&(Z=z.focusText.text.slice(k[0].start.offset,k[0].end.offset),te=z.focusText.text.slice(k[0].start.offset,w.focus.offset));const ae=te.match(/(?:!?=~?"?|")(.*)/);ae?te=ae[1]:T&&(te=T(te));const{suggestions:re,context:ne}=await V({prefix:te,text:Z,value:z,wrapperClasses:J,labelKey:ee||void 0,editor:N}),ce=re.map(le=>{if(!le.items)return le;const he=le.searchFunctionType||(le.prefixMatch?B.T.Prefix:B.T.Word),oe=B.H[he];let de={...le};return te&&(le.skipFilter||(de.items=de.items.filter(me=>(me.filterText||me.label).length>=te.length),de.items=oe(de.items,te)),de.items=de.items.filter(me=>!(me.insertText===te||(me.filterText??me.label)===te))),le.skipSort||(de.items=(0,n.sortBy)(de.items,me=>me.sortText===void 0?me.sortValue!==void 0?me.sortValue:me.label:me.sortText||me.label)),de}).filter(le=>le.items&&le.items.length);K({groupedItems:ce,typeaheadPrefix:te,typeaheadContext:ne,typeaheadText:Z}),N.blur().focus()};function A(N,K,V,T,z,w){const H=z||K.length,G=w?w(V):V,X=V.indexOf(K),k=X>-1?G.length-X-K.length:G.length-K.length;return{forward:!!(K&&k>0||N===V)&&!T?k+X:0,backward:H}}},65268:(q,j,e)=>{"use strict";e.d(j,{k:()=>F});var t=e(74848),n=e(17437),r=e(29675);function a(I){return(0,n.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function i(I){return(0,n.css)({".alert-state-paused, .alert-state-pending":{color:I.colors.text.secondary,fontWeight:I.typography.fontWeightMedium},".alert-state-ok":{color:I.colors.success.text,fontWeight:I.typography.fontWeightMedium},".alert-state-warning":{color:I.colors.warning.text,fontWeight:I.typography.fontWeightMedium},".alert-state-critical":{color:I.colors.error.text,fontWeight:I.typography.fontWeightMedium}})}function x(I){return(0,n.css)({".panel-options-group":{borderBottom:`1px solid ${I.colors.border.weak}`},".panel-options-group__header":{padding:I.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:I.colors.text.primary,"&:hover":{background:I.colors.emphasize(I.colors.background.primary,.03)}},".panel-options-group__icon":{color:I.colors.text.secondary,marginRight:I.spacing(1),padding:I.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:I.spacing(1,2,1,4)}})}function s(I){return(0,n.css)({".card-section":{marginBottom:I.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:I.colors.background.secondary,boxShadow:"none",padding:I.spacing(2),borderRadius:"4px","&:hover":{background:I.colors.emphasize(I.colors.background.secondary,.03)},".label-tag":{marginLeft:I.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:I.spacing(2)},".card-item-type":{color:I.colors.text.secondary,textTransform:"uppercase",fontSize:I.typography.size.sm,fontWeight:I.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:I.typography.size.sm},".card-item-name":{color:I.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:I.spacing(1)},".card-item-sub-name":{color:I.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:I.colors.text.secondary,textTransform:"uppercase",marginBottom:I.spacing(2),fontSize:I.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:I.typography.size.sm,display:"inline-block",marginLeft:I.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:I.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:I.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:I.typography.h3.fontSize},[I.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[I.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[I.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:I.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:I.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:I.typography.h4.fontSize},".card-item-sub-name":{fontSize:I.typography.size.sm},".layout-selector":{marginRight:0}}})}function c(I){return(0,n.css)({"code, pre, kbd, samp":{...I.typography.code,fontSize:I.typography.bodySmall.fontSize,backgroundColor:I.colors.background.primary,color:I.colors.text.primary,border:`1px solid ${I.colors.border.medium}`,borderRadius:"4px"},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:I.spacing(0,0,2),lineHeight:I.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function d(I){return(0,n.css)({".react-resizable-handle":{visibility:"hidden"},".react-grid-item, #grafana-portal-container":{touchAction:"initial !important","&:hover":{".react-resizable-handle":{visibility:"visible"}}},[I.breakpoints.down("md")]:{".react-grid-layout":{height:"unset !important"},".react-grid-item":{display:"block !important",transitionProperty:"none !important",position:"unset !important",transform:"translate(0px, 0px) !important",marginBottom:I.spacing(2)},".panel-repeater-grid-item":{height:"auto !important"}},".react-grid-item.react-grid-placeholder":{boxShadow:`0 0 4px ${I.colors.primary.border} !important`,background:`${I.colors.primary.transparent} !important`,zIndex:"-1 !important",opacity:"unset !important"},".react-grid-item > .react-resizable-handle::after":{borderRight:`2px solid ${I.isDark?I.v1.palette.gray1:I.v1.palette.gray3} !important`,borderBottom:`2px solid ${I.isDark?I.v1.palette.gray1:I.v1.palette.gray3} !important`},".react-grid-item.resizing.panel, .react-grid-item.panel.dropdown-menu-open, .react-grid-item.react-draggable-dragging.panel":{zIndex:I.zIndex.dropdown},".react-grid-item.cssTransforms":{transitionProperty:"none !important"},[I.transitions.handleMotion("no-preference")]:{".react-grid-layout--enable-move-animations":{".react-grid-item.cssTransforms":{transitionProperty:"transform !important"}}},".dashboard-selected-element":{outline:`2px dashed ${I.colors.primary.border}`,outlineOffset:"0px",borderRadius:"2px"}})}function u(I){return(0,n.css)({".delta-html":{background:I.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:I.colors.text.primary,fontFamily:I.typography.fontFamilyMonospace,fontSize:I.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:I.colors.text.secondary,display:"inline-block",fontSize:I.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:I.colors.text.primary,fontSize:I.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:I.v1.palette.gray5,".diff-line-number":{color:I.colors.text.primary}},".diff-json-new":{backgroundColor:I.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:I.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:I.colors.primary.shade},".diff-json-deleted":{backgroundColor:I.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:I.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:I.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:I.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:I.colors.action.hover,borderRadius:"3px",color:I.colors.text.primary,display:"inline",fontSize:`${I.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:I.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:I.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var g=e(94963);function o(I){return(0,n.css)({"*, *::before, *::after":{boxSizing:"inherit"},"[tabindex='-1']:focus":{outline:"none !important"},html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",boxSizing:"border-box",height:"100%",fontSize:`${I.typography.htmlFontSize}px`,fontFamily:I.typography.fontFamily,lineHeight:I.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:I.colors.mode},body:{height:"100%",width:"100%",position:"unset",color:I.colors.text.primary,backgroundColor:I.colors.background.canvas,overflowY:"auto !important",paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0},fontVariantLigatures:"no-contextual",...I.typography.body},"h1, .h1":E(I.typography.h1),"h2, .h2":E(I.typography.h2),"h3, .h3":E(I.typography.h3),"h4, .h4":E(I.typography.h4),"h5, .h5":E(I.typography.h5),"h6, .h6":E(I.typography.h6),p:{margin:I.spacing(0,0,2)},textarea:{overflow:"auto",resize:"vertical"},button:{letterSpacing:I.typography.body.letterSpacing,"&:focus-visible":(0,g.getFocusStyles)(I),"&:focus":{outline:"none"}},label:{display:"inline-block"},figure:{margin:I.spacing(0,0,2)},img:{verticalAlign:"middle"},fieldset:{minWidth:0,padding:0,margin:0,border:0},legend:{display:"block",width:"100%",padding:0,marginBottom:I.spacing(1),fontSize:I.spacing(3),lineHeight:"inherit",border:0},"small, .small":{fontSize:I.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:I.typography.fontWeightMedium},em:{fontStyle:"italic",color:I.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:I.spacing(0,0,0,2),margin:I.spacing(0,0,2),borderLeft:`5px solid ${I.v1.palette.gray3}`,p:{marginBottom:0,fontSize:I.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:I.typography.body.lineHeight,color:I.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:I.spacing(2),fontStyle:"normal",lineHeight:I.typography.body.lineHeight},"a.external-link":{color:I.colors.text.link,textDecoration:"normal","&:hover":{color:I.colors.text.link,textDecoration:"underline"}},".link":{color:I.colors.text.primary,cursor:"pointer"},".link:hover":{color:I.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:I.spacing(2),marginBottom:I.spacing(2),border:0,borderTop:`1px solid ${I.colors.border.medium}`},"mark, .mark":{background:I.colors.warning.main},"ul, ol, dl":{marginTop:0,marginBottom:0,padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:I.typography.body.lineHeight},dd:{marginBottom:I.spacing(1),marginLeft:0},"dt, dd":{lineHeight:I.typography.body.lineHeight},dt:{fontWeight:I.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{borderRadius:0,color:"inherit",font:"inherit",lineHeight:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]':{WebkitAppearance:"none"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{backgroundColor:"transparent",borderCollapse:"collapse",borderSpacing:0},caption:{paddingTop:I.spacing(.5),paddingBottom:I.spacing(.5),color:I.colors.text.secondary,textAlign:"left",captionSide:"bottom"},th:{fontWeight:I.typography.fontWeightMedium,textAlign:"left"},"td, th":{padding:0},".muted":{color:I.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:I.colors.text.primary},".text-warning":{color:I.colors.warning.text,"&:hover, &:focus":{color:I.colors.emphasize(I.colors.warning.text,.15)}},".text-error":{color:I.colors.error.text,"&:hover, &:focus":{color:I.colors.emphasize(I.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:I.colors.emphasize(I.colors.success.text,.15)}},a:{cursor:"pointer",color:I.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,g.getFocusStyles)(I),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},"[role='button']":{cursor:"pointer"},"[hidden]":{display:"none !important"},"a, area, button, [role='button'], input, label, select, summary, textarea":{touchAction:"manipulation"},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:I.components.textHighlight.background,color:I.components.textHighlight.text,padding:0},".template-variable":{color:I.colors.primary.text},".modal-header-title":{fontSize:I.typography.size.lg,float:"left",paddingTop:I.spacing(1),margin:I.spacing(0,2)}})}function E(I){return{margin:0,fontSize:I.fontSize,lineHeight:I.lineHeight,fontWeight:I.fontWeight,letterSpacing:I.letterSpacing,fontFamily:I.fontFamily,marginBottom:"0.45em"}}function m(I){return(0,n.css)({"iframe.intercom-borderless-frame":{colorScheme:I.colors.mode}})}function f(I){return(0,n.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-of-type(odd)":{background:I.colors.emphasize(I.colors.background.primary,.02)}},th:{width:"auto",padding:I.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:I.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:I.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:I.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:"50%"},"&--hover":{"tbody tr:hover":{background:I.colors.emphasize(I.colors.background.primary,.05)}}}})}function p(I){const U=typeof window<"u"&&window.__grafana_public_path__,W=U?`${U}fonts/`:"public/fonts/";return(0,n.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${W}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${W}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${W}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${W}inter/Inter-Medium.woff2') format('woff2')`}}])}function h(I){return(0,n.css)({"input, button, select, textarea":{fontFamily:I.typography.body.fontFamily,fontSize:I.typography.body.fontSize,fontWeight:I.typography.body.fontWeight,lineHeight:I.typography.body.lineHeight},"input, select":{backgroundColor:I.components.input.background,color:I.components.input.text,border:"none",boxShadow:"none"},"input, textarea":{"&::placeholder":{color:I.colors.text.disabled}},'input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button':{WebkitAppearance:"none",margin:0},'input[type="number"]':{MozAppearance:"textfield"},'select, input[type="file"]':{height:I.components.height.md,lineHeight:I.components.height.md},select:{width:"220px",border:`1px solid ${I.components.input.borderColor}`,backgroundColor:I.components.input.background},"select[multiple], select[size], textarea":{height:"auto"},'select:focus, input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus':{outline:"5px auto -webkit-focus-ring-color",outlineOffset:"-2px"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"},"input[disabled], select[disabled], textarea[disabled], input[readonly], select[readonly], textarea[readonly]":{cursor:"not-allowed",backgroundColor:I.colors.action.disabledBackground},'input[type="radio"][disabled], input[type="checkbox"][disabled], input[type="radio"][readonly], input[type="checkbox"][readonly]':{cursor:"not-allowed",backgroundColor:"transparent"},"input:-webkit-autofill, input:-webkit-autofill:hover, input:-webkit-autofill:focus, input:-webkit-autofill, textarea:-webkit-autofill, textarea:-webkit-autofill:hover, textarea:-webkit-autofill:focus, select:-webkit-autofill, select:-webkit-autofill:hover, select:-webkit-autofill:focus":{WebkitBoxShadow:`0 0 0px 1000px ${I.components.input.background} inset !important`,WebkitTextFillColor:I.components.input.text,boxShadow:`0 0 0px 1000px ${I.components.input.background} inset`,border:`1px solid ${I.components.input.background}`},".gf-form":{display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",marginBottom:I.spacing(.5),"&--offset-1":{marginLeft:I.spacing(2)},"&--grow":{flexGrow:1},"&--flex-end":{justifyContent:"flex-end"},"&--align-center":{alignContent:"center"},"&--alt":{flexDirection:"column",alignItems:"flex-start",".gf-form-label":{padding:"4px 0"}}},".gf-form--has-input-icon":{position:"relative",marginRight:I.spacing(.5),".gf-form-input-icon":{position:"absolute",top:"8px",fontSize:I.typography.size.lg,left:"10px",color:I.colors.text.disabled},"> input":{paddingLeft:"35px","&:focus + .gf-form-input-icon":{color:I.colors.text.secondary}},".Select--multi .Select-multi-value-wrapper, .Select-placeholder":{paddingLeft:"30px"}},".gf-form-disabled":{color:I.colors.text.secondary,".gf-form-select-wrapper::after":{color:I.colors.text.secondary},"a, .gf-form-input":{color:I.colors.text.secondary}},".gf-form-group":{marginBottom:I.spacing(5)},".gf-form-inline":{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start","&--nowrap":{flexWrap:"nowrap"},"&--xs-view-flex-column":{flexDirection:"row",flexWrap:"nowrap",[I.breakpoints.down("sm")]:{flexDirection:"column"}},".select-container":{marginRight:I.spacing(.5)},".gf-form-spacing":{marginRight:I.spacing(.5)}},".gf-form-button-row":{paddingTop:I.spacing(3),"a, button":{marginRight:I.spacing(2)}},".gf-form-label":{display:"flex",alignItems:"center",padding:I.spacing(0,1),flexShrink:0,fontWeight:I.typography.fontWeightMedium,fontSize:I.typography.size.sm,backgroundColor:I.colors.background.secondary,height:"32px",lineHeight:"32px",marginRight:I.spacing(.5),borderRadius:I.shape.radius.default,justifyContent:"space-between",border:"none","&--grow":{flexGrow:1},"&--transparent":{backgroundColor:"transparent",border:0,textAlign:"right",paddingLeft:0},"&--variable":{color:I.colors.primary.text,background:I.components.panel.background,border:`1px solid ${I.components.panel.borderColor}`},"&--btn":{border:"none",borderRadius:I.shape.radius.default,"&:hover":{background:I.colors.background.secondary,color:I.colors.text.primary}},"&:disabled":{color:I.colors.text.secondary}},".gf-form-label + .gf-form-label":{marginRight:I.spacing(.5)},".gf-form-pre":{display:"block !important",flexGrow:1,margin:0,marginRight:I.spacing(.5),border:"1px solid transparent",borderLeft:"none",borderRadius:I.shape.radius.default},".gf-form-textarea":{maxWidth:"650px"},".gf-form-input":{display:"block",width:"100%",height:"32px",padding:I.spacing(0,1),fontSize:I.typography.size.md,lineHeight:"18px",color:I.components.input.text,backgroundColor:I.components.input.background,backgroundImage:"none",backgroundClip:"padding-box",border:`1px solid ${I.components.input.borderColor}`,borderRadius:I.shape.radius.default,marginRight:I.spacing(.5),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&textarea":{overflow:"auto",whiteSpace:"pre-wrap",padding:`6px ${I.spacing(1)}`,minHeight:"32px",height:"auto"},"&::-ms-expand":{backgroundColor:"transparent",border:0,display:"none"},"&:focus":{borderColor:I.colors.primary.border,outline:"none"},"&::placeholder":{color:I.colors.text.disabled,opacity:1},"&:disabled, &[readonly]":{backgroundColor:I.colors.action.disabledBackground,opacity:1},"&:disabled":{cursor:"not-allowed"},"&.gf-size-auto":{width:"auto"},"&--dropdown":{paddingRight:I.spacing(3),position:"relative",display:"flex",alignItems:"center","&::after":{position:"absolute",top:"36%",right:"11px",fontSize:"11px",backgroundColor:"transparent",color:I.colors.text.primary,font:`normal normal normal ${I.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none"}},"&--has-help-icon":{paddingRight:I.spacing(4)}},".gf-form-select-wrapper":{position:"relative",backgroundColor:I.components.input.background,marginRight:I.spacing(.5),".gf-form-select-icon":{position:"absolute",zIndex:1,top:"50%",marginTop:"-7px","+ .gf-form-input":{position:"relative",zIndex:2,paddingLeft:I.spacing(4),backgroundColor:"transparent",option:{color:I.v1.palette.black}}},".gf-form-input":{marginRight:0,lineHeight:"32px"},"select.gf-form-input":{textIndent:"0.01px",textOverflow:"''",paddingRight:I.spacing(4),appearance:"none","&:-moz-focusring":{outline:"none",color:"transparent",textShadow:`0 0 0 ${I.colors.text.primary}`},"&.ng-empty":{color:I.colors.text.secondary}},"&::after":{position:"absolute",top:"36%",right:"11px",backgroundColor:"transparent",color:I.colors.text.primary,font:`normal normal normal ${I.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none",fontSize:"11px"},"&--has-help-icon":{"&::after":{right:I.spacing(4)}}},".gf-form--v-stretch":{alignItems:"stretch"},".gf-form-btn":{padding:I.spacing(0,1),marginRight:I.spacing(.5),lineHeight:"18px",fontSize:I.typography.size.sm,flexShrink:0,flexGrow:0},".gf-form-help-icon":{flexGrow:0,color:I.colors.text.secondary,"&:hover":{color:I.colors.text.primary}},".cta-form":{position:"relative",padding:I.spacing(3),backgroundColor:I.colors.background.secondary,marginBottom:I.spacing(3),borderTop:`3px solid ${I.colors.success.main}`},".input-small":{width:"90px"}})}function D(I){return(0,n.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:I.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:I.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:I.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:I.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:I.isDark?I.colors.primary.text:I.colors.primary.main},".json-formatter-boolean":{color:I.isDark?I.colors.primary.text:I.colors.error.main},".json-formatter-null":{color:I.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:I.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:I.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:I.isDark?"#027bff":I.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:I.isDark?"#9494ff":I.colors.primary.main},".json-formatter-key":{color:I.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:I.spacing(.25),marginRight:I.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:I.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:I.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:I.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function C(I){return(0,n.css)({".gf-form-select-box__control":{width:"100%",marginRight:I.spacing(.5),backgroundColor:I.components.input.background,border:`1px solid ${I.components.input.borderColor}`,borderRadius:I.shape.radius.default,color:I.components.input.text,cursor:"default",height:I.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:I.components.input.background,borderColor:I.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${I.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:I.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:I.colors.background.primary,boxShadow:I.shadows.z3,position:"absolute",zIndex:I.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:I.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:I.components.input.background,"&.gf-form-select-box__option--is-focused":{color:I.colors.text.primary,background:I.colors.action.hover,borderImage:I.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:I.colors.text.primary}}},".gf-form-select-box__placeholder":{color:I.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:I.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:I.typography.bodySmall.fontSize,color:I.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${I.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function l(I){return(0,n.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:I.spacing(3),marginBottom:I.spacing(2)},table:{marginBottom:I.spacing(2),"td, th":{padding:I.spacing(.5,1)},th:{fontWeight:I.typography.fontWeightMedium,background:I.colors.background.secondary}},"table, th, td":{border:`1px solid ${I.colors.border.medium}`,borderCollapse:"collapse"},a:{color:I.colors.text.link,textDecoration:"none","&:hover":{color:I.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function v(I){const U=I.breakpoints.values.xxl+I.spacing.gridSize*2+I.components.sidemenu.width;return(0,n.css)({".grafana-app":{display:"flex",flexDirection:"column",height:"100vh"},".main-view":{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:I.spacing(2),paddingRight:I.spacing(2),[I.breakpoints.up("sm")]:{margin:I.spacing(0,1)},[I.breakpoints.up("md")]:{margin:I.spacing(0,2)},[`@media (min-width: ${U}px)`]:{maxWidth:`${I.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:I.spacing(2),paddingLeft:I.spacing(2),paddingRight:I.spacing(2)},".page-body":{padding:I.spacing(1),background:I.components.panel.background,border:`1px solid ${I.components.panel.borderColor}`,marginBottom:"32px",[I.breakpoints.up("md")]:{padding:I.spacing(2)},[I.breakpoints.up("lg")]:{padding:I.spacing(3)}},".page-heading":{fontSize:I.typography.h4.fontSize,marginTop:0,marginBottom:I.spacing(2)},".page-action-bar":{marginBottom:I.spacing(2),display:"flex",alignItems:"flex-start",gap:I.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:I.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:I.spacing(2)},".page-sub-heading-icon":{marginLeft:I.spacing(1),marginTop:I.spacing(.5)},".page-hidden":{display:"none"}})}function y(I){return(0,n.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:I.colors.text.secondary}}},".query-keyword":{fontWeight:I.typography.fontWeightMedium,color:`${I.colors.primary.text} !important`},".query-part":{backgroundColor:I.colors.background.secondary,"&:hover":{background:I.colors.emphasize(I.colors.background.secondary,.03)}},".query-segment-operator":{color:`${I.v1.palette.orange} !important`},".tight-form-func":{background:I.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:I.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}var P=e(71815);const b=I=>(0,n.css)({".react-loading-skeleton":P.Q});function S(I){return(0,n.css)({".slate-query-field":{fontSize:I.typography.fontSize,fontFamily:I.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:I.colors.text.primary,backgroundColor:I.components.input.background,backgroundImage:"none",border:`1px solid ${I.components.input.borderColor}`,borderRadius:I.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:I.zIndex.typeahead,borderRadius:I.shape.radius.default,border:`1px solid ${I.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:I.components.panel.background,color:I.colors.text.primary,boxShadow:I.shadows.z2},".typeahead-group__title":{color:I.colors.text.secondary,fontSize:I.typography.size.sm,lineHeight:I.typography.body.lineHeight,padding:I.spacing(1)},".typeahead-item":{height:"auto",fontFamily:I.typography.fontFamilyMonospace,padding:I.spacing(1,1,1,2),fontSize:I.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:I.isDark?I.v1.palette.dark9:I.v1.palette.gray6,".typeahead-item-hint":{fontSize:I.typography.size.xs,color:I.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:I.v1.palette.yellow,borderBottom:`1px solid ${I.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:I.colors.text.secondary},".token.variable, .token.entity":{color:I.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:I.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:I.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:I.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:I.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function M(I){return(0,n.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function O(I,U,W="#fff",A="0px 1px 0 rgba(0, 0, 0, 0.1)"){return{backgroundColor:I,backgroundImage:`linear-gradient(to bottom, ${I}, ${U})`,backgroundRepeat:"repeat-x",color:W,textShadow:A,borderColor:I,"&:hover, &:focus, &:active, &.active, &.disabled, &[disabled]":{color:W,backgroundImage:"none",backgroundColor:I}}}function R(I,U,W,A){return{padding:`${I} ${U}`,fontSize:W,borderRadius:A}}function L(I,U){let W={};for(let A=1;A<=U;A++){const N=`${I.spacing(2*A)} !important`;W[`.width-${A}`]={width:N},W[`.max-width-${A}`]={maxWidth:N,flexGrow:1},W[`.min-width-${A}`]={minWidth:N},W[`.offset-width-${A}`]={marginLeft:N}}return W}function B(I){return(0,n.css)({".highlight-word":{color:I.v1.palette.orange},".hide":{display:"none"},".show":{display:"block"},".invisible":{visibility:"hidden !important"},".absolute":{position:"absolute"},".flex-grow-1":{flexGrow:1},".flex-shrink-1":{flexShrink:1},".flex-shrink-0":{flexShrink:0},".center-vh":{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",justifyItems:"center"},".btn":{display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:I.typography.fontWeightMedium,lineHeight:I.typography.body.lineHeight,textAlign:"center",verticalAlign:"middle",cursor:"pointer",border:"none",height:`${I.spacing.gridSize*I.components.height.md}px`,...R(I.spacing(0),I.spacing(2),`${I.typography.fontSize}px`,I.shape.radius.default),"&, &:active, &.active":{"&:focus, &.focus":{outline:"none"}},"&:focus, &:hover":{textDecoration:"none"},"&.focus":{textDecoration:"none"},"&:active, &.active":{backgroundImage:"none",outline:0},"&.disabled, &[disabled], &:disabled":{cursor:"not-allowed",opacity:.65,boxShadow:"none",pointerEvents:"none"}},".btn-small":{...R(I.spacing(.5),I.spacing(1),I.typography.size.sm,I.shape.radius.default),height:`${I.spacing.gridSize*I.components.height.sm}px`},".btn-mini":{...R(I.spacing(.5),I.spacing(1),I.typography.size.sm,I.shape.radius.default),height:`${I.spacing.gridSize*I.components.height.sm}px`},".btn-success, .btn-primary":{...O(I.colors.primary.main,I.colors.primary.shade)},".btn-danger":{...O(I.colors.error.main,I.colors.error.shade)},".btn-secondary":{...O(I.colors.secondary.main,I.colors.secondary.shade,I.colors.text.primary)},".btn-inverse":{...O(I.isDark?I.v1.palette.dark6:I.v1.palette.gray5,I.isDark?I.v1.palette.dark5:I.v1.palette.gray4,I.colors.text.primary),"&":{boxShadow:"none"}},".typeahead":{zIndex:I.zIndex.typeahead},...L(I,30),".row":{display:"flex",flexWrap:"wrap",marginLeft:`calc(${I.spacing(4)} / -2)`,marginRight:`calc(${I.spacing(4)} / -2)`},".container":{marginLeft:"auto",marginRight:"auto",paddingLeft:`calc(${I.spacing(4)} / 2)`,paddingRight:`calc(${I.spacing(4)} / 2)`,[I.breakpoints.up("sm")]:{maxWidth:I.breakpoints.values.sm},[I.breakpoints.up("md")]:{maxWidth:I.breakpoints.values.md},[I.breakpoints.up("lg")]:{maxWidth:I.breakpoints.values.lg},[I.breakpoints.up("xl")]:{maxWidth:I.breakpoints.values.xl}}})}function F(){const I=(0,r.$j)();return(0,t.jsx)(n.Global,{styles:[a(I),x(I),i(I),c(I),u(I),d(I),o(I),m(I),f(I),p(I),h(I),D(I),s(I),l(I),v(I),y(I),b(I),S(I),M(I),B(I),C(I)]})}},83319:(q,j,e)=>{"use strict";e.d(j,{kH:()=>c.k,Dx:()=>t.D,O4:()=>i,mG:()=>x,fq:()=>n.fq,YF:()=>d,N3:()=>s.N,IS:()=>n.IS,of:()=>n.of,DP:()=>n.DP,$j:()=>n.$j,SL:()=>n.SL,cV:()=>n.cV});var t=e(15580),n=e(29675),r=e(10468);let a;const i=(u="dark")=>a?a(u):(0,r.a)({colors:{mode:u}}).v1,x=u=>(a=u,()=>{a=null});var s=e(90617),c=e(65268),d=e(94963)},45696:(q,j,e)=>{"use strict";e.d(j,{I:()=>t});var t=(n=>(n.GroupTitle="GroupTitle",n))(t||{})},83795:()=>{"use strict"},8404:(q,j,e)=>{"use strict";e.r(j),e.d(j,{CompletionItemKind:()=>i.I,getAvailableIcons:()=>c.GO,getFieldTypeIcon:()=>c.SS,getFieldTypeIconName:()=>c.lV,isIconSize:()=>c.rJ,toIconName:()=>c.Uo});var t=e(409),n=e.n(t),f={};for(const p in t)p!=="default"&&(f[p]=()=>t[p]);e.d(j,f);var r=e(40156),a=e.n(r),f={};for(const p in r)p!=="default"&&(f[p]=()=>r[p]);e.d(j,f);var i=e(45696),x=e(83795),s=e.n(x),f={};for(const p in x)["default","CompletionItemKind"].indexOf(p)<0&&(f[p]=()=>x[p]);e.d(j,f);var c=e(22399),d=e(79902),u=e.n(d),f={};for(const p in d)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(p)<0&&(f[p]=()=>d[p]);e.d(j,f);var g=e(98791),o=e.n(g),f={};for(const p in g)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(p)<0&&(f[p]=()=>g[p]);e.d(j,f);var E=e(71986),m=e.n(E),f={};for(const p in E)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(p)<0&&(f[p]=()=>E[p]);e.d(j,f)},40156:()=>{"use strict"},71986:()=>{"use strict"},79902:()=>{"use strict"},98791:()=>{"use strict"},409:()=>{"use strict"},66631:(q,j,e)=>{"use strict";e.d(j,{Q:()=>t});const t=(n,r)=>{n.key==="Tab"||n.altKey||n.ctrlKey||n.metaKey||(n.stopPropagation(),n.key==="Escape"&&r())}},41090:(q,j,e)=>{"use strict";e.d(j,{Ih:()=>h,Mk:()=>i,Tj:()=>g,UJ:()=>u,Xw:()=>x,ct:()=>d,mZ:()=>p,nO:()=>c,sg:()=>f,xj:()=>s});var t=e(2543),n=e.n(t),r=e(84140);const a=4,i="rgba(0, 211, 255, 1)",x="rgba(11, 237, 50, 1)",s="rgba(237, 46, 24, 1)",c="rgba(150, 150, 150, 1)",d="rgba(247, 149, 32, 1)",u=.09,g=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function o(D){const C=(0,t.map)(D,E),l=(0,t.sortBy)(C,["h"]),v=(0,t.chunk)(l,a),y=(0,t.map)(v,b=>(0,t.sortBy)(b,"l")),P=(0,t.flattenDeep)((0,t.zip)(...y));return(0,t.map)(P,m)}function E(D){return(0,r.A)(D).toHsl()}function m(D){return(0,r.A)(D).toHexString()}function f(D){return(0,r.A)(D).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function p(D,C){const l=(0,r.A)(D),v=l.getBrightness();return l.getAlpha()<.3?C?"rgb(247, 248, 250)":"rgb(32, 34, 38)":v>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let h=o(g)},27821:(q,j,e)=>{"use strict";e.d(j,{H:()=>n,J:()=>t});const t=r=>r().map(a=>({label:a.title,ariaLabel:a.title,url:a.href,target:a.target,icon:`${a.target==="_blank"?"external-link-alt":"link"}`,onClick:a.onClick})),n=r=>r.map(a=>({label:a.title,ariaLabel:a.title,icon:"record-audio",onClick:a.onClick}))},77595:(q,j,e)=>{"use strict";e.d(j,{h:()=>t});function t(n,r,a){}},93644:(q,j,e)=>{"use strict";e.d(j,{i:()=>t});function t(n){const a=n.lastIndexOf("."),i=n.substring(a),x=n.substring(0,a);return x.length<16?n:`${x.substring(0,16)}...${i}`}},15728:(q,j,e)=>{"use strict";e.d(j,{I:()=>r});var t=e(2543),n=e.n(t);function r(a,i){let x=0,s=a.indexOf(i);i=i.replace(/\s/g,"");const c=[];if(s!==-1)return{distance:0,found:!0,ranges:[{start:s,end:s+i.length-1}]};for(const d of i){const u=a.indexOf(d,s);if(u===-1)return{distance:1/0,ranges:[],found:!1};if(s!==-1&&(x+=u-s),s=u+1,c.length===0)c.push({start:u,end:u});else{const g=(0,t.last)(c);u===g.end+1?g.end++:c.push({start:u,end:u})}}return{distance:x,ranges:c,found:!0}}},27104:(q,j,e)=>{"use strict";e.d(j,{xj:()=>i.xj,Mk:()=>i.Mk,bk:()=>t,Pw:()=>x.Pw,nO:()=>i.nO,uc:()=>D,Xw:()=>i.Xw,ct:()=>i.ct,UJ:()=>i.UJ,zt:()=>a,yx:()=>s.yx,Tt:()=>f.T,HD:()=>c.H,hF:()=>h.h,Vr:()=>E.Vr,Tj:()=>i.Tj,h:()=>p.h,It:()=>C.I,Yc:()=>E.Yc,kl:()=>o.k,XJ:()=>g,yC:()=>d.yC,JF:()=>d.JF,MC:()=>d.MC,mZ:()=>i.mZ,sg:()=>i.sg,K:()=>x.K,Jl:()=>c.J,DD:()=>l.D,dF:()=>s.dF,mO:()=>s.mO,kD:()=>E.kD,RP:()=>x.RP,Ih:()=>i.Ih,CH:()=>m.C,tf:()=>x.tf});var t={};e.r(t),e.d(t,{getNextCharacter:()=>r,getPreviousCousin:()=>n}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(v){const y=(this.document||this.ownerDocument).querySelectorAll(v);let P=this,b;do{for(b=y.length;--b>=0&&y.item(b)!==P;);P=P.parentElement}while(b<0&&P);return P});function n(v,y){let P=v.parentElement.previousSibling,b;for(;P;){if(b=P.querySelector(y),b)return b;P=P.previousSibling}}function r(v){const y=(v||window).getSelection();if(!y||!y.anchorNode)return null;const P=y.getRangeAt(0),b=y.anchorNode.textContent,S=P.startOffset;return b.slice(S,S+1)}var a=e(98842),i=e(41090),x=e(87916),s=e(21573),c=e(27821),d=e(27671);let u=null;function g(){if(u!==null)return u;if(typeof document<"u"){const v=document.createElement("div"),y={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(y).map(P=>{v.style[P]=y[P]}),document.body.appendChild(v),u=v.offsetWidth-v.clientWidth,document.body.removeChild(v)}else u=0;return u||0}var o=e(17444),E=e(91371),m=e(34798),f=e(41297),p=e(61978),h=e(77595),D=(v=>(v.id="id",v.title="title",v.subTitle="subTitle",v.mainStat="mainStat",v.secondaryStat="secondaryStat",v.source="source",v.target="target",v.detail="detail__",v.arc="arc__",v.color="color",v))(D||{}),C=e(15728),l=e(4438)},4438:(q,j,e)=>{"use strict";e.d(j,{D:()=>t});function t(n,r,a,i){if(n>r){const x=`[Combobox] Items exceed the recommended amount ${r}.`;console.warn(x,{itemsCount:""+n,recommendedAmount:""+r,"aria-labelledby":i??"",id:a??""})}}},61978:(q,j,e)=>{"use strict";e.d(j,{h:()=>a});var t=e(2543),n=e.n(t);const r=(0,t.throttle)((...i)=>{console.log(...i)},500),a=i=>{let x=!1;return typeof window<"u"&&(x=window.localStorage.getItem("grafana.debug")==="true"),{logger:(s,c=!1,...d)=>{},enable:()=>x=!0,disable:()=>x=!1,isEnabled:()=>x}}},91371:(q,j,e)=>{"use strict";e.d(j,{Vr:()=>s,Yc:()=>i,kD:()=>x});let t;const n=new Map,r=500;let a="";function i(){return t||(t=document.createElement("canvas").getContext("2d")),t}function x(c,d,u=400){const g=`${u} ${d}px 'Inter'`,o=c+g,E=n.get(o);if(E)return E;const m=i();a!==g&&(m.font=a=g);const f=m.measureText(c);return n.size===r&&n.clear(),n.set(o,f),f}function s(c,d,u,g,o,E){const m=x(c,14,E),f=d/(m.width+2)*14,p=u/g,h=Math.min(p,f);return Math.min(h,o??h)}},98842:(q,j,e)=>{"use strict";e.r(j),e.d(j,{getChildId:()=>n,renderOrCallToRender:()=>r});var t=e(96540);function n(a){let i;const x=t.Children.only(a);return"id"in x?.props?i=x.props.id:"inputId"in x.props&&(i=x?.props.inputId),typeof i=="string"?i:void 0}function r(a,i){if(t.isValidElement(a)||typeof a=="string"||typeof a=="number")return a;if(typeof a=="function"&&i)return a(i);throw new Error(`${a} is not a React element nor a function that returns React element`)}},41297:(q,j,e)=>{"use strict";e.d(j,{H:()=>x,T:()=>n});var t=e(15728),n=(s=>(s.Word="Word",s.Prefix="Prefix",s.Fuzzy="Fuzzy",s))(n||{});const x={Word:(s,c)=>s.filter(d=>(d.filterText||d.label).includes(c)),Prefix:(s,c)=>s.filter(d=>(d.filterText||d.label).startsWith(c)),Fuzzy:(s,c)=>(c=c.toLowerCase(),s.filter(d=>{const{distance:u,ranges:g,found:o}=(0,t.I)(d.label.toLowerCase(),c);return o?(d.sortValue=u,d.highlightParts=g,!0):!1}))}},71815:(q,j,e)=>{"use strict";e.d(j,{Q:()=>a,j:()=>i});var t=e(74848),n=e(22803);const a={animationName:(0,n.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},i=(x,s)=>Object.assign(x,{Skeleton:d=>(0,t.jsx)(s,{...d,rootProps:{style:a}})})},21573:(q,j,e)=>{"use strict";e.d(j,{dF:()=>r,mO:()=>a,yx:()=>n});var t=e(82611);const n={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},r=(i,x)=>{const s=i.split(`
`).map(d=>t.Block.create({type:"code_line",nodes:[t.Text.create(d)]})),c=t.Block.create({data:{syntax:x},type:"code_block",nodes:s});return t.Document.create({nodes:[c]})},a=(i,x)=>{const s=r(i,x);return t.Value.create({document:s})}},17444:(q,j,e)=>{"use strict";e.d(j,{k:()=>t});const t=(n,r)=>{let a;if(n.getLinks&&(a=n.getLinks({valueRowIndex:r.index})),!!a){for(let i=0;i<a?.length;i++)if(a[i].onClick){const x=a[i].onClick;a[i].onClick=s=>{s.ctrlKey||s.metaKey||s.shiftKey||(s.preventDefault(),x(s,{field:n,rowIndex:r.index}))}}return a}}},27671:(q,j,e)=>{"use strict";e.d(j,{JF:()=>r,MC:()=>a,yC:()=>i});const t=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],n=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function r(c=""){const d=x(c.toLowerCase());return Math.abs(d%t.length)}function a(c=""){const d=r(c);return i(d)}function i(c){return{color:t[c],borderColor:n[c]}}function x(c){let d=5381;for(let u=0;u<c.length;u++)d=(d<<5)+d+c.charCodeAt(u);return d}var s={getTagColorsFromName:a}},34798:(q,j,e)=>{"use strict";e.d(j,{C:()=>n});var t=e(96540);function n(){const[r,a]=(0,t.useState)(0);return(0,t.useCallback)(()=>a(i=>i+1),[])}},87916:(q,j,e)=>{"use strict";e.d(j,{K:()=>r,Pw:()=>t,RP:()=>a,tf:()=>n});var t=(i=>(i.onBlur="onBlur",i.onFocus="onFocus",i.onChange="onChange",i))(t||{});const n=(i,x)=>{const s=x.reduce((c,d)=>d.rule(i)?c:c.concat(d.errorMessage),[]);return s.length>0?s:null},r=(i,x)=>x&&x[i],a=(i,x)=>({rule:s=>!!s.match(i),errorMessage:x||"Value is not valid"})},31226:(q,j,e)=>{"use strict";e.d(j,{W:()=>r,s:()=>a});var t=e(75505),n=e(28082);function r({baseURL:i}){async function x(s){try{const{data:c,...d}=await(0,t.s)((0,n.AI)().fetch({...s,url:i+s.url,showErrorAlert:s.showErrorAlert??!1,data:s.body}));return{data:c,meta:d}}catch(c){return s.manageError?s.manageError(c):a(c)}}return x}function a(i){return(0,n.NF)(i)?{error:new Error(i.data.message)}:i instanceof Error?{error:i}:{error:new Error("Unknown error")}}},77855:(q,j,e)=>{"use strict";e.d(j,{G:()=>n,T:()=>r});var t=e(32370);const n=()=>t.$.namespace,r=(a,i)=>`/apis/${a}/${i}/namespaces/${n()}`},12248:(q,j,e)=>{"use strict";e.d(j,{A:()=>r,f:()=>i});var t=e(2543),n=e.n(t);class r{constructor(s){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",s){if(s.columns)for(const c of s.columns)this.addColumn(c);if(s.rows)for(const c of s.rows)this.addRow(c)}}sort(s){s.col===null||s.col===void 0||this.columns.length<=s.col||(this.rows.sort((c,d)=>(c=c[s.col],d=d[s.col],+(c==null)-+(d==null)||+(c>d)||-(c<d))),s.desc&&this.rows.reverse(),this.columns[s.col].sort=!0,this.columns[s.col].desc=s.desc)}addColumn(s){this.columnMap[s.text]||(this.columns.push(s),this.columnMap[s.text]=s)}addRow(s){this.rows.push(s)}}function a(x,s,c){let d=!1;for(let u=0;u<x.length;u++)if(s[u]!==void 0&&c[u]!==void 0){if(s[u]!==c[u])return!1}else(s[u]===void 0||c[u]===void 0)&&(d=!0);return d}function i(x,...s){const c=x||new r;if(arguments.length===1)return c;if(arguments.length===2)return c.columns=s[0].hasOwnProperty("columns")?[...s[0].columns]:[],c.rows=s[0].hasOwnProperty("rows")?[...s[0].rows]:[],c;const d=s.filter(p=>!!p.columns),u={},g=d.slice().reduce((p,h)=>(h.columns.forEach(D=>{const{text:C}=D;u[C]===void 0&&(u[C]=p.length,p.push(D))}),p),[]),o=d.map(p=>p.columns.map(h=>u[h.text])),E=d.reduce((p,h,D)=>{const C=o[D];return h.rows.forEach(l=>{const v=[];C.forEach((y,P)=>{v[y]=l[P]}),p.push(v)}),p},[]),m={},f=E.reduce((p,h,D)=>{if(!m[D]){let C=D+1;for(;C<E.length;){const l=(0,t.findIndex)(E,v=>a(g,h,v),C);if(l>-1){const v=E[l];for(let y=0;y<g.length;y++)h[y]===void 0&&v[y]!==void 0&&(h[y]=v[y]);m[l]=v,C=l+1}else break}p.push(h)}return p},[]);return c.columns=g,c.rows=f,c}},40449:(q,j,e)=>{"use strict";e.d(j,{N:()=>n});var t=e(65307);const n=(0,t.VP)("core/cleanUpState")},23737:(q,j,e)=>{"use strict";e.d(j,{Do:()=>t.Do,Vz:()=>n.Vz,YA:()=>n.YA,dx:()=>t.dx});var t=e(80847),n=e(76829)},12590:(q,j,e)=>{"use strict";e.d(j,{x:()=>K});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(29675),x=e(9968),s=e(90231),c=e(45565),d=e(54594),u=e(79467),g=e(11817),o=e(75911),E=e(97204),m=e(48583),f=e(44826),p=e(94219),h=e(76459),D=e.n(h),C=e(28082);class l extends a.Component{constructor(_){super(_),this.search=D()(async ee=>(this.setState({isLoading:!0}),(0,r.isNil)(ee)&&(ee=""),(0,C.AI)().get(`/api/serviceaccounts/search?query=${ee}&perpage=100`).then(J=>J.serviceAccounts.map(Z=>({id:Z.id,uid:Z.uid,value:Z,label:Z.login,imgUrl:Z.avatarUrl,login:Z.login}))).finally(()=>{this.setState({isLoading:!1})})),300,{leading:!0}),this.state={isLoading:!1}}render(){const{className:_,onSelected:ee,inputId:J}=this.props,{isLoading:Z}=this.state;return(0,t.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,t.jsx)(f.DW,{isClearable:!0,className:_,inputId:J,isLoading:Z,defaultOptions:!0,loadOptions:this.search,onChange:ee,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"})})}}class v extends a.Component{constructor(_){super(_),this.search=D()(async ee=>(this.setState({isLoading:!0}),(0,r.isNil)(ee)&&(ee=""),(0,C.AI)().get(`/api/teams/search?perpage=100&page=1&query=${ee}`).then(J=>{const Z=J.teams.map(te=>({value:te,label:te.name,imgUrl:te.avatarUrl}));return this.setState({isLoading:!1}),Z})),300,{leading:!0}),this.state={isLoading:!1}}componentDidMount(){const{teamId:_}=this.props;_&&(0,C.AI)().get(`/api/teams/${_}`).then(ee=>{this.setState({value:{value:ee,label:ee.name,imgUrl:ee.avatarUrl}})})}render(){const{onSelected:_,className:ee}=this.props,{isLoading:J,value:Z}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,t.jsx)(f.DW,{isLoading:J,defaultOptions:!0,loadOptions:this.search,value:Z,onChange:_,className:ee,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"})})}}class y extends a.Component{constructor(_){super(_),this.search=D()(async ee=>(this.setState({isLoading:!0}),(0,r.isNil)(ee)&&(ee=""),(0,C.AI)().get(`/api/org/users/lookup?query=${ee}&limit=100`).then(J=>J.map(Z=>({id:Z.userId,uid:Z.uid,value:Z,label:Z.login,imgUrl:Z.avatarUrl,login:Z.login}))).finally(()=>{this.setState({isLoading:!1})})),300,{leading:!0}),this.state={isLoading:!1}}render(){const{className:_,onSelected:ee,inputId:J}=this.props,{isLoading:Z}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,t.jsx)(f.DW,{isClearable:!0,className:_,inputId:J,isLoading:Z,defaultOptions:!0,loadOptions:this.search,onChange:ee,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"})})}}var P=e(71959),b=(k=>(k.None="None",k.Team="Team",k.User="User",k.ServiceAccount="ServiceAccount",k.BuiltInRole="builtInRole",k))(b||{});const S=({title:k=(0,g.t)("access-control.add-permission.title","Add permission for"),permissions:_,assignments:ee,onAdd:J,onCancel:Z})=>{const[te,ae]=(0,a.useState)(b.None),[re,ne]=(0,a.useState)(""),[ce,le]=(0,a.useState)(""),[he,oe]=(0,a.useState)(""),[de,me]=(0,a.useState)(""),Pe=(0,a.useMemo)(()=>{const be=[];return ee.users&&be.push({value:b.User,label:(0,g.t)("access-control.add-permission.user-label","User")}),ee.serviceAccounts&&be.push({value:b.ServiceAccount,label:(0,g.t)("access-control.add-permission.serviceaccount-label","Service Account")}),ee.teams&&be.push({value:b.Team,label:(0,g.t)("access-control.add-permission.team-label","Team")}),ee.builtInRoles&&be.push({value:b.BuiltInRole,label:(0,g.t)("access-control.add-permission.role-label","Role")}),be},[ee]);(0,a.useEffect)(()=>{_.length>0&&me(_[0])},[_]);const Ee=()=>te===b.Team&&re||te===b.User&&ce||te===b.ServiceAccount&&ce||b.BuiltInRole&&P.XT.hasOwnProperty(he);return(0,t.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,t.jsx)(p.J,{onClick:Z}),(0,t.jsx)("h5",{children:k}),(0,t.jsx)("form",{name:"addPermission",onSubmit:be=>{be.preventDefault(),J({userUid:ce,teamUid:re,builtInRole:he,permission:de,target:te})},children:(0,t.jsxs)(m.B,{gap:1,direction:"row",children:[(0,t.jsx)(f.l6,{"aria-label":"Role to add new permission to",value:te,options:Pe,onChange:be=>ae(be.value),disabled:Pe.length===0,width:"auto"}),te===b.User&&(0,t.jsx)(y,{onSelected:be=>le(be?.value?.uid||"")}),te===b.ServiceAccount&&(0,t.jsx)(l,{onSelected:be=>le(be?.value?.uid||"")}),te===b.Team&&(0,t.jsx)(v,{onSelected:be=>ne(be.value?.uid||"")}),te===b.BuiltInRole&&(0,t.jsx)(f.l6,{"aria-label":"Built-in role picker",options:Object.values(P.XT).filter(be=>be!==P.XT.None).map(be=>({value:be,label:be})),onChange:be=>oe(be.value||""),width:"auto"}),(0,t.jsx)(f.l6,{"aria-label":"Permission Level",width:"auto",value:_.find(be=>be===de),options:_.map(be=>({label:be,value:be})),onChange:be=>me(be.value||"")}),(0,t.jsx)(d.$n,{type:"submit",disabled:!Ee(),children:(0,t.jsx)(g.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var M=e(6736),O=e(79784);const R=({item:k,permissionLevels:_,canSet:ee,onRemove:J,onChange:Z})=>{const te=(0,i.of)(U);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:L(k)}),(0,t.jsx)("td",{children:F(k)}),(0,t.jsx)("td",{children:k.isInherited&&(0,t.jsx)("em",{className:te.inherited,children:(0,t.jsx)(g.x6,{i18nKey:"access-control.permission-list-item.inherited",children:"Inherited from folder"})})}),(0,t.jsx)("td",{children:(0,t.jsx)(f.l6,{disabled:!ee||!k.isManaged,onChange:ae=>Z(k,ae.value),value:_.find(ae=>ae===k.permission),options:_.map(ae=>({value:ae,label:ae}))})}),(0,t.jsx)("td",{children:k.warning?(0,t.jsx)(M.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.a,{marginBottom:1,children:k.warning}),I(k)]}),children:(0,t.jsx)(O.I,{name:"exclamation-triangle",className:te.warning})}):(0,t.jsx)(M.m,{content:I(k),children:(0,t.jsx)(O.I,{name:"info-circle"})})}),(0,t.jsx)("td",{children:k.isManaged?(0,t.jsx)(d.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!ee,onClick:()=>J(k),"aria-label":`Remove permission for ${B(k)}`}):(0,t.jsx)(M.m,{content:k.isInherited?"Inherited Permission":"Provisioned Permission",children:(0,t.jsx)(d.$n,{size:"sm",icon:"lock","aria-label":"Locked permission indicator"})})})]})},L=k=>k.teamId?(0,t.jsx)("img",{className:"filter-table__avatar",src:k.teamAvatarUrl,alt:`Avatar for team ${k.teamId}`}):k.userId?(0,t.jsx)("img",{className:"filter-table__avatar",src:k.userAvatarUrl,alt:`Avatar for user ${k.userId}`}):(0,t.jsx)(O.I,{size:"xl",name:"shield"}),B=k=>k.userId?k.userLogin:k.teamId?k.team:k.builtInRole,F=k=>k.userId?(0,t.jsxs)("span",{children:[k.userLogin," "]},"name"):k.teamId?(0,t.jsxs)("span",{children:[k.team," "]},"name"):k.builtInRole?(0,t.jsxs)("span",{children:[k.builtInRole," "]},"name"):(0,t.jsx)("span",{},"name"),I=k=>`Actions: ${[...new Set(k.actions)].sort().join(" ")}`,U=k=>({warning:(0,n.css)({color:k.colors.warning.main}),inherited:(0,n.css)({color:k.colors.text.secondary,flexWrap:"nowrap"})}),W=({title:k,items:_,compareKey:ee,permissionLevels:J,canSet:Z,onRemove:te,onChange:ae})=>{const re=(0,a.useMemo)(()=>{const ne={};for(let ce of _){const le=ce[ee];if(!ne[le]){ne[le]=ce;continue}if(ce.actions.length>ne[le].actions.length){ne[le]=ce;continue}ce.actions.length===ne[le].actions.length&&!ce.isInherited&&(ne[le]=ce)}return Object.keys(ne).map(ce=>ne[ce])},[_,ee]);return re.length===0?null:(0,t.jsx)("div",{children:(0,t.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{children:k}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%"},children:(0,t.jsx)(g.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)("tbody",{children:re.map((ne,ce)=>(0,t.jsx)(R,{item:ne,onRemove:te,onChange:ae,canSet:Z,permissionLevels:J},`${ce}-${ne.userId}`))})]})})},A="",N={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},K=({title:k=(0,g.t)("access-control.permissions.title","Permissions"),buttonLabel:_=(0,g.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:ee=(0,g.t)("access-control.permissions.no-permissions","There are no permissions"),resource:J,resourceId:Z,canSetPermissions:te,addPermissionTitle:ae,getWarnings:re,epilogue:ne})=>{const ce=(0,i.of)(X),[le,he]=(0,a.useState)(!1),[oe,de]=(0,a.useState)([]),[me,Pe]=(0,a.useState)(N),Ee=(0,a.useCallback)(async()=>{let De=await T(J,Z);re&&(De=re(De)),de(De)},[J,Z,re]);(0,a.useEffect)(()=>{V(J).then(De=>(Pe(De),Ee()))},[J,Z,Ee]);const be=De=>{let Ke=null;De.target===b.User||De.target===b.ServiceAccount?Ke=z(J,Z,De.userUid,De.permission):De.target===b.Team?Ke=w(J,Z,De.teamUid,De.permission):De.target===b.BuiltInRole&&(Ke=H(J,Z,De.builtInRole,De.permission)),Ke!==null&&Ke.then(Ee)},Se=De=>{let Ke=null;De.userUid?Ke=z(J,Z,De.userUid,A):De.teamUid?Ke=w(J,Z,De.teamUid,A):De.builtInRole&&(Ke=H(J,Z,De.builtInRole,A)),Ke!==null&&Ke.then(Ee)},Xe=(De,Ke)=>{console.log("onChange",De,Ke),De.permission!==Ke&&(De.userUid||De.isServiceAccount?be({permission:Ke,userUid:De.userUid,target:b.User}):De.teamUid?be({permission:Ke,teamUid:De.teamUid,target:b.Team}):De.builtInRole&&be({permission:Ke,builtInRole:De.builtInRole,target:b.BuiltInRole}))},Qe=(0,a.useMemo)(()=>(0,r.sortBy)(oe.filter(De=>De.teamId),["team","isManaged"]),[oe]),we=(0,a.useMemo)(()=>(0,r.sortBy)(oe.filter(De=>De.userId&&!De.isServiceAccount),["userLogin","isManaged"]),[oe]),$e=(0,a.useMemo)(()=>(0,r.sortBy)(oe.filter(De=>De.userId&&De.isServiceAccount),["userLogin","isManaged"]),[oe]),Fe=(0,a.useMemo)(()=>(0,r.sortBy)(oe.filter(De=>De.builtInRole),["builtInRole","isManaged"]),[oe]),Te=(0,g.t)("access-control.permissions.role","Role"),Le=(0,g.t)("access-control.permissions.user","User"),Ge=(0,g.t)("access-control.permissions.serviceaccount","Service Account"),Me=(0,g.t)("access-control.permissions.team","Team");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[te&&J==="folders"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,t.jsx)(E.x,{selectedItems:{folder:{[Z]:!0},dashboard:{},panel:{},$all:!1}}),(0,t.jsx)(x.$,{v:2})]}),oe.length===0&&(0,t.jsx)(s.a,{children:(0,t.jsx)(c.E,{children:ee})}),(0,t.jsx)(W,{title:Te,items:Fe,compareKey:"builtInRole",permissionLevels:me.permissions,onChange:Xe,onRemove:Se,canSet:te}),(0,t.jsx)(W,{title:Le,items:we,compareKey:"userLogin",permissionLevels:me.permissions,onChange:Xe,onRemove:Se,canSet:te}),(0,t.jsx)(W,{title:Ge,items:$e,compareKey:"userLogin",permissionLevels:me.permissions,onChange:Xe,onRemove:Se,canSet:te}),(0,t.jsx)(W,{title:Me,items:Qe,compareKey:"team",permissionLevels:me.permissions,onChange:Xe,onRemove:Se,canSet:te}),te&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.$n,{className:ce.addPermissionButton,variant:"primary",onClick:()=>he(!0),icon:"plus",children:_},"add-permission"),(0,t.jsx)(u.a,{in:le,children:(0,t.jsx)(S,{title:ae,onAdd:be,permissions:me.permissions,assignments:me.assignments,onCancel:()=>he(!1)})})]})]}),ne&&ne(oe)]})},V=async k=>{try{return await(0,o.AI)().get(`/api/access-control/${k}/description`)}catch(_){return console.error("failed to load resource description: ",_),N}},T=(k,_)=>(0,o.AI)().get(`/api/access-control/${k}/${_}`),z=(k,_,ee,J)=>G(k,_,"users",ee,J),w=(k,_,ee,J)=>G(k,_,"teams",ee,J),H=(k,_,ee,J)=>G(k,_,"builtInRoles",ee,J),G=(k,_,ee,J,Z)=>(0,o.AI)().post(`/api/access-control/${k}/${_}/${ee}/${J}`,{permission:Z}),X=k=>({breakdown:(0,n.css)({...k.typography.bodySmall,color:k.colors.text.secondary,marginBottom:k.spacing(2)}),addPermissionButton:(0,n.css)({marginBottom:k.spacing(2)})})},79467:(q,j,e)=>{"use strict";e.d(j,{a:()=>s});var t=e(74848),n=e(96540),r=e(22669);const a="200px",i=200,x={transition:`max-height ${i}ms ease-in-out`,overflow:"hidden"},s=({children:c,in:d,maxHeight:u=a,style:g=x})=>{const o=(0,n.useRef)(null),E={exited:{maxHeight:0},entering:{maxHeight:u},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,t.jsx)(r.Ay,{in:d,timeout:i,nodeRef:o,children:m=>(0,t.jsx)("div",{style:{...g,...E[m]},ref:o,children:c})})}},94885:(q,j,e)=>{"use strict";e.d(j,{dk:()=>D,hE:()=>f,k0:()=>p,lU:()=>h});var t=e(24120),n=e(49426),r=e(81160),a=e(19519),i=e(80426),x=e(32370),s=e(56276),c=e(11817),d=e(82856);function u(l,v){if(l===v)return!0;if(!(l instanceof Object)||!(v instanceof Object))return!1;const y=Object.keys(l),P=y.length;for(let b=0;b<P;b++)if(!(y[b]in v))return!1;for(let b=0;b<P;b++)if(l[y[b]]!==v[y[b]])return!1;return P===Object.keys(v).length}var g=e(61491),o=e(14910),E=e(53480),m=e(71149);const f="grafana.navigation.docked",p="grafana.navigation.open",h="grafana.navigation.history";class D{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=x.$.theme2.breakpoints.values.xl&&d.A.getBool(f,window.innerWidth>=x.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new n.t({chromeless:!0,sectionNav:{node:{text:(0,c.t)("nav.home.title","Home")},main:{text:""}},megaMenuOpen:this.megaMenuDocked&&d.A.getBool(p,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:i.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.headerHeightObservable=this.state.pipe((0,r.T)(({actions:v,chromeless:y,kioskMode:P})=>P||y?0:v?m.l*2:m.l)).pipe((0,a.F)()),this.setReturnToPrevious=v=>{const y=this.state.getValue().returnToPrevious;(0,s.rR)("grafana_return_to_previous_button_created",{page:v.href,previousPage:y?.href}),this.update({returnToPrevious:v}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(v))},this.clearReturnToPrevious=v=>{const y=this.state.getValue().returnToPrevious;y&&(0,s.rR)("grafana_return_to_previous_button_dismissed",{action:v,page:y.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=v=>{const{megaMenuDocked:y}=this.state.getValue();y&&d.A.set(p,v),(0,s.rR)("grafana_mega_menu_open",{state:v}),this.update({megaMenuOpen:v})},this.setMegaMenuDocked=(v,y=!0)=>{y&&d.A.set(f,v),(0,s.rR)("grafana_mega_menu_docked",{state:v}),this.update({megaMenuDocked:v})},this.onToggleKioskMode=()=>{}}setMatchedRoute(v){this.currentRoute!==v&&(this.currentRoute=v,this.routeChangeHandled=!1)}update(v){const y=this.state.getValue(),P={...y};this.routeChangeHandled||(P.actions=void 0,P.pageNav=void 0,P.sectionNav={node:{text:(0,c.t)("nav.home.title","Home")},main:{text:""}},P.chromeless=this.currentRoute?.chromeless,P.layout=i.k.Standard,this.routeChangeHandled=!0),Object.assign(P,v),P.chromeless=P.kioskMode===g.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(P,y)||(x.$.featureToggles.unifiedHistory&&d.A.setObject(h,this.getUpdatedHistory(P)),this.state.next(P))}getUpdatedHistory(v){const y=(0,o.Z)(v.sectionNav.node,v.pageNav,{text:"Home",url:"/"},!0),P=v.pageNav||v.sectionNav.node;let b=d.A.getObject(h,[]);if(d.A.getObject("CLICKING_HISTORY"))return d.A.setObject("CLICKING_HISTORY",!1),b;if(!P)return b;const M=b[0],O={name:P.text,views:[],breadcrumbs:y,time:Date.now(),url:window.location.href};return M&&O.url.split("?")[0]===M.url.split("?")[0]?b[0]=O:(M&&M.name===O.name&&(0,E.kt)({entryName:O.name,lastEntryURL:M.url,newEntryURL:O.url}),b=[O,...b]),b}ignoreStateUpdate(v,y){return!!(u(v,y)||(v.sectionNav!==y.sectionNav||v.pageNav!==y.pageNav)&&v.actions===y.actions&&v.layout===y.layout&&C(v.sectionNav.node,y.sectionNav.node)&&C(v.pageNav,y.pageNav))}useState(){return(0,t.A)(this.state,this.state.getValue())}exitKioskMode(){}setKioskModeFromUrl(v){let y;y=g.KioskMode.Full,y&&y!==this.state.getValue().kioskMode&&this.update({kioskMode:y})}getKioskUrlValue(v){return!0}}function C(l,v){if(l===v)return!0;const y=l?.children?.find(b=>b.active),P=v?.children?.find(b=>b.active);return l?.text===v?.text&&l?.url===v?.url&&y?.url===P?.url&&C(l?.parentItem,v?.parentItem)}},91536:(q,j,e)=>{"use strict";e.d(j,{H:()=>r});var t=e(96540),n=e(95382);const r=t.memo(({actions:a})=>{const{chrome:i}=(0,n.Il)();return(0,t.useLayoutEffect)(()=>{i.update({actions:a})}),null});r.displayName="TopNavUpdate"},53480:(q,j,e)=>{"use strict";e.d(j,{KX:()=>c,Ni:()=>d,bL:()=>x,kt:()=>s});var t=e(56276);const n="grafana_unified_history_entry_clicked",r="grafana_unified_history_duplicated_entry_rendered",a="grafana_unified_history_drawer_interaction",i="grafana_unified_history_show_more",x=({entryURL:u,subEntry:g})=>{(0,t.rR)(n,{entryURL:u,subEntry:g})},s=({entryName:u,lastEntryURL:g,newEntryURL:o})=>{(0,t.rR)(r,{entryName:u,lastEntryURL:g,newEntryURL:o})},c=({type:u})=>{(0,t.rR)(a,{type:u})},d=()=>{(0,t.rR)(i)}},64599:(q,j,e)=>{"use strict";e.d(j,{t3:()=>P,iL:()=>b,fn:()=>S});var t=e(74848),n=e(22803),r=e(29675),a=e(48583),i=e(52120),x=e(99764),s=e(95382),c=e(11817),d=e(77455),u=e(96540),g=e(53027),o=e(45565),E=e(61351),m=e(80713),f=e(61491),p=e(44826),h=e(79784);function D({orgs:O,onSelectChange:R}){const L=(0,r.of)(C),{orgId:B}=E.TP.user,F=(0,u.useMemo)(()=>O.map(N=>({label:N.name,description:N.role,value:N})),[O]),I=(0,u.useMemo)(()=>F.find(N=>N.value.orgId===B),[F,B]),[U,W]=(0,u.useState)(()=>I),A=N=>{W(N),R(N)};return(0,t.jsx)(p.l6,{"aria-label":"Change organization",width:"auto",value:U,prefix:(0,t.jsx)(h.I,{className:"prefix-icon",name:"building"}),className:L.select,options:F,onChange:A})}const C=O=>({select:(0,n.css)({border:"none",background:"none",color:O.colors.text.secondary,"&:hover":{color:O.colors.text.primary,"& .prefix-icon":(0,n.css)({color:O.colors.text.primary})}})});function l(){const O=(0,f.useDispatch)(),R=(0,f.useSelector)(F=>F.organization.userOrgs),L=(0,r.of)(v),B=F=>{F.value&&((0,m.bA)(F.value.orgId),g.Ny.push(`/?orgId=${F.value.orgId}`),window.location.reload())};return(0,u.useEffect)(()=>{E.TP.isSignedIn&&!(E.TP.user.authenticatedBy==="apikey"||E.TP.user.authenticatedBy==="render")&&O((0,m.wV)())},[O]),R?.length<=1?(0,t.jsx)("span",{className:L.brandTitle,children:(0,t.jsx)(o.E,{truncate:!0,children:d.M.AppTitle})}):(0,t.jsx)(D,{orgs:R,onSelectChange:B})}const v=O=>({brandTitle:(0,n.css)({paddingLeft:O.spacing(1)})});var y=e(71149);const P="dock-menu-button",b="mega-menu-header-toggle";function S({handleMegaMenu:O,handleDockedMenu:R,onClose:L}){const B=(0,r.$j)(),{chrome:F}=(0,s.Il)(),I=F.useState(),U=M(B);return(0,t.jsxs)("div",{className:U.header,children:[(0,t.jsxs)(a.B,{alignItems:"center",minWidth:0,gap:.25,children:[(0,t.jsx)(i.I,{narrow:!0,id:b,onClick:O,tooltip:(0,c.t)("navigation.megamenu.close","Close menu"),children:(0,t.jsx)(d.M.MenuLogo,{className:U.img})}),(0,t.jsx)(l,{})]}),(0,t.jsx)(x.K,{id:P,className:U.dockMenuButton,tooltip:I.megaMenuDocked?(0,c.t)("navigation.megamenu.undock","Undock menu"):(0,c.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:R,variant:"secondary"}),(0,t.jsx)(x.K,{className:U.mobileCloseButton,tooltip:(0,c.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:L,size:"xl",variant:"secondary"})]})}S.displayName="MegaMenuHeader";const M=O=>({dockMenuButton:(0,n.css)({display:"none",[O.breakpoints.up("xl")]:{display:"inline-flex"}}),header:(0,n.css)({alignItems:"center",borderBottom:`1px solid ${O.colors.border.weak}`,display:"flex",gap:O.spacing(1),justifyContent:"space-between",padding:O.spacing(0,1,0,.75),height:y.l,minHeight:y.l}),img:(0,n.css)({alignSelf:"center",height:O.spacing(3),width:O.spacing(3)}),mobileCloseButton:(0,n.css)({[O.breakpoints.up("md")]:{display:"none"}})})},24124:(q,j,e)=>{"use strict";e.d(j,{s:()=>a});var t=e(96540),n=e(32370),r=e(32126);const a=()=>{const i=(0,r.Pj)(void 0,{skip:!n.$.bootData.user.isSignedIn}),x=(0,t.useMemo)(()=>i.data?.navbar?.bookmarkUrls||[],[i]);return n.$.featureToggles.pinNavItems?x:[]}},8629:(q,j,e)=>{"use strict";e.d(j,{A6:()=>f,CS:()=>o,J0:()=>E,Wk:()=>h,m0:()=>m,n0:()=>D});var t=e(96540),n=e(56276),r=e(32370),a=e(11817),i=e(76829),x=e(91830),s=e(22492),c=e(50363),d=e(74064),u=e(10747),g=e(64599);const o=C=>{let l=C.children||[];if(C.id==="help"){const v=()=>{s.A.publish(new x.S8({component:d.N}))};C.children=[...l,...(0,c.Dd)(),...p(),{id:"keyboard-shortcuts",text:(0,a.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:v}]}return C},E=(C,l)=>{const v={...C},y=v.onClick;return v.onClick=()=>{(0,n.rR)("grafana_navigation_item_clicked",{path:v.url??v.id,menuIsDocked:l,itemIsBookmarked:!!(r.$.featureToggles.pinNavItems&&v?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!r.$.featureToggles.pinNavItems}),y?.()},v.children&&(v.children=v.children.map(P=>E(P,l))),v},m=(C,l)=>!!C.children?.some(v=>v===l?!0:m(v,l)),f=(C,l,v)=>{const{id:y,parentItem:P}=l;if(v==="/")return C.find(S=>S.id===i.Id);if(l.id==="profile")return;for(const S of C){const M=!!(S.id&&S.id===y),O=S.text===l.text&&S.url===l.url;if(M||O)return S;if(S.children){const R=f(S.children,l);if(R)return R}}const b=C[0]?.parentItem?.id==="bookmarks";if(P&&!b)return f(C,P)};function p(){const{buildInfo:C,licenseInfo:l}=r.$,v=l.stateInfo?` (${l.stateInfo})`:"",y=[];return y.push({target:"_blank",id:"version",text:`${C.edition}${v}`,url:l.licenseUrl,icon:"external-link-alt"}),C.hasUpdate&&y.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),y}function h(C,l){for(const v of C){if(v.url===l)return v;if(v.children?.length){const y=h(v.children,l);if(y)return y}}return null}function D(C,l){(0,t.useEffect)(()=>{C?document.getElementById(g.iL)?.focus():document.getElementById(u.U)?.focus()},[C]),(0,t.useEffect)(()=>{l?document.getElementById(g.t3)?.focus():document.getElementById(u.U)?.focus()},[l])}},23838:(q,j,e)=>{"use strict";e.d(j,{K:()=>a});var t=e(74848),n=e(22803),r=e(29675);function a({className:x,leftActionsSeparator:s}){const c=(0,r.of)(i);return s?(0,t.jsx)("div",{className:(0,n.cx)(x,c.leftActionsSeparator)}):(0,t.jsx)("div",{className:(0,n.cx)(x,c.line)})}const i=x=>({leftActionsSeparator:(0,n.css)({display:"flex",flexGrow:1}),line:(0,n.css)({width:1,backgroundColor:x.colors.border.medium,height:24})})},10747:(q,j,e)=>{"use strict";e.d(j,{U:()=>je,h:()=>Ve});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(29675),x=e(48583),s=e(52120),c=e(79784),d=e(60232),u=e(88023),g=e(95382),o=e(87638),E=e(11817),m=e(76829),f=e(61491),p=e(77455),h=e(58779),D=e(56276);function C({href:Oe,isCurrent:nt,text:Je,index:Be,flexGrow:Ze}){const tt=(0,i.of)(l),Re=()=>{(0,D.rR)("grafana_breadcrumb_clicked",{url:Oe})};return(0,t.jsx)("li",{className:tt.breadcrumbWrapper,style:{flexGrow:Ze},children:nt?(0,t.jsx)("span",{"data-testid":h.XF.Breadcrumbs.breadcrumb(Je),className:tt.breadcrumb,"aria-current":"page",title:Je,children:Je}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{onClick:Re,"data-testid":h.XF.Breadcrumbs.breadcrumb(Je),className:(0,n.cx)(tt.breadcrumb,tt.breadcrumbLink),title:Je,href:Oe,children:Je}),(0,t.jsx)("div",{className:tt.separator,"aria-hidden":!0,children:(0,t.jsx)(c.I,{name:"angle-right"})})]})})}const l=Oe=>({breadcrumb:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:Oe.colors.text.secondary}),breadcrumbLink:(0,n.css)({color:Oe.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,n.css)({alignItems:"center",color:Oe.colors.text.primary,display:"flex",flex:1,gap:Oe.spacing(.5),minWidth:0,maxWidth:"max-content",padding:Oe.spacing(.5,0,.5,.5),[Oe.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,n.css)({color:Oe.colors.text.secondary})});function v({breadcrumbs:Oe,className:nt}){const Je=(0,i.of)(P);return(0,t.jsx)("nav",{"aria-label":"Breadcrumbs",className:nt,children:(0,t.jsx)("ol",{className:Je.breadcrumbs,children:Oe.map((Be,Ze)=>(0,a.createElement)(C,{...Be,isCurrent:Ze===Oe.length-1,key:Ze,index:Ze,flexGrow:y(Ze,Oe.length)}))})})}function y(Oe,nt){return nt<5&&Oe>0&&Oe<nt-2||nt>6&&Oe>1&&Oe<nt-3?4:10}const P=Oe=>({breadcrumbs:(0,n.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var b=e(14910),S=e(42941),M=e(69199),O=e(58528),R=e(22492),L=e(91830),B=e(94885),F=e(23838),I=e(95093),U=e.n(I),W=e(63739),A=e(90231),N=e(45565),K=e(54594),V=e(99764),T=e(9968),z=e(6210),w=e(392),H=e(13171),G=e(53480);function X({onClose:Oe}){const nt=M.M.getObject(B.lU,[]).filter(at=>U()(at.time).isAfter(U()().subtract(2,"day").startOf("day"))),[Je,Be]=(0,a.useState)(5),Ze=nt.find(at=>at.url===window.location.href||at.views.some(yt=>yt.url===window.location.href))?.time,tt=nt.slice(0,Je).reduce((at,yt)=>{const ze=U()(yt.time);let st="";return ze.isSame(U()(),"day")?st=(0,E.t)("nav.history-wrapper.today","Today"):ze.isSame(U()().subtract(1,"day"),"day")?st=(0,E.t)("nav.history-wrapper.yesterday","Yesterday"):st=ze.format("YYYY-MM-DD"),at[st]=[...at[st]||[],yt],at},{}),Re=(0,i.of)(_);return(0,t.jsxs)(x.B,{direction:"column",alignItems:"flex-start",children:[(0,t.jsx)(A.a,{width:"100%",children:Object.keys(tt).map((at,yt)=>(0,t.jsxs)(x.B,{direction:"column",gap:1,children:[(0,t.jsx)(A.a,{paddingLeft:2,children:(0,t.jsx)(N.E,{color:"secondary",children:at})}),(0,t.jsx)("div",{className:Re.timeline,children:tt[at].map((ze,st)=>(0,t.jsx)(k,{entry:ze,isSelected:ze.time===Ze,onClick:()=>Oe()},st))})]},yt))}),nt.length>Je&&(0,t.jsx)(A.a,{paddingLeft:2,children:(0,t.jsx)(K.$n,{variant:"secondary",fill:"text",onClick:()=>{Be(Je+5),(0,G.Ni)()},children:(0,E.t)("nav.history-wrapper.show-more","Show more")})})]})}function k({entry:Oe,isSelected:nt,onClick:Je}){const Be=(0,i.of)(_),Ze=(0,i.$j)(),[tt,Re]=(0,a.useState)(nt&&Oe.views.length>0),{breadcrumbs:at,views:yt,time:ze,url:st,sparklineData:ht}=Oe,It=tt?(0,E.t)("nav.history-wrapper.collapse","Collapse"):(0,E.t)("nav.history-wrapper.expand","Expand"),Gt=tt?(0,E.t)("nav.history-wrapper.icon-selected","Selected Entry"):(0,E.t)("nav.history-wrapper.icon-unselected","Normal Entry"),un=nt&&Oe.views.find(vn=>vn.url===window.location.href)?.time;return(0,t.jsx)(A.a,{marginBottom:1,children:(0,t.jsxs)(x.B,{direction:"column",gap:1,children:[(0,t.jsxs)(x.B,{alignItems:"baseline",children:[yt.length>0?(0,t.jsx)(V.K,{name:tt?"angle-down":"angle-right",onClick:()=>Re(!tt),"aria-label":It,className:Be.iconButton}):(0,t.jsx)(T.$,{h:2}),(0,t.jsx)(c.I,{size:"sm",name:nt?"circle-mono":"circle","aria-label":Gt,className:tt?Be.iconButtonDot:Be.iconButtonCircle}),(0,t.jsx)(z.Z,{onClick:()=>{M.M.setObject("CLICKING_HISTORY",!0),Je(),(0,G.bL)({entryURL:st})},href:st,isCompact:!0,className:nt?Be.card:(0,n.cx)(Be.card,Be.cardSelected),children:(0,t.jsxs)(x.B,{direction:"column",children:[(0,t.jsx)("div",{children:at.map((vn,pn)=>(0,t.jsxs)(N.E,{children:[vn.text," ",pn!==at.length-1?"> ":""]},pn))}),(0,t.jsx)(N.E,{variant:"bodySmall",color:"secondary",children:(0,H.Y)(ze,{timeStyle:"short"})}),ht&&(0,t.jsx)(w.O,{theme:Ze,width:240,height:40,config:{custom:{fillColor:"rgba(130, 181, 216, 0.1)",lineColor:"#82B5D8"}},sparkline:{y:{type:W.PU.number,name:"test",config:{},values:ht.values,state:{range:{...ht.range}}}}})]})})]}),tt&&(0,t.jsx)("div",{className:Be.expanded,children:yt.map((vn,pn)=>(0,t.jsx)(z.Z,{href:vn.url,onClick:()=>{M.M.setObject("CLICKING_HISTORY",!0),Je(),(0,G.bL)({entryURL:vn.url,subEntry:"timeRange"})},isCompact:!0,className:vn.time===un?void 0:Be.subCard,children:(0,t.jsxs)(x.B,{direction:"column",gap:0,children:[(0,t.jsx)(N.E,{variant:"bodySmall",children:vn.name}),vn.description&&(0,t.jsx)(N.E,{color:"secondary",variant:"bodySmall",children:vn.description})]})},pn))})]})})}const _=Oe=>({card:(0,n.css)({label:"card",background:"none",margin:Oe.spacing(.5,0)}),cardSelected:(0,n.css)({label:"card-selected",background:"none"}),subCard:(0,n.css)({label:"subcard",background:"none",margin:0}),iconButton:(0,n.css)({label:"expand-button",margin:0}),iconButtonCircle:(0,n.css)({label:"blue-circle-icon",margin:0,background:Oe.colors.background.primary,fill:Oe.colors.primary.main,cursor:"default","&:hover:before":{background:"none"},zIndex:0}),iconButtonDot:(0,n.css)({label:"blue-dot-icon",margin:0,color:Oe.colors.primary.main,border:Oe.shape.radius.circle,cursor:"default","&:hover:before":{background:"none"},zIndex:0}),expanded:(0,n.css)({label:"expanded",display:"flex",flexDirection:"column",marginLeft:Oe.spacing(6),gap:Oe.spacing(1),position:"relative","&:before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:"1px",background:Oe.colors.border.weak}}),timeline:(0,n.css)({label:"timeline",position:"relative",height:"100%",width:"100%",paddingLeft:Oe.spacing(2),"&:before":{content:'""',position:"absolute",left:Oe.spacing(5.75),top:0,height:"100%",width:"1px",borderLeft:`1px dashed ${Oe.colors.border.strong}`}})});function ee(){const[Oe,nt]=(0,S.A)(!1),Je=(0,i.of)(J);return(0,a.useEffect)(()=>{const Be=R.l.subscribe(L.sj,Ze=>{if(M.M.getObject("CLICKING_HISTORY")){M.M.setObject("CLICKING_HISTORY",!1);return}const Re=M.M.getObject(B.lU,[]);let at=Re[0];const yt=Ze.payload.url;return at.views[0]?.url!==yt&&(at.views=[{name:Ze.payload.name,description:Ze.payload.description,url:yt,time:Date.now()},...at.views],M.M.setObject(B.lU,[...Re])),()=>{Be.unsubscribe()}})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.I,{onClick:()=>{nt(),(0,G.KX)({type:"open"})},iconOnly:!0,icon:"history","aria-label":(0,E.t)("nav.history-container.drawer-tittle","History")}),(0,t.jsx)(F.K,{className:Je.separator}),Oe&&(0,t.jsx)(O._,{title:(0,E.t)("nav.history-container.drawer-tittle","History"),onClose:()=>{nt(),(0,G.KX)({type:"close"})},size:"sm",children:(0,t.jsx)(X,{onClose:()=>nt(!1)})})]})}const J=Oe=>({separator:(0,n.css)({[Oe.breakpoints.down("sm")]:{display:"none"}})});var Z=e(8629),te=e(19224),ae=e(59041);function re(Oe){const nt=[];for(const Je of Oe)Je.isCreateAction&&nt.push(Je),Je.children&&nt.push(...re(Je.children));return nt}const ne=({})=>{const Oe=(0,i.of)(ce),nt=(0,i.$j)(),Je=(0,f.useSelector)(ht=>ht.navBarTree),Be=nt.breakpoints.values.sm,[Ze,tt]=(0,a.useState)(!1),[Re,at]=(0,a.useState)(!window.matchMedia(`(min-width: ${Be}px)`).matches),yt=(0,a.useMemo)(()=>re(Je),[Je]),ze=yt.length>0&&!Re;(0,ae.Y)({breakpoint:Be,onChange:ht=>{at(!ht.matches)}});const st=()=>(0,t.jsx)(te.W,{children:yt.map((ht,It)=>(0,t.jsx)(te.W.Item,{url:ht.url,label:ht.text,onClick:()=>(0,D.rR)("grafana_menu_item_clicked",{url:ht.url,from:"quickadd"})},It))});return ze?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.m,{overlay:st,placement:"bottom-end",onVisibleChange:tt,children:(0,t.jsx)(s.I,{iconOnly:!0,icon:Re?"plus-circle":"plus",isOpen:Re?void 0:Ze,"aria-label":"New"})}),(0,t.jsx)(F.K,{className:Oe.separator})]}):null},ce=Oe=>({buttonContent:(0,n.css)({alignItems:"center",display:"flex"}),buttonText:(0,n.css)({[Oe.breakpoints.down("md")]:{display:"none"}}),separator:(0,n.css)({[Oe.breakpoints.down("sm")]:{display:"none"}})});var le=e(71149),he=e(32370),oe=e(36529),de=e(60938),me=e(49185),Pe=e(36492),Ee=e(87518);function be({feedUrl:Oe}){const nt=(0,i.of)(Se),{state:Je,getNews:Be}=(0,Ee.n)(Oe),[Ze,tt]=(0,me.A)();return(0,a.useEffect)(()=>{Be()},[Be]),Je.error?(0,t.jsx)("div",{className:nt.innerWrapper,children:Je.error&&Je.error.message}):(0,t.jsxs)("div",{ref:Ze,children:[Je.loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Pe.K.Skeleton,{showImage:!0,width:tt.width}),(0,t.jsx)(Pe.K.Skeleton,{showImage:!0,width:tt.width}),(0,t.jsx)(Pe.K.Skeleton,{showImage:!0,width:tt.width}),(0,t.jsx)(Pe.K.Skeleton,{showImage:!0,width:tt.width}),(0,t.jsx)(Pe.K.Skeleton,{showImage:!0,width:tt.width})]}):(0,t.jsx)(t.Fragment,{children:tt.width>0&&Je.value?.map((Re,at)=>(0,t.jsx)(Pe.K,{index:at,showImage:!0,width:tt.width,data:Je.value},at))}),(0,t.jsx)("div",{className:nt.grot,children:(0,t.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",children:(0,t.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})})})]})}const Se=Oe=>({innerWrapper:(0,n.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:Oe.spacing(5,0),img:{width:"186px",height:"186px"}})});function Xe({onClose:Oe}){const nt=(0,i.of)(Qe);return(0,t.jsx)(O._,{title:(0,t.jsxs)("div",{className:nt.title,children:[(0,t.jsx)(N.E,{element:"h2",children:(0,E.t)("news.title","Latest from the blog")}),(0,t.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:nt.grot,children:(0,t.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})}),(0,t.jsx)("div",{className:nt.actions,children:(0,t.jsx)(V.K,{name:"times",variant:"secondary",onClick:Oe,"data-testid":h.Tp.components.Drawer.General.close,tooltip:(0,E.t)("news.drawer.close","Close Drawer")})})]}),onClose:Oe,size:"md",children:(0,t.jsx)(be,{feedUrl:de.$})})}const Qe=Oe=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:Oe.spacing(2),borderBottom:`1px solid ${Oe.colors.border.weak}`}),grot:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:Oe.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,n.css)({position:"absolute",right:Oe.spacing(1),top:Oe.spacing(2)})});function we({node:Oe,children:nt}){const Je=(0,i.of)($e),Be=(0,Z.J0)((0,r.cloneDeep)(Oe),!1);return Be?(0,t.jsxs)(te.W,{header:(0,t.jsxs)("div",{onClick:Ze=>Ze.stopPropagation(),className:Je.header,children:[(0,t.jsx)("div",{children:Be.text}),Be.subTitle&&(0,t.jsx)("div",{className:Je.subTitle,children:Be.subTitle})]}),children:[Be.children?.map(Ze=>Ze.url?(0,t.jsx)(oe.D,{url:Ze.url,label:Ze.text,icon:Ze.icon,target:Ze.target},Ze.id):(0,t.jsx)(oe.D,{icon:Ze.icon,onClick:Ze.onClick,label:Ze.text},Ze.id)),nt]}):null}const $e=Oe=>({header:(0,n.css)({fontSize:Oe.typography.h5.fontSize,fontWeight:Oe.typography.h5.fontWeight,padding:Oe.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,n.css)({color:Oe.colors.text.secondary,fontSize:Oe.typography.bodySmall.fontSize})});function Fe({profileNode:Oe}){const nt=(0,i.of)(Te),Je=(0,Z.J0)((0,r.cloneDeep)(Oe),!1),[Be,Ze]=(0,S.A)(!1);if(!Je)return null;const tt=()=>(0,t.jsx)(we,{node:Oe,children:he.$.newsFeedEnabled&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(te.W.Divider,{}),(0,t.jsx)(oe.D,{icon:"rss",onClick:Ze,label:(0,E.t)("navigation.rss-button","Latest from the blog")})]})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.m,{overlay:tt,placement:"bottom-end",children:(0,t.jsx)(s.I,{className:nt.profileButton,imgSrc:o.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})}),Be&&(0,t.jsx)(Xe,{onClose:Ze})]})}const Te=Oe=>({profileButton:(0,n.css)({padding:Oe.spacing(0,.5),img:{borderRadius:Oe.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});var Le=e(54148),Ge=e(84099),Me=e(2567);function De(){const Oe=(0,Le.zy)(),nt=(0,i.of)(Ke);let Je=Ge.sQ.sanitizeUrl(Me.I.getUrlForPartial(Oe,{forceLogin:"true"}));return Je.startsWith("//")&&(Je=Je.replace(/\/+/g,"/")),(0,t.jsx)("a",{className:nt.link,href:Je,target:"_self",children:(0,t.jsx)(E.x6,{i18nKey:"app-chrome.top-bar.sign-in",children:"Sign in"})})}const Ke=Oe=>({link:(0,n.css)({paddingLeft:Oe.spacing(1),paddingRight:Oe.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var Ie=e(1503),Ne=e(34128),ie=e(94963),ve=e(47715);function fe(){const Oe=(0,i.$j)(),{query:nt}=(0,Ie.useKBar)(Re=>({kbarSearchQuery:Re.searchQuery,kbarIsOpen:Re.visualState===Ie.VisualState.showing})),Je=Oe.breakpoints.values.lg,[Be,Ze]=(0,a.useState)(!window.matchMedia(`(min-width: ${Je}px)`).matches);(0,ae.Y)({breakpoint:Je,onChange:Re=>{Ze(!Re.matches)}});const tt=()=>{nt.toggle()};return Be?(0,t.jsx)(s.I,{iconOnly:!0,icon:"search","aria-label":(0,E.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:tt}):(0,t.jsx)(ge,{onClick:tt})}function ge({onClick:Oe}){const nt=(0,i.of)(xe),Je=(0,a.useMemo)(()=>(0,ve.gn)(),[]);return(0,t.jsx)("div",{className:nt.wrapper,"data-testid":h.Tp.components.NavToolbar.commandPaletteTrigger,children:(0,t.jsxs)("div",{className:nt.inputWrapper,children:[(0,t.jsx)("div",{className:nt.prefix,children:(0,t.jsx)(c.I,{name:"search"})}),(0,t.jsx)("button",{className:nt.fakeInput,onClick:Oe,children:(0,E.t)("nav.search.placeholderCommandPalette","Search or jump to...")}),(0,t.jsxs)("div",{className:nt.suffix,children:[(0,t.jsx)(c.I,{name:"keyboard"}),(0,t.jsx)(N.E,{variant:"bodySmall",children:`${Je}+k`})]})]})})}const xe=Oe=>{const nt=(0,Ne.n)({theme:Oe});return{wrapper:nt.wrapper,inputWrapper:nt.inputWrapper,prefix:nt.prefix,suffix:(0,n.css)([nt.suffix,{display:"flex",gap:Oe.spacing(.5)}]),fakeInput:(0,n.css)([nt.input,{textAlign:"left",paddingLeft:28,color:Oe.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,ie.getFocusStyles)(Oe)}]),button:(0,n.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}},je="mega-menu-toggle",Ve=(0,a.memo)(function({onToggleMegaMenu:nt,onToggleKioskMode:Je,pageNav:Be,sectionNav:Ze}){const{chrome:tt}=(0,g.Il)(),Re=tt.useState(),at=!Re.chromeless&&Re.megaMenuDocked&&Re.megaMenuOpen,yt=(0,i.of)(ke,at),ze=(0,f.useSelector)(pn=>pn.navIndex),st=(0,r.cloneDeep)(ze.help),ht=st?(0,Z.CS)(st):void 0,It=ze.profile,Gt=(0,f.useSelector)(pn=>pn.navIndex)[m.Id],un=(0,b.Z)(Ze,Be,Gt),vn=u.$W.featureToggles.unifiedHistory;return(0,t.jsxs)("div",{className:yt.layout,children:[(0,t.jsxs)(x.B,{minWidth:0,gap:.5,alignItems:"center",children:[!at&&(0,t.jsx)(s.I,{narrow:!0,id:je,onClick:nt,tooltip:(0,E.t)("navigation.megamenu.open","Open menu"),children:(0,t.jsxs)(x.B,{gap:0,alignItems:"center",children:[(0,t.jsx)(p.M.MenuLogo,{className:yt.img}),(0,t.jsx)(c.I,{size:"sm",name:"angle-down"})]})}),(0,t.jsx)(v,{breadcrumbs:un,className:yt.breadcrumbsWrapper})]}),(0,t.jsxs)(x.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)(fe,{}),vn&&(0,t.jsx)(ee,{}),(0,t.jsx)(ne,{}),ht&&(0,t.jsx)(d.m,{overlay:()=>(0,t.jsx)(we,{node:ht}),placement:"bottom-end",children:(0,t.jsx)(s.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),(0,t.jsx)(s.I,{icon:"monitor",className:yt.kioskToggle,onClick:Je,tooltip:"Enable kiosk mode"}),!o.TP.user.isSignedIn&&(0,t.jsx)(De,{}),It&&(0,t.jsx)(Fe,{profileNode:It})]})]})}),ke=(Oe,nt)=>({layout:(0,n.css)({height:le.l,display:"flex",gap:Oe.spacing(2),alignItems:"center",padding:Oe.spacing(0,1),paddingLeft:nt?Oe.spacing(3.5):Oe.spacing(.75),borderBottom:`1px solid ${Oe.colors.border.weak}`,justifyContent:"space-between",[Oe.breakpoints.up("lg")]:{gridTemplateColumns:"2fr minmax(550px, 1fr)",display:"grid",justifyContent:"flex-start"}}),breadcrumbsWrapper:(0,n.css)({display:"flex",overflow:"hidden",[Oe.breakpoints.down("sm")]:{minWidth:"40%"}}),img:(0,n.css)({alignSelf:"center",height:Oe.spacing(3),width:Oe.spacing(3)}),kioskToggle:(0,n.css)({[Oe.breakpoints.down("lg")]:{display:"none"}})})},71149:(q,j,e)=>{"use strict";e.d(j,{l:()=>t});const t=40},77455:(q,j,e)=>{"use strict";e.d(j,{M:()=>d});var t=e(74848),n=e(22803),r=e(87190),a=e(29675);const i=({className:u,logo:g})=>(0,t.jsx)("img",{className:u,src:`${g||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),x=({className:u,children:g})=>{const o=(0,a.$j)(),E=(0,n.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${o.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[o.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,t.jsx)("div",{className:(0,n.cx)(E,u),children:g})},s=({className:u})=>(0,t.jsx)("img",{className:u,src:"public/img/grafana_icon.svg",alt:"Grafana"}),c=()=>{const u=(0,a.$j)();return(0,n.css)({background:r.MV.alpha(u.colors.background.primary,.7),backgroundSize:"cover"})};class d{static{this.LoginLogo=i}static{this.LoginBackground=x}static{this.MenuLogo=s}static{this.LoginBoxBackground=c}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},14910:(q,j,e)=>{"use strict";e.d(j,{Z:()=>t});function t(n,r,a,i){const x=[];let s=!1,c;function d(u,g=!1){if(s)return;const o=u.url?.split("?")??["",""];let E=o[0];const m=new URLSearchParams(o[1]);if(m.has("editview")&&(E+=`?editview=${m.get("editview")}`),a&&E===a.url){i||x.unshift({text:a.text,href:u.url??""}),s=!0;return}const f=E.length>0&&c===E;if(c=E,!u.hideFromBreadcrumbs&&!(g&&f)){const h=u.children?.findIndex(D=>D.active)??-1;if(h>0){const D=u.children?.[h];D&&x.unshift({text:D.text,href:D.url??""})}x.unshift({text:u.text,href:u.url??""})}u.parentItem&&d(u.parentItem)}return r&&d(r),d(n,!0),x}},94219:(q,j,e)=>{"use strict";e.d(j,{J:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(99764);const i=({onClick:s,"aria-label":c,style:d})=>{const u=(0,r.of)(x);return(0,t.jsx)(a.K,{"aria-label":c??"Close",className:u,name:"times",onClick:s,style:d,tooltip:"Close"})},x=s=>(0,n.css)({position:"absolute",right:s.spacing(.5),top:s.spacing(1)})},50363:(q,j,e)=>{"use strict";e.d(j,{Dd:()=>c,wi:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(32370),i=e(29675),x=e(79784),s=e(11817);let c=()=>[{target:"_blank",id:"documentation",text:(0,s.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,s.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,s.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function d(f){return{hasReleaseNotes:!0,isBeta:f.includes("-beta")}}function u(f){const{buildInfo:p,licenseInfo:h}=a.$,D=[],C=h.stateInfo?` (${h.stateInfo})`:"";if(f||D.push({target:"_blank",id:"license",text:`${p.edition}${C}`,url:h.licenseUrl}),p.hideVersion)return D;const{hasReleaseNotes:l}=d(p.version);return D.push({target:"_blank",id:"version",text:p.versionString,url:l?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),p.hasUpdate&&D.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),D}function g(f){c=f}const o=(0,r.memo)(({customLinks:f,hideEdition:p})=>{const h=(f||c()).concat(u(p)),D=(0,i.of)(m);return(0,t.jsx)("footer",{className:D.footer,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("ul",{className:D.list,children:h.map((C,l)=>(0,t.jsx)("li",{className:D.listItem,children:(0,t.jsx)(E,{item:C})},l))})})})});o.displayName="Footer";function E({item:f}){const p=f.url?(0,t.jsx)("a",{href:f.url,target:f.target,rel:"noopener noreferrer",id:f.id,children:f.text}):f.text;return(0,t.jsxs)(t.Fragment,{children:[f.icon&&(0,t.jsx)(x.I,{name:f.icon})," ",p]})}const m=f=>({footer:(0,n.css)({...f.typography.bodySmall,color:f.colors.text.primary,display:"block",padding:f.spacing(2,0),position:"relative",width:"98%","a:hover":{color:f.colors.text.maxContrast,textDecoration:"underline"},[f.breakpoints.down("md")]:{display:"none"}}),list:(0,n.css)({listStyle:"none"}),listItem:(0,n.css)({display:"inline-block","&:after":{content:"' | '",padding:f.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},40917:(q,j,e)=>{"use strict";e.d(j,{T:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(26777);function i({children:s,spacing:c,level:d}){const u=(0,r.of)(x,c,d);return(0,t.jsx)("span",{className:(0,n.css)(u.indentor),children:s})}const x=(s,c,d)=>({indentor:(0,n.css)((0,a.Y)(s,c,u=>({paddingLeft:s.spacing(u*d)})))})},23657:(q,j,e)=>{"use strict";e.d(j,{b:()=>a});var t=e(74848),n=e(96540),r=e(82856);const a=i=>{const{children:x,storageKey:s,defaultValue:c}=i,[d,u]=(0,n.useState)({value:r.A.getObject(i.storageKey,i.defaultValue)});(0,n.useEffect)(()=>{const E=m=>{m.key===s&&u({value:r.A.getObject(i.storageKey,i.defaultValue)})};return window.addEventListener("storage",E),()=>{window.removeEventListener("storage",E)}});const g=E=>{try{r.A.setObject(s,E)}catch(m){console.error(m)}u({value:E})},o=()=>{try{r.A.delete(s)}catch(E){console.log(E)}u({value:c})};return(0,t.jsx)(t.Fragment,{children:x(d.value,g,o)})}},94259:(q,j,e)=>{"use strict";e.d(j,{A:()=>n,X:()=>r});var t=e(96540);function n({children:a,onSetScrollRef:i,divId:x}){const s=(0,t.useRef)(null);return(0,t.useEffect)(()=>{i&&i(new r(document.documentElement))},[s,i]),a}class r{constructor(i){this.element=i}get scrollTop(){return this.element.scrollTop}scrollTo(i,x,s=0){if(!(this.element.scrollHeight-this.element.clientHeight-x>=0)&&s<10){requestAnimationFrame(()=>this.scrollTo(i,x,s+1));return}this.element.scrollTo(i,x)}}},14485:(q,j,e)=>{"use strict";e.d(j,{I:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(6210);function i({description:s,text:c,url:d}){const u=(0,r.of)(x);return(0,t.jsxs)(a.Z,{className:u.card,href:d,children:[(0,t.jsx)(a.Z.Heading,{children:c}),(0,t.jsx)(a.Z.Description,{className:u.description,children:s})]})}const x=s=>({card:(0,n.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,n.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})})},98444:(q,j,e)=>{"use strict";e.d(j,{I:()=>ae});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(76459),s=e.n(x),c=e(96540),d=e(32370),u=e(29675),g=e(34128),o=e(79784),E=e(37e3),m=e(37008),f=e(11817),p=e(15664),h=e(92914),D=e(1167),C=e(61491),l=e(70255),v=e(91793),y=e(10022),P=e(99764),b=e(45565),S=e(40917),M=e(86843);const O=40,R="md",L=(ne,ce)=>`${ne}-${ce||"root"}`;function B({items:ne,focusedItemIndex:ce,foldersAreOpenable:le,idPrefix:he,selectedFolder:oe,onFolderExpand:de,onFolderSelect:me,isItemLoaded:Pe,requestLoadMore:Ee}){const be=(0,c.useRef)(null),Se=(0,u.of)(U),Xe=(0,c.useMemo)(()=>({items:ne,focusedItemIndex:ce,foldersAreOpenable:le,selectedFolder:oe,onFolderExpand:de,onFolderSelect:me,idPrefix:he}),[ne,ce,le,oe,de,me,he]),Qe=(0,c.useCallback)($e=>Pe($e),[Pe]),we=(0,c.useCallback)(($e,Fe)=>{const{parentUID:Te}=ne[$e];Ee(Te)},[Ee,ne]);return(0,t.jsx)("div",{className:Se.table,role:"tree",children:ne.length>0?(0,t.jsx)(y.A,{ref:be,itemCount:ne.length,isItemLoaded:Qe,loadMoreItems:we,children:({onItemsRendered:$e,ref:Fe})=>(0,t.jsx)(v.Y1,{ref:Fe,height:O*Math.min(6.5,ne.length),width:"100%",itemData:Xe,itemSize:O,itemCount:ne.length,onItemsRendered:$e,children:I})}):(0,t.jsx)("div",{className:Se.emptyMessage,children:(0,t.jsx)(f.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const F=[100,200,130,160,150];function I({index:ne,style:ce,data:le}){const{items:he,focusedItemIndex:oe,foldersAreOpenable:de,selectedFolder:me,onFolderExpand:Pe,onFolderSelect:Ee,idPrefix:be}=le,{item:Se,isOpen:Xe,level:Qe,parentUID:we}=he[ne],$e=(0,c.useRef)(null),Fe=(0,c.useId)(),Te=(0,C.useSelector)(M.ku),Le=(0,C.useSelector)(M.Am),Ge=(Se.uid?Le[Se.uid]:Te)?.items??[];let Me=[];Se.uid&&(Me=(we?Le[we]:Te)?.items??[]);const De=(0,u.of)(U),Ke=(0,c.useCallback)(Ne=>{Ne.preventDefault(),Ne.stopPropagation(),Se.uid&&Pe(Se.uid,!Xe)},[Se.uid,Xe,Pe]),Ie=(0,c.useCallback)(()=>{Se.kind==="folder"&&Ee(Se)},[Se,Ee]);if(Se.kind==="ui"&&Se.uiKind==="pagination-placeholder")return(0,t.jsxs)("span",{style:ce,className:De.row,children:[(0,t.jsx)(S.T,{level:Qe,spacing:2}),(0,t.jsx)(l.A,{width:F[ne%F.length]})]});if(Se.kind!=="folder"){const Ne=Se.kind,ie=Se.uid;return null}return(0,t.jsx)("div",{ref:$e,style:ce,className:(0,n.cx)(De.row,{[De.rowFocused]:ne===oe,[De.rowSelected]:Se.uid===me}),tabIndex:-1,onClick:Ie,"aria-expanded":Xe,"aria-selected":Se.uid===me,"aria-labelledby":Fe,"aria-level":Qe+1,role:"treeitem","aria-owns":Ge.length>0?Ge.map(Ne=>L(be,Ne.uid)).join(" "):void 0,"aria-setsize":Ge.length,"aria-posinset":Me.findIndex(Ne=>Ne.uid===Se.uid)+1,id:L(be,Se.uid),children:(0,t.jsxs)("div",{className:De.rowBody,children:[(0,t.jsx)(S.T,{level:Qe,spacing:2}),de?(0,t.jsx)(P.K,{size:R,onMouseDown:Ke,tabIndex:-1,"aria-label":Xe?`Collapse folder ${Se.title}`:`Expand folder ${Se.title}`,name:Xe?"angle-down":"angle-right"}):(0,t.jsx)("span",{className:De.folderButtonSpacer}),(0,t.jsx)("label",{className:De.label,id:Fe,children:(0,t.jsx)(b.E,{truncate:!0,children:Se.title})})]})})}const U=ne=>{const ce=(0,n.css)({height:O,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:ne.spacing(.5),overflow:"hidden",padding:ne.spacing(0,1)});return{table:(0,n.css)({background:ne.components.input.background}),emptyMessage:(0,n.css)({padding:ne.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,n.css)({paddingLeft:ne.spacing(.5)}),row:(0,n.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${ne.colors.border.weak}`}}),rowFocused:(0,n.css)({backgroundColor:ne.colors.background.secondary}),rowSelected:(0,n.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:ne.shape.radius.default,backgroundImage:ne.colors.gradients.brandVertical}}),rowBody:ce,label:(0,n.css)({lineHeight:O+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var W=e(94963);function A(){const ne=(0,u.of)(N);return(0,t.jsx)("div",{className:ne.wrapper,children:(0,t.jsx)("div",{className:ne.inputWrapper,children:(0,t.jsx)("button",{type:"button",className:ne.fakeInput,"aria-disabled":!0,children:(0,t.jsx)(l.A,{width:100})})})})}const N=ne=>{const ce=(0,g.n)({theme:ne});return{wrapper:ce.wrapper,inputWrapper:ce.inputWrapper,fakeInput:(0,n.css)([ce.input,{textAlign:"left"}])}};function K({handleClearSelection:ne,isLoading:ce,invalid:le,label:he,...oe},de){const me=(0,u.$j)(),Pe=T(me,le),Ee=be=>{(be.key==="Enter"||be.key===" ")&&ne?.(be)};return ce?(0,t.jsx)(A,{}):(0,t.jsx)("div",{className:Pe.wrapper,children:(0,t.jsxs)("div",{className:Pe.inputWrapper,children:[he?(0,t.jsx)("div",{className:Pe.prefix,children:(0,t.jsx)(o.I,{name:"folder"})}):void 0,(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(Pe.fakeInput,he?Pe.hasPrefix:void 0),...oe,ref:de,children:[he?(0,t.jsx)(b.E,{truncate:!0,children:he}):(0,t.jsx)(b.E,{truncate:!0,color:"secondary",children:(0,t.jsx)(f.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!ce&&ne&&(0,t.jsx)(o.I,{role:"button",tabIndex:0,"aria-label":(0,f.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:Pe.clearIcon,name:"times",onClick:ne,onKeyDown:Ee})]}),(0,t.jsx)("div",{className:Pe.suffix,children:(0,t.jsx)(o.I,{name:"angle-down"})})]})})}const V=(0,c.forwardRef)(K),T=(ne,ce=!1)=>{const le=(0,g.n)({theme:ne,invalid:ce});return{wrapper:le.wrapper,inputWrapper:le.inputWrapper,prefix:(0,n.css)([le.prefix,{pointerEvents:"none",color:ne.colors.text.primary}]),suffix:(0,n.css)([le.suffix,{pointerEvents:"none"}]),fakeInput:(0,n.css)([le.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,W.getFocusStyles)(ne),alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,n.css)({paddingLeft:28}),clearIcon:(0,n.css)({color:ne.colors.text.secondary,cursor:"pointer","&:hover":{color:ne.colors.text.primary},"&:focus:not(:focus-visible)":(0,W.getMouseFocusStyles)(ne),"&:focus-visible":(0,W.getFocusStyles)(ne)})}};var z=e(25508),w=e(86865),H=e(5741),G=e(81954);const X=(0,z.Mz)([ne=>ne,(ne,ce)=>ce],(ne,ce)=>{const le=new Set,he=[],oe={};let de=!1;for(const me of ce){if(le.has(me.requestId))continue;const Pe=p.cU.endpoints.listFolders.select({parentUid:me.arg.parentUid,page:me.arg.page,limit:me.arg.limit,permission:me.arg.permission})(ne);Pe.status==="pending"&&(de=!0);const Ee=Pe.originalArgs?.parentUid;Ee?(oe[Ee]||(oe[Ee]=[]),oe[Ee].push(Pe)):he.push(Pe)}return{isLoading:de,rootPages:he,pagesByParent:oe}});function k(ne){const ce=ne.at(-1),le=ce?.originalArgs?.page;return ce?.data?[ce.data.length<ce.originalArgs.limit,le]:[!1,le]}function _(ne,ce,le){const he=(0,G.wA)(),oe=(0,c.useRef)([]),de=(0,G.d4)(Ee=>X(Ee,oe.current)),me=(0,c.useCallback)(Ee=>{const be=Ee?de.pagesByParent[Ee]:de.rootPages,[Se,Xe]=k(be??[]);if(Se)return;const Qe={parentUid:Ee,page:(Xe??0)+1,limit:w.md,permission:le},we=he(p.cU.endpoints.listFolders.initiate(Qe));oe.current=oe.current.concat([we])},[de,he,le]);return(0,c.useEffect)(()=>()=>{for(const Ee of oe.current)Ee.unsubscribe()},[]),{items:(0,c.useMemo)(()=>{if(!ne)return[];function Ee(Se,Xe,Qe){const we=Xe.flatMap(Fe=>(Fe.data??[]).flatMap(Le=>{const Ge=ce[Le.uid],Me={isOpen:!!Ge,level:Qe,item:{kind:"folder",title:Le.title,uid:Le.uid}},De=Ge&&de.pagesByParent[Le.uid];if(De){const Ke=Ee(Le.uid,De,Qe+1);return[Me,...Ke]}return Me})),[$e]=k(Xe);return $e||we.push(...(0,H.T)(w.md,Se,Qe)),we}const be=Ee(void 0,de.rootPages,1);return be.unshift(ee),be},[de,ne,ce]),isLoading:de.isLoading,requestNextPage:me}}const ee={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function J({tree:ne,handleCloseOverlay:ce,handleFolderSelect:le,handleFolderExpand:he,idPrefix:oe,search:de,visible:me}){const[Pe,Ee]=(0,c.useState)(-1),be=!!d.$.featureToggles.nestedFolders;(0,c.useEffect)(()=>{me&&Ee(-1)},[me]),(0,c.useEffect)(()=>{Ee(0)},[de]),(0,c.useEffect)(()=>{document.getElementById(L(oe,ne[Pe]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[Pe,oe,ne]);const Se=(0,c.useCallback)(Xe=>{const Qe=be&&!de;switch(Xe.key){case"ArrowRight":case"ArrowLeft":Qe&&(Xe.preventDefault(),he(ne[Pe].item.uid,Xe.key==="ArrowRight"));break;case"ArrowUp":Pe>0&&(Xe.preventDefault(),Ee(Pe-1));break;case"ArrowDown":Pe<ne.length-1&&(Xe.preventDefault(),Ee(Pe+1));break;case"Enter":Xe.preventDefault();const we=ne[Pe].item;we.kind==="folder"&&le(we);break;case"Tab":Xe.stopPropagation(),ce();break;case"Escape":Xe.stopPropagation(),Xe.preventDefault(),ce();break}},[Pe,ce,he,le,be,de,ne]);return{focusedItemIndex:Pe,handleKeyDown:Se}}const Z=s()(te,300);async function te(ne,ce){const le=await(0,h.S)().search({query:ne,kind:["folder"],limit:100,permission:ce}),he=le.view.map(oe=>(0,D.hI)(oe,le.view));return{...le,items:he}}function ae({value:ne,invalid:ce,showRootFolder:le=!0,clearable:he=!1,excludeUIDs:oe,permission:de="edit",onChange:me}){const Pe=(0,u.of)(re),Ee=(0,p.kH)(ne||p.hT),be=!!d.$.featureToggles.nestedFolders,[Se,Xe]=(0,c.useState)(""),[Qe,we]=(0,c.useState)(null),[$e,Fe]=(0,c.useState)(!1),[Te,Le]=(0,c.useState)(!1),[Ge,Me]=(0,c.useState)(!1),[De,Ke]=(0,c.useState)({}),Ie=(0,c.useId)(),[Ne]=(0,c.useState)(void 0),ie=(0,c.useRef)(0),ve=(0,c.useMemo)(()=>{if(de==="view")return C.PermissionLevelString.View;if(de==="edit")return C.PermissionLevelString.Edit;throw new Error("Invalid permission")},[de]),fe=!!(Ge&&!(Se&&Qe)),{items:ge,isLoading:xe,requestNextPage:je}=_(fe,De,ve);(0,c.useEffect)(()=>{if(!Se){we(null);return}const cn=Date.now();Fe(!0),Z(Se,ve).then(jn=>{if(cn>ie.current){const _n=jn.view.map(Ot=>(0,D.hI)(Ot,jn.view));we({...jn,items:_n}),Fe(!1),ie.current=cn}})},[Se,ve]);const Ve=[(0,r.UU)({crossAxis:!1,boundary:document.body})],{context:ke,refs:Oe,floatingStyles:nt,elements:Je}=(0,a.we)({open:Ge,placement:"bottom",onOpenChange:cn=>{cn&&(Xe(""),Le(!0)),Me(cn)},middleware:Ve,whileElementsMounted:i.ll}),Be=(0,a.kp)(ke),Ze=(0,a.s9)(ke),{getReferenceProps:tt,getFloatingProps:Re}=(0,a.bv)([Ze,Be]),at=(0,c.useCallback)(async(cn,jn)=>{Ke(_n=>({..._n,[cn]:jn})),jn&&!De[cn]&&je(cn)},[je,De]),yt=(0,c.useCallback)(cn=>{me&&me(cn.uid,cn.title),Me(!1)},[me]),ze=(0,c.useCallback)(cn=>{cn.preventDefault(),cn.stopPropagation(),me&&me(void 0,void 0)},[me]),st=(0,c.useCallback)(()=>Me(!1),[Me]),ht=(0,c.useCallback)(cn=>{Se||je(cn)},[Se,je]),It=(0,c.useMemo)(()=>{let cn=[];return fe?cn=ge:cn=Qe?.items.map(jn=>({isOpen:!1,level:0,item:{kind:"folder",title:jn.title,uid:jn.uid}}))??[],(!le||oe?.length)&&(cn=cn.filter(jn=>!(!le&&jn===ee||oe?.includes(jn.item.uid)))),cn},[ge,oe,fe,Qe?.items,le]),Gt=(0,c.useCallback)(cn=>{const jn=It[cn];if(!jn)return!1;const _n=jn.item;return!(_n.kind==="ui"&&_n.uiKind==="pagination-placeholder")},[It]),un=xe||$e,{focusedItemIndex:vn,handleKeyDown:pn}=J({tree:It,handleCloseOverlay:st,handleFolderSelect:yt,handleFolderExpand:at,idPrefix:Ie,search:Se,visible:Ge});let xn=Ee.data?.title;return ne===""&&(xn="Dashboards"),Ge?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.p,{ref:Oe.setReference,autoFocus:!0,prefix:xn?(0,t.jsx)(o.I,{name:"folder"}):null,placeholder:xn??(0,f.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:Se,invalid:ce,className:Pe.search,onChange:cn=>Xe(cn.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":Ie,"aria-owns":Ie,"aria-activedescendant":L(Ie,It[vn]?.item.uid),role:"combobox",suffix:(0,t.jsx)(o.I,{name:"search"}),...tt(),onKeyDown:pn}),(0,t.jsx)("fieldset",{ref:Oe.setFloating,id:Ie,className:Pe.tableWrapper,style:{...nt,width:Je.domReference?.clientWidth},...Re(),children:Ne?(0,t.jsx)(E.F,{className:Pe.error,severity:"warning",title:(0,f.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:Ne.message||Ne.toString?.()||(0,f.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,t.jsxs)("div",{children:[un&&(0,t.jsx)("div",{className:Pe.loader,children:(0,t.jsx)(m.G,{width:600})}),(0,t.jsx)(B,{items:It,selectedFolder:ne,focusedItemIndex:vn,onFolderExpand:at,onFolderSelect:yt,idPrefix:Ie,foldersAreOpenable:be&&!(Se&&Qe),isItemLoaded:Gt,requestLoadMore:ht})]})})]}):(0,t.jsx)(V,{label:xn,handleClearSelection:he&&ne!==void 0?ze:void 0,invalid:ce,isLoading:Ee.isLoading,autoFocus:Te,ref:Oe.setReference,"aria-label":xn?(0,f.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:xn}):void 0,...tt()})}const re=ne=>({button:(0,n.css)({maxWidth:"100%"}),error:(0,n.css)({marginBottom:0}),tableWrapper:(0,n.css)({boxShadow:ne.shadows.z3,position:"relative",zIndex:ne.zIndex.portal}),loader:(0,n.css)({position:"absolute",top:0,left:0,right:0,zIndex:ne.zIndex.portal+1,overflow:"hidden"}),search:(0,n.css)({input:{cursor:"default"}})})},30602:(q,j,e)=>{"use strict";e.d(j,{Q:()=>s});var t=e(74848),n=e(2543),r=e.n(n),a=e(96540),i=e(34128),x=e(86489);class s extends a.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=a.createRef(),this.updateValue=()=>{const d=this.inputRef.current?.value;let u=!1,g="";const o=this.props.min,E=this.props.max;let m=d!==""?Number(d):void 0;m&&!Number.isNaN(m)&&(o!=null&&m<o?(g=o.toString(),u=!0):E!=null&&m>E?(g=E.toString(),u=!0):g=d??"",this.setState({text:g,inputCorrected:u})),u&&this.updateValueDebounced(),!Number.isNaN(m)&&m!==this.props.value&&this.props.onChange(m)},this.updateValueDebounced=(0,n.debounce)(this.updateValue,500),this.onChange=d=>{this.setState({text:d.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=d=>{d.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(d){if(this.props.value!==d.value){const u=isNaN(this.props.value)?"":`${this.props.value}`;u!==this.state.text&&this.setState({text:u})}}renderInput(){return(0,t.jsx)(i.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:d}=this.state;if(d){let u="",{min:g,max:o}=this.props;return o==null?g!=null&&(u=`< ${g}`):g!=null?u=`${g} < > ${o}`:u=`> ${o}`,(0,t.jsx)(x.D,{invalid:d,error:`Out of range ${u}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},8106:(q,j,e)=>{"use strict";e.d(j,{a:()=>s});var t=e(74848),n=e(22803),r=e(29675),a=e(57836),i=e(99764),x=e(82738);const s=({value:d,settings:u,onChange:g,details:o})=>{const E=(0,r.$j)(),m=(0,r.of)(c);return(0,t.jsx)(a.sk,{color:d??"",onChange:g,enableNamedColors:u?.enableNamedColors!==!1,children:({ref:f,showColorPicker:p,hideColorPicker:h})=>(0,t.jsxs)("div",{className:m.spot,children:[(0,t.jsx)("div",{className:m.colorPicker,children:(0,t.jsx)(x.q,{ref:f,onClick:p,onMouseLeave:h,color:d?E.visualization.getColorByName(d):E.components.input.borderColor})}),o&&(0,t.jsxs)(t.Fragment,{children:[d?(0,t.jsx)("span",{className:m.colorText,onClick:p,children:d}):(0,t.jsx)("span",{className:m.placeholderText,onClick:p,children:u?.placeholder??"Select color"}),u?.isClearable&&d&&(0,t.jsx)(i.K,{name:"times",onClick:()=>g(void 0),tooltip:"Clear settings"})]})]})})},c=d=>({spot:(0,n.css)({cursor:"pointer",color:d.colors.text.primary,background:d.components.input.background,padding:"3px",height:d.v1.spacing.formInputHeight,border:`1px solid ${d.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${d.components.input.borderHover}`}}),colorPicker:(0,n.css)({padding:`0 ${d.spacing(1)}`}),colorText:(0,n.css)({flexGrow:2}),placeholderText:(0,n.css)({flexGrow:2,color:d.colors.text.secondary})})},29768:(q,j,e)=>{"use strict";e.d(j,{w:()=>a});var t=e(74848),n=e(96540),r=e(30602);const a=({value:i,onChange:x,item:s})=>{const{settings:c}=s,d=(0,n.useCallback)(u=>{x(c?.integer&&u!==void 0?Math.floor(u):u)},[x,c?.integer]);return(0,t.jsx)(r.Q,{value:i,min:c?.min,max:c?.max,step:c?.step,placeholder:c?.placeholder,onChange:d})}},71536:(q,j,e)=>{"use strict";e.d(j,{H:()=>ie,u:()=>ve});var t=e(74848),n=e(79488),r=e(49448),a=e(63739),i=e(99116),x=e(32370),s=e(29010),c=e(60641),d=e(14749),u=e(59748),g=e(96540),o=e(22803),E=e(2543),m=e(42483),f=e(15580),p=e(41090),h=e(34128),D=e(57836),C=e(99764),l=e(54594),v=e(40271),y=e(90617);const P=[{value:i.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:i.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class b extends g.PureComponent{constructor(ge){super(ge),this.onAddThreshold=()=>{const{steps:je}=this.state;let Ve=0;je.length>1&&(Ve=je[je.length-1].value+10);let ke=p.Tj.filter(Je=>!je.some(Be=>Be.color===Je))[1];ke||(ke="#CCCCCC");const Oe={value:Ve,color:ke,key:S++},nt=[...je,Oe];(0,m.RU)(nt),this.setState({steps:nt},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=je=>{const{steps:Ve}=this.state;Ve.length&&je.key!==Ve[0].key&&this.setState({steps:Ve.filter(ke=>ke.key!==je.key)},this.onChange)},this.onChangeThresholdValue=(je,Ve)=>{const ke=je.target.value.replace(/,/g,"."),Oe=parseFloat(ke),nt=isNaN(Oe)?"":Oe,Je=this.state.steps.map(Be=>(Be.key===Ve.key&&(Be={...Be,value:nt}),Be));Je.length&&(Je[0].value=-1/0),(0,m.RU)(Je),this.setState({steps:Je})},this.onChangeThresholdColor=(je,Ve)=>{const{steps:ke}=this.state,Oe=ke.map(nt=>(nt.key===je.key&&(nt={...nt,color:Ve}),nt));this.setState({steps:Oe},this.onChange)},this.onBlur=()=>{const je=[...this.state.steps];(0,m.RU)(je),this.setState({steps:je},this.onChange)},this.onChange=()=>{this.props.onChange(O(this.props.thresholds,this.state.steps))},this.onModeChanged=je=>{this.props.onChange({...this.props.thresholds,mode:je})};const xe=M(ge.thresholds.steps);xe[0].value=-1/0,this.state={steps:xe},this.latestThresholdInputRef=g.createRef()}renderInput(ge,xe,je){const Ve=this.props.thresholds.mode===i.O.Percentage,ke=`Threshold ${je+1}`;return isFinite(ge.value)?(0,t.jsx)(h.p,{type:"number",step:"0.0001",onChange:Oe=>this.onChangeThresholdValue(Oe,ge),value:ge.value,"aria-label":ke,ref:je===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,t.jsxs)("div",{className:xe.inputPrefix,children:[(0,t.jsx)("div",{className:xe.colorPicker,children:(0,t.jsx)(D.sk,{color:ge.color,onChange:Oe=>this.onChangeThresholdColor(ge,Oe),enableNamedColors:!0})}),Ve&&(0,t.jsx)("div",{className:xe.percentIcon,children:"%"})]}),suffix:(0,t.jsx)(C.K,{className:xe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(ge),tooltip:`Remove ${ke}`})},Ve.toString()):(0,t.jsx)(h.p,{type:"text",value:"Base","aria-label":ke,disabled:!0,prefix:(0,t.jsx)("div",{className:xe.colorPicker,children:(0,t.jsx)(D.sk,{color:ge.color,onChange:Oe=>this.onChangeThresholdColor(ge,Oe),enableNamedColors:!0})})})}render(){const{thresholds:ge}=this.props,{steps:xe}=this.state;return(0,t.jsx)(f.D.Consumer,{children:je=>{const Ve=R(je);return(0,t.jsxs)("div",{className:Ve.wrapper,children:[(0,t.jsx)(l.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Ve.addButton,fullWidth:!0,children:"Add threshold"}),(0,t.jsx)("div",{className:Ve.thresholds,children:xe.slice(0).reverse().map((ke,Oe)=>(0,t.jsx)("div",{className:Ve.item,children:this.renderInput(ke,Ve,Oe)},`${ke.key}`))}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.J,{description:"Percentage means thresholds relative to min & max",children:"Thresholds mode"}),(0,t.jsx)(c.z,{options:P,onChange:this.onModeChanged,value:ge.mode})]})]})}})}}let S=100;function M(fe){return(!fe||fe.length===0)&&(fe=[{value:-1/0,color:"green"}]),fe.filter((ge,xe)=>(0,E.isNumber)(ge.value)||xe===0).map(ge=>({color:ge.color,value:ge.value===null?-1/0:ge.value,key:S++}))}function O(fe,ge){return{mode:fe.mode??i.O.Absolute,steps:ge.map(je=>{const{key:Ve,...ke}=je;return ke})}}const R=(0,y.N)(fe=>({wrapper:(0,o.css)({display:"flex",flexDirection:"column"}),thresholds:(0,o.css)({display:"flex",flexDirection:"column",marginBottom:fe.spacing(2)}),item:(0,o.css)({marginBottom:fe.spacing(1),"&:last-child":{marginBottom:0}}),colorPicker:(0,o.css)({padding:fe.spacing(0,1)}),addButton:(0,o.css)({marginBottom:fe.spacing(1)}),percentIcon:(0,o.css)({fontSize:fe.typography.bodySmall.fontSize,color:fe.colors.text.secondary}),inputPrefix:(0,o.css)({display:"flex",alignItems:"center"}),trashIcon:(0,o.css)({color:fe.colors.text.secondary,cursor:"pointer",marginRight:0,"&:hover":{color:fe.colors.text.primary}})}));class L extends g.PureComponent{constructor(ge){super(ge)}render(){const{onChange:ge}=this.props;let xe=this.props.value;return xe||(xe={mode:i.O.Percentage,steps:[]}),(0,t.jsx)(b,{thresholds:xe,onChange:ge})}}var B=e(65329),F=e(29675),I=e(19550),U=e(79784),W=e(25356),A=e(86142),N=e(38390),K=e(57095),V=e(31952),T=e(44826);function z({mapping:fe,index:ge,onChange:xe,onRemove:je,onDuplicate:Ve,showIconPicker:ke}){const{key:Oe,result:nt,id:Je}=fe,Be=(0,F.of)(w),Ze=(0,g.useRef)(null),tt=(0,g.useCallback)(xn=>{const cn={...fe,result:{...fe.result}};xn(cn),xe(ge,cn)},[fe,ge,xe]);(0,g.useEffect)(()=>{Ze.current&&fe.isNew&&(Ze.current.focus(),tt(xn=>{xn.isNew=!1}))},[fe,Ze,tt]);const Re=xn=>{tt(cn=>{cn.result.color=xn})},at=()=>{tt(xn=>{xn.result.color=void 0})},yt=xn=>{tt(cn=>{cn.result.icon=xn})},ze=()=>{tt(xn=>{xn.result.icon=void 0})},st=xn=>{tt(cn=>{cn.key=xn.currentTarget.value})},ht=xn=>{tt(cn=>{cn.result.text=xn.currentTarget.value})},It=xn=>{tt(cn=>{cn.from=parseFloat(xn.currentTarget.value)})},Gt=xn=>{tt(cn=>{cn.to=parseFloat(xn.currentTarget.value)})},un=xn=>{tt(cn=>{cn.pattern=xn.currentTarget.value})},vn=xn=>{tt(cn=>{cn.specialMatch=xn.value})},pn=[{label:"Null",value:B.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:B.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:B.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:B.W.True,description:"Boolean true values"},{label:"False",value:B.W.False,description:"Boolean false values"},{label:"Empty",value:B.W.Empty,description:"Empty string"}];return(0,t.jsx)(K.Draggable,{draggableId:Je,index:ge,children:xn=>(0,t.jsxs)("tr",{className:Be.dragRow,ref:xn.innerRef,...xn.draggableProps,children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:Be.dragHandle,...xn.dragHandleProps,children:(0,t.jsx)(U.I,{name:"draggabledots",size:"lg"})})}),(0,t.jsx)("td",{className:Be.typeColumn,children:fe.type}),(0,t.jsxs)("td",{children:[fe.type===B.d.ValueToText&&(0,t.jsx)(h.p,{ref:Ze,type:"text",value:Oe??"",onChange:st,placeholder:"Exact value to match"}),fe.type===B.d.RangeToText&&(0,t.jsxs)("div",{className:Be.rangeInputWrapper,children:[(0,t.jsx)(h.p,{type:"number",value:fe.from??"",placeholder:"Range start",onChange:It,prefix:"From"}),(0,t.jsx)(h.p,{type:"number",value:fe.to??"",placeholder:"Range end",onChange:Gt,prefix:"To"})]}),fe.type===B.d.RegexToText&&(0,t.jsx)(h.p,{type:"text",value:fe.pattern??"",placeholder:"Regular expression",onChange:un}),fe.type===B.d.SpecialValue&&(0,t.jsx)(T.l6,{value:pn.find(cn=>cn.value===fe.specialMatch),options:pn,onChange:vn})]}),(0,t.jsx)("td",{children:(0,t.jsx)(h.p,{type:"text",value:nt.text??"",onChange:ht,placeholder:"Optional display text"})}),(0,t.jsxs)("td",{className:Be.textAlignCenter,children:[nt.color&&(0,t.jsxs)(I.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(D.sk,{color:nt.color,onChange:Re,enableNamedColors:!0}),(0,t.jsx)(C.K,{name:"times",onClick:at,tooltip:"Remove color",tooltipPlacement:"top"})]}),!nt.color&&(0,t.jsx)(D.sk,{color:"gray",onChange:Re,enableNamedColors:!0,children:cn=>(0,t.jsx)(l.$n,{variant:"primary",fill:"text",onClick:cn.showColorPicker,ref:cn.ref,size:"sm",children:"Set color"})})]}),ke&&(0,t.jsx)("td",{className:Be.textAlignCenter,children:(0,t.jsxs)(I.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(N.n,{onChange:yt,onClear:ze,value:nt.icon,size:A.Iy.SMALL,folderName:A.Iu.Icon,mediaType:A.zu.Icon,color:nt.color}),nt.icon&&(0,t.jsx)(C.K,{name:"times",onClick:ze,tooltip:"Remove icon",tooltipPlacement:"top"})]})}),(0,t.jsx)("td",{className:Be.textAlignCenter,children:(0,t.jsxs)(I.Gy,{spacing:"sm",children:[(0,t.jsx)(C.K,{name:"copy",onClick:()=>Ve(ge),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),(0,t.jsx)(C.K,{name:"trash-alt",onClick:()=>je(ge),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})]})})]})},Je)}const w=fe=>({dragRow:(0,o.css)({position:"relative"}),dragHandle:(0,o.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${fe.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,o.css)({display:"flex","> div:first-child":{marginRight:fe.spacing(2)}}),regexInputWrapper:(0,o.css)({display:"flex","> div:first-child":{marginRight:fe.spacing(2)}}),typeColumn:(0,o.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,o.css)({textAlign:"center"})});function H({value:fe,onChange:ge,onClose:xe,showIconPicker:je}){const Ve=(0,F.of)(G),[ke,Oe]=(0,g.useState)([]);(0,g.useEffect)(()=>{Oe(J(fe))},[fe]);const nt=yt=>{if(!fe||!yt.destination)return;const ze=[...ke],st=ze[yt.source.index];ze.splice(yt.source.index,1),ze.splice(yt.destination.index,0,st),Oe(ze)},Je=(yt,ze)=>{const st=[...ke];st.splice(yt,1,ze),Oe(st)},Be=yt=>{const ze=[...ke];ze.splice(yt,1),Oe(ze)},Ze=[{label:"Value",value:B.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:B.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:B.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:B.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],tt=yt=>{Oe([...ke,k({type:yt.value,result:{},isNew:!0})])},Re=yt=>{const ze=_(ke[yt]),st=[...ke];st.splice(yt,0,{...ze});for(let ht=yt;ht<ke.length;ht++)st[ht].result.index=ht;Oe(st)},at=()=>{ge(ee(ke)),xe()};return(0,g.useEffect)(()=>{fe?.length||tt({value:B.d.ValueToText})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ve.tableWrap,children:(0,t.jsxs)("table",{className:Ve.editTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:"Condition"}),(0,t.jsx)("th",{style:{textAlign:"left"},children:"Display text"}),(0,t.jsx)("th",{style:{width:"10%"},children:"Color"}),je&&(0,t.jsx)("th",{style:{width:"10%"},children:"Icon"}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)(K.DragDropContext,{onDragEnd:nt,children:(0,t.jsx)(K.Droppable,{droppableId:"sortable-field-mappings",direction:"vertical",children:yt=>(0,t.jsxs)("tbody",{ref:yt.innerRef,...yt.droppableProps,children:[ke.map((ze,st)=>(0,t.jsx)(z,{mapping:ze,index:st,onChange:Je,onRemove:Be,onDuplicate:Re,showIconPicker:je},ze.id)),yt.placeholder]})})})]})}),(0,t.jsxs)(W.a.ButtonRow,{leftItems:(0,t.jsx)(V.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:Ze,onChange:tt}),children:[(0,t.jsx)(l.$n,{variant:"secondary",fill:"outline",onClick:xe,children:"Cancel"}),(0,t.jsx)(l.$n,{variant:"primary",onClick:at,children:"Update"})]})]})}const G=fe=>({tableWrap:(0,o.css)({maxHeight:"calc(80vh - 170px)",minHeight:"40px",overflow:"auto"}),editTable:(0,o.css)({width:"100%",marginBottom:fe.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:fe.colors.action.hover}," th, td":{padding:fe.spacing(1)}})});function X(){return(0,E.uniqueId)("mapping-")}function k(fe){return{type:B.d.ValueToText,result:{},id:X(),...fe}}function _(fe){return{...k(fe),id:X()}}function ee(fe){const ge=[],xe={type:B.d.ValueToText,options:{}};return fe.forEach((je,Ve)=>{const ke={...je.result,index:Ve};switch((!ke.text||ke.text.trim().length===0)&&(ke.text=void 0),je.type){case B.d.ValueToText:je.key!=null&&(xe.options[je.key]=ke);break;case B.d.RangeToText:je.from!=null&&je.to!=null&&ge.push({type:je.type,options:{from:je.from,to:je.to,result:ke}});break;case B.d.RegexToText:je.pattern!=null&&ge.push({type:je.type,options:{pattern:je.pattern,result:ke}});break;case B.d.SpecialValue:ge.push({type:je.type,options:{match:je.specialMatch,result:ke}})}}),Object.keys(xe.options).length>0&&ge.unshift(xe),ge}function J(fe){const ge=[];if(fe)for(const xe of fe)switch(xe.type){case B.d.ValueToText:for(const je in xe.options)ge.push(k({type:xe.type,result:xe.options[je],key:je}));break;case B.d.RangeToText:ge.push(k({type:xe.type,result:xe.options.result,from:xe.options.from??0,to:xe.options.to??0}));break;case B.d.RegexToText:ge.push(k({type:xe.type,result:xe.options.result,pattern:xe.options.pattern}));break;case B.d.SpecialValue:ge.push(k({type:xe.type,result:xe.options.result,specialMatch:xe.options.match??B.W.Null}))}return ge.sort((xe,je)=>(xe.result.index??0)>(je.result.index??0)?1:-1),ge}const Z=(0,g.memo)(fe=>{const{value:ge,onChange:xe,item:je}=fe,Ve=(0,F.of)(te),ke=je.settings?.icon,[Oe,nt]=(0,g.useState)(!1),Je=(0,g.useCallback)(()=>{nt(!1)},[nt]),Be=(0,g.useMemo)(()=>J(ge),[ge]),Ze=(0,g.useCallback)((Re,at)=>{Be[at].result.color=Re,xe(ee(Be))},[Be,xe]),tt=(0,g.useCallback)((Re,at)=>{Be[at].result.icon=Re,xe(ee(Be))},[Be,xe]);return(0,t.jsxs)(I.gW,{children:[(0,t.jsx)("table",{className:Ve.compactTable,children:(0,t.jsx)("tbody",{children:Be.map((Re,at)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[Re.type===B.d.ValueToText&&Re.key,Re.type===B.d.RangeToText&&(0,t.jsxs)("span",{children:["[",Re.from," - ",Re.to,"]"]}),Re.type===B.d.RegexToText&&Re.pattern,Re.type===B.d.SpecialValue&&Re.specialMatch]}),(0,t.jsx)("td",{children:(0,t.jsx)(U.I,{name:"arrow-right"})}),(0,t.jsx)("td",{children:Re.result.text}),Re.result.color&&(0,t.jsx)("td",{children:(0,t.jsx)(D.sk,{color:Re.result.color,onChange:yt=>Ze(yt,at),enableNamedColors:!0})}),ke&&Re.result.icon&&(0,t.jsx)("td",{"data-testid":"iconPicker",children:(0,t.jsx)(N.n,{onChange:yt=>tt(yt,at),value:Re.result.icon,size:A.Iy.SMALL,folderName:A.Iu.Icon,mediaType:A.zu.Icon,color:Re.result.color})})]},at.toString()))})}),(0,t.jsxs)(l.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>nt(!0),children:[Be.length>0&&(0,t.jsx)("span",{children:"Edit value mappings"}),Be.length===0&&(0,t.jsx)("span",{children:"Add value mappings"})]}),(0,t.jsx)(W.a,{isOpen:Oe,title:"Value mappings",onDismiss:Je,className:Ve.modal,closeOnBackdropClick:!1,children:(0,t.jsx)(H,{value:ge,onChange:xe,onClose:Je,showIconPicker:ke})})]})});Z.displayName="ValueMappingsEditor";const te=fe=>({modal:(0,o.css)({width:"980px"}),compactTable:(0,o.css)({width:"100%","tbody td":{padding:fe.spacing(.5)}})});var ae=e(93403);const re=({value:fe,onChange:ge,item:xe})=>{const{placeholder:je,isClearable:Ve}=xe?.settings??{},ke=(0,g.useCallback)(Oe=>{ge(Oe?.value?.uid)},[ge]);return(0,t.jsx)(ae.b,{isClearable:Ve,defaultOptions:!0,onChange:ke,placeholder:je,value:fe})};var ne=e(47180),ce=e(9932);const le=({value:fe,onChange:ge,context:xe})=>(0,t.jsx)(ce.G,{actions:fe,onChange:ge,data:xe.data,getSuggestions:()=>xe.getSuggestions?xe.getSuggestions(ne.uP.Values):[]});var he=e(8106),oe=e(18752),de=e(62931),me=e(86489);const Pe=({value:fe,onChange:ge,item:xe,id:je})=>{const Ve=(0,F.$j)(),ke=(0,F.of)(be),Oe=(0,oe.Hs)(fe?.mode),Je=(xe.settings?.byValueSupport?oe.uf.list():oe.uf.list().filter(at=>!at.isByValue)).filter(at=>!at.excludeFromPicker).map(at=>{let yt=at.isByValue?" (by value)":"";return{value:at.id,label:`${at.name}${yt}`,description:at.description,isContinuous:at.isContinuous,isByValue:at.isByValue,component(){return(0,t.jsx)(Ee,{mode:at,theme:Ve})}}}),Be=at=>{ge({...fe,mode:at.value})},Ze=at=>{ge({...fe,mode:Re,fixedColor:at})},tt=at=>{ge({...fe,mode:Re,seriesBy:at})},Re=fe?.mode??de.Y.Thresholds;if(Re===de.Y.Fixed||Re===de.Y.Shades)return(0,t.jsxs)("div",{className:ke.group,children:[(0,t.jsx)(T.l6,{minMenuHeight:200,options:Je,value:Re,onChange:Be,className:ke.select,inputId:je}),(0,t.jsx)(he.a,{value:fe?.fixedColor,onChange:Ze})]});if(xe.settings?.bySeriesSupport&&Oe.isByValue){const at=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:Ve.spacing(2)},children:(0,t.jsx)(T.l6,{minMenuHeight:200,options:Je,value:Re,onChange:Be,inputId:je})}),(0,t.jsx)(me.D,{label:"Color series by",children:(0,t.jsx)(c.z,{value:fe?.seriesBy??"last",options:at,onChange:tt})})]})}return(0,t.jsx)(T.l6,{minMenuHeight:200,options:Je,value:Re,onChange:Be,inputId:je})},Ee=({mode:fe,theme:ge})=>{if(!fe.getColors)return null;const xe=fe.getColors(ge).map(ge.visualization.getColorByName),je={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(fe.isContinuous)je.background=`linear-gradient(90deg, ${xe.join(",")})`;else{let Ve="",ke="";for(let Oe=0;Oe<xe.length;Oe++){const nt=xe[Oe];if(Ve==="")Ve=`linear-gradient(90deg, ${nt} 0%`;else{const Be=Oe/(xe.length-1)*100;Ve+=`, ${ke} ${Be}%, ${nt} ${Be}%`}ke=nt}je.background=Ve}return(0,t.jsx)("div",{style:je})},be=fe=>({group:(0,o.css)({display:"flex"}),select:(0,o.css)({marginRight:fe.spacing(1),flexGrow:1})});var Se=e(99153);const Xe=({value:fe,onChange:ge,context:xe,item:je})=>(0,t.jsx)(Se.e,{links:fe,onChange:ge,data:xe.data,getSuggestions:()=>xe.getSuggestions?xe.getSuggestions(ne.uP.Values):[],showOneClick:je.settings?.showOneClick});class Qe extends g.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:ge}=this.props,{settings:xe}=ge;let je=ge.settings?.options||[];xe?.getOptions&&(je=await xe.getOptions(this.props.context)),this.state.options!==je&&this.setState({isLoading:!1,options:je})}}componentDidMount(){this.updateOptions()}componentDidUpdate(ge){const xe=ge.item?.settings,je=this.props.item?.settings;if(xe!==je)this.updateOptions();else if(je?.getOptions){const Ve=ge.context?.data,ke=this.props.context?.data;Ve!==ke&&this.updateOptions()}}render(){const{options:ge,isLoading:xe}=this.state,{value:je,onChange:Ve,item:ke}=this.props,{settings:Oe}=ke;return(0,t.jsx)(T.KF,{isLoading:xe,value:je,defaultValue:je,allowCustomValue:Oe?.allowCustomValue,onChange:nt=>{Ve(nt.map(Je=>Je.value).flatMap(Je=>Je!==void 0?[Je]:[]))},options:ge})}}var we=e(29768);class $e extends g.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:ge}=this.props,{settings:xe}=ge;let je=ge.settings?.options||[];xe?.getOptions&&(je=await xe.getOptions(this.props.context)),this.state.options!==je&&this.setState({isLoading:!1,options:je})}}componentDidMount(){this.updateOptions()}componentDidUpdate(ge){const xe=ge.item?.settings,je=this.props.item?.settings;if(xe!==je)this.updateOptions();else if(je?.getOptions){const Ve=ge.context?.data,ke=this.props.context?.data;Ve!==ke&&this.updateOptions()}}render(){const{options:ge,isLoading:xe}=this.state,{value:je,onChange:Ve,item:ke}=this.props,{settings:Oe}=ke;let nt=ge.find(Je=>Je.value===je);return!nt&&je&&(nt={label:`${je}`,value:je}),(0,t.jsx)(T.l6,{isLoading:xe,value:nt,defaultValue:je,allowCustomValue:Oe?.allowCustomValue,isClearable:Oe?.isClearable,onChange:Je=>Ve(Je?.value),options:ge})}}var Fe=e(4708),Te=e(54852);const Le=({value:fe,onChange:ge,item:xe,id:je})=>(0,t.jsx)(Te.S,{stats:fe,onChange:ge,allowMultiple:!!xe.settings?.allowMultiple,defaultStat:xe.settings?.defaultStat,inputId:je});var Ge=e(66992);class Me extends g.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=ge=>{const{value:xe,onChange:je}=this.props,Ve=[...xe];Ve.splice(ge,1),je(Ve)},this.onValueChange=(ge,xe)=>{if("key"in ge&&ge.key!=="Enter")return;const{value:je,onChange:Ve}=this.props,ke=ge.currentTarget.value.trim();if(xe<0){ke&&(ge.currentTarget.value="",Ve([...je,ke])),this.setState({showAdd:!1});return}if(!ke)return this.onRemoveString(xe);const Oe=[...je];Oe[xe]=ke,Ve(Oe)}}render(){const{value:ge,item:xe}=this.props,{showAdd:je}=this.state,Ve=De(x.$.theme2),ke=xe.settings?.placeholder||"Add text";return(0,t.jsxs)("div",{children:[ge.map((Oe,nt)=>(0,t.jsx)(h.p,{className:Ve.textInput,defaultValue:Oe||"",onBlur:Je=>this.onValueChange(Je,nt),onKeyDown:Je=>this.onValueChange(Je,nt),suffix:(0,t.jsx)(U.I,{className:Ve.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(nt)})},`${nt}/${Oe}`)),je?(0,t.jsx)(h.p,{autoFocus:!0,className:Ve.textInput,placeholder:ke,defaultValue:"",onBlur:Oe=>this.onValueChange(Oe,-1),onKeyDown:Oe=>this.onValueChange(Oe,-1),suffix:(0,t.jsx)(U.I,{name:"plus-circle"})}):(0,t.jsx)(l.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:ke})]})}}const De=(0,y.N)(fe=>({textInput:(0,o.css)({marginBottom:"5px","&:hover":{border:`1px solid ${fe.components.input.borderHover}`}}),trashIcon:(0,o.css)({color:fe.colors.text.secondary,cursor:"pointer","&:hover":{color:fe.colors.text.primary}})}));var Ke=e(69942);function Ie({value:fe,onChange:ge,item:xe}){const je=(0,F.of)(Ne);return xe?.settings?.isClearable&&fe!=null?(0,t.jsxs)("div",{className:je.wrapper,children:[(0,t.jsx)("span",{className:je.first,children:(0,t.jsx)(Ke.p,{value:fe,onChange:ge})}),(0,t.jsx)(C.K,{name:"times",onClick:()=>ge(void 0),tooltip:"Clear unit selection"})]}):(0,t.jsx)(Ke.p,{value:fe,onChange:ge})}const Ne=fe=>({wrapper:(0,o.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,o.css)({marginRight:fe.spacing(1),flexGrow:2})}),ie=()=>{const fe={id:"number",name:"Number",description:"Allows numeric values input",editor:we.w},ge={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Fe.G},xe={id:"text",name:"Text",description:"Allows string values input",editor:Ge.g},je={id:"strings",name:"String array",description:"An array of strings",editor:Me},Ve={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(Gt){const{id:un,...vn}=Gt;return(0,t.jsx)(s.d,{...vn,onChange:pn=>Gt.onChange(pn.currentTarget.checked)})}},ke={id:"select",name:"Select",description:"Allows option selection",editor:$e},Oe={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Qe},nt={id:"radio",name:"Radio",description:"Allows option selection",editor(Gt){return(0,t.jsx)(c.z,{...Gt,options:Gt.item.settings?.options})}},Je={id:"unit",name:"Unit",description:"Allows unit input",editor:Ie},Be={id:"color",name:"Color",description:"Allows color selection",editor(Gt){return(0,t.jsx)(he.a,{value:Gt.value,onChange:Gt.onChange,settings:Gt.item.settings,details:!0})}},Ze={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:Pe},tt={id:"links",name:"Links",description:"Allows defining data links",editor:Xe},Re={id:"actions",name:"Actions",description:"Allows defining actions",editor:le},at={id:"stats-picker",name:"Stats Picker",editor:Le,description:""},yt={id:"timezone",name:"Time zone",description:"Time zone selection",editor:d.U},ze={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:u.O};return[xe,fe,ge,Ve,nt,ke,Je,tt,Re,at,je,yt,Ze,Be,Oe,ze,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:re},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:Z},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:L}]},ve=()=>{const fe=["Standard options"],ge={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:r.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:fe},xe={id:"unit",path:"unit",name:"Unit",description:"",editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:r.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:fe},je={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:r.FM,shouldApply:ze=>ze.type===a.PU.number,showIf:ze=>ze.min===void 0||ze.max===void 0,category:fe},Ve={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:r.m0,settings:{placeholder:"auto"},shouldApply:ze=>ze.type===a.PU.number,category:fe},ke={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:r.m0,settings:{placeholder:"auto"},shouldApply:ze=>ze.type===a.PU.number,category:fe},Oe={id:"decimals",path:"decimals",name:"Decimals",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:r.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:ze=>ze.type===a.PU.number,category:fe},nt={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:r.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:fe},Je=x.$.featureToggles.vizActions?"Data links and actions":"Data links",Be={id:"links",path:"links",name:"Data links",editor:n.D.get("links").editor,override:n.D.get("links").editor,process:r.Ch,settings:{showOneClick:!1},shouldApply:()=>!0,category:[Je],getItemsCount:ze=>ze?ze.length:0},Ze={id:"actions",path:"actions",name:"Actions",editor:n.D.get("actions").editor,override:n.D.get("actions").editor,process:r.cz,settings:{showOneClick:!1},shouldApply:()=>!0,category:[Je],getItemsCount:ze=>ze?ze.length:0,showIf:()=>x.$.featureToggles.vizActions,hideFromDefaults:!0},tt={id:"color",path:"color",name:"Color scheme",editor:n.D.get("fieldColor").editor,override:n.D.get("fieldColor").editor,process:r.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:fe},Re={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:n.D.get("mappings").editor,override:n.D.get("mappings").editor,process:r.xT,settings:{},defaultValue:[],shouldApply:ze=>ze.type!==a.PU.time,category:["Value mappings"],getItemsCount:ze=>ze?ze.length:0},at={id:"thresholds",path:"thresholds",name:"Thresholds",editor:n.D.get("thresholds").editor,override:n.D.get("thresholds").editor,process:r.N7,settings:{},defaultValue:{mode:i.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:ze=>ze?ze.steps.length:0},yt={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:r.FM,shouldApply:()=>!0,settings:{},category:fe};return[xe,Ve,ke,je,Oe,ge,tt,nt,Be,Ze,Re,at,yt]}},4708:(q,j,e)=>{"use strict";e.d(j,{G:()=>d});var t=e(74848),n=e(22803),r=e(17437),a=e(55168),i=e(96540),x=e(29675),s=e(19331),c=e(30602);const d=({value:o,onChange:E,item:m})=>{const f=(0,i.useRef)(null),{settings:p}=m,h=p?.min||0,D=p?.max||100,C=p?.step,l=p?.marks||{[h]:h,[D]:D},v=p?.included,y=p?.ariaLabelForHandle,P=75,b=!0,S=(0,x.$j)(),[M,O]=(0,i.useState)(o??h),[R,L]=(0,i.useState)(P);(0,i.useEffect)(()=>{o!=null&&o!==M&&O(o)},[o,M]),(0,i.useEffect)(()=>{const A=getComputedStyle(f.current),N=A.getPropertyValue("font-weight")||"normal",K=A.getPropertyValue("font-size")||"16px",V=A.getPropertyValue("font-family")||"Arial",T="0",z=4,w=8,H=Math.max((D+(C||0)).toString().length,(D-(C||0)).toString().length)+z,G=T.repeat(H),X=u(G,`${N} ${K} ${V}`);X&&L(X+w*2)},[D,C]);const B=(0,i.useCallback)(A=>{const N=typeof A=="number"?A:A[0];O(N),E&&E(N)},[O,E]),F=(0,i.useCallback)(A=>{let N=A;(Number.isNaN(N)||!N)&&(N=0),O(N),E&&E(N)},[E]),I=(0,s.$)(S,b,!!l),U=g(S,R),W=b?[]:[I.sliderInputVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(I.container,I.slider),children:[(0,t.jsx)(r.Global,{styles:I.slider}),(0,t.jsxs)("div",{className:(0,n.cx)(I.sliderInput,...W),children:[(0,t.jsx)(a.A,{min:h,max:D,step:C,defaultValue:o,value:M,onChange:B,vertical:!b,reverse:!1,ariaLabelForHandle:y,marks:l,included:v}),(0,t.jsx)("span",{className:U.numberInputWrapper,ref:f,children:(0,t.jsx)(c.Q,{value:M,onChange:F,max:D,min:h,step:C})})]})]})};function u(o,E){const f=document.createElement("canvas").getContext("2d");return f?(f.font=E,f.measureText(o).width):null}const g=(o,E)=>({numberInputWrapper:(0,n.css)({marginLeft:o.spacing(3),maxHeight:"32px",maxWidth:E,minWidth:E,overflow:"visible",width:"100%"})})},66992:(q,j,e)=>{"use strict";e.d(j,{g:()=>i});var t=e(74848),n=e(96540),r=e(50926),a=e(34128);const i=({value:x,onChange:s,item:c,suffix:d})=>{const u=c.settings?.useTextarea?r.f:a.p,g=(0,n.useCallback)(o=>{let E=x??"";"key"in o?o.key==="Enter"&&!c.settings?.useTextarea&&(E=o.currentTarget.value.trim()):E=o.currentTarget.value.trim(),E!==x&&s(E===""?void 0:E)},[x,c.settings?.useTextarea,s]);return(0,t.jsx)(u,{placeholder:c.settings?.placeholder,defaultValue:x||"",rows:c.settings?.useTextarea&&c.settings.rows||5,onBlur:g,onKeyDown:g,suffix:d})}},54122:(q,j,e)=>{"use strict";e.d(j,{Y:()=>A});var t=e(74848),n=e(22803),r=e(96540),a=e(80426),i=e(29675),x=e(95382),s=e(94259),c=e(20337);const d=({isLoading:K,children:V,className:T})=>{let z=T?(0,t.jsx)("div",{className:T,children:V}):V;return(0,t.jsx)(t.Fragment,{children:K?(0,t.jsx)(c.A,{}):z})};var u=e(18899),g=e(28082),o=e(45565),E=e(99764),m=e(86489),f=e(34128);const p=({value:K,onEdit:V})=>{const T=(0,i.of)(h),[z,w]=(0,r.useState)(K),[H,G]=(0,r.useState)(!1),[X,k]=(0,r.useState)(!1),[_,ee]=(0,r.useState)();(0,r.useEffect)(()=>{w(K)},[K]);const J=(0,r.useCallback)(async Z=>{const te=Z.currentTarget.value;if(!te)ee("Please enter a title");else if(te===K)ee(void 0),G(!1);else{k(!0);try{await V(te),ee(void 0),G(!1)}catch(ae){(0,g.NF)(ae)?ee(ae.data.message):ae instanceof Error&&ee(ae.message)}k(!1)}},[V,K]);return H?(0,t.jsx)("div",{className:T.inputContainer,children:(0,t.jsx)(m.D,{className:T.field,loading:X,invalid:!!_,error:_,children:(0,t.jsx)(f.p,{className:T.input,defaultValue:z,onKeyDown:Z=>{Z.key==="Enter"&&J(Z)},autoFocus:!0,onBlur:J,onChange:Z=>w(Z.currentTarget.value),onFocus:()=>G(!0)})})}):(0,t.jsx)("div",{className:T.textContainer,children:(0,t.jsxs)("div",{className:T.textWrapper,children:[(0,t.jsx)(o.E,{element:"h1",truncate:!0,children:z}),(0,t.jsx)(E.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>G(!0)})]})})};p.displayName="EditableTitle";const h=K=>({textContainer:(0,n.css)({minWidth:0}),field:(0,n.css)({flex:1,left:`calc(-${K.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,n.css)({input:{...K.typography.h1}}),inputContainer:(0,n.css)({display:"flex",flex:1}),textWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:K.spacing(1),height:K.spacing(K.components.height.md)})});function D({navItem:K,renderTitle:V,actions:T,info:z,subTitle:w,onEditTitle:H}){const G=(0,i.of)(C),X=w??K.subTitle,k=H?(0,t.jsx)(p,{value:K.text,onEdit:H}):(0,t.jsxs)("div",{className:G.title,children:[K.img&&(0,t.jsx)("img",{className:G.img,src:K.img,alt:`logo for ${K.text}`}),V?V(K.text):(0,t.jsx)("h1",{children:K.text})]});return(0,t.jsxs)("div",{className:G.pageHeader,children:[(0,t.jsxs)("div",{className:G.topRow,children:[(0,t.jsxs)("div",{className:G.titleInfoContainer,children:[k,z&&(0,t.jsx)(u.Q,{info:z})]}),(0,t.jsx)("div",{className:G.actions,children:T})]}),X&&(0,t.jsx)("div",{className:G.subTitle,children:X})]})}const C=K=>({topRow:(0,n.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:K.spacing(1,3)}),title:(0,n.css)({display:"flex",flexDirection:"row",maxWidth:"100%",flex:1,h1:{marginBottom:0}}),actions:(0,n.css)({display:"flex",flexDirection:"row",gap:K.spacing(1)}),titleInfoContainer:(0,n.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:K.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,n.css)({label:"page-header",display:"flex",flexDirection:"column",gap:K.spacing(1),marginBottom:K.spacing(2)}),subTitle:(0,n.css)({position:"relative",color:K.colors.text.secondary}),img:(0,n.css)({width:"32px",height:"32px",marginRight:K.spacing(2)})});var l=e(10247),v=e(5005),y=e(88849);function P({navItem:K}){const V=(0,i.of)(b);return(0,t.jsx)("div",{className:V.tabsWrapper,children:(0,t.jsx)(l.U,{children:K.children.map((T,z)=>{const w=T.icon?(0,v.Uo)(T.icon):void 0;return!T.hideFromTabs&&(0,t.jsx)(y.o,{label:T.text,active:T.active,icon:w,counter:T.tabCounter,href:T.url,suffix:T.tabSuffix,onChangeTab:T.onClick},`${T.url}-${z}`)})})})}const b=K=>({tabsWrapper:(0,n.css)({paddingBottom:K.spacing(3)})});var S=e(25508),M=e(12636),O=e(83394),R=e(61491);function L(K,V){if(V)return V;if(K&&O.M_)return(0,R.useSelector)((0,S.Mz)(B,T=>(0,M.tc)(T,K??"home")))}function B(K){return K.navIndex}var F=e(76829),I=e(77455),U=e(14910);function W(K,V){const T=(0,R.useSelector)(z=>z.navIndex)?.[F.Id];(0,r.useEffect)(()=>{const z=(K?.node!==K?.main?K?.node:K?.main)??{text:"Grafana"},w=(0,U.Z)(z,V,T).map(H=>H.text).reverse();w[w.length-1]=I.M.AppTitle,document.title=w.join(" - ")},[T,K,V])}const A=({navId:K,navModel:V,pageNav:T,renderTitle:z,onEditTitle:w,actions:H,subTitle:G,children:X,className:k,info:_,layout:ee=a.k.Standard,onSetScrollRef:J,...Z})=>{const te=(0,i.of)(N),ae=L(K,V),{chrome:re}=(0,x.Il)();W(ae,T);const ne=T??ae?.node;return(0,r.useLayoutEffect)(()=>{ae&&re.update({sectionNav:ae,pageNav:T,layout:ee})},[ae,T,re,ee]),(0,t.jsxs)("div",{className:(0,n.cx)(te.wrapper,k),...Z,children:[ee===a.k.Standard&&(0,t.jsx)(s.A,{divId:"page-scrollbar",onSetScrollRef:J,children:(0,t.jsxs)("div",{className:te.pageInner,children:[ne&&(0,t.jsx)(D,{actions:H,onEditTitle:w,navItem:ne,renderTitle:z,info:_,subTitle:G}),T&&T.children&&(0,t.jsx)(P,{navItem:T}),(0,t.jsx)("div",{className:te.pageContent,children:X})]})}),ee===a.k.Canvas&&(0,t.jsx)(s.A,{divId:"page-scrollbar",onSetScrollRef:J,children:(0,t.jsx)("div",{className:te.canvasContent,children:X})}),ee===a.k.Custom&&X]})};A.Contents=d;const N=K=>({wrapper:(0,n.css)({label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",position:"relative"}),pageContent:(0,n.css)({label:"page-content",flexGrow:1}),primaryBg:(0,n.css)({background:K.colors.background.primary}),pageInner:(0,n.css)({label:"page-inner",padding:K.spacing(2),borderBottom:"none",background:K.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:K.spacing(0,0,0,0),[K.breakpoints.up("md")]:{padding:K.spacing(4)}}),canvasContent:(0,n.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:K.spacing(2),flexBasis:"100%",flexGrow:1})})},18899:(q,j,e)=>{"use strict";e.d(j,{Q:()=>i});var t=e(74848),n=e(22803),r=e(96540),a=e(29675);function i({info:s}){const c=(0,a.of)(x);return(0,t.jsx)("div",{className:c.container,children:s.map((d,u)=>(0,t.jsxs)(r.Fragment,{children:[(0,t.jsxs)("div",{className:c.infoItem,children:[(0,t.jsx)("div",{className:c.label,children:d.label}),d.value]}),u+1<s.length&&(0,t.jsx)("div",{"data-testid":"page-info-separator",className:c.separator})]},u))})}const x=s=>({container:(0,n.css)({display:"flex",flexDirection:"row",gap:s.spacing(1.5),overflow:"auto"}),infoItem:(0,n.css)({...s.typography.bodySmall,display:"flex",flexDirection:"column",gap:s.spacing(.5)}),label:(0,n.css)({color:s.colors.text.secondary}),separator:(0,n.css)({borderLeft:`1px solid ${s.colors.border.weak}`})})},20337:(q,j,e)=>{"use strict";e.d(j,{A:()=>i});var t=e(74848),n=e(90231),r=e(81876);const i=({pageName:x=""})=>{const s=`Loading ${x}...`;return(0,t.jsx)(n.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(r._,{text:s})})}},22961:(q,j,e)=>{"use strict";e.d(j,{L:()=>c});var t=e(74848),n=e(22803),r=e(58779),a=e(29675),i=e(59830),x=e(54731),s=e(11817);function c({entity:u="Page"}){const g=(0,a.of)(d),o=u.toLowerCase();return(0,t.jsx)("div",{className:g.container,"data-testid":r.Tp.components.EntityNotFound.container,children:(0,t.jsx)(i.p,{message:`${u} not found`,variant:"not-found",children:(0,t.jsxs)(s.x6,{i18nKey:"entity-not-found.description",children:["We're looking but can't seem to find this ",{lowerCaseEntity:o},". Try returning"," ",(0,t.jsx)(x.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,t.jsx)(x.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})})}function d(u){return{container:(0,n.css)({padding:u.spacing(8,2,2,2)})}}},57017:(q,j,e)=>{"use strict";e.d(j,{H:()=>i});var t=e(74848),n=e(80426),r=e(54122),a=e(22961);function i(){return(0,t.jsx)(r.Y,{navId:"home",layout:n.k.Canvas,pageNav:{text:"Page not found"},children:(0,t.jsx)(a.L,{entity:"Page"})})}},90935:(q,j,e)=>{"use strict";e.d(j,{$:()=>u});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(54594),x=e(44826),s=e(79784),c=e(11817),d=e(55452);const u=({onChange:o,maxMenuHeight:E})=>{const m=(0,r.useMemo)(d.A4,[]),f=(0,r.useMemo)(()=>m.map(v=>({label:v.name,imgUrl:v.info.logos.small,value:v})).sort((v,y)=>v.label?.localeCompare(y.label)),[m]),[p,h]=(0,r.useState)([]),D=(0,r.useCallback)(v=>{const y=v.filter(P=>P.value).map(P=>P.value);o(y),h(v)},[o]),C=(0,a.of)(g),l={defaultOptions:!0,getOptionLabel:v=>v.label,getOptionValue:v=>v.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:E,options:f,value:p,onChange:D};return(0,t.jsxs)("div",{className:C.container,children:[p.length>0&&(0,t.jsx)(i.$n,{size:"xs",icon:"trash-alt",fill:"text",className:C.clear,onClick:()=>D([]),"aria-label":"Clear types",children:(0,t.jsx)(c.x6,{i18nKey:"panel-type-filter.clear-button",children:"Clear types"})}),(0,t.jsx)(x.KF,{...l,prefix:(0,t.jsx)(s.I,{name:"filter"}),"aria-label":"Panel Type filter"})]})};function g(o){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:o.spacing(1.5),position:"absolute",top:o.spacing(-4.5),right:0})}}},8716:(q,j,e)=>{"use strict";e.d(j,{j:()=>x});var t=e(74848),n=e(22803),r=e(96540),a=e(60997),i=e(29675);const x=r.memo(r.forwardRef(({className:d,children:u,markdown:g,styleOverrides:o,onRemove:E,...m},f)=>{const p=(0,i.of)(h=>c(h,o?.borderTop));return(0,t.jsxs)("div",{className:(0,n.cx)(p.wrapper,d),...m,ref:f,children:[g&&s(g),u]})}));function s(d){const u=(0,a.G)(d);return(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:u}})}x.displayName="OperationRowHelp";const c=(d,u)=>{const g=d.shape.radius.default,o=d.colors.background.secondary;return{wrapper:(0,n.css)({padding:d.spacing(2),border:`2px solid ${o}`,borderTop:u?u+o:"none",borderRadius:`0 0 ${g} ${g}`,position:"relative",top:"-4px"})}}},33833:(q,j,e)=>{"use strict";e.d(j,{A:()=>c,q:()=>s});var t=e(74848),n=e(22803),r=e(58779),a=e(29675),i=e(99764);function x(u){const g=(0,a.of)(d);return(0,t.jsx)("div",{className:(0,n.cx)(g.icon,"active"in u&&u.active&&g.active),children:(0,t.jsx)(i.K,{name:u.icon,tooltip:u.title,className:g.icon,disabled:!!u.disabled,onClick:u.onClick,type:"button","data-testid":u.dataTestId??r.Tp.components.QueryEditorRow.actionButton(u.title),..."active"in u&&{"aria-pressed":u.active}})})}function s(u){return(0,t.jsx)(x,{...u})}const c=u=>(0,t.jsx)(x,{...u}),d=u=>({icon:(0,n.css)({display:"flex",position:"relative",color:u.colors.text.secondary}),active:(0,n.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:u.shape.radius.default,bottom:-8,backgroundImage:u.colors.gradients.brandHorizontal}})})},56180:(q,j,e)=>{"use strict";e.d(j,{u:()=>f});var t=e(74848),n=e(22803),r=e(57095),a=e(96540),i=e(22589),x=e(56276),s=e(29675),c=e(98842),d=e(99764),u=e(48583),g=e(79784),o=e(11817);const E=({actionsElement:h,disabled:D,draggable:C,collapsable:l=!0,dragHandleProps:v,headerElement:y,isContentVisible:P,onRowToggle:b,reportDragMousePosition:S,title:M,id:O,expanderMessages:R})=>{const L=(0,s.of)(m);let B=P?(0,o.t)("query-operation.header.collapse-row","Collapse query row"):(0,o.t)("query-operation.header.expand-row","Expand query row");R!==void 0&&P?B=R.close:R!==void 0&&(B=R?.open);const F=(0,o.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,t.jsxs)("div",{className:L.header,children:[(0,t.jsxs)("div",{className:L.column,children:[l&&(0,t.jsx)(d.K,{name:P?"angle-down":"angle-right",tooltip:B,className:L.collapseIcon,onClick:b,"aria-expanded":P,"aria-controls":O}),M&&(0,t.jsx)("div",{className:L.titleWrapper,onClick:b,"aria-label":"Query operation row title",children:(0,t.jsx)("div",{className:(0,n.cx)(L.title,D&&L.disabled),children:M})}),y]}),(0,t.jsxs)(u.B,{gap:1,alignItems:"center",children:[h,C&&(0,t.jsx)("div",{onMouseMove:S,...v,children:(0,t.jsx)(g.I,{title:F,name:"draggabledots",size:"lg",className:L.dragIcon})})]})]})},m=h=>({header:(0,n.css)({label:"Header",padding:h.spacing(.5,.5),borderRadius:h.shape.radius.default,background:h.colors.background.secondary,minHeight:h.spacing(4),display:"grid",gridTemplateColumns:"minmax(100px, max-content) min-content",alignItems:"center",justifyContent:"space-between",whiteSpace:"nowrap","&:focus":{outline:"none"}}),column:(0,n.css)({label:"Column",display:"flex",alignItems:"center",overflow:"hidden"}),dragIcon:(0,n.css)({cursor:"grab",color:h.colors.text.disabled,margin:h.spacing(0,.5),"&:hover":{color:h.colors.text.primary}}),collapseIcon:(0,n.css)({marginLeft:h.spacing(.5),color:h.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",flexGrow:1,cursor:"pointer",overflow:"hidden",marginRight:h.spacing(.5)}),title:(0,n.css)({fontWeight:h.typography.fontWeightBold,color:h.colors.text.link,marginLeft:h.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),disabled:(0,n.css)({color:h.colors.text.disabled})});E.displayName="QueryOperationRowHeader";function f({children:h,actions:D,title:C,headerElement:l,onClose:v,onOpen:y,isOpen:P,disabled:b,draggable:S,collapsable:M,index:O,id:R,expanderMessages:L}){const[B,F]=(0,a.useState)(P!==void 0?P:!0),I=(0,s.of)(p),U=(0,a.useCallback)(()=>{F(!B)},[B,F]);(0,a.useEffect)(()=>{typeof P=="boolean"&&F(P)},[P]);const W=(0,a.useCallback)(V=>{if(V.defaultPrevented){const T=V.currentTarget.getBoundingClientRect(),z=V.clientX-T.left,w=V.clientY-T.top;(0,x.rR)("query_row_reorder_drag_position",{x:z/T.width,y:w/T.height,width:T.width,height:T.height})}},[]);(0,i.A)(()=>{B?y&&y():v&&v()},[B]);const A={isOpen:B,onOpen:()=>{F(!0)},onClose:()=>{F(!1)}},N=D&&c.renderOrCallToRender(D,A),K=l&&c.renderOrCallToRender(l,A);return S?(0,t.jsx)(r.Draggable,{draggableId:R,index:O,children:V=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:V.innerRef,className:I.wrapper,...V.draggableProps,children:[(0,t.jsx)("div",{children:(0,t.jsx)(E,{id:R,actionsElement:N,disabled:b,draggable:!0,collapsable:M,dragHandleProps:V.dragHandleProps,headerElement:K,isContentVisible:B,onRowToggle:U,reportDragMousePosition:W,title:C,expanderMessages:L})}),B&&(0,t.jsx)("div",{className:I.content,children:h})]})})}):(0,t.jsxs)("div",{className:I.wrapper,children:[(0,t.jsx)(E,{id:R,actionsElement:N,disabled:b,draggable:!1,collapsable:M,headerElement:K,isContentVisible:B,onRowToggle:U,reportDragMousePosition:W,title:C,expanderMessages:L}),B&&(0,t.jsx)("div",{className:I.content,children:h})]})}const p=h=>({wrapper:(0,n.css)({marginBottom:h.spacing(2)}),content:(0,n.css)({marginTop:h.spacing(.5),marginLeft:h.spacing(3)})});f.displayName="QueryOperationRow"},24085:(q,j,e)=>{"use strict";e.d(j,{y:()=>u});var t=e(74848),n=e(13686),r=e(84099),a=e(24726);const i=2,x=5,s=m=>{const f=m.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return f?f[0]:null},c=m=>m.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[i],d=m=>{let f=c(m);if(!f){f=`x${(0,a.A)()}`;const h=m.indexOf("<svg")+x;m=m.substring(0,h)+`id="${f}" `+m.substring(h)}let p=s(m);if(p){let h=p.replace(/(#(.*?))?\./g,`#${f} .`);m=m.replace(p,h)}return m},u=m=>{const{cleanStyle:f,...p}=m;return(0,t.jsx)(n.default,{...p,cacheRequests:!0,preProcessor:f?E:o})};let g=new Map;function o(m){let f=g.get(m);return f||(f=r.sQ.sanitizeSVGContent(m),g.set(m,f)),f}function E(m){let f=g.get(m);return f||(f=r.sQ.sanitizeSVGContent(m),f.indexOf('<style type="text/css">')>-1&&(f=d(f)),g.set(m,f)),f}},93403:(q,j,e)=>{"use strict";e.d(j,{b:()=>E});var t=e(74848),n=e(76459),r=e.n(n),a=e(96540),i=e(32370),x=e(44826),s=e(75911),c=e(20708),d=e(15543);const u=(m="Dashboards",f)=>`${m}/${f}`;async function g(m=""){return s.IB.search({type:"dash-db",query:m,limit:100}).then(f=>f.map(p=>({value:{uid:p.uid,title:p.title,folderTitle:p.folderTitle,folderUid:p.folderUid},label:u(p?.folderTitle,p.title)})))}const o=r()(g,250,{leading:!0}),E=({value:m,onChange:f,placeholder:p="Select dashboard",noOptionsMessage:h="No dashboards found",...D})=>{const[C,l]=(0,a.useState)();(0,a.useEffect)(()=>{!m||m===C?.value?.uid||(async()=>{if(i.$.featureToggles.useV2DashboardsAPI){const P=await(0,d.n)("v2").getDashboardDTO(m,void 0);l({value:{uid:P.metadata.name,title:P.spec.title,folderTitle:P.metadata.annotations?.[c.w2],folderUid:P.metadata.annotations?.[c.ew]},label:u(P.metadata.annotations?.[c.ew],P.spec.title)})}else{const P=await(0,d.n)().getDashboardDTO(m,void 0);P.dashboard&&l({value:{uid:P.dashboard.uid,title:P.dashboard.title,folderTitle:P.meta.folderTitle,folderUid:P.meta.folderUid},label:u(P.meta?.folderTitle,P.dashboard.title)})}})()},[m]);const v=(0,a.useCallback)(y=>{l(y),f?.(y?.value)},[f,l]);return(0,t.jsx)(x.DW,{loadOptions:o,onChange:v,placeholder:p,noOptionsMessage:h,value:C,defaultOptions:!0,...D})}},62851:(q,j,e)=>{"use strict";e.d(j,{d:()=>x});var t=e(74848),n=e(96540),r=e(32370),a=e(98444),i=e(96843);function x(c){const d=r.$.featureToggles.newFolderPicker||r.$.featureToggles.nestedFolders,{initialTitle:u,dashboardId:g,enableCreateNew:o,...E}=c;return d?(0,t.jsx)(a.I,{...E}):(0,t.jsx)(s,{...c})}function s({value:c,showRootFolder:d,onChange:u,initialTitle:g,dashboardId:o,enableCreateNew:E,inputId:m,skipInitialLoad:f}){const p=(0,n.useCallback)(h=>{u&&u(h.uid,h.title)},[u]);return(0,t.jsx)(i.sR,{onChange:p,showRoot:d,initialFolderUid:c,initialTitle:g,inputId:m,skipInitialLoad:f,dashboardId:o,enableCreateNew:E})}},96843:(q,j,e)=>{"use strict";e.d(j,{sR:()=>l});var t=e(74848),n=e(22803),r=e(76459),a=e.n(r),i=e(96540),x=e(16817),s=e(52718),c=e(58779),d=e(56276),u=e(29675),g=e(34128),o=e(44826),E=e(22492),m=e(11817),f=e(61351),p=e(4956),h=e(61491);const D="+ Add new",C="-10";function l(b){const{dashboardId:S,allowEmpty:M,onChange:O,filter:R,enableCreateNew:L,inputId:B,onClear:F,enableReset:I,initialFolderUid:U,initialTitle:W="",permissionLevel:A=h.PermissionLevelString.Edit,rootName:N,showRoot:K=!0,skipInitialLoad:V,searchQueryType:T,customAdd:z,folderWarning:w,invalid:H}=b,G=N??"Dashboards",[X,k]=(0,i.useState)(null),[_,ee]=(0,i.useState)(!1),[J,Z]=(0,i.useState)(""),[te,ae]=(0,i.useState)(X?.title??""),re=(0,u.of)(P),ne=typeof F=="function",ce=(0,i.useCallback)(async Qe=>{const we=await(0,p.c0)(Qe,A,T),Fe=v(we,R);return(0,d.rR)("grafana_folder_picker_results_loaded",{results:Fe.length,searchTermLength:Qe.length,enableCreateNew:!!L}),(f.TP.hasPermission(h.AccessControlAction.DashboardsWrite)||f.TP.hasPermission(h.AccessControlAction.DashboardsCreate))&&G?.toLowerCase().startsWith(Qe.toLowerCase())&&K&&Fe.unshift({label:G,value:""}),I&&Qe===""&&W!==""&&!Fe.find(Le=>Le.label===W)&&Fe.unshift({label:W,value:U}),L&&z?[...Fe,{value:C,label:D,title:Qe}]:Fe},[I,U,W,A,G,K,T,R,L,z]),le=(0,i.useMemo)(()=>a()(ce,300,{leading:!0}),[ce]),he=async()=>{const Qe={label:W,value:void 0},we={label:G,value:""},$e=await ce("");let Fe=null;U!=null?Fe=$e.find(Te=>Te.value===U)||null:I&&W?Fe=Qe:U&&(Fe=$e.find(Te=>Te.id===U)||null),!Fe&&!M&&(f.TP.isEditor?Fe=we:!!S?Fe=Qe:Fe=$e.length>0?$e[0]:Qe),!_&&k(Fe)};(0,i.useEffect)(()=>{X&&X.value!==U&&!_&&X.value&&X.label&&O({uid:X.value,title:X.label})},[X,U]),(0,x.A)(async()=>{if(V){const Qe=await y({getFolder:p.Ql,folderUid:U,folderName:W});k(Qe)}await he()},[V,U,W]),(0,i.useEffect)(()=>{X&&X.id===C&&ee(!0)},[X]);const oe=(0,i.useCallback)((Qe,we)=>{if(Qe?.value===C)k({id:C,title:J}),ae(J);else{if(Qe||(Qe={value:"",label:G}),we.action==="clear"&&F){F();return}k(Qe),O({uid:Qe.value,title:Qe.label})}},[O,F,G,J]),de=(0,i.useCallback)(async Qe=>{if(w?.warningCondition(Qe))return(0,d.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const we=await(0,p.vV)({title:Qe});let $e={value:"",label:"Not created"};return we.uid?((0,d.rR)("grafana_folder_picker_folder_created",{status:"success"}),E.A.emit(s.r1.alertSuccess,["Folder Created","OK"]),$e={value:we.uid,label:we.title},k(we),oe($e,{action:"create-option",option:$e})):((0,d.rR)("grafana_folder_picker_folder_created",{status:"failed"}),E.A.emit(s.r1.alertError,["Folder could not be created"])),$e},[w,oe]),me=(0,i.useCallback)(Qe=>{const we=!!z?.disallowValues;if(Qe.key==="Enter"&&we&&!z?.isAllowedValue(te)){Qe.preventDefault();return}switch(Qe.key){case"Enter":{de(X?.title),ee(!1);break}case"Escape":k({value:"",label:G}),ee(!1)}},[z?.disallowValues,z?.isAllowedValue,te,de,X?.title,G]),Pe=Qe=>{const we=Qe.currentTarget.value;ae(we),k({id:void 0,title:we})},Ee=()=>{k({value:"",label:G}),ee(!1)},be=(Qe,{action:we})=>{we==="input-change"&&Z($e=>Qe),we==="menu-close"&&Z($e=>Qe)},Se=()=>w?.warningCondition(te)?(0,t.jsx)(w.warningComponent,{}):null,Xe=()=>w?.warningCondition(J)?(0,t.jsx)(w.warningComponent,{}):null;return _?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Se,{}),(0,t.jsx)("div",{className:re.newFolder,children:(0,t.jsx)(m.x6,{i18nKey:"folder-picker.create-instructions",children:"Press enter to create the new folder."})}),(0,t.jsx)(g.p,{width:30,autoFocus:!0,value:te,onChange:Pe,onKeyDown:me,placeholder:"Press enter to confirm new folder.",onBlur:Ee})]}):(0,t.jsxs)("div",{"data-testid":c.Tp.components.FolderPicker.containerV2,children:[(0,t.jsx)(Xe,{}),(0,t.jsx)(o.gZ,{inputId:B,"data-testid":c.Tp.components.FolderPicker.input,loadingMessage:(0,m.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:X,inputValue:J,onInputChange:be,value:X,allowCustomValue:L&&!z,loadOptions:le,onChange:oe,onCreateOption:de,invalid:H,isClearable:ne})]})}function v(b,S){return(S?S(b):b).map(O=>({label:O.title,value:O.uid}))}async function y({folderName:b,folderUid:S,getFolder:M}){if(S==null)throw new Error("folderUid is not found.");return b?{label:b,value:S}:{label:(await M(S)).title,value:S}}const P=b=>({newFolder:(0,n.css)({color:b.colors.warning.main,fontSize:b.typography.bodySmall.fontSize,paddingBottom:b.spacing(1)})})},89963:(q,j,e)=>{"use strict";e.d(j,{r:()=>c});var t=e(74848),n=e(16817),r=e(44826),a=e(79784),i=e(93719),x=e(92914);const s=()=>(0,x.S)().getSortOptions();function c({onChange:d,value:u,placeholder:g,filter:o,getSortOptions:E,isClearable:m}){const f=(0,n.A)(async()=>{const h=await(E??s)();return o?h.filter(D=>o.includes(D.value)):h},[E,o]);if(f.loading)return null;const p=!!(u?.includes("desc")||u?.startsWith("-"));return(0,t.jsx)(r.l6,{width:28,onChange:d,value:f.value?.find(h=>h.value===u)??null,options:f.value,"aria-label":"Sort",placeholder:g??`Sort (Default ${i.r4.label})`,prefix:(0,t.jsx)(a.I,{name:p?"sort-amount-down":"sort-amount-up"}),isClearable:m},u)}},29272:(q,j,e)=>{"use strict";e.d(j,{$:()=>s,E:()=>x});var t=e(74848),n=e(22803),r=e(27671),a=e(29675),i=e(79784);const x=({count:c,label:d,onClick:u,removeIcon:g})=>{const{color:o}=(0,r.MC)(d),E=(0,a.of)(s),m=c!==0&&(0,t.jsx)("span",{style:{marginLeft:"3px"},children:`(${c})`});return(0,t.jsxs)("span",{className:E.badge,style:{backgroundColor:o},children:[g&&(0,t.jsx)(i.I,{onClick:u,name:"times"}),d," ",m]})},s=c=>({badge:(0,n.css)({...c.typography.bodySmall,backgroundColor:c.v1.palette.gray1,borderRadius:c.shape.radius.default,color:c.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:c.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},96601:(q,j,e)=>{"use strict";e.d(j,{$:()=>m});var t=e(74848),n=e(22803),r=e(96540),a=e(15777),i=e(67793),x=e(29675),s=e(44826),c=e(79784),d=e(11817),u=e(29272);const g=({data:p,className:h,label:D,isFocused:C,innerProps:l})=>{const v=(0,x.of)(o);return(0,t.jsx)("div",{className:(0,n.cx)(v.option,C&&v.optionFocused),"aria-label":"Tag option",...l,children:(0,t.jsx)("div",{className:(0,n.cx)(v.optionInner,h),children:typeof D=="string"?(0,t.jsx)(u.E,{label:D,removeIcon:!1,count:p.count??0}):D})})},o=p=>({option:(0,n.css)({padding:p.spacing(.5),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent",borderRadius:p.shape.radius.default,"&:hover":{background:p.colors.action.hover}}),optionFocused:(0,n.css)({background:p.colors.action.focus,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,n.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),E=(p,h)=>{const D=RegExp((0,i.jD)(h),"i");return!!(p.value&&D.test(p.value))},m=({allowCustomValue:p=!1,formatCreateLabel:h,hideValues:D,inputId:C,isClearable:l,onChange:v,placeholder:y,tagOptions:P,tags:b,width:S})=>{const M=(0,x.of)(f),O=b.map(w=>({value:w,label:w,count:0})),[R,L]=(0,r.useState)(O),[B,F]=(0,r.useState)(!1),[I,U]=(0,r.useState)(b),[W,A]=(0,r.useState)(O),N=(0,r.useMemo)(()=>b.join(),[b]),K=(0,r.useCallback)(async()=>(await P()).map(H=>b.includes(H.term)?{value:H.term,label:H.term,count:0}:{value:H.term,label:H.term,count:H.count}),[P,b]),V=(0,r.useCallback)(async()=>{F(!0);const w=await K();p&&W.forEach(H=>w.push(H)),L(w),F(!1)},[p,W,K]);(0,r.useEffect)(()=>{b.length>0&&R.length===0&&V()},[V,R.length,b.length]),(0,r.useEffect)(()=>{b!==I&&(U(b),V())},[V,I,b]);const T=w=>{w.forEach(H=>H.count=0),v((w||[]).map(H=>H.value)),p&&A(w.filter(H=>!b.includes(H)))},z={onFocus:V,isLoading:B,options:R,allowCreateWhileLoading:!0,allowCustomValue:p,formatCreateLabel:h,defaultOptions:!0,filterOption:E,getOptionLabel:w=>w.label,getOptionValue:w=>w.value,inputId:C,isMulti:!0,onChange:T,loadingMessage:(0,d.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,d.t)("tag-filter.no-tags","No tags found"),placeholder:y||(0,d.t)("tag-filter.placeholder","Filter by tag"),value:O,width:S,components:{Option:g,MultiValueLabel:()=>null,MultiValueRemove(w){const{data:H}=w;return(0,t.jsx)(a.c.MultiValueRemove,{...w,children:(0,t.jsx)(u.E,{label:H.label,removeIcon:!0,count:H.count},H.label)})},MultiValueContainer:D?()=>null:a.c.MultiValueContainer}};return(0,t.jsxs)("div",{className:M.tagFilter,children:[l&&b.length>0&&(0,t.jsx)("button",{className:M.clear,onClick:()=>T([]),children:(0,t.jsx)(d.x6,{i18nKey:"tag-filter.clear-button",children:"Clear tags"})}),(0,t.jsx)(s.KF,{...z,prefix:(0,t.jsx)(c.I,{name:"tag-alt"}),"aria-label":"Tag filter"},N)]})};m.displayName="TagFilter";const f=p=>{const h=(0,u.$)(p);return{tagFilter:(0,n.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${h.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,n.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:p.colors.text.secondary,"&:hover":{color:p.colors.text.primary}})}}},85935:(q,j,e)=>{"use strict";e.d(j,{m:()=>o});var t=e(74848),n=e(2543),r=e.n(n),a=e(52718),i=e(59577),x=e(3202),s=e(78968),c=e(22492),d=e(11817),u=e(23657);const g="grafana.dashboard.timepicker.history",o=D=>(0,t.jsx)(u.b,{storageKey:g,defaultValue:[],children:(C,l)=>{const v=m(C),y=E(v);return(0,t.jsx)(s.$6,{...D,history:y,onChange:P=>{f(P,v,l),D.onChange(P)},onError:P=>c.A.emit(a.r1.alertError,[(0,d.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,d.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:P})])})}});function E(D){return D.map(C=>i.convertRawToRange(C,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function m(D){return D.map(C=>{const l=typeof C.from=="string"?C.from:C.from.toISOString(),v=typeof C.to=="string"?C.to:C.to.toISOString();return{from:l,to:v}})}function f(D,C,l){if(!p(D))return;const v={from:typeof D.raw.from=="string"?D.raw.from:D.raw.from.toISOString(),to:typeof D.raw.to=="string"?D.raw.to:D.raw.to.toISOString()},y=h([v,...C]);l(y)}function p(D){return(0,x.Ar)(D.raw.from)||(0,x.Ar)(D.raw.to)}function h(D){return(0,n.uniqBy)(D,C=>C.from+C.to).slice(0,4)}},74064:(q,j,e)=>{"use strict";e.d(j,{N:()=>g});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(25356),x=e(98349),s=e(45565),c=e(11817),d=e(47715);const u=f=>[{category:(0,c.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,c.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,c.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,c.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,c.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${f} + k`],description:(0,c.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,c.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,c.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,c.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,c.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,c.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,c.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,c.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,c.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,c.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,c.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,c.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${f} + s`],description:(0,c.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,c.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,c.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,c.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,c.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,c.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,c.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,c.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${f} + o`],description:(0,c.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,c.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,c.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,c.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,c.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,c.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,c.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],g=({onDismiss:f})=>{const p=(0,a.of)(m),h=(0,r.useMemo)(()=>(0,d.gn)(),[]),D=(0,r.useMemo)(()=>u(h),[h]);return(0,t.jsx)(i.a,{title:(0,c.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:f,onClickBackdrop:f,children:(0,t.jsx)(x.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(D).map(({category:C,shortcuts:l})=>(0,t.jsx)("section",{children:(0,t.jsxs)("table",{className:p.table,children:[(0,t.jsx)("caption",{children:(0,t.jsx)(s.E,{element:"p",variant:"h5",children:C})}),(0,t.jsx)("thead",{className:"sr-only",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:(0,t.jsx)(c.x6,{i18nKey:"help-modal.column-headers.keys",children:"Keys"})}),(0,t.jsx)("th",{children:(0,t.jsx)(c.x6,{i18nKey:"help-modal.column-headers.description",children:"Description"})})]})}),(0,t.jsx)("tbody",{children:l.map(({keys:v,description:y})=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:p.keys,children:v.map(P=>(0,t.jsx)(o,{children:P},P))}),(0,t.jsx)("td",{children:(0,t.jsx)(s.E,{variant:"bodySmall",element:"p",children:y})})]},v.join()))})]})},C))})})},o=({children:f})=>{const p=(0,a.of)(m),h=(0,r.useMemo)(()=>E(f),[f]),D=(0,t.jsx)("span",{dangerouslySetInnerHTML:{__html:h}});return(0,t.jsx)("kbd",{className:p.shortcutTableKey,children:(0,t.jsx)(s.E,{variant:"code",children:D})})};function E(f){let p,h;if(f.includes("ctrl"))p="ctrl",h="Control";else if(f.includes("esc"))p="esc",h="Escape";else return f;return f.replace(p,`<span class="sr-only">${h}</span><span aria-hidden="true" role="none">${p}</span>`)}function m(f){return{table:(0,n.css)({borderCollapse:"separate",borderSpacing:f.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,n.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,n.css)({display:"inline-block",textAlign:"center",marginRight:f.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${f.colors.border.medium}`,borderRadius:f.shape.radius.default,color:f.colors.text.primary,backgroundColor:f.colors.background.secondary})}}},40828:(q,j,e)=>{"use strict";e.d(j,{FG:()=>o,HG:()=>i,IZ:()=>u,Pz:()=>a,bJ:()=>s,cV:()=>r,cx:()=>c,dU:()=>n,o9:()=>x,sD:()=>t,tH:()=>d,wV:()=>E});const t=30,n=8,r=24,a="v",i="h",x=4,s=250,c=t*3,d="panel-copy",u=2,g=23763571993,o=40,E="VisualizationSelectPane.ListMode"},95382:(q,j,e)=>{"use strict";e.d(j,{Il:()=>i,YE:()=>a,k9:()=>s,ni:()=>x});var t=e(96540),n=e(24120),r=e(53027);const a=(0,t.createContext)(void 0);function i(){const c=(0,t.useContext)(a);if(!c)throw new Error("No GrafanaContext found");return c}function x(){const{chrome:c}=i();return(0,t.useCallback)((d,u)=>{const{pathname:g,search:o}=r.Ny.getLocation();c.setReturnToPrevious({title:d,href:u??g+o})},[c])}function s(){const{chrome:c}=i();return(0,n.A)(c.headerHeightObservable,0)}},17687:(q,j,e)=>{"use strict";e.d(j,{Cf:()=>o,_2:()=>E,gi:()=>u,q8:()=>g,tZ:()=>d});var t=e(96540),n=e(24726),r=e(44608),a=e(61491),i=e(23737);const x={title:"",text:"",severity:a.AppNotificationSeverity.Success,icon:"check"},s={title:"",text:"",severity:a.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},c={title:"",text:"",severity:a.AppNotificationSeverity.Error,icon:"exclamation-triangle"},d=(m,f="",p)=>({...x,title:m,text:f,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),u=(m,f="",p,h)=>({...c,text:(0,r.q6)(f),title:m,id:(0,n.A)(),traceId:p,component:h,timestamp:Date.now(),showing:!0}),g=(m,f="",p)=>({...s,title:m,text:f,traceId:p,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),o=(m,f="",p)=>({severity:a.AppNotificationSeverity.Info,icon:"info-circle",title:m,text:f,id:(0,n.A)(),timestamp:Date.now(),showing:!0});function E(){const m=(0,a.useDispatch)();return(0,t.useMemo)(()=>({success:(f,p="")=>{m((0,i.dx)(d(f,p)))},warning:(f,p="",h)=>{m((0,i.dx)(g(f,p,h)))},error:(f,p="",h)=>{m((0,i.dx)(u(f,p,h)))},info:(f,p="")=>{m((0,i.dx)(o(f,p)))}}),[m])}},3835:(q,j,e)=>{"use strict";e.d(j,{$H:()=>d,Ay:()=>u});var t=e(2543),n=e(82856),r=e(84315),a=e(98437);const i=C=>{const l=(0,a.l)().getInstanceSettings(C.datasourceName);return{id:C.ts.toString(),createdAt:C.ts,datasourceName:C.datasourceName,datasourceUid:l?.uid||"",starred:C.starred,comment:C.comment,queries:C.queries}},x=C=>{if(!(0,a.l)().getInstanceSettings({uid:C.datasourceUid}))throw new Error("Datasource not found.");return{ts:C.createdAt,datasourceName:C.datasourceName,starred:C.starred,comment:C.comment,queries:C.queries}};var s=e(94023);const c="grafana.explore.richHistory",d=1e4;class u{async getRichHistory(l){const v=m().map(i),y=l.starred?v.filter(S=>S.starred===!0):v,P=l.from&&l.to?[l.from,l.to]:void 0,b=(0,s.a_)(y,l.sortOrder,l.datasourceFilters,l.search,P);return{richHistory:b,total:b.length}}async addToRichHistory(l){const v=Date.now(),y={id:v.toString(),createdAt:v,...l},P=x(y),b=o(m()),S=P.queries.map(B=>(0,t.omit)(B,["key","refId"])),M=b.length>0&&b[0].queries.map(B=>(0,t.omit)(B,["key","refId"]));if((0,t.isEqual)(S,M)){const B=new Error("Entry already exists");throw B.name=r.m.DuplicatedEntry,B}const{queriesToKeep:O,limitExceeded:R}=E(b),L=[P,...O];try{n.A.setObject(c,L)}catch(B){if(B instanceof Error&&B.name==="QuotaExceededError")D(r.m.StorageFull,`Saving rich history failed: ${B.message}`);else throw B}return R?{warning:{type:r.C.LimitExceeded,message:`Query history reached the limit of ${d}. Old, not-starred items have been removed.`},richHistoryQuery:y}:{richHistoryQuery:y}}async deleteAll(){n.A.delete(c)}async deleteRichHistory(l){const v=parseInt(l,10),P=n.A.getObject(c,[]).filter(b=>b.ts!==v);n.A.setObject(c,P)}async updateStarred(l,v){return g(l,y=>y.starred=v)}async updateComment(l,v){return g(l,y=>y.comment=v)}async getSettings(){return{activeDatasourcesOnly:n.A.getObject(s.mE.activeDatasourcesOnly)??n.A.getObject(s.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:n.A.getObject(s.mE.retentionPeriod,7),starredTabAsFirstTab:n.A.getBool(s.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:n.A.getObject(s.mE.datasourceFilters,[]).map(v=>v.value)}}async updateSettings(l){n.A.set(s.mE.activeDatasourcesOnly,l.activeDatasourcesOnly),n.A.set(s.mE.retentionPeriod,l.retentionPeriod),n.A.set(s.mE.starredTabAsFirstTab,l.starredTabAsFirstTab),n.A.setObject(s.mE.datasourceFilters,(l.lastUsedDatasourceFilters||[]).map(v=>({value:v})))}}function g(C,l){const v=parseInt(C,10),y=n.A.getObject(c,[]),P=(0,t.find)(y,{ts:v});if(!P)throw new Error("Rich history item not found.");return l(P),n.A.setObject(c,y),i(P)}function o(C){const l=n.A.getObject(s.mE.retentionPeriod,7),v=(0,s.wQ)(l,{isLastTs:!1});return C.filter(y=>y.ts>v||y.starred===!0)||[]}function E(C){let l=!1,v=C.length-1;for(;v>=0&&C.length>=d;)C[v].starred||(C.splice(v,1),l=!0),v--;return{queriesToKeep:C,limitExceeded:l}}function m(){const C=n.A.getObject(c,[]);return f(C)}function f(C){return C.map(v=>{const y=v.queries.map((P,b)=>p(v,P,b));return{...v,queries:y}})}function p(C,l,v){const y="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof l=="object"?l:h(l)?JSON.parse(l):{expr:l,refId:y[v]}}function h(C){try{JSON.parse(C)}catch{return!1}return!0}function D(C,l){const v=new Error(l);throw v.name=C,v}},84315:(q,j,e)=>{"use strict";e.d(j,{C:()=>n,m:()=>t});var t=(r=>(r.StorageFull="StorageFull",r.DuplicatedEntry="DuplicatedEntry",r))(t||{}),n=(r=>(r.LimitExceeded="LimitExceeded",r))(n||{})},94023:(q,j,e)=>{"use strict";e.d(j,{a_:()=>i,mE:()=>g,wQ:()=>x});var t=e(2543),n=e.n(t),r=e(3202),a=e(75748);function i(o,E,m,f,p){const h=c(o,m),D=d(h,f),C=p?s(D,p):D;return u(C,E)}const x=(o,E)=>{let m=E.now;return m||(m=E.tz?(0,r.oZ)(E.tz):(0,r.KQ)()),m.add(-o,"d"),(E.isLastTs?m.endOf("d"):m.startOf("d")).valueOf()};function s(o,E){return o.filter(m=>m.createdAt>E[0]&&m.createdAt<E[1])}function c(o,E){return E.length>0?o.filter(m=>E.includes(m.datasourceName)):o}function d(o,E){return o.filter(m=>m.comment.includes(E)?!0:m.queries.filter(p=>Object.values((0,t.omit)(p,["datasource","key","refId","hide","queryType"])).some(h=>h?.toString().includes(E))).length>0)}const u=(o,E)=>{let m;return E===a.x.Ascending&&(m=(f,p)=>f.createdAt<p.createdAt?-1:f.createdAt>p.createdAt?1:0),E===a.x.Descending&&(m=(f,p)=>f.createdAt<p.createdAt?1:f.createdAt>p.createdAt?-1:0),E===a.x.DatasourceZA&&(m=(f,p)=>f.datasourceName<p.datasourceName?-1:f.datasourceName>p.datasourceName?1:0),E===a.x.DatasourceAZ&&(m=(f,p)=>f.datasourceName<p.datasourceName?1:f.datasourceName>p.datasourceName?-1:0),o.sort(m)},g={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},67548:(q,j,e)=>{"use strict";e.d(j,{tU:()=>p,a:()=>f,gQ:()=>h});var t=e(32370),n=e(87638),r=e(75748),a=e(3835),i=e(75505),x=e(28082),s=e(98437),c=e(33237);const d=D=>{const C=(0,s.l)().getInstanceSettings({uid:D.datasourceUid});return{id:D.uid,createdAt:D.createdAt*1e3,datasourceName:C?.name||"",datasourceUid:D.datasourceUid,starred:D.starred,comment:D.comment,queries:D.queries}},u=D=>({uid:D.id,createdAt:Math.floor(D.createdAt/1e3),datasourceUid:D.datasourceUid,starred:D.starred,comment:D.comment,queries:D.queries});class g{constructor(){this.preferenceService=new c.W("user")}async addToRichHistory(C){const{result:l}=await(0,x.AI)().post("/api/query-history",{dataSourceUid:C.datasourceUid,queries:C.queries});return{richHistoryQuery:d(l)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(C){(0,x.AI)().delete(`/api/query-history/${C}`)}async getRichHistory(C){const l=o(C);let v="query-history-get-all";C.starred&&(v="query-history-get-starred");const P=(await(0,i.s)((0,x.AI)().fetch({method:"GET",url:`/api/query-history?${l}`,requestId:v}))).data,b=(P.result.queryHistory||[]).map(d),S=P.result.totalCount||0;return{richHistory:b,total:S}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(C,l){const v=await(0,x.AI)().patch(`/api/query-history/${C}`,{comment:l});return d(v.result)}updateSettings(C){return this.preferenceService.patch({queryHistory:{homeTab:C.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(C,l){let v;return l?v=await(0,x.AI)().post(`/api/query-history/star/${C}`):v=await(0,x.AI)().delete(`/api/query-history/star/${C}`),d(v.result)}}function o(D){let C=`${D.datasourceFilters.map(l=>{const v=(0,s.l)().getInstanceSettings(l).uid;return`datasourceUid=${encodeURIComponent(v)}`}).join("&")}`;return D.search&&(C=C+`&searchString=${D.search}`),D.sortOrder&&(C=C+`&sort=${D.sortOrder===r.x.Ascending?"time-asc":"time-desc"}`),D.starred||(C=C+`&to=${D.to}`,C=C+`&from=${D.from}`),C=C+"&limit=100",C=C+`&page=${D.page||1}`,D.starred&&(C=C+`&onlyStarred=${D.starred}`),C}const E=new a.Ay,m=new g,f=()=>t.$.queryHistoryEnabled?m:E,p=()=>E,h=()=>t.$.queryHistoryEnabled?{availableFilters:[r.x.Descending,r.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:n.TP.isSignedIn}:{availableFilters:[r.x.Descending,r.x.Ascending,r.x.DatasourceAZ,r.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},7435:(q,j,e)=>{"use strict";e.d(j,{u:()=>n});var t=e(96540);function n(r,a){const[i,x]=(0,t.useState)();return(0,t.useEffect)(()=>{const s=r.subscribe(a,x);return()=>s.unsubscribe()},[r,a]),i}},59041:(q,j,e)=>{"use strict";e.d(j,{Y:()=>n});var t=e(96540);function n({breakpoint:r,onChange:a}){(0,t.useEffect)(()=>{const i=window.matchMedia(`(min-width: ${r}px)`),x=s=>a(s);return i.addEventListener("change",x),()=>i.removeEventListener("change",x)},[r,a])}},10011:(q,j,e)=>{"use strict";e.d(j,{C:()=>r});var t=e(61491),n=e(12636);const r=a=>{const i=(0,t.useSelector)(x=>x.navIndex);return(0,n.tc)(i,a)}},65539:(q,j,e)=>{"use strict";e.d(j,{s:()=>a});var t=e(96540),n=e(54148),r=e(53027);function a(){const{search:i}=(0,n.zy)(),x=(0,t.useMemo)(()=>(0,r.SE)(i||""),[i]),s=(0,t.useCallback)((c,d)=>r.Ny.partial(c,d),[]);return[x,s]}},1783:(q,j,e)=>{"use strict";e.d(j,{Nm:()=>u,Yj:()=>g,dK:()=>E,rd:()=>o,wi:()=>d});var t=e(2543),n=e.n(t);const r="en-US",a="fr-FR",i="es-ES",x="de-DE",s="pt-BR",c="zh-Hans",d="pseudo",u=r,g=[{code:r,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:a,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:i,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:x,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:c,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:s,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const m=e(55905);if(m.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:f,ENTERPRISE_I18N_NAMESPACE:p}=m("app/extensions/locales/localeExtensions");for(const h of g){const D=f[h.code];D&&(h.loader[p]=D)}}}const o=g.map(m=>m.code),E=(0,t.uniq)(g.flatMap(m=>Object.keys(m.loader)))},13171:(q,j,e)=>{"use strict";e.d(j,{Y:()=>u,a:()=>g});var t=e(5086),n=e(32017),r=e.n(n),a=e(47078),i=e.n(a),x=e(11817);const s=o=>i()(o,{isEqual:r()}),c=s((o,E)=>new Intl.DateTimeFormat(o,E)),d=s((o,E)=>new Intl.DurationFormat(o,E)),u=s((o,E={})=>{if(typeof o=="string")return u(new Date(o),E);const m=(0,x.iL)();return c(m.language,E).format(o)}),g=s((o,E={})=>{const m=(0,x.iL)();return d(m.language,E).format(o)})},11817:(q,j,e)=>{"use strict";e.d(j,{x6:()=>o,iL:()=>m,JL:()=>u,t:()=>E});var t=e(74848),n=e(72635),r=e(94997),a=e(32389),i=e(1783);const x=f=>f.split("-")[0].toLowerCase(),s={type:"backend",init(){},async read(f,p,h){let D=i.Yj.find(v=>v.code===f);if(D||(D=i.Yj.find(v=>x(v.code)===x(f))),!D)return h(new Error(`No message loader available for ${f}`),null);const C=D.loader[p];if(!C)return h(new Error(`No message loader available for ${f} with namespace ${p}`),null);const l=await C();h(null,l)}};let c,d;async function u(f){const p={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:i.rd,fallbackLng:i.Nm,ns:i.dK};if(d=n.default,f==="detect"){d=d.use(r.A);const D={order:["navigator"],caches:[]};p.detection=D}else p.lng=i.rd.includes(f)?f:void 0;return await d.use(s).use(a.r9).init(p),c=n.default.getFixedT(null,i.dK),{language:d.resolvedLanguage}}function g(f){const p=VALID_LANGUAGES.includes(f)?f:void 0;return i18n.changeLanguage(p)}const o=f=>(0,t.jsx)(a.x6,{shouldUnescape:!0,ns:i.dK,...f}),E=(f,p,h)=>(c||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),c=n.default.t),c(f,p,h));function m(){return c?d||n.default:(console.warn("An attempt to internationalize was made before it was initialized. This was probably caused by calling a locale-aware function in the root module scope, instead of in render"),n.default)}},80847:(q,j,e)=>{"use strict";e.d(j,{$K:()=>f,Do:()=>u,XC:()=>o,XR:()=>g,dx:()=>d,fX:()=>C,g5:()=>m,oF:()=>E,qN:()=>D});var t=e(65307),n=e(25508),r=e(61491);const a=25,i="notifications",x=`${i}/lastRead`,s={byId:P(),lastRead:Number.parseInt(window.localStorage.getItem(x)??`${Date.now()}`,10)},c=(0,t.Z0)({name:"appNotifications",initialState:s,reducers:{notifyApp:(S,{payload:M})=>{Object.values(S.byId).some(O=>l(M,O)&&O.showing)||(S.byId[M.id]=M,b(S.byId))},hideAppNotification:(S,{payload:M})=>{M in S.byId&&(S.byId[M].showing=!1,b(S.byId))},clearNotification:(S,{payload:M})=>{delete S.byId[M],b(S.byId)},clearAllNotifications:S=>{S.byId={},b(S.byId)},readAllNotifications:(S,{payload:M})=>{S.lastRead=M}}}),{notifyApp:d,hideAppNotification:u,clearNotification:g,clearAllNotifications:o,readAllNotifications:E}=c.actions,m=c.reducer,f=S=>S.lastRead,p=S=>S.byId,h=(0,n.Mz)(p,S=>Object.values(S).sort((M,O)=>O.timestamp-M.timestamp)),D=(0,n.Mz)(h,S=>S.filter(v)),C=(0,n.Mz)(p,S=>Object.values(S).filter(M=>M.showing));function l(S,M){return S.icon===M.icon&&S.severity===M.severity&&S.text===M.text&&S.title===M.title}function v(S){return S.severity===r.AppNotificationSeverity.Warning||S.severity===r.AppNotificationSeverity.Error}function y(S){return typeof S=="object"&&S!==null&&"id"in S&&"icon"in S&&"title"in S&&"text"in S}function P(){const S=window.localStorage.getItem(i);if(!S)return{};const M=JSON.parse(S);return Object.values(M).every(O=>y(O))?M:{}}function b(S){const M=Object.values(S).filter(v).sort((O,R)=>R.timestamp-O.timestamp).slice(0,a).reduce((O,R)=>(O[R.id]={id:R.id,severity:R.severity,icon:R.icon,title:R.title,text:R.text,traceId:R.traceId,timestamp:R.timestamp,showing:!1},O),{});try{window.localStorage.setItem(i,JSON.stringify(M))}catch(O){console.error("Unable to persist notifications to local storage"),console.error(O)}}},19606:(q,j,e)=>{"use strict";e.d(j,{I_:()=>o,L1:()=>x,TU:()=>u,ci:()=>c,fc:()=>d,ve:()=>g});var t=e(65307),n=e(32370),r=e(23375);const a=n.$.bootData?.navTree??[];function i(E){return E.map(m=>{const f=m.children&&i(m.children);return{...m,children:f,text:(0,r.C)(m.id)??m.text,subTitle:(0,r.o)(m.id)??m.subTitle,emptyMessage:(0,r.C)(m.emptyMessageId)}})}const x="starred/",s=(0,t.Z0)({name:"navBarTree",initialState:()=>i(n.$.bootData?.navTree??[]),reducers:{setStarred:(E,m)=>{const f=E.find(l=>l.id==="starred"),{id:p,title:h,url:D,isStarred:C}=m.payload;if(f)if(C){f.children||(f.children=[]);const l={id:x+p,text:h,url:D};f.children.push(l),f.children.sort((v,y)=>v.text.localeCompare(y.text))}else{const l=f.children?.findIndex(v=>v.id===x+p)??-1;l>-1&&f?.children?.splice(l,1)}},setBookmark:(E,m)=>{if(!n.$.featureToggles.pinNavItems)return;const f=E.find(D=>D.id==="bookmarks"),{item:p,isSaved:h}=m.payload;if(f)if(h){f.children||=[];const D={...p,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:f.id,text:f.text}};f.children.push(D)}else f.children=f.children?.filter(D=>D.url!==p.url)??[]},updateDashboardName:(E,m)=>{const{id:f,title:p,url:h}=m.payload,D=E.find(C=>C.id==="starred");if(D){const C=D.children?.find(l=>l.id===f);C&&(C.text=p,C.url=h,D.children?.sort((l,v)=>l.text.localeCompare(v.text)))}},removePluginFromNavTree:(E,m)=>{const f="plugin-page-"+m.payload.pluginID,p=E.findIndex(h=>h.id===f);p>-1&&E.splice(p,1)}}}),{setStarred:c,removePluginFromNavTree:d,updateDashboardName:u,setBookmark:g}=s.actions,o=s.reducer},76829:(q,j,e)=>{"use strict";e.d(j,{Id:()=>x,Im:()=>E,Vz:()=>g,YA:()=>o,_h:()=>f,s2:()=>s});var t=e(65307),n=e(2543),r=e.n(n),a=e(88023),i=e(23375);const x="home";function s(){const p={},h=(0,n.cloneDeep)(a.Ay.bootData.navTree),D=h.find(l=>l.id===x),C=h.filter(l=>l.id!==x);return D&&c(p,[D]),c(p,C,p[x]),p}function c(p,h,D){const C=[];for(const l of h){const v={...l,text:(0,i.C)(l.id)??l.text,subTitle:(0,i.o)(l.id)??l.subTitle,emptyMessage:(0,i.C)(l.emptyMessageId),parentItem:D};v.id&&(p[v.id]=v),v.children&&c(p,v.children,v),C.push(v)}D&&(D.children=C),p["not-found"]={...d("Page not found","404 Error").node},p.error={...d("Page error","An unexpected error").node}}function d(p,h){const D={text:p,subTitle:h,icon:"exclamation-triangle"};return{node:D,main:D}}const u={},g=(0,t.VP)("navIndex/updateNavIndex"),o=(0,t.VP)("navIndex/updateConfigurationSubtitle"),E=(0,t.VP)("navIndex/removeNavIndex"),m=(p,h)=>({...p,parentItem:{...p.parentItem,text:p.parentItem?.text??"",subTitle:h}}),f=(p=u,h)=>{if(g.match(h)){let C=function(y){if(y.children)for(const P of y.children)l[P.id]={...P,parentItem:y};y.parentItem&&C(y.parentItem)};var D=C;const l={},v=h.payload;return C(v),{...p,...l}}else if(o.match(h)){const C=`Organization: ${h.payload}`;return{...p,cfg:{...p.cfg,subTitle:C},datasources:m(p.datasources,C),correlations:m(p.correlations,C),users:m(p.users,C),teams:m(p.teams,C),plugins:m(p.plugins,C),"org-settings":m(p["org-settings"],C),apikeys:m(p.apikeys,C)}}else E.match(h)&&delete p[h.payload];return p}},12636:(q,j,e)=>{"use strict";e.d(j,{rH:()=>x,tc:()=>i});var t=e(41811),n=e(64199),r=e(76829);const a=()=>{const d={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:d,main:d}},i=(0,t.default)((d,u,g,o=!1)=>{if(d[u]){const E=d[u],m=o?E:x(E),f=s(m,u);return{node:E,main:f}}return g||a()});function x(d){return d.id===n.Rj?d:d.parentItem&&d.parentItem.id!==r.Id?x(d.parentItem):d}function s(d,u){return d.id===u?{...d,active:!0}:d.children&&d.children.length>0?{...d,children:d.children.map(g=>s(g,u))}:d}const c=d=>`${d.main.text}${d.node.text?": "+d.node.text:""}`},33237:(q,j,e)=>{"use strict";e.d(j,{W:()=>n});var t=e(75911);class n{constructor(a){this.resourceUri=a}update(a){return t.IB.put(`/api/${this.resourceUri}/preferences`,a)}patch(a){return t.IB.patch(`/api/${this.resourceUri}/preferences`,a)}load(){return t.IB.get(`/api/${this.resourceUri}/preferences`)}}},5761:(q,j,e)=>{"use strict";e.d(j,{Q:()=>a});var t=e(96540),n=e(13752),r=e(34798);class a{constructor(s){this._subject=new n.B,this._state=s}useState(){return i(this)}get state(){return this._state}setState(s){this._state={...this._state,...s},this._subject.next(this._state)}subscribeToState(s){return this._subject.subscribe(s)}}function i(x){const s=(0,r.C)();return(0,t.useEffect)(()=>{const c=x.subscribeToState({next:s});return()=>c.unsubscribe()},[x,s]),x.state}},75911:(q,j,e)=>{"use strict";e.d(j,{Mf:()=>Qe,IB:()=>we,AI:()=>$e});var t=e(56568),n=e(13752),r=e(75505),a=e(88483),i=e(64423),x=e(13288),s=e(65474),c=e(20039),d=e(81160),u=e(69862),g=e(59099),o=e(37748),E=e(66847),m=e(67791),f=e(16126),p=e(41560),h=e(69850),D=e(1005),C=e(24726),l=e(52718),v=e(29997),y=e(33262),P=e(32370),b=e(22492),S=e(88023),M=e(84589),O=e(8845),R=e(15543),L=e(74848),B=e(22803),F=e(29675),I=e(75606),U=e(85836),W=e(54594),A=e(15506);const N=Fe=>{const Te=(0,F.of)(K),Le=(0,F.$j)(),Ge=(0,A.o)(Le),Me=!!Fe.maxConcurrentSessions,De=()=>{window.location.reload()};return(0,L.jsxs)(I.ZL,{children:[(0,L.jsx)("div",{className:Ge.modal,children:(0,L.jsxs)(U.w,{title:"You have been automatically signed out",severity:"warning",className:Te.infobox,children:[(0,L.jsxs)("div",{className:Te.text,children:[(0,L.jsxs)("p",{children:["Your session token was automatically revoked because you have reached",(0,L.jsx)("strong",{children:` the maximum number of ${Me?Fe.maxConcurrentSessions:""} concurrent sessions `}),"for your account."]}),(0,L.jsxs)("p",{children:[(0,L.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})]}),(0,L.jsx)(W.$n,{size:"md",variant:"primary",onClick:De,children:"Sign in"})]})}),(0,L.jsx)("div",{className:(0,B.cx)(Ge.modalBackdrop,Te.backdrop)})]})},K=Fe=>({infobox:(0,B.css)({marginBottom:0}),text:(0,B.css)({margin:Fe.spacing(1,0,2)}),backdrop:(0,B.css)({backgroundColor:Fe.colors.background.canvas,opacity:.8})});var V=e(91830),T=e(2543);const z=Fe=>{const Te=Fe.method,Le=Z(Fe),Ge=te(Le),Me=ae(Fe,Ge),De=le(Fe);return{method:Te,headers:Le,body:Me,credentials:De,signal:Fe.abortSignal}},w={canParse:()=>!0,parse:Fe=>(Fe.get("accept")||Fe.set("accept","application/json, text/plain, */*"),Fe)},H=Fe=>({canParse:Te=>(Te?.method?Te?.method.toLowerCase():"")===Fe,parse:Te=>(Te.get("content-type")||Te.set("content-type","application/json"),Te)}),G=H("post"),X=H("put"),k=H("patch"),_=[G,X,k,w],ee=/[^\u0000-\u00ff]/g;function J(Fe){return ee.test(Fe)?encodeURI(Fe):Fe}const Z=Fe=>{const Te={};for(let[De,Ke]of Object.entries(Fe.headers??{}))Te[J(De)]=J(Ke);const Le=new Headers(Te);return _.filter(De=>De.canParse(Fe)).reduce((De,Ke)=>Ke.parse(De),Le)},te=Fe=>{if(!Fe)return!1;const Te=Fe.get("content-type");return!!(Te&&(Te.toLowerCase()==="application/json"||Te.toLowerCase()==="application/merge-patch+json"))},ae=(Fe,Te)=>Fe&&(!Fe.data||typeof Fe.data=="string"||Fe.data instanceof Blob?Fe.data:Te?JSON.stringify(Fe.data):new URLSearchParams(Fe.data));async function re(Fe,Te){if(Te)switch(Te){case"arraybuffer":return Fe.arrayBuffer();case"blob":return Fe.blob();case"json":return Fe.headers.get("Content-Length")==="0"?(console.warn(`${Fe.url} returned an invalid JSON`),{}):await Fe.json();case"text":return Fe.text()}const Le=await Fe.text();try{return JSON.parse(Le)}catch{}return Le}function ne(Fe){return Object.keys(Fe).map(Te=>{const Le=Fe[Te];return Array.isArray(Le)?Le.map(Ge=>`${encodeURIComponent(Te)}=${encodeURIComponent(Ge)}`).join("&"):`${encodeURIComponent(Te)}=${encodeURIComponent(Le)}`}).join("&")}const ce=Fe=>{const Te=(0,T.omitBy)(Fe.params,Ge=>Ge===void 0||Ge&&Ge.length===0),Le=ne(Te);return Fe.params&&Le.length?`${Fe.url}?${Le}`:Fe.url},le=Fe=>Fe&&(Fe.credentials?Fe.credentials:Fe.withCredentials?((0,y.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var he=e(27315),oe=(Fe=>(Fe[Fe.Pending=0]="Pending",Fe[Fe.InProgress=1]="InProgress",Fe[Fe.Done=2]="Done",Fe))(oe||{});class de{constructor(Te=!1){this.state={},this.queue=new n.B,this.updates=new n.B,this.add=(Le,Ge)=>this.queue.next({id:Le,options:Ge,state:0}),this.setInProgress=Le=>this.queue.next({id:Le,state:1}),this.setDone=Le=>this.queue.next({id:Le,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=Le=>{const Ge=Object.keys(Le).filter(De=>Le[De].state===1).length;return{noOfPending:Object.keys(Le).filter(De=>Le[De].state===0).length,noOfInProgress:Ge,state:Le}},this.publishUpdate=(Le,Ge)=>{this.printState(Le,Ge),this.updates.next(Le)},this.printState=(Le,Ge)=>{if(!Ge)return;const Me=Object.keys(Le.state).reduce((De,Ke)=>{const Ie={id:Ke,state:Le.state[Ke].state};return De.push(Ie),De},[]);console.log("FetchQueue noOfStarted",Le.noOfInProgress),console.log("FetchQueue noOfNotStarted",Le.noOfPending),console.log("FetchQueue state",Me)},this.queue.subscribe(Le=>{const{id:Ge,state:Me,options:De}=Le;if(this.state[Ge]||(this.state[Ge]={state:0,options:{url:""}}),Me===2){delete this.state[Ge];const Ie=this.getUpdate(this.state);this.publishUpdate(Ie,Te);return}this.state[Ge].state=Me,De&&(this.state[Ge].options=De);const Ke=this.getUpdate(this.state);this.publishUpdate(Ke,Te)})}}var me=e(95864);class Pe{constructor(Te,Le,Ge){const Me=Ge?.http2Enabled?1e3:5;Te.getUpdates().pipe((0,f.p)(({noOfPending:De})=>De>0),(0,me.H)(({state:De,noOfInProgress:Ke})=>{const Ie=Object.keys(De).filter(fe=>De[fe].state===oe.Pending&&!(0,he.dr)(De[fe].options.url)).reduce((fe,ge)=>{const xe={id:ge,options:De[ge].options};return fe.push(xe),fe},[]),Ne=Object.keys(De).filter(fe=>De[fe].state===oe.Pending&&(0,he.dr)(De[fe].options.url)).reduce((fe,ge)=>{const xe={id:ge,options:De[ge].options};return fe.push(xe),fe},[]),ie=Math.max(Me-Ke-Ie.length,0),ve=Ne.slice(0,ie);return Ie.concat(ve)})).subscribe(({id:De,options:Ke})=>{Le.add(De,Ke)})}}class Ee{constructor(Te,Le){this.queue=new n.B,this.responses=new n.B,this.add=(Ge,Me)=>{this.queue.next({id:Ge,options:Me})},this.getResponses=Ge=>this.responses.asObservable().pipe((0,f.p)(Me=>Me.id===Ge)),this.queue.subscribe(Ge=>{const{id:Me,options:De}=Ge;Te.setInProgress(Me),this.responses.next({id:Me,observable:Le(De)})})}}var be=e(61351);const Se="cancel_all_requests_request_id",Xe="grafana-trace-id";class Qe{constructor(Te){this.inFlightRequests=new n.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new n.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:c.$,appEvents:b.A,contextSrv:be.TP,logout:()=>{be.TP.setLoggedOut()}},this.chunkRequestId=1,Te&&(this.dependencies={...this.dependencies,...Te}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new de,this.responseQueue=new Ee(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new Pe(this.fetchQueue,this.responseQueue,(0,S.zj)())}async initGrafanaDeviceID(){try{const Le=await(await t.Ay.load()).get();this.deviceID=Le.visitorId}catch(Te){console.error(Te)}}async request(Te){return await(0,r.s)(this.fetch(Te).pipe((0,d.T)(Le=>Le.data)))}fetch(Te){const Le=(0,C.A)(),Ge=this.fetchQueue;return new a.c(Me=>{const De=new i.yU;return De.add(this.responseQueue.getResponses(Le).subscribe(Ke=>{De.add(Ke.observable.subscribe(Me))})),this.fetchQueue.add(Le,Te),function(){Ge.setDone(Le),De.unsubscribe()}})}chunked(Te){const Le=Te.requestId??`chunked-${this.chunkRequestId++}`,Ge=new AbortController,Me=ce(Te),De=z({...Te,requestId:Le,abortSignal:Ge.signal});return new a.c(Ke=>{let Ie=!1;const Ne=this.dependencies.fromFetch(Me,De).subscribe({next:ie=>{const ve={status:ie.status,statusText:ie.statusText,ok:ie.ok,headers:ie.headers,url:ie.url,type:ie.type,redirected:ie.redirected,config:Te,traceId:ie.headers.get(Xe)??void 0,data:void 0};if(!ie.body){Ke.next(ve),Ke.complete();return}const fe=ie.body.getReader();async function ge(){for(;fe&&!Ie;){if(Ge.signal.aborted){fe.cancel(Ge.signal.reason),console.log(Le,"signal.aborted");return}const xe=await fe.read();Ke.next({...ve,data:xe.value}),xe.done&&(Ie=!0,console.log(Le,"done"))}}ge().then(()=>{console.log(Le,"complete"),Ke.complete()}).catch(xe=>{console.log(Le,"catch",xe),Ke.error(xe)})},error:ie=>{Ke.error(ie)}});return function(){console.log(Le,"unsubscribe"),Ge.abort("unsubscribe"),Ne.unsubscribe()}})}internalFetch(Te){Te.requestId&&this.inFlightRequests.next(Te.requestId),Te=this.parseRequestOptions(Te);const Le=(0,O.r)();return Le!==null&&Le!==""&&P.$.jwtUrlLogin&&P.$.jwtHeaderName&&(Te.headers=Te.headers??{},Te.headers[P.$.jwtHeaderName]=`${Le}`),this.deviceID&&(Te.headers=Te.headers??{},Te.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Te).pipe(this.handleStreamResponse(Te),this.handleStreamError(Te),this.handleStreamCancellation(Te))}resolveCancelerIfExists(Te){this.inFlightRequests.next(Te)}cancelAllInFlightRequests(){this.inFlightRequests.next(Se)}async datasourceRequest(Te){return(0,r.s)(this.fetch(Te))}parseRequestOptions(Te){const Le=this.dependencies.contextSrv.user?.orgId;return Te.retry=Te.retry??0,(0,he.Lr)(Te.url)&&(Le&&(Te.headers=Te.headers??{},Te.headers["X-Grafana-Org-Id"]=Le),Te.url.startsWith("/")&&(Te.url=Te.url.substring(1)),Te.headers?.Authorization&&(Te.headers["X-DS-Authorization"]=Te.headers.Authorization,delete Te.headers.Authorization),this.noBackendCache&&(Te.headers=Te.headers??{},Te.headers["X-Grafana-NoCache"]="true")),Te.hideFromInspector===void 0&&(Te.hideFromInspector=(0,he.Lr)(Te.url)&&!(0,he.dr)(Te.url)),Te}getFromFetchStream(Te){const Le=ce(Te),Ge=z(Te);return this.dependencies.fromFetch(Le,Ge).pipe((0,u.Z)(async Me=>{const{status:De,statusText:Ke,ok:Ie,headers:Ne,url:ie,type:ve,redirected:fe}=Me,ge=Te.responseType??(te(Ne)?"json":void 0),xe=await re(Me,ge);return{status:De,statusText:Ke,ok:Ie,data:xe,headers:Ne,url:ie,type:ve,redirected:fe,config:Te,traceId:Me.headers.get(Xe)??void 0}}))}showApplicationErrorAlert(Te){}showSuccessAlert(Te){const{config:Le}=Te;if(Le.showSuccessAlert===!1||Le.showSuccessAlert===void 0&&(Le.method==="GET"||(0,he.dr)(Le.url)||!(0,he.Lr)(Le.url)))return;const Ge=Te.data;Ge?.message&&this.dependencies.appEvents.emit(l.r1.alertSuccess,[Ge.message])}showErrorAlert(Te,Le){if(Te.showErrorAlert===!1||Te.showErrorAlert===void 0&&((0,he.dr)(Te.url)||!(0,he.Lr)(Te.url)))return;let Ge="",Me=Le.data.message;Me==="Unexpected error"&&Le.message&&(Me=Le.message),Me.length>80&&(Ge=Me,Me="Error"),Le.status===422&&(Ge=Le.data.message,Me="Validation failed"),this.dependencies.appEvents.emit(Le.status<500?l.r1.alertWarning:l.r1.alertError,[Me,Ge,Le.data.traceID])}processRequestError(Te,Le){return Le.data=Le.data??{message:"Unexpected error"},typeof Le.data=="string"&&(Le.data={message:Le.data,error:Le.statusText,response:Le.data}),Le.data&&!Le.data.message&&typeof Le.data.error=="string"&&(Le.data.message=Le.data.error),Le.data.message&&setTimeout(()=>{Le.isHandled||this.showErrorAlert(Te,Le)},50),this.inspectorStream.next({response:Le,requestId:Te.requestId}),Le}handleStreamResponse(Te){return Le=>Le.pipe((0,d.T)(Ge=>{if(!Ge.ok){const{status:Me,statusText:De,data:Ke}=Ge;throw{status:Me,statusText:De,data:Ke,config:Te,traceId:Ge.headers.get(Xe)??void 0}}return Ge}),(0,g.M)(Ge=>{this.showSuccessAlert(Ge),this.inspectorStream.next({response:Ge,requestId:Te.requestId})}))}handleStreamError(Te){const{isSignedIn:Le}=this.dependencies.contextSrv.user;return Ge=>Ge.pipe((0,o.l)(Me=>Me.pipe((0,u.Z)((De,Ke)=>{const Ie=Ke===0&&Te.retry===0;if(De.status===401&&(0,he.Lr)(Te.url)&&Ie&&Le){if(De.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new V.S8({component:N,props:{maxConcurrentSessions:De.data?.error?.maxConcurrentSessions}})),this.dependencies.contextSrv.setRedirectToUrl(),(0,x.$)(()=>De);let Ne=this.loginPing();return(0,M.m)()&&(0,M.W)()*1e3<Date.now()&&(Ne=this.rotateToken()),(0,s.H)(Ne).pipe((0,E.W)(ie=>(ie.status===401&&this.dependencies.logout(),(0,x.$)(ie))))}return(0,x.$)(De)}))),(0,E.W)(Me=>(0,x.$)(()=>this.processRequestError(Te,Me))))}handleStreamCancellation(Te){return Le=>Le.pipe((0,m.Q)(this.inFlightRequests.pipe((0,f.p)(Ge=>{let Me=!1;return Te&&Te.requestId&&Te.requestId===Ge&&(Me=!0),Ge===Se&&(Me=!0),Me}))),(0,p.v)(()=>({type:v.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Te})))}getInspectorStream(){return this.inspectorStream}async get(Te,Le,Ge,Me){return this.request({...Me,method:"GET",url:Te,params:Le,requestId:Ge})}async delete(Te,Le,Ge){return this.request({...Ge,method:"DELETE",url:Te,data:Le})}async post(Te,Le,Ge){return this.request({...Ge,method:"POST",url:Te,data:Le})}async patch(Te,Le,Ge){return this.request({...Ge,method:"PATCH",url:Te,data:Le})}async put(Te,Le,Ge){return this.request({...Ge,method:"PUT",url:Te,data:Le})}withNoBackendCache(Te){return this.noBackendCache=!0,Te().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,h.j)(()=>{this._tokenRotationInProgress=null}),(0,D.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Te){return this.get("/api/search",Te)}getDashboardByUid(Te){return(0,y.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,R.n)().getDashboardDTO(Te)}validateDashboard(Te){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Te){return this.get(`/api/public/dashboards/${Te}`)}getFolderByUid(Te,Le={}){const Ge=new URLSearchParams;return Le.withAccessControl&&Ge.set("accesscontrol","true"),this.get(`/api/folders/${Te}?${Ge.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const we=new Qe,$e=()=>we},42228:(q,j,e)=>{"use strict";e.d(j,{n:()=>n});var t=e(3353);const n=(a,i)=>{(0,t.x$)().addEvent({type:t.on.Performance,payload:{name:a,value:i}})},r=a=>faro?.api?.pushError(a)},87851:(q,j,e)=>{"use strict";e.d(j,{S5:()=>i,k0:()=>r});var t=e(61978),n=e(77595);function r(x,s=!1){return new Promise(c=>{const d=document.createElement("script");d.onload=c,d.src=x,d.async=s,document.head.appendChild(d)})}const a=(0,t.h)("EchoSrv"),i=a.logger;(0,n.h)("echo",void 0,a)},36167:(q,j,e)=>{"use strict";e.d(j,{A:()=>c});var t=e(2543),n=e.n(t),r=e(28082),a=e(88023),i=e(82856);class x{constructor(){}addDashboardImpression(u){const g=this.impressionKey();let o=[];i.A.exists(g)&&(o=JSON.parse(i.A.get(g)),(0,t.isArray)(o)||(o=[])),o=o.filter(E=>u!==E),o.unshift(u),o.length>50&&o.pop(),i.A.set(g,JSON.stringify(o))}async convertToUIDs(){let u=this.getImpressions();const g=(0,t.filter)(u,E=>(0,t.isNumber)(E));if(!g.length)return;const o=await(0,r.AI)().get(`/api/dashboards/ids/${g.join(",")}`);i.A.set(this.impressionKey(),JSON.stringify([...(0,t.filter)(u,E=>(0,t.isString)(E)),...o]))}getImpressions(){const u=i.A.get(this.impressionKey())||"[]";return JSON.parse(u)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,t.filter)(this.getImpressions(),g=>(0,t.isString)(g))}impressionKey(){return"dashboard_impressions-"+a.Ay.bootData.user.orgId}}const c=new x},14765:(q,j,e)=>{"use strict";e.d(j,{R:()=>D});let t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},a={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},i=null;for(let C=1;C<20;++C)t[111+C]="f"+C;for(let C=0;C<=9;++C)t[C+96]=C.toString();function x(C){if(C.type==="keypress"){let l=String.fromCharCode(C.which);return C.shiftKey||(l=l.toLowerCase()),l}return t[C.which]?t[C.which]:n[C.which]?n[C.which]:String.fromCharCode(C.which).toLowerCase()}function s(C,l){return C.sort().join(",")===l.sort().join(",")}function c(C){let l=[];return C.shiftKey&&l.push("shift"),C.altKey&&l.push("alt"),C.ctrlKey&&l.push("ctrl"),C.metaKey&&l.push("meta"),l}function d(C){if(C.preventDefault){C.preventDefault();return}C.returnValue=!1}function u(C){if(C.stopPropagation){C.stopPropagation();return}C.cancelBubble=!0}function g(C){return C==="shift"||C==="ctrl"||C==="alt"||C==="meta"}function o(){if(!i){i={};for(let C in t){const l=parseInt(C,10);l>95&&l<112||t.hasOwnProperty(C)&&(i[t[C]]=C)}}return i}function E(C,l,v){return v||(v=o()[C]?"keydown":"keypress"),v==="keypress"&&l.length&&(v="keydown"),v}function m(C){return C==="+"?["+"]:(C=C.replace(/\+{2}/g,"+plus"),C.split("+"))}function f(C,l){let v,y,P,b=[];for(v=m(C),P=0;P<v.length;++P)y=v[P],a[y]&&(y=a[y]),l&&l!=="keypress"&&r[y]&&(y=r[y],b.push("shift")),g(y)&&b.push(y);if(!y)throw new Error("Unable to get key");return l=E(y,b,l),{key:y,modifiers:b,action:l}}function p(C,l){return C===null||C===document?!1:C===l?!0:p(C.parentNode,l)}class h{constructor(l){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=v=>{v=v||{};let y=!1,P;for(P in this._sequenceLevels){if(v[P]){y=!0;continue}this._sequenceLevels[P]=0}y||(this._nextExpectedAction=!1)},this._getMatches=(v,y,P,b,S,M)=>{let O,R,L=[],B=P.type;if(!this._callbacks[v])return[];for(B==="keyup"&&g(v)&&(y=[v]),O=0;O<this._callbacks[v].length;++O)if(R=this._callbacks[v][O],!(!b&&R.seq&&this._sequenceLevels[R.seq]!==R.level)&&B===R.action&&(B==="keypress"&&!P.metaKey&&!P.ctrlKey||s(y,R.modifiers))){let F=!b&&R.combo===S,I=b&&R.seq===b&&R.level===M;(F||I)&&this._callbacks[v].splice(O,1),L.push(R)}return L},this._fireCallback=(v,y,P,b)=>{const S=y.target||y.srcElement;S&&S instanceof HTMLElement&&this.stopCallback(y,S,P,b)||v(y,P)===!1&&(d(y),u(y))},this._handleKey=(v,y,P)=>{let b=this._getMatches(v,y,P),S,M={},O=0,R=!1;for(S=0;S<b.length;++S)b[S].seq&&(O=Math.max(O,b[S].level??0));for(S=0;S<b.length;++S){const B=b[S].seq;if(B){if(b[S].level!==O)continue;R=!0,M[B]=1,this._fireCallback(b[S].callback,P,b[S].combo,B);const F=B.lastIndexOf(v),I=B.slice(0,F);for(const[U,W]of Object.entries(this._sequenceLevels))W>0&&U.startsWith(I)&&(M[U]=1);continue}R||this._fireCallback(b[S].callback,P,b[S].combo)}for(const B of this._callbacks[v]??[])B.action===P.type&&B.seq&&B.level===0&&(M[B.seq]=1);let L=P.type==="keypress"&&this._ignoreNextKeypress;P.type===this._nextExpectedAction&&!g(v)&&!L&&this._resetSequences(M),this._ignoreNextKeypress=R&&P.type==="keydown"},this._handleKeyEvent=v=>{if(!(v instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const y=v;if(y.repeat)return;typeof y.which!="number"&&(y.which=y.keyCode);let P=x(y);if(P){if(y.type==="keyup"&&this._ignoreNextKeyup===P){this._ignoreNextKeyup=!1;return}this.handleKey(P,c(y),y)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(v,y,P,b)=>{this._sequenceLevels[v]=0;const S=O=>()=>{this._nextExpectedAction=O,++this._sequenceLevels[v],this._resetSequenceTimer()},M=O=>{this._fireCallback(P,O,v),b!=="keyup"&&(this._ignoreNextKeyup=x(O)),this._resetSequenceTimer()};for(let O=0;O<y.length;++O){let L=O+1===y.length?M:S(b||f(y[O+1]).action);this._bindSingle(y[O],L,b,v,O)}},this._bindSingle=(v,y,P,b,S)=>{this._directMap[v+":"+P]=y,v=v.replace(/\s+/g," ");let M=v.split(" "),O;if(M.length>1){this._bindSequence(v,M,y,P);return}O=f(v,P),this._callbacks[O.key]=this._callbacks[O.key]||[];const R={type:O.action,metaKey:!1,ctrlKey:!1};this._getMatches(O.key,O.modifiers,R,b,v,S);const L={callback:y,modifiers:O.modifiers,action:O.action,seq:b,level:S,combo:v};this._callbacks[O.key][b?"unshift":"push"](L)},this._bindMultiple=(v,y,P)=>{for(let b=0;b<v.length;++b)this._bindSingle(v[b],y,P)},this.bind=(v,y,P)=>(v=v instanceof Array?v:[v],this._bindMultiple(v,y,P),self),this.unbind=(v,y)=>this.bind(v,function(){},y),this.bindGlobal=(v,y,P)=>{if(this.bind(v,y,P),v instanceof Array){for(let b=0;b<v.length;b++)this._globalCallbacks[v[b]]=!0;return}this._globalCallbacks[v]=!0},this.unbindGlobal=(v,y)=>{if(this.unbind(v,y),v instanceof Array){for(let P=0;P<v.length;P++)this._globalCallbacks[v[P]]=!1;return}this._globalCallbacks[v]=!1},this.trigger=(v,y)=>{let P=this;return P._directMap[v+":"+y]&&P._directMap[v+":"+y]({},v),P},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(v,y,P,b)=>{if(this._globalCallbacks[P]||b&&this._globalCallbacks[b]||(" "+y.className+" ").indexOf(" mousetrap ")>-1||p(y,this.target))return!1;if("composedPath"in v&&typeof v.composedPath=="function"){let S=v.composedPath()[0];S!==v.target&&S instanceof HTMLElement&&(y=S)}return!!(y.tagName==="INPUT"||y.tagName==="SELECT"||y.tagName==="TEXTAREA"||"isContentEditable"in y&&y.isContentEditable)},this.handleKey=(...v)=>this._handleKey(...v),this.addKeycodes=v=>{for(let y in v)v.hasOwnProperty(y)&&(t[y]=v[y]);i=null},this.target=l,this.target.addEventListener("keypress",v=>{v instanceof KeyboardEvent&&this._handleKeyEvent(v)}),this.target.addEventListener("keydown",v=>{v instanceof KeyboardEvent&&this._handleKeyEvent(v)}),this.target.addEventListener("keyup",v=>{v instanceof KeyboardEvent&&this._handleKeyEvent(v)})}}const D=new h(document)},97267:(q,j,e)=>{"use strict";e.d(j,{K:()=>s,O:()=>c});var t=e(71985),n=e(86833),r=e(22492),a=e(88023),i=e(87638),x=e(33237);async function s(d,u){const g=a.$W.theme2,o=(0,t.g)(d);if(r.A.publish(new n.E8(o)),g.colors.mode!==o.colors.mode){const f=document.createElement("link");f.rel="stylesheet",f.href=a.$W.bootData.assets[o.colors.mode],f.onload=()=>{const p=document.getElementsByTagName("link");for(let h=0;h<p.length;h++){const D=p[h];D.href&&D.href.includes(`build/grafana.${g.colors.mode}`)&&D.remove()}},document.head.insertBefore(f,document.head.firstChild)}if(u||!i.TP.isSignedIn)return;const E=new x.W("user"),m=await E.load();await E.update({...m,theme:o.colors.mode})}async function c(d){const u=a.$W.theme2;s(u.isDark?"light":"dark",d)}},82856:(q,j,e)=>{"use strict";e.d(j,{A:()=>r});class t{get(i){return window.localStorage[i]}set(i,x){window.localStorage[i]=x}getBool(i,x){return x!==void 0&&!this.exists(i)?x:window.localStorage[i]==="true"}getObject(i,x){let s=x;if(this.exists(i)){const c=window.localStorage[i];try{s=JSON.parse(c)}catch(d){console.error(`Error parsing store object: ${i}. Returning default: ${x}. [${d}]`)}}return s}setObject(i,x){let s;try{s=JSON.stringify(x)}catch(c){throw new Error(`Could not stringify object: ${i}. [${c}]`)}try{this.set(i,s)}catch(c){const d=new Error(`Could not save item in localStorage: ${i}. [${c}]`);throw c instanceof Error&&(d.name=c.name),d}return!0}exists(i){return window.localStorage[i]!==void 0}delete(i){window.localStorage.removeItem(i)}}const r=new t},15084:(q,j,e)=>{"use strict";e.d(j,{F:()=>t});function t(n={}){return{...n,accesscontrol:!0}}},33935:(q,j,e)=>{"use strict";e.d(j,{b:()=>t});const t=(n,r,a)=>(n.splice(a,0,n.splice(r,1)[0]),n)},47715:(q,j,e)=>{"use strict";e.d(j,{gn:()=>r});function t(){const a=navigator.userAgent.indexOf("MSIE")>-1,i=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,x=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,s=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),c=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return a&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||i&&(c&&parseFloat(c[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||x&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(s&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function n(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function r(){return n()?"\u2318":"ctrl"}},83023:(q,j,e)=>{"use strict";e.d(j,{TS:()=>r});class t{_linkTo(s,c){c<=0&&s.inputEdges.push(this),c>=0&&s.outputEdges.push(this),s.edges.push(this)}link(s,c){if(!s)throw Error("inputNode is required");if(!c)throw Error("outputNode is required");return this.unlink(),this.inputNode=s,this.outputNode=c,this._linkTo(s,1),this._linkTo(c,-1),this}unlink(){let s;const c=this.inputNode,d=this.outputNode;c&&d&&(s=c.edges.indexOf(this),s>-1&&c.edges.splice(s,1),s=d.edges.indexOf(this),s>-1&&d.edges.splice(s,1),s=c.outputEdges.indexOf(this),s>-1&&c.outputEdges.splice(s,1),s=d.inputEdges.indexOf(this),s>-1&&d.inputEdges.splice(s,1))}}class n{constructor(s){this.name=s,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(s){return s?typeof s=="object"?this.inputEdges.find(c=>c.inputNode?.name===s.name):this.inputEdges.find(c=>c.inputNode?.name===s):null}getEdgeTo(s){return s?typeof s=="object"?this.outputEdges.find(c=>c.outputNode?.name===s.name):this.outputEdges.find(c=>c.outputNode?.name===s):null}getOptimizedInputEdges(){const s=[];return this.inputEdges.forEach(c=>{c.inputNode?.inputEdges.map(u=>u.inputNode)?.forEach(u=>{const g=u?.getEdgeTo(this.name);g&&s.push(g)})}),this.inputEdges.filter(c=>s.indexOf(c)===-1)}}class r{constructor(){this.nodes={}}createNode(s){const c=new n(s);return this.nodes[s]=c,c}createNodes(s){const c=[];return s.forEach(d=>{c.push(this.createNode(d))}),c}link(s,c){let d=[],u=[];const g=[],o=[];s instanceof Array?d=s:d=[s],c instanceof Array?u=c:u=[c];for(let m=0;m<d.length;m++){const f=d[m];if(typeof f=="string"){const p=this.getNode(f);if(!p)throw Error(`cannot link input node named ${f} since it doesn't exist in graph`);g.push(p)}else g.push(f)}for(let m=0;m<u.length;m++){const f=u[m];if(typeof f=="string"){const p=this.getNode(f);if(!p)throw Error(`cannot link output node named ${f} since it doesn't exist in graph`);o.push(p)}else o.push(f)}const E=[];return g.forEach(m=>{o.forEach(f=>{if(this.willCreateCycle(m,f))throw Error(`cannot link ${m.name} to ${f.name} since it would create a cycle`);E.push(this.createEdge().link(m,f))})}),E}descendants(s){if(!s.length)return new Set;const c=new Set(i(s)?s.map(d=>this.nodes[d]).filter(d=>d!==void 0):s);return this.descendantsRecursive(c)}descendantsRecursive(s,c=new Set){for(const d of s){const u=new Set;for(const{inputNode:g}of d.inputEdges)g&&!c.has(g)&&(c.add(g),u.add(g));this.descendantsRecursive(u,c)}return c}willCreateCycle(s,c){if(s===c)return!0;const d=new Set,u=[c];for(;u.length;){const g=u.pop();if(g===s)return!0;d.add(g);for(const o of g.outputEdges){const E=o.outputNode;E&&!d.has(E)&&u.push(E)}}return!1}createEdge(){return new t}getNode(s){return this.nodes[s]}}const a=x=>{Object.keys(x.nodes).forEach(s=>{const c=x.nodes[s];let d=c.outputEdges.map(g=>g.outputNode?.name).join(", ");d||(d="<none>");let u=c.inputEdges.map(g=>g.inputNode?.name).join(", ");u||(u="<none>"),console.log(`${c.name}:
 - links to:   ${d}
 - links from: ${u}`)})};function i(x){return x.length>0&&typeof x[0]=="string"}},44608:(q,j,e)=>{"use strict";e.d(j,{do:()=>r,q6:()=>n,rE:()=>a});var t=e(28082);function n(i){if(typeof i=="string")return i;if(i){if(i instanceof Error)return i.message;if((0,t.NF)(i)){if(i.data&&i.data.message)return i.data.message;if(i.statusText)return i.statusText}else if(i.hasOwnProperty("message"))return i.message}return JSON.stringify(i)}function r(i){if(typeof i!="string"&&i){if(i instanceof Error)return;if((0,t.NF)(i))return i.status;if(i.hasOwnProperty("status"))return i.status}}function a(i){if(typeof i!="string"&&i){if(i instanceof Error)return;if((0,t.NF)(i))return i.data?.messageId;if(i.hasOwnProperty("messageId"))return i.messageId}}},95536:(q,j,e)=>{"use strict";e.d(j,{HQ:()=>C,Ll:()=>R,MA:()=>M,WP:()=>f,Xe:()=>y,_u:()=>N,bI:()=>b,dY:()=>U,di:()=>B,dr:()=>l,eF:()=>L,o$:()=>v,uE:()=>A,uJ:()=>V,uq:()=>P,w4:()=>S,zT:()=>I,zq:()=>W});var t=e(43561),n=e(24726),r=e(7500),a=e(93407),i=e(2567),x=e(16753),s=e(55801),c=e(44099),d=e(59577),u=e(98437),g=e(98140),o=e(82856),E=e(44684);const m={dedupStrategy:r.fY.none},f="0123456789abcdefghijklmnopqrstuvwxyz",p=(0,t.d_)(f,3),h="grafana.explore.datasource",D=T=>`${h}.${T}`,C=T=>o.A.getObject(D(T)),l=(T,z)=>o.A.setObject(D(T),z);function v(){for(;;){const T=p(3);if(!/^\d+$/.test(T))return T}}async function y(T){const{queries:z,dsRef:w,timeRange:H,scopedVars:G,adhocFilters:X}=T,k=(await Promise.allSettled(z.filter(ee=>ee.datasource?.uid!==E.Uj).map(async ee=>{const J=await(0,u.l)().get(ee.datasource||w);return{...J.interpolateVariablesInQueries?.([ee],G??{},X)[0]||ee,...!J.meta.mixed&&{datasource:J.getRef()}}}))).filter(ee=>ee.status==="fulfilled").map(ee=>ee.value),_=JSON.stringify({[v()]:{range:(0,a.sQ)(H.raw),queries:k,datasource:w?.uid}});return i.I.assureBaseUrl(a.kM.renderUrl("/explore",{panes:_,schemaVersion:1}))}function P(T){return`explore_${T}`}function b(T,z,w,H,G,X,k){const _=Number.parseInt(T,36),{interval:ee,intervalMs:J}=K(H,w.minInterval,w.maxDataPoints),Z={app:x.Jk.Explore,timezone:X||s.lE,startTime:Date.now(),interval:ee,intervalMs:J,panelId:_,targets:z,range:H,requestId:P(T),rangeRaw:H.raw,scopedVars:{__interval:{text:ee,value:ee},__interval_ms:{text:J,value:J},...k},maxDataPoints:w.maxDataPoints,liveStreaming:w.liveStreaming,skipQueryCache:!0};return{queries:z,request:Z,scanning:G,id:O(),done:!1}}const S=({key:T,...z})=>z,M=(T,z)=>{if(T==null)return"";try{return JSON.stringify(T,null,z)}catch(w){console.error(w)}return""};function O(T=0){return`Q-${(0,n.A)()}-${T}`}async function R(T,z=0,w){let H,G,X;return w?G=w:T.length>0&&T[T.length-1].datasource?G=T[T.length-1].datasource:(H=await(0,u.l)().get(),X=H.getDefaultQuery?.(x.Jk.Explore),G=H.getRef()),H||(H=await(0,u.l)().get(G),X=H.getDefaultQuery?.(x.Jk.Explore)),{...X,refId:(0,c.M)(T),key:O(z),datasource:G}}const L=(T,z,w=0)=>{const H=O(w),G=T.refId||(0,c.M)(z);return{...T,refId:G,key:H}};async function B(T,z){if(T&&typeof T=="object"&&T.length>0){const w=[];for(let H=0;H<T.length;H++){const G=T[H],X=O(H);let k=G.refId;k||(k=(0,c.M)(w));let _=!0;if(G.datasource)try{await(0,u.l)().get(G.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),_=!1}_&&w.push({...G,refId:k,key:X})}return w}try{const w=z??(await(0,u.l)().get()).getRef();return[await R(T??[],void 0,w)]}catch{return[]}}const F=["refId","key","context","datasource"];function I(T){return T&&T.some(z=>Object.entries(z).filter(([H,G])=>F.indexOf(H)===-1).filter(([H,G])=>G).length>0)}const U=T=>T.reduce((w,H,G)=>{const X=H.datasource?.uid||H.key;return w.concat(`${X}-${G}`)},[]),W=(T,z,w)=>d.convertRawToRange(z,T,w),A=T=>g.cC.isLive(T)?r.uH.Ascending:r.uH.Descending,N=T=>{T&&T.unsubscribe()};function K(T,z,w){return w?d.calculateInterval(T,w,z):{interval:"1s",intervalMs:1e3}}const V=T=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(T);else{const z=document.createElement("textarea");z.value=T,document.body.appendChild(z),z.select(),document.execCommand("copy"),document.body.removeChild(z)}}},42961:(q,j,e)=>{"use strict";e.r(j),e.d(j,{default:()=>t});function t(n,r){r=r||{};const a=r.delimiter||".";let i=r.maxDepth||3,x=1;const s={};function c(d,u){Object.entries(d).forEach(([g,o])=>{const E=r?.safe&&Array.isArray(o),f=Object.prototype.toString.call(o)==="[object Object]",p=u?u+a+g:g;if(r?.maxDepth||(i=x+1),!E&&f&&Object.keys(o).length&&x<i)return++x,c(o,p);s[p]=o})}return c(n,null),s}},58410:(q,j,e)=>{"use strict";e.d(j,{A:()=>s});var t=e(33262),n=e(67793),r=e(59577),a=e(59141);const x={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:c=>((0,t.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,n.$f)(c)),roundInterval:c=>((0,t.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),r.roundInterval(c)),secondsToHms:c=>((0,t.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),r.secondsToHms(c)),secondsToHhmmss:c=>{const d=[],u=Math.floor(c/3600),g=Math.floor(c%3600/60),o=Math.floor(c%3600%60);return u>9?d.push(""+u):d.push("0"+u),g>9?d.push(""+g):d.push("0"+g),o>9?d.push(""+o):d.push("0"+o),d.join(":")},toPercent:(c,d)=>Math.floor(c/d*1e4)/100+"%",addSlashes:c=>c.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:c=>((0,t.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),r.describeInterval(c)),intervalToSeconds:c=>((0,t.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),r.intervalToSeconds(c)),intervalToMs:c=>((0,t.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),r.intervalToMs(c)),calculateInterval:(c,d,u)=>((0,t.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),r.calculateInterval(c,d,u)),queryColorDot:(c,d)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+c,"font-size:"+d+"px"].join(";")+'"></div>',slugifyForUrl:c=>c.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:c=>((0,t.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,n.dO)(c)),toFixed:(c,d)=>{if(c===null)return"";const u=d?Math.pow(10,Math.max(0,d)):1,g=String(Math.round(c*u)/u);if(g.indexOf("e")!==-1||c===0)return g;if(d!=null){const o=g.indexOf("."),E=o===-1?0:g.length-o-1;if(E<d)return(E?g:g+".")+String(u).slice(1,d-E+1)}return g},toFixedScaled:(c,d,u,g,o)=>u===null?x.toFixed(c,d)+o:x.toFixed(c,u+g)+o,roundValue:(c,d)=>{if(c===null)return null;const u=Math.pow(10,d),g=(u*c).toFixed(d);return Math.round(parseFloat(g))/u},getUnitFormats:a.Ke};typeof Proxy<"u"?x.valueFormats=new Proxy(x.valueFormats,{get(c,d,u){if(typeof d!="string")throw{message:`Value format ${String(d)} is not a string`};const g=(0,a.j_)(d);return g?(o,E,m,f)=>(0,a.cN)(g(o,E,m,f?"utc":"browser")):Reflect.get(c,d,u)}}):x.valueFormats=(0,a.uH)();const s=x},36314:(q,j,e)=>{"use strict";e.d(j,{j:()=>n,z:()=>r});var t=e(42228);function n(a){if(!(!performance||!performance.mark))try{performance.mark(`${a}_started`)}catch(i){console.error(`[Metrics] Failed to startMeasure ${a}`,i)}}function r(a){if(!(!performance||!performance.mark))try{const i=`${a}_started`,x=`${a}_completed`,s=`${a}_measured`;performance.mark(x);const c=performance.measure(s,i,x);return(0,t.n)(`${a}_ms`,c.duration),performance.clearMarks(i),performance.clearMarks(x),performance.clearMeasures(s),c}catch(i){console.error(`[Metrics] Failed to stopMeasure ${a}`,i);return}}},23375:(q,j,e)=>{"use strict";e.d(j,{C:()=>r,o:()=>a});var t=e(32370),n=e(11817);function r(i){switch(i){case"home":return(0,n.t)("nav.home.title","Home");case"home-setup-guide":return(0,n.t)("nav.setup-guide.title","Setup guide");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,n.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,n.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return t.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.title","Shared dashboards"):(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"drilldown":return(0,n.t)("nav.drilldown.title","Drilldown");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,n.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","More apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-dbo11y-app":return(0,n.t)("nav.databases.title","Databases");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function a(i){switch(i){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards and panels");case"dashboards/public":return t.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.subtitle","Manage your organization's externally shared dashboards"):void 0;case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations and enable receiving Grafana-managed alerts");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,n.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"groupsync":return(0,n.t)("nav.groupsync.subtitle","Manage mappings of Identity Provider groups to Grafana Roles");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},31788:(q,j,e)=>{"use strict";e.d(j,{v:()=>r});var t=e(2543),n=e.n(t);function r(a){return(0,t.isArray)(a)?a.map(r):(0,t.isPlainObject)(a)?Object.keys(a).sort().reduce((i,x)=>{const s=a[x];return s!=null&&s!==-1/0&&(i[x]=r(s)),i},{}):a}},27315:(q,j,e)=>{"use strict";e.d(j,{Ih:()=>n,Lr:()=>i,U7:()=>r,dr:()=>a,fE:()=>x});var t=e(44099);function n(s){const c=["refId","hide","key","queryType","datasource"];for(const d in s)if(d!=="label"&&!c.includes(d))return!1;return!0}function r(s,c,d){const u={...c,refId:(0,t.M)(s),hide:!1};return!u.datasource&&d&&(u.datasource=d),[...s,u]}function a(s){return s.indexOf("api/datasources/proxy")!==-1||s.indexOf("api/ds/query")!==-1}function i(s){return!s.match(/^http/)}function x(s){return s||void 0}},14453:(q,j,e)=>{"use strict";e.d(j,{Ax:()=>R,DI:()=>p,Gx:()=>D,IA:()=>b,NC:()=>y,TR:()=>B,U3:()=>P,X1:()=>C,cX:()=>v,l0:()=>f,oU:()=>l,rs:()=>h,x8:()=>L,xB:()=>m.x});var t=e(2543),n=e.n(t),r=e(93407),a=e(88090),i=e(98437),x=e(23737),s=e(17687),c=e(11817),d=e(83394),u=e(84315),g=e(94023),o=e(67548),E=e(61351),m=e(75748);async function f(I){const{queries:U,localOverride:W,datasource:A,starred:N,comment:K,showNotif:V}=I,T=V?.quotaExceededError??!0,z=V?.limitExceededWarning??!0,w=V?.otherErrors??!0,H=U&&U.filter(G=>F(G));if(H.length>0){let G=!1,X=!1,k;try{k=(await(W?(0,o.tU)():(0,o.a)()).addToRichHistory({datasourceUid:A.uid,datasourceName:A.name??"",queries:H,starred:N,comment:K??""})).warning}catch(_){return _ instanceof Error&&(_.name===u.m.StorageFull?(G=!0,T&&(0,d.JD)((0,x.dx)((0,s.gi)(_.message)))):w&&_.name!==u.m.DuplicatedEntry&&(0,d.JD)((0,x.dx)((0,s.gi)((0,c.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),_.message)))),{richHistoryStorageFull:G,limitExceeded:X}}return k&&k.type===u.C.LimitExceeded&&(X=!0,z&&(0,d.JD)((0,x.dx)((0,s.q8)(k.message)))),{richHistoryStorageFull:G,limitExceeded:X}}return{}}async function p(I){const U={...I,from:I.to===void 0?I.to:(0,g.wQ)(I.to,{isLastTs:!0,tz:E.TP.user?.timezone}),to:I.from===void 0?I.from:(0,g.wQ)(I.from,{isLastTs:!0,tz:E.TP.user?.timezone})};return await(0,o.a)().getRichHistory(U)}async function h(I){await(0,o.a)().updateSettings(I)}async function D(){return await(0,o.a)().getSettings()}async function C(){return(0,o.a)().deleteAll()}async function l(I,U){try{return await(0,o.a)().updateStarred(I,U)}catch(W){W instanceof Error&&(0,d.JD)((0,x.dx)((0,s.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),W.message)));return}}async function v(I,U){try{return await(0,o.a)().updateComment(I,U)}catch(W){W instanceof Error&&(0,d.JD)((0,x.dx)((0,s.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),W.message)));return}}async function y(I){try{return await(0,o.a)().deleteRichHistory(I),I}catch(U){U instanceof Error&&(0,d.JD)((0,x.dx)((0,s.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),U.message)));return}}const P=I=>{const U={range:{from:(0,c.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,c.t)("explore.rich-history-utils.default-to","now")},datasource:I.datasourceName,queries:I.queries},W=(0,r.Pp)(U),A=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return r.kM.renderUrl(`${A}/explore`,{left:W})},b=I=>{let U;switch(I){case 0:U=(0,c.t)("explore.rich-history-utils.today","today");break;case 1:U=(0,c.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:U=(0,c.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:U=(0,c.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:U=(0,c.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${I}`})}return U};function S(I){return(0,a.LE)(I,{format:"MMMM D"})}function M(I){const U=(0,t.omit)(I,["key","refId","datasource"]);return JSON.stringify(U)}function O(I,U){let W="";return U===m.x.DatasourceAZ||U===m.x.DatasourceZA?W=I.datasourceName:W=S(I.createdAt),W}function R(I,U){return U?.getQueryDisplayText?U.getQueryDisplayText(I):M(I)}function L(I,U){let W={};return I.forEach(A=>{let N=O(A,U);N in W?W[N]=[...W[N],A]:W[N]=[A]}),W}function B(){return(0,i.l)().getList({mixed:!0}).map(I=>({name:I.name,uid:I.uid}))}function F(I){const U=(0,t.omit)(I,["key","refId","datasource"]);return Object.keys(U).length>0}},75748:(q,j,e)=>{"use strict";e.d(j,{x:()=>t});var t=(n=>(n.Descending="Descending",n.Ascending="Ascending",n.DatasourceAZ="Datasource A-Z",n.DatasourceZA="Datasource Z-A",n))(t||{})},65552:(q,j,e)=>{"use strict";e.d(j,{$l:()=>D,Sp:()=>p,VN:()=>h,VP:()=>f,fn:()=>m,sU:()=>l});var t=e(41811),n=e(32370),r=e(28082),a=e(53027),i=e(61034),x=e(23737),s=e(17687),c=e(32480),d=e(83394),u=e(11817),g=e(95536);function o(){return`${window.location.protocol}//${window.location.host}${n.$.appSubUrl}`}function E(v){let y=v.replace(o(),"");return y.startsWith("/")?y.substring(1,y.length):y}const m=(0,t.default)(async function(v){try{return(await(0,r.AI)().post("/api/short-urls",{path:E(v)})).url}catch(y){console.error("Error when creating shortened link: ",y),(0,d.JD)((0,x.dx)((0,s.gi)("Error generating shortened link")))}}),f=async v=>{const y=await m(v);y?((0,g.uJ)(y),(0,d.JD)((0,x.dx)((0,s.tZ)("Shortened link copied to clipboard")))):(0,d.JD)((0,x.dx)((0,s.gi)("Error generating shortened link")))},p=async(v,y,P)=>{const b=h(v,y,P);if(y.useShortUrl)return await f(b);(0,g.uJ)(b),(0,d.JD)((0,x.dx)((0,s.tZ)((0,u.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},h=(v,y,P)=>{const b=a.Ny.getLocation(),S=i.jh.getTimeRange(P??v),M=D(y,S,P);return(0,c.u)({uid:v.state.uid,slug:v.state.meta.slug,currentQueryParams:b.search,updateQuery:M,absolute:!y.useShortUrl})},D=(v,y,P)=>{const b={};return P&&(b.viewPanel=P.state.key),v.useAbsoluteTimeRange&&(b.from=y.state.value.from.toISOString(),b.to=y.state.value.to.toISOString()),v.theme!=="current"&&(b.theme=v.theme),b};function C(v,y){for(let P=y.indexOf(v)-1;P>=0;P--)if(y[P].timeEpochMs>v.timeEpochMs)return y[P];return null}function l(v,y,P){const b={from:new Date(P.from).toISOString(),to:new Date(P.to).toISOString()};if(!n.$.featureToggles.logsInfiniteScrolling)return b;const S=y.filter(O=>O.dataFrame.refId===v.dataFrame.refId),M=C(v,S);return v.timeEpochMs>P.to&&!M?{from:new Date(P.from).toISOString(),to:new Date(v.timeEpochMs+1).toISOString()}:{from:new Date(P.from).toISOString(),to:new Date(M?M.timeEpochMs:P.to).toISOString()}}},6641:(q,j,e)=>{"use strict";e.r(j),e.d(j,{getPrecision:()=>i,getScaledDecimals:()=>n,getStringPrecision:()=>x,grafanaTimeFormat:()=>r,logp:()=>a,tickStep:()=>t});function t(s,c,d){const u=Math.sqrt(50),g=Math.sqrt(10),o=Math.sqrt(2),E=Math.abs(c-s)/Math.max(0,d);let m=Math.pow(10,Math.floor(Math.log(E)/Math.LN10));const f=E/m;return f>=u?m*=10:f>=g?m*=5:f>=o&&(m*=2),c<s?-m:m}function n(s,c){return s-Math.floor(Math.log(c)/Math.LN10)}function r(s,c,d){if(c&&d&&s){const u=d-c,g=u/s/1e3,o=864e5,E=31536e6;return g<=45?"HH:mm:ss":g<=7200||u<=o?"HH:mm":g<=8e4?"MM/DD HH:mm":g<=2419200||u<=E?"MM/DD":"YYYY-MM"}return"HH:mm"}function a(s,c){return Math.log(s)/Math.log(c)}function i(s){const c=s.toString();return x(c)}function x(s){if(isNaN(s))return 0;const c=s.indexOf(".");return c===-1?0:s.length-c-1}},46924:(q,j,e)=>{"use strict";e.d(j,{Wb:()=>n,Zk:()=>r,zG:()=>a});var t=e(3202);const n=(i,x)=>{const s={from:(0,t.yT)(x.from),to:(0,t.yT)(x.to)},c=(s.to.valueOf()-s.from.valueOf())/2;let d,u;return i===-1?(d=s.to.valueOf()-c,u=s.from.valueOf()-c):i===1?(d=s.to.valueOf()+c,u=s.from.valueOf()+c,d>Date.now()&&s.to.valueOf()<Date.now()&&(d=Date.now(),u=s.from.valueOf())):(d=s.to.valueOf(),u=s.from.valueOf()),{from:u,to:d}},r=(i,x)=>{const s=i.to.valueOf()-i.from.valueOf(),c=i.to.valueOf()-s/2,d=s===0?3e4:s*x,u=c+d/2;return{from:c-d/2,to:u}};async function a(){const i=await navigator.clipboard.readText();let x;try{return x=JSON.parse(i),!x.from||!x.to?{range:i,isError:!0}:{range:x,isError:!1}}catch{return{range:i,isError:!0}}}},95181:(q,j,e)=>{"use strict";e.d(j,{i:()=>x});var t=e(14465),n=e(66102);const r=24*3600;function a(s,c,d,u,g,o){let E=u-s;E<0&&(E+=7);let m=c*3600+d*60,f=g*3600+o*60,p=0;return E===0&&f<m?p=7*r-(m-f):p=E*r-m+f,p}function i(s,c,d,u){if(s==null&&c==null)return;const g={cronExpr:"",duration:0},o=s==null&&d==null,E=s!=null&&c==null&&u==null;c??="00:00";let[m,f]=c.split(":").map(l=>+l);g.cronExpr=`${f} ${m} * * ${s??"*"}`,s??=1,d??=s,E&&(u="00:00",d+=d===7?-6:1),u??=c;let[p,h]=u.split(":").map(l=>+l),D=m*3600+f*60,C=p*3600+h*60;return o&&C<D&&(d+=d===7?-6:1),g.duration=a(s,m,f,d,p,h),g}function x(s,c){const d=[];let u="",g=0,{fromDayOfWeek:o,from:E,toDayOfWeek:m,to:f,duration:p=""}=s;if(s.mode==="cron")u=s.cronExpr??"",g=(0,n.WT)((0,n.E9)(p));else{E=E===""?void 0:E,f=f===""?void 0:f;const h=i(o,E,m,f);h!=null&&(u=h.cronExpr,g=h.duration*1e3)}if(u==="")return[];try{let h=s.timezone==="browser"?void 0:s.timezone==="utc"?"Etc/UTC":s.timezone,D=new t.l4(u,{timezone:h}),C=new Date(c.from.valueOf()-g),l=c.to.valueOf(),v=D.nextRun(C);for(;v!=null;){let y=+v;if(y>l)break;d.push({from:y,to:y+g}),v=D.nextRun(v)}}catch(h){console.error(h)}return d}},8845:(q,j,e)=>{"use strict";e.d(j,{r:()=>n});let t="";const n=()=>{const a=new URLSearchParams(window.location.search).get("auth_token");return a!==null&&a!==""?(t=a,a):t}},9932:(q,j,e)=>{"use strict";e.d(j,{G:()=>L});var t=e(74848),n=e(63786),r=e(48205),a=e(96540),i=e(54594),x=e(25356),s=e(11817),c=e(22803),d=e(32370),u=e(29010),g=e(86489),o=e(60484),E=e(77222),m=e(60641),f=e(67676),p=e(29675),h=e(70462),D=e(19575),C=e(99764),l=e(34128),v=e(48583),y=e(44826);const P=({value:B,onChange:F,suggestions:I,contentTypeHeader:U=!1})=>{const W=(0,p.of)(b),A=B.find(([te,ae])=>te==="Content-Type"),[N,K]=(0,a.useState)(""),[V,T]=(0,a.useState)(""),[z,w]=(0,a.useState)("");(0,a.useEffect)(()=>{z!==""?w(z):A&&w(A[1])},[z,A]);const[H,G]=(0,a.useState)(Math.random().toString()),X=te=>{T(te)},k=te=>{K(te)},_=te=>()=>{const ae=B.filter(re=>re[0]!==te);F(ae)},ee=te=>{let ae;B?ae=B.filter(re=>re[0]!==(te?te[0]:N)):ae=[],ae.push(te??[N,V]),ae.sort((re,ne)=>re[0].localeCompare(ne[0])),F(ae),K(""),T(""),G(Math.random().toString())},J=te=>{w(te),ee(["Content-Type",te])},Z=N===""||V==="";return(0,t.jsxs)("div",{children:[(0,t.jsxs)(v.B,{direction:"row",children:[(0,t.jsx)(D.y,{value:N,onChange:k,suggestions:I,placeholder:"Key",style:{width:332}}),(0,t.jsx)(D.y,{value:V,onChange:X,suggestions:I,placeholder:"Value",style:{width:332}}),(0,t.jsx)(C.K,{"aria-label":"add",name:"plus-circle",onClick:()=>ee(),disabled:Z})]},H),(0,t.jsx)(v.B,{direction:"column",children:Array.from(B.filter(te=>te[0]!=="Content-Type")||[]).map(te=>(0,t.jsxs)(v.B,{direction:"row",children:[(0,t.jsx)(l.p,{disabled:!0,value:te[0]}),(0,t.jsx)(l.p,{disabled:!0,value:te[1]}),(0,t.jsx)(C.K,{"aria-label":"delete",onClick:_(te[0]),name:"trash-alt"})]},te[0]))}),U&&(0,t.jsx)("div",{className:W.extraHeader,children:(0,t.jsxs)(v.B,{direction:"row",children:[(0,t.jsx)(l.p,{value:"Content-Type",disabled:!0}),(0,t.jsx)(y.l6,{onChange:te=>J(te.value),options:n.Ur,value:z})]})})]})},b=B=>({extraHeader:(0,c.css)({marginTop:B.spacing(1),marginBottom:B.spacing(1),maxWidth:673})}),S=13,M=(0,a.memo)(({index:B,value:F,onChange:I,suggestions:U,showOneClick:W})=>{const A=(0,p.of)(O),N=ee=>{I(B,{...F,title:ee})},K=ee=>{I(B,{...F,confirmation:ee})},V=()=>{I(B,{...F,oneClick:!F.oneClick})},T=ee=>{I(B,{...F,fetch:{...F.fetch,url:ee}})},z=ee=>{I(B,{...F,fetch:{...F.fetch,body:ee}})},w=ee=>{I(B,{...F,fetch:{...F.fetch,method:ee}})},H=ee=>{I(B,{...F,fetch:{...F.fetch,queryParams:ee}})},G=ee=>{I(B,{...F,fetch:{...F.fetch,headers:ee}})},X=(ee="{}")=>{try{const J=JSON.parse(ee);return(0,t.jsx)(f.B,{json:J})}catch(J){return J instanceof Error?`Invalid JSON provided: ${J.message}`:"Invalid JSON provided"}},k=F.fetch.method!==n.DO.GET&&F.fetch.headers?.some(([ee,J])=>ee==="Content-Type"&&J==="application/json"),_=d.$.featureToggles.vizActions?"or action":"";return(0,t.jsxs)("div",{className:A.listItem,children:[(0,t.jsx)(g.D,{label:(0,h.t)("grafana-ui.action-editor.modal.action-title","Title"),className:A.inputField,children:(0,t.jsx)(D.y,{value:F.title,onChange:N,suggestions:U,autoFocus:F.title==="",placeholder:(0,h.t)("grafana-ui.action-editor.modal.action-title-placeholder","Action title")})}),(0,t.jsx)(g.D,{label:(0,h.t)("grafana-ui.viz-tooltip.actions-confirmation-label","Confirmation message"),description:(0,h.t)("grafana-ui.viz-tooltip.actions-confirmation-message","Provide a descriptive prompt to confirm or cancel the action."),className:A.inputField,children:(0,t.jsx)(D.y,{value:F.confirmation,onChange:K,suggestions:U,placeholder:(0,h.t)("grafana-ui.viz-tooltip.actions-confirmation-input-placeholder","Are you sure you want to {{ actionTitle }}?",{actionTitle:F.title||"... "})})}),W&&(0,t.jsx)(g.D,{label:(0,h.t)("grafana-ui.data-link-inline-editor.one-click","One click"),description:(0,h.t)("grafana-ui.action-editor.modal.one-click-description","Only one link {{ action }} can have one click enabled at a time",{action:_}),children:(0,t.jsx)(u.d,{value:F.oneClick||!1,onChange:V})}),(0,t.jsx)(E.C,{children:(0,t.jsx)(o.I,{label:(0,h.t)("grafana-ui.action-editor.modal.action-method","Method"),labelWidth:S,grow:!0,children:(0,t.jsx)(m.z,{value:F?.fetch.method,options:n.ki,onChange:w,fullWidth:!0})})}),(0,t.jsx)(E.C,{children:(0,t.jsx)(o.I,{label:"URL",labelWidth:S,grow:!0,children:(0,t.jsx)(D.y,{value:F.fetch.url,onChange:T,suggestions:U,placeholder:"URL"})})}),(0,t.jsx)(g.D,{label:(0,h.t)("grafana-ui.action-editor.modal.action-query-params","Query parameters"),className:A.fieldGap,children:(0,t.jsx)(P,{value:F?.fetch.queryParams??[],onChange:H,suggestions:U})}),(0,t.jsx)(g.D,{label:"Headers",children:(0,t.jsx)(P,{value:F?.fetch.headers??[],onChange:G,suggestions:U,contentTypeHeader:!0})}),F?.fetch.method!==n.DO.GET&&(0,t.jsx)(g.D,{label:(0,h.t)("grafana-ui.action-editor.modal.action-body","Body"),className:A.inputField,children:(0,t.jsx)(D.y,{value:F.fetch.body,onChange:z,suggestions:U,type:D.c.TextAreaElement})}),k&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),X(F?.fetch.body)]})]})}),O=B=>({listItem:(0,c.css)({marginBottom:B.spacing()}),infoText:(0,c.css)({paddingBottom:B.spacing(2),marginLeft:"66px",color:B.colors.text.secondary}),fieldGap:(0,c.css)({marginTop:B.spacing(2)}),inputField:(0,c.css)({marginRight:4})});M.displayName="ActionEditor";const R=({action:B,index:F,onSave:I,onCancel:U,getSuggestions:W,showOneClick:A})=>{const[N,K]=(0,a.useState)(B);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M,{value:N,index:F,onChange:(V,T)=>{K(T)},suggestions:W(),showOneClick:A}),(0,t.jsxs)(x.a.ButtonRow,{children:[(0,t.jsx)(i.$n,{variant:"secondary",onClick:()=>U(F),fill:"outline",children:(0,t.jsx)(s.x6,{i18nKey:"action-editor.modal.cancel-button",children:"Cancel"})}),(0,t.jsx)(i.$n,{onClick:()=>{I(F,N)},disabled:N.title.trim()===""||N.fetch.url.trim()==="",children:(0,t.jsx)(s.x6,{i18nKey:"action-editor.modal.save-button",children:"Save"})})]})]})},L=({actions:B,getSuggestions:F,showOneClick:I=!1,...U})=>(0,t.jsx)(r.J,{type:"action",items:B,...U,children:(W,A,N,K)=>(0,t.jsx)(R,{index:A,action:W??n.mx,data:U.data,onSave:N,onCancel:K,getSuggestions:F,showOneClick:I})})},8476:(q,j,e)=>{"use strict";e.d(j,{$u:()=>K,A5:()=>G,Bc:()=>X,DX:()=>F,JI:()=>L,Jc:()=>I,Kg:()=>B,MV:()=>p,N6:()=>C,P3:()=>y,Pi:()=>P,T$:()=>S,TK:()=>m,VR:()=>M,Vk:()=>T,hG:()=>D,hU:()=>W,is:()=>k,kz:()=>o,ly:()=>f,mI:()=>R,nM:()=>N,nh:()=>v,nr:()=>h,pm:()=>O,xq:()=>w,yd:()=>V});var t=e(2543),n=e.n(t),r=e(88090),a=e(32864),i=e(28082),x=e(53027),s=e(88023),c=e(87638),d=e(15084),u=e(61491),g=e(69818);function o(_){return async ee=>{try{ee((0,g.D1)(!1)),await ee(E(_)),await ee(l(_)),await ee(b(_)),s.Ay.ldapEnabled&&(0,a.a)("ldapsync")&&await ee(O()),ee((0,g.D1)(!0))}catch(J){if(console.error(J),(0,i.NF)(J)){const Z={title:J.data.message,body:J.data.error};ee((0,g.PV)(Z))}}}}function E(_){return async ee=>{const J=await(0,i.AI)().get(`/api/users/${_}`,(0,d.F)());ee((0,g.G_)(J))}}function m(_){return async ee=>{await(0,i.AI)().put(`/api/users/${_.uid}`,_),ee(o(_.uid))}}function f(_,ee){return async J=>{const Z={password:ee};await(0,i.AI)().put(`/api/admin/users/${_}/password`,Z),J(o(_))}}function p(_){return async ee=>{await(0,i.AI)().post(`/api/admin/users/${_}/disable`),x.Ny.push("/admin/users")}}function h(_){return async ee=>{await(0,i.AI)().post(`/api/admin/users/${_}/enable`),ee(o(_))}}function D(_){return async ee=>{await(0,i.AI)().delete(`/api/admin/users/${_}`),x.Ny.push("/admin/users")}}function C(_,ee){return async J=>{const Z={isGrafanaAdmin:ee};await(0,i.AI)().put(`/api/admin/users/${_}/permissions`,Z),J(o(_))}}function l(_){return async ee=>{const J=await(0,i.AI)().get(`/api/users/${_}/orgs`);ee((0,g.OF)(J))}}function v(_,ee,J){return async Z=>{const te={loginOrEmail:_.login,role:J};await(0,i.AI)().post(`/api/orgs/${ee}/users/`,te),Z(o(_.uid))}}function y(_,ee,J){return async Z=>{const te={role:J};await(0,i.AI)().patch(`/api/orgs/${ee}/users/${_}`,te),Z(o(_))}}function P(_,ee){return async J=>{await(0,i.AI)().delete(`/api/orgs/${ee}/users/${_}`),J(o(_))}}function b(_){return async ee=>{if(!c.TP.hasPermission(u.AccessControlAction.UsersAuthTokenList))return;const J=await(0,i.AI)().get(`/api/admin/users/${_}/auth-tokens`);J.reverse();const Z=J.map(te=>({id:te.id,isActive:te.isActive,seenAt:(0,r.fq)(te.seenAt),createdAt:te.createdAt,clientIp:te.clientIp,browser:te.browser,browserVersion:te.browserVersion,authModule:te.authModule,os:te.os,osVersion:te.osVersion,device:te.device}));ee((0,g.ag)(Z))}}function S(_,ee){return async J=>{const Z={authTokenId:_};await(0,i.AI)().post(`/api/admin/users/${ee}/revoke-auth-token`,Z),J(b(ee))}}function M(_){return async ee=>{await(0,i.AI)().post(`/api/admin/users/${_}/logout`),ee(b(_))}}function O(){return async _=>{const ee=c.TP.hasPermission(u.AccessControlAction.LDAPStatusRead);if((0,a.a)("ldapsync")&&ee){const J=await(0,i.AI)().get("/api/admin/ldap-sync-status");_((0,g.OR)(J))}}}function R(_,ee){return async J=>{await(0,i.AI)().post(`/api/admin/ldap/sync/${_}`),J(o(ee))}}function L(){return async _=>{if(c.TP.hasPermission(u.AccessControlAction.LDAPStatusRead))try{const ee=await(0,i.AI)().get("/api/admin/ldap/status");_((0,g.pH)(ee))}catch(ee){if((0,i.NF)(ee)){ee.isHandled=!0;const J={title:ee.data.message,body:ee.data.error};_((0,g.V$)(J))}}}}function B(_){return async ee=>{try{const J=await(0,i.AI)().get(`/api/admin/ldap/${encodeURIComponent(_)}`),{name:Z,surname:te,email:ae,login:re,isGrafanaAdmin:ne,isDisabled:ce,roles:le,teams:he}=J,oe={info:{name:Z,surname:te,email:ae,login:re},permissions:{isGrafanaAdmin:ne,isDisabled:ce},roles:le,teams:he};ee((0,g.TW)(oe))}catch(J){if((0,i.NF)(J)){J.isHandled=!0;const Z={title:J.data.message,body:J.data.error};ee((0,g.Vv)()),ee((0,g.Nf)(Z))}}}}function F(){return _=>{_((0,g.zi)())}}function I(){return _=>{_((0,g.zi)()),_((0,g.Vv)())}}const U=_=>_.map(ee=>Array.isArray(ee.value)?ee.value.map(J=>`${ee.name}=${J.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function W(){return async(_,ee)=>{try{const{perPage:J,page:Z,query:te,filters:ae,sort:re}=ee().userListAdmin;let ne=`/api/users/search?perpage=${J}&page=${Z}&query=${te}&${U(ae)}`;re&&(ne+=`&sort=${re}`);const ce=await(0,i.AI)().get(ne);_((0,g.Mb)(ce))}catch(J){(0,g.g4)(),console.error(J)}}}const A=(0,t.debounce)(_=>_(W()),500);function N(_){return async ee=>{ee((0,g.Cj)()),ee((0,g.L5)(_)),A(ee)}}function K(_){return async ee=>{ee((0,g.Cj)()),ee((0,g.jX)(_)),A(ee)}}function V(_){return async ee=>{ee((0,g.Cj)()),ee((0,g.EC)(_)),ee(W())}}function T({sortBy:_}){const ee=_.length?`${_[0].id}-${_[0].desc?"desc":"asc"}`:void 0;return async(J,Z)=>{Z().userListAdmin.sort!==ee&&(J((0,g.Cj)()),J((0,g.$u)(ee)),J(W()))}}const z=_=>_.map(ee=>Array.isArray(ee.value)?ee.value.map(J=>`${ee.name}=${J.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function w(){return async(_,ee)=>{try{const{perPage:J,page:Z,query:te,filters:ae,sort:re}=ee().userListAnonymousDevices;let ne=`/api/anonymous/search?perpage=${J}&page=${Z}&query=${te}&${z(ae)}`;re&&(ne+=`&sort=${re}`);const ce=await(0,i.AI)().get(ne);_((0,g.o3)(ce))}catch(J){console.error(J)}}}const H=(0,t.debounce)(_=>_(w()),500);function G({sortBy:_}){const ee=_.length?`${_[0].id}-${_[0].desc?"desc":"asc"}`:void 0;return async(J,Z)=>{Z().userListAnonymousDevices.sort!==ee&&(J((0,g.kh)(ee)),J(w()))}}function X(_){return async ee=>{ee((0,g.xx)(_)),H(ee)}}function k(_){return async ee=>{ee((0,g.iK)(_)),ee(w())}}},69818:(q,j,e)=>{"use strict";e.d(j,{$u:()=>R,Ay:()=>K,Cj:()=>P,D1:()=>h,EC:()=>M,G_:()=>m,L5:()=>S,Mb:()=>y,Nf:()=>d,OF:()=>f,OR:()=>c,PV:()=>D,TW:()=>u,V$:()=>s,Vv:()=>i,ag:()=>p,g4:()=>b,iK:()=>W,jX:()=>O,kh:()=>U,o3:()=>I,pH:()=>x,xx:()=>A,zi:()=>a});var t=e(65307);const n={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},r=(0,t.Z0)({name:"ldap",initialState:n,reducers:{ldapConnectionInfoLoadedAction:(V,T)=>({...V,ldapError:void 0,connectionInfo:T.payload}),ldapFailedAction:(V,T)=>({...V,ldapError:T.payload}),ldapSyncStatusLoadedAction:(V,T)=>({...V,syncInfo:T.payload}),userMappingInfoLoadedAction:(V,T)=>({...V,user:T.payload,userError:void 0}),userMappingInfoFailedAction:(V,T)=>({...V,user:void 0,userError:T.payload}),clearUserMappingInfoAction:(V,T)=>({...V,user:void 0}),clearUserErrorAction:(V,T)=>({...V,userError:void 0})}}),{clearUserErrorAction:a,clearUserMappingInfoAction:i,ldapConnectionInfoLoadedAction:x,ldapFailedAction:s,ldapSyncStatusLoadedAction:c,userMappingInfoFailedAction:d,userMappingInfoLoadedAction:u}=r.actions,g=r.reducer,o={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},E=(0,t.Z0)({name:"userAdmin",initialState:o,reducers:{userProfileLoadedAction:(V,T)=>({...V,user:T.payload}),userOrgsLoadedAction:(V,T)=>({...V,orgs:T.payload}),userSessionsLoadedAction:(V,T)=>({...V,sessions:T.payload}),userAdminPageLoadedAction:(V,T)=>({...V,isLoading:!T.payload}),userAdminPageFailedAction:(V,T)=>({...V,error:T.payload,isLoading:!1})}}),{userProfileLoadedAction:m,userOrgsLoadedAction:f,userSessionsLoadedAction:p,userAdminPageLoadedAction:h,userAdminPageFailedAction:D}=E.actions,C=E.reducer,l={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},v=(0,t.Z0)({name:"userListAdmin",initialState:l,reducers:{usersFetched:(V,T)=>{const{totalCount:z,perPage:w,...H}=T.payload,G=Math.ceil(z/w);return{...V,...H,totalPages:G,perPage:w,showPaging:G>1,isLoading:!1}},usersFetchBegin:V=>({...V,isLoading:!0}),usersFetchEnd:V=>({...V,isLoading:!1}),queryChanged:(V,T)=>({...V,query:T.payload,page:0}),pageChanged:(V,T)=>({...V,page:T.payload}),sortChanged:(V,T)=>({...V,page:0,sort:T.payload}),filterChanged:(V,T)=>{const{name:z,value:w}=T.payload;return V.filters.some(H=>H.name===z)?{...V,page:0,filters:V.filters.map(H=>H.name===z?{...H,value:w}:H)}:{...V,page:0,filters:[...V.filters,T.payload]}}}}),{usersFetched:y,usersFetchBegin:P,usersFetchEnd:b,queryChanged:S,pageChanged:M,filterChanged:O,sortChanged:R}=v.actions,L=v.reducer,B={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},F=(0,t.Z0)({name:"userListAnonymousDevices",initialState:B,reducers:{usersAnonymousDevicesFetched:(V,T)=>{const{totalCount:z,perPage:w,...H}=T.payload,G=Math.ceil(z/w);return{...V,...H,totalPages:G,perPage:w,showPaging:G>1}},anonQueryChanged:(V,T)=>({...V,query:T.payload,page:0}),anonPageChanged:(V,T)=>({...V,page:T.payload}),anonUserSortChanged:(V,T)=>({...V,page:0,sort:T.payload}),filterChanged:(V,T)=>{const{name:z,value:w}=T.payload;return V.filters.some(H=>H.name===z)?{...V,page:0,filters:V.filters.map(H=>H.name===z?{...H,value:w}:H)}:{...V,page:0,filters:[...V.filters,T.payload]}}}}),{usersAnonymousDevicesFetched:I,anonUserSortChanged:U,anonPageChanged:W,anonQueryChanged:A}=F.actions,N=F.reducer,K={ldap:g,userAdmin:C,userListAdmin:L,userListAnonymousDevices:N}},71481:(q,j,e)=>{"use strict";e.d(j,{A:()=>C,p:()=>s});var t=e(2543),n=e.n(t),r=e(6592);const a=new r.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),i=[{text:"Query",value:"query"}],x={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var s=(l=>(l.IsAbove="gt",l.IsBelow="lt",l.IsEqual="eq",l.IsNotEqual="ne",l.IsGreaterThanEqual="gte",l.IsLessThanEqual="lte",l.IsOutsideRange="outside_range",l.IsWithinRange="within_range",l.IsWithinRangeIncluded="within_range_included",l.IsOutsideRangeIncluded="outside_range_included",l.HasNoValue="no_value",l))(s||{});const c=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"eq",text:"IS EQUAL TO"},{value:"ne",text:"IS NOT EQUAL TO"},{value:"gte",text:"IS ABOVE OR EQUAL TO"},{value:"lte",text:"IS BELOW OR EQUAL TO"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"outside_range_included",text:"IS OUTSIDE RANGE INCLUDED"},{value:"within_range_included",text:"IS WITHIN RANGE INCLUDED"},{value:"no_value",text:"HAS NO VALUE"}],d=[{text:"OR",value:"or"},{text:"AND",value:"and"},{text:"LOGIC OR",value:"logic-or"}],u=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],g=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],o=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function E(l){const v=new r.tI({type:l.type,defaultParams:[]});return new r.kW(l,v)}function m(l){return l.toLowerCase().replace(/_/g,"").split(" ")[0]}function f(l){switch(m(l)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function p(l,v){return(0,t.reduce)(l,(y,P)=>(P.metric!==void 0&&P.value!==void 0&&y.push(P.metric+"="+P.value),P.Metric!==void 0&&P.Value!==void 0&&y.push(P.Metric+"="+P.Value),y),[]).join(v)}function h(l){return(0,t.isArray)(l.data)?p(l.data,", "):(0,t.isArray)(l.data.evalMatches)?p(l.data.evalMatches,", "):l.data.error?"Error: "+l.data.error:""}function D(l){return(0,t.isArray)(l)?p(l,", "):(0,t.isArray)(l.evalMatches)?p(l.evalMatches,", "):l.error?"Error: "+l.error:""}const C={alertQueryDef:a,getStateDisplayModel:f,conditionTypes:i,evalFunctions:c,evalOperators:d,noDataModes:g,executionErrorModes:o,reducerTypes:u,createReducerPart:E,getAlertAnnotationInfo:h,getAlertAnnotationText:D,alertStateSortScore:x}},6592:(q,j,e)=>{"use strict";e.d(j,{Dw:()=>x,Wn:()=>i,kW:()=>a,tI:()=>r});var t=e(2543),n=e.n(t);class r{constructor(u){this.type=u.type,this.params=u.params,this.defaultParams=u.defaultParams,this.renderer=u.renderer,this.category=u.category,this.addStrategy=u.addStrategy}}class a{constructor(u,g){if(this.part=u,this.def=g,!this.def)throw{message:"Could not find query part "+u.type};u.params=u.params||(0,t.clone)(this.def.defaultParams),this.params=u.params,this.text="",this.updateText()}render(u){return this.def.renderer(this,u)}hasMultipleParamsInString(u,g){return u.indexOf(",")===-1?!1:this.def.params[g+1]&&this.def.params[g+1].optional}updateParam(u,g){if(this.hasMultipleParamsInString(u,g)){(0,t.each)(u.split(","),(o,E)=>{this.updateParam(o.trim(),E)});return}u===""&&this.def.params[g].optional?this.params.splice(g,1):this.params[g]=u,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let u=this.def.type+"(";u+=this.params.join(", "),u+=")",this.text=u}}function i(d,u){const g=d.def.type+"(",o=(0,t.map)(d.params,(E,m)=>{const f=d.def.params[m];return f.type==="time"&&E==="auto"&&(E="$__interval"),f.quote==="single"?"'"+E+"'":f.quote==="double"?'"'+E+'"':E});return u&&o.unshift(u),g+o.join(", ")+")"}function x(d,u){return u+" "+d.params[0]}function s(d,u){return d.params[0]}function c(d,u){return'"'+d.params[0]+'"'}},83893:(q,j,e)=>{"use strict";e.d(j,{AK:()=>B,Cl:()=>T,FF:()=>f,Gn:()=>O,Hs:()=>H,IR:()=>M,KF:()=>D,Ke:()=>l,P6:()=>z,QA:()=>p,Rk:()=>S,Sn:()=>A,Sq:()=>P,U6:()=>K,U7:()=>h,Yk:()=>L,aL:()=>N,fH:()=>o,iF:()=>F,iW:()=>w,l$:()=>m,le:()=>g,nf:()=>b,t6:()=>V,vO:()=>R,vV:()=>E,zs:()=>U});var t=e(2543),n=e.n(t),r=e(3202),a=e(18729),i=e(28082),x=e(32370),s=e(56276),c=e(87638),d=e(60344);const u=7,g={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history",exportNewGrafanaRule:"exporting new Grafana rule",noAlertRuleVersionsFound:"no alert rule versions found"},{logInfo:o,logError:E,logMeasurement:m,logWarning:f}=(0,a.DW)("features.alerting",{module:"Alerting"});function p(G,X,k){return async function(..._){const ee=performance.now(),J=await X(..._),Z=performance.now()-ee;return m(G,{loadTimesMs:Z},k),J}}function h(G,X,k){return async(..._)=>{const ee=performance.now(),J=await X(..._),{namespacesCount:Z,groupsCount:te,rulesCount:ae}=C(J);return m(G,{loadTimeMs:performance.now()-ee,namespacesCount:Z,groupsCount:te,rulesCount:ae},k),J}}function D(G){Object.entries(G).forEach(([X,k])=>{const _=k.message??"unknown error",ee=String(k.type)??"unknown",J=new Error(_);E(J,{field:X,type:ee})})}function C(G){const X=G.length,k=G.flatMap(J=>J.groups).length,_=G.flatMap(J=>J.groups).flatMap(J=>J.rules).length;return{namespacesCount:X,groupsCount:k,rulesCount:_}}function l(G,X,k){return async(..._)=>{const ee=performance.now(),J=await X(..._),{namespacesCount:Z,groupsCount:te,rulesCount:ae}=v(J);return m(G,{namespacesCount:Z,groupsCount:te,rulesCount:ae,loadTimeMs:performance.now()-ee},k),J}}function v(G){const X=Object.keys(G),k=Object.values(G).flatMap(ee=>ee),_=k.flatMap(ee=>ee.rules);return{namespacesCount:X.length,groupsCount:k.length,rulesCount:_.length}}async function y(){try{const{createdAt:G}=await(0,i.AI)().get("/api/user"),X=(0,r.KQ)().subtract(u,"days"),k=(0,r.KQ)(G);return X.isBefore(k)}catch{return!0}}const P=async(G={grafana_version:x.$.buildInfo.version,org_id:c.TP.user.orgId,user_id:c.TP.user.id})=>{await y()||(0,s.rR)("grafana_alerting_navigation",G)},b=G=>{(0,s.rR)("grafana_alerting_rule_creation",G)},S=G=>{(0,s.rR)("grafana_alerting_rule_aborted",G)},M=G=>{(0,s.rR)("grafana_alerting_rule_form_error",G)},O=G=>{(0,s.rR)("grafana_alerting_grafana_rule_creation_new_success",G)},R=()=>{(0,s.rR)("grafana_alerting_grafana_rule_creation_new_aborted")},L=()=>{(0,s.rR)("grafana_alerting_grafana_rule_creation_new_error")},B=async G=>{const X={grafana_version:x.$.buildInfo.version,org_id:c.TP.user.orgId,user_id:c.TP.user.id};(0,s.rR)("grafana_alerting_insights",{...X,...G})},F=async G=>{(0,s.rR)("grafana_alerting_rule_versions_comparison_click",{...G})};function I(G){(0,s.rR)("grafana_alerting_rules_search",{...G})}function U({oldQuery:G,newQuery:X}){try{const k=(0,d.XY)(G),_=(0,d.XY)(X),ee=W(k);W(_).filter(te=>!ee.includes(te)).forEach(te=>{I({filter:te,triggeredBy:"typing"})})}catch(k){k instanceof Error&&E(k)}}function W(G){return Object.entries(G).filter(([X,k])=>!(0,t.isEmpty)(k)).map(([X])=>X)}function A(G){I({filter:G,triggeredBy:"component"})}function N(G){(0,s.rR)("grafana_alerting_rules_list_mode",{...G})}function K(){(0,s.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function V(){(0,s.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function T(){(0,s.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function z(G){(0,s.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",G)}function w(){(0,s.rR)("grafana_alerting_central_alert_state_history_expand_row")}function H(G){(0,s.rR)("grafana_alerting_central_alert_state_history_max_events_reached",G)}},48675:(q,j,e)=>{"use strict";e.r(j),e.d(j,{default:()=>h,defaultPageNav:()=>f});var t=e(74848),n=e(96540),r=e(54148),a=e(28082),i=e(37e3),x=e(22961),s=e(32174),c=e(68521),d=e(78032),u=e(8276),g=e(85651),o=e(68639),E=e(37104);const m=()=>{const D=(0,r.g)(),C=(0,o.uE)(D),[l]=(0,d.P5)(),y=l===d.gQ.Instances?void 0:0,P=(0,n.useMemo)(()=>{if(!C)throw new Error("Rule ID is required");return(0,o.qg)(C,!0)},[C]),{loading:b,error:S,result:M}=(0,u.ZU)({ruleIdentifier:P,limitAlerts:y});return S?(0,t.jsx)(s.d,{pageNav:f,navId:"alert-list",children:(0,t.jsx)(p,{error:S})}):b?(0,t.jsx)(s.d,{pageNav:f,navId:"alert-list",isLoading:!0,children:(0,t.jsx)(t.Fragment,{})}):M?(0,t.jsx)(c.K,{identifier:P,rule:M,children:(0,t.jsx)(d.Ay,{})}):(0,t.jsx)(s.d,{pageNav:f,navId:"alert-list",children:(0,t.jsx)(x.L,{entity:"Rule"})})},f={id:"alert-rule-view",text:""};function p({error:D}){return(0,a.NF)(D)&&D.status===404?(0,t.jsx)(x.L,{entity:"Rule"}):(0,t.jsx)(i.F,{title:"Something went wrong loading the rule",children:(0,g.JZ)(D)})}const h=(0,E.S)(m)},5240:(q,j,e)=>{"use strict";e.d(j,{hK:()=>m});var t=e(2543),n=e.n(t),r=e(11817),a=e(88214),i=e(70584),x=e(82700),s=e(79120),c=e(27106),d=e(76204),u=e(37398);const g="/api/v1/rule/test/grafana",o="api/prometheus/grafana/api/v1/rules";var E=(f=>(f.RuleGroup="rule_group",f.Namespace="file",f.FolderUID="folder_uid",f.LimitAlerts="limit_alerts",f))(E||{});const m=s.H.injectEndpoints({endpoints:f=>({preview:f.mutation({query:({alertQueries:p,condition:h,customLabels:D,folder:C,alertName:l,alertUid:v})=>({url:g,data:{rule:{grafana_alert:{data:p,condition:h,no_data_state:"Alerting",title:l,uid:v??"N/A"},for:"0s",labels:(0,i.x4)(D),annotations:{}},folderUid:C.uid,folderTitle:C.title},method:"POST"})}),prometheusRulesByNamespace:f.query({query:({limitAlerts:p,identifier:h,filter:D,state:C,matcher:l})=>{const v=new URLSearchParams;p&&v.set("limit_alerts",String(p)),h&&((0,x.Mj)(h)||(0,x.X4)(h))&&(v.set("file",h.namespace),v.set("rule_group",h.groupName));const P={...(0,d.ou)(D),...Object.fromEntries(v)};return{url:o,params:(0,d.Dj)(P,C,l)}},transformResponse:p=>(0,d.lH)(p.data.groups,a.hY)}),prometheusRuleNamespaces:f.query({query:({ruleSourceName:p,namespace:h,groupName:D,ruleName:C,dashboardUid:l,panelId:v,limitAlerts:y,maxGroups:P,excludeAlerts:b})=>{const S={rule_group:D,rule_name:C,dashboard_uid:l,panel_id:v?.toString()};return h&&((0,a.z2)(p)?(0,t.set)(S,"folder_uid",h):(0,t.set)(S,"file",h)),y!==void 0&&(0,t.set)(S,"limit_alerts",String(y)),P&&(0,t.set)(S,"max_groups",P),b&&(0,t.set)(S,"exclude_alerts","true"),{url:`api/prometheus/${(0,a.w5)(p)}/api/v1/rules`,params:S}},transformResponse:(p,h,D)=>(0,d.lH)(p.data.groups,D.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:f.query({query:({rulerConfig:p,filter:h})=>{const{path:D,params:C}=(0,u.$o)(p).rules(h);return{url:D,params:C}},providesTags:["CombinedAlertRule"]}),rulerNamespace:f.query({query:({rulerConfig:p,namespace:h})=>{const{path:D,params:C}=(0,u.$o)(p).namespace(h);return{url:D,params:C}},providesTags:(p,h,{namespace:D})=>[{type:"RuleNamespace",id:D}]}),getRuleGroupForNamespace:f.query({query:({rulerConfig:p,namespace:h,group:D,notificationOptions:C})=>{const{path:l,params:v}=(0,u.$o)(p).namespaceGroup(h,D);return{url:l,params:v,notificationOptions:C}},providesTags:(p,h,{namespace:D,group:C,rulerConfig:l})=>[{type:"RuleGroup",id:`${l.dataSourceUid}/${D}/${C}`},{type:"RuleNamespace",id:`${l.dataSourceUid}/${D}`}]}),getGrafanaRulerGroup:f.query({query:({namespace:p,groupName:h})=>{const{path:D,params:C}=(0,u.$o)(c.b).namespaceGroup(p.uid,h);return{url:D,params:C}},providesTags:(p,h,{namespace:D,groupName:C})=>[{type:"RuleGroup",id:`grafana/${D.uid}/${C}`},{type:"RuleNamespace",id:`grafana/${D.uid}`}]}),deleteRuleGroupFromNamespace:f.mutation({query:({rulerConfig:p,namespace:h,group:D,notificationOptions:C})=>{const l=(0,r.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:v,params:y}=(0,u.$o)(p).namespaceGroup(h,D);return{url:v,params:y,method:"DELETE",notificationOptions:{successMessage:l,...C}}},invalidatesTags:(p,h,{namespace:D,group:C,rulerConfig:l})=>[{type:"RuleGroup",id:`${l.dataSourceUid}/${D}/${C}`},{type:"RuleNamespace",id:`${l.dataSourceUid}/${D}`}]}),upsertRuleGroupForNamespace:f.mutation({query:({payload:p,namespace:h,rulerConfig:D,notificationOptions:C})=>{const{path:l,params:v}=(0,u.$o)(D).namespace(h),y=(0,r.t)("alerting.rule-groups.update.success","Successfully updated rule group");return{url:l,params:v,data:p,method:"POST",notificationOptions:{successMessage:y,...C}}},invalidatesTags:(p,h,{namespace:D,payload:C,rulerConfig:l})=>{const v=C.rules.filter(y=>(0,x.lT)(y));return[{type:"RuleNamespace",id:`${l.dataSourceUid}/${D}`},{type:"RuleGroup",id:`${l.dataSourceUid}/${D}/${C.name}`},...v.flatMap(y=>[{type:"GrafanaRulerRule",id:y.grafana_alert.uid},{type:"GrafanaRulerRuleVersion",id:y.grafana_alert.uid}])]}}),getAlertRule:f.query({query:({uid:p})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${p}`}),providesTags:(p,h,{uid:D})=>[{type:"GrafanaRulerRule",id:D}]}),getAlertVersionHistory:f.query({query:({uid:p})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${p}/versions`}),providesTags:(p,h,{uid:D})=>[{type:"GrafanaRulerRuleVersion",id:D}]}),exportRules:f.query({query:({format:p,folderUid:h,group:D,ruleUid:C})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:p,folderUid:h,group:D,ruleUid:C},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:f.query({query:({receiverName:p,decrypt:h,format:D})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:D,decrypt:h,name:p},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:f.query({query:({decrypt:p,format:h})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:h,decrypt:p},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:f.query({query:({format:p})=>({url:"/api/v1/provisioning/policies/export/",params:{format:p},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:f.mutation({query:({payload:p,format:h,nameSpaceUID:D})=>({url:`/api/ruler/grafana/api/v1/rules/${D}/export/`,params:{format:h},responseType:"text",data:p,method:"POST"})}),exportMuteTimings:f.query({query:({format:p})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:p},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:f.query({query:({format:p,muteTiming:h})=>({url:`/api/v1/provisioning/mute-timings/${h}/export/`,params:{format:p},responseType:"text"}),keepUnusedDataFor:0})})})},66150:(q,j,e)=>{"use strict";e.d(j,{F:()=>a});var t=e(52718),n=e(22492),r=e(79120);const a=r.H.injectEndpoints({endpoints:i=>({getSilences:i.query({query:({datasourceUid:x,ruleMetadata:s,accessControl:c})=>({url:`/api/alertmanager/${x}/api/v2/silences`,params:{ruleMetadata:s,accesscontrol:c}}),providesTags:x=>x?[...x.map(({id:s})=>({type:"AlertmanagerSilences",id:s})),{type:"AlertmanagerSilences"}]:[{type:"AlertmanagerSilences"}]}),getSilence:i.query({query:({datasourceUid:x,id:s,ruleMetadata:c,accessControl:d})=>({url:`/api/alertmanager/${x}/api/v2/silence/${s}`,showErrorAlert:!1,params:{ruleMetadata:c,accesscontrol:d}}),providesTags:(x,s,{id:c})=>x?[{type:"AlertmanagerSilences",id:c}]:["AlertmanagerSilences"]}),createSilence:i.mutation({query:({datasourceUid:x,payload:s})=>({url:`/api/alertmanager/${x}/api/v2/silences`,method:"POST",data:s}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(x,{queryFulfilled:s})=>{try{await s,n.A.emit(t.r1.alertSuccess,["Silence created"])}catch{n.A.emit(t.r1.alertError,["Could not create silence"])}}}),expireSilence:i.mutation({query:({datasourceUid:x,silenceId:s})=>({url:`/api/alertmanager/${x}/api/v2/silence/${s}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},79120:(q,j,e)=>{"use strict";e.d(j,{H:()=>g});var t=e(75816),n=e(10378),r=e(2543),a=e.n(r),i=e(75505),x=e(52718),s=e(28082),c=e(22492),d=e(83893);const u=()=>async({body:o,notificationOptions:E={},...m},f,p)=>{const{errorMessage:h,showErrorAlert:D,successMessage:C,showSuccessAlert:l}=E,{hideErrorMessage:v}=p||{};try{const y={...m,...o&&{data:o},...C&&{showSuccessAlert:!1},...(h||v)&&{showErrorAlert:!1}},P=performance.now(),{data:b,...S}=await(0,i.s)((0,s.AI)().fetch(y));return(0,d.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-P},{url:m.url,method:m.method??"GET",responseStatus:S.statusText}),C&&l!==!1&&c.A.emit(x.r1.alertSuccess,[C]),{data:b,meta:S}}catch(y){return h&&D!==!1&&c.A.emit(x.r1.alertError,[h]),{error:y}}},g=(0,t.xP)({reducerPath:"alertingApi",baseQuery:u(),serializeQueryArgs:o=>(0,n.lE)((0,r.omit)(o,"queryArgs.notificationOptions")),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaRulerRuleVersion","GrafanaSlo","RuleGroup","RuleNamespace","ContactPoint","ContactPointsStatus","Receiver"],endpoints:()=>({})})},51885:(q,j,e)=>{"use strict";e.d(j,{By:()=>u,VO:()=>d,WS:()=>i,f4:()=>c,nd:()=>s,vk:()=>x});var t=e(75505),n=e(8392),r=e(28082),a=e(88214);async function i(f){try{const p=await(0,t.s)((0,r.AI)().fetch({url:`/api/alertmanager/${(0,a.w5)(f)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:p.data.template_files??{},template_file_provenances:p.data.template_file_provenances??{},alertmanager_config:p.data.alertmanager_config??{},last_applied:p.data.last_applied,id:p.data.id}}catch(p){if(f===a.hY&&(0,r.NF)(p)&&p.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw p}}async function x(f,p){await(0,t.s)((0,r.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,a.w5)(f)}/config/api/v1/alerts`,data:p,showErrorAlert:!1,showSuccessAlert:!1}))}async function s(f){await(0,t.s)((0,r.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,a.w5)(f)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function c(f){return(await(0,t.s)((0,r.AI)().fetch({url:`/api/alertmanager/${(0,a.w5)(f)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function d(f){return(await(0,t.s)((0,r.AI)().fetch({url:`/api/alertmanager/${(0,a.w5)(f)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function u(f,p,h){const D={receivers:p,alert:h};try{const C=await(0,t.s)((0,r.AI)().fetch({method:"POST",data:D,url:`/api/alertmanager/${(0,a.w5)(f)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(g(C.data))throw new Error(m(C.data))}catch(C){throw(0,r.NF)(C)&&o(C.data)&&g(C.data)?new Error(m(C.data)):C}}function g(f){return f.receivers.some(p=>p.grafana_managed_receiver_configs.some(h=>h.status==="failed"))}function o(f){return(0,n.Gv)(f)&&"receivers"in f&&Array.isArray(f.receivers)?f.receivers.every(E):!1}function E(f){return(0,n.Gv)(f)&&"name"in f&&typeof f.name=="string"&&"grafana_managed_receiver_configs"in f&&Array.isArray(f.grafana_managed_receiver_configs)}function m(f){return f.receivers.flatMap(p=>p.grafana_managed_receiver_configs.filter(h=>h.status==="failed").map(h=>h.error??"Unknown error.")).join("; ")}},9365:(q,j,e)=>{"use strict";e.d(j,{m:()=>p});var t=e(2543),n=e.n(t),r=e(55936),a=e(83394),i=e(83893),x=e(1814),s=e(88214),c=e(85651),d=e(4013),u=e(79120),g=e(51885),o=e(27106);const E=30,m=30*1e3,f=["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","ContactPoint","ContactPointsStatus","Receiver"],p=u.H.injectEndpoints({endpoints:h=>({getAlertmanagerAlerts:h.query({query:({amSourceName:D,filter:C,showErrorAlert:l=!0})=>{const v=C?.matchers?.filter(R=>R.name&&R.value).map(R=>(0,r.b2)((0,x.MU)(R))),{silenced:y,inhibited:P,unprocessed:b,active:S}=C||{},M=Object.fromEntries(Object.entries({silenced:y,active:S,inhibited:P,unprocessed:b}).filter(([R,L])=>L!==void 0)),O={filter:v};return M&&Object.keys(M).forEach(R=>{O[R]=M[R]}),{url:`/api/alertmanager/${(0,s.w5)(D)}/api/v2/alerts`,params:O,showErrorAlert:l}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:h.query({query:({amSourceName:D})=>({url:`/api/alertmanager/${(0,s.w5)(D)}/api/v2/alerts/groups`})}),grafanaNotifiers:h.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:h.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:h.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:h.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:D=>D.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:h.mutation({query:D=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:D,showSuccessAlert:!1}),invalidatesTags:[...f]}),getAlertmanagerConfigurationHistory:h.query({query:()=>({url:`/api/alertmanager/${(0,s.w5)(s.hY)}/config/history`,params:{limit:E}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:h.mutation({query:D=>({url:`/api/alertmanager/${(0,s.w5)(s.hY)}/config/history/${D.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:h.query({queryFn:async D=>{const C=D===s.hY;if((0,s.AL)(D))return(0,d.$I)((0,g.VO)(D).then(M=>({data:{alertmanager_config:M.config,template_files:{}}})));const{data:v}=await(0,a.JD)(o.L.endpoints.discoverAmFeatures.initiate({amSourceName:D})),y={alertmanager_config:{},template_files:{},template_file_provenances:{}},P=v?.lazyConfigInit??!1,b=(0,i.QA)("unifiedalerting/fetchAmConfig",g.WS,{dataSourceName:D,thunk:"unifiedalerting/fetchAmConfig"}),S=(0,c.i9)(()=>b(D),M=>!!(0,d.CZ)(M)?.includes("alertmanager storage object not found")&&!P,m).then(M=>C?M:(0,t.isEmpty)(M.alertmanager_config)&&(0,t.isEmpty)(M.template_files)?(0,g.VO)(D).then(R=>({alertmanager_config:R.config,template_files:{},template_file_provenances:M.template_file_provenances,last_applied:M.last_applied,id:M.id})):M).then(M=>M??y).then(M=>({data:M})).catch(M=>{if(P&&(0,d.CZ)(M)?.includes("alertmanager storage object not found"))return{data:y};throw M});return(0,d.$I)(S).catch(M=>({error:M,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:h.mutation({query:({selectedAlertmanager:D,config:C})=>({url:`/api/alertmanager/${(0,s.w5)(D)}/config/api/v1/alerts`,method:"POST",data:C,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"]}),getContactPointsStatus:h.query({query:()=>({url:`/api/alertmanager/${(0,s.w5)(s.hY)}/config/api/v1/receivers`}),transformResponse:D=>{const C=l=>l.startsWith("0001-01-01");return D.map(l=>({...l,integrations:l.integrations.map(v=>{const y=C(v.lastNotifyAttempt);return{...v,lastNotifyAttempt:y?"":v.lastNotifyAttempt,lastNotifyAttemptDuration:y?"":v.lastNotifyAttemptDuration}})}))},providesTags:["ContactPointsStatus"]}),getContactPointsList:h.query({query:()=>({url:"/api/v1/notifications/receivers"}),providesTags:["ContactPoint"]}),getMuteTimingList:h.query({query:()=>({url:"/api/v1/notifications/time-intervals"}),providesTags:["AlertmanagerConfiguration"]})})})},8562:(q,j,e)=>{"use strict";e.d(j,{O5:()=>g,_y:()=>u,cc:()=>c});var t=e(75505),n=e(28082),r=e(51876),a=e(83466),i=e(88214),x=e(76204),s=e(37398);async function c(h){if(h===i.hY)return{application:"grafana",features:{rulerApiEnabled:!0}};const D=(0,i.of)(h);if(!D)throw new Error(`Cannot find data source configuration for ${h}`);const{url:C,name:l,type:v}=D;if(!C)throw new Error("The data source url cannot be empty.");if(v!=="prometheus"&&v!=="loki")throw new Error(`The build info request is not available for ${v}. Only 'prometheus' and 'loki' are supported`);return d({name:l,url:C,type:v})}async function d(h){const{url:D,name:C,type:l}=h,v=l==="loki"?void 0:await E(D);if(!(v!==void 0)){if(!await m(C))throw new Error(`Unable to fetch alert rules. Is the ${C} data source properly configured?`);const S=await f(C);return{application:l==="loki"?"Loki":r.N1.Cortex,features:{rulerApiEnabled:S}}}const{features:P}=v.data;return P?{application:r.N1.Mimir,features:{rulerApiEnabled:P?.ruler_config_api==="true"}}:{application:r.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function u(h){if(h===i.hY)return{lazyConfigInit:!1};const D=o(h),{url:C,type:l}=D;if(!C)throw new Error("The data source url cannot be empty.");if(l!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${l}. Only 'alertmanager' type is supported`);return await g(C)}async function g(h){try{return{lazyConfigInit:(await E(h))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function o(h){const D=(0,i.oh)(h);if(!D)throw new Error(`Cannot find data source configuration for ${h}`);return D}async function E(h){return(await(0,t.s)((0,n.AI)().fetch({url:`${h}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(C=>{if(!("status"in C&&C.status===404))throw C}))?.data}async function m(h){try{return await(0,x.sA)(h),!0}catch{return!1}}async function f(h){try{return await(0,s.Zp)(h),!0}catch(D){if(p(D))return!1;throw D}}function p(h){return(0,n.NF)(h)?h.data.message?.includes("GetRuleGroup unsupported in rule local store")||h.data.message?.includes("page not found")||h.data.message?.includes(a.UU):h instanceof Error&&h.message?.includes("404 from rules config endpoint")}},27106:(q,j,e)=>{"use strict";e.d(j,{L:()=>s,b:()=>x});var t=e(35004),n=e(51876),r=e(88214),a=e(79120),i=e(8562);const x={dataSourceName:"grafana",dataSourceUid:"grafana",apiVersion:"legacy"},s=a.H.injectEndpoints({endpoints:c=>({discoverAmFeatures:c.query({queryFn:async({amSourceName:d})=>{try{return{data:await(0,i._y)(d)}}catch(u){return{error:u}}}}),discoverDsFeatures:c.query({queryFn:async d=>{const u=(0,r.Iz)(d);if(!u)return{error:new Error(`Unable to find data source for ${d}`)};if(u===t.l$)return{data:{name:r.hY,uid:r.hY,application:"grafana",rulerConfig:x}};const g=u?(0,r.of)(u):void 0;if(!g)return{error:new Error(`Missing data source configuration for ${d}`)};const o=await(0,i.cc)(g.uid),E=o.features.rulerApiEnabled?{dataSourceName:g.name,dataSourceUid:g.uid,apiVersion:o.application===n.N1.Cortex?"legacy":"config"}:void 0;return{data:{name:g.name,uid:g.uid,application:o.application,rulerConfig:E}}}})})})},65333:(q,j,e)=>{"use strict";e.d(j,{Pc:()=>i,WG:()=>s,uz:()=>u});var t=e(28082),n=e(94736),r=e(19165),a=e(79120);const i="grafana_alerting_v2";function x(g){return`/api/plugins/${(0,r.BO)()}/resources${g}`}const s=a.H.injectEndpoints({endpoints:g=>({grafanaOnCallIntegrations:g.query({query:()=>({url:x("/alert_receive_channels/"),params:{filters:!0,integration:[n.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:o=>c(o)?o.results:o,providesTags:["OnCallIntegrations"]}),validateIntegrationName:g.query({query:o=>({url:x("/alert_receive_channels/validate_name/"),params:{verbal_name:o},showErrorAlert:!1})}),createIntegration:g.mutation({query:o=>({url:x("/alert_receive_channels/"),data:o,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:g.query({query:()=>({url:x("/features/"),showErrorAlert:!1})}),onCallConfigChecks:g.query({query:()=>({url:x("/organization/config-checks/"),showErrorAlert:!1})})})});function c(g){return"results"in g&&Array.isArray(g.results)}const{useGrafanaOnCallIntegrationsQuery:d}=s;function u(g){return(0,t.NF)(g)&&"detail"in g.data}},76204:(q,j,e)=>{"use strict";e.d(j,{Dj:()=>u,JY:()=>g,Kw:()=>E,lH:()=>o,ou:()=>d,sA:()=>f});var t=e(1932),n=e(75505),r=e(28082),a=e(83893),i=e(51876),x=e(88214),s=e(82700);function c(p){const{dataSourceName:h,limitAlerts:D,identifier:C}=p;return{rules:(l,v,y)=>{const P=new URLSearchParams;h===x.hY&&D&&P.set("limit_alerts",String(D)),C&&((0,s.Mj)(C)||(0,s.X4)(C))&&(P.set("file",C.namespace),P.set("rule_group",C.groupName));const S={...d(l),...Object.fromEntries(P)};return{url:`/api/prometheus/${(0,x.w5)(h)}/api/v1/rules`,params:u(S,v,y)}}}}function d(p){const h={};return p?.dashboardUID&&(h.dashboard_uid=p.dashboardUID,p?.panelId&&(h.panel_id=String(p.panelId))),h}function u(p,h,D){let C={...p};if(h?.length&&(C={...C,state:h}),D?.length){const l=D.map(v=>JSON.stringify(v));C={...C,matcher:l}}return C}function g(p){return(0,t.jM)(p,h=>{h.rules.forEach(D=>{D.query=D.query||"",D.type===i.JS.Alerting&&(D.state||((0,a.fH)("prom rule with type=alerting is missing a state",{ruleName:D.name}),D.state=i.cF.Inactive))})})}const o=(p,h)=>{const D=p.map(g),C={};return D.forEach(l=>{C[l.file]?C[l.file].groups.push(l):C[l.file]={dataSourceName:h,name:l.file,groups:[l]}}),Object.values(C)},E=(p=[])=>p?.flatMap(h=>h.groups.flatMap(D=>m(D,h.name)));function m(p,h){return{name:p.name,file:h,rules:p.rules,interval:p.interval}}async function f(p,h,D,C,l,v){if(h?.dashboardUID&&p!==x.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:y,params:P}=c({dataSourceName:p,limitAlerts:D,identifier:v}).rules(h,l,C),b=await(0,n.s)((0,r.AI)().fetch({url:y,params:P,showErrorAlert:!1,showSuccessAlert:!1})).catch(S=>{throw"status"in S&&S.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):S});return o(b.data.data.groups,p)}},37398:(q,j,e)=>{"use strict";e.d(j,{$o:()=>u,HO:()=>p,Zp:()=>f,iy:()=>E});var t=e(75505),n=e(8392),r=e(28082),a=e(34001),i=e(83466),x=e(88214),s=e(76204);const c="QUERY_NAMESPACE",d="QUERY_GROUP";function u(v){const y=o(v),P=g(v),b=v.apiVersion==="legacy"?"cortex":"mimir";return{rules:S=>({path:y,params:{subtype:b,...(0,s.ou)(S)}}),namespace:S=>{const{namespace:M,searchParams:O}=P.namespace(S);return{path:`${y}/${encodeURIComponent(M)}`,params:{subtype:b,...O}}},namespaceGroup:(S,M)=>{if(!S)throw new Error("Namespace UID is required to fetch ruler group");if(!M)throw new Error("Group name is required to fetch ruler group");const{namespace:O,searchParams:R}=P.namespace(S),{group:L,searchParams:B}=P.group(M);return{path:`${y}/${encodeURIComponent(O)}/${encodeURIComponent(L)}`,params:{subtype:b,...R,...B}}}}}function g(v){const y=v.dataSourceName===x.hY,P=b=>(0,a.Cl)(b)===!0?{group:d,searchParams:{group:b}}:{group:b,searchParams:{}};return y?{namespace:b=>({namespace:b,searchParams:{}}),group:P}:{namespace:b=>(0,a.Cl)(b)===!0?{namespace:c,searchParams:{namespace:b}}:{namespace:b,searchParams:{}},group:P}}function o(v){return`${`/api/ruler/${v.dataSourceUid}`}/api/v1/rules`}async function E(v,y){if(y?.dashboardUID&&v.dataSourceName!==x.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:P,params:b}=u(v).rules(y);return h(P,{},b)}async function m(v,y){const{path:P,params:b}=u(v).namespace(y);return(await h(P,{},b))[y]||[]}async function f(v){return h(`/api/ruler/${(0,x.w5)(v)}/api/v1/rules/test/test`,null)}async function p(v,y,P){const{path:b,params:S}=u(v).namespaceGroup(y,P);return h(b,null,S)}async function h(v,y,P){try{return(await(0,t.s)((0,r.AI)().fetch({url:v,showErrorAlert:!1,showSuccessAlert:!1,params:P}))).data}catch(b){if(!D(b))throw b;if(l(b))return y;throw C(b)?{...b,data:{...b.data,message:i.UU}}:b}}function D(v){if(!(0,n.Gv)(v))return!1;const y="data"in v&&v.data!==null&&v.data!==void 0;return"status"in v&&Number.isFinite(v.status)&&y}function C(v){return v.status===404||v.status===500&&v.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function l(v){return v.status===404&&(v.data.message?.includes("group does not exist")||v.data.message?.includes("no rule groups found"))}},75764:(q,j,e)=>{"use strict";e.d(j,{E:()=>r,R:()=>n});var t=e(28082);function n(a){if(r(a))return null;throw a}function r(a){return(0,t.NF)(a)&&a.status===404}},3429:(q,j,e)=>{"use strict";e.d(j,{m:()=>m});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(55127),x=e.n(i),s=e(96540),c=e(29675),d=e(54594),u=e(27671),g=e(11817),o=e(70584),E=e(36692);const m=({labels:h,commonLabels:D={},size:C,onClick:l})=>{const v=(0,c.of)(p,C),[y,P]=(0,s.useState)(!1),b=(0,r.chain)(h).toPairs().reject(o.w0).reject(([R])=>y?!1:R in D).value(),S=Object.keys(D).length,M=S>0,O=(0,g.t)("alert-labels.button.show.tooltip","Show common labels");return(0,t.jsxs)("div",{className:v.wrapper,role:"list","aria-label":"Labels",children:[b.map(([R,L])=>(0,t.jsx)(E.J,{size:C,label:R,value:L,color:f(R),onClick:l},R+L)),!y&&M&&(0,t.jsxs)(d.$n,{variant:"secondary",fill:"text",onClick:()=>P(!0),tooltip:O,tooltipPlacement:"top",size:"sm",children:["+",S," common ",x()("label",S)]}),y&&M&&(0,t.jsx)(d.$n,{variant:"secondary",fill:"text",onClick:()=>P(!1),tooltipPlacement:"top",size:"sm",children:(0,t.jsx)(g.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function f(h){return(0,u.MC)(h).color}const p=(h,D)=>({wrapper:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:D==="md"?h.spacing():h.spacing(.5)})})},32174:(q,j,e)=>{"use strict";e.d(j,{d:()=>l,y:()=>v});var t=e(74848),n=e(87586),r=e(54122),a=e(13005),i=e(22803),x=e(96540),s=e(29675),c=e(60484),d=e(44826),u=e(77299),g=e(88214);function o(b){return b.name===g.hY?"Grafana":b.name}const E=({disabled:b=!1})=>{const S=(0,s.of)(m),{selectedAlertmanager:M,availableAlertManagers:O,setSelectedAlertmanager:R}=(0,a.VI)(),L=(0,x.useMemo)(()=>O.map(I=>({label:o(I),value:I.name,imgUrl:I.imgUrl,meta:I.meta})),[O]),B=b||L.length===1,F=B?"Alertmanager":"Choose Alertmanager";return(0,t.jsx)(c.I,{className:S.field,label:F,disabled:B,"data-testid":"alertmanager-picker",children:(0,t.jsx)(d.l6,{"aria-label":F,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:I=>{I?.value&&R(I.value)},options:L,noOptionsMessage:"No datasources found",value:M,getOptionLabel:I=>I.label,components:{Option:f}})})},m=b=>({field:(0,i.css)({margin:0})}),f=b=>(0,t.jsx)(u.o5,{...b,renderOptionLabel:({label:S})=>(0,t.jsx)("div",{style:{whiteSpace:"pre-line"},children:S})});var p=e(37e3);const h=()=>(0,t.jsx)(p.F,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."}),D=()=>(0,t.jsx)(p.F,{title:"Selected Alertmanager not found.",severity:"warning",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."}),C=({availableAlertManagers:b})=>{const S=b.length>0;return(0,t.jsx)("div",{children:S?(0,t.jsx)(D,{}):(0,t.jsx)(h,{})})},l=({children:b,isLoading:S,...M})=>(0,t.jsx)(r.Y,{...M,children:(0,t.jsx)(r.Y.Contents,{isLoading:S,children:b})}),v=({children:b,accessType:S,...M})=>{const O=y();return(0,t.jsx)(a.b9,{accessType:S,children:(0,t.jsx)(l,{...M,actions:(0,t.jsx)(E,{disabled:O}),children:(0,t.jsx)(P,{children:b})})})};function y(){const b=(0,n.A)();return["/edit","/new"].some(M=>b?.pathname?.includes(M))}const P=({children:b})=>{const{availableAlertManagers:S,selectedAlertmanager:M}=(0,a.VI)();return M?(0,t.jsx)(t.Fragment,{children:b}):(0,t.jsx)(C,{availableAlertManagers:S})}},9985:(q,j,e)=>{"use strict";e.d(j,{s:()=>g});var t=e(74848),n=e(22803),r=e(6736),a=e(29675),i=e(54731),x=e(83466),s=e(83650),c=e(5487),d=e(91768);const u=["message","description"],g=({annotationKey:m,value:f,valueLink:p})=>{const h=m,D=x.J3[h]?(0,t.jsx)(r.m,{content:m,placement:"top",theme:"info",children:(0,t.jsx)("span",{children:x.J3[h]})}):m;return(0,t.jsx)(s.X,{label:D,horizontal:!0,children:(0,t.jsx)(o,{annotationKey:m,value:f,valueLink:p})})},o=({annotationKey:m,value:f,valueLink:p})=>{const h=(0,a.of)(E),D=u.includes(m),C=f&&f.startsWith("http"),l=(0,t.jsx)(c.Y,{input:f,delimiter:["{{","}}"]});return p?(0,t.jsx)(i.Y,{href:p,external:!0,children:f}):D?(0,t.jsx)(d.L,{className:h.well,children:l}):C?(0,t.jsx)(i.Y,{href:f,external:!0,children:f}):(0,t.jsx)(t.Fragment,{children:l})},E=m=>({well:(0,n.css)({wordBreak:"break-word"})})},76966:(q,j,e)=>{"use strict";e.d(j,{A:()=>r});var t=e(96540);function n({children:a,shouldWrap:i,wrap:x},s){return i?(0,t.cloneElement)(x(a)):a}const r=(0,t.forwardRef)(n)},83650:(q,j,e)=>{"use strict";e.d(j,{X:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({className:x,label:s,horizontal:c,children:d,childrenWrapperClassName:u})=>{const g=(0,r.of)(i);return(0,t.jsxs)("div",{className:(0,n.cx)(g.field,c?g.fieldHorizontal:g.fieldVertical,x),children:[(0,t.jsx)("div",{children:s}),(0,t.jsx)("div",{className:u,children:d})]})},i=x=>({fieldHorizontal:(0,n.css)({flexDirection:"row",[x.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,n.css)({flexDirection:"column"}),field:(0,n.css)({display:"flex",margin:`${x.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:x.spacing(1),fontSize:x.typography.size.sm,fontWeight:x.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:x.colors.text.secondary}})})},50585:(q,j,e)=>{"use strict";e.d(j,{E:()=>u});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(99764),s=e(16110),c=e(99797),d=e(15686);const u=({cols:o,items:E,isExpandable:m=!1,onCollapse:f,onExpand:p,isExpanded:h,renderExpandedContent:D,testIdGenerator:C,pagination:l,paginationStyles:v,renderPrefixCell:y,renderPrefixHeader:P,footerRow:b,dataTestId:S})=>{const M=(0,i.of)(d.H);if((f||p||h)&&!(f&&p&&h))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((m||D)&&!(m&&D))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const O=(0,i.of)(g(o,m,!!P)),[R,L]=(0,r.useState)([]),B=N=>{h&&f&&p?h(N)?f(N):p(N):L(R.includes(N.id)?R.filter(K=>K!==N.id):[...R,N.id])},F=l?.itemsPerPage??E.length,{page:I,numberOfPages:U,onPageChange:W,pageItems:A}=(0,c.W)(E,1,F);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:O.container,"data-testid":S??"dynamic-table",children:[(0,t.jsxs)("div",{className:O.row,"data-testid":"header",children:[P&&P(),m&&(0,t.jsx)("div",{className:O.cell()}),o.map(N=>(0,t.jsx)("div",{className:O.cell(N.alignColumn),children:N.label},N.id))]}),A.map((N,K)=>{const V=h?h(N):R.includes(N.id);return(0,t.jsxs)("div",{className:O.row,"data-testid":C?.(N,K)??"row",children:[y&&y(N,K,E),m&&(0,t.jsx)("div",{className:(0,n.cx)(O.cell(),O.expandCell),children:(0,t.jsx)(x.K,{tooltip:`${V?"Collapse":"Expand"} row`,"data-testid":a.Tp.components.AlertRules.toggle,name:V?"angle-down":"angle-right",onClick:()=>B(N)})}),o.map(T=>(0,t.jsx)("div",{className:(0,n.cx)(O.cell(T.alignColumn),O.bodyCell,T.className),"data-column":T.label,children:T.renderCell(N,K)},`${N.id}-${T.id}`)),V&&D&&(0,t.jsx)("div",{className:O.expandedContentRow,"data-testid":a.Tp.components.AlertRules.expandedContent,children:D(N,K,E)})]},`${N.id}-${K}`)}),b&&(0,t.jsx)("div",{className:(0,n.cx)(O.row,O.footerRow),children:b})]}),l&&(0,t.jsx)(s.d,{className:(0,n.cx)(M,v),currentPage:I,numberOfPages:U,onNavigate:W,hideWhenSinglePage:!0})]})},g=(o,E,m)=>{const f=o.map(p=>p.size?typeof p.size=="number"?`${p.size}fr`:p.size:"auto");return E&&f.unshift("calc(1em + 16px)"),m&&f.unshift("0"),p=>({container:(0,n.css)({border:`1px solid ${p.colors.border.weak}`,borderRadius:p.shape.radius.default,color:p.colors.text.secondary}),row:(0,n.css)({display:"grid",gridTemplateColumns:f.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:p.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:p.colors.background.primary},[p.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${p.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:m?"none":void 0}}}),footerRow:(0,n.css)({display:"flex",padding:p.spacing(1)}),cell:h=>(0,n.css)({display:"flex",alignItems:"center",padding:p.spacing(1),justifyContent:h||"initial",[p.breakpoints.down("sm")]:{padding:`${p.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,n.css)({overflow:"hidden",[p.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:p.colors.text.primary}}}),expandCell:(0,n.css)({justifyContent:"center",[p.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,n.css)({gridColumnEnd:f.length+1,gridColumnStart:m?3:2,gridRow:2,padding:`0 ${p.spacing(3)} 0 ${p.spacing(1)}`,position:"relative",[p.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${p.colors.border.strong}`,gridRow:"auto",padding:`${p.spacing(1)} 0 0 0`}})})}},9172:(q,j,e)=>{"use strict";e.d(j,{B:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(50585);const i=({renderExpandedContent:s,...c})=>{const d=(0,r.of)(x);return(0,t.jsx)(a.E,{renderExpandedContent:s?(u,g,o)=>(0,t.jsxs)(t.Fragment,{children:[g!==o.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(d.contentGuideline,d.guideline)}),s(u,g,o)]}):void 0,renderPrefixHeader:()=>(0,t.jsx)("div",{className:d.relative,children:(0,t.jsx)("div",{className:(0,n.cx)(d.headerGuideline,d.guideline)})}),renderPrefixCell:(u,g,o)=>(0,t.jsxs)("div",{className:d.relative,children:[(0,t.jsx)("div",{className:(0,n.cx)(d.topGuideline,d.guideline)}),g!==o.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(d.bottomGuideline,d.guideline)})]}),...c})},x=s=>({relative:(0,n.css)({position:"relative",height:"100%"}),guideline:(0,n.css)({left:"-19px",borderLeft:`1px solid ${s.colors.border.weak}`,position:"absolute",[s.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,n.css)({width:"18px",borderBottom:`1px solid ${s.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,n.css)({top:"50%",bottom:0}),contentGuideline:(0,n.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,n.css)({top:"-17px",bottom:0})})},93185:(q,j,e)=>{"use strict";e.d(j,{M:()=>d});var t=e(74848),n=e(22803),r=e(29675),a=e(37e3),i=e(80187),x=e(9365),s=e(747),c=e(88214);function d({currentAlertmanager:g}){const o=(0,r.of)(u),E=g!==c.hY,[m,f]=(0,s.Ej)(s.RY.ReadConfigurationStatus),p=m&&f,{currentData:h}=x.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:E||!p});if(!(h?.alertmanagersChoice&&[i.nA.External,i.nA.All].includes(h?.alertmanagersChoice))||E)return null;const C=h.numExternalAlertmanagers>0;return h.alertmanagersChoice===i.nA.External?(0,t.jsxs)(a.F,{title:"Grafana alerts are not delivered to Grafana Alertmanager",children:["Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration will not affect delivery of your alerts.",(0,t.jsx)("div",{className:o.adminHint,children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})]}):h.alertmanagersChoice===i.nA.All&&C?(0,t.jsxs)(a.F,{title:"You have additional Alertmanagers to configure",severity:"warning",children:["Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one will not affect the others.",(0,t.jsx)("div",{className:o.adminHint,children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})]}):null}const u=g=>({adminHint:(0,n.css)({fontSize:g.typography.bodySmall.fontSize,fontWeight:g.typography.bodySmall.fontWeight})})},2178:(q,j,e)=>{"use strict";e.d(j,{B:()=>u});var t=e(74848),n=e(22803),r=e(46942),a=e.n(r),i=e(96540),x=e(29675),s=e(48583),c=e(52706),d=e(95486);const u=({children:o,header:E,content:m,footer:f,arrow:p,showAfter:h=300,wrapperClassName:D,disabled:C=!1,showOn:l="hover",...v})=>{const y=(0,i.useRef)(null),P=(0,x.of)(g);if(C)return o;const b=l==="hover",S=l==="click",M=(0,t.jsxs)(s.B,{direction:"column",gap:0,role:"tooltip",children:[E&&(0,t.jsx)("div",{className:P.card.header,children:E}),(0,t.jsx)("div",{className:P.card.body,children:m}),f&&(0,t.jsx)("div",{className:P.card.footer,children:f})]});return(0,t.jsx)(c.I,{content:M,hideAfter:100,children:(O,R,L)=>{const B={onClick:O},F={onMouseLeave:R,onMouseEnter:O},I={onBlur:R,onFocus:O};return(0,t.jsxs)(t.Fragment,{children:[y.current&&(0,t.jsx)(d.A,{...L,...v,wrapperClassName:a()(P.popover,D),referenceElement:y.current,renderArrow:p,...I,...b?F:{}}),(0,i.cloneElement)(o,{ref:y,onFocus:O,onBlur:R,tabIndex:0,...b?F:{},...S?B:{}})]})}})},g=o=>({popover:(0,n.css)({borderRadius:o.shape.radius.default,boxShadow:o.shadows.z3,background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`}),card:{body:(0,n.css)({padding:o.spacing(1)}),header:(0,n.css)({padding:o.spacing(1),background:o.colors.background.secondary,borderBottom:`solid 1px ${o.colors.border.medium}`}),footer:(0,n.css)({padding:o.spacing(.5,1),background:o.colors.background.secondary,borderTop:`solid 1px ${o.colors.border.medium}`})}})},81564:(q,j,e)=>{"use strict";e.d(j,{A:()=>i});var t=e(74848),n=e(37e3),r=e(11817);const i=()=>(0,t.jsx)(n.F,{severity:"info",title:(0,r.t)("alerting.alert.evaluation-paused","Alert evaluation currently paused"),children:(0,t.jsx)(r.x6,{i18nKey:"alerting.alert.evaluation-paused-description",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})})},36692:(q,j,e)=>{"use strict";e.d(j,{J:()=>c});var t=e(74848),n=e(22803),r=e(96540),a=e(84140),i=e(29675),x=e(48583),s=e(79784);const c=({label:u,value:g,icon:o,color:E,size:m="md",onClick:f})=>{const p=(0,i.of)(d,E,m),h=`${u}: ${g}`,D=u?.toString()??"",C=g?.toString()??"",l=(0,r.useMemo)(()=>(0,t.jsxs)(x.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,t.jsx)("div",{className:p.label,children:(0,t.jsxs)(x.B,{direction:"row",gap:.5,alignItems:"center",children:[o&&(0,t.jsx)(s.I,{name:o}),u&&(0,t.jsx)("span",{className:p.labelText,title:u.toString(),children:u??""})]})}),(0,t.jsx)("div",{className:p.value,title:g?.toString(),children:g??"-"})]}),[o,u,g,p]);return(0,t.jsx)("div",{className:p.wrapper,role:"listitem","aria-label":h,"data-testid":"label-value",children:f?(0,t.jsx)("div",{className:p.clickable,role:"button",tabIndex:0,onClick:()=>f(D,C),onKeyDown:v=>{v.key==="Enter"&&(f(D,C),v.preventDefault())},children:l},D+C):l})},d=(u,g,o)=>{const E=g??u.colors.secondary.main,m=u.isDark?(0,a.A)(E).lighten(5).toString():(0,a.A)(E).darken(5).toString(),f=u.isDark?(0,a.A)(E).darken(5).toString():(0,a.A)(E).lighten(5).toString(),p=g?a.A.mostReadable(E,["#000","#fff"]).toString():u.colors.text.primary;let h=u.spacing(.33,1);switch(o){case"sm":h=u.spacing(.2,.6);break;case"xs":h=u.spacing(0,.5);break;default:break}return{wrapper:(0,n.css)({color:p,fontSize:u.typography.bodySmall.fontSize,borderRadius:u.shape.borderRadius(2)}),labelText:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,n.css)({display:"flex",alignItems:"center",color:"inherit",padding:h,background:E,border:`solid 1px ${m}`,borderTopLeftRadius:u.shape.borderRadius(2),borderBottomLeftRadius:u.shape.borderRadius(2)}),clickable:(0,n.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,n.css)({color:"inherit",padding:h,background:f,border:`solid 1px ${m}`,borderLeft:"none",borderTopRightRadius:u.shape.borderRadius(2),borderBottomRightRadius:u.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},5127:(q,j,e)=>{"use strict";e.d(j,{A:()=>s});var t=e(74848),n=e(96540),r=e(54594),a=e(48583),i=e(79784);const s=(0,n.forwardRef)(function(d,u){return(0,t.jsx)(r.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:u,...d,children:(0,t.jsxs)(a.B,{direction:"row",alignItems:"center",gap:0,children:["More ",(0,t.jsx)(i.I,{name:"angle-down"})]})})})},28782:(q,j,e)=>{"use strict";e.d(j,{h:()=>a});var t=e(74848),n=e(51311);const r=({children:i,plugin:x,loadingComponent:s,notInstalledFallback:c})=>{const{loading:d,installed:u}=usePluginBridge(x);return d?s??null:u?jsx(Fragment,{children:i}):c??null};function a(i,x,s){const c=new URLSearchParams(s).toString();return`/a/${i}${x}`+(c?"?"+c:"")}},27219:(q,j,e)=>{"use strict";e.d(j,{Yi:()=>s,hk:()=>x,rS:()=>c});var t=e(74848),n=e(37e3),r=e(66384),a=e(6736),i=e(11817),x=(d=>(d.ContactPoint="contact point",d.Template="template",d.MuteTiming="mute timing",d.AlertRule="alert rule",d.RootNotificationPolicy="root notification policy",d))(x||{});const s=({resource:d,...u})=>(0,t.jsxs)(n.F,{title:`This ${d} cannot be edited through the UI`,severity:"info",...u,children:["This ",d," has been provisioned, that means it was created by config. Please contact your server admin to update this ",d,"."]}),c=({tooltip:d,provenance:u})=>{const g=(0,t.jsx)(r.E,{text:"Provisioned",color:"purple"});if(d){const o=(0,t.jsxs)(i.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:u},children:["This resource has been provisioned via ",{provenance:u}," and cannot be edited through the UI"]}),E=(0,t.jsx)(i.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),m=u?o:E;return(0,t.jsx)(a.m,{content:m,children:(0,t.jsx)("span",{children:g})})}return g}},33911:(q,j,e)=>{"use strict";e.d(j,{c:()=>a});var t=e(74848),n=e(45565),r=e(79784);const a=({namespace:i,group:x})=>x?(0,t.jsxs)(n.E,{element:"h3",variant:"body",children:[i," ",(0,t.jsx)(r.I,{name:"angle-right","aria-label":">"})," ",x]}):(0,t.jsx)(n.E,{element:"h3",variant:"body",children:i})},7484:(q,j,e)=>{"use strict";e.d(j,{h:()=>r});var t=e(74848),n=e(22803);const r=()=>(0,t.jsx)("span",{className:(0,n.css)({flex:1})})},22245:(q,j,e)=>{"use strict";e.d(j,{O:()=>i});var t=e(74848),n=e(22803),r=e(96540),a=e(29675);const i=(0,r.forwardRef)(({children:s,state:c,size:d="md",muted:u=!1},g)=>{const o=(0,a.of)(x);return(0,t.jsx)("span",{className:(0,n.cx)(o.common,o[c],o[d],{[o.muted]:u}),ref:g,children:s||c})});i.displayName="StateTag";const x=s=>({common:(0,n.css)({display:"inline-block",color:"white",borderRadius:s.shape.radius.default,fontSize:s.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:s.typography.fontWeightBold}),good:(0,n.css)({backgroundColor:s.colors.success.main,border:`solid 1px ${s.colors.success.main}`,color:s.colors.success.contrastText}),warning:(0,n.css)({backgroundColor:s.colors.warning.main,border:`solid 1px ${s.colors.warning.main}`,color:s.colors.warning.contrastText}),bad:(0,n.css)({backgroundColor:s.colors.error.main,border:`solid 1px ${s.colors.error.main}`,color:s.colors.error.contrastText}),neutral:(0,n.css)({backgroundColor:s.colors.secondary.main,border:`solid 1px ${s.colors.secondary.main}`,color:s.colors.secondary.contrastText}),info:(0,n.css)({backgroundColor:s.colors.primary.main,border:`solid 1px ${s.colors.primary.main}`,color:s.colors.primary.contrastText}),md:(0,n.css)({padding:s.spacing(.5,1),minWidth:s.spacing(8)}),sm:(0,n.css)({padding:s.spacing(.3,.5),minWidth:"52px"}),muted:(0,n.css)({opacity:"0.5"})})},5487:(q,j,e)=>{"use strict";e.d(j,{Y:()=>c});var t=e(74848),n=e(22803),r=e(29675),a=e(66384),i=e(2178),x=e(97671);const s=["$",".",'"'];function c({input:p,delimiter:h=["{{","}}"]}){const D=(0,r.of)(f),[C,l]=h,v=new RegExp(`(?<before>.*?)(${C}(?<token>.*?)${l}|$)`,"gm"),y=p.split(`
`),P=[];return y.forEach((b,S)=>{Array.from(b.matchAll(v)).forEach((O,R)=>{const L=O.groups?.before,B=O.groups?.token?.trim();if(L&&P.push((0,t.jsx)("span",{children:L},`${S}-${R}-before`)),B){const F=m(B),I=F==="variable"?B:"",U=`${C} ${B} ${l}`;P.push((0,t.jsx)(u,{content:U,type:F,description:I},`${S}-${R}-token`))}}),P.push((0,t.jsx)("br",{},`${S}-newline`))}),(0,t.jsx)("span",{className:D.wrapper,children:P})}var d=(p=>(p.Variable="variable",p.Function="function",p.Keyword="keyword",p.Unknown="unknown",p))(d||{});function u({content:p,description:h,type:D}){const C=(0,r.of)(f),l=!D;return(0,t.jsx)(i.B,{placement:"top-start",disabled:l,content:(0,t.jsxs)("div",{className:C.hoverTokenItem,children:[(0,t.jsx)(a.E,{tabIndex:0,text:(0,t.jsx)(t.Fragment,{children:D}),color:"blue"})," ",h&&(0,t.jsx)("code",{children:h})]}),children:(0,t.jsx)("span",{children:(0,t.jsx)(a.E,{tabIndex:0,className:C.token,text:p,color:"blue"})})})}function g(p){return s.some(h=>p.startsWith(h))}function o(p){return x.keywords.some(h=>p.startsWith(h))}function E(p){return x.builtinFunctions.some(h=>p.startsWith(h))}function m(p){let h;return g(p)?h="variable":o(p)?h="keyword":E(p)?h="function":h="unknown",h}const f=p=>({wrapper:(0,n.css)({whiteSpace:"pre-wrap"}),token:(0,n.css)({cursor:"default",fontFamily:p.typography.fontFamilyMonospace}),popover:(0,n.css)({borderRadius:p.shape.radius.default,boxShadow:p.shadows.z3,background:p.colors.background.primary,border:`1px solid ${p.colors.border.medium}`,padding:p.spacing(1)}),hoverTokenItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:p.spacing(1)})})},91768:(q,j,e)=>{"use strict";e.d(j,{L:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x,className:s})=>{const c=(0,r.of)(i);return(0,t.jsx)("div",{className:(0,n.cx)(c.wrapper,s),children:x})},i=x=>({wrapper:(0,n.css)({backgroundColor:x.components.panel.background,border:`solid 1px ${x.components.input.borderColor}`,borderRadius:x.shape.radius.default,padding:x.spacing(.5,1),fontFamily:x.typography.fontFamilyMonospace})})},72974:(q,j,e)=>{"use strict";e.d(j,{d:()=>r});var t=e(96540),n=e(51312);const r=({component:a,title:i="previous page"})=>{const x=(0,n.i)(),s=(0,t.useCallback)(()=>{x(i)},[x,i]);return(0,t.cloneElement)(a,{onClick:s})}},39498:(q,j,e)=>{"use strict";e.d(j,{X:()=>m});var t=e(74848),n=e(22803),r=e(96540),a=e(40996),i=e(29675),x=e(79784),s=e(86489),c=e(40271),d=e(48583),u=e(6736),g=e(34128),o=e(83893),E=e(55936);const m=({onFilterChange:p,defaultQueryString:h})=>{const D=(0,i.of)(f),[C,l]=(0,r.useState)(h??"");(0,a.A)(()=>{(0,o.fH)(o.le.filterByLabel),p(C)},600,[C]);const v=(0,t.jsx)(x.I,{name:"search"});let y=!!(h&&h.length>=3);try{h?(0,E.S6)(h):y=!0}catch{y=!1}return(0,t.jsx)(s.D,{className:D.fixMargin,invalid:!y,error:y?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,t.jsx)(c.J,{children:(0,t.jsxs)(d.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)("span",{children:"Search by label"}),(0,t.jsx)(u.m,{content:(0,t.jsxs)("div",{children:["Filter alerts using label querying without spaces, ex:",(0,t.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),"Invalid use of spaces:",(0,t.jsx)("pre",{children:'{severity= "critical"}'}),(0,t.jsx)("pre",{children:'{severity ="critical"}'}),"Valid use of spaces:",(0,t.jsx)("pre",{children:'{severity=" critical"}'}),"Filter alerts using label querying without braces, ex:",(0,t.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,t.jsx)(x.I,{name:"info-circle",size:"sm"})})]})}),children:(0,t.jsx)(g.p,{placeholder:"Search",value:C,onChange:P=>l(P.currentTarget.value),"data-testid":"search-query-input",prefix:v,className:D.inputWidth})})},f=p=>({fixMargin:(0,n.css)({marginBottom:0}),inputWidth:(0,n.css)({width:340,flexGrow:0})})},44862:(q,j,e)=>{"use strict";e.d(j,{MX:()=>n,sW:()=>r,v4:()=>t});const t=Symbol("receiver_status"),n=Symbol("receiver_metadata"),r=Symbol("receiver_plugin_metadata")},91495:(q,j,e)=>{"use strict";e.d(j,{PE:()=>n,w6:()=>a});var t=e(61491);const n=[t.AccessControlAction.AlertingReceiversRead],r=[t.AccessControlAction.AlertingReceiversCreate,t.AccessControlAction.AlertingReceiversWrite],a=[...n,...r]},35626:(q,j,e)=>{"use strict";e.d(j,{dK:()=>w,Kt:()=>k,$x:()=>H,om:()=>z,Z3:()=>K,Pm:()=>_,cB:()=>ee});var t=e(2543),n=e(96540),r=e(79120);const a=["Receiver"],x=r.H.enhanceEndpoints({addTagTypes:a}).injectEndpoints({endpoints:J=>({listNamespacedReceiver:J.query({query:Z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${Z.namespace}/receivers`,params:{pretty:Z.pretty,allowWatchBookmarks:Z.allowWatchBookmarks,continue:Z.continue,fieldSelector:Z.fieldSelector,labelSelector:Z.labelSelector,limit:Z.limit,resourceVersion:Z.resourceVersion,resourceVersionMatch:Z.resourceVersionMatch,sendInitialEvents:Z.sendInitialEvents,timeoutSeconds:Z.timeoutSeconds,watch:Z.watch}}),providesTags:["Receiver"]}),createNamespacedReceiver:J.mutation({query:Z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${Z.namespace}/receivers`,method:"POST",body:Z.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver,params:{pretty:Z.pretty,dryRun:Z.dryRun,fieldManager:Z.fieldManager,fieldValidation:Z.fieldValidation}}),invalidatesTags:["Receiver"]}),readNamespacedReceiver:J.query({query:Z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${Z.namespace}/receivers/${Z.name}`,params:{pretty:Z.pretty}}),providesTags:["Receiver"]}),replaceNamespacedReceiver:J.mutation({query:Z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${Z.namespace}/receivers/${Z.name}`,method:"PUT",body:Z.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver,params:{pretty:Z.pretty,dryRun:Z.dryRun,fieldManager:Z.fieldManager,fieldValidation:Z.fieldValidation}}),invalidatesTags:["Receiver"]}),deleteNamespacedReceiver:J.mutation({query:Z=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${Z.namespace}/receivers/${Z.name}`,method:"DELETE",body:Z.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:Z.pretty,dryRun:Z.dryRun,gracePeriodSeconds:Z.gracePeriodSeconds,orphanDependents:Z.orphanDependents,propagationPolicy:Z.propagationPolicy}}),invalidatesTags:["Receiver"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{createNamespacedReceiver:{invalidatesTags:["Receiver","ContactPoint","ContactPointsStatus","AlertmanagerConfiguration"]},deleteNamespacedReceiver:J=>{const Z=J.query;J.query=(...te)=>{const ae=Z(...te);return ae.headers={"content-type":"application/json"},ae}},readNamespacedReceiver:J=>{const Z={hideErrorMessage:!0};J.extraOptions=Z}}});var s=e(17209),c=e(2473),d=e(88214),u=e(13693),g=e(77855),o=e(9365),E=e(65333),m=e(25779),f=e(51311),p=e(25061),h=e(86203),D=e(19165),C=e(80681);const l=10*1e3,{useGetAlertmanagerConfigurationQuery:v,useGetContactPointsListQuery:y,useGetContactPointsStatusQuery:P,useGrafanaNotifiersQuery:b,useLazyGetAlertmanagerConfigurationQuery:S}=o.m,{useGrafanaOnCallIntegrationsQuery:M}=E.WG,{useListNamespacedReceiverQuery:O,useReadNamespacedReceiverQuery:R,useDeleteNamespacedReceiverMutation:L,useCreateNamespacedReceiverMutation:B,useReplaceNamespacedReceiverMutation:F}=x,I={refetchOnFocus:!0,refetchOnReconnect:!0},U=({skip:J}={})=>{const{installed:Z,loading:te}=(0,f._)((0,D.BO)()),ae=M(void 0,{skip:J||!Z});return(0,n.useMemo)(()=>Z?ae:{isLoading:te,data:void 0},[Z,te,ae])},W=J=>({id:J.metadata.name||J.metadata.uid||J.spec.title,name:J.spec.title,provisioned:(0,u.Uo)(J),grafana_managed_receiver_configs:J.spec.integrations,metadata:J.metadata}),A=(...[J,Z])=>O(J,{...Z,selectFromResult:te=>{const ae=te.data?.items.map(re=>W(re));return{...te,data:te.error?[]:ae,currentData:ae}}}),N=({skip:J}={})=>{const Z=(0,g.G)(),te=(0,u.dM)(d.hY),ae=y(void 0,{skip:J||te,selectFromResult:ne=>{const ce=ne.data?.map(le=>({...le,provisioned:le.grafana_managed_receiver_configs?.some(he=>he.provenance)}));return{...ne,data:ce,currentData:ce}}}),re=A({namespace:Z},{skip:J||!te});return te?re:ae},K=({fetchStatuses:J,fetchPolicies:Z,skip:te}={})=>{const ae={skip:te},re=U(ae),ne=b(void 0,ae),ce=N(ae),le=P(void 0,{...I,pollingInterval:l,skip:te||!J}),he=v(d.hY,{skip:te||!Z});return(0,n.useMemo)(()=>{if(re.isLoading||ne.isLoading||ce.isLoading)return{...ce,isLoading:!0,contactPoints:[]};const de=(0,C.Rm)({status:le.data,notifiers:ne.data,onCallIntegrations:re?.data,contactPoints:ce.data||[],alertmanagerConfiguration:he.data});return{...ce,contactPoints:de}},[ne,he,ce,le,re])},V=({alertmanager:J,name:Z},te)=>v(J,{...te,selectFromResult:ae=>{const re=ae.data?.alertmanager_config.receivers?.find(ne=>ne.name===Z);return{...ae,data:re,currentData:re}}}),T=({name:J},Z)=>{const te=(0,g.G)(),ae=(0,u.dM)(d.hY),re=R({namespace:te,name:J},{...Z,selectFromResult:ce=>{const le=ce.data?W(ce.data):void 0;return{...ce,data:le,currentData:le}},skip:Z?.skip||!ae}),ne=V({alertmanager:d.hY,name:J},{skip:Z?.skip||ae});return ae?re:ne},z=({alertmanager:J,name:Z})=>{const te=J===d.hY,ae=T({name:Z},{skip:!te}),re=V({alertmanager:J,name:Z},{skip:te});return te?ae:re};function w({alertmanager:J,fetchStatuses:Z,fetchPolicies:te,skip:ae}){const re=J===d.hY,ne=K({skip:ae||!re,fetchStatuses:Z,fetchPolicies:te}),ce=v(J,{...I,selectFromResult:le=>({...le,contactPoints:le.data?(0,C.Rm)({notifiers:c.r,contactPoints:le.data.alertmanager_config.receivers??[],alertmanagerConfiguration:le.data}):[]}),skip:ae||re});return re?ne:ce}function H({alertmanager:J}){const Z=(0,u.dM)(J),[te]=(0,p.d)(),[ae]=L(),re=(0,m.Yb)(async({name:ce,resourceVersion:le})=>{const he=(0,g.G)();await ae({name:ce,namespace:he,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{preconditions:{resourceVersion:le}}}).unwrap()}),ne=(0,m.Yb)(async({name:ce})=>{const le=(0,h.FS)(ce);return te(le)});return Z?re:ne}const G=J=>{const{secureSettings:Z,settings:te,...ae}=J,re=Object.entries(Z||{}).reduce((le,[he,oe])=>oe===void 0?{...le,[he]:!0}:le,{}),ne=Object.entries(Z||{}).reduce((le,[he,oe])=>oe?(0,t.set)(le,he,oe):le,{}),ce=(0,t.merge)({},te,ne);return{...ae,secureFields:re,settings:ce}},X=(J,Z,te)=>({metadata:{...Z&&{name:Z},resourceVersion:te},spec:{title:J.name,integrations:(J.grafana_managed_receiver_configs||[]).map(G)}}),k=({alertmanager:J})=>{const Z=J===d.hY,te=(0,u.dM)(J),{createOnCallIntegrations:ae}=(0,s.VY)(),[re]=B(),[ne]=(0,p.d)(),ce=(0,m.Yb)(async({contactPoint:he})=>{const oe=Z?await ae(he):he,de=(0,g.G)(),me=X(oe);return re({namespace:de,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver:me}).unwrap()}),le=(0,m.Yb)(async({contactPoint:he})=>{const oe=Z?await ae(he):he,de=(0,h.BD)(oe);return ne(de)});return te?ce:le},_=({alertmanager:J})=>{const Z=J===d.hY,te=(0,u.dM)(J),{createOnCallIntegrations:ae}=(0,s.VY)(),[re]=F(),[ne]=(0,p.d)();return(0,m.Yb)(async le=>{if("resourceVersion"in le&&te){const{contactPoint:he,id:oe,resourceVersion:de}=le,me=Z?await ae(he):he,Pe=(0,g.G)(),Ee=X(me,oe,de);return re({name:oe,namespace:Pe,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver:Ee}).unwrap()}else if("originalName"in le){const{contactPoint:he,originalName:oe}=le,de=Z?await ae(he):he,me=(0,h.Xm)({name:oe,receiver:de});return ne(me)}})},ee=({alertmanager:J})=>{const Z=(0,u.dM)(J),[te]=S();return Z?()=>{}:async(ae,re)=>{if(!(re&&ae===re))return te(J).unwrap().then(ne=>{const{alertmanager_config:ce}=ne;return!!ce.receivers?.find(he=>he.name===ae)?`Contact point already exists with name "${ae}"`:void 0})}}},80681:(q,j,e)=>{"use strict";e.d(j,{Rm:()=>l,aM:()=>D,T8:()=>S});var t=e(2543),n=e(32370),r=e(11817),a=e(13693),i=e(80187),x=e(86655);function s(M){return"grafana_managed_receiver_configs"in M?M.grafana_managed_receiver_configs??[]:Object.entries(M).filter(([R])=>R!=="grafana_managed_receiver_configs"&&R.endsWith("_configs")).filter(([R,L])=>Array.isArray(L)&&!(0,t.isEmpty)(L)).reduce((R,[L,B])=>{const F=L.replace("_configs",""),I=B.map(U=>({name:M.name,type:F,settings:U,disableResolveMessage:!1}));return R.concat(I)},[])}var c=e(94736),d=e(19165),u=e(28782),g=e(12602);const m={title:"Grafana OnCall",icon:g.K[(0,d.BO)()]};function f(M,O,R=!0){const L=(0,d.ZP)()?"IRM":"OnCall";if(!R||!O.settings?.url||M===void 0)return m;if(M==null)return{...m,warning:`Grafana ${L} is not installed or is disabled`};const B=M.find(F=>F.integration_url===O.settings?.url);return{...m,description:B?.display_name,externalUrl:B?(0,u.h)((0,d.BO)(),`/integrations/${B.value}`):void 0,warning:B?void 0:`${L} Integration no longer exists`}}var p=e(44862);const h="__grafana_receiver__";function D(M){if(!M.settings)return;const{settings:O}=M;switch(M.type){case"email":{const R=O.addresses||O.to;return R?C(R):void 0}case"slack":{const R=O.recipient||O.channel;return R?`#${R.replace(/^#/,"")}`:void 0}case"kafka":return O.kafkaTopic;case"webhook":return O.url;case"jira":return(0,r.t)("alerting.contact-points.receiver-summary.jira",'Creates a "{{issueType}}" issue in the "{{project}}" project',{issueType:O.issue_type,project:O.project,url:O.api_url});case c.J4.OnCall:return M[p.sW]?.description;default:return M[p.MX]?.description}}function C(M){const R=/,|;|\n+/g,L=M.trim().split(R).map(t.trim),B=(0,t.take)(L,3),F=(0,t.difference)(L,B);return F.length&&B.push(`+${F.length} more`),B.join(", ")}function l({status:M=[],notifiers:O=[],onCallIntegrations:R,contactPoints:L,alertmanagerConfiguration:B}){const F=(0,x._I)(B?.alertmanager_config?.route??{}),I=P(F),U=(0,t.groupBy)(I,"receiver");return L.map(A=>{const N=s(A),K=M.find(T=>T.name===A.name),V=v(A);return{...A,id:V,policies:B&&U&&(U[A.name]??[]),grafana_managed_receiver_configs:N.map((T,z)=>{const w=T.type===c.J4.OnCall;return{...T,[p.v4]:K?.integrations[z],[p.MX]:b(O,T),[p.sW]:w?f(R,T,!!B):void 0}})}}).sort((A,N)=>A.name.localeCompare(N.name))}function v(M){return"id"in M&&M.id?M.id:M.name}function y(M){return!(n.$.featureToggles.alertingSimplifiedRouting??!1)||!M.object_matchers?!1:M.object_matchers.some(R=>R[0]===h&&R[1]===i.ho.equal)??!1}function P(M){const O=M.routes?.flatMap(R=>P(R))??[];return M.receiver?[{receiver:M.receiver,route:{type:y(M)?"auto-generated":"normal"}},...O]:O}function b(M,O){const R=M.find(L=>L.type===O.type);return{name:R?.name??(0,t.upperFirst)(O.type),description:R?.description}}const S=(M,O)=>(0,a.dM)(M)&&(0,a.jw)(O)},79198:(q,j,e)=>{"use strict";e.d(j,{GX:()=>A,r4:()=>U});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(96540),x=e(49785),s=e(8392),c=e(16753),d=e(67555),u=e(88090),g=e(29675),o=e(37e3),E=e(48583),m=e(54594),f=e(95722),p=e(99764),h=e(45565),D=e(96080),C=e(53434),l=e(31810),v=e(22025),y=e(87919),P=e(30632),b=e(44684),S=e(51876),M=e(99797),O=e(82700),R=e(2178),L=e(7484),B=e(17025),F=e(97157),I=e(66976);const U=({queries:_=[],query:ee,data:J,error:Z,warning:te,isAlertCondition:ae,onSetCondition:re,onUpdateRefId:ne,onRemoveExpression:ce,onUpdateExpressionType:le,onChangeQuery:he})=>{const oe=(0,g.of)(k),de=ee?.type,{setError:me,clearErrors:Pe,watch:Ee}=(0,x.xW)(),be=Ee("type"),Se=be?(0,O.pq)(be):!1,Xe=(0,i.useCallback)(Ke=>{Ke?me("queries",{type:"custom",message:Ke}):Pe("queries")},[me,Pe]),Qe=J&&Object.values(J).some(Ke=>!!Ke&&Ke.state===s.Gu.Loading),we=Array.isArray(J?.series)&&!Qe,$e=J?.series??[],Fe=ae??!1,{seriesCount:Te,groupedByState:Le}=K($e),Ge=(0,i.useCallback)(Ke=>{const Ie=_.filter(Ne=>Ke.refId!==Ne.refId).map(Ne=>({value:Ne.refId,label:Ne.refId}));switch(Ke.type){case b.Tz.math:return(0,t.jsx)(C.z,{onChange:he,query:Ke,labelWidth:"auto",onRunQuery:()=>{}});case b.Tz.reduce:return(0,t.jsx)(l.Z,{onChange:he,refIds:Ie,labelWidth:"auto",app:c.Jk.UnifiedAlerting,query:Ke});case b.Tz.resample:return(0,t.jsx)(v.C,{onChange:he,query:Ke,labelWidth:"auto",refIds:Ie});case b.Tz.classic:return(0,t.jsx)(D.z,{onChange:he,query:Ke,refIds:Ie});case b.Tz.threshold:return(0,t.jsx)(P.O,{onChange:he,query:Ke,labelWidth:"auto",refIds:Ie,onError:Xe,useHysteresis:!0});case b.Tz.sql:return(0,t.jsx)(y.k,{onChange:he,query:Ke,refIds:Ie});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",Ke.type]})}},[he,_,Xe]),De=b.uQ.find(Ke=>Ke.value===de)?.description??"";return(0,t.jsx)("div",{className:(0,n.cx)(oe.expression.wrapper,Fe&&oe.expression.alertCondition,de===b.Tz.classic&&oe.expression.classic,de!==b.Tz.classic&&oe.expression.nonClassic),children:(0,t.jsxs)("div",{className:oe.expression.stack,children:[(0,t.jsx)(V,{refId:ee.refId,queryType:de,onRemoveExpression:()=>ce(ee.refId),onUpdateRefId:Ke=>ne(ee.refId,Ke),onSetCondition:re,query:ee,alertCondition:Fe}),(0,t.jsxs)("div",{className:oe.expression.body,children:[Z&&(0,t.jsx)(o.F,{title:"Expression failed",severity:"error",children:Z.message}),te&&(0,t.jsx)(o.F,{title:"Expression warning",severity:"warning",children:te.message}),(0,t.jsx)("div",{className:oe.expression.description,children:De}),Ge(ee)]}),we&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{series:$e,isAlertCondition:ae,isRecordingRule:Se}),!Se&&(0,t.jsx)("div",{className:oe.footer,children:(0,t.jsxs)(E.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)(L.h,{}),(0,t.jsx)(N,{isCondition:!!ae,firing:Le[S.cF.Firing].length,normal:Le[S.cF.Inactive].length,seriesCount:Te})]})})]})]})})},W=20,A=({series:_,isAlertCondition:ee,isRecordingRule:J=!1})=>{const{pageItems:Z,previousPage:te,nextPage:ae,numberOfPages:re,pageStart:ne,pageEnd:ce}=(0,M.W)(_,1,W),le=(0,g.of)(k),he=(0,I.PI)(_),oe=!he&&(0,d.jq)(_),de=re>1;return(0,t.jsxs)("div",{className:le.expression.results,children:[!he&&oe&&(0,t.jsx)("div",{children:Z.map((me,Pe)=>(0,t.jsx)(X,{frame:me,index:ne+Pe,isAlertCondition:ee},(0,r.uniqueId)()))}),!he&&!oe&&Z.map((me,Pe)=>(0,t.jsx)(G,{frame:me,index:ne+Pe,isAlertCondition:ee,isRecordingRule:J},(0,r.uniqueId)())),he&&(0,t.jsx)("div",{className:(0,n.cx)(le.expression.noData,le.mutedText),children:"No data"}),de&&(0,t.jsx)("div",{className:le.pagination.wrapper,"data-testid":"paginate-expression",children:(0,t.jsxs)(E.B,{children:[(0,t.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:te,icon:"angle-left",size:"sm","aria-label":"previous-page"}),(0,t.jsx)(L.h,{}),(0,t.jsxs)("span",{className:le.mutedText,children:[ne," - ",ce," of ",_.length]}),(0,t.jsx)(L.h,{}),(0,t.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:ae,icon:"angle-right",size:"sm","aria-label":"next-page"})]})})]})},N=({firing:_,normal:ee,isCondition:J,seriesCount:Z})=>{const{mutedText:te}=(0,g.of)(k);return Z===0?(0,t.jsx)("span",{className:te,children:"No series"}):J?(0,t.jsx)("span",{className:te,children:`${Z} series: ${_} firing, ${ee} normal`}):(0,t.jsx)("span",{className:te,children:`${Z} series`})};function K(_){const ee=_.filter(te=>(0,I.Lm)(te)===void 0).length,J={[S.cF.Firing]:_.filter(te=>(0,I.Lm)(te)!==void 0&&(0,I.Lm)(te)!==0),[S.cF.Inactive]:_.filter(te=>(0,I.Lm)(te)===0)},Z=_.length-ee;return{groupedByState:J,seriesCount:Z}}const V=({refId:_,queryType:ee,onUpdateRefId:J,onRemoveExpression:Z,onSetCondition:te,alertCondition:ae,query:re})=>{const ne=(0,g.of)(k),ce=(0,g.of)(m.my),[le,he]=(0,i.useState)(!1),de=le!==!1&&le==="refId";return(0,t.jsx)("header",{className:ne.header.wrapper,children:(0,t.jsxs)(E.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,t.jsxs)(E.B,{direction:"row",gap:1,alignItems:"center",children:[!de&&(0,t.jsx)("button",{type:"button",className:(0,n.cx)(ce,ne.editable),onClick:()=>he("refId"),children:(0,t.jsx)("div",{className:ne.expression.refId,children:_})}),de&&(0,t.jsx)(f.D,{autoFocus:!0,defaultValue:_,minWidth:5,onFocus:me=>me.target.select(),onBlur:me=>{J(me.currentTarget.value),he(!1)}}),(0,t.jsx)("div",{children:(0,b.NI)(ee)})]}),(0,t.jsx)(L.h,{}),(0,t.jsx)(F.a,{refId:_,onSetCondition:()=>te(re.refId),isCondition:ae}),(0,t.jsx)(p.K,{name:"trash-alt",variant:"secondary",className:ne.mutedIcon,onClick:Z,tooltip:`Remove expression "${_}"`})]})})},T=()=>(0,t.jsx)("span",{children:"{"}),z=()=>(0,t.jsx)("span",{children:"}"}),w=()=>(0,t.jsx)("span",{children:'"'}),H=()=>(0,t.jsx)("span",{children:"="});function G({frame:_,index:ee,isAlertCondition:J,isRecordingRule:Z}){const te=(0,g.of)(k),ae=(0,I.Jw)(_)||"Series "+ee,re=(0,I.Lm)(_),ne=(0,I.JQ)(_),ce=Object.entries(ne),le=ce.length>0,he=J&&re!==0,oe=J&&re===0,de=`${le?"":ae}${le?`{${(0,I.h6)(ne)}}`:""}`,me=!Z;return(0,t.jsx)("div",{className:te.expression.resultsRow,children:(0,t.jsxs)(E.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)("div",{className:te.expression.resultLabel,title:de,children:(0,t.jsx)(h.E,{variant:"code",children:le?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{}),ce.map(([Pe,Ee],be)=>(0,t.jsxs)(h.E,{variant:"body",children:[(0,t.jsx)("span",{className:te.expression.labelKey,children:Pe}),(0,t.jsx)(H,{}),(0,t.jsx)(w,{}),(0,t.jsx)("span",{className:te.expression.labelValue,children:Ee}),(0,t.jsx)(w,{}),be<ce.length-1&&(0,t.jsx)("span",{children:", "})]},(0,r.uniqueId)())),(0,t.jsx)(z,{})]}):(0,t.jsx)("span",{className:te.expression.labelKey,children:de})})}),(0,t.jsx)("div",{className:te.expression.resultValue,children:re}),me&&(0,t.jsxs)(t.Fragment,{children:[he&&(0,t.jsx)(B.C,{state:S.cF.Firing,size:"sm"}),oe&&(0,t.jsx)(B.C,{state:S.cF.Inactive,size:"sm"})]})]})})}const X=({frame:_,index:ee})=>{const J=(0,g.of)(k),Z=_.fields[1],te=Z.labels,re=Z.config?.displayNameFromDS??(te?(0,I.h6)(Z.labels??{}):"Series "+ee),ne=_.fields[0].values,ce=he=>_.fields[0].values[he],le=he=>_.fields[1].values[he];return(0,t.jsx)("div",{className:J.expression.resultsRow,children:(0,t.jsxs)(E.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)("span",{className:(0,n.cx)(J.mutedText,J.expression.resultLabel),title:re,children:re}),(0,t.jsx)("div",{className:J.expression.resultValue,children:(0,t.jsx)(R.B,{placement:"right",wrapperClassName:J.timeseriesTableWrapper,content:(0,t.jsxs)("table",{className:J.timeseriesTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Timestamp"}),(0,t.jsx)("th",{children:"Value"})]})}),(0,t.jsx)("tbody",{children:ne.map((he,oe)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:J.mutedText,children:(0,u.LE)(ce(oe))}),(0,t.jsx)("td",{className:J.expression.resultValue,children:le(oe)})]},oe))})]}),children:(0,t.jsx)("span",{children:"Time series data"})})})]})})},k=_=>({expression:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${_.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:_.shape.radius.default}),stack:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,n.css)({maxWidth:"100%"}),nonClassic:(0,n.css)({maxWidth:"640px"}),alertCondition:(0,n.css)({}),body:(0,n.css)({padding:_.spacing(1),flex:1}),description:(0,n.css)({marginBottom:_.spacing(1),fontSize:_.typography.size.xs,color:_.colors.text.secondary}),refId:(0,n.css)({fontWeight:_.typography.fontWeightBold,color:_.colors.primary.text}),results:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${_.colors.border.medium}`}),noResults:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,n.css)({padding:`${_.spacing(.75)} ${_.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:_.colors.background.secondary},"&:hover":{backgroundColor:_.colors.background.canvas}}),labelKey:(0,n.css)({color:_.isDark?"#73bf69":"#56a64b"}),labelValue:(0,n.css)({color:_.isDark?"#ce9178":"#a31515"}),resultValue:(0,n.css)({textAlign:"right"}),resultLabel:(0,n.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:_.spacing()})},mutedText:(0,n.css)({color:_.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,n.css)({background:_.colors.background.secondary,padding:`${_.spacing(.5)} ${_.spacing(1)}`,borderBottom:`solid 1px ${_.colors.border.weak}`})},footer:(0,n.css)({background:_.colors.background.secondary,padding:_.spacing(1),borderTop:`solid 1px ${_.colors.border.weak}`}),draggableIcon:(0,n.css)({cursor:"grab"}),mutedIcon:(0,n.css)({color:_.colors.text.secondary}),editable:(0,n.css)({padding:`${_.spacing(.5)} ${_.spacing(1)}`,border:`solid 1px ${_.colors.border.weak}`,borderRadius:_.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:_.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,n.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,n.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:_.spacing(1)},td:{background:_.colors.background.primary},th:{background:_.colors.background.secondary},tr:{borderBottom:`1px solid ${_.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,n.css)({borderTop:`1px solid ${_.colors.border.medium}`,padding:_.spacing()})}})},97157:(q,j,e)=>{"use strict";e.d(j,{a:()=>c});var t=e(74848),n=e(22803),r=e(49785),a=e(29675),i=e(66384),x=e(54594),s=e(82700);const c=({isCondition:u,onSetCondition:g,refId:o})=>{const E=(0,a.of)(d),{watch:m}=(0,r.xW)(),f=m("type"),p=f?(0,s.pq)(f):!1,h=p?"Recording rule output":"Alert condition",D=o?`Set "${o}" as alert condition`:"Set as alert condition",C=p?"Set as recording rule output":D;return u?(0,t.jsx)(i.E,{color:"green",icon:"check",text:h},"condition"):(0,t.jsx)("button",{type:"button",className:E.actionLink,onClick:()=>g&&g(),children:C},"make-condition")},d=u=>{const g=(0,x.my)(u);return{actionLink:(0,n.css)(g,{color:u.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},66976:(q,j,e)=>{"use strict";e.d(j,{EL:()=>d,JQ:()=>s,Jw:()=>i,Lm:()=>x,PI:()=>g,h6:()=>c});var t=e(2543),n=e.n(t),r=e(12936),a=e(88214);const i=o=>{const E=o.fields[0];return E?.config?.displayNameFromDS??o.name??E?.labels?.__name__},x=o=>{const E=o.fields[0]?.values[0];return Number.isFinite(E)?(0,r.h)(E,5):E},s=o=>o.fields[0]?.labels??{},c=o=>Object.entries(o).map(([E,m])=>E+"="+m).join(", "),d=o=>{const E=o.name;if((0,a.Eb)(o.rulesSource))return{name:E,parents:[]};try{const m=JSON.parse(E);if(!Array.isArray(m))throw new Error("not a nested Grafana folder");const f=(0,t.last)(m)??E,p=(0,t.dropRight)(m,1);return{name:f,parents:p}}catch{return{name:o.name,parents:[]}}},u=(o,E=[])=>JSON.stringify(E.concat(o)),g=o=>o.every(m=>m.fields.every(f=>f.values.every(p=>p==null)))},60088:(q,j,e)=>{"use strict";e.d(j,{GK:()=>a,Zr:()=>r,xK:()=>n});var t=e(61491);const n=[t.AccessControlAction.AlertingTimeIntervalsRead],r=[t.AccessControlAction.AlertingTimeIntervalsWrite],a=[...n,...r]},82945:(q,j,e)=>{"use strict";e.d(j,{Im:()=>a,nv:()=>r,rw:()=>n});var t=e(61491);const n=[t.AccessControlAction.AlertingRoutesRead],r=[t.AccessControlAction.AlertingRoutesWrite],a=[...n,...r]},27889:(q,j,e)=>{"use strict";e.d(j,{g0:()=>O,a1:()=>M,yV:()=>P,F:()=>S});var t=e(2543),n=e(47078),r=e.n(n),a=e(80187),i=e(77855),x=e(9365),s=e(25779),c=e(25061),d=e(79120);const u=["RoutingTree"],g=d.H.enhanceEndpoints({addTagTypes:u}).injectEndpoints({endpoints:U=>({listNamespacedRoutingTree:U.query({query:W=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${W.namespace}/routingtrees`,params:{pretty:W.pretty,allowWatchBookmarks:W.allowWatchBookmarks,continue:W.continue,fieldSelector:W.fieldSelector,labelSelector:W.labelSelector,limit:W.limit,resourceVersion:W.resourceVersion,resourceVersionMatch:W.resourceVersionMatch,sendInitialEvents:W.sendInitialEvents,timeoutSeconds:W.timeoutSeconds,watch:W.watch}}),providesTags:["RoutingTree"]}),replaceNamespacedRoutingTree:U.mutation({query:W=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${W.namespace}/routingtrees/${W.name}`,method:"PUT",body:W.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree,params:{pretty:W.pretty,dryRun:W.dryRun,fieldManager:W.fieldManager,fieldValidation:W.fieldValidation}}),invalidatesTags:["RoutingTree"]})}),overrideExisting:!1});var o=e(31746),E=e(12444),m=e(18269),f=e(13693),p=e(86655),h=e(27174);const D=r()(R,{maxSize:1}),{useListNamespacedRoutingTreeQuery:C,useReplaceNamespacedRoutingTreeMutation:l,useLazyListNamespacedRoutingTreeQuery:v}=g,{useGetAlertmanagerConfigurationQuery:y}=x.m,P=({alertmanager:U},{skip:W}={})=>{const A=(0,f.dM)(U),N=C({namespace:(0,i.G)()},{skip:W||!A,selectFromResult:V=>({...V,currentData:V.currentData?D(V.currentData.items):void 0,data:V.data?D(V.data.items):void 0})}),K=y(U,{skip:W||A,selectFromResult:V=>({...V,currentData:V.currentData?.alertmanager_config?.route?[b(V.currentData.alertmanager_config.route)]:void 0,data:V.data?.alertmanager_config?.route?[b(V.data.alertmanager_config.route)]:void 0})});return A?N:K},b=r()(U=>({...U,[a.uz]:{provisioned:!!(U.provenance&&U.provenance!==m.rh)}}));function S({alertmanager:U}){const W=(0,f.dM)(U),[A]=l(),[N]=(0,c.d)(),[K]=v(),V=(0,s.Yb)(async z=>{const w=(0,i.G)(),H=await K({namespace:w}),[G]=H.data?D(H.data.items):[];if(!G)throw new Error(`no root route found for namespace ${w}`);const X=(0,E.QM)(G),k=(0,h.AB)(U,z,X),_=I(k);return A({name:m.DM,namespace:w,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:(0,h.HO)(_)}).unwrap()}),T=(0,s.Yb)(async z=>{const w=(0,o.LY)({update:z,alertmanager:U});return N(w)});return W?V:T}function M({alertmanager:U}){const W=(0,f.dM)(U),[A]=(0,c.d)(),[N]=v(),[K]=l(),V=(0,s.Yb)(async z=>{const w=(0,i.G)(),H=await N({namespace:w}),[G]=H.data?D(H.data.items):[];if(!G)throw new Error(`no root route found for namespace ${w}`);const X=(0,E.QM)(G),k=(0,h.AS)(z,X),_=I(k);return K({name:m.DM,namespace:w,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:_}).unwrap()}),T=(0,s.Yb)(async z=>{const w=(0,o.Z8)({id:z});return A(w)});return W?V:T}function O({alertmanager:U}){const W=(0,f.dM)(U),[A]=(0,c.d)(),[N]=v(),[K]=l(),V=(0,s.Yb)(async({partialRoute:z,referenceRouteIdentifier:w,insertPosition:H})=>{const G=(0,i.G)(),X=await N({namespace:G}),[k]=X.data?D(X.data.items):[];if(!k)throw new Error(`no root route found for namespace ${G}`);const _=(0,E.QM)(k),ee=(0,h.I8)(U??"",z,w,_,H),J=I(ee);return K({name:m.DM,namespace:G,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:(0,h.HO)(J)}).unwrap()}),T=(0,s.Yb)(async({partialRoute:z,referenceRouteIdentifier:w,insertPosition:H})=>{const G=(0,o.tD)({partialRoute:z,referenceRouteIdentifier:w,insertPosition:H,alertmanager:U});return A(G)});return W?V:T}function R(U){return U?.map(W=>({...W.spec.defaults,routes:W.spec.routes?.map(B),[a.uz]:{provisioned:(0,f.Uo)(W),resourceVersion:W.metadata.resourceVersion,name:W.metadata.name}}))}function L(U){return Object.values(a.ho).includes(U)}function B(U){return{...U,routes:U.routes?.map(B),matchers:void 0,object_matchers:U.matchers?.map(({label:W,type:A,value:N})=>{if(!L(A))throw new Error(`Invalid matcher operator from API: ${A}`);return[W,A,N]})}}function F(U){const{object_matchers:W,...A}=U;return{...A,receiver:U.receiver??void 0,matchers:W?.map(([N,K,V])=>({label:N,type:K,value:V})),routes:U.routes?.map(F)}}function I(U){const A={...(0,t.pick)(U,p.Rs),receiver:U.receiver??""},N=U.routes?.map(F)??[];return{spec:{defaults:A,routes:N},metadata:{name:m.DM,resourceVersion:U[a.uz]?.resourceVersion}}}},97671:(q,j,e)=>{"use strict";e.r(j),e.d(j,{AlertmanagerTemplateFunction:()=>n,availableAlertManagerFunctions:()=>r,builtinFunctions:()=>i,conf:()=>c,keywords:()=>x,language:()=>s});var t=(d=>(d.Delimiter="delimiter",d.Keyword="keyword",d.Function="type.identifier",d.String="string",d.Variable="variable.name",d.Number="number",d.Comment="comment",d.Operator="operator",d.Identifier="idenfifier",d))(t||{}),n=(d=>(d.toUpper="toUpper",d.toLower="toLower",d.title="title",d.join="join",d.match="match",d.safeHtml="safeHtml",d.reReplaceAll="reReplaceAll",d.stringSlice="stringSlice",d))(n||{});const r=Object.values(n),i=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],x=["define","if","else","end","range","break","continue","template","block","with"],s={defaultToken:"",keywords:x,functions:[...i,...r],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},c={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},94736:(q,j,e)=>{"use strict";e.d(j,{FI:()=>t,J4:()=>n});const t="grafana_alerting";var n=(i=>(i.OnCall="oncall",i))(n||{});const r=(i,x)=>x.includes(i),a=(i,x)=>{if(!i.grafana_managed_receiver_configs)return!1;const s=i.grafana_managed_receiver_configs.length===1,c=r(i.grafana_managed_receiver_configs[0]?.settings?.url??"",x.map(d=>d.integration_url));return s&&c}},17209:(q,j,e)=>{"use strict";e.d(j,{U0:()=>g,VY:()=>f});var t=e(1932),n=e(96540),r=e(28082),a=e(19165),i=e(17687),x=e(65333),s=e(51311),c=e(40113),d=e(12602),u=e(94736),g=(p=>(p.NewIntegration="new_oncall_integration",p.ExistingIntegration="existing_oncall_integration",p))(g||{}),o=(p=>(p.IntegrationType="integration_type",p.IntegrationName="integration_name",p))(o||{}),E=(p=>(p.Disabled="disabled",p.V1="v1",p.V2="v2",p))(E||{});function m(){const{installed:p,loading:h,error:D}=(0,s._)((0,a.BO)()),{data:C=[],error:l,isLoading:v}=x.WG.endpoints.features.useQuery(void 0,{skip:!p}),y=(0,n.useMemo)(()=>p?C.includes(x.Pc)?"v2":"v1":"disabled",[p,C]),P=(0,n.useMemo)(()=>y==="v2",[y]);return{isOnCallEnabled:p,integrationStatus:y,isAlertingV2IntegrationEnabled:P,isOnCallStatusLoading:h||v,onCallError:D??l}}function f(){const p=(0,i._2)(),{isOnCallEnabled:h,integrationStatus:D,isAlertingV2IntegrationEnabled:C,isOnCallStatusLoading:l,onCallError:v}=m(),{useCreateIntegrationMutation:y,useGrafanaOnCallIntegrationsQuery:P,useLazyValidateIntegrationNameQuery:b}=x.WG,[S,{isFetching:M}]=b(),[O]=y(),{data:R=[],isLoading:L,isError:B}=P(void 0,{skip:!C}),F=(0,n.useMemo)(()=>({integration_name:async A=>{try{return await S(A).unwrap(),!0}catch(N){if((0,r.NF)(N)&&N.status===409)return"Integration of this name already exists in OnCall";throw p.error("Failed to validate OnCall integration name. Is the OnCall API available?"),N}},url:A=>C?R.map(N=>N.integration_url).includes(A)?!0:"Selection of existing OnCall integration is required":!0}),[R,S,C,p]),I=(0,n.useCallback)(A=>C?(0,t.jM)(A,N=>{N.grafana_managed_receiver_configs?.forEach(K=>{K.type===u.J4.OnCall&&(K.settings.integration_type="existing_oncall_integration")})}):A,[C]),U=(0,n.useCallback)(async A=>{if(!C)return A;const V=(A.grafana_managed_receiver_configs?.filter(T=>T.type===u.J4.OnCall)??[]).filter(T=>T.settings.integration_type==="new_oncall_integration").map(async T=>{const z=await O({integration:u.FI,verbal_name:T.settings.integration_name}).unwrap();T.settings.url=z.integration_url});return await Promise.all(V),(0,t.jM)(A,T=>{T.grafana_managed_receiver_configs?.forEach(z=>{z.type===u.J4.OnCall&&(delete z.settings.integration_type,delete z.settings.integration_name)})})},[C,O]),W=(0,n.useCallback)(A=>{if(A.type===u.J4.OnCall&&C){const N=A.options.filter(T=>T.propertyName!=="url"),K={value:"new_oncall_integration",label:"New OnCall integration",description:"A new OnCall integration without escalation chains will be automatically created"},V={value:"existing_oncall_integration",label:"Existing OnCall integration",description:"Use an existing OnCall integration"};return N.unshift((0,c.u)("integration_type","How to connect to OnCall","",{required:!0,element:"radio",defaultValue:K,selectOptions:[K,V]}),(0,c.u)("integration_name","Integration name","The name of the new OnCall integration",{required:!0,showWhen:{field:"integration_type",is:"new_oncall_integration"}}),(0,c.u)("url","OnCall Integration","The OnCall integration to send alerts to",{element:"select",required:!0,showWhen:{field:"integration_type",is:"existing_oncall_integration"},selectOptions:R.map(T=>({label:T.display_name,description:T.integration_url,value:T.integration_url}))})),{...A,options:N}}return A},[R,C]);return{integrationStatus:D,onCallNotifierMeta:{enabled:!!h,order:-1,description:h?"Connect effortlessly to Grafana OnCall":"Enable Grafana OnCall plugin to use this integration",iconUrl:d.K[(0,a.BO)()]},extendOnCallNotifierFeatures:W,extendOnCallReceivers:I,createOnCallIntegrations:U,onCallFormValidators:F,isLoadingOnCallIntegration:L||l,isValidating:M,hasOnCallError:!!v||B}}},12602:(q,j,e)=>{"use strict";e.d(j,{K:()=>n});var t=e(10148);const n={[t.W.OnCall]:"public/img/alerting/oncall_logo.svg",[t.W.Irm]:"public/img/alerting/irm_logo.svg",[t.W.Incident]:"",[t.W.MachineLearning]:"",[t.W.Labels]:"",[t.W.Slo]:""}},84703:(q,j,e)=>{"use strict";e.d(j,{j:()=>u});var t=e(74848),n=e(22803),r=e(70713),a=e(67555),i=e(29675),x=e(22492),s=e(8174),c=e(79198),d=e(34001);const u=({data:o,thresholds:E,thresholdsType:m})=>{const f=(0,i.of)(g),p=(0,a.jq)(o.series),h=(0,d.yW)(o),D=m?{mode:m}:void 0;return(0,t.jsx)("div",{className:f.wrapper,children:(0,t.jsx)(r.default,{disableHeight:!0,children:({width:C})=>(0,t.jsx)("div",{style:{width:C},children:p?(0,t.jsx)(s.y,{statusMessage:h,data:o.series,eventBus:x.A,height:300,width:C,timeRange:o.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:o.state,thresholdsConfig:E,thresholdsStyle:D}):(0,t.jsxs)("div",{className:f.instantVectorResultWrapper,children:[(0,t.jsx)("header",{className:f.title,children:"Table"}),(0,t.jsx)(c.GX,{series:o.series})]})})})})},g=o=>({wrapper:(0,n.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,n.css)({border:`solid 1px ${o.colors.border.medium}`,borderRadius:o.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,n.css)({label:"panel-title",padding:o.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:o.typography.h6.fontSize,fontWeight:o.typography.h6.fontWeight})})},29269:(q,j,e)=>{"use strict";e.d(j,{p_:()=>o,qQ:()=>g,vL:()=>x,wz:()=>s});var t=e(2543),n=e.n(t),r=e(83023),a=e(12175),i=e(44684);function x(p){const h=new r.TS,D=[],C=p.map(l=>l.refId);if(h.createNodes(C),p.forEach(l=>{if(!(0,a.f)(l.model))return;const v=l.refId;d(l.model).forEach(P=>{if(v&&P)try{h.link(P,v)}catch(b){D.push({source:v,target:P,error:b})}})}),D.length>0)throw new c("failed to create DAG from queries",{cause:D});return h}function s(p,h=[]){try{return[x(p),h]}catch(D){if(D instanceof c){const C=D.cause;h.push(...C);const l=(0,t.reject)(p,v=>C.some(y=>y.source===v.refId));return s(l,h)}}return[new r.TS,h]}class c extends Error{constructor(h,D){super(h,D),this.cause=D?.cause??[]}}function d(p){const h=p.type===i.Tz.math,D=p.type===i.Tz.classic;return h?u(p.expression??""):D?p.conditions?.map(C=>C.query.params[0])??[]:[p.expression]}function u(p){const h=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),D=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),C=Array.from(p.matchAll(h)).map(v=>v.groups?.var),l=Array.from(p.matchAll(D)).map(v=>v.groups?.var);return(0,t.compact)((0,t.uniq)([...C,...l]))}const g=(0,t.memoize)(E,(p,h)=>p+f(h)),o=(0,t.memoize)(m,(p,h)=>p+f(h));function E(p,h){const D=h.getNode(p);if(!D)return[];const C=[];function l(v){const y=v.inputEdges;y.length>0?y.forEach(P=>{P.inputNode&&l(P.inputNode)}):C.push(v)}return l(D),C.map(v=>v.name)}function m(p,h){const D=h.getNode(p);if(!D)return[];const C=[];function l(v){v.outputEdges.forEach(P=>{P.outputNode&&(C.push(P.outputNode),l(P.outputNode))})}return l(D),C.map(v=>v.name)}function f(p){return Object.keys(p.nodes).map(h=>{const D=p.nodes[h],C=D.outputEdges.map(v=>v.outputNode?.name).join(", "),l=D.inputEdges.map(v=>v.inputNode?.name).join(", ");return`${D.name}:${C}:${l}`}).join(" ")}},45834:(q,j,e)=>{"use strict";e.d(j,{F7:()=>l,zF:()=>v,zd:()=>S});var t=e(74848),n=e(22803),r=e(1932),a=e(91357),i=e(29675),x=e(48583),s=e(45565),c=e(77222),d=e(60484),u=e(44826),g=e(34128),o=e(11817),E=e(71481),m=e(83819),f=e(44684),p=e(66456),h=e(24825),D=e(79198),C=e(1653);const l={queryId:"A",reducerId:"B",thresholdId:"C"},v=({simpleCondition:O,onChange:R,expressionQueriesList:L,dispatch:B,previewData:F})=>{const I=V=>{R({...O,whenField:V.value??a.gy.last}),y(V.value??a.gy.last,L,B)},U=O.evaluator.type===E.p.IsWithinRange||O.evaluator.type===E.p.IsOutsideRange,W=f.zd.find(V=>V.value===O.evaluator?.type),A=V=>{R({...O,evaluator:{...O.evaluator,type:V.value??E.p.IsAbove}}),P(V.value??E.p.IsAbove,L,B)},N=(V,T)=>{if(U){const z=(0,r.jM)(O.evaluator.params,w=>{w[T??0]=parseFloat(V.currentTarget.value)});R({...O,evaluator:{...O.evaluator,params:z}}),b(parseFloat(V.currentTarget.value),T??0,L,B)}else R({...O,evaluator:{...O.evaluator,params:[parseFloat(V.currentTarget.value)]}}),b(parseFloat(V.currentTarget.value),0,L,B)},K=(0,i.of)(M);return(0,t.jsx)("div",{className:K.condition.wrapper,children:(0,t.jsxs)(x.B,{direction:"column",gap:0,width:"100%",children:[(0,t.jsx)("header",{className:K.condition.header,children:(0,t.jsx)(s.E,{variant:"body",children:(0,t.jsx)(o.x6,{i18nKey:"alerting.simpleCondition.alertCondition",children:"Alert condition"})})}),(0,t.jsxs)(c.C,{className:K.condition.container,children:[O.whenField&&(0,t.jsx)(d.I,{label:"WHEN",children:(0,t.jsx)(u.l6,{options:f.Cu,value:f.Cu.find(V=>V.value===O.whenField),onChange:I,width:20})}),(0,t.jsx)(d.I,{label:O.whenField?"OF QUERY":"WHEN QUERY",children:(0,t.jsxs)(x.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(m.E,{onChange:A,value:W}),U?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.p,{type:"number",width:10,value:O.evaluator.params[0],onChange:V=>N(V,0)}),(0,t.jsx)(h.Y,{}),(0,t.jsx)(g.p,{type:"number",width:10,value:O.evaluator.params[1],onChange:V=>N(V,1)})]}):(0,t.jsx)(g.p,{type:"number",width:10,onChange:N,value:O.evaluator.params[0]})]})})]}),F?.series&&(0,t.jsx)(D.GX,{series:F?.series,isAlertCondition:!0})]})})};function y(O,R,L){const B=R.find(I=>I.model.type===f.Tz.reduce&&I.model.refId===l.reducerId),F=B?(0,r.jM)(B?.model,I=>{I&&I.conditions&&(I.reducer=O,I.conditions[0].reducer.type=(0,p.H3)(O)??a.gy.last)}):void 0;F&&L((0,C.eD)(F))}function P(O,R,L){const B=R.find(I=>I.model.type===f.Tz.threshold&&I.model.refId===l.thresholdId),F=(0,r.jM)(B,I=>{I&&I.model.conditions&&(I.model.conditions[0].evaluator.type=O)});F&&L((0,C.eD)(F.model))}function b(O,R,L,B){const F=L.find(U=>U.model.type===f.Tz.threshold&&U.model.refId===l.thresholdId),I=(0,r.jM)(F,U=>{U&&U.model.conditions&&(U.model.conditions[0].evaluator.params[R]=O)});I&&B((0,C.eD)(I.model))}function S(O){const R=O.find(W=>W.model.type===f.Tz.reduce&&W.refId===l.reducerId),B=O.find(W=>W.model.type===f.Tz.threshold&&W.refId===l.thresholdId)?.model.conditions??[],F=R?.model.reducer,I=B[0]?.evaluator?.params?[...B[0]?.evaluator?.params]:[0],U=B[0]?.evaluator?.type??E.p.IsAbove;return{whenField:F,evaluator:{params:I,type:U}}}const M=O=>({buttonSelectText:(0,n.css)({color:O.colors.primary.text,fontSize:O.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${O.spacing(1)}`}),condition:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${O.colors.border.medium}`,flex:1,height:"fit-content",borderRadius:O.shape.radius.default}),container:(0,n.css)({display:"flex",flexDirection:"row",padding:O.spacing(1),flex:1,width:"100%"}),header:(0,n.css)({background:O.colors.background.secondary,padding:`${O.spacing(.5)} ${O.spacing(1)}`,borderBottom:`solid 1px ${O.colors.border.weak}`,flex:1})}})},1653:(q,j,e)=>{"use strict";e.d(j,{MJ:()=>B,NX:()=>K,Op:()=>N,PH:()=>P,QP:()=>b,RZ:()=>O,S1:()=>y,Tf:()=>V,_:()=>A,bS:()=>S,cD:()=>M,eD:()=>R,eF:()=>L,iw:()=>I,k8:()=>F,mB:()=>v});var t=e(65307),n=e(1932),r=e(61809),a=e(59577),i=e(55801),x=e(91357),s=e(44099),c=e(98437),d=e(21475),u=e(12175),g=e(44684),o=e(66456),E=e(83893),m=e(88214),f=e(82096),p=e(29269),h=e(34001),D=e(45834);const C=(w,H)=>{const G=(0,p.vL)(w),X=(0,p.qQ)(H,G)[0];if(!X)return;const k=w.find(_=>_.refId===X);if(k&&"relativeTimeRange"in k)return k},l={queries:[]},v=(0,t.VP)("duplicateQuery"),y=(0,t.VP)("addNewDataQuery"),P=(0,t.VP)("setDataQueries"),b=(0,t.VP)("addNewExpression"),S=(0,t.VP)("removeExpression"),M=(0,t.VP)("removeExpressions"),O=(0,t.VP)("addExpressions"),R=(0,t.VP)("updateExpression"),L=(0,t.VP)("updateExpressionRefId"),B=(0,t.VP)("rewireExpressions"),F=(0,t.VP)("updateExpressionType"),I=(0,t.VP)("updateExpressionTimeRange"),U=(0,t.VP)("updateMaxDataPoints"),W=(0,t.VP)("updateMinInterval"),A=(0,t.VP)("resetToSimpleCondition"),N=(0,t.VP)("optimizeReduceExpression"),K=(0,t.VP)("setRecordingRulesQueries"),V=(0,t.vy)(l,w=>{w.addCase(A,H=>{H.queries=(0,f.qO)()}).addCase(v,(H,{payload:G})=>{H.queries=T(H.queries,G)}).addCase(y,H=>{const G=(0,m.y9)();G&&(H.queries=T(H.queries,{datasourceUid:G.uid,model:{refId:"",datasource:(0,r.p$)(G)}}))}).addCase(P,(H,{payload:G})=>{const X=H.queries.filter(k=>(0,u.f)(k.model));H.queries=[...G,...X]}).addCase(K,(H,{payload:G})=>{const X=G.recordingRuleQueries[0],k={...X,expr:G.expression,model:X?.model};H.queries=[k]}).addCase(U,(H,G)=>{H.queries=H.queries.map(X=>X.refId===G.payload.refId?{...X,model:{...X.model,maxDataPoints:G.payload.maxDataPoints}}:X)}).addCase(W,(H,G)=>{H.queries=H.queries.map(X=>X.refId===G.payload.refId?{...X,model:{...X.model,intervalMs:G.payload.minInterval?a.intervalToMs(G.payload.minInterval):void 0}}:X)}),w.addCase(b,(H,{payload:G})=>{H.queries=T(H.queries,{datasourceUid:g.Uj,model:d.Ex.newQuery({type:G,conditions:[{...o.P0,query:{params:[]}}],expression:""})})}).addCase(S,(H,{payload:G})=>{H.queries=H.queries.filter(X=>X.refId!==G)}).addCase(M,H=>{H.queries=H.queries.filter(G=>!(0,u.f)(G.model))}).addCase(O,(H,{payload:G})=>{H.queries=[...H.queries,...G]}).addCase(R,(H,{payload:G})=>{const X=H.queries.find(k=>k.refId===G.refId);if(X&&(X.model=G,G.type===g.Tz.resample&&G.expression)){const k=(0,n.c2)(H)?.queries??[];let _=(0,i.Cn)();try{const ee=C(k,G.expression);ee?.relativeTimeRange&&(_=ee.relativeTimeRange)}catch(ee){ee instanceof Error?(0,E.vV)(ee):(0,E.vV)(new Error("Error while trying to find data source from expression"))}X.relativeTimeRange=_}}).addCase(I,H=>{H.queries.forEach(G=>{if((0,u.f)(G.model)&&G.model.type===g.Tz.resample&&G.model.expression){const X=(0,n.c2)(H)?.queries??[],k=C(X,G.model.expression),_=k?k.relativeTimeRange:(0,i.Cn)();G.relativeTimeRange=_}})}).addCase(L,(H,{payload:G})=>{const{newRefId:X,oldRefId:k}=G;if((0,h.xb)(H.queries,X))return;const ee=(0,h.I3)(H.queries,k,X);H.queries=ee.map(J=>J.refId===k?{...J,refId:X,model:{...J.model,refId:X}}:J)}).addCase(B,(H,{payload:G})=>{H.queries=(0,h.I3)(H.queries,G.oldRefId,G.newRefId)}).addCase(N,(H,{payload:G})=>{const{updatedQueries:X,expressionQueries:k}=G;if(X.length!==1)return;const _=(0,c.l)().getInstanceSettings(X[0].datasourceUid);if(!_)return;const ee=_?.type,J=ee===m.ol.Prometheus||ee===m.ol.Loki,Z=(0,f.mY)(X[0].model,ee),te=J&&X.length===1&&Z&&k.length===2,ae=k.length===1&&"type"in k[0].model&&k[0].model.type!==g.Tz.reduce,re=J&&X.length===1&&!Z&&ae;if(te){const ne=H.queries.findIndex(ce=>(0,u.f)(ce.model)&&ce.model.type===g.Tz.reduce);ne===1&&(H.queries.splice(ne,1),H.queries[1].model.expression=D.F7.queryId)}re&&(H.queries[1].model.expression=D.F7.reducerId,H.queries.splice(1,0,{datasourceUid:g.Uj,model:d.Ex.newQuery({type:g.Tz.reduce,reducer:x.gy.last,conditions:[{...o.P0,query:{params:[]}}],expression:D.F7.queryId,refId:D.F7.reducerId}),refId:D.F7.reducerId,queryType:"expression"}))}).addCase(F,(H,G)=>{H.queries=H.queries.map(X=>X.refId===G.payload.refId?{...X,model:{...d.Ex.newQuery({type:G.payload.type,conditions:[{...o.P0,query:{params:[]}}],expression:""}),refId:G.payload.refId}}:X)})}),T=(w,H)=>{const G=(0,s.M)(w),X={...H,refId:G,queryType:"",model:{...H.model,hide:!1,refId:G},relativeTimeRange:H.relativeTimeRange??z(H.model)};return[...w,X]},z=w=>{if(!(0,u.f)(w))return(0,i.Cn)()}},35248:(q,j,e)=>{"use strict";e.d(j,{Y:()=>w});var t=e(96540),n=e(8392),r=e(2543),a=e(39741),i=e(62467),x=e(66847),s=e(1005),c=e(81160),d=e(24726),u=e(4038),g=e(78137),o=e(59577),E=e(55801),m=e(26701),f=e(98437),p=e(65502),h=e(64121),D=e(11817),C=e(75911),l=e(12175),v=e(64061),y=e(29341),P=e(29269),b=e(44684);const S={from:21600,to:0},M=(H,G)=>{const X=O(H,G);if(!X)return S;const{from:k,to:_}=L(X,G);return!k.length&&!_.length?S:{from:Math.max(...k),to:Math.min(..._)}},O=(H,G)=>{switch(H.type){case b.Tz.classic:return R(H);case b.Tz.math:case b.Tz.sql:return B(H,G);case b.Tz.resample:case b.Tz.reduce:case b.Tz.threshold:return F(H)}},R=H=>H.conditions?.map(G=>G.query.params[0]),L=(H,G)=>{const X=[],k=[S.to];for(const _ of H){const ee=G.find(J=>J.refId===_);!ee||!ee.relativeTimeRange||(X.push(ee.relativeTimeRange.from),k.push(ee.relativeTimeRange.to))}return{from:X,to:k}},B=(H,G)=>G.filter(X=>X.queryType==="query"&&H.expression?.includes(X.refId)).map(X=>X.refId),F=H=>H.expression?[H.expression]:void 0;class I{constructor(G=(0,C.AI)(),X=(0,f.l)()){this.backendSrv=G,this.dataSourceSrv=X,this.subject=new a.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(G,X){const k=await this.prepareQueries(G);if(k.length===0)return;const ee=k.some(J=>J.refId===X)?X:"";this.subscription=U(this.backendSrv,k,ee).subscribe({next:J=>{const Z=V(J,(re,ne)=>{const ce=this.lastResult[re],le=(0,u.N$)(ne,ce);return(0,y.B)(le,ce)}),[te,ae]=(0,P.wz)(G);ae.forEach(re=>{Z[re.source]=T(re)}),this.lastResult=Z,this.subject.next(this.lastResult)},error:J=>{this.lastResult=K(this.lastResult,J),this.subject.next(this.lastResult)}})}async prepareQueries(G){const X=[];for(const J of G){const Z=J.model.refId;if((0,l.f)(J.model))continue;const te=await this.dataSourceSrv.get(J.datasourceUid);te instanceof p.iy&&te.filterQuery&&!te.filterQuery(J.model)&&X.push(Z)}const[k]=(0,P.wz)(G),_=Object.keys(k.nodes);return X.forEach(J=>{const Z=(0,P.p_)(J,k);X.push(...Z)}),G.filter(J=>!_.includes(J.refId)).forEach(J=>{X.push(J.refId)}),(0,r.reject)(G,J=>X.includes(J.refId))}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let G=!1;const X=V(this.lastResult,(k,_)=>(_.state===n.Gu.Loading&&(G=!0),{..._,state:n.Gu.Done}));G&&this.subject.next(X)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const U=(H,G,X)=>{const k=W(G,n.Gu.Loading),_={data:{data:G,condition:X},url:"/api/v1/eval",method:"POST",requestId:(0,d.A)()};return(0,g.k)({whileLoading:k,source:H.fetch(_).pipe(N(k),(0,x.W)(ee=>(0,i.of)(K(k,ee))),(0,v.N)(H,_.requestId),(0,s.u)())})},W=(H,G)=>H.reduce((X,k)=>(X[k.refId]={state:G,series:[],timeRange:A(k,H)},X),{}),A=(H,G)=>{if((0,l.f)(H.model)){const X=M(H.model,G);return o.relativeToTimeRange(X)}return H.relativeTimeRange?o.relativeToTimeRange(H.relativeTimeRange):(console.warn(`Query with refId: ${H.refId} did not have any relative time range, using default.`),(0,E.E2)())},N=H=>(0,c.T)(G=>{const{data:X}=G,k={};for(const[_,ee]of Object.entries(X.results)){const{error:J,status:Z,frames:te=[]}=ee,ae=J?[{message:J,refId:_,status:Z}]:[];k[_]={errors:ae,timeRange:H[_].timeRange,state:n.Gu.Done,series:te.map(m.or)}}return k}),K=(H,G)=>{const X=(0,h.u)(G);return V(H,(k,_)=>_.state===n.Gu.Error?_:{..._,state:n.Gu.Error,error:X})},V=(H,G)=>{const X={};for(const[k,_]of Object.entries(H))X[k]=G(k,_);return X},T=H=>({series:[],state:n.Gu.Error,errors:[{message:z(H)}],timeRange:(0,E.E2)()});function z(H){return H.source===H.target?(0,D.t)("alerting.dag.self-reference","You can't link an expression to itself"):(0,D.t)("alerting.dag.missing-reference",'Expression "{{source}}" failed to run because "{{target}}" is missing or also failed.',{source:H.source,target:H.target})}function w(){const[H,G]=(0,t.useState)({}),X=(0,t.useRef)(new I);(0,t.useEffect)(()=>{const Z=X.current;return Z.get().subscribe(te=>{G(te)}),()=>{Z.destroy()}},[]);const k=(0,t.useCallback)(()=>{G({})},[]),_=(0,t.useCallback)(()=>{X.current.cancel()},[]),ee=(0,t.useCallback)((Z,te)=>{X.current.run(Z,te)},[]),J=(0,t.useMemo)(()=>Object.values(H).some(Z=>Z.state===n.Gu.Loading),[H]);return{queryPreviewData:H,runQueries:ee,cancelQueries:_,isPreviewLoading:J,clearPreviewData:k}}},34001:(q,j,e)=>{"use strict";e.d(j,{Cl:()=>f,I3:()=>o,YG:()=>y,an:()=>C,lb:()=>h,xb:()=>m,yW:()=>v,yr:()=>D,zy:()=>p});var t=e(2543),n=e.n(t),r=e(67555),a=e(99116),i=e(8392),x=e(7500),s=e(88023),c=e(71481),d=e(12175),u=e(44684),g=e(29269);function o(P,b,S){return P.map(M=>{if(b===S||!(0,d.f)(M.model))return M;const O=M.model.type==="math",R=M.model.type==="reduce",L=M.model.type==="resample",B=M.model.type==="classic_conditions",F=M.model.type==="threshold";if(O)return{...M,model:{...M.model,expression:E(M.model.expression??"",b,S)}};if(L||R||F){const I=M.model.expression===b;return{...M,model:{...M.model,expression:I?S:M.model.expression}}}if(B){const I=M.model.conditions?.map(U=>({...U,query:{...U.query,params:U.query.params.map(W=>W===b?S:W)}}));return{...M,model:{...M.model,conditions:I}}}return M})}function E(P,b,S){const M=new RegExp("(\\$"+b+"\\b)|(\\${"+b+"})","gm"),O="${"+S+"}";return P.replace(M,O)}function m(P,b){return P.find(S=>S.refId===b)!==void 0}function f(P){return P.includes("/")||P.includes("\\")}function p(P){if(P.series.length===0)return;const b=(0,r.jq)(P.series);let S;return b&&(S=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),S}function h(P){if(P.errors?.length)return new Error(P.errors[0].message)}function D(P){const S=(P[0]?.meta?.notices??[]).find(M=>M.severity==="warning")?.text;return S?new Error(S):void 0}function C(P,b){const S={},M=[u.Tz.threshold,u.Tz.classic];if(!b)return S;for(const L of P){if(!(0,d.f)(L.model)||!M.includes(L.model.type)||!Array.isArray(L.model.conditions)||L.model.refId!==b)continue;const B=L.model.conditions.some(l);L.model.conditions.forEach(F=>{const I=F.evaluator.params,U=F.query?.params[0]??L.model.expression;if(!U)return;const W=l(F);try{const A=(0,g.vL)(P),N=(0,g.qQ)(U,A);P.filter(V=>N.includes(V.refId)).forEach(V=>{const T=V.refId,w=!!(!(0,d.f)(V?.model)&&T);T&&!S[T]&&(S[T]={config:{mode:a.O.Absolute,steps:[]},mode:x.Ly.Line}),T&&w&&!W&&!B?O(T,I[0]):T&&w&&W&&(R(T,I,F.evaluator.type),S[T].mode=x.Ly.LineAndArea)})}catch(A){console.error("Failed to parse thresholds",A);return}})}function O(L,B){S[L].config.steps.push({value:-1/0,color:"transparent"},{value:B,color:s.$W.theme2.colors.error.main})}function R(L,B,F){F===c.p.IsWithinRange&&S[L].config.steps.push({value:-1/0,color:"transparent"},{value:B[0],color:s.$W.theme2.colors.error.main},{value:B[1],color:s.$W.theme2.colors.error.main},{value:B[1],color:"transparent"}),F===c.p.IsOutsideRange&&S[L].config.steps.push({value:-1/0,color:s.$W.theme2.colors.error.main},{value:B[0],color:s.$W.theme2.colors.error.main},{value:B[0],color:"transparent"},{value:B[1],color:s.$W.theme2.colors.error.main}),F===c.p.IsWithinRangeIncluded&&S[L].config.steps.push({value:-1/0,color:"transparent"},{value:B[0],color:s.$W.theme2.colors.error.main},{value:B[1],color:s.$W.theme2.colors.error.main},{value:B[1],color:"transparent"}),F===c.p.IsOutsideRangeIncluded&&S[L].config.steps.push({value:-1/0,color:s.$W.theme2.colors.error.main},{value:B[0],color:s.$W.theme2.colors.error.main},{value:B[0],color:"transparent"},{value:B[1],color:s.$W.theme2.colors.error.main}),S[L].config.steps.sort((I,U)=>I.value-U.value),S[L].config.steps=S[L].config.steps.filter(I=>I.value!==void 0)}return S}function l(P){return P.evaluator.type===c.p.IsWithinRange||P.evaluator.type===c.p.IsOutsideRange||P.evaluator.type===c.p.IsOutsideRangeIncluded||P.evaluator.type===c.p.IsWithinRangeIncluded}function v(P){const b="Failed to fetch data";if(P.state!==i.Gu.Error)return;const S=P.errors;return S?.length?S.map(M=>M.message??b).join(", "):P.error?.message??b}function y(P,b){const S=b.filter(L=>!(0,d.f)(L.model)).map(L=>L.refId),M=P.filter(L=>!(0,d.f)(L.model)).map(L=>L.refId),[O,R]=(0,t.xor)(M,S);return[O,R]}},38310:(q,j,e)=>{"use strict";e.d(j,{A:()=>V});var t=e(74848),n=e(52718),r=e(19224),a=e(60232),i=e(22492),x=e(17687),s=e(11817),c=e(5240),d=e(76206),u=e(98775),g=e(25779),o=e(10372);function E(){const[T]=(0,o.D)(),[z]=c.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),w=(0,s.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),H=(0,s.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return(0,g.Yb)(async(G,X,k)=>{const _=(0,u.Rc)(G),ee=(0,d.LH)({uid:X,pause:k}),{newRuleGroupDefinition:J,rulerConfig:Z}=await T(_,ee);return z({rulerConfig:Z,namespace:G.namespace.uid,payload:J,notificationOptions:{successMessage:k?w:H}}).unwrap()})}var m=e(85651),f=e(82700);const h=({rule:T,groupIdentifier:z,onPauseChange:w})=>{const H=(0,x._2)(),[G,X]=E(),[k,_]=(0,f.HH)(T)?["play","Resume evaluation"]:["pause","Pause evaluation"],ee=async J=>{try{await G.execute(z,T.grafana_alert.uid,J)}catch(Z){H.error(`Failed to ${J?"pause":"resume"} the rule: ${(0,m.JZ)(Z)}`);return}w?.()};return(0,t.jsx)(r.W.Item,{label:_,icon:k,disabled:(0,g.VP)(X),onClick:()=>{ee(!T.grafana_alert.is_paused)}})};var D=e(5127),C=e(96540),l=e(93253),v=e(29012),y=e(51876);function P(T,z){const w=b(T,z),{links:H}=(0,v.U)(w),G=(0,f.uo)(T),X=T.type;if(!G||!X)return[];const{pluginId:k}=G;return H.filter(_=>_.pluginId===k)}function b(T,z){return(0,C.useMemo)(()=>{const w=T.type,{namespace:H,groupName:G}=z,X="uid"in H?H.uid:H.name;switch(w){case y.JS.Alerting:return{extensionPointId:l.S.AlertingAlertingRuleAction,context:{name:T.name,namespace:X,group:G,expression:T.query,labels:T.labels??{},annotations:T.annotations??{}}};case y.JS.Recording:return{extensionPointId:l.S.AlertingRecordingRuleAction,context:{name:T.name,namespace:X,group:G,expression:T.query,labels:T.labels??{}}};default:return{extensionPointId:""}}},[z,T])}var S=e(747),M=e(68639),O=e(35874),R=e(6736),L=e(51311),B=e(19165),F=e(28782);const I=(0,B.Wx)(),U=({title:T="",severity:z="",url:w=""})=>{const H=createBridgeURL(I,"/incidents/declare",{title:T,severity:z,url:w}),{loading:G,installed:X,settings:k}=usePluginBridge(I);return jsxs(Fragment,{children:[G===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"}),X===!1&&jsx(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly",children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"})}),k&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:H,children:"Declare Incident"})]})},W=({title:T="",severity:z="",url:w=""})=>{const H=(0,F.h)(I,"/incidents/declare",{title:T,severity:z,url:w}),{loading:G,installed:X,settings:k}=(0,L._)(I);return(0,t.jsxs)(t.Fragment,{children:[G===!0&&(0,t.jsx)(r.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),X===!1&&(0,t.jsx)(R.m,{content:"Grafana Incident is not installed or is not configured correctly",children:(0,t.jsx)(r.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})}),k&&(0,t.jsx)(r.W.Item,{label:"Declare incident",url:H,icon:"fire"})]})},A=({promRule:T,rulerRule:z,identifier:w,groupIdentifier:H,handleSilence:G,handleDelete:X,handleDuplicateRule:k,onPauseChange:_,buttonSize:ee})=>{const[J,Z]=(0,S.mW)(z,H,S.j5.Pause),te=J&&Z,[ae,re]=(0,S.mW)(z,H,S.j5.Delete),ne=ae&&re,[ce,le]=(0,S.mW)(z,H,S.j5.Duplicate),he=ce&&le,[oe,de]=(0,S.mW)(z,H,S.j5.Silence),me=oe&&de,[Pe,Ee]=(0,S.mW)(z,H,S.j5.ModifyExport),be=Pe&&Ee,Se=P(T,H),Xe=Se.length>0,Qe=(!(0,m.y$)()||(0,m.ES)())&&(0,f.Z8)(T)&&T.state===y.cF.Firing,we=(0,m.S2)(w),$e=[te,me,Qe,he].some(Boolean)&&[be].some(Boolean),Fe=(0,t.jsxs)(t.Fragment,{children:[te&&(0,f.lT)(z)&&H.groupOrigin==="grafana"&&(0,t.jsx)(h,{rule:z,groupIdentifier:H,onPauseChange:_}),me&&(0,t.jsx)(r.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:G}),Qe&&(0,t.jsx)(W,{title:T.name,url:""}),he&&(0,t.jsx)(r.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>k(w)}),$e&&(0,t.jsx)(r.W.Divider,{}),we&&(0,t.jsx)(r.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>K(we)}),be&&(0,t.jsx)(r.W.Item,{label:"Export",icon:"download-alt",childItems:[(0,t.jsx)(N,{identifier:w},"export-with-modifications")]}),Xe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.W.Divider,{}),Se.map(Te=>(0,t.jsx)(r.W.Item,{label:Te.title,icon:Te.icon,onClick:Te.onClick},Te.id))]}),ne&&z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.W.Divider,{}),(0,t.jsx)(r.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>X(z,H)})]})]});return(0,t.jsx)(a.m,{overlay:(0,t.jsx)(r.W,{children:Fe}),children:(0,t.jsx)(D.A,{size:ee})})},N=({identifier:T})=>{const z=location.pathname+location.search,w=(0,O.G)(`/alerting/${encodeURIComponent(M.$9(T))}/modify-export`,{returnTo:z});return(0,t.jsx)(r.W.Item,{label:"With modifications",icon:"file-edit-alt",url:w},"with-modifications")};function K(T){navigator.clipboard?.writeText(T).then(()=>{i.A.emit(n.r1.alertSuccess,["URL copied to clipboard"])})}const V=A},34542:(q,j,e)=>{"use strict";e.d(j,{w:()=>E});var t=e(74848),n=e(96540),r=e(53027),a=e(65164),i=e(83394),x=e(3674),s=e(79803),c=e(81513),d=e(48542),u=e(98775),g=e(82700);const o=(0,x.w)(),E=(m=!1)=>{const[f,p]=(0,n.useState)(),[h]=(0,s.Y)(),{waitForRemoval:D}=(0,c.I)(),C=(0,n.useCallback)(()=>{p(void 0)},[]),l=(0,n.useCallback)((P,b)=>{p({ruleIdentifier:P,groupIdentifier:b})},[]),v=(0,n.useCallback)(async()=>{if(!f)return;const{ruleIdentifier:P,groupIdentifier:b}=f,S=(0,u.Rc)(b),M=S.dataSourceName;await h.execute(S,P),(0,i.JD)((0,d.Lc)({rulesSourceName:M})),o&&(0,g.X4)(P)?await D(P):await(0,i.JD)((0,d.eB)({rulesSourceName:M})),C(),m&&r.Ny.replace("/alerting/list")},[h,C,f,m,D]);return[(0,n.useMemo)(()=>(0,t.jsx)(a.u,{isOpen:!!f,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:v,onDismiss:C}),[f,v,C]),l,C]}},68521:(q,j,e)=>{"use strict";e.d(j,{K:()=>a,k:()=>i});var t=e(74848),n=e(96540);const r=n.createContext(void 0),a=({children:x,rule:s,identifier:c})=>{const d={rule:s,identifier:c};return(0,t.jsx)(r.Provider,{value:d,children:x})},i=()=>{const x=n.useContext(r);if(x===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return x}},78032:(q,j,e)=>{"use strict";e.d(j,{gQ:()=>Rt,rf:()=>wn,Ay:()=>ls,lf:()=>qt,P5:()=>gn});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(49185),x=e(48583),s=e(37e3),c=e(11238),d=e(29675),u=e(54731),g=e(45565),o=e(54594),E=e(37008),m=e(65539),f=e(11817),p=e(81564),h=e(12626),D=e(35004),C=e(51876),l=e(48675),v=e(3674),y=e(81513),P=e(29526),b=e(20206),S=e(83466),M=e(85651),O=e(82700),R=e(35874),L=e(3429),B=e(32174),F=e(27219),I=e(72974),U=e(66976),W=e(90319);function A(){return(0,t.jsx)(s.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2,children:(0,t.jsxs)(x.B,{direction:"column",children:["Federated rule groups are currently an experimental feature.",(0,t.jsx)(o.$n,{fill:"text",icon:"book",children:(0,t.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})})}var N=e(79784);function K(){return(0,t.jsx)(g.E,{variant:"bodySmall",color:"warning",children:(0,t.jsxs)(x.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(N.I,{name:"pause",size:"xs"})," Paused"]})})}var V=e(68521);const T=({color:Lt,includeState:$t})=>{const nn=(0,d.of)(z,{color:Lt,includeState:$t});return(0,t.jsx)(x.B,{direction:"row",gap:.5,children:(0,t.jsx)("div",{className:nn.dot})})},z=(Lt,$t)=>{const nn=Lt.spacing(1.25),on=`calc(${nn} / 2.5)`,bn=$t.color==="error",In=$t.color==="success",Yn=$t.color==="warning";return{dot:(0,n.css)({width:nn,height:nn,borderRadius:"100%",backgroundColor:Lt.colors.secondary.main,outline:`solid ${on} ${Lt.colors.secondary.transparent}`,margin:on},In&&(0,n.css)({backgroundColor:Lt.colors.success.main,outlineColor:Lt.colors.success.transparent}),Yn&&(0,n.css)({backgroundColor:Lt.colors.warning.main,outlineColor:Lt.colors.warning.transparent}),bn&&(0,n.css)({backgroundColor:Lt.colors.error.main,outlineColor:Lt.colors.error.transparent}))}},w=({health:Lt})=>{const $t=qt(Lt),nn=$t?"error":"success",on=$t?"Recording error":"Recording";return(0,t.jsx)(G,{color:nn,text:on})},H=({state:Lt,health:$t})=>{let nn,on;switch(Lt){case C.cF.Inactive:on="success",nn="Normal";break;case C.cF.Firing:on="error",nn="Firing";break;case C.cF.Pending:on="warning",nn="Pending";break}return qt($t)&&(on="error",nn="Error"),$t==="nodata"&&(on="warning",nn="No data"),(0,t.jsx)(G,{color:on,text:nn})};function G({color:Lt,text:$t}){return(0,t.jsxs)(x.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(T,{color:Lt}),(0,t.jsx)(g.E,{variant:"bodySmall",color:Lt,children:$t})]})}var X=e(88569),k=e(89344),_=e(32370),ee=e(40479);const J=(0,a.lazy)(()=>e.e(1600).then(e.bind(e,81600))),Z=(0,a.lazy)(()=>Promise.all([e.e(825),e.e(9069)]).then(e.bind(e,19069))),te=({rule:Lt})=>{const $t=_.$.unifiedAlerting.alertStateHistoryBackend,nn=_.$.unifiedAlerting.alertStateHistoryPrimary,bn=[$t,nn].some(Yn=>Yn===ee.Q.Loki)?ee.Q.Loki:ee.Q.Annotations,In=Lt.grafana_alert.uid;return(0,t.jsxs)(a.Suspense,{fallback:"Loading...",children:[bn===ee.Q.Loki&&(0,t.jsx)(Z,{ruleUID:In}),bn===ee.Q.Annotations&&(0,t.jsx)(J,{ruleUID:In})]})};var ae=e(40828),re=e(5278);const ne=({rule:Lt})=>(0,t.jsx)(re.s,{rule:Lt,pagination:{itemsPerPage:ae.FG},enableFiltering:!0});var ce=e(93407),le=e(59577),he=e(76313),oe=e(49816),de=e(66384),me=e(12175),Pe=e(44684),Ee=e(71481),be=e(7484),Se=e(79198),Xe=e(34001),Qe=e(84703);function we({data:Lt,thresholds:$t}){return Lt?(0,t.jsx)(Qe.j,{data:Lt,thresholds:$t?.config,thresholdsType:$t?.mode}):null}var $e=e(20382),Fe=e(88214),Te=e(82096),Le=e(86618);const Ge=({expression:Lt})=>(0,t.jsx)(Le.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:Lt,width:"100%"});function Me(Lt){return"rawSql"in Lt}const De=null,Ke=a.lazy(()=>e.e(9906).then(e.bind(e,79906))),Ie=a.lazy(()=>e.e(7373).then(e.bind(e,27373)));function Ne({model:Lt,dataSource:$t}){return $t.type===Fe.ol.Prometheus&&(0,Te.Bu)(Lt)?(0,t.jsx)(Ke,{query:Lt.expr}):$t.type===Fe.ol.Loki&&(0,Te.Bu)(Lt)?(0,t.jsx)(Ie,{query:Lt.expr??""}):Me(Lt)?(0,t.jsx)(Ge,{expression:Lt.rawSql}):(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:(0,$e.Bh)(Lt)})})}var ie=e(747);function ve({rule:Lt,queries:$t,condition:nn,evalDataByQuery:on={}}){const bn=(0,r.keyBy)(Object.values(_.$.datasources),zt=>zt.uid),In=$t.filter(zt=>!(0,me.f)(zt.model)),Yn=$t.filter(zt=>(0,me.f)(zt.model)),zn=(0,d.of)(yt),St=(0,Xe.an)($t,nn);return(0,t.jsxs)(x.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,t.jsx)("div",{className:zn.maxWidthContainer,children:(0,t.jsx)(x.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:In.map(({model:zt,relativeTimeRange:Qt,refId:an,datasourceUid:mn},yn)=>{const Ct=bn[mn];return(0,t.jsx)(fe,{rule:Lt,refId:an,model:zt,relativeTimeRange:Qt,dataSource:Ct,thresholds:St[an],queryData:on[an]},yn)})})}),(0,t.jsx)("div",{className:zn.maxWidthContainer,children:(0,t.jsx)(x.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:Yn.map(({model:zt,refId:Qt,datasourceUid:an},mn)=>(0,me.f)(zt)&&(0,t.jsx)(Ve,{refId:Qt,isAlertCondition:nn===Qt,model:zt,evalData:on[Qt]},mn))})})]})}function fe({refId:Lt,rule:$t,thresholds:nn,model:on,dataSource:bn,queryData:In,relativeTimeRange:Yn}){const zn=(0,d.of)(je),St=(0,me.f)(on),[zt,Qt]=(0,ie.mh)($t,ie.j5.Explore),an=zt&&Qt,mn=[];if(bn){const Ct=bn.name??"[[Data source not found]]",ut=bn.meta.info.logos.small;mn.push((0,t.jsx)(xe,{name:Ct,imgUrl:ut},"datasource"))}Yn&&mn.push((0,t.jsxs)(g.E,{color:"secondary",children:[(0,le.secondsToHms)(Yn.from)," to now"]},"timerange"));let yn;return!St&&an&&(yn=bn&&ge(bn,on)),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ke,{refId:Lt,headerItems:mn,exploreLink:yn,children:(0,t.jsx)("div",{className:zn.queryPreviewWrapper,children:(0,t.jsx)(oe.Xw,{children:on&&bn&&(0,t.jsx)(Ne,{model:on,dataSource:bn})})})}),bn&&(0,t.jsx)(we,{data:In,thresholds:nn})]})}function ge(Lt,$t){const{uid:nn,type:on}=Lt,{refId:bn,...In}=$t;return ce.kM.renderUrl(`${_.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:Lt.uid,queries:[{refId:"A",...In,datasource:{type:on,uid:nn}}],range:{from:"now-1h",to:"now"}})})}function xe({name:Lt,imgUrl:$t}){const nn=(0,d.of)(je);return(0,t.jsxs)("div",{className:nn.dataSource,children:[(0,t.jsx)("img",{src:$t,width:16,alt:Lt}),Lt]},"datasource")}const je=Lt=>({queryPreviewWrapper:(0,n.css)({margin:Lt.spacing(1)}),contentBox:(0,n.css)({flex:"1 0 100%"}),dataSource:(0,n.css)({border:`1px solid ${Lt.colors.border.weak}`,borderRadius:Lt.shape.radius.default,padding:Lt.spacing(.5,1),display:"flex",alignItems:"center",gap:Lt.spacing(1)})});function Ve({refId:Lt,model:$t,evalData:nn,isAlertCondition:on}){const bn=(0,d.of)(Oe);function In(){switch($t.type){case Pe.Tz.math:return(0,t.jsx)(ze,{model:$t});case Pe.Tz.reduce:return(0,t.jsx)(Be,{model:$t});case Pe.Tz.resample:return(0,t.jsx)(tt,{model:$t});case Pe.Tz.classic:return(0,t.jsx)(nt,{model:$t});case Pe.Tz.threshold:return(0,t.jsx)(at,{model:$t});case Pe.Tz.sql:return(0,t.jsx)(he.l,{rawSql:$t.expression||"",datasourceType:$t.datasource?.type});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",$t.type]})}}return(0,t.jsxs)(ke,{refId:Lt,headerItems:[(0,t.jsx)(g.E,{color:"secondary",children:(0,r.startCase)($t.type)},"expression-type")],isAlertCondition:on,children:[(0,t.jsxs)("div",{className:bn.previewWrapper,children:[nn?.errors?.map(Yn=>(0,t.jsx)(s.F,{title:"Expression failed",severity:"error",bottomSpacing:1,children:Yn.message},(0,r.uniqueId)())),In()]}),(0,t.jsx)(be.h,{}),nn&&(0,t.jsx)(Se.GX,{series:nn.series,isAlertCondition:on})]})}function ke({refId:Lt,headerItems:$t=[],children:nn,isAlertCondition:on,exploreLink:bn}){const In=(0,d.of)(Oe);return(0,t.jsxs)("div",{className:(0,n.cx)(In.container),children:[(0,t.jsxs)("header",{className:In.header,children:[(0,t.jsx)("span",{className:In.refId,children:Lt}),$t,(0,t.jsx)(be.h,{}),on&&(0,t.jsx)(de.E,{color:"green",icon:"check",text:"Alert condition"}),bn&&(0,t.jsx)(I.d,{component:(0,t.jsx)(o.z9,{size:"md",variant:"secondary",icon:"compass",href:bn,children:"View in Explore"})})]}),nn]})}const Oe=Lt=>({container:(0,n.css)({flex:"1 0 25%",border:`1px solid ${Lt.colors.border.weak}`,maxWidth:"100%",borderRadius:Lt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,n.css)({display:"flex",alignItems:"center",gap:Lt.spacing(1),padding:Lt.spacing(1),backgroundColor:Lt.colors.background.secondary}),textBlock:(0,n.css)({border:`1px solid ${Lt.colors.border.weak}`,padding:Lt.spacing(.5,1),backgroundColor:Lt.colors.background.primary,borderRadius:Lt.shape.radius.default}),refId:(0,n.css)({color:Lt.colors.text.link,padding:Lt.spacing(.5,1),border:`1px solid ${Lt.colors.border.weak}`,borderRadius:Lt.shape.radius.default}),previewWrapper:(0,n.css)({padding:Lt.spacing(1)})});function nt({model:Lt}){const $t=(0,d.of)(Je),nn=(0,r.keyBy)(Ee.A.reducerTypes,In=>In.value),on=(0,r.keyBy)(Ee.A.evalOperators,In=>In.value),bn=(0,r.keyBy)(Ee.A.evalFunctions,In=>In.value);return(0,t.jsx)("div",{className:$t.container,children:Lt.conditions?.map(({query:In,operator:Yn,reducer:zn,evaluator:St},zt)=>{const Qt=ht(St);return(0,t.jsxs)(a.Fragment,{children:[(0,t.jsx)("div",{className:$t.blue,children:zt===0?"WHEN":!!Yn?.type&&on[Yn?.type]?.text}),(0,t.jsx)("div",{className:$t.bold,children:zn?.type&&nn[zn.type]?.text}),(0,t.jsx)("div",{className:$t.blue,children:"OF"}),(0,t.jsx)("div",{className:$t.bold,children:In.params[0]}),(0,t.jsx)("div",{className:$t.blue,children:bn[St.type].text}),(0,t.jsx)("div",{className:$t.bold,children:Qt?`(${St.params[0]}; ${St.params[1]})`:St.params[0]})]},zt)})})}const Je=Lt=>({container:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:Lt.spacing(0,1)}),...st(Lt)});function Be({model:Lt}){const $t=(0,d.of)(Ze),{reducer:nn,expression:on,settings:bn}=Lt,In=Pe.Cu.find(St=>St.value===nn),Yn=bn?.mode??Pe.Mt.Strict,zn=Pe.HZ.find(St=>St.value===Yn);return(0,t.jsxs)("div",{className:$t.container,children:[(0,t.jsx)("div",{className:$t.label,children:"Function"}),(0,t.jsx)("div",{className:$t.value,children:In?.label}),(0,t.jsx)("div",{className:$t.label,children:"Input"}),(0,t.jsx)("div",{className:$t.value,children:on}),(0,t.jsx)("div",{className:$t.label,children:"Mode"}),(0,t.jsx)("div",{className:$t.value,children:zn?.label})]})}const Ze=Lt=>({container:(0,n.css)({display:"grid",gap:Lt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...st(Lt)});function tt({model:Lt}){const $t=(0,d.of)(Re),{expression:nn,window:on,downsampler:bn,upsampler:In}=Lt,Yn=Pe.PN.find(St=>St.value===bn),zn=Pe.iX.find(St=>St.value===In);return(0,t.jsxs)("div",{className:$t.container,children:[(0,t.jsx)("div",{className:$t.label,children:"Input"}),(0,t.jsx)("div",{className:$t.value,children:nn}),(0,t.jsx)("div",{className:$t.label,children:"Resample to"}),(0,t.jsx)("div",{className:$t.value,children:on}),(0,t.jsx)("div",{className:$t.label,children:"Downsample"}),(0,t.jsx)("div",{className:$t.value,children:Yn?.label}),(0,t.jsx)("div",{className:$t.label,children:"Upsample"}),(0,t.jsx)("div",{className:$t.value,children:zn?.label})]})}const Re=Lt=>({container:(0,n.css)({display:"grid",gap:Lt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...st(Lt)});function at({model:Lt}){const $t=(0,d.of)(yt),{expression:nn,conditions:on}=Lt,bn=on&&on[0]?.evaluator,In=Pe.zd.find(Qt=>Qt.value===bn?.type),Yn=bn?ht(bn):!1,zn=on&&on[0]?.unloadEvaluator,St=Pe.zd.find(Qt=>Qt.value===zn?.type),zt=zn?ht(zn):!1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:$t.container,children:[(0,t.jsx)("div",{className:$t.label,children:"Input"}),(0,t.jsx)("div",{className:$t.value,children:nn}),bn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:$t.blue,children:In?.label}),(0,t.jsx)("div",{className:$t.bold,children:Yn?`(${bn.params[0]}; ${bn.params[1]})`:bn.params[0]})]})]}),(0,t.jsx)("div",{className:$t.container,children:zn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:$t.label,children:"Stop alerting when "}),(0,t.jsx)("div",{className:$t.value,children:nn}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:$t.blue,children:St?.label}),(0,t.jsx)("div",{className:$t.bold,children:zt?`(${zn.params[0]}; ${zn.params[1]})`:zn.params[0]})]})]})})]})}const yt=Lt=>{const{blue:$t,bold:nn,...on}=st(Lt);return{...on,maxWidthContainer:(0,n.css)({maxWidth:"100%"}),container:(0,n.css)({display:"flex",gap:Lt.spacing(.5)}),blue:(0,n.css)($t,{margin:"auto 0"}),bold:(0,n.css)(nn,{margin:"auto 0"})}};function ze({model:Lt}){const $t=(0,d.of)(yt),{expression:nn}=Lt;return(0,t.jsxs)("div",{className:$t.container,children:[(0,t.jsx)("div",{className:$t.label,children:"Input"}),(0,t.jsx)("div",{className:$t.value,children:nn})]})}const st=Lt=>({blue:(0,n.css)({color:Lt.colors.text.link}),bold:(0,n.css)({fontWeight:Lt.typography.fontWeightBold}),label:(0,n.css)({display:"flex",alignItems:"center",padding:Lt.spacing(.5,1),backgroundColor:Lt.colors.background.secondary,fontSize:Lt.typography.bodySmall.fontSize,lineHeight:Lt.typography.bodySmall.lineHeight,fontWeight:Lt.typography.fontWeightBold,borderRadius:Lt.shape.radius.default}),value:(0,n.css)({padding:Lt.spacing(.5,1),border:`1px solid ${Lt.colors.border.weak}`,borderRadius:Lt.shape.radius.default})});function ht(Lt){return Lt.type===Ee.p.IsWithinRange||Lt.type===Ee.p.IsOutsideRange||Lt.type===Ee.p.IsOutsideRangeIncluded||Lt.type===Ee.p.IsWithinRangeIncluded}var It=e(46329),Gt=e(1932),un=e(32266);function vn(Lt){if(!Lt)return[];const{namespace:$t,rulerRule:nn}=Lt,{rulesSource:on}=$t;if((0,O.lT)(nn)){const bn=nn.grafana_alert.data;return pn(bn,nn.for??"",Lt.group.interval)}if((0,Fe.Eb)(on)){const bn=cn(on,Lt);return[xn(bn,on.uid)]}return[]}function pn(Lt,$t,nn){const on=(0,un.P8)($t)??(0,un.P8)(nn??"1m"),bn=Math.floor(on/1e3);return Lt.map(In=>(0,Gt.jM)(In,Yn=>{const zn=Yn.relativeTimeRange?.from??0,St=Math.max(bn*3,zn+bn*2);Yn.relativeTimeRange={from:St,to:0}}))}function xn(Lt,$t){return{refId:Lt.refId,datasourceUid:$t,queryType:"",model:Lt,relativeTimeRange:{from:360,to:0}}}function cn(Lt,$t){const nn="A";switch(Lt.type){case"prometheus":return{refId:nn,expr:$t.query};case"loki":return{refId:nn,expr:$t.query};default:throw new Error(`Query for datasource type ${Lt.type} is currently not supported by cloud alert rules.`)}}var jn=e(35248);const _n=({rule:Lt})=>{const{queryPreviewData:$t,runQueries:nn,isPreviewLoading:on}=(0,jn.Y)(),bn=(0,a.useMemo)(()=>vn(Lt),[Lt]),{allDataSourcesAvailable:In}=(0,It.g)(bn),Yn=(0,a.useCallback)(()=>{if(bn.length>0&&In){let St;Lt&&(0,O.lT)(Lt.rulerRule)&&(St=Lt.rulerRule.grafana_alert.condition),nn(bn,St??"A")}},[bn,In,Lt,nn]);(0,a.useEffect)(()=>{In&&Yn()},[In,Yn]);const zn=(0,O.YN)(Lt.group);return on?(0,t.jsx)(f.x6,{i18nKey:"alerting.common.loading",children:"Loading..."}):(0,t.jsxs)(t.Fragment,{children:[(0,O.lT)(Lt.rulerRule)&&!zn&&(0,t.jsx)(ve,{rule:Lt,condition:Lt.rulerRule.grafana_alert.condition,queries:bn,evalDataByQuery:$t}),!(0,O.lT)(Lt.rulerRule)&&!zn&&$t&&Object.keys($t).length>0&&(0,t.jsx)(x.B,{direction:"column",gap:1,children:bn.map(St=>(0,t.jsx)(fe,{rule:Lt,refId:St.refId,model:St.model,dataSource:Object.values(_.$.datasources).find(zt=>zt.uid===St.datasourceUid),queryData:$t[St.refId],relativeTimeRange:St.relativeTimeRange},St.refId))}),!zn&&!In&&(0,t.jsx)(s.F,{title:(0,f.t)("alerting.rule-view.query.datasources-na.title","Query not available"),severity:"warning",children:(0,t.jsx)(f.x6,{i18nKey:"alerting.rule-view.query.datasources-na.description",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})})]})},Ot=()=>(0,t.jsx)(t.Fragment,{children:"Routing"});var Rt=(Lt=>(Lt.Query="query",Lt.Instances="instances",Lt.History="history",Lt.Routing="routing",Lt.Details="details",Lt.VersionHistory="version-history",Lt))(Rt||{});const Ye=(0,v.w)(),dt=()=>{const{rule:Lt,identifier:$t}=(0,V.k)(),{pageNav:nn,activeTab:on}=Tn(Lt),[bn,In]=(0,a.useState)(),{annotations:Yn,promRule:zn,rulerRule:St}=Lt,zt=qt(zn?.health),Qt=(0,O.Z8)(zn),an=(0,O.YN)(Lt.group),mn=(0,O.lT)(St)&&!!St.grafana_alert.provenance,yn=(0,O.lT)(St)&&(0,O.HH)(St),Ct=zt&&!yn,ut=St?(0,O.uo)(St):(0,O.uo)(zn),Et=Yn[S.YH.summary];return(0,t.jsxs)(B.d,{pageNav:nn,navId:"alert-list",isLoading:!1,renderTitle:Ut=>(0,t.jsx)(Bt,{name:Ut,paused:yn,state:Qt?zn.state:void 0,health:zn?.health,ruleType:zn?.type,ruleOrigin:ut}),actions:(0,t.jsx)(h.l,{rule:Lt,rulesSource:Lt.namespace.rulesSource}),info:lt(Lt),subTitle:(0,t.jsxs)(x.B,{direction:"column",children:[yn&&(0,t.jsx)(p.A,{}),Et,an&&(0,t.jsx)(A,{}),mn&&(0,t.jsx)(F.Yi,{resource:F.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Ct&&(0,t.jsx)(s.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2,children:(0,t.jsx)("pre",{style:{marginBottom:0},children:(0,t.jsx)("code",{children:Lt.promRule?.lastError??"No error message"})})})]}),children:[Ye&&(0,t.jsx)(Jt,{ruleIdentifier:$t}),(0,t.jsx)(x.B,{direction:"column",gap:2,children:(0,t.jsxs)(c.J,{children:[on==="query"&&(0,t.jsx)(_n,{rule:Lt}),on==="instances"&&(0,t.jsx)(ne,{rule:Lt}),on==="history"&&(0,O.lT)(Lt.rulerRule)&&(0,t.jsx)(te,{rule:Lt.rulerRule}),on==="routing"&&(0,t.jsx)(Ot,{}),on==="details"&&(0,t.jsx)(k.B,{rule:Lt}),on==="version-history"&&(0,O.lT)(Lt.rulerRule)&&(0,t.jsx)(X.f,{ruleUid:Lt.rulerRule.grafana_alert.uid})]})}),bn&&(0,t.jsx)(W.Z,{redirectTo:!0,identifier:bn,isProvisioned:mn,onDismiss:()=>In(void 0)})]})},lt=Lt=>{const{labels:$t,annotations:nn,group:on}=Lt,bn=[],In=nn[S.YH.runbookURL],Yn=nn[S.YH.dashboardUID],zn=nn[S.YH.panelID],St=Yn&&zn,zt=Yn,Qt=!(0,r.isEmpty)($t),an=on.interval,mn=(0,d.of)(ps);if(In){const yn=(0,r.truncate)(In,{length:42}),Ct=es(In)?(0,t.jsx)(u.Y,{variant:"bodySmall",className:mn.url,href:In,external:!0,children:yn}):(0,t.jsx)(g.E,{variant:"bodySmall",children:yn});bn.push({label:"Runbook URL",value:Ct})}if(St?bn.push({label:"Dashboard and panel",value:(0,t.jsx)(I.d,{title:Lt.name,component:(0,t.jsx)(u.Y,{variant:"bodySmall",href:(0,M.D2)(Yn,zn),children:"View panel"})})}):zt&&bn.push({label:"Dashboard",value:(0,t.jsx)(I.d,{title:Lt.name,component:(0,t.jsx)(u.Y,{title:Lt.name,variant:"bodySmall",href:(0,M.JM)(Yn),children:"View dashboard"})})}),(0,O.Gy)(Lt.rulerRule)){const yn=Lt.rulerRule?.grafana_alert.record?.metric??"";bn.push({label:"Metric name",value:(0,t.jsx)(g.E,{color:"primary",children:yn})})}return an&&bn.push({label:"Evaluation interval",value:(0,t.jsxs)(g.E,{color:"primary",children:["Every ",an]})}),Qt&&bn.push({label:"Labels",value:(0,t.jsx)(L.m,{labels:$t,size:"sm"})}),bn},Pt=Lt=>{const $t=new URLSearchParams([["search",Lt.map(([nn,on])=>`${nn}:"${on}"`).join(" ")]]);return(0,R.G)("/alerting/list",$t)},Bt=({name:Lt,paused:$t=!1,state:nn,health:on,ruleType:bn,ruleOrigin:In})=>{const Yn=bn===C.JS.Recording,{returnTo:zn}=(0,P.h)("/alerting/list");return(0,t.jsxs)(x.B,{direction:"row",gap:1,minWidth:0,alignItems:"center",children:[(0,t.jsx)(o.z9,{variant:"secondary",icon:"angle-left",href:zn}),In&&(0,t.jsx)(b.T,{pluginId:In.pluginId,size:"lg"}),(0,t.jsx)(g.E,{variant:"h1",truncate:!0,children:Lt}),$t?(0,t.jsx)(K,{}):(0,t.jsxs)(t.Fragment,{children:[nn&&(0,t.jsx)(H,{state:nn,health:on}),Yn&&(0,t.jsx)(w,{health:on})]})]})};function Jt({ruleIdentifier:Lt}){const[$t,{width:nn}]=(0,i.A)(),{isConsistent:on,error:bn}=(0,y.f)(Lt);return on?null:bn?(0,t.jsx)(s.F,{title:"Unable to check the rule status",bottomSpacing:0,topSpacing:2,children:(0,M.JZ)(bn)}):(0,t.jsxs)(x.B,{direction:"column",gap:0,ref:$t,children:[(0,t.jsx)(E.G,{width:nn}),(0,t.jsx)(s.F,{title:(0,f.t)("alerting.rule-viewer.prometheus-consistency-check.alert-title","Update in progress"),severity:"info",children:(0,t.jsx)(f.x6,{i18nKey:"alerting.rule-viewer.prometheus-consistency-check.alert-message",children:"Alert rule has been updated. Changes may take up to a minute to appear on the Alert rules list view."})})]})}const qt=Lt=>Lt==="error"||Lt==="err";function gn(){const[Lt,$t]=(0,m.s)(),nn=Lt.tab;return[On(nn)?nn:"query",In=>{$t({tab:In})}]}function On(Lt){return typeof Lt=="string"&&Object.values(Rt).includes(Lt)}function Tn(Lt){const[$t,nn]=gn(),{annotations:on,promRule:bn,rulerRule:In}=Lt,Yn=on[S.YH.summary],zn=(0,O.Z8)(bn),St=zn?wn(Lt.instanceTotals):void 0,zt=(0,U.EL)(Lt.namespace).name,Qt=Lt.group.name,an=(0,O.lT)(In)&&zn,mn=(0,O.Gy)(In),yn=(0,O.KB)(bn);return{pageNav:{...l.defaultPageNav,text:Lt.name,subTitle:Yn,children:[{text:"Query and conditions",active:$t==="query",onClick:()=>{nn("query")}},{text:"Instances",active:$t==="instances",onClick:()=>{nn("instances")},tabCounter:St,hideFromTabs:yn},{text:"History",active:$t==="history",onClick:()=>{nn("history")},hideFromTabs:!an},{text:"Details",active:$t==="details",onClick:()=>{nn("details")}},{text:"Versions",active:$t==="version-history",onClick:()=>{nn("version-history")},hideFromTabs:!an&&!mn}],parentItem:{text:Qt,url:Pt([["namespace",zt],["group",Qt]]),parentItem:{text:zt,url:Pt([["namespace",zt]])}}},activeTab:$t}}const wn=Lt=>(0,r.chain)(Lt).pick([D.$7.Alerting,D.$7.Pending,D.$7.Normal,D.$7.NoData,D.$7.Error]).values().sum().value(),ps=()=>({title:(0,n.css)({display:"flex",alignItems:"center",gap:8,minWidth:0}),url:(0,n.css)({wordBreak:"break-all"})});function es(Lt){const $t=Lt.startsWith("/");let nn=!1;try{new URL(Lt),nn=!0}catch{return!1}return $t||nn}const ls=dt},88569:(q,j,e)=>{"use strict";e.d(j,{f:()=>K,R:()=>N});var t=e(74848),n=e(96540),r=e(32370),a=e(37e3),i=e(81876),x=e(59830),s=e(48583),c=e(45565),d=e(6736),u=e(54594),g=e(58528),o=e(90231),E=e(2543),m=e(88090),f=e(79784),p=e(76080),h=e(11817),D=e(6253),C=e(51738),l=e(91354);const v=({info:T})=>{const{created:z,createdBy:w,version:H,message:G=""}=T,X=(0,m.fq)(z);return(0,t.jsxs)(h.x6,{i18nKey:"core.versionHistory.comparison.header.text",children:["Version ",{version:H}," updated by ",{createdBy:w}," (",{ageString:X},") ",{message:G}]})},y=({oldSummary:T,newSummary:z,oldVersion:w,newVersion:H,preprocessVersion:G=E.identity})=>{const X=(0,l.G4)(G(w),G(H)),k=Object.entries(X).length===0,[_,ee]=(0,n.useState)(k);return(0,t.jsxs)(s.B,{gap:2,direction:"column",children:[(0,t.jsx)(o.a,{children:(0,t.jsxs)(c.E,{variant:"h5",element:"h4",children:[(0,t.jsx)(v,{info:T}),(0,t.jsx)(f.I,{name:"arrow-right"}),(0,t.jsx)(v,{info:z})]})}),(0,t.jsxs)(o.a,{children:[k&&(0,t.jsx)(x.p,{message:(0,h.t)("core.versionHistory.no-properties-changed","No relevant properties changed"),variant:"not-found",hideImage:!0,children:(0,t.jsx)(h.x6,{i18nKey:"core.versionHistory.view-json-diff",children:"View JSON diff to see all changes"})}),Object.entries(X).map(([J,Z])=>(0,t.jsx)(D.D,{diffs:Z,title:J},J)),(0,t.jsx)(p.c,{})]}),(0,t.jsxs)(o.a,{children:[_&&(0,t.jsx)(u.$n,{variant:"secondary",onClick:()=>ee(!1),children:(0,t.jsx)(h.x6,{i18nKey:"core.versionHistory.comparison.header.hide-json-diff",children:"Hide JSON diff "})}),!_&&(0,t.jsx)(u.$n,{variant:"secondary",onClick:()=>ee(!0),children:(0,t.jsx)(h.x6,{i18nKey:"core.versionHistory.comparison.header.show-json-diff",children:"Show JSON diff "})})]}),_&&(0,t.jsx)(C.M,{oldValue:JSON.stringify(w,null,2),newValue:JSON.stringify(H,null,2)})]})};var P=e(83893),b=e(5240),S=e(85651),M=e(81942),O=e(66384),R=e(14123),L=e(65164),B=e(65456),F=e(39378);const I=20;function U({onVersionsChecked:T,ruleVersions:z,disableSelection:w,checkedVersions:H}){const[G,X]=(0,n.useState)(!1),[k,_]=(0,n.useState)(),ee=ae=>{const re=z[0],ne=z.find(ce=>String(ce.grafana_alert.version)===ae);ne&&(X(!0),_((0,l.G4)(re,ne)))},J=()=>{X(!1)},Z=(0,h.t)("alerting.alertVersionHistory.unknown","Unknown"),te=[{disableGrow:!0,id:"id",header:(0,h.t)("core.versionHistory.table.version","Version"),cell:({row:ae})=>{const re=String(ae.original.grafana_alert.version),ne=H.has(String(re??!1))??!1;return(0,t.jsx)(s.B,{direction:"row",children:(0,t.jsx)(M.S,{label:re,checked:ne,disabled:w&&!ne,onChange:()=>{T(re)}})})}},{id:"createdBy",header:(0,h.t)("core.versionHistory.table.updatedBy","Updated By"),disableGrow:!0,cell:({row:ae})=>(0,t.jsx)(F.m,{user:ae.original.grafana_alert.updated_by})},{id:"created",header:(0,h.t)("core.versionHistory.table.updated","Date"),disableGrow:!0,cell:({row:ae})=>{const re=ae.original.grafana_alert.updated;return re?(0,m.LE)(re)+" ("+(0,m.fq)(re)+")":Z}},{id:"diff",disableGrow:!0,cell:({rows:ae,row:re})=>{const ce=re.index===z.length-1?{}:ae[re.index+1]?.original,le=re.original,he=(0,B.h)(ce,le),oe=`+${he.added}`,de=`-${he.removed}`;return(0,t.jsxs)(s.B,{alignItems:"baseline",gap:.5,children:[(0,t.jsx)(c.E,{color:"success",variant:"bodySmall",children:oe}),(0,t.jsx)(c.E,{color:"error",variant:"bodySmall",children:de})]})}},{id:"actions",disableGrow:!0,cell:({row:ae})=>{const re=ae.index===0;return(0,t.jsx)(s.B,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:re?(0,t.jsx)(O.E,{text:(0,h.t)("alerting.alertVersionHistory.latest","Latest"),color:"blue"}):r.$.featureToggles.alertingRuleVersionHistoryRestore?(0,t.jsx)(u.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{ee(ae.values.id)},children:(0,t.jsx)(h.x6,{i18nKey:"alerting.alertVersionHistory.restore",children:"Restore"})}):null})}}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.j,{pageSize:I,columns:te,data:z,getRowId:ae=>`${ae.grafana_alert.version}`}),(0,t.jsx)(L.u,{isOpen:G,title:(0,h.t)("alerting.alertVersionHistory.restore-modal.title","Restore Version"),body:(0,t.jsxs)(s.B,{direction:"column",gap:2,children:[(0,t.jsx)(h.x6,{i18nKey:"alerting.alertVersionHistory.restore-modal.body",children:"Are you sure you want to restore the alert rule definition to this version? All unsaved changes will be lost."}),(0,t.jsx)(c.E,{variant:"h6",children:(0,t.jsx)(h.x6,{i18nKey:"alerting.alertVersionHistory.restore-modal.summary",children:"Summary of changes to be applied:"})}),(0,t.jsx)("div",{children:k&&(0,t.jsx)(t.Fragment,{children:Object.entries(k).map(([ae,re])=>(0,t.jsx)(D.D,{diffs:re,title:ae},ae))})})]}),confirmText:"Yes, restore configuration",onConfirm:()=>{J()},onDismiss:()=>J()})]})}var W=e(96965);const{useGetAlertVersionHistoryQuery:A}=b.hK,N=["id","uid","updated","updated_by","version"];function K({ruleUid:T}){const{isLoading:z,currentData:w=[],error:H}=A({uid:T}),[G,X]=(0,n.useState)(),[k,_]=(0,n.useState)(),[ee,J]=(0,n.useState)(!1),[Z,te]=(0,n.useState)(new Set),ae=(0,n.useMemo)(()=>Z.size>1,[Z]);if(H)return(0,t.jsx)(a.F,{title:(0,h.t)("alerting.alertVersionHistory.errorloading","Failed to load alert rule versions"),children:(0,S.JZ)(H)});if(z)return(0,t.jsx)(i._,{text:(0,h.t)("alerting.common.loading","Loading...")});if(!w.length)return(0,P.fH)(P.le.noAlertRuleVersionsFound,{ruleUid:T}),(0,t.jsx)(x.p,{variant:"not-found",message:(0,h.t)("alerting.alertVersionHistory.noVersionsFound","No versions found for this rule")});const re=()=>{const[ce,le]=w.filter(he=>{const oe=he.grafana_alert.version;if(!(!oe&&oe!==0))return Z.has(String(he.grafana_alert.version))}).sort((he,oe)=>{const de=he.grafana_alert.version,me=oe.grafana_alert.version;return de===void 0||me===void 0?0:de-me});(0,P.iF)({latest:le===w[0],oldVersion:ce?.grafana_alert.version||0,newVersion:le?.grafana_alert.version||0}),X(ce),_(le),J(!0)};function ne(ce){te(le=>{const he=new Set(le);return he.has(ce)?he.delete(ce):he.add(ce),he}),X(void 0),_(void 0)}return(0,t.jsxs)(s.B,{direction:"column",gap:2,children:[(0,t.jsx)(c.E,{variant:"body",children:(0,t.jsx)(h.x6,{i18nKey:"alerting.alertVersionHistory.description",children:"Each time you edit the alert rule, a new version is created. Select two versions below and compare their differences."})}),(0,t.jsx)(s.B,{children:(0,t.jsx)(d.m,{content:(0,h.t)("core.versionHistory.comparison.select","Select two versions to start comparing"),placement:"bottom",children:(0,t.jsx)(u.$n,{type:"button",disabled:!ae,onClick:re,icon:"code-branch",children:(0,t.jsx)(h.x6,{i18nKey:"alerting.alertVersionHistory.compareVersions",children:"Compare versions"})})})}),ee&&G&&k&&(0,t.jsxs)(g._,{onClose:()=>J(!1),title:(0,h.t)("alerting.alertVersionHistory.comparing-versions","Comparing versions"),children:[(0,t.jsx)(y,{oldSummary:V(G),oldVersion:G,newSummary:V(k),newVersion:k,preprocessVersion:W.L}),r.$.featureToggles.alertingRuleVersionHistoryRestore&&(0,t.jsx)(o.a,{paddingTop:2,children:(0,t.jsx)(s.B,{justifyContent:"flex-end",children:(0,t.jsx)(u.$n,{variant:"destructive",onClick:()=>{},children:(0,t.jsxs)(h.x6,{i18nKey:"alerting.alertVersionHistory.reset",children:["Reset to version ",{version:G.grafana_alert.version}]})})})})]}),(0,t.jsx)(U,{onVersionsChecked:ne,ruleVersions:w,disableSelection:ae,checkedVersions:Z})]})}function V(T){const z=(0,h.t)("alerting.alertVersionHistory.unknown","Unknown"),w=(0,W.J)(),H=(()=>{const G=T?.grafana_alert.updated_by,X=G?.uid,k=G?.name;return G?X&&w[X]?w[X].name:k||(X?(0,h.t)("alerting.alertVersionHistory.user-id","User ID {{uid}}",{uid:X}):z):z})();return{created:T.grafana_alert.updated||z,createdBy:H,version:T.grafana_alert.version||z}}},89344:(q,j,e)=>{"use strict";e.d(j,{$:()=>b,B:()=>P});var t=e(74848),n=e(22803),r=e(74226),a=e(88090),i=e(48583),x=e(45565),s=e(29675),c=e(79784),d=e(54731),u=e(11817),g=e(94485),o=e(82700),E=e(32266),m=e(5487),f=e(90231),p=e(6736),h=e(93604),D=e(76966);const C=({id:M,label:O,value:R,monospace:L,showCopyButton:B,copyValue:F,tooltipValue:I})=>{const U=(0,u.t)("alerting.copy-to-clipboard",'Copy "{{label}}" to clipboard',{label:O});return(0,t.jsx)(f.a,{children:(0,t.jsxs)(i.B,{direction:"column",gap:0,children:[(0,t.jsx)(x.E,{color:"secondary",id:M,children:O}),(0,t.jsxs)(x.E,{"aria-labelledby":M,color:"primary",variant:L?"code":"body",children:[(0,t.jsx)(D.A,{shouldWrap:!!I,wrap:W=>(0,t.jsx)(p.m,{content:I,children:W}),children:(0,t.jsx)("span",{children:R})}),B&&(0,t.jsx)(h.b,{"aria-label":U,fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:()=>F})]})]})})};var l=e(39378),v=(M=>(M.GrafanaManagedAlertRule="Grafana-managed alert rule",M.GrafanaManagedRecordingRule="Grafana-managed recording rule",M.CloudAlertRule="Cloud alert rule",M.CloudRecordingRule="Cloud recording rule",M))(v||{});const y=({title:M,children:O})=>(0,t.jsxs)(i.B,{direction:"column",gap:1,children:[(0,t.jsx)(x.E,{variant:"h4",children:M}),(0,t.jsx)(i.B,{direction:"column",gap:2,children:O})]}),P=({rule:M})=>{const O=(0,s.of)(S);let R;const L=(0,g.G)(M);(0,o.lT)(M.rulerRule)?R=(0,o.Gy)(M.rulerRule)?"Grafana-managed recording rule":"Grafana-managed alert rule":(0,o.i7)(M.rulerRule)?R="Cloud recording rule":R="Cloud alert rule";const B=M.promRule?.evaluationTime,F=M.promRule?.lastEvaluation,I=(0,o.Rh)(M),U=Number.isFinite(B),W=(0,o.lT)(M.rulerRule)?M.rulerRule.grafana_alert.updated:void 0,A=(0,o.pv)(M.rulerRule)&&M.rulerRule.grafana_alert.is_paused,N=(0,t.jsxs)(i.B,{children:[(0,t.jsx)(x.E,{color:"warning",children:(0,t.jsx)(c.I,{name:"pause-circle"})}),(0,t.jsx)(x.E,{children:(0,t.jsx)(u.x6,{i18nKey:"alerting.alert.evaluation-paused",children:"Alert evaluation currently paused"})})]});return(0,t.jsxs)("div",{className:O.metadata,children:[(0,t.jsxs)(y,{title:(0,u.t)("alerting.alert.rule","Rule"),children:[(0,t.jsx)(C,{id:"rule-type",label:(0,u.t)("alerting.alert.rule-type","Rule type"),value:R}),(0,o.lT)(M.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C,{id:"rule-type",label:(0,u.t)("alerting.alert.rule-identifier","Rule identifier"),value:M.rulerRule.grafana_alert.uid,monospace:!0,showCopyButton:!0,copyValue:M.rulerRule.grafana_alert.uid}),(0,t.jsx)(C,{id:"last-updated-by",label:(0,u.t)("alerting.alert.last-updated-by","Last updated by"),value:(0,t.jsx)(l.m,{user:M.rulerRule.grafana_alert.updated_by})}),W&&(0,t.jsx)(C,{id:"date-of-last-update",label:(0,u.t)("alerting.alert.last-updated-at","Last updated at"),value:(0,a.LE)(W)+` (${(0,a.fq)(W)})`})]})]}),(0,t.jsxs)(y,{title:(0,u.t)("alerting.alert.evaluation","Evaluation"),children:[A?N:(0,t.jsxs)(t.Fragment,{children:[U&&F&&(0,t.jsx)(C,{id:"last-evaluated",label:(0,u.t)("alerting.alert.last-evaluated","Last evaluated"),value:(0,E.mo)(F)?"-":(0,r.B)(new Date(F),{addSuffix:!0}),tooltipValue:(0,E.mo)(F)?void 0:(0,a.LE)(F)}),U&&(0,t.jsx)(C,{id:"last-evaluation-duration",label:(0,u.t)("alerting.alert.last-evaluation-duration","Last evaluation duration"),value:A?N:`${B} ms`})]}),L&&(0,t.jsx)(C,{id:"pending-period",label:(0,u.t)("alerting.alert.pending-period","Pending period"),value:L})]}),(0,o.lT)(M.rulerRule)&&M.rulerRule.grafana_alert.no_data_state&&M.rulerRule.grafana_alert.exec_err_state&&(0,t.jsxs)(y,{title:(0,u.t)("alerting.alert.alert-state","Alert state"),children:[U&&(0,t.jsx)(C,{id:"alert-state-no-data",label:(0,u.t)("alerting.alert.state-no-data","Alert state if no data or all values are null"),value:M.rulerRule.grafana_alert.no_data_state}),L&&(0,t.jsx)(C,{id:"alert-state-exec-err",label:(0,u.t)("alerting.alert.state-error-timeout","Alert state if execution error or timeout"),value:M.rulerRule.grafana_alert.exec_err_state})]}),I&&(0,t.jsx)(y,{title:(0,u.t)("alerting.alert.annotations","Annotations"),children:Object.keys(I).length===0?(0,t.jsx)("div",{children:(0,t.jsx)(x.E,{color:"secondary",italic:!0,children:(0,t.jsx)(u.x6,{i18nKey:"alerting.alert.no-annotations",children:"No annotations"})})}):Object.entries(I).map(([K,V])=>{const T=`annotation-${K.replace(/\s/g,"-")}`;return(0,t.jsx)(C,{id:T,label:K,value:(0,t.jsx)(b,{value:V})},K)})})]})};function b({value:M}){const O=M&&M.startsWith("http"),R=(0,t.jsx)(m.Y,{input:M,delimiter:["{{","}}"]});return O?(0,t.jsx)(d.Y,{href:M,external:!0,children:M}):(0,t.jsx)(x.E,{color:"primary",children:R})}const S=M=>({metadata:(0,n.css)({display:"grid",gap:M.spacing(4),gridTemplateColumns:"1fr 1fr 1fr",[M.breakpoints.down("lg")]:{gridTemplateColumns:"1fr 1fr"},[M.breakpoints.down("sm")]:{gridTemplateColumns:"1fr"}})})},39378:(q,j,e)=>{"use strict";e.d(j,{m:()=>d});var t=e(74848),n=e(22803),r=e(29675),a=e(6736),i=e(79784),x=e(66384),s=e(11817),c=e(96965);const d=({user:g})=>{const o=(0,s.t)("alerting.alertVersionHistory.unknown","Unknown"),E=(0,c.J)(),m=(0,r.of)(u),f=(0,t.jsx)(a.m,{content:(0,s.t)("alerting.alertVersionHistory.unknown-change-description","This update was made prior to the implementation of alert rule version history. The user who made the change is not tracked, but future changes will include the user"),children:(0,t.jsxs)("span",{children:[(0,t.jsxs)("span",{className:m.underline,children:[o," "]}),(0,t.jsx)(i.I,{name:"question-circle"})]})});if(!g)return f;const p=E[g.uid];return p||!g?(0,t.jsx)(a.m,{content:p.tooltipContent,children:(0,t.jsx)("span",{children:(0,t.jsx)(x.E,{className:m.badge,text:p.name,color:p.badgeColor,icon:p.icon})})}):g.name?g.name:g.uid?(0,s.t)("alerting.alertVersionHistory.user-id","User ID {{uid}}",{uid:g.uid}):f},u=()=>({badge:(0,n.css)({cursor:"help"}),underline:(0,n.css)({textDecoration:"underline dotted",textUnderlineOffset:"5px",cursor:"help"})})},96965:(q,j,e)=>{"use strict";e.d(j,{J:()=>r,L:()=>a});var t=e(11817),n=e(88569);const r=()=>{const i={name:(0,t.t)("alerting.alertVersionHistory.provisioning","Provisioning"),tooltipContent:(0,t.t)("alerting.alertVersionHistory.provisioning-change-description","Version update was made via provisioning"),badgeColor:"purple"};return{__alerting__:{name:(0,t.t)("alerting.alertVersionHistory.alerting","Alerting"),tooltipContent:(0,t.t)("alerting.alertVersionHistory.alerting-change-description","This update was made by the alerting system due to other changes. For example, when renaming a contact point that is used for simplified routing, this will update affected rules"),badgeColor:"orange",icon:"bell"},service:i,__provisioning__:i}};function a(i){const{grafana_alert:x,...s}=i,c={for:(0,t.t)("alerting.alertVersionHistory.pendingPeriod","Pending period"),annotations:(0,t.t)("alerting.alertVersionHistory.annotations","Annotations"),labels:(0,t.t)("alerting.alertVersionHistory.labels","Labels")},d={title:(0,t.t)("alerting.alertVersionHistory.name","Name"),namespace_uid:(0,t.t)("alerting.alertVersionHistory.namespace_uid","Folder UID"),data:(0,t.t)("alerting.alertVersionHistory.queryAndAlertCondition","Query and alert condition"),notification_settings:(0,t.t)("alerting.alertVersionHistory.contactPointRouting","Contact point routing"),no_data_state:(0,t.t)("alerting.alertVersionHistory.noDataState","Alert state when no data"),exec_err_state:(0,t.t)("alerting.alertVersionHistory.execErrorState","Alert state when execution error"),is_paused:(0,t.t)("alerting.alertVersionHistory.paused","Paused state"),rule_group:(0,t.t)("alerting.alertVersionHistory.rule_group","Rule group"),condition:(0,t.t)("alerting.alertVersionHistory.condition","Alert condition"),intervalSeconds:(0,t.t)("alerting.alertVersionHistory.intervalSeconds","Evaluation interval")},u=Object.entries(s).reduce((o,[E,m])=>{const p=c[E]||E;return{...o,[p]:m}},{}),g=Object.entries(x).reduce((o,[E,m])=>{const f=E;if(n.R.includes(f))return o;const p=d[f]||E;return{...o,[p]:m}},{});return{...u,...g}}},57732:(q,j,e)=>{"use strict";e.d(j,{D:()=>l});var t=e(74848),n=e(96540),r=e(55515),a=e(3202),i=e(93253),x=e(82700),s=e(3429),c=e(50585),d=e(29012),u=e(60232),g=e(99764),o=e(22099),E=e(69531);const m=({rule:y,instance:P,extensionPointId:b})=>{const[S,M]=(0,n.useState)(),O=(0,n.useMemo)(()=>({instance:P,rule:y}),[P,y]),{links:R}=(0,d.U)({context:O,extensionPointId:b,limitPerPlugin:3});if(R.length===0)return null;const L=(0,t.jsx)(E.w,{extensions:R,onSelect:M});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.m,{placement:"bottom-start",overlay:L,children:(0,t.jsx)(g.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})}),!!S&&!!S.path&&(0,t.jsx)(o.s,{path:S.path,title:S.title,onDismiss:()=>M(void 0)})]})};var f=e(44307),p=e(9985),h=e(83650);const D=({instance:y})=>{const P=(0,f.Hx)(y.annotations),b=(0,f.gO)(P);return(0,t.jsxs)("div",{children:[y.value&&(0,t.jsx)(h.X,{label:"Value",horizontal:!0,children:y.value}),P.map(([S,M])=>(0,t.jsx)(p.s,{annotationKey:S,value:M,valueLink:b.get(S)},S))]})};var C=e(17025);const l=({rule:y,instances:P,pagination:b,footerRow:S})=>{const M=(0,n.useMemo)(()=>P.length>1?(0,r.yO)(P.map(R=>R.labels)):{},[P]),O=(0,n.useMemo)(()=>P.map(R=>({data:{rule:y,alert:{...R,commonLabels:M}},id:(0,x.RI)(R)})),[M,P,y]);return(0,t.jsx)(c.E,{cols:v,isExpandable:!0,items:O,renderExpandedContent:({data:R})=>(0,t.jsx)(D,{instance:R.alert}),pagination:b,footerRow:S})},v=[{id:"state",label:"State",renderCell:({data:{alert:{state:y}}})=>(0,t.jsx)(C.C,{state:y}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:y,commonLabels:P}}})=>(0,t.jsx)(s.m,{labels:y,commonLabels:P,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:y}}})=>(0,t.jsx)(t.Fragment,{children:y.startsWith("0001")?"-":(0,a.KQ)(y).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:y,rule:P}})=>(0,t.jsx)(m,{rule:P,instance:y,extensionPointId:i.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},17025:(q,j,e)=>{"use strict";e.d(j,{C:()=>s});var t=e(74848),n=e(96540),r=e(6736),a=e(79784),i=e(82700),x=e(22245);const s=(0,n.memo)(({state:c,isPaused:d=!1,size:u="md",muted:g=!1})=>d?(0,t.jsx)(r.m,{content:"Alert evaluation is currently paused",placement:"top",children:(0,t.jsxs)(x.O,{state:"warning",size:u,muted:g,children:[(0,t.jsx)(a.I,{name:"pause",size:"xs"})," Paused"]})}):(0,t.jsx)(x.O,{state:(0,i.Wy)(c),size:u,muted:g,children:(0,i.XI)(c)}));s.displayName="AlertStateTag"},90319:(q,j,e)=>{"use strict";e.d(j,{Z:()=>s});var t=e(74848),n=e(96540),r=e(54148),a=e(65164),i=e(54594),x=e(68639);function s({identifier:d,isProvisioned:u,redirectTo:g=!1,onDismiss:o}){const E=(0,r.zy)(),[m,f]=(0,n.useState)(u?"confirm":"redirect");if(m==="redirect"){const p=x.$9(d),h=E.pathname+E.search,D=new URLSearchParams({copyFrom:p,returnTo:g?h:""});return(0,t.jsx)(r.C5,{to:"/alerting/new?"+D.toString(),replace:!1})}return(0,t.jsx)(a.u,{isOpen:m==="confirm",title:"Copy provisioned alert rule",body:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["The new rule will ",(0,t.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]}),(0,t.jsx)("p",{children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})]}),confirmText:"Copy",onConfirm:()=>f("redirect"),onDismiss:o})}const c=(0,n.forwardRef)(({text:d,ruleIdentifier:u,isProvisioned:g,className:o},E)=>{const[m,f]=(0,n.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.$n,{title:"Copy",className:o,size:"sm",variant:"secondary",icon:"copy",onClick:()=>f(!0),ref:E,children:d},"clone"),m&&(0,t.jsx)(s,{identifier:u,isProvisioned:g,onDismiss:()=>f(!1)})]})});c.displayName="CloneRuleButton"},12626:(q,j,e)=>{"use strict";e.d(j,{l:()=>y});var t=e(74848),n=e(96540),r=e(54594),a=e(48583),i=e(11817),x=e(38310),s=e(34542),c=e(6774),d=e(19423),u=e(19127),g=e(61491),o=e(747),E=e(48542),m=e(88214),f=e(98775),p=e(85651),h=e(68639),D=e(82700),C=e(35874),l=e(90319);const v=P=>window.matchMedia(`(max-width: ${P}px)`).matches,y=({compact:P,showViewButton:b,rule:S,rulesSource:M})=>{const O=(0,g.useDispatch)(),R=!P,[L,B]=(0,s.w)(R),[F,I]=(0,n.useState)(!1),[U,W]=(0,n.useState)(void 0),{namespace:A,group:N,rulerRule:K}=S,{hasActiveFilters:V}=(0,u.dI)(),T=(0,D.lT)(S.rulerRule)&&!!S.rulerRule.grafana_alert.provenance,[z,w]=(0,o.mh)(S,o.j5.Update),H=z&&w,G=[],X=P?"sm":"md",k=(0,m.EV)(M),_=h.UP(k,S),ee=f.HA.fromCombinedRule(S);if(b&&G.push((0,t.jsx)(r.z9,{title:"View",size:X,variant:"secondary",icon:"eye",href:(0,p.w$)(M,S),children:(0,t.jsx)(i.x6,{i18nKey:"common.view",children:"View"})},"view")),K&&H){const J=h.P1(k,A.name,N.name,K),Z=(0,C.G)(`/alerting/${encodeURIComponent(h.$9(J))}/edit`);G.push((0,t.jsx)(r.z9,{title:"Edit",size:X,variant:"secondary",icon:"pen",href:Z,children:(0,t.jsx)(i.x6,{i18nKey:"common.edit",children:"Edit"})},"edit"))}return S.promRule?(0,t.jsxs)(a.B,{gap:1,alignItems:"center",wrap:"nowrap",children:[G,(0,t.jsx)(x.A,{rulerRule:S.rulerRule,promRule:S.promRule,identifier:_,groupIdentifier:ee,handleDelete:()=>{if(S.rulerRule){const J=h.co(ee,S.rulerRule);B(J,ee)}},handleSilence:()=>I(!0),handleDuplicateRule:()=>W({identifier:_,isProvisioned:T}),onPauseChange:()=>{const J=V?void 0:c.Ys+1;O((0,E.Lc)({rulesSourceName:m.hY,limitAlerts:J}))},buttonSize:X}),L,(0,D.pv)(S.rulerRule)&&F&&(0,t.jsx)(d.A,{rulerRule:S.rulerRule,onClose:()=>I(!1)}),U?.identifier&&(0,t.jsx)(l.Z,{identifier:U.identifier,isProvisioned:U.isProvisioned,onDismiss:()=>W(void 0)})]}):null}},6774:(q,j,e)=>{"use strict";e.d(j,{Ys:()=>_,DI:()=>ee});var t=e(74848),n=e(22803),r=e(88090),a=e(3202),i=e(29675),x=e(6736),s=e(40816),c=e(94485),d=e(44307),u=e(82700),g=e(32266),o=e(3429),E=e(83650),m=e(9985);function f(te){const ae=(0,i.of)(p),{annotations:re}=te,ne=(0,d.gO)(re);return re.length===0?null:(0,t.jsx)("div",{className:ae.annotations,children:re.map(([ce,le])=>(0,t.jsx)(m.s,{annotationKey:ce,value:le,valueLink:ne.get(ce)},ce))})}const p=()=>({annotations:(0,n.css)({marginTop:"46px"})});var h=e(96540),D=e(84099),C=e(51312),l=e(54594),v=e(48583),y=e(747),P=e(40479),b=e(83466),S=e(88214),M=e(85651);const R=({rule:te,rulesSource:ae})=>{const{group:re}=te,{StateHistoryModal:ne,showStateHistoryModal:ce}=(0,P.G)(),le=(0,C.i)(),[he,oe]=(0,y.mh)(te,y.j5.Explore),de=[],me=(0,u.YN)(re);if((0,S.Eb)(ae)&&he&&oe&&!me&&de.push((0,t.jsx)(l.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,M.Yp)(ae,te.query),children:"See graph"},"explore")),te.annotations[b.YH.runbookURL]&&de.push((0,t.jsx)(l.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:D.sQ.sanitizeUrl(te.annotations[b.YH.runbookURL]),children:"View runbook"},"runbook")),te.annotations[b.YH.dashboardUID]){const Pe=te.annotations[b.YH.dashboardUID];if(Pe){de.push((0,t.jsx)(l.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Pe)}`,onClick:()=>{le(te.name)},children:"Go to dashboard"},"dashboard"));const Ee=te.annotations[b.YH.panelID];Ee&&de.push((0,t.jsx)(l.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Pe)}?viewPanel=${encodeURIComponent(Ee)}`,onClick:()=>{le(te.name)},children:"Go to panel"},"panel"))}}return(0,u.pv)(te.rulerRule)&&de.push((0,t.jsxs)(h.Fragment,{children:[(0,t.jsx)(l.$n,{size:"sm",icon:"history",onClick:()=>(0,u.lT)(te.rulerRule)&&ce(te.rulerRule),children:"Show state history"}),ne]},"history")),de.length?(0,t.jsx)(v.B,{children:de}):null};var L=e(98437),B=e(44684);function F(te){const{rulesSource:ae,rule:re}=te,ne=(0,i.of)(I),ce=(0,h.useMemo)(()=>{if((0,S.Eb)(ae))return[{name:ae.name,icon:ae.meta.info.logos.small}];if((0,u.lT)(re.rulerRule)){const{data:le}=re.rulerRule.grafana_alert,he=le.reduce((oe,de)=>{const me=(0,L.l)().getInstanceSettings(de.datasourceUid);return!me||me.uid===B.Uj||(oe[me.name]={name:me.name,icon:me.meta.info.logos.small}),oe},{});return Object.values(he)}return[]},[re,ae]);return ce.length===0?null:(0,t.jsx)(E.X,{label:"Data source",children:ce.map(({name:le,icon:he},oe)=>(0,t.jsxs)("div",{children:[he&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{alt:`${le} datasource logo`,className:ne.dataSourceIcon,src:he})," "]}),le]},le))})}function I(te){const ae=te.spacing(2);return{dataSourceIcon:(0,n.css)({width:ae,height:ae})}}var U=e(28848),W=e(29317),A=e(93981),N=e(32254),K=e(21573),V=e(14191),T=e(91768);const z=({language:te,expr:ae})=>{const re=(0,h.useMemo)(()=>[(0,N.D)({onlyIn:ce=>"type"in ce&&ce.type==="code_block",getSyntax:()=>te},{...U.languages,[te]:te==="logql"?V.Ay:A.n6})],[te]),ne=(0,h.useMemo)(()=>(0,K.mO)(ae),[ae]);return(0,t.jsx)(W.Editor,{"data-testid":"expression-editor",plugins:re,value:ne})},w=({expression:te,rulesSource:ae})=>{const re=(0,i.of)(H);return(0,t.jsx)(T.L,{className:(0,n.cx)(re.well,"slate-query-field"),children:(0,S.Eb)(ae)?(0,t.jsx)(z,{expr:te,language:ae.type===S.ol.Loki?"logql":"promql"}):te})},H=te=>({well:(0,n.css)({fontFamily:te.typography.fontFamilyMonospace})});function G(te){const{annotations:ae,rulesSource:re,rule:ne}=te,ce=X();return(0,S.Eb)(re)?(0,t.jsx)(E.X,{label:"Expression",horizontal:!0,className:(0,n.cx)({[ce.exprRow]:!!ae.length}),children:(0,t.jsx)(w,{expression:ne.query,rulesSource:re})}):null}const X=()=>({exprRow:(0,n.css)({marginBottom:"46px"})});var k=e(5278);const _=15,ee=({rule:te})=>{const ae=(0,i.of)(Z),{namespace:{rulesSource:re}}=te,ne=(0,d.Hx)(te.annotations);return(0,t.jsxs)("div",{children:[(0,t.jsx)(R,{rule:te,rulesSource:re}),(0,t.jsxs)("div",{className:ae.wrapper,children:[(0,t.jsxs)("div",{className:ae.leftSide,children:[(0,t.jsx)(J,{rule:te}),!!te.labels&&!!Object.keys(te.labels).length&&(0,t.jsx)(E.X,{label:"Labels",horizontal:!0,children:(0,t.jsx)(o.m,{labels:te.labels})}),(0,t.jsx)(G,{rulesSource:re,rule:te,annotations:ne}),(0,t.jsx)(f,{annotations:ne})]}),(0,t.jsx)("div",{className:ae.rightSide,children:(0,t.jsx)(F,{rulesSource:re,rule:te})})]}),!((0,u.i7)(te.rulerRule)||(0,u.KB)(te.promRule)||(0,u.Gy)(te.rulerRule))&&(0,t.jsx)(E.X,{label:"Instances",horizontal:!0,children:(0,t.jsx)(k.s,{rule:te,itemsDisplayLimit:_})})]})},J=({rule:te})=>{const ae=te.group.interval,re=te.promRule?.lastEvaluation,ne=te.promRule?.evaluationTime,ce=(0,u.Gy)(te.rulerRule)?te.rulerRule?.grafana_alert.record?.metric:void 0,le=(0,c.G)(te);return(0,t.jsxs)(t.Fragment,{children:[ce&&(0,t.jsx)(E.X,{label:"Metric",horizontal:!0,children:ce}),ae&&(0,t.jsxs)(E.X,{label:"Evaluate",horizontal:!0,children:["Every ",ae]}),le&&(0,t.jsx)(E.X,{label:"Pending period",horizontal:!0,children:le}),re&&!(0,g.mo)(re)&&(0,t.jsx)(E.X,{label:"Last evaluation",horizontal:!0,children:(0,t.jsx)(x.m,{placement:"top",content:`${(0,r.LE)(re,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,t.jsx)("span",{children:`${(0,a.KQ)(re).locale("en").fromNow(!0)} ago`})})}),re&&!(0,g.mo)(re)&&ne!==void 0&&(0,t.jsx)(E.X,{label:"Evaluation time",horizontal:!0,children:(0,t.jsx)(x.m,{placement:"top",content:`${ne}s`,theme:"info",children:(0,t.jsx)("span",{children:(0,s.g)({timeInMs:ne*1e3,humanize:!0})})})})]})},Z=te=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",[te.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,n.css)({flex:1}),rightSide:(0,n.css)({[te.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},5278:(q,j,e)=>{"use strict";e.d(j,{s:()=>P});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(29675),x=e(54594),s=e(39498),c=e(73903),d=e(40271),u=e(60641),g=e(51876);const o=({className:M,onStateFilterChange:O,stateFilter:R,filterType:L,itemPerStateStats:B})=>{const F=(0,i.of)(E),I=K=>function(){return B&&B[K]?(0,t.jsx)(c.v,{name:B[K].toFixed(0),colorIndex:9,className:F.tag}):null},U=Object.values(g.Gi).map(K=>({label:K,value:K,component:I(K)})),A=[g.cF.Firing,g.cF.Pending].map(K=>({label:(0,r.capitalize)(K),value:K,component:I(K)})),N=L==="grafana"?U:A;return(0,t.jsxs)("div",{className:M,"data-testid":"alert-instance-state-filter",children:[(0,t.jsx)(d.J,{children:"State"}),(0,t.jsx)(u.z,{options:N,value:R,onChange:O,onClick:K=>{K===R&&O(void 0)}})]})};function E(M){return{tag:(0,n.css)({fontSize:"11px",fontWeight:"normal",padding:M.spacing(.25,.5),verticalAlign:"middle",marginLeft:M.spacing(.5)})}}var m=e(1814),f=e(85651),p=e(2255),h=e(88214),D=e(55936),C=e(82700),l=e(57732),v=e(31237);function y({stats:M,onClick:O,href:R}){const L=(0,i.of)(S);return(0,t.jsxs)("div",{className:L.footerRow,children:[(0,t.jsxs)("div",{children:["Showing ",M.visibleItemsCount," out of ",M.totalItemsCount," instances"]}),(0,t.jsxs)(x.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:O,href:R,children:["Show all ",M.totalItemsCount," alert instances"]})]})}function P(M){const{rule:O,itemsDisplayLimit:R=Number.POSITIVE_INFINITY,pagination:L,enableFiltering:B=!1}=M,{promRule:F,namespace:I,instanceTotals:U}=O,[W,A]=(0,a.useState)(),[N,K]=(0,a.useState)(),[V]=(0,a.useState)(Math.floor(Math.random()*100)),T=`queryString-${V}`,z=(0,i.of)(S),w=(0,h.z2)(I.rulesSource)?h.hY:"prometheus",H=(0,a.useMemo)(()=>(0,C.Z8)(F)&&F.alerts?.length?b(W,N,(0,f.Cp)(p.xB.Importance,F.alerts)):[],[F,N,W]);if(!(0,C.Z8)(F))return null;const G=H.slice(0,R),X=(0,r.countBy)(F.alerts,re=>(0,g.lh)(re.state)),k=(0,r.sum)([U.alerting,U.inactive,U.pending,U.nodata]),_=k-G.length,ee={totalItemsCount:k,visibleItemsCount:G.length},J=(0,f.w$)(I.rulesSource,M.rule,location.pathname+location.search),Z=(0,v.kc)(U),te=()=>K(void 0),ae=_?(0,t.jsx)(y,{stats:ee,onClick:B?te:void 0,href:B?void 0:J}):void 0;return(0,t.jsxs)(t.Fragment,{children:[B&&(0,t.jsx)("div",{className:(0,n.cx)(z.flexRow,z.spaceBetween),children:(0,t.jsxs)("div",{className:z.flexRow,children:[(0,t.jsx)(s.X,{defaultQueryString:W,onFilterChange:re=>A(re)},T),(0,t.jsx)(o,{filterType:w,stateFilter:N,onStateFilterChange:K,itemPerStateStats:X})]})}),!B&&(0,t.jsx)("div",{className:z.stats,children:Z}),(0,t.jsx)(l.D,{rule:O,instances:G,pagination:L,footerRow:ae})]})}function b(M,O,R){let L=[...R];if(M){const B=M?(0,D.Zc)(M):[];L=L.filter(({labels:F})=>(0,m.Av)(F,B))}return O&&(L=L.filter(B=>(0,g.lh)(B.state)===O)),L}const S=M=>({flexRow:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:M.spacing(1),gap:M.spacing(1)}),spaceBetween:(0,n.css)({justifyContent:"space-between"}),footerRow:(0,n.css)({display:"flex",flexDirection:"column",gap:M.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,n.css)({marginBottom:M.spacing(2)}),stats:(0,n.css)({display:"flex",gap:M.spacing(1),padding:M.spacing(1,0)})})},31237:(q,j,e)=>{"use strict";e.d(j,{M_:()=>o,j7:()=>f,kc:()=>p});var t=e(74848),n=e(2543),r=e.n(n),a=e(55127),i=e.n(a),x=e(96540),s=e(48583),c=e(66384),d=e(35004),u=e(51876);const g={recording:0,alerting:0,[u.cF.Pending]:0,[u.cF.Inactive]:0,paused:0,error:0,nodata:0},o=x.memo(({namespaces:h})=>{const D=(0,x.useDeferredValue)(h),C=(0,x.useMemo)(()=>E(D),[D]),l=m(C),v=p(C),y=!!v.length;return v.unshift((0,t.jsxs)(x.Fragment,{children:[l," ",i()("rule",l)]},"total")),(0,t.jsx)(s.B,{direction:"row",children:y&&(0,t.jsx)("div",{children:(0,t.jsx)(s.B,{gap:.5,children:v})})})});o.displayName="RuleStats";function E(h){const D={...g};return h.forEach(({groups:C})=>{C.forEach(l=>{const v=(0,n.omitBy)(l.totals,n.isUndefined);for(const y in v)D[y]+=v[y]})}),D}function m(h){const D=(0,n.pick)(h,["alerting","pending","inactive","recording"]);return(0,n.sum)(Object.values(D))}const f=({group:h})=>{const D=h.totals,C=h?.interval,l=p(D),v=!!l.length;return(0,t.jsxs)(s.B,{direction:"row",children:[v&&(0,t.jsx)("div",{children:(0,t.jsx)(s.B,{gap:.5,children:l})}),C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"|"}),(0,t.jsx)(c.E,{text:C,icon:"clock-nine",color:"blue"})]})]})};function p(h){const D=[];return h[d.$7.Alerting]&&D.push((0,t.jsx)(c.E,{color:"red",text:`${h[d.$7.Alerting]} firing`},"firing")),h.error&&D.push((0,t.jsx)(c.E,{color:"red",text:`${h.error} ${i()("error",h.error)}`},"errors")),h.nodata&&D.push((0,t.jsx)(c.E,{color:"blue",text:`${h.nodata} no data`},"nodata")),h[d.$7.Pending]&&D.push((0,t.jsx)(c.E,{color:"orange",text:`${h[d.$7.Pending]} pending`},"pending")),h[d.$7.Normal]&&h.paused&&D.push((0,t.jsx)(c.E,{color:"green",text:`${h[d.$7.Normal]} normal (${h.paused} paused)`},"paused")),h[d.$7.Normal]&&!h.paused&&D.push((0,t.jsx)(c.E,{color:"green",text:`${h[d.$7.Normal]} normal`},"inactive")),h.recording&&D.push((0,t.jsx)(c.E,{color:"purple",text:`${h.recording} recording`},"recording")),D}},88755:(q,j,e)=>{"use strict";e.d(j,{sF:()=>Z,ZI:()=>le});var t=e(74848),n=e(22803),r=e(96540),a=e(70255),i=e(29675),x=e(16110),s=e(6736),c=e(40828),d=e(5240),u=e(27106),g=e(3674),o=e(25779),E=e(91064),m=e(3161),f=e(99797),p=e(9912),h=e(20206),D=e(87446),C=e(83466),l=e(88214),v=e(82700),y=e(50585),P=e(9172),b=e(27219),S=e(33911),M=e(5487),O=e(12626),R=e(32370),L=e(79784),B=e(19165);function F({rule:oe}){const de=(0,i.of)(I),me=(0,v.lT)(oe.rulerRule);return(0,r.useMemo)(()=>me?(0,B.qf)(oe.group.interval).exceedsLimit:!1,[oe.group.interval,me])?(0,t.jsx)(s.m,{theme:"error",content:(0,t.jsxs)("div",{children:["A minimum evaluation interval of"," ",(0,t.jsx)("span",{className:de.globalLimitValue,children:R.$.unifiedAlerting.minInterval})," has been configured in Grafana and will be used instead of the ",oe.group.interval," interval configured for the Rule Group."]}),children:(0,t.jsx)(L.I,{name:"stopwatch-slash",className:de.icon})}):null}function I(oe){return{globalLimitValue:(0,n.css)({fontWeight:oe.typography.fontWeightBold}),icon:(0,n.css)({fill:oe.colors.warning.text})}}var U=e(6774),W=e(78032);const A=({rule:oe})=>{const de=(0,i.of)(N);return(0,W.lf)(oe.health)?(0,t.jsx)(s.m,{theme:"error",content:oe.lastError||"No error message provided.",children:(0,t.jsxs)("div",{className:de.warn,children:[(0,t.jsx)(L.I,{name:"exclamation-triangle"}),(0,t.jsx)("span",{children:"error"})]})}):(0,t.jsx)(t.Fragment,{children:oe.health})},N=oe=>({warn:(0,n.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:oe.spacing(1),color:oe.colors.warning.text})});var K=e(66102),V=e(48583),T=e(20968),z=e(11817),w=e(51876),H=e(22245),G=e(17025);const X=({rule:oe,isDeleting:de,isCreating:me,isPaused:Pe})=>{const Ee=(0,i.of)(k),{promRule:be,rulerRule:Se}=oe,Xe=()=>Pe&&(0,v.Gy)(Se)?(0,t.jsx)(s.m,{content:"Recording rule evaluation is currently paused",placement:"top",children:(0,t.jsxs)(H.O,{state:"warning",children:[(0,t.jsx)(L.I,{name:"pause",size:"xs"}),(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),Qe=(0,r.useMemo)(()=>{if(be&&(0,v.Z8)(be)&&be.alerts?.length&&be.state!==w.cF.Inactive){const we=be.activeAt?new Date(be.activeAt):(0,v.Om)(be);if(we)return(0,t.jsxs)("span",{title:String(we),className:Ee.for,children:["for"," ",(0,K.dU)({start:we,end:new Date},!1)]})}return null},[be,Ee]);return de?(0,t.jsxs)(V.B,{gap:1,children:[(0,t.jsx)(T.y,{}),(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):me?(0,t.jsxs)(V.B,{gap:1,children:[(0,t.jsx)(T.y,{}),(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):be&&(0,v.Z8)(be)?(0,t.jsxs)(V.B,{gap:1,children:[(0,t.jsx)(G.C,{state:be.state,isPaused:Pe}),!Pe&&Qe]}):be&&(0,v.KB)(be)?(0,t.jsx)(Xe,{}):(0,t.jsx)(t.Fragment,{children:"n/a"})},k=oe=>({for:(0,n.css)({fontSize:oe.typography.bodySmall.fontSize,color:oe.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),_=(0,g.w)(),{useLazyGetRuleGroupForNamespaceQuery:ee}=d.hK,{useLazyDiscoverDsFeaturesQuery:J}=u.L,Z=({rules:oe,className:de,showGuidelines:me=!1,emptyMessage:Pe="No rules found.",showGroupColumn:Ee=!1,showSummaryColumn:be=!1,showNextEvaluationColumn:Se=!1})=>{const Xe=(0,i.of)(ae),Qe=(0,n.cx)(Xe.wrapper,de,{[Xe.wrapperMargin]:me}),{pageItems:we,page:$e,numberOfPages:Fe,onPageChange:Te}=(0,f.W)(oe,1,c.FG),{result:Le,status:Ge}=te(we),Me=Ge==="loading",De=(0,r.useMemo)(()=>Le.map((Ne,ie)=>({id:`${Ne.namespace.name}-${Ne.group.name}-${Ne.name}-${ie}`,data:Ne})),[Le]),Ke=re(be,Ee,Se,Me);if(!we.length)return(0,t.jsx)("div",{className:(0,n.cx)(Qe,Xe.emptyMessage),children:Pe});const Ie=me?P.B:y.E;return(0,t.jsxs)("div",{className:Qe,"data-testid":"rules-table",children:[(0,t.jsx)(Ie,{cols:Ke,isExpandable:!0,items:De,renderExpandedContent:({data:Ne})=>(0,t.jsx)(U.DI,{rule:Ne})}),(0,t.jsx)(x.d,{currentPage:$e,numberOfPages:Fe,onNavigate:Te,hideWhenSinglePage:!0,className:Xe.pagination})]})};function te(oe){const[de]=ee(),[me]=J(),[Pe,Ee]=(0,o.Yb)(async()=>Promise.all(oe.map(async Se=>{const Xe=await me({rulesSourceName:(0,l.EV)(Se.namespace.rulesSource)},!0).unwrap();if(Xe.rulerConfig&&Se.namespace.rulesSource!==l.hY){const Qe=await de({namespace:Se.namespace.name,group:Se.group.name,rulerConfig:Xe.rulerConfig},!0).unwrap();(0,E.yh)(Se,Qe)}return Se})),oe);return(0,r.useEffect)(()=>{_?Pe.execute():Pe.reset()},[oe,Pe]),Ee}const ae=oe=>({wrapperMargin:(0,n.css)({[oe.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,n.css)({padding:oe.spacing(1)}),wrapper:(0,n.css)({width:"auto",borderRadius:oe.shape.radius.default}),skeletonWrapper:(0,n.css)({flex:1}),pagination:(0,n.css)({display:"flex",margin:0,paddingTop:oe.spacing(1),paddingBottom:oe.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${oe.colors.border.medium}`,borderRight:`1px solid ${oe.colors.border.medium}`,borderBottom:`1px solid ${oe.colors.border.medium}`,float:"none"})});function re(oe,de,me,Pe){return(0,r.useMemo)(()=>{const Ee=[{id:"state",label:"State",renderCell:({data:be})=>(0,t.jsx)(ne,{rule:be}),size:"165px"},{id:"name",label:"Name",renderCell:({data:be})=>be.name,size:me?4:5},{id:"metadata",label:"",renderCell:({data:be})=>{const{promRule:Se,rulerRule:Xe}=be,Qe=(0,v.uo)(Se??Xe);return Qe?(0,t.jsx)(h.T,{pluginId:Qe.pluginId}):(0,v.lT)(Xe)&&Xe.grafana_alert.provenance?(0,t.jsx)(b.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:be})=>(0,t.jsx)(F,{rule:be}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:be,group:Se}})=>be?(0,t.jsx)(A,{rule:be}):null,size:"75px"}];return oe&&Ee.push({id:"summary",label:"Summary",renderCell:({data:be})=>(0,t.jsx)(M.Y,{input:be.annotations[C.YH.summary]??""}),size:me?4:5}),me&&Ee.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:be})=>{const Se=(0,D.C)(be.promRule?.lastEvaluation,be.group.interval);return Se&&(0,t.jsx)(s.m,{placement:"top",content:`${Se?.fullDate}`,theme:"info",children:(0,t.jsx)("span",{children:Se?.humanized})})},size:2}),de&&Ee.push({id:"group",label:"Group",renderCell:({data:be})=>{const{namespace:Se,group:Xe}=be;return Xe.name==="default"?(0,t.jsx)(S.c,{namespace:Se.name}):(0,t.jsx)(S.c,{namespace:Se.name,group:Xe.name})},size:5}),Ee.push({id:"actions",label:"Actions",renderCell:({data:be})=>(0,t.jsx)(ce,{rule:be,isLoadingRuler:Pe}),size:"215px"}),Ee},[oe,de,me,Pe])}function ne({rule:oe}){const{isDeleting:de,isCreating:me,isPaused:Pe}=he(oe);return(0,t.jsx)(X,{rule:oe,isDeleting:de,isCreating:me,isPaused:Pe})}function ce({rule:oe,isLoadingRuler:de}){const me=(0,i.of)(ae),{isDeleting:Pe,isCreating:Ee}=he(oe);return de?(0,t.jsx)(a.A,{containerClassName:me.skeletonWrapper}):(0,t.jsx)(O.l,{compact:!0,showViewButton:!Pe&&!Ee,rule:oe,rulesSource:oe.namespace.rulesSource})}function le(oe){const de=(0,p.$)(Ee=>Ee.rulerRules),me=(0,l.EV)(oe);return!!de[me]?.result}function he(oe){const de=oe.namespace.rulesSource,me=le(de),{hasRuler:Pe}=(0,m.y)(de),{promRule:Ee,rulerRule:be}=oe;if(_&&!(0,v.lT)(be))return{isDeleting:!1,isCreating:!1,isPaused:!1};const Se=!!(Pe&&me&&Ee&&!be),Xe=!!(Pe&&me&&be&&!Ee),Qe=(0,v.lT)(be)&&(0,v.HH)(be);return{isDeleting:Se,isCreating:Xe,isPaused:Qe}}},35912:(q,j,e)=>{"use strict";e.d(j,{y:()=>i});var t=e(74848),n=e(80187),r=e(22245);const a={[n.Or.Active]:"bad",[n.Or.Unprocessed]:"neutral",[n.Or.Suppressed]:"info"},i=({state:x})=>(0,t.jsx)(r.O,{state:a[x],children:x})},19423:(q,j,e)=>{"use strict";e.d(j,{A:()=>d});var t=e(74848),n=e(96540),r=e(58528),a=e(48583),i=e(97609),x=e(88214),s=e(13005);const d=n.memo(({rulerRule:u,onClose:g})=>{const{uid:o}=u.grafana_alert;return(0,t.jsx)(r._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:g,size:"md",children:(0,t.jsx)(a.B,{direction:"column",children:(0,t.jsx)(s.b9,{accessType:"instance",children:(0,t.jsx)(i.SilencesEditor,{ruleUid:o,alertManagerSourceName:x.hY,onSilenceCreated:g,onCancel:g})})})})},(u,g)=>u.rulerRule.grafana_alert.uid===g.rulerRule.grafana_alert.uid)},97609:(q,j,e)=>{"use strict";e.r(j),e.d(j,{SilencesEditor:()=>me,default:()=>be});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(49785),x=e(54148),s=e(40996),c=e(66102),d=e(3202),u=e(28082),g=e(53027),o=e(32370),E=e(81876),m=e(37e3),f=e(29675),p=e(44617),h=e(86489),D=e(34128),C=e(50926),l=e(48583),v=e(54594),y=e(11817),P=e(66150),b=e(83466),S=e(88214),M=e(80187),O=e(747),R=e(13005),L=e(1814),B=e(85651),F=e(37104),I=e(32174),U=e(93185),W=e(76080),A=e(44826),N=e(99764),K=e(5240);const V=({className:Se,required:Xe,ruleUid:Qe})=>{const we=(0,f.of)(T),$e=(0,i.xW)(),{control:Fe,register:Te,formState:{errors:Le}}=$e,{fields:Ge=[],append:Me,remove:De}=(0,i.jz)({name:"matchers"}),[Ke,{data:Ie}]=K.hK.endpoints.getAlertRule.useLazyQuery();return(0,a.useEffect)(()=>{Qe&&Ke({uid:Qe})},[Ke,Qe]),(0,t.jsx)("div",{className:Se,children:(0,t.jsx)(h.D,{label:"Refine affected alerts",required:Xe,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:(0,n.cx)(we.matchers,we.indent),children:[Ie&&(0,t.jsxs)("div",{children:[(0,t.jsx)(h.D,{label:"Alert rule",disabled:!0,children:(0,t.jsx)(D.p,{id:"alert-rule-name",defaultValue:Ie.grafana_alert.title,disabled:!0})}),(0,t.jsx)(W.c,{})]}),Ge.map((Ne,ie)=>(0,t.jsxs)("div",{className:we.row,"data-testid":"matcher",children:[(0,t.jsx)(h.D,{label:"Label",invalid:!!Le?.matchers?.[ie]?.name,error:Le?.matchers?.[ie]?.name?.message,children:(0,t.jsx)(D.p,{...Te(`matchers.${ie}.name`,{required:{value:Xe,message:"Required."}}),defaultValue:Ne.name,placeholder:"label",id:`matcher-${ie}-label`})}),(0,t.jsx)(h.D,{label:"Operator",children:(0,t.jsx)(i.xI,{control:Fe,render:({field:{onChange:ve,ref:fe,...ge}})=>(0,t.jsx)(A.l6,{...ge,onChange:xe=>ve(xe.value),className:we.matcherOptions,options:L.xH,"aria-label":"operator",id:`matcher-${ie}-operator`}),defaultValue:Ne.operator||L.xH[0].value,name:`matchers.${ie}.operator`,rules:{required:{value:Xe,message:"Required."}}})}),(0,t.jsx)(h.D,{label:"Value",invalid:!!Le?.matchers?.[ie]?.value,error:Le?.matchers?.[ie]?.value?.message,children:(0,t.jsx)(D.p,{...Te(`matchers.${ie}.value`,{required:{value:Xe,message:"Required."}}),defaultValue:Ne.value,placeholder:"value",id:`matcher-${ie}-value`})}),(Ge.length>1||!Xe)&&(0,t.jsx)(N.K,{"aria-label":"Remove matcher",className:we.removeButton,name:"trash-alt",onClick:()=>De(ie),children:"Remove"})]},`${Ne.id}`))]}),(0,t.jsx)(v.$n,{className:we.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Ne={name:"",value:"",operator:M.ho.equal};Me(Ne)},children:"Add matcher"})]})})})},T=Se=>({wrapper:(0,n.css)({marginTop:Se.spacing(2)}),row:(0,n.css)({marginTop:Se.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:Se.colors.background.secondary,padding:`${Se.spacing(1)} ${Se.spacing(1)} 0 ${Se.spacing(1)}`,"& > * + *":{marginLeft:Se.spacing(2)}}),removeButton:(0,n.css)({marginLeft:Se.spacing(1),marginTop:Se.spacing(2.5)}),matcherOptions:(0,n.css)({minWidth:"140px"}),matchers:(0,n.css)({maxWidth:`${Se.breakpoints.values.sm}px`,margin:`${Se.spacing(1)} 0`,paddingTop:Se.spacing(.5)}),indent:(0,n.css)({marginLeft:Se.spacing(2)})}),z=V;var w=e(7224);const H=()=>{const{control:Se,getValues:Xe}=(0,i.xW)(),{field:{onChange:Qe,value:we},fieldState:{invalid:$e}}=(0,i.as)({name:"startsAt",control:Se,rules:{validate:Ne=>Xe().endsAt>Ne}}),{field:{onChange:Fe,value:Te},fieldState:{invalid:Le}}=(0,i.as)({name:"endsAt",control:Se,rules:{validate:Ne=>Xe().startsAt<Ne}}),{field:{onChange:Ge,value:Me}}=(0,i.as)({name:"timeZone",control:Se}),De=$e||Le,Ke=(0,d.KQ)(we),Ie=(0,d.KQ)(Te);return(0,t.jsx)(h.D,{className:G.timeRange,label:"Silence start and end",error:De?"To is before or the same as from":"",invalid:De,children:(0,t.jsx)(w.b,{value:{from:Ke,to:Ie,raw:{from:Ke,to:Ie}},timeZone:Me,onChange:Ne=>{Qe((0,d.KQ)(Ne.from)),Fe((0,d.KQ)(Ne.to))},onChangeTimeZone:Ne=>Ge(Ne),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},G={timeRange:(0,n.css)({width:"400px"})};var X=e(45214),k=e(6736),_=e(79784),ee=e(66384),J=e(9365),Z=e(32266),te=e(3429),ae=e(50585),re=e(35912);const ne=(Se,Xe,Qe)=>{const[we,$e]=(0,a.useState)();(0,s.A)(Se,Xe,[we]),(0,X.A)(()=>{$e(Qe)},[Qe])},ce=({amSourceName:Se,matchers:Xe,ruleUid:Qe})=>{const we=[...Qe?[{name:b.kW,value:Qe,operator:M.ho.equal}]:[],...Xe].map(L.Wc),$e=J.m.endpoints.getAlertmanagerAlerts.useLazyQuery,Fe=(0,f.of)(he),Te=le(),Le=Qe||Xe.some(Ne=>Ne.value&&Ne.name),[Ge,{currentData:Me=[],isFetching:De,isError:Ke}]=$e();if(ne(()=>{Le&&Ge({amSourceName:Se,filter:{matchers:we}})},500,[Se,we]),Ke)return(0,t.jsx)(m.F,{title:"Preview not available",severity:"error",children:"Error occurred when generating preview of affected alerts. Are your matchers valid?"});const Ie=Me.map(Ne=>({id:Ne.fingerprint,data:Ne}));return(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:Fe.title,children:[(0,t.jsx)(y.x6,{i18nKey:"alerting.silences.affected-instances",children:"Affected alert instances"}),(0,t.jsx)(k.m,{content:(0,t.jsxs)("div",{children:[(0,t.jsx)(y.x6,{i18nKey:"alerting.silences.preview-affected-instances",children:"Preview the alert instances affected by this silence."}),(0,t.jsx)("br",{}),(0,t.jsx)(y.x6,{i18nKey:"alerting.silences.only-firing-instances",children:"Only alert instances in the firing state are displayed."})]}),children:(0,t.jsxs)("span",{children:["\xA0",(0,t.jsx)(_.I,{name:"info-circle",size:"sm"})]})}),Ie.length>0?(0,t.jsx)(ee.E,{className:Fe.badge,color:"blue",text:Ie.length}):null]}),!Le&&(0,t.jsx)("span",{children:"Add a valid matcher to see affected alerts"}),De&&(0,t.jsx)(E._,{text:"Loading affected alert rule instances..."}),!De&&!Ke&&Le&&(0,t.jsx)("div",{className:Fe.table,children:Ie.length>0?(0,t.jsx)(ae.E,{items:Ie,isExpandable:!1,cols:Te,pagination:{itemsPerPage:10}}):(0,t.jsx)("span",{children:"No firing alert instances found"})})]})};function le(){const Se=(0,f.of)(he);return[{id:"state",label:"State",renderCell:function({data:Qe}){return(0,t.jsx)(re.y,{state:Qe.status.state})},size:"120px",className:Se.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:Qe}){return(0,t.jsx)(te.m,{labels:Qe.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:Qe}){return(0,t.jsx)(t.Fragment,{children:(0,Z.mo)(Qe.startsAt)?"-":(0,d.KQ)(Qe.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const he=Se=>({table:(0,n.css)({maxWidth:`${Se.breakpoints.values.lg}px`}),moreMatches:(0,n.css)({marginTop:Se.spacing(1)}),title:(0,n.css)({display:"flex",alignItems:"center"}),badge:(0,n.css)({marginLeft:Se.spacing(1)}),stateColumn:(0,n.css)({display:"flex",alignItems:"center"})});var oe=e(94618);const de=()=>{const{id:Se=""}=(0,x.g)(),{selectedAlertmanager:Xe=""}=(0,R.VI)(),{data:Qe,isLoading:we,error:$e}=P.F.endpoints.getSilence.useQuery({id:Se,datasourceUid:(0,S.w5)(Xe),ruleMetadata:!0,accessControl:!0}),Fe=Qe?.matchers?.find(De=>De.name===b.kW)?.value,Te=Xe===S.hY,Le=(0,a.useMemo)(()=>{if(!Qe)return;const De=Qe.matchers?.filter(Ke=>Ke.name!==b.kW);return(0,oe.Ee)({...Qe,matchers:De})},[Qe]);return Se&&we?(0,t.jsx)(E._,{text:"Loading existing silence information..."}):(0,u.NF)($e)&&$e.status===404?(0,t.jsx)(m.F,{title:`Existing silence "${Se}" not found`,severity:"warning"}):(Te?Qe?.accessControl?.write:!0)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.M,{currentAlertmanager:Xe}),(0,t.jsx)(me,{ruleUid:Fe,formValues:Le,alertManagerSourceName:Xe})]}):(0,t.jsx)(m.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},me=({formValues:Se=(0,oe.Di)(),alertManagerSourceName:Xe,onSilenceCreated:Qe,onCancel:we,ruleUid:$e})=>{const[Fe,Te]=(0,O.L7)(O.QI.PreviewSilencedInstances),Le=Fe&&Te,[Ge,{isLoading:Me}]=P.F.endpoints.createSilence.useMutation(),De=(0,i.mN)({defaultValues:Se}),Ke=(0,f.of)(Pe),{register:Ie,handleSubmit:Ne,formState:ie,watch:ve,setValue:fe,clearErrors:ge}=De,[xe,je,Ve,ke]=ve(["duration","startsAt","endsAt","matchers"]),Oe=()=>{g.Ny.push((0,B.nL)("/alerting/silences",Xe))},nt=Qe||Oe,Je=we||Oe,Be=async at=>{const{id:yt,startsAt:ze,endsAt:st,comment:ht,createdBy:It,matchers:Gt}=at;$e&&Gt.push({name:b.kW,value:$e,operator:M.ho.equal});const un=Gt.map(L.Wc).filter(pn=>pn.name&&pn.value),vn=(0,r.pickBy)({id:yt,startsAt:ze,endsAt:st,comment:ht,createdBy:It,matchers:un},pn=>!!pn);await Ge({datasourceUid:(0,S.w5)(Xe),payload:vn}).unwrap().then(pn=>{nt?.(pn)})},[Ze,tt]=(0,a.useState)(xe);(0,s.A)(()=>{if((0,c.vd)(je)&&(0,c.vd)(Ve))if(xe!==Ze)fe("endsAt",(0,d.KQ)((0,c.Ri)(new Date(je),(0,c.E9)(xe))).toISOString()),tt(xe);else{const at=new Date(je).valueOf();if(new Date(Ve).valueOf()>at){const ze=(0,c.dU)({start:new Date(je),end:new Date(Ve)});fe("duration",ze),tt(ze)}}},700,[ge,xe,Ve,Ze,fe,je]);const Re=!!(o.$.bootData.user.isSignedIn&&o.$.bootData.user.name);return(0,t.jsx)(i.Op,{...De,children:(0,t.jsxs)("form",{onSubmit:Ne(Be),children:[(0,t.jsxs)(p.n,{className:Ke.formContainer,children:[(0,t.jsxs)("div",{className:Ke.silencePeriod,children:[(0,t.jsx)(H,{}),(0,t.jsx)(h.D,{label:"Duration",invalid:!!ie.errors.duration,error:ie.errors.duration&&(ie.errors.duration.type==="required"?"Required field":ie.errors.duration.message),children:(0,t.jsx)(D.p,{...Ie("duration",{validate:at=>Object.keys((0,c.E9)(at)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,t.jsx)(z,{required:!$e,ruleUid:$e}),(0,t.jsx)(h.D,{label:"Comment",required:!0,error:ie.errors.comment?.message,invalid:!!ie.errors.comment,children:(0,t.jsx)(C.f,{...Ie("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})}),!Re&&(0,t.jsx)(h.D,{label:"Created By",required:!0,error:ie.errors.createdBy?.message,invalid:!!ie.errors.createdBy,children:(0,t.jsx)(D.p,{...Ie("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})}),Le&&(0,t.jsx)(ce,{amSourceName:Xe,matchers:ke,ruleUid:$e})]}),(0,t.jsxs)(l.B,{gap:1,children:[Me&&(0,t.jsx)(v.$n,{disabled:!0,icon:"spinner",variant:"primary",children:"Saving..."}),!Me&&(0,t.jsx)(v.$n,{type:"submit",children:"Save silence"}),(0,t.jsx)(v.z9,{onClick:Je,variant:"secondary",children:(0,t.jsx)(y.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})]})})},Pe=Se=>({formContainer:(0,n.css)({maxWidth:Se.breakpoints.values.md}),alertRule:(0,n.css)({paddingBottom:Se.spacing(2)}),silencePeriod:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:Se.spacing(1),maxWidth:Se.breakpoints.values.sm,paddingTop:Se.spacing(2)})});function Ee(){const Se={id:"silence-edit",text:"Edit silence",subTitle:"Recreate existing silence to stop notifications from a particular alert rule"};return(0,t.jsx)(I.y,{navId:"silences",pageNav:Se,accessType:"instance",children:(0,t.jsx)(de,{})})}const be=(0,F.S)(Ee)},94618:(q,j,e)=>{"use strict";e.d(j,{Di:()=>g,Ee:()=>u,LP:()=>d});var t=e(66102),n=e(55801),r=e(3202),a=e(32370),i=e(1814),x=e(83466),s=e(55936),c=e(80187);const d=o=>{const E={},m=o.get("comment"),p=o.getAll("matcher").filter(D=>!D.startsWith(x.kW)),h=(0,s.ou)(p);return h.length&&(E.matchers=h.map(i.MU)),m&&(E.comment=m),E},u=o=>{const E=new Date,f=Date.parse(o.endsAt)<Date.now()?{start:E,end:(0,t.Ri)(E,{hours:2})}:{start:new Date(o.startsAt),end:new Date(o.endsAt)};return{id:o.id,startsAt:f.start.toISOString(),endsAt:f.end.toISOString(),comment:o.comment,createdBy:o.createdBy,duration:(0,t.dU)(f),isRegex:!1,matchers:o.matchers?.map(i.MU)||[],matcherName:"",matcherValue:"",timeZone:n.lE}},g=o=>{const E=new Date,m=(0,t.Ri)(E,{hours:2});return{id:"",startsAt:E.toISOString(),endsAt:m.toISOString(),comment:`created ${(0,r.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:a.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:n.lE,matchers:[{name:"",value:"",operator:c.ho.equal}],...o}}},90666:(q,j,e)=>{"use strict";e.d(j,{X:()=>n});var t=e(61491);const n=[t.AccessControlAction.AlertingTemplatesRead,t.AccessControlAction.AlertingTemplatesWrite,t.AccessControlAction.AlertingTemplatesDelete]},3674:(q,j,e)=>{"use strict";e.d(j,{w:()=>n});var t=e(32370);const n=()=>t.$.featureToggles.alertingPrometheusRulesPrimary??!1},79803:(q,j,e)=>{"use strict";e.d(j,{Y:()=>x});var t=e(11817),n=e(5240),r=e(76206),a=e(25779),i=e(10372);function x(){const[s]=(0,i.D)(),[c]=n.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[d]=n.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,a.Yb)(async(u,g)=>{const{groupName:o,namespaceName:E}=u,m=(0,r.KH)({identifier:g}),{newRuleGroupDefinition:f,rulerConfig:p}=await s(u,m),h=(0,t.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return f.rules.length===0?d({rulerConfig:p,namespace:E,group:o,notificationOptions:{successMessage:h}}).unwrap():c({rulerConfig:p,namespace:E,payload:f,notificationOptions:{successMessage:h}}).unwrap()})}},10372:(q,j,e)=>{"use strict";e.d(j,{D:()=>d,_:()=>c});var t=e(5240),n=e(27106),r=e(75764),a=e(76206),i=e(69064);const{useLazyGetRuleGroupForNamespaceQuery:x}=t.hK,{useLazyDiscoverDsFeaturesQuery:s}=n.L,c=g=>new Error(`DataSource ${g} does not support ruler API or does not have the ruler API enabled.`);function d(){const[g,o]=x(),[E]=s();return[async(f,p)=>{const{dataSourceName:h,groupName:D,namespaceName:C}=f,{rulerConfig:l}=await E({rulesSourceName:h}).unwrap();if(!l)throw c(h);const v=await g({rulerConfig:l,namespace:C,group:D,notificationOptions:{showErrorAlert:!1}}).unwrap().catch(r.R);return{newRuleGroupDefinition:(0,a.i3)(v??u(f.groupName),p),rulerConfig:l}},o]}const u=g=>({name:g,interval:i.T6,rules:[]})},94485:(q,j,e)=>{"use strict";e.d(j,{G:()=>r});var t=e(96540),n=e(82700);function r(a){return(0,t.useMemo)(()=>(0,n.fC)(a),[a])}},747:(q,j,e)=>{"use strict";e.d(j,{Ej:()=>P,Hl:()=>I,L7:()=>F,QI:()=>h,RY:()=>C,e2:()=>y,iI:()=>B,j5:()=>D,mW:()=>M,mh:()=>b});var t=e(96540),n=e(61351),r=e(91495),a=e(60088),i=e(82945),x=e(34657),s=e(80187),c=e(61491),d=e(9365),u=e(13005),g=e(96621),o=e(88214),E=e(98775),m=e(85651),f=e(82700),p=e(78731),h=(T=>(T.ViewExternalConfiguration="view-external-configuration",T.UpdateExternalConfiguration="update-external-configuration",T.CreateContactPoint="create-contact-point",T.ViewContactPoint="view-contact-point",T.UpdateContactPoint="edit-contact-points",T.DeleteContactPoint="delete-contact-point",T.ExportContactPoint="export-contact-point",T.CreateNotificationTemplate="create-notification-template",T.ViewNotificationTemplate="view-notification-template",T.UpdateNotificationTemplate="edit-notification-template",T.DeleteNotificationTemplate="delete-notification-template",T.DecryptSecrets="decrypt-secrets",T.CreateNotificationPolicy="create-notification-policy",T.ViewNotificationPolicyTree="view-notification-policy-tree",T.UpdateNotificationPolicyTree="update-notification-policy-tree",T.DeleteNotificationPolicy="delete-notification-policy",T.ExportNotificationPolicies="export-notification-policies",T.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",T.CreateSilence="create-silence",T.ViewSilence="view-silence",T.UpdateSilence="update-silence",T.PreviewSilencedInstances="preview-silenced-alerts",T.ViewMuteTiming="view-mute-timing",T.CreateMuteTiming="create-mute-timing",T.UpdateMuteTiming="update-mute-timing",T.DeleteMuteTiming="delete-mute-timing",T.ExportMuteTimings="export-mute-timings",T.ViewAlertGroups="view-alert-groups",T))(h||{}),D=(T=>(T.Duplicate="duplicate-alert-rule",T.View="view-alert-rule",T.Update="update-alert-rule",T.Delete="delete-alert-rule",T.Explore="explore-alert-rule",T.Silence="silence-alert-rule",T.ModifyExport="modify-export-rule",T.Pause="pause-alert-rule",T))(D||{}),C=(T=>(T.CreateAlertRule="create-alert-rule",T.ViewAlertRule="view-alert-rule",T.UpdateAlertRule="update-alert-rule",T.DeleteAlertRule="delete-alert-rule",T.ExportGrafanaManagedRules="export-grafana-managed-rules",T.ReadConfigurationStatus="read-configuration-status",T.CreateExternalAlertRule="create-external-alert-rule",T.ViewExternalAlertRule="view-external-alert-rule",T.UpdateExternalAlertRule="update-external-alert-rule",T.DeleteExternalAlertRule="delete-external-alert-rule",T))(C||{});const l=!0,v=!1,y=()=>({"create-alert-rule":V(l,c.AccessControlAction.AlertingRuleCreate),"view-alert-rule":V(l,c.AccessControlAction.AlertingRuleRead),"update-alert-rule":V(l,c.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":V(l,c.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":V(l,c.AccessControlAction.AlertingRuleRead),"read-configuration-status":[l,n.TP.hasPermission(c.AccessControlAction.AlertingInstanceRead)||n.TP.hasPermission(c.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":V(l,c.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":V(l,c.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":V(l,c.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":V(l,c.AccessControlAction.AlertingRuleExternalWrite)}),P=T=>y()[T];function b(T,z){const w=R(T);return(0,t.useMemo)(()=>w[z],[w,z])}function S(T,z){const w=R(T);return useMemo(()=>z.map(H=>w[H]),[w,z])}function M(T,z,w){const H=L(T,z);return(0,t.useMemo)(()=>H[w],[H,w])}function O(T,z,w){const H=L(T,z);return useMemo(()=>w.map(G=>H[G]),[H,w])}function R(T){const z=(0,o.EV)(T.namespace.rulesSource),{isEditable:w,isRemovable:H,isRulerAvailable:G=!1,loading:X}=(0,p.g)(z,T.rulerRule),[k,_]=P("export-grafana-managed-rules"),ee=W(T.rulerRule);return(0,t.useMemo)(()=>{const Z=(0,f.lT)(T.rulerRule)&&!!T.rulerRule.grafana_alert.provenance,te=(0,f.YN)(T.group),ae=(0,f.lT)(T.rulerRule),re=(0,f.Tm)(T.rulerRule),ne=Z||te||re,ce=X?v:G,le=ne?v:ce,he=re?v:ce,oe=(0,g.Wd)(z);return{"duplicate-alert-rule":V(he,oe.create),"view-alert-rule":V(l,oe.read),"update-alert-rule":[le,w??!1],"delete-alert-rule":[le,H??!1],"explore-alert-rule":V(l,c.AccessControlAction.DataSourcesExplore),"silence-alert-rule":ee,"modify-export-rule":[ae,_],"pause-alert-rule":[le&&ae,w??!1]}},[T,X,G,w,H,z,_,ee])}function L(T,z){const w=(0,E.rO)(z),{isEditable:H,isRemovable:G,isRulerAvailable:X=!1,loading:k}=(0,p.g)(w,T),[_,ee]=P("export-grafana-managed-rules"),J=W(T);return(0,t.useMemo)(()=>{const te=(0,f.lT)(T)&&!!T.grafana_alert.provenance,ae=!1,re=(0,f.lT)(T),ne=(0,f.Tm)(T),ce=te||ae||ne,le=k?v:X,he=ce?v:le,oe=ne?v:le,de=(0,g.Wd)(w);return{"duplicate-alert-rule":V(oe,de.create),"view-alert-rule":V(l,de.read),"update-alert-rule":[he,H??!1],"delete-alert-rule":[he,G??!1],"explore-alert-rule":V(l,c.AccessControlAction.DataSourcesExplore),"silence-alert-rule":J,"modify-export-rule":[re,ee],"pause-alert-rule":[he&&re,H??!1]}},[T,k,X,w,H,G,J,ee])}function B(){const{selectedAlertmanager:T,hasConfigurationAPI:z,isGrafanaAlertmanager:w}=(0,u.VI)(),H=(0,g.lV)(T),G=(0,g.jy)(T);return{"view-external-configuration":V(l,c.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":V(z,c.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":V(z,H.create,...w?[c.AccessControlAction.AlertingReceiversCreate]:[]),"view-contact-point":V(l,H.read,...w?r.PE:[]),"edit-contact-points":V(z,H.update,...w?[c.AccessControlAction.AlertingReceiversWrite]:[]),"delete-contact-point":V(z,H.delete,...w?[c.AccessControlAction.AlertingReceiversWrite]:[]),"export-contact-point":[w,w],"create-notification-template":V(z,H.create,...w?[c.AccessControlAction.AlertingTemplatesWrite]:[]),"view-notification-template":V(l,H.read,...w?[c.AccessControlAction.AlertingTemplatesRead]:[]),"edit-notification-template":V(z,H.update,...w?[c.AccessControlAction.AlertingTemplatesWrite]:[]),"delete-notification-template":V(z,H.delete),"create-notification-policy":V(z,H.create,...w?i.nv:[]),"view-notification-policy-tree":V(l,H.read,...w?i.rw:[]),"update-notification-policy-tree":V(z,H.update,...w?i.nv:[]),"delete-notification-policy":V(z,H.delete,...w?i.nv:[]),"export-notification-policies":V(w,H.read),"decrypt-secrets":V(w,H.provisioning.readSecrets),"view-autogenerated-policy-tree":[w,(0,m.qc)()],"create-silence":V(l,G.create),"view-silence":V(l,G.read),"update-silence":V(l,G.update),"preview-silenced-alerts":V(l,G.read),"create-mute-timing":V(z,H.create,...w?a.Zr:[]),"view-mute-timing":V(l,H.read,...w?a.xK:[]),"update-mute-timing":V(z,H.update,...w?a.Zr:[]),"delete-mute-timing":V(z,H.delete,...w?a.Zr:[]),"export-mute-timings":V(w,H.read),"view-alert-groups":V(l,G.read)}}function F(T){const z=B();return(0,t.useMemo)(()=>z[T],[z,T])}function I(T){const z=B();return(0,t.useMemo)(()=>T.map(w=>z[w]),[z,T])}const{useGetGrafanaAlertingConfigurationStatusQuery:U}=d.m;function W(T){const z=(0,f.lT)(T)?T.grafana_alert.namespace_uid:void 0,{loading:w,folder:H}=(0,x.a4)(z),G=T&&(0,f.lT)(T),X=T&&(0,f.Gy)(T),k=N(),_=A(z);return T?!G||X||w||!H?[!1,!1]:[k,_]:[!1,!1]}function A(T){const w=K(T)[c.AccessControlAction.AlertingSilenceCreate]??!1;return n.TP.hasPermission(c.AccessControlAction.AlertingInstanceCreate)||w}function N(){const{currentData:T,isLoading:z}=U(void 0),w=T?.alertmanagersChoice===s.nA.External,H=T?.alertmanagersChoice===s.nA.All;return z?!1:!w||H}function K(T){const{folder:z}=(0,x.a4)(T);return z?.accessControl??{}}const V=(T,...z)=>[T,z.some(w=>w&&n.TP.hasPermission(w))]},82236:(q,j,e)=>{"use strict";e.d(j,{W:()=>r});var t=e(96540),n=e(88214);function r(a){return(0,t.useMemo)(()=>(0,n.sq)(a),[a])}},46329:(q,j,e)=>{"use strict";e.d(j,{g:()=>a});var t=e(96540),n=e(98437),r=e(65502);function a(i){return{allDataSourcesAvailable:(0,t.useMemo)(()=>i.filter(s=>!(0,r.s9)(s.datasourceUid)).every(s=>!!(0,n.l)().getInstanceSettings(s.datasourceUid)),[i])}}},25779:(q,j,e)=>{"use strict";e.d(j,{Gz:()=>u,VP:()=>d,Yb:()=>a,bJ:()=>x});var t=e(74848),n=e(96540),r=e(85651);function a(o,E){const[m,f]=(0,n.useState)({status:"not-executed",error:void 0,result:E}),p=(0,n.useRef)(),h=(0,n.useRef)(),D=i({execute(...C){h.current=C;const l=o(...C);return p.current=l,f(v=>({...v,status:"loading"})),l.then(v=>{l===p.current&&f(y=>({...y,status:"success",error:void 0,result:v}))},v=>{l===p.current&&f(y=>({...y,status:"error",error:v}))}),l},reset(){f({status:"not-executed",error:void 0,result:E}),p.current=void 0,h.current=void 0}});return[(0,n.useMemo)(()=>({reset(){D.current.reset()},execute:(...C)=>D.current.execute(...C)}),[]),m,{promise:p.current,lastArgs:h.current}]}function i(o){const E=(0,n.useRef)(o);return E.current=o,(0,n.useMemo)(()=>Object.freeze({get current(){return E.current}}),[])}function x(o){return o.status==="error"}function s(o){return o.status==="success"}function c(o){return o.status==="not-executed"}function d(o){return o.status==="loading"}function u(...o){return{uninitialized:o.every(c),loading:o.some(d),error:o.find(x)?.error,success:o.some(s)}}function g({state:o}){return jsxs(Fragment,{children:[c(o)&&"uninitialized",d(o)&&"loading",s(o)&&"success",s(o)&&`result: ${JSON.stringify(o.result,null,2)}`,x(o)&&`error: ${stringifyErrorLike(o.error)}`]})}},8276:(q,j,e)=>{"use strict";e.d(j,{Ll:()=>m,O3:()=>f,ZU:()=>g,we:()=>u});var t=e(96540),n=e(16817),r=e(88214),a=e(5240),i=e(27106),x=e(68639),s=e(82700),c=e(91064),d=e(34657);function u(p,h,D){const C=(0,r.oh)(h),{dsFeatures:l,isLoadingDsFeatures:v}=f(h),{currentData:y,isLoading:P,error:b}=a.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:h,ruleName:p,namespace:D?.namespace,groupName:D?.groupName}),[S]=a.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:M,error:O,value:R}=(0,n.A)(async()=>{if(!C)throw new Error("Unable to obtain data source settings");if(b)throw new Error("Unable to obtain Prometheus rules");const L=y||[],B=[];if(l?.rulerConfig){const U=l.rulerConfig,W=L.map(A=>A.groups.map(N=>({namespace:A,group:N}))).flat();await Promise.allSettled(W.map(async A=>{const N=await S({rulerConfig:U,namespace:A.namespace.name,group:A.group.name}).unwrap();B.push(N)}))}return L.map(U=>(0,c.O6)(C,U,B)).flatMap(U=>U.groups.flatMap(W=>W.rules))},[C,l,P,b,y,S]);return{loading:v||M,error:O,rules:R}}function g({ruleIdentifier:p,limitAlerts:h}){const{ruleSourceName:D}=p,C=E(p),{dsFeatures:l,isLoadingDsFeatures:v}=f(D),{loading:y,error:P,result:b}=o(p),{currentData:S=[],isLoading:M,error:O}=a.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:p.ruleSourceName,namespace:b?.namespace,groupName:b?.group,ruleName:b?.ruleName,limitAlerts:h},{skip:!b||y,refetchOnMountOrArgChange:!0}),R=(0,r.z2)(D),L=(0,d.a4)(R?b?.namespace:void 0),B=R&&L.folder?(0,d.WL)(L.folder):b?.namespace,[F,{currentData:I,isLoading:U,error:W}]=a.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!l?.rulerConfig||!b||F({rulerConfig:l.rulerConfig,namespace:b.namespace,group:b.group})},[l,F,b]);const A=(0,t.useMemo)(()=>{if(!C||!b)return;const N=I&&B?{[B]:[I]}:{};return(0,c.gt)(C,S,N).flatMap(z=>z.groups).flatMap(z=>z.rules).find(z=>x.LC(x.UP(D,z),p))},[p,D,S,I,C,b,B]);return{loading:v||M||U,error:P??O??W,result:A}}function o(p){const{isLoading:h,currentData:D,error:C,isUninitialized:l}=a.hK.endpoints.getAlertRule.useQuery({uid:(0,s.A4)(p)?p.uid:""},{skip:!(0,s.A4)(p),refetchOnMountOrArgChange:!0});return(0,t.useMemo)(()=>(0,s.Mj)(p)||(0,s.X4)(p)?{result:{datasource:p.ruleSourceName,namespace:p.namespace,group:p.groupName,ruleName:p.ruleName},loading:!1}:(0,s.A4)(p)?h||l?{loading:!0}:C?{loading:!1,error:C}:D?{result:{datasource:p.ruleSourceName,namespace:D.grafana_alert.namespace_uid,group:D.grafana_alert.rule_group,ruleName:D.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${p.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[p,h,l,C,D])}function E(p){return(0,s.A4)(p)?"grafana":(0,r.oh)(p.ruleSourceName)}function m({ruleIdentifier:p}){const h=E(p),{data:D,isLoading:C}=i.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:p.ruleSourceName}),{loading:l,error:v,result:y}=o(p),[P,{currentData:b,isLoading:S,isUninitialized:M,error:O}]=a.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!D?.rulerConfig||!y||P({rulerConfig:D.rulerConfig,namespace:y.namespace,group:y.group})},[D,P,y]);const R=(0,t.useMemo)(()=>{const{ruleSourceName:L}=p;if(!b||!h||!y)return;const B=b.rules.find(F=>{const I=x.P1(L,y.namespace,y.group,F);return x.LC(I,p)});if(B)return{ruleSourceName:L,group:b,namespace:y.namespace,rule:B}},[p,b,h,y]);return{loading:l||C||S||M,error:v??O,result:R}}function f(p){const{currentData:h,isLoading:D}=i.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:p});return{isLoadingDsFeatures:D,dsFeatures:h}}},91064:(q,j,e)=>{"use strict";e.d(j,{Jr:()=>D,NW:()=>P,O6:()=>f,Tj:()=>b,Ug:()=>y,dy:()=>E,gt:()=>m,kU:()=>B,yh:()=>p});var t=e(2543),n=e.n(t),r=e(96540),a=e(35004),i=e(51876),x=e(5240),s=e(27106),c=e(83466),d=e(88214),u=e(68639),g=e(82700),o=e(9912);function E(F,I){const U=(0,o.$)(K=>K.promRules),W=(0,o.$)(K=>K.rulerRules),A=(0,r.useRef)({}),N=(0,r.useMemo)(()=>{if(F){const K=(0,d.Zw)(F);if(!K)throw new Error(`Unknown rules source: ${F}`);return[K]}return(0,d.lS)()},[F]);return(0,r.useMemo)(()=>N.map(K=>{const V=(0,d.Eb)(K)?K.name:K,T=W[V]?.result;let z=U[V]?.result;V===d.hY&&I&&(z=I);const w=A.current[V];if(w&&w.promRules===z&&w.rulerRules===T)return w.result;const H={};Object.entries(T||{}).forEach(([X,k])=>{const _={rulesSource:K,name:X,groups:[]};(0,g.lT)(k[0].rules[0])&&(_.uid=k[0].rules[0].grafana_alert.namespace_uid),H[X]=_,l(_,k)}),z?.forEach(({name:X,groups:k})=>{const _=H[X]=H[X]||{rulesSource:K,name:X,groups:[]};v(_,k)});const G=Object.values(H);return A.current[V]={promRules:z,rulerRules:T,result:G},G}).flat(),[U,W,N,I])}function m(F,I,U){const W={};return Object.entries(U||{}).forEach(([A,N])=>{const K={rulesSource:F,name:A,groups:[]};W[A]=K,l(K,N)}),I?.forEach(({name:A,groups:N})=>{const K=W[A]=W[A]||{rulesSource:F,name:A,groups:[]};v(K,N)}),Object.values(W)}function f(F,I,U){const W={rulesSource:F,name:I.name,groups:[]};return l(W,U),v(W,I.groups),W.groups.forEach(A=>{A.rules=A.rules.filter(N=>N.promRule)}),W}function p(F,I){if(!F.promRule)return;const W=I.rules.map(N=>O(N,F.namespace,F.group)).reduce((N,K)=>{const V=N.get(K.name);return V?V.push(K):N.set(K.name,[K]),N},new Map),A=R(F.promRule,W,F.namespace.rulesSource);A&&(F.rulerRule=A.rulerRule,F.query=A.query,F.labels=A.labels,F.annotations=A.annotations)}function h(F,I,U){return l(F,U),v(F,I),F}function D(F){return F.map(I=>{const U={...I,groups:[]};return U.groups.push({name:"default",rules:C(I.groups.flatMap(W=>W.rules)),totals:S(I.groups)}),U})}function C(F){return F.sort((I,U)=>I.name.localeCompare(U.name))}function l(F,I=[]){F.groups=I.map(U=>{const W=U.rules.filter(K=>(0,g.i7)(K)).length,A=U.rules.filter(K=>(0,g.lT)(K)&&K.grafana_alert.is_paused).length,N={name:U.name,interval:U.interval,source_tenants:U.source_tenants,rules:[],totals:{paused:A,recording:W}};return N.rules=U.rules.map(K=>O(K,F,N)),N})}function v(F,I){const U=new Map;F.groups.forEach(W=>U.set(W.name,W)),I.forEach(W=>{let A=U.get(W.name);A||(A={name:W.name,rules:[],totals:b(W)},F.groups.push(A),U.set(W.name,A)),A.totals={...A.totals,...b(W)};const N=new Map;A.rules.forEach(K=>{const V=N.get(K.name);V?V.push(K):N.set(K.name,[K])}),(W.rules??[]).forEach(K=>{const V=R(K,N,F.rulesSource);V?(V.promRule=K,V.instanceTotals=(0,g.Z8)(K)?y(K):{},V.filteredInstanceTotals=(0,g.Z8)(K)?P(K):{}):A.rules.push(M(K,F,A))})})}function y(F){const I=(0,t.countBy)(F.alerts,"state");if(F.totals){const{normal:U,...W}=F.totals;return{...W,inactive:U}}return{alerting:I[a.$7.Alerting]||I.firing,pending:I[a.$7.Pending],inactive:I[a.$7.Normal],nodata:I[a.$7.NoData],error:I[a.$7.Error]||I.err||void 0}}function P(F){if(F.totalsFiltered){const{normal:I,...U}=F.totalsFiltered;return{...U,inactive:I}}return{}}function b(F){if(F.totals){const{firing:A,...N}=F.totals;return{...N,alerting:A}}const I=(0,t.countBy)(F.rules,A=>(0,g.Z8)(A)&&A.state),U=(0,t.countBy)(F.rules,A=>A.health),W=F.rules.filter(A=>(0,g.KB)(A)).length;return{alerting:I[i.cF.Firing],error:U.error,nodata:U.nodata,inactive:I[i.cF.Inactive],pending:I[i.cF.Pending],recording:W}}function S(F){const I={};return F.forEach(U=>{const W=U.totals;Object.entries(W).forEach(([A,N])=>{I[A]||(I[A]=0),N!=null&&(I[A]+=N)})}),I}function M(F,I,U){return{name:F.name,query:F.query,labels:F.labels||{},annotations:(0,g.Z8)(F)?F.annotations||{}:{},promRule:F,namespace:I,group:U,instanceTotals:(0,g.Z8)(F)?y(F):{},filteredInstanceTotals:(0,g.Z8)(F)?P(F):{}}}function O(F,I,U){return(0,g.$y)(F)?{name:F.alert,query:F.expr,labels:F.labels||{},annotations:F.annotations||{},rulerRule:F,namespace:I,group:U,instanceTotals:{},filteredInstanceTotals:{}}:(0,g.i7)(F)?{name:F.record,query:F.expr,labels:F.labels||{},annotations:{},rulerRule:F,namespace:I,group:U,instanceTotals:{},filteredInstanceTotals:{}}:{name:F.grafana_alert.title,query:"",labels:F.labels||{},annotations:F.annotations||{},rulerRule:F,namespace:I,group:U,instanceTotals:{},filteredInstanceTotals:{}}}function R(F,I,U){const W=I.get(F.name);if(!W)return;if((0,d.z2)(U))return W[0];const A=W.find(K=>!K.promRule&&L(K,F,!0));if(A)return A;const N=W.find(K=>!K.promRule&&L(K,F,!1));if(N)return N}function L(F,I,U=!0){return F.name===I.name?(0,t.isEqual)([U?(0,u.h1)(F.query):"",F.labels,F.annotations],[U?(0,u.h1)(I.query):"",I.labels||{},(0,g.Z8)(I)?I.annotations||{}:{}]):!1}function B(F,I,U){const W=!F,{currentData:A,isLoading:N,error:K}=x.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:d.hY,dashboardUid:F??void 0,panelId:I},{skip:W,pollingInterval:U?c.HH:void 0}),{currentData:V,isLoading:T,error:z}=x.hK.endpoints.rulerRules.useQuery({rulerConfig:s.b,filter:{dashboardUID:F??void 0,panelId:I}},{pollingInterval:U?c.HH:void 0,skip:W}),w=(0,r.useRef)({}),H=(0,d.Zw)(d.hY),G=(0,r.useMemo)(()=>{if(!H)return[];const X=w.current[d.hY];if(X&&X.promRules===A&&X.rulerRules===V)return X.result;const k={};Object.entries(V||{}).forEach(([ee,J])=>{const Z={rulesSource:H,name:ee,groups:[]};(0,g.lT)(J[0].rules[0])&&(Z.uid=J[0].rules[0].grafana_alert.namespace_uid),k[ee]=Z,l(Z,J)}),A?.forEach(({name:ee,groups:J})=>{const Z=k[ee]=k[ee]||{rulesSource:H,name:ee,groups:[]};v(Z,J)});const _=Object.values(k);return w.current[d.hY]={promRules:A,rulerRules:V,result:_},_},[A,V,H]);return{loading:N||T,error:K??z,result:G}}},19127:(q,j,e)=>{"use strict";e.d(j,{dI:()=>y,i7:()=>P});var t=e(84139),n=e(1932),r=e(2543),a=e.n(r),i=e(96540),x=e(98437),s=e(51876),c=e(83893),d=e(60344),u=e(1814),g=e(83466),o=e(88214),E=e(55936),m=e(82700),f=e(91064),p=e(84558);const h=25,D=1/0,C=5,l=/[^ -~]/m,v=/^[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+$/m;function y(){const[B,F]=(0,p.l)(),I=B.get("search")??"",U=(0,i.useMemo)(()=>(0,d.XY)(I),[I]),W=(0,i.useMemo)(()=>Object.values(U).some(K=>!(0,r.isEmpty)(K)),[U]),A=(0,i.useCallback)(K=>{const V=(0,d.kL)(I,K);F({search:V})},[I,F]),N=(0,i.useCallback)(K=>{F({search:K})},[F]);return(0,i.useEffect)(()=>{const K={dataSource:B.get("dataSource")??void 0,alertState:B.get("alertState")??void 0,ruleType:B.get("ruleType")??void 0,labels:(0,E.S6)(B.get("queryString")??"").map(u.MU)};Object.values(K).some(T=>!(0,r.isEmpty)(T))&&(F({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),A((0,n.jM)(U,T=>{if(T.dataSourceNames??=K.dataSource?[K.dataSource]:[],K.alertState&&(0,s.Si)(K.alertState)&&(T.ruleState??=K.alertState),K.ruleType&&(0,m.nf)(K.ruleType)&&(T.ruleType??=K.ruleType),T.labels.length===0&&K.labels.length>0){const z=K.labels.map(({name:w,operator:H,value:G})=>`${w}${H}${G}`);T.labels.push(...z)}})))},[B,A,U,F]),{filterState:U,hasActiveFilters:W,searchQuery:I,setSearchQuery:N,updateFilters:A}}const P=(B,F)=>{const I=(0,i.useDeferredValue)(B),U=(0,i.useDeferredValue)(F);return(0,i.useMemo)(()=>{const W=b(I,U);return W.forEach(A=>{A.groups.forEach(N=>{N.rules.forEach(K=>{(0,m.Z8)(K.promRule)&&(K.instanceTotals=(0,f.Ug)(K.promRule),K.filteredInstanceTotals=(0,f.NW)(K.promRule))}),N.totals=(0,f.Tj)({rules:N.rules.map(K=>K.promRule).filter(K=>!!K)})})}),W},[I,U])},b=(B,F={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let I=B;const U=F.dataSourceNames;U.length&&(I=I.filter(({rulesSource:N})=>(0,o.Eb)(N)?U.includes(N.name):!0));const W=F.namespace;W&&(I=R(I,N=>N.name,W));const A=[];try{I.reduce(S(F),[]).forEach(K=>{A.push(K)})}catch(N){(0,c.vV)(new Error("Failed to filter rules",{cause:N}),{search:JSON.stringify(F)})}return A},S=B=>(F,I)=>{const U=B.groupName;let W=I.groups;return U&&(W=R(W,A=>A.name,U)),W=W.reduce(M(B),[]),W.length&&F.push({...I,groups:W}),F},M=B=>{const F=B.ruleName??B.freeFormWords.join(" ");return(I,U)=>{let W=U.rules;return F&&(W=R(W,A=>A.name,F)),W=W.filter(A=>{const N=A.promRule,K=(0,r.chain)(B).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins","contactPoint"]).omitBy(r.isEmpty).mapValues(()=>!1).value();if("ruleType"in K&&B.ruleType===N?.type&&(K.ruleType=!0),"plugins"in K&&B.plugins==="hide"&&(K.plugins=A.rulerRule&&!(0,m.Tm)(A.rulerRule)),"contactPoint"in K){const V=B.contactPoint;(0,m.lT)(A.rulerRule)&&A.rulerRule.grafana_alert.notification_settings?.receiver===V&&(K.contactPoint=!0)}if("dataSourceNames"in K&&((0,m.lT)(A.rulerRule)?L(A.rulerRule,B)&&(K.dataSourceNames=!0):K.dataSourceNames=!0),"ruleHealth"in B&&N){const V=(0,m.f6)(N.health);B.ruleHealth===V&&(K.ruleHealth=!0)}if("labels"in K){const V=(0,r.compact)(B.labels.map(O)),T=V.length>0&&(0,u.Av)(A.labels,V),z=V.length>0&&N&&N.type===s.JS.Alerting&&N.alerts&&N.alerts.some(w=>(0,u.Av)(w.labels,V));(T||z)&&(K.labels=!0)}if("ruleState"in K){const V=A.promRule;V&&(0,m.Z8)(V)&&V.state===B.ruleState&&(K.ruleState=!0)}return"dashboardUid"in K&&A.annotations[g.YH.dashboardUID]===B.dashboardUid&&(K.dashboardUid=!0),Object.values(K).every(V=>V===!0)}),W.length&&I.push({...U,rules:W}),I}};function O(B){try{return(0,E.qR)(B)}catch{return{name:B,value:"",isRegex:!0,isEqual:!0}}}function R(B,F,I){let U=B;const W=new t.A({intraMode:1}),A=W.split(I).length;if(l.test(I)||v.test(I)||I.length>h||A>C)return B.filter(H=>F(H).toLowerCase().includes(I.toLowerCase()));const K=B.map(F),V=A<5?4:0,[T,z,w]=W.search(K,I,V,D);return z&&w?U=w.map(H=>U[z.idx[H]]):T&&(U=T.map(H=>U[H])),U}const L=(B,F)=>F.dataSourceNames?.length?!!B.grafana_alert.data.find(I=>{if(!I.datasourceUid)return!1;const U=(0,x.l)().getInstanceSettings(I.datasourceUid);return U?.name&&F?.dataSourceNames?.includes(U.name)}):!0},34657:(q,j,e)=>{"use strict";e.d(j,{WL:()=>s,a4:()=>x});var t=e(96540),n=e(61491),r=e(48542),a=e(4013),i=e(9912);function x(d){const u=(0,n.useDispatch)(),g=(0,i.$)(o=>o.folders);if((0,t.useEffect)(()=>{d&&u((0,r.Om)(d))},[u,d]),d){const o=g[d]||a.jA;return{folder:o.result,loading:o.loading}}return{loading:!1}}function s({title:d,parents:u}){return u&&u?.length?[...u.map(g=>g.title),d].map(c).join("/"):c(d)}function c(d){return d.replaceAll("/","\\/")}},3161:(q,j,e)=>{"use strict";e.d(j,{y:()=>a});var t=e(27106),n=e(88214);const{useDiscoverDsFeaturesQuery:r}=t.L;function a(i){const x=(0,n.EV)(i),{currentData:s}=r({rulesSourceName:x});return{hasRuler:!!s?.rulerConfig,rulerConfig:s?.rulerConfig}}},78731:(q,j,e)=>{"use strict";e.d(j,{g:()=>s});var t=e(61351),n=e(27106),r=e(96621),a=e(88214),i=e(82700),x=e(34657);function s(c,d){const{currentData:u,isLoading:g}=n.L.endpoints.discoverDsFeatures.useQuery({uid:(0,a.w5)(c)}),o=d&&(0,i.lT)(d)?d.grafana_alert.namespace_uid:void 0,E=(0,r.Wd)(c),{folder:m,loading:f}=(0,x.a4)(o);if(!d)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,i.lT)(d)){if(!o)throw new Error(`Rule ${d.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!m)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:f};const C=t.TP.hasPermissionInMetadata(E.update,m),l=t.TP.hasPermissionInMetadata(E.delete,m);return{isRulerAvailable:!0,isEditable:C,isRemovable:l,loading:f||g}}const p=!!u?.rulerConfig,h=t.TP.hasPermission(E.update),D=t.TP.hasPermission(E.delete);return{isRulerAvailable:p,isEditable:h&&p,isRemovable:D&&p,loading:g}}},99797:(q,j,e)=>{"use strict";e.d(j,{W:()=>a});var t=e(2543),n=e.n(t),r=e(96540);function a(i,x=1,s){const[c,d]=(0,r.useState)(x),u=(0,r.useMemo)(()=>(0,t.chunk)(i,s),[i,s]),g=u.length,o=u[c-1]??[],E=(c-1)*s+1,m=(0,t.clamp)(c*s,i.length),f=(0,r.useCallback)(D=>{d((0,t.clamp)(D,1,u.length))},[d,u]),p=(0,r.useCallback)(()=>f(c+1),[c,f]),h=(0,r.useCallback)(()=>f(c-1),[c,f]);return(0,r.useEffect)(()=>d(1),[g]),{page:c,onPageChange:f,numberOfPages:g,pageItems:o,pageStart:E,pageEnd:m,nextPage:p,previousPage:h}}},32757:(q,j,e)=>{"use strict";e.d(j,{S:()=>n});var t=e(91064);function n({dashboardUID:r,panelId:a,poll:i=!1}){const{result:x,loading:s,error:c}=(0,t.kU)(r,a,i);return{rules:x?x.flatMap(u=>u.groups).flatMap(u=>u.rules):[],errors:c?[c]:[],loading:s}}},51311:(q,j,e)=>{"use strict";e.d(j,{_:()=>r});var t=e(16817),n=e(6838);function r(a){const{loading:i,error:x,value:s}=(0,t.A)(()=>(0,n.x)(a,{showErrorAlert:!1})),c=s&&!x&&!i,d=s?.enabled;return i&&!s?{loading:!0}:!c||!d?{loading:!1,installed:!1}:{loading:i,installed:!0,settings:s}}},25061:(q,j,e)=>{"use strict";e.d(j,{d:()=>m});var t=e(34632),n=e(9365),r=e(65665),a=e(31746),i=e(61499),x=e(86203),s=e(13005);function c(...f){return{error:f.find(p=>p.error),isUninitialized:f.every(p=>p.isUninitialized),isSuccess:f.every(p=>p.isSuccess),isError:f.some(p=>p.isError),isLoading:f.some(p=>p.isLoading)}}const d=new Error("no active Alertmanager"),{useLazyGetAlertmanagerConfigurationQuery:u,useUpdateAlertmanagerConfigurationMutation:g}=n.m,o={alertmanager_config:{receivers:[],route:{},time_intervals:[],mute_time_intervals:[],inhibit_rules:[],templates:[]},template_files:{}},E=(0,t.A)(o,r.f1,x.NF,i.r0,a.B8);function m(){const{selectedAlertmanager:f}=(0,s.VI)(),[p,h]=u(),[D,C]=g(),l=c(h,C);if(!f)throw d;return[async y=>{const P=await p(f).unwrap(),b=E(P,y);return D({selectedAlertmanager:f,config:b}).unwrap()},l]}},81513:(q,j,e)=>{"use strict";e.d(j,{I:()=>o,f:()=>E});var t=e(96540),n=e(5240),r=e(68639),a=e(82700),i=e(25779);const{useLazyPrometheusRuleNamespacesQuery:x}=n.hK,s=3*1e3,c=90*1e3,{setInterval:d,clearInterval:u}=window;function g(){const[m]=x();return{matchingPromRuleExists:(0,t.useCallback)(async p=>{const{ruleSourceName:h,namespace:D,groupName:C,ruleName:l}=p;return(await m({ruleSourceName:h,namespace:D,groupName:C,ruleName:l}).unwrap()).find(b=>b.name===D)?.groups.find(b=>b.name===C)?.rules.some(b=>{const S=r.Lg(h,D,C,b);return r.LC(S,p)})??!1},[m])}}function o(){const{matchingPromRuleExists:m}=g(),f=(0,t.useRef)(),p=(0,t.useRef)();(0,t.useEffect)(()=>()=>{h(),D()},[]);const h=()=>{f.current&&(u(f.current),f.current=void 0)},D=()=>{p.current&&(u(p.current),p.current=void 0)};async function C(v){h();const y=new Promise((b,S)=>{setTimeout(()=>{h(),S(new Error("Timeout while waiting for rule removal"))},c)}),P=new Promise((b,S)=>{f.current=d(()=>{m(v).then(M=>{M===!1&&(h(),b())}).catch(M=>{h(),S(M)})},s)});return Promise.race([y,P])}async function l(v){D();const y=new Promise((b,S)=>{setTimeout(()=>{D(),S(new Error("Timeout while waiting for rule creation"))},c)}),P=new Promise((b,S)=>{p.current=d(()=>{m(v).then(M=>{M===!0&&(D(),b())}).catch(M=>{D(),S(M)})},s)});return Promise.race([y,P])}return{waitForRemoval:C,waitForCreation:l}}function E(m){const{matchingPromRuleExists:f}=g(),{waitForCreation:p}=o(),[h,D]=(0,i.Yb)(async C=>(0,a.X4)(C)?p(C):Promise.resolve());return(0,t.useEffect)(()=>{(0,a.X4)(m)&&f(m).then(C=>{C||h.execute(m)})},[h,m,f]),{isConsistent:D.status==="success"||D.status==="not-executed",error:D.error}}},29526:(q,j,e)=>{"use strict";e.d(j,{h:()=>i});var t=e(84099),n=e(32370),r=e(83893),a=e(84558);function i(s){const c={returnTo:s},[d]=(0,a.l)(),u=d.get("returnTo");if(!u)return c;const g=t.sQ.sanitizeUrl(u),o=`${window.location.origin}/${n.$.appSubUrl}`,E=x(g,o);if(!E)return(0,r.FF)("Malformed returnTo parameter",{returnTo:u}),c;const{protocol:m,origin:f,pathname:p,search:h}=E;return["http:","https:"].includes(m)===!1||f!==window.location.origin?((0,r.FF)("Malformed returnTo parameter",{returnTo:u}),c):{returnTo:`${p}${h}`}}function x(s,c){try{return new URL(s,c)}catch{return null}}},40479:(q,j,e)=>{"use strict";e.d(j,{G:()=>u,Q:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(32370),i=e(29675),x=e(25356);const s=(0,r.lazy)(()=>e.e(1600).then(e.bind(e,81600))),c=(0,r.lazy)(()=>Promise.all([e.e(825),e.e(9069)]).then(e.bind(e,19069)));var d=(o=>(o.Loki="loki",o.Annotations="annotations",o))(d||{});function u(){const[o,E]=(0,r.useState)(!1),[m,f]=(0,r.useState)(),p=(0,i.of)(g),h=a.$.unifiedAlerting.alertStateHistoryBackend,D=a.$.unifiedAlerting.alertStateHistoryPrimary,l=[h,D].some(b=>b==="loki")?"loki":"annotations",v=(0,r.useCallback)(()=>{f(void 0),E(!1)},[]),y=(0,r.useCallback)(b=>{f(b),E(!0)},[]);return{StateHistoryModal:(0,r.useMemo)(()=>m?(0,t.jsx)(x.a,{isOpen:o,onDismiss:v,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:p.modal,contentClassName:p.modalContent,children:(0,t.jsxs)(r.Suspense,{fallback:"Loading...",children:[l==="loki"&&(0,t.jsx)(c,{ruleUID:m.grafana_alert.uid}),l==="annotations"&&(0,t.jsx)(s,{ruleUID:m.grafana_alert.id??""})]})}):null,[m,o,v,l,p]),showStateHistoryModal:y,hideStateHistoryModal:v}}const g=o=>({modal:(0,n.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,n.css)({height:"100%",width:"100%",padding:o.spacing(2)})})},84558:(q,j,e)=>{"use strict";e.d(j,{l:()=>a});var t=e(96540),n=e(54148),r=e(53027);function a(){const{search:i}=(0,n.zy)(),x=(0,t.useMemo)(()=>new URLSearchParams(i),[i]),s=(0,t.useCallback)((c,d)=>{r.Ny.partial(c,d)},[]);return[x,s]}},9912:(q,j,e)=>{"use strict";e.d(j,{$:()=>r});var t=e(25508),n=e(61491);function r(a,i){return(0,n.useSelector)((0,t.Mz)(x=>x.unifiedAlerting,x=>a(x)),i)}},20206:(q,j,e)=>{"use strict";e.d(j,{T:()=>s});var t=e(74848),n=e(16817),r=e(66384),a=e(6736),i=e(85516),x=e(6838);function s({pluginId:c,size:d="md"}){const{value:u,loading:g}=(0,n.A)(()=>(0,x.x)(c));if(g||!u)return null;const o=u.info.logos?.small,E=u.name,m=(0,i.cs)(d),f=o?(0,t.jsx)("img",{src:o,alt:E,height:m}):(0,t.jsx)(r.E,{text:c,color:"orange"});return(0,t.jsx)(a.m,{content:`This rule is managed by the ${E} plugin`,children:f})}},65665:(q,j,e)=>{"use strict";e.d(j,{$8:()=>s,X9:()=>i,f1:()=>d,ov:()=>x});var t=e(65307),n=e(2543),r=e.n(n),a=e(1814);const i=(0,t.VP)("muteTiming/add"),x=(0,t.VP)("muteTiming/update"),s=(0,t.VP)("muteTiming/delete"),c={alertmanager_config:{},template_files:{}},d=(0,t.vy)(c,u=>{u.addCase(i,(g,{payload:o})=>{const{interval:E}=o;g.alertmanager_config.time_intervals=(g.alertmanager_config.time_intervals??[]).concat(E)}).addCase(x,(g,{payload:o})=>{const{interval:E,originalName:m}=o,f=E.name!==m,p=g.alertmanager_config.time_intervals??[],h=g.alertmanager_config.mute_time_intervals??[],D=p.findIndex(({name:l})=>l===m);D!==-1&&(p[D]=E);const C=h.findIndex(({name:l})=>l===m);C!==-1&&(h[C]=E),f&&g.alertmanager_config.route&&(g.alertmanager_config.route=(0,a.$m)(E.name,m,g.alertmanager_config.route))}).addCase(s,(g,{payload:o})=>{const{name:E}=o,{alertmanager_config:m}=g,{time_intervals:f=[],mute_time_intervals:p=[]}=m;(0,n.remove)(f,h=>h.name===E),(0,n.remove)(p,h=>h.name===E),m.route=(0,a._n)(E,m.route??{})})})},31746:(q,j,e)=>{"use strict";e.d(j,{B8:()=>c,LY:()=>a,Z8:()=>i,tD:()=>x});var t=e(65307),n=e(12444),r=e(27174);const a=(0,t.VP)("routes/update"),i=(0,t.VP)("routes/delete"),x=(0,t.VP)("routes/add"),s={alertmanager_config:{},template_files:{}},c=(0,t.vy)(s,d=>{d.addCase(a,(u,{payload:g})=>{const{update:o,alertmanager:E}=g,{alertmanager_config:m}=u;if(!m.route)return;const f=(0,n.QM)(m.route),p=(0,r.AB)(E,o,f);m.route=(0,r.dn)(p)}).addCase(i,(u,{payload:g})=>{const{id:o}=g,{alertmanager_config:E}=u;if(!E.route)return;const m=(0,n.QM)(E.route),f=(0,r.AS)(o,m);u.alertmanager_config.route=(0,r.dn)(f)}).addCase(x,(u,{payload:g})=>{const{partialRoute:o,referenceRouteIdentifier:E,insertPosition:m,alertmanager:f}=g,{alertmanager_config:p}=u;if(!p.route)return;const h=(0,n.QM)(p.route),D=(0,r.I8)(f,o,E,h,m);u.alertmanager_config.route=(0,r.dn)(D)})})},61499:(q,j,e)=>{"use strict";e.d(j,{FB:()=>i,JI:()=>s,jS:()=>x,r0:()=>d});var t=e(65307),n=e(2543),r=e.n(n),a=e(5900);const i=(0,t.VP)("notificationTemplate/add"),x=(0,t.VP)("notificationTemplate/update"),s=(0,t.VP)("notificationTemplate/delete"),c={alertmanager_config:{},template_files:{}},d=(0,t.vy)(c,u=>{u.addCase(i,(g,{payload:o})=>{const{alertmanager_config:E={},template_files:m={}}=g,{template:f}=o;if(m[f.title]!==void 0)throw new Error("target template already exists");const h=(0,a.o)(f.title,f.content);m[f.title]=h,E.templates=(0,n.toArray)(E.templates).concat(f.title)}).addCase(x,(g,{payload:o})=>{const{alertmanager_config:E={},template_files:m={}}=g,{name:f,template:p}=o,h=f!==p.title;if(!(m[f]!==void 0))throw new Error(`Expected notification template ${f} to exist, but did not find it in the config`);const C=(0,a.o)(p.title,p.content);if(h){const l=f,v=p.title;if(m[v]!==void 0)throw new Error(`Duplicate template name ${v}`);(0,n.unset)(m,l),(0,n.remove)(E.templates??[],P=>P===l),E.templates=(0,n.toArray)(E.templates).concat(p.title)}m[p.title]=C}).addCase(s,(g,{payload:o})=>{const{name:E}=o,{alertmanager_config:m={},template_files:f={}}=g;(0,n.unset)(f,E),(0,n.remove)(m.templates??[],p=>p===E)})})},86203:(q,j,e)=>{"use strict";e.d(j,{BD:()=>i,FS:()=>s,NF:()=>d,Xm:()=>x});var t=e(65307),n=e(2543),r=e.n(n),a=e(86655);const i=(0,t.VP)("receiver/add"),x=(0,t.VP)("receiver/update"),s=(0,t.VP)("receiver/delete"),c={alertmanager_config:{},template_files:{}},d=(0,t.vy)(c,u=>{u.addCase(i,(g,{payload:o})=>{const E=g.alertmanager_config.receivers=g.alertmanager_config.receivers??[];if(E.some(f=>f.name===o.name))throw new Error(`Duplicate receiver name ${o.name}`);E.push(o)}).addCase(x,(g,{payload:o})=>{const{name:E,receiver:m}=o,f=E!==m.name,p=g.alertmanager_config.receivers??[],h=p.findIndex(l=>l.name===E);if(!(h>-1))throw new Error(`Expected receiver ${E} to exist, but did not find it in the config`);if(f&&p.some(v=>v.name===m.name))throw new Error(`Duplicate receiver name ${m.name}`);p[h]=m;const C=g.alertmanager_config.route;C&&f&&(g.alertmanager_config.route=(0,a.Wn)(C,E,m.name))}).addCase(s,(g,{payload:o})=>{(0,n.remove)(g.alertmanager_config.receivers??[],E=>E.name===o)})})},76206:(q,j,e)=>{"use strict";e.d(j,{Ct:()=>C,KH:()=>u,KL:()=>E,LH:()=>d,Qn:()=>s,Wu:()=>c,bw:()=>m,fO:()=>o,i3:()=>p,lF:()=>g});var t=e(65307),n=e(2543),r=e.n(n),a=e(88214),i=e(68639),x=e(82700);const s=(0,t.VP)("ruleGroup/rules/add"),c=(0,t.VP)("ruleGroup/rules/update"),d=(0,t.VP)("ruleGroup/rules/pause"),u=(0,t.VP)("ruleGroup/rules/delete"),g=(0,t.VP)("ruleGroup/update"),o=(0,t.VP)("ruleGroup/move"),E=(0,t.VP)("ruleGroup/rename"),m=(0,t.VP)("ruleGroup/rules/reorder"),f={name:"initial",rules:[]},p=(0,t.vy)(f,v=>{v.addCase(s,(y,{payload:P})=>{const{rule:b}=P;y.rules.push(b)}).addCase(c,(y,{payload:P})=>{const{identifier:b,rule:S}=P,M=l(y.rules,b);y.rules[M]=S}).addCase(u,(y,{payload:P})=>{const{identifier:b}=P,S=l(y.rules,b);y.rules.splice(S,1)}).addCase(d,(y,{payload:P})=>{const{uid:b,pause:S}=P,M={ruleSourceName:a.hY,uid:b},O=l(y.rules,M),R=y.rules[O];if((0,x.lT)(R))R.grafana_alert.is_paused=S;else throw new Error("Matching rule is not a Grafana-managed rule")}).addCase(m,(y,{payload:P})=>{const{swaps:b}=P;D(y.rules,b)}).addMatcher((0,t.i0)(E,o,s),(y,{payload:P})=>{const{groupName:b}=P;y.name=b??y.name}).addMatcher((0,t.i0)(g,E,o,s),(y,{payload:P})=>{const{interval:b}=P;y.interval=b??y.interval}).addDefaultCase((y,P)=>{throw new Error(`Unknown action for rule group reducer: ${P.type}`)})}),h=v=>{const y=(0,x.A4)(v),P=(0,x.X4)(v);return b=>{const S=(0,x.lT)(b),M=(0,x.Mt)(b);if(y&&S)return b.grafana_alert.uid===v.uid;if(M&&P)return(0,i.Ns)(b)===v.rulerRuleHash}};function D(v,y){for(const P of y)C(v,P);return v}function C(v,[y,P]){if(!((0,n.inRange)(y,v.length)&&(0,n.inRange)(P,v.length)))throw new Error("Invalid operation: index out of bounds");const[S]=v.splice(y,1);v.splice(P,0,S)}function l(v,y){const P=v.findIndex(h(y));if(P===-1)throw new Error("no rule matching identifier found");return P}},69064:(q,j,e)=>{"use strict";e.d(j,{BH:()=>P,IJ:()=>h,JG:()=>l,T6:()=>p,_u:()=>b,b0:()=>v,ir:()=>y});var t=e(2543),n=e.n(t),r=e(32370),a=e(51876),i=e(39180),x=e(96621),s=e(83466),c=e(88214),d=e(82096),u=e(82700),g=e(32266),o=e(9469);const E=(0,g.P8)(r.$.unifiedAlerting?.minInterval??"10s"),m=(0,g.P8)("1m"),p=(0,g.an)((0,t.clamp)(E,m,1/0)),h=()=>{const{canCreateGrafanaRules:S,canCreateCloudRules:M}=(0,x.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:s.kl,dataSourceName:c.hY,type:S?i.Z.grafana:M?i.Z.cloudAlerting:void 0,group:"",folder:void 0,queries:[],recordingRulesQueries:[],condition:"",noDataState:a.Q8.NoData,execErrState:a.Q8.Error,evaluateFor:p,evaluateEvery:p,manualRouting:D(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],editorSettings:C(),namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},D=()=>r.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(d.Q8)!=="false":!1;function C(){if(!(r.$.featureToggles.alertingQueryAndExpressionsStepMode??!1))return;const M=localStorage.getItem(d.Os),O=localStorage.getItem(d.Q8);return{simplifiedQueryEditor:M!=="false",simplifiedNotificationEditor:O!=="false"}}function l(S,M){let O;try{O=JSON.parse(S)}catch{return{...h(),queries:(0,d.qO)()}}return(0,o.bx)((0,o.A2)((0,o.i_)({...h(),...O,annotations:(0,o.JE)(O.annotations??[]),queries:O.queries??(0,d.qO)(),type:M||i.Z.grafana,evaluateEvery:p})))}function v(S){return(0,o.i_)({...h(),...S})}function y(S){return(0,o.i_)((0,d.QX)(S))}function P(S){return{...h(),condition:"C",queries:(0,d.qO)((0,u.pq)(S)),type:S,evaluateEvery:p}}function b(S=""){return S==="recording"?i.Z.cloudRecording:S==="grafana-recording"?i.Z.grafanaRecording:i.Z.grafana}},9469:(q,j,e)=>{"use strict";e.d(j,{A2:()=>u,JE:()=>f,Nx:()=>g,Oy:()=>o,bx:()=>d,i_:()=>m});var t=e(2543),n=e.n(t),r=e(32370),a=e(12175),i=e(44684),x=e(45834),s=e(83466),c=e(88214);function d(p){if(!(r.$.featureToggles.alertingQueryAndExpressionsStepMode??!1))return{...p,editorSettings:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!0}};const D=p.queries.filter(v=>!(0,a.f)(v.model)),C=p.queries.filter(v=>o(v)),l=g(D,C);return{...p,editorSettings:{simplifiedQueryEditor:l,simplifiedNotificationEditor:!0}}}function u(p){return{...p,queries:p.queries?.map(h=>{if((0,a.f)(h.model))return h;const D=h.model.datasource?.type===c.ol.Loki||h.model.datasource?.type===c.ol.Prometheus,C="instant"in h.model&&h.model.instant!==void 0?h.model.instant:D;return{...h,model:{...h.model,instant:C,range:!C}}})}}function g(p,h){if(p.length!==1)return!1;const D="instant"in p[0].model&&p[0].model.instant&&h.length===1;if(h.length!==2&&!D||p[0].refId!==x.F7.queryId)return!1;const l=h.findIndex(R=>R.model.type===i.Tz.reduce&&R.refId===x.F7.reducerId),v=h.at(l),y=v&&l===0&&(v.model.settings?.mode===i.Mt.Strict||v.model.settings?.mode===void 0),P=h.findIndex(R=>R.model.type===i.Tz.threshold&&R.refId===x.F7.thresholdId),b=h.at(P),S=b?.model.conditions??[],O=b&&(D?P===0:P===1)&&S[0]?.unloadEvaluator===void 0;return(!!y||!!D)&&!!O}function o(p){return(0,a.f)(p.model)}function E(p){return!isExpressionQuery(p.model)}const m=p=>({...p,queries:p.queries?.map(h=>(0,t.omit)(h,"model.hide"))});function f(p){const h=[...p];return s.kl.map(C=>C.key).forEach((C,l)=>{const v=h.findIndex(y=>y.key===C);if(v===-1){const y={key:C,value:""};h.splice(l,0,y)}else v!==l&&h.splice(l,0,h.splice(v,1)[0])}),h}},87446:(q,j,e)=>{"use strict";e.d(j,{C:()=>s});var t=e(79197),n=e(48497),r=e(66102),a=e(3202),i=e(88090),x=e(32266);function s(d,u){if(!d||!u||!(0,r.vd)(d))return;let g;try{g=(0,x.M9)(u)}catch{return}if((0,x.mo)(d))return;const o=Date.parse(d||""),E=(0,t.A)(o,g);return(0,n.Y)(E,new Date)?{humanized:`within ${u}`,fullDate:`within ${u}`}:{humanized:`in ${(0,a.KQ)(E).locale("en").fromNow(!0)}`,fullDate:(0,i.LE)(E,{format:"YYYY-MM-DD HH:mm:ss"})}}function c(d){if(!d)return null;if(!isNullDate(d))return formatDistanceToNowStrict(new Date(d))}},60344:(q,j,e)=>{"use strict";e.d(j,{Jc:()=>w,kL:()=>G,XY:()=>H});var t=e(51876),n=e(82700);const r=1,a=2,i=3,x=4,s=5,c=6,d=7,u=8,g=9,o=10,E=11,m=12,f=13,p=14,h=15,D=0,C=1,l=2,v=3,y=4,P=5,b=6,S=7,M=8,O=9,R=10;var L=e(2543),B=e(48820);const F=B.U1.deserialize({version:14,states:"!vOQOPOOO{OPO'#CkOOOO'#Ck'#CkOQOPO'#CoOOOO'#Cl'#ClQQOPOOO!yOQO'#C^O#OOPO'#CmO#TOPO,59VOOOO,59Z,59ZOOOO-E6j-E6jOOOO,58x,58xOOOO,59X,59XOOOO-E6k-E6k",stateData:"$t~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UO^UOdPOfQO~OeVOR_XT_XU_XV_XW_XX_XY_XZ_X[_X]_X^_Xd_Xf_X~OSZO~Od[O~OeVOR_aT_aU_aV_aW_aX_aY_aZ_a[_a]_a^_ad_af_a~OR~T~U~V~W~Y~Z~[~]~^~R^][ZYXWVUTd~",goto:"}dPPePPPPPPPPPPPPejpPvVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken ContactPointToken FreeFormExpression",maxTerm:22,skippedNodes:[0],repeatNodeCount:2,tokenData:"$ nRRtqr#crs&ost#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]+q!]#V#c#V#W-T#W#X@m#X#Z#c#Z#[!/S#[#]!7|#]#`#c#`#a!B`#a#b#c#b#c!KY#c#d#c#d#e#,W#e#f#c#f#g#8S#g#h#?d#h#i#H^#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#jcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cQ$zcSQqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uQ&YP;=`<%l$uQ&`P;=`;NQ$uR&fP;=`<%l#cR&lP;=`;NQ#cR&rrX^(|pq(|qr(|st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R)PsX^(|pq(|qr(|rs+^st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R+eOSQfPR+hP;=`<%l(|R+nP;=`;NQ(|R+xcSQePqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR-[eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d.m#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR.teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c0V#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR0^eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i1o#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR1veSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U3X#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR3`eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W4q#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR4xeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i6Z#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR6beSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]!r#c!r!s7s!s$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR7zeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d9]#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR9deSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^:u#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR:|eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c<_#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR<feSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i=w#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR>OcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]?Z!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR?bcSQ^Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR@teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UBV#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRB^fSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#hCr#h#i! n#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRCyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]E[#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cREceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#VFt#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRF{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#dH^#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRHeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UIv#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRI}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#gK`#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRKgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#W#c#W#XLx#X$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRMPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRNccSQ[Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR! ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!#W#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!#_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h!$p#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!$weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!&Y#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!&aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!'r#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!'yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!)[#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!)ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W!*t#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!*{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!,^#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!,ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!-p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!-wcSQRPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!/ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!0l#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!0seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!2U#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!2]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!3n#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!3ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e!5W#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!5_cSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!6j!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!6qcSQVPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!8TeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!9f#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!9meSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!;O#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!;VeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!<h#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!<oeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i!>Q#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!>XeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]!?j#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!?qcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!@|!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!ATcSQZPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!BgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Cx#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!DPeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#V!Eb#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!EieSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!Fz#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!GReSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!Hd#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!HkcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!Iv!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!I}cSQUPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!KaeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Lr#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!LyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#a#c#a#b!N[#b$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!NceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y# t#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR# {eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h##^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR##eeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#$v#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#$}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#&`#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#&geSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W#'x#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#(PeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#)b#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#)icSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#*t!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#*{cSQTPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#,_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#-p#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#-weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#/Y#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#/aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#Z#c#Z#[#0r#[$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#0yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^#2[#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#2ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c#3t#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#3{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h#5^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#5ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#6p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#6wcSQ]Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#8ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#9l#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#9seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#;U#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#;]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#<n#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#<ucSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#>Q!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#>XcSQWPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#?keSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#@|#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#ATeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#Bf#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#BmeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#DO#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#DVeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Eh#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#EocSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#Fz!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#GRcSQXPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#HeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#m#c#m#n#Iv#n$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#I}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#K`#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#KgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Lx#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#MPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#NccSQYPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$u",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:141,nameSpaceFilter:143,labelFilter:145,groupFilter:147,ruleFilter:149,stateFilter:84,typeFilter:151,healthFilter:153,dashboardFilter:155,pluginsFilter:157,contactPointFilter:159},tokenPrec:161}),I={[i]:"datasource",[s]:"namespace",[c]:"label",[u]:"rule",[d]:"group",[g]:"state",[o]:"type",[E]:"health",[m]:"dashboard",[f]:"plugins",[p]:"contactPoint"};var U=(k=>(k.dataSource="dataSourceFilter",k.nameSpace="nameSpaceFilter",k.label="labelFilter",k.group="groupFilter",k.rule="ruleFilter",k.state="stateFilter",k.type="typeFilter",k.health="healthFilter",k.dashboard="dashboardFilter",k.plugins="pluginsFilter",k.contactPoint="contactPointFilter",k))(U||{});function W(k,_,ee){V(k,_,J=>{if(J.type.id===a){const Z=A(k,J);if(Z.type&&Z.value){const te=ee[Z.type];te&&te(Z.value)}}else if(J.type.id===h){const Z=ee[h];Z&&Z(N(k,J))}})}function A(k,_){if(_.type.id!==a)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const ee=_.firstChild;if(!ee)return{type:void 0,value:void 0};const J=_.getChild(x),Z=J?(0,L.trim)(N(k,J),'"'):void 0;return{type:ee.type.id,value:Z}}function N(k,_){return k.slice(_.from,_.to).trim().replace(/\"/g,"")}function K(k,_,ee){const J=[];V(k,_,te=>{te.type.id===a&&te.firstChild&&J.push(te.firstChild),te.type.id===h&&J.push(te)});const Z=[];return J.forEach(te=>{const ae=ee.findIndex(re=>re.type===te.type.id);if(ae!==-1){if(te.parent?.type.is(a)){const re=I[te.type.id],ne=ee.splice(ae,1)[0];Z.push(`${re}:${T(ne.value)}`)}if(te.type.is(h)){const re=ee.splice(ae,1)[0];Z.push(re.value)}}}),ee.forEach(te=>{te.type===h?Z.push(te.value):Z.push(`${I[te.type]}:${T(te.value)}`)}),Z.join(" ")}function V(k,_,ee){const J=_.join(" "),te=F.configure({dialect:J}).parse(k).cursor();do ee(te.node);while(te.next())}function T(k){return/\s/.test(k)?`"${k}"`:k}const z=[U.dataSource,U.nameSpace,U.label,U.group,U.rule,U.state,U.type,U.health,U.dashboard,U.plugins,U.contactPoint];var w=(k=>(k.Ok="ok",k.Error="error",k.NoData="nodata",k.Unknown="unknown",k))(w||{});function H(k){const _={labels:[],freeFormWords:[],dataSourceNames:[]},ee={[i]:J=>_.dataSourceNames.push(J),[s]:J=>_.namespace=J,[d]:J=>_.groupName=J,[u]:J=>_.ruleName=J,[c]:J=>_.labels.push(J),[g]:J=>_.ruleState=X(J),[o]:J=>(0,n.nf)(J)?_.ruleType=J:void 0,[E]:J=>_.ruleHealth=(0,n.f6)(J),[m]:J=>_.dashboardUid=J,[f]:J=>_.plugins=J==="hide"?J:void 0,[p]:J=>_.contactPoint=J,[h]:J=>_.freeFormWords.push(J)};return W(k,z,ee),_}function G(k,_){const ee=[];return _.dataSourceNames&&ee.push(..._.dataSourceNames.map(J=>({type:i,value:J}))),_.namespace&&ee.push({type:s,value:_.namespace}),_.groupName&&ee.push({type:d,value:_.groupName}),_.ruleName&&ee.push({type:u,value:_.ruleName}),_.ruleState&&ee.push({type:g,value:_.ruleState}),_.ruleType&&ee.push({type:o,value:_.ruleType}),_.ruleHealth&&ee.push({type:E,value:_.ruleHealth}),_.labels&&ee.push(..._.labels.map(J=>({type:c,value:J}))),_.dashboardUid&&ee.push({type:m,value:_.dashboardUid}),_.plugins&&ee.push({type:f,value:_.plugins}),_.freeFormWords&&ee.push(..._.freeFormWords.map(J=>({type:h,value:J}))),_.contactPoint&&ee.push({type:p,value:_.contactPoint}),K(k,z,ee)}function X(k){if(k==="normal")return t.cF.Inactive;if((0,t.Si)(k))return k}},13005:(q,j,e)=>{"use strict";e.d(j,{Kh:()=>m,VI:()=>g,b9:()=>u});var t=e(74848),n=e(96540),r=e(53027),a=e(82856),i=e(80187),x=e(82236),s=e(83466),c=e(88214);const d=n.createContext(void 0),u=({children:f,accessType:p,alertmanagerSourceName:h})=>{const D=r.Ny.getSearch(),C=r.Ny.partial,l=(0,x.W)(p),v=l.availableInternalDataSources.concat(l.availableExternalDataSources),y=n.useCallback(U=>{o(v,U)&&(U===c.hY?(a.A.delete(s.Oq),C({[s.DD]:void 0})):(a.A.set(s.Oq,U),C({[s.DD]:U})))},[v,C]),P=D.get(s.DD),b=a.A.get(s.Oq),S=c.hY;n.useEffect(()=>{P&&P!==b&&a.A.set(s.Oq,P)},[P,b]);const M=h??P??b??S,O=o(v,M)?M:void 0,R=(0,c.r3)(O)?.jsonData,L=O===c.hY,B=R?m(R):!1,I={selectedAlertmanager:O,hasConfigurationAPI:L||B,isGrafanaAlertmanager:L,selectedAlertmanagerConfig:R,availableAlertManagers:v,setSelectedAlertmanager:y};return(0,t.jsx)(d.Provider,{value:I,children:f})};function g(){const f=n.useContext(d);if(f===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return f}function o(f,p){return f.map(D=>D.name).includes(p)}const E=[i.Oz.mimir,i.Oz.cortex,void 0];function m(f){return E.includes(f.implementation)}},48542:(q,j,e)=>{"use strict";e.d(j,{nO:()=>F,D3:()=>B,yo:()=>b,nV:()=>S,Tp:()=>R,Om:()=>L,JH:()=>M,Lc:()=>P,mB:()=>v,eB:()=>y,uQ:()=>U,bO:()=>I,RW:()=>O});var t=e(65307),n=e(2543),r=e(53027),a=e(18729),i=e(75911),x=e(83893),s=e(51885),c=e(9365),d=e(28082);function u(W){return(0,d.AI)().get("/api/annotations",{alertUID:W}).then(A=>A?.sort(g))}function g(W,A){const N=(T,z)=>T>z?-1:z>T?1:0,K=N(W.timeEnd,A.timeEnd);if(K)return K;const V=N(W.time,A.time);return V||N(W.id,A.id)}var o=e(27106),E=e(76204),m=e(37398),f=e(1814),p=e(88214),h=e(85651),D=e(4013),C=e(82700),l=e(32266);const v=(0,t.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:W,filter:A,limitAlerts:N,matcher:K,state:V,identifier:T},z)=>{const w=(0,x.U7)("unifiedalerting/fetchPromRules",E.sA,{dataSourceName:W,thunk:"unifiedalerting/fetchPromRules"});return await(0,D.$I)(w(W,A,N,K,V,T))}),y=(0,t.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:W,filter:A},{dispatch:N,getState:K})=>{const{data:V}=await N(o.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:W}));if(!V?.rulerConfig)return null;const T=(0,x.Ke)("unifiedalerting/fetchRulerRules",m.iy,{dataSourceName:W,thunk:"unifiedalerting/fetchRulerRules"});return await(0,D.$I)(T(V.rulerConfig,A))});function P({rulesSourceName:W,identifier:A,filter:N,limitAlerts:K,matcher:V,state:T}){return async z=>{const{data:w}=await z(o.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:W}));await Promise.all([z(v({rulesSourceName:W,identifier:A,filter:N,limitAlerts:K,matcher:V,state:T})),w?.rulerConfig?z(y({rulesSourceName:W})):Promise.resolve()])}}function b(W=!1,A={}){return async(N,K)=>{const V=performance.now();await Promise.allSettled((0,p.gR)().map(async T=>{const{data:z}=await N(o.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:T})),{promRules:w,rulerRules:H}=K().unifiedAlerting;if(!z)return;const G=W||!w[T]?.loading,X=(W||!H[T]?.loading)&&!!z?.rulerConfig;await Promise.allSettled([G&&N(v({rulesSourceName:T,...A})),X&&N(y({rulesSourceName:T}))])})),(0,a.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-V})}}function S(W=!1,A={}){return async(N,K)=>{const{promRules:V}=K().unifiedAlerting;(0,p.gR)().map(T=>{(W||!V[T]?.loading)&&N(v({rulesSourceName:T,...A}))})}}const M=(0,t.zD)("unifiedalerting/fetchGrafanaAnnotations",W=>(0,D.$I)(u(W))),O=(0,t.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:W,oldConfig:A,newConfig:N,successMessage:K,redirectPath:V,redirectSearch:T},z)=>(0,D.v5)((0,D.$I)((async()=>{const w=await z.dispatch(c.m.endpoints.getAlertmanagerConfiguration.initiate(W,{forceRefetch:!0})).unwrap(),H=(0,n.isEmpty)(w.alertmanager_config)&&(0,n.isEmpty)(w.template_files),G=JSON.stringify(w)!==JSON.stringify(A);if(!H&&G)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,s.vk)(W,(0,f.MZ)(N)),z.dispatch(c.m.util.invalidateTags(["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"])),V){const X=new URLSearchParams(T??"");r.Ny.push((0,h.nL)(V,W,X))}})()),{successMessage:K})),R=(0,t.zD)("unifiedalerting/fetchFolder",W=>(0,D.$I)(i.IB.getFolderByUid(W,{withAccessControl:!0}))),L=W=>(A,N)=>{N().unifiedAlerting.folders[W]?.dispatched||A(R(W))},B=(0,t.zD)("unifiedalerting/fetchAlertGroups",W=>(0,D.$I)((0,s.f4)(W))),F=(0,t.zD)("unifiedalerting/deleteAlertManagerConfig",async(W,A)=>(0,D.v5)((0,D.$I)((async()=>{await(0,s.nd)(W),await A.dispatch(c.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),I=(0,t.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:W,receivers:A,alert:N})=>(0,D.v5)((0,D.$I)((0,s.By)(W,A,N)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),U=(W,A)=>W.filter(N=>{const{forDuration:K}=(0,C.jg)(N,A),V=K?(0,l.P8)(K):null,T=(0,l.P8)(A);return V?V!==0&&V<T:!1})},15686:(q,j,e)=>{"use strict";e.d(j,{H:()=>n});var t=e(22803);const n=r=>(0,t.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:r.spacing(2,0)})},10148:(q,j,e)=>{"use strict";e.d(j,{W:()=>t});var t=(n=>(n.Incident="grafana-incident-app",n.OnCall="grafana-oncall-app",n.Irm="grafana-irm-app",n.MachineLearning="grafana-ml-app",n.Labels="grafana-labels-app",n.Slo="grafana-slo-app",n))(t||{})},39180:(q,j,e)=>{"use strict";e.d(j,{Z:()=>t});var t=(n=>(n.grafana="grafana-alerting",n.grafanaRecording="grafana-recording",n.cloudAlerting="cloud-alerting",n.cloudRecording="cloud-recording",n))(t||{})},42430:(q,j,e)=>{"use strict";e.d(j,{y:()=>t});var t=(n=>(n.seconds="s",n.minutes="m",n.hours="h",n.days="d",n.weeks="w",n))(t||{})},96621:(q,j,e)=>{"use strict";e.d(j,{C0:()=>m,HL:()=>x,Q9:()=>f,VQ:()=>s,Wd:()=>E,jy:()=>g,lV:()=>o,nU:()=>c,q0:()=>p});var t=e(88023),n=e(61351),r=e(61491),a=e(88214);function i(h){return(0,a.z2)(h)?"grafana":"external"}const x={read:{grafana:r.AccessControlAction.AlertingInstanceRead,external:r.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:r.AccessControlAction.AlertingInstanceCreate,external:r.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:r.AccessControlAction.AlertingInstanceUpdate,external:r.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:r.AccessControlAction.AlertingInstanceUpdate,external:r.AccessControlAction.AlertingInstancesExternalWrite}},s={read:{grafana:r.AccessControlAction.AlertingNotificationsRead,external:r.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:r.AccessControlAction.AlertingNotificationsWrite,external:r.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:r.AccessControlAction.AlertingNotificationsWrite,external:r.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:r.AccessControlAction.AlertingNotificationsWrite,external:r.AccessControlAction.AlertingNotificationsExternalWrite}},c={read:{grafana:r.AccessControlAction.AlertingSilenceRead,external:r.AccessControlAction.AlertingInstanceRead},create:{grafana:r.AccessControlAction.AlertingSilenceCreate,external:r.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:r.AccessControlAction.AlertingSilenceUpdate,external:r.AccessControlAction.AlertingInstancesExternalWrite}},d={read:r.AccessControlAction.AlertingProvisioningRead,readSecrets:r.AccessControlAction.AlertingProvisioningReadSecrets,write:r.AccessControlAction.AlertingProvisioningWrite},u={read:{grafana:r.AccessControlAction.AlertingRuleRead,external:r.AccessControlAction.AlertingRuleExternalRead},create:{grafana:r.AccessControlAction.AlertingRuleCreate,external:r.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:r.AccessControlAction.AlertingRuleUpdate,external:r.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:r.AccessControlAction.AlertingRuleDelete,external:r.AccessControlAction.AlertingRuleExternalWrite}};function g(h){const D=i(h);return{read:x.read[D],create:x.create[D],update:x.update[D],delete:x.delete[D]}}function o(h){const D=i(h);return{read:s.read[D],create:s.create[D],update:s.update[D],delete:s.delete[D],provisioning:d}}function E(h){const D=i(h);return{read:u.read[D],create:u.create[D],update:u.update[D],delete:u.delete[D]}}function m(h){return()=>n.TP.evaluatePermission(h)}function f(){return{canCreateGrafanaRules:n.TP.hasPermission(r.AccessControlAction.FoldersRead)&&n.TP.hasPermission(u.create.grafana),canCreateCloudRules:n.TP.hasPermission(r.AccessControlAction.DataSourcesRead)&&n.TP.hasPermission(u.create.external),canEditRules:h=>n.TP.hasPermission(E(h).update)}}function p(){const{unifiedAlertingEnabled:h}=(0,t.zj)(),D=n.TP.hasPermission(E(a.hY).read),C=n.TP.hasPermission(E(a.hY).update);return h&&D&&C}},1814:(q,j,e)=>{"use strict";e.d(j,{$P:()=>R,$m:()=>u,Av:()=>C,Dm:()=>S,EU:()=>l,LF:()=>b,MN:()=>o,MU:()=>m,MZ:()=>c,NL:()=>D,UL:()=>O,VE:()=>v,Wc:()=>f,_n:()=>d,mP:()=>L,uH:()=>M,xH:()=>h});var t=e(2543),n=e.n(t),r=e(80187),a=e(19165),i=e(88214),x=e(70584),s=e(55936);function c(B){return B.alertmanager_config.receivers||(B.alertmanager_config.receivers=[{name:"default "}]),B.alertmanager_config.route||(B.alertmanager_config.route={receiver:B.alertmanager_config.receivers[0].name}),B.template_files||(B.template_files={}),B}function d(B,F){return{...F,mute_time_intervals:F.mute_time_intervals?.filter(U=>U!==B)??[],active_time_intervals:F.active_time_intervals?.filter(U=>U!==B)??[],routes:F.routes?.map(U=>d(B,U))}}function u(B,F,I){return{...I,mute_time_intervals:I.mute_time_intervals?.map(U=>U===F?B:U),active_time_intervals:I.active_time_intervals?.map(U=>U===F?B:U),routes:I.routes?.map(U=>u(B,F,U))}}function g(B){return B.map(([F,I,U])=>[F,I,unquoteWithUnescape(U)])}function o(B){return B.isEqual?B.isRegex?r.ho.regex:r.ho.equal:B.isRegex?r.ho.notRegex:r.ho.notEqual}function E(B){switch(B){case r.ho.equal:return{isEqual:!0,isRegex:!1};case r.ho.notEqual:return{isEqual:!1,isRegex:!1};case r.ho.regex:return{isEqual:!0,isRegex:!0};case r.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function m(B){return{name:B.name,value:B.value,operator:o(B)}}function f(B){return{name:B.name,value:B.value,...E(B.operator)}}function p(B){return`{ ${B.map(m).reduce((U,W)=>{const A=`${W.name}${W.operator}"${W.value}"`;return U?`${U}, ${A}`:A},"")} }`}const h=[{label:r.ho.equal,description:"Equals",value:r.ho.equal},{label:r.ho.notEqual,description:"Does not equal",value:r.ho.notEqual},{label:r.ho.regex,description:"Matches regex",value:r.ho.regex},{label:r.ho.notRegex,description:"Does not match regex",value:r.ho.notRegex}];function D(B){const F=o(B);return[B.name,F,B.value]}function C(B,F){const I=(0,x.Dd)(B),U=F.map(D);return(0,s.ry)(U,I)}function l(...B){const F=B.map(s.Zc).flat(),I=(0,t.uniqWith)(F,t.isEqual);return p(I)}function v(B){return B===i.hY?"default":"unquote"}function y(){return getAllDataSources().filter(B=>B.type===DataSourceType.Alertmanager)}function P(B){return y().find(F=>B===F.uid)}function b(B){const{times:F,weekdays:I,days_of_month:U,months:W,years:A,location:N}=B,K=S(F,N),V=M(I),T=O(U),z=R(W),w=L(A);return[K,V,T,z,w].join(", ")}function S(B,F){return"Times: "+(B?B?.map(({start_time:I,end_time:U})=>`${I} - ${U} [${F??"UTC"}]`).join(" and "):"All")}function M(B){return"Weekdays: "+(B?.map(F=>{if(F.includes(":"))return F.split(":").map(I=>{const U=I.slice(0,3);return U[0].toLocaleUpperCase()+U.slice(1)}).join("-");{const I=F.slice(0,3);return I[0].toLocaleUpperCase()+I.slice(1)}}).join(", ")??"All")}function O(B){return"Days of the month: "+(B?.join(", ")??"All")}function R(B){return"Months: "+(B?.join(", ")??"All")}function L(B){return"Years: "+(B?.join(", ")??"All")}},12444:(q,j,e)=>{"use strict";e.d(j,{DY:()=>y,Mk:()=>h,QM:()=>m,Rg:()=>u,SJ:()=>p,YE:()=>f,Yl:()=>o,gY:()=>D,hH:()=>l,ie:()=>C});var t=e(80187),n=e(1814),r=e(88214),a=e(55936),i=e(27174),x=e(32266);const s=(P,b)=>Object.entries(P??{}).reduce((S,[M,O])=>[...S,{name:M,value:O,operator:b?t.ho.regex:t.ho.equal}],[]),c=P=>P.value,d=P=>(P??[]).map(c),u={name:"",value:"",operator:t.ho.equal},g=["grafana_folder","alertname"],o=[{label:"grafana_folder",value:"grafana_folder",isFixed:!0},{label:"alertname",value:"alertname",isFixed:!0},{label:"Disable (...)",value:"..."}],E={id:"",overrideGrouping:!1,groupBy:g,object_matchers:[],routes:[],continue:!1,receiver:"",overrideTimings:!1,groupWaitValue:"",groupIntervalValue:"",repeatIntervalValue:"",muteTimeIntervals:[]};function m(P,b="0"){const S=(0,i.KR)(P),M=P.routes??[];return{id:`${b}-${S}`,...P,routes:M.map((O,R)=>m(O,`${b}-${R}`))}}const f=P=>{if(!P)return E;const b=P.id;if(Object.keys(P).length===0)return{...E,id:b};const S=[];P.routes?.forEach(R=>{const L=f(R);S.push(L)});const M=P.object_matchers?.map(R=>({name:R[0],operator:R[1],value:R[2]}))??[],O=P.matchers?.flatMap(R=>(0,a.So)(R).flatMap(n.MU)).map(({name:R,operator:L,value:B})=>({name:(0,a.Ig)(R),operator:L,value:(0,a.Ig)(B)}))??[];return{id:b,object_matchers:[...O,...M,...s(P.match,!1),...s(P.match_re,!0)],continue:P.continue??!1,receiver:P.receiver??"",overrideGrouping:Array.isArray(P.group_by)&&P.group_by.length>0,groupBy:P.group_by??void 0,overrideTimings:[P.group_wait,P.group_interval,P.repeat_interval].some(Boolean),groupWaitValue:P.group_wait??"",groupIntervalValue:P.group_interval??"",repeatIntervalValue:P.repeat_interval??"",routes:S,muteTimeIntervals:P.mute_time_intervals??[]}},p=(P,b,S)=>{const M=(0,i.eM)(b.id??"",S),{overrideGrouping:O,groupBy:R,overrideTimings:L,groupWaitValue:B,groupIntervalValue:F,repeatIntervalValue:I,receiver:U}=b,W=void 0,A=O?R:W,K=L&&B?B:W,T=L&&F?F:W,w=L&&I?I:W,H=b.object_matchers?.filter(k=>k.name&&k.operator&&k.value!==null&&k.value!==void 0).map(({name:k,operator:_,value:ee})=>[k,_,ee]),G=b.routes?.map(k=>p(P,k,S)),X={...M??{},continue:b.continue,group_by:A,object_matchers:H,match:void 0,match_re:void 0,group_wait:K,group_interval:T,repeat_interval:w,routes:G,mute_time_intervals:b.muteTimeIntervals,receiver:U};return P!==r.hY?(X.matchers=b.object_matchers?.map(a.b2),X.object_matchers=void 0):(X.object_matchers=(0,a.J$)(X),X.matchers=void 0),b.receiver&&(X.receiver=b.receiver),X},h=P=>({label:P,value:P}),D=P=>(P??[]).map(h),C=P=>P?d(P):[];function l(P){return!P||P.length===0?!0:(0,x.TN)(P)||"Invalid duration format. Must be {number}{time_unit}"}const v=P=>P.map(b=>{const[S,M,O]=b;return`${S}${M}${O}`}),y=(P,b="")=>{if(P.length===0)return!0;const S=l(P),M=l(b);if(S!==!0)return S;if(M!==!0)return M;const O=(0,x.P8)(P),R=(0,x.P8)(b);return R!==0&&O<R?"Repeat interval should be higher or equal to Group interval":!0}},44307:(q,j,e)=>{"use strict";e.d(j,{Hx:()=>i,gO:()=>x});var t=e(96540),n=e(83466),r=e(85651);function a(s){return{dashboardUID:s.find(([c])=>c===n.YH.dashboardUID)?.[1],panelId:s.find(([c])=>c===n.YH.panelID)?.[1]}}function i(s){return(0,t.useMemo)(()=>Object.entries(s||{}).filter(([c,d])=>!!d.trim()),[s])}function x(s){const c=new Map,{panelId:d,dashboardUID:u}=a(s);return u&&c.set(n.YH.dashboardUID,(0,r.JM)(u)),u&&d&&c.set(n.YH.panelID,(0,r.D2)(u,d)),c}},2473:(q,j,e)=>{"use strict";e.d(j,{U:()=>d,r:()=>c});var t=e(32370),n=e(40113);const r=(0,n.u)("basic_auth","Basic auth","Sets the `Authorization` header with the configured username and password. Password and password_file are mutually exclusive.",{element:"subform",subformOptions:[(0,n.u)("username","Username",""),(0,n.u)("password","Password",""),(0,n.u)("password_file","Password file","")]}),a=(0,n.u)("tls_config","TLS config","Configures the TLS settings.",{element:"subform",subformOptions:[(0,n.u)("ca_file","CA file","CA certificate to validate the server certificate with."),(0,n.u)("cert_file","Cert file","Certificate for client cert authentication to the server."),(0,n.u)("key_file","Key file","Key file for client cert authentication to the server."),(0,n.u)("server_name","Server name","ServerName extension to indicate the name of the server."),(0,n.u)("insecure_skip_verify","Skip verify","Disable validation of the server certificate.",{element:"checkbox"})]}),i=(0,n.u)("oauth2","OAuth2","Configures the OAuth2 settings.",{element:"subform",subformOptions:[(0,n.u)("client_id","Client ID","The OAuth2 client ID",{required:!0}),(0,n.u)("client_secret","Client secret","The OAuth2 client secret",{required:!0}),(0,n.u)("token_url","Token URL","The OAuth2 token exchange URL",{required:!0}),(0,n.u)("scopes","Scopes","Comma-separated list of scopes",{element:"string_array"}),(0,n.u)("endpoint_params","Additional parameters","",{element:"key_value_map"})]}),x=(0,n.u)("http_config","HTTP Config","Note that `basic_auth`, `bearer_token` and `bearer_token_file` options are mutually exclusive.",{element:"subform",subformOptions:[(0,n.u)("bearer_token","Bearer token","Sets the `Authorization` header with the configured bearer token."),(0,n.u)("bearer_token_file","Bearer token file","Sets the `Authorization` header with the bearer token read from the configured file."),(0,n.u)("proxy_url","Proxy URL","Optional proxy URL."),r,a,i]}),s={name:"Jira",description:"Send notifications to Jira Service Management",type:"jira",info:"",heading:"Jira settings",options:[(0,n.u)("api_url","API URL","The host to send Jira API requests to",{required:!0}),(0,n.u)("project","Project Key","The project key where issues are created",{required:!0}),(0,n.u)("summary","Summary","Issue summary template",{placeholder:'{{ template "jira.default.summary" . }}'}),(0,n.u)("description","Description","Issue description template",{placeholder:'{{ template "jira.default.description" . }}'}),(0,n.u)("labels","Labels"," Labels to be added to the issue",{element:"string_array"}),(0,n.u)("priority","Priority","Priority of the issue",{placeholder:'{{ template "jira.default.priority" . }}'}),(0,n.u)("issue_type","Issue Type","Type of the issue (e.g. Bug)",{required:!0}),(0,n.u)("reopen_transition","Reopen transition",'Name of the workflow transition to reopen an issue. The target status should not have the category "done"'),(0,n.u)("resolve_transition","Resolve transition",'Name of the workflow transition to resolve an issue. The target status must have the category "done"'),(0,n.u)("wont_fix_resolution","Won't fix resolution",'If "Reopen transition" is defined, ignore issues with that resolution'),(0,n.u)("reopen_duration","Reopen duration",'If "Reopen transition" is defined, reopen the issue when it is not older than this value (rounded down to the nearest minute)',{placeholder:"Use duration format, for example: 1.2s, 100ms"}),(0,n.u)("fields","Fields","Other issue and custom fields",{element:"key_value_map"}),x]},c=[{name:"Email",description:"Send notification over SMTP",type:"email",info:"",heading:"Email settings",options:[(0,n.u)("to","To",'The email address to send notifications to. You can enter multiple addresses using a "," separator',{required:!0}),(0,n.u)("from","From","The sender address."),(0,n.u)("smarthost","SMTP host","The SMTP host through which emails are sent."),(0,n.u)("hello","Hello","The hostname to identify to the SMTP server."),(0,n.u)("auth_username","Username","SMTP authentication information"),(0,n.u)("auth_password","Password","SMTP authentication information"),(0,n.u)("auth_secret","Secret","SMTP authentication information"),(0,n.u)("auth_identity","Identity","SMTP authentication information"),(0,n.u)("require_tls","Require TLS","The SMTP TLS requirement",{element:"checkbox"}),(0,n.u)("html","Email HTML body","The HTML body of the email notification.",{placeholder:'{{ template "email.default.html" . }}',element:"textarea"}),(0,n.u)("text","Email text body","The text body of the email notification.",{element:"textarea"}),(0,n.u)("headers","Headers","Further headers email header key/value pairs. Overrides any headers previously set by the notification implementation.",{element:"key_value_map"}),a]},{name:"PagerDuty",description:"Send notifications to PagerDuty",type:"pagerduty",info:"",heading:"PagerDuty settings",options:[(0,n.u)("routing_key","Routing key","The PagerDuty integration key (when using PagerDuty integration type `Events API v2`)"),(0,n.u)("service_key","Service key","The PagerDuty integration key (when using PagerDuty integration type `Prometheus`)."),(0,n.u)("url","URL","The URL to send API requests to"),(0,n.u)("client","Client","The client identification of the Alertmanager.",{placeholder:'{{ template "pagerduty.default.client" . }}'}),(0,n.u)("client_url","Client URL","A backlink to the sender of the notification.",{placeholder:'{{ template "pagerduty.default.clientURL" . }}'}),(0,n.u)("description","Description","A description of the incident.",{placeholder:'{{ template "pagerduty.default.description" .}}'}),(0,n.u)("severity","Severity","Severity of the incident.",{placeholder:"error"}),(0,n.u)("details","Details","A set of arbitrary key/value pairs that provide further detail about the incident.",{element:"key_value_map"}),(0,n.u)("images","Images","Images to attach to the incident.",{element:"subform_array",subformOptions:[(0,n.u)("href","URL","",{required:!0}),(0,n.u)("source","Source","",{required:!0}),(0,n.u)("alt","Alt","",{required:!0})]}),(0,n.u)("links","Links","Links to attach to the incident.",{element:"subform_array",subformOptions:[(0,n.u)("href","URL","",{required:!0}),(0,n.u)("text","Text","",{required:!0})]}),x]},{name:"Pushover",description:"Send notifications to Pushover",type:"pushover",info:"",heading:"Pushover settings",options:[(0,n.u)("user_key","User key","The recipient user\u2019s user key.",{required:!0}),(0,n.u)("token","Token","Your registered application\u2019s API token, see https://pushover.net/app",{required:!0}),(0,n.u)("title","Title","Notification title.",{placeholder:'{{ template "pushover.default.title" . }}'}),(0,n.u)("message","Message","Notification message.",{placeholder:'{{ template "pushover.default.message" . }}'}),(0,n.u)("url","URL","A supplementary URL shown alongside the message.",{placeholder:'{{ template "pushover.default.url" . }}'}),(0,n.u)("priority","Priority","Priority, see https://pushover.net/api#priority",{placeholder:'{{ if eq .Status "firing" }}2{{ else }}0{{ end }}'}),(0,n.u)("retry","Retry","How often the Pushover servers will send the same notification to the user. Must be at least 30 seconds.",{placeholder:"1m"}),(0,n.u)("expire","Expire","How long your notification will continue to be retried for, unless the user acknowledges the notification.",{placeholder:"1h"}),(0,n.u)("ttl","TTL","The number of seconds before a message expires and is deleted automatically. Examples: 10s, 5m30s, 8h.",{validationRule:"^(\\d+[s|m|h])+$|^$",element:"input"}),x]},{name:"Slack",description:"Send notifications to Slack",type:"slack",info:"",heading:"Slack settings",options:[(0,n.u)("api_url","Webhook URL","The Slack webhook URL."),(0,n.u)("channel","Channel","The #channel or @user to send notifications to.",{required:!0}),(0,n.u)("icon_emoji","Emoji icon",""),(0,n.u)("icon_url","Icon URL",""),(0,n.u)("link_names","Names link","",{element:"checkbox"}),(0,n.u)("username","Username","",{placeholder:'{{ template "slack.default.username" . }}'}),(0,n.u)("callback_id","Callback ID","",{placeholder:'{{ template "slack.default.callbackid" . }}'}),(0,n.u)("color","Color","",{placeholder:'{{ if eq .Status "firing" }}danger{{ else }}good{{ end }}'}),(0,n.u)("fallback","Fallback","",{placeholder:'{{ template "slack.default.fallback" . }}'}),(0,n.u)("footer","Footer","",{placeholder:'{{ template "slack.default.footer" . }}'}),(0,n.u)("mrkdwn_in","Mrkdwn fields","An array of field names that should be formatted by mrkdwn syntax.",{element:"string_array"}),(0,n.u)("pretext","Pre-text","",{placeholder:'{{ template "slack.default.pretext" . }}'}),(0,n.u)("short_fields","Short fields","",{element:"checkbox"}),(0,n.u)("text","Message body","",{element:"textarea",placeholder:'{{ template "slack.default.text" . }}'}),(0,n.u)("title","Title","",{placeholder:'{{ template "slack.default.title" . }}'}),(0,n.u)("title_link","Title link","",{placeholder:'{{ template "slack.default.titlelink" . }}'}),(0,n.u)("image_url","Image URL",""),(0,n.u)("thumb_url","Thumbnail URL",""),(0,n.u)("actions","Actions","",{element:"subform_array",subformOptions:[(0,n.u)("text","Text","",{required:!0}),(0,n.u)("type","Type","",{required:!0}),(0,n.u)("url","URL","Either url or name and value are mandatory."),(0,n.u)("name","Name",""),(0,n.u)("value","Value",""),(0,n.u)("confirm","Confirm","",{element:"subform",subformOptions:[(0,n.u)("text","Text","",{required:!0}),(0,n.u)("dismiss_text","Dismiss text",""),(0,n.u)("ok_text","OK text",""),(0,n.u)("title","Title","")]}),(0,n.u)("style","Style","")]}),(0,n.u)("fields","Fields","",{element:"subform_array",subformOptions:[(0,n.u)("title","Title","",{required:!0}),(0,n.u)("value","Value","",{required:!0}),(0,n.u)("short","Short","",{element:"checkbox"})]}),x]},...t.$.featureToggles?.alertingJiraIntegration?[s]:[],{name:"OpsGenie",description:"Send notifications to OpsGenie",type:"opsgenie",info:"",heading:"OpsGenie settings",options:[(0,n.u)("api_key","API key","The API key to use when talking to the OpsGenie API."),(0,n.u)("api_url","API URL","The host to send OpsGenie API requests to."),(0,n.u)("message","Message","Alert text limited to 130 characters."),(0,n.u)("description","Description","A description of the incident.",{placeholder:'{{ template "opsgenie.default.description" . }}'}),(0,n.u)("source","Source","A backlink to the sender of the notification.",{placeholder:'{{ template "opsgenie.default.source" . }}'}),(0,n.u)("details","Details","A set of arbitrary key/value pairs that provide further detail about the incident.",{element:"key_value_map"}),(0,n.u)("tags","Tags","Comma separated list of tags attached to the notifications."),(0,n.u)("note","Note","Additional alert note."),(0,n.u)("priority","Priority","Priority level of alert. Possible values are P1, P2, P3, P4, and P5."),(0,n.u)("responders","Responders","List of responders responsible for notifications.",{element:"subform_array",subformOptions:[(0,n.u)("type","Type",'"team", "user", "escalation" or schedule".',{required:!0}),(0,n.u)("id","ID","Exactly one of these fields should be defined."),(0,n.u)("name","Name","Exactly one of these fields should be defined."),(0,n.u)("username","Username","Exactly one of these fields should be defined.")]}),x]},{name:"VictorOps",description:"Send notifications to VictorOps",type:"victorops",info:"",heading:"VictorOps settings",options:[(0,n.u)("api_key","API key","The API key to use when talking to the VictorOps API."),(0,n.u)("api_url","API URL","The VictorOps API URL."),(0,n.u)("routing_key","Routing key","A key used to map the alert to a team.",{required:!0}),(0,n.u)("message_type","Message type","Describes the behavior of the alert (CRITICAL, WARNING, INFO)."),(0,n.u)("entity_display_name","Entity display name","Contains summary of the alerted problem.",{placeholder:'{{ template "victorops.default.entity_display_name" . }}'}),(0,n.u)("state_message","State message","Contains long explanation of the alerted problem.",{placeholder:'{{ template "victorops.default.state_message" . }}'}),(0,n.u)("monitoring_tool","Monitoring tool","The monitoring tool the state message is from.",{placeholder:'{{ template "victorops.default.monitoring_tool" . }}'}),x]},{name:"Webhook",description:"Send notifications to a webhook",type:"webhook",info:"",heading:"Webhook settings",options:[(0,n.u)("url","URL","The endpoint to send HTTP POST requests to.",{required:!0}),(0,n.u)("max_alerts","Max alerts","The maximum number of alerts to include in a single webhook message. Alerts above this threshold are truncated. When leaving this at its default value of 0, all alerts are included.",{placeholder:"0",inputType:"number",validationRule:"(^\\d+$|^$)",setValueAs:u=>{const g=Number(u);return Number.isFinite(g)?g:0}}),x]},{name:"Discord",description:"Sends notifications to Discord",type:"discord",info:"",heading:"Discord settings",options:[(0,n.u)("title","Title","Templated title of the message",{placeholder:'{{ template "discord.default.title" . }}'}),(0,n.u)("message","Message Content","Mention a group using @ or a user using <@ID> when notifying in a channel",{placeholder:'{{ template "discord.default.message" . }}'}),(0,n.u)("webhook_url","Webhook URL","",{placeholder:"Discord webhook URL",required:!0}),x]},{name:"Cisco Webex Teams",description:"Sends notifications to Cisco Webex Teams",type:"webex",info:"",heading:"Cisco Webex Teams settings",options:[(0,n.u)("api_url","API URL","The Webex Teams API URL",{placeholder:"https://webexapis.com/v1/messages"}),(0,n.u)("room_id","Room ID","ID of the Webex Teams room where to send the messages",{required:!0}),(0,n.u)("message","Message","Message template",{placeholder:'{{ template "webex.default.message" .}}'}),{...x,required:!0}]},{name:"Telegram",description:"Sends notifications to Telegram",type:"telegram",info:"",heading:"Telegram settings",options:[(0,n.u)("api_url","API URL","The Telegram API URL",{placeholder:"https://api.telegram.org"}),(0,n.u)("bot_token","Bot token","Telegram bot token",{required:!0}),(0,n.u)("chat_id","Chat ID","ID of the chat where to send the messages",{required:!0,setValueAs:u=>typeof u=="string"?parseInt(u,10):u}),(0,n.u)("message","Message","Message template",{placeholder:'{{ template "webex.default.message" .}}'}),(0,n.u)("disable_notifications","Disable notifications","Disable telegram notifications",{element:"checkbox"}),(0,n.u)("parse_mode","Parse mode","Parse mode for telegram message",{element:"select",defaultValue:{label:"None",value:""},selectOptions:[{label:"None",value:""},{label:"MarkdownV2",value:"MarkdownV2"},{label:"Markdown",value:"Markdown"},{label:"HTML",value:"HTML"}]}),x]},{name:"Amazon SNS",description:"Sends notifications to Amazon SNS",type:"sns",info:"",heading:"Amazon SNS settings",options:[(0,n.u)("api_url","API URL","The Amazon SNS API URL"),(0,n.u)("sigv4","SigV4 authentication","Configures AWS's Signature Verification 4 signing process to sign requests",{element:"subform",subformOptions:[(0,n.u)("region","Region","The AWS region. If blank, the region from the default credentials chain is used"),(0,n.u)("access_key","Access key",'The AWS API access_key. If blank the environment variable "AWS_ACCESS_KEY_ID" is used'),(0,n.u)("secret_key","Secret key",'The AWS API secret_key. If blank the environment variable "AWS_ACCESS_SECRET_ID" is used'),(0,n.u)("profile","Profile","Named AWS profile used to authenticate"),(0,n.u)("role_arn","Role ARN","AWS Role ARN, an alternative to using AWS API keys")]}),(0,n.u)("topic_arn","SNS topic ARN","If you don't specify this value, you must specify a value for the phone_number or target_arn. If you are using a FIFO SNS topic you should set a message group interval longer than 5 minutes to prevent messages with the same group key being deduplicated by the SNS default deduplication window"),(0,n.u)("phone_number","Phone number","Phone number if message is delivered via SMS in E.164 format. If you don't specify this value, you must specify a value for the topic_arn or target_arn"),(0,n.u)("target_arn","Target ARN","The  mobile platform endpoint ARN if message is delivered via mobile notifications. If you don't specify this value, you must specify a value for the topic_arn or phone_number"),(0,n.u)("subject","Subject","Subject line when the message is delivered",{placeholder:'{{ template "sns.default.subject" .}}'}),(0,n.u)("message","Message","The message content of the SNS notification",{placeholder:'{{ template "sns.default.message" .}}'}),(0,n.u)("attributes","Attributes","SNS message attributes",{element:"key_value_map"}),x]},{name:"WeChat",description:"Sends notifications to WeChat",type:"wechat",info:"",heading:"WeChat settings",options:[(0,n.u)("api_url","API URL","The WeChat API URL"),(0,n.u)("api_secret","API Secret","The API key to use when talking to the WeChat API"),(0,n.u)("corp_id","Corp ID","The corp id for authentication"),(0,n.u)("message","Message","API request data as defined by the WeChat API",{placeholder:'{{ template "wechat.default.message" . }}'}),(0,n.u)("message_type","Message type","Type of the message type",{element:"select",defaultValue:{label:"Text",value:"text"},selectOptions:[{label:"Text",value:"text"},{label:"Markdown",value:"markdown"}]}),(0,n.u)("agent_id","Agent ID","",{placeholder:'{{ template "wechat.default.agent_id" . }}'}),(0,n.u)("to_user","to user","",{placeholder:'{{ template "wechat.default.to_user" . }}'}),(0,n.u)("to_party","to party","",{placeholder:'{{ template "wechat.default.to_party" . }}'}),(0,n.u)("to_tag","to tag","",{placeholder:'{{ template "wechat.default.to_tag" . }}'})]},{name:"Microsoft Teams",description:"Sends notifications to Microsoft Teams",type:"msteams",info:"",heading:"Microsoft Teams settings",options:[(0,n.u)("webhook_url","Webhook URL","The incoming webhook URL."),(0,n.u)("title","Title","Message title template.",{placeholder:'{{ template "teams.default.title" . }}'}),(0,n.u)("text","Text","Message body template.",{placeholder:'{{ template "teams.default.text" . }}'})]}],d=[(0,n.u)("smtp_from","SMTP from","The default SMTP From header field."),(0,n.u)("smtp_smarthost","SMTP smarthost","The default SMTP smarthost used for sending emails, including port number. Port number usually is 25, or 587 for SMTP over TLS (sometimes referred to as STARTTLS). Example: smtp.example.org:587"),(0,n.u)("smtp_hello","SMTP hello","The default hostname to identify to the SMTP server.",{placeholder:"localhost"}),(0,n.u)("smtp_auth_username","SMTP auth username","SMTP Auth using CRAM-MD5, LOGIN and PLAIN. If empty, Alertmanager doesn't authenticate to the SMTP server."),(0,n.u)("smtp_auth_password","SMTP auth password","SMTP Auth using LOGIN and PLAIN."),(0,n.u)("smtp_auth_identity","SMTP auth identity","SMTP Auth using PLAIN."),(0,n.u)("smtp_auth_secret","SMTP auth secret","SMTP Auth using CRAM-MD5."),(0,n.u)("smtp_require_tls","SMTP require TLS","The default SMTP TLS requirement. Note that Go does not support unencrypted connections to remote SMTP endpoints.",{element:"checkbox"}),(0,n.u)("slack_api_url","Slack API URL",""),(0,n.u)("victorops_api_key","VictorOps API key",""),(0,n.u)("victorops_api_url","VictorOps API URL","",{placeholder:"https://alert.victorops.com/integrations/generic/20131114/alert/"}),(0,n.u)("pagerduty_url","PagerDuty URL","https://events.pagerduty.com/v2/enqueue"),(0,n.u)("opsgenie_api_key","OpsGenie API key",""),(0,n.u)("opsgenie_api_url","OpsGenie API URL","",{placeholder:"https://api.opsgenie.com/"}),(0,n.u)("wechat_api_url","WeChat API URL","",{placeholder:"https://qyapi.weixin.qq.com/cgi-bin/"}),(0,n.u)("wechat_api_secret","WeChat API secret",""),(0,n.u)("wechat_api_corp_id","WeChat API corp id",""),(0,n.u)("webex_api_url","Cisco Webex Teams API URL",""),(0,n.u)("telegram_api_url","The Telegram API URL",""),x,(0,n.u)("resolve_timeout","Resolve timeout","ResolveTimeout is the default value used by alertmanager if the alert does not include EndsAt, after this time passes it can declare the alert as resolved if it has not been updated. This has no impact on alerts from Prometheus, as they always include EndsAt.",{placeholder:"5m"})]},19165:(q,j,e)=>{"use strict";e.d(j,{BO:()=>c,Wx:()=>s,ZP:()=>x,k7:()=>a,qf:()=>i});var t=e(32370),n=e(10148),r=e(32266);function a(){return Object.values(t.$.datasources)}function i(d){if(!(0,r.TN)(t.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const u=(0,r.P8)(t.$.unifiedAlerting.minInterval);if(!d||!(0,r.TN)(d))return{globalLimit:u,exceedsLimit:!1};const g=(0,r.P8)(d),o=u>g&&g>0;return{globalLimit:u,exceedsLimit:o}}function x(){return n.W.Irm in t.$.apps}function s(){return x()?n.W.Irm:n.W.Incident}function c(){return x()?n.W.Irm:n.W.OnCall}},83466:(q,j,e)=>{"use strict";e.d(j,{DD:()=>r,H8:()=>E,HH:()=>n,J3:()=>o,Oq:()=>a,U3:()=>x,UU:()=>t,YH:()=>g,cB:()=>s,kW:()=>f,kl:()=>m,wG:()=>i});const t="ruler not supported",n=3e4,r="alertmanager",a="alerting-alertmanager",i=2e4,x=2e4,s=2e4,c="timeseries",d="table",u="stat";var g=(p=>(p.description="description",p.summary="summary",p.runbookURL="runbook_url",p.alertId="__alertId__",p.dashboardUID="__dashboardUid__",p.panelID="__panelId__",p))(g||{});const o={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},E={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},m=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],f="__alert_rule_uid__"},88214:(q,j,e)=>{"use strict";e.d(j,{AL:()=>z,EV:()=>K,Eb:()=>T,Iz:()=>Z,TG:()=>A,Zw:()=>_,bD:()=>M,cy:()=>F,gR:()=>W,hP:()=>re,hY:()=>f,iV:()=>R,k5:()=>te,lS:()=>N,of:()=>P,oh:()=>G,ol:()=>D,qi:()=>l,r3:()=>k,r6:()=>h,sq:()=>I,v0:()=>V,vv:()=>p,w5:()=>J,y9:()=>ae,yc:()=>w,z2:()=>H});var t=e(98437),n=e(61351),r=e(60088),a=e(82945),i=e(80187),x=e(61491),s=e(35004),c=e(9365),d=e(91495),u=e(90666),g=e(82236),o=e(13005),E=e(96621),m=e(19165);const f="grafana",p="-- Grafana --",h={uid:s.l$,name:f,ruleSourceType:"grafana"};var D=(ne=>(ne.Alertmanager="alertmanager",ne.Loki="loki",ne.Prometheus="prometheus",ne))(D||{});const C=["loki","prometheus"];function l(){const ne=n.TP.hasPermission(x.AccessControlAction.AlertingRuleExternalRead),ce=n.TP.hasPermission(x.AccessControlAction.AlertingRuleExternalWrite);return!ne&&!ce?[]:(0,m.k7)().filter(le=>C.includes(le.type)).filter(le=>re(le)).sort((le,he)=>le.name.localeCompare(he.name))}function v(ne){return H(ne)?"grafana":ne.uid??ne.id}function y(ne){return l().find(ce=>ce.name===ne)}function P(ne){return l().find(ce=>ce.uid===ne)}function b(){return(0,m.k7)().filter(S).sort((ne,ce)=>ne.name.localeCompare(ce.name))}function S(ne){return ne.type==="alertmanager"}function M(ne){return ne.type==="alertmanager"}function O(){return b().filter(ne=>ne.jsonData.handleGrafanaManagedAlerts)}function R(ne){return ne.jsonData.handleGrafanaManagedAlerts===!0}const L={name:f,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function B(){return[L,...b().map(ne=>({name:ne.name,displayName:ne.name,imgUrl:ne.meta.info.logos.small,meta:ne.meta}))]}function F(ne){const ce=(0,g.W)(ne),le=ce.availableExternalDataSources.filter(me=>me.handleGrafanaManagedAlerts),he=ce.availableInternalDataSources,{currentData:oe}=c.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(oe?.alertmanagersChoice){case i.nA.Internal:return he;case i.nA.External:return le;default:return[...he,...le]}}function I(ne){const ce=[],le=[],he={instance:E.HL.read,notification:E.VQ.read,silence:E.nU.read};if([...Object.values(he).flatMap(me=>me.grafana),...d.w6,...a.Im,...u.X,...r.GK].some(me=>n.TP.hasPermission(me))&&ce.push(L),n.TP.hasPermission(he[ne].external)){const me=b().map(Pe=>({name:Pe.name,displayName:Pe.name,imgUrl:Pe.meta.info.logos.small,meta:Pe.meta,hasConfigurationAPI:(0,o.Kh)(Pe.jsonData),handleGrafanaManagedAlerts:Pe.jsonData.handleGrafanaManagedAlerts}));le.push(...me)}return{availableInternalDataSources:ce,availableExternalDataSources:le}}function U(ne){const ce=G(ne);if(!ce)throw new Error(`Data source ${ne} not found`);if(ce.type!=="loki"&&ce.type!=="prometheus")throw new Error(`Unexpected data source type ${ce.type}`);return ce}function W(){const ne=l().map(ce=>ce.name);return n.TP.hasPermission(x.AccessControlAction.AlertingRuleRead)&&ne.push(f),ne}function A(){return l().map(ne=>({name:ne.name,uid:ne.uid,ruleSourceType:"datasource"}))}function N(){const ne=l();return n.TP.hasPermission(x.AccessControlAction.AlertingRuleRead)&&ne.unshift(f),ne}function K(ne){return T(ne)?ne.name:ne}function V(ne){return T(ne)?ne.uid:f}function T(ne){return ne!==f}function z(ne){return ne!==f&&k(ne)?.jsonData?.implementation===i.Oz.prometheus}function w(ne){return ne.readOnly===!0}function H(ne){return ne===f}function G(ne){return(0,m.k7)().find(ce=>ce.name===ne)}function X(ne){return getAllDataSources().find(ce=>ce.uid===ne)}function k(ne){return(0,m.k7)().filter(S).find(ce=>ce.name===ne)}function _(ne){return ne===f?f:G(ne)}function ee(ne){if(ne===f)return f;const ce=G(ne);if(!ce)throw new Error(`Datasource "${ne}" not found`);return String(ce.id)}function J(ne){if(ne===f)return f;const ce=G(ne);if(!ce)throw new Error(`Datasource "${ne}" not found`);return ce.uid}function Z(ne){if("uid"in ne)return ne.uid;if(ne.rulesSourceName===f)return s.l$;const ce=y(ne.rulesSourceName);if(ce)return ce.uid}function te(){return(0,t.l)().getList({alerting:!0})[0]}function ae(){const ne=(0,t.l)().getInstanceSettings("default");return ne?.meta.alerting??!1?ne:te()}function re(ne){return ne.jsonData.manageAlerts!==!1}},65456:(q,j,e)=>{"use strict";e.d(j,{h:()=>a});var t=e(2543),n=e.n(t),r=e(91354);function a(i,x,s=t.identity){const c=s(i),d=s(x),u=(0,r.G4)(c,d),g=(0,t.chain)(u).values().flatMap().filter(E=>E.op==="add"||E.op==="replace"||E.op==="move").sumBy(E=>E.endLineNumber-E.startLineNumber+1).value(),o=(0,t.chain)(u).values().flatMap().filter(E=>E.op==="remove"||E.op==="replace").sumBy(E=>E.endLineNumber-E.startLineNumber+1).value();return{added:g,removed:o}}},98775:(q,j,e)=>{"use strict";e.d(j,{HA:()=>x,Rc:()=>i,rO:()=>a});var t=e(88214),n=e(82700);function r(s){if((0,n.lT)(s.rulerRule)&&(0,t.z2)(s.namespace.rulesSource))return{namespace:{uid:s.rulerRule.grafana_alert.namespace_uid},groupName:s.group.name,groupOrigin:"grafana"};const c=(0,t.EV)(s.namespace.rulesSource);return{rulesSource:{uid:(0,t.w5)(c),name:c,ruleSourceType:"datasource"},namespace:{name:s.namespace.name},groupName:s.group.name,groupOrigin:"datasource"}}function a(s){return s.groupOrigin==="grafana"?t.hY:s.rulesSource.name}function i(s){return{dataSourceName:a(s),namespaceName:"uid"in s.namespace?s.namespace.uid:s.namespace.name,groupName:s.groupName}}const x={fromCombinedRule:r}},18269:(q,j,e)=>{"use strict";e.d(j,{DM:()=>a,T:()=>r,a3:()=>t,rh:()=>n});const t="grafana.com/provenance",n="none";var r=(i=>(i.Provenance="grafana.com/provenance",i.InUseRoutes="grafana.com/inUse/routes",i.InUseRules="grafana.com/inUse/rules",i.AccessWrite="grafana.com/access/canWrite",i.AccessAdmin="grafana.com/access/canAdmin",i.AccessDelete="grafana.com/access/canDelete",i))(r||{});const a="user-defined"},16361:(q,j,e)=>{"use strict";e.d(j,{g2:()=>i,j2:()=>x,jX:()=>s});var t=e(2543),n=e.n(t),r=e(28082),a=e(11817);const i="alerting.notifications.conflict";function x(c){return{[i]:(0,a.t)("alerting.policies.update-errors.conflict","The notification policy tree has been updated by another user.")}[c]}function s(c){return(0,r.NF)(c)&&(0,t.get)(c.data,"kind")==="Status"&&(0,t.get)(c.data,"status")==="Failure"}},13693:(q,j,e)=>{"use strict";e.d(j,{Au:()=>c,O:()=>g,Uo:()=>i,dM:()=>a,gw:()=>s,jw:()=>d,zl:()=>u});var t=e(32370),n=e(88214),r=e(18269);const a=o=>t.$.featureToggles.alertingApiServer&&o===n.hY,i=o=>{const E=s(o,r.T.Provenance);return!!(E&&E!==r.rh)},x="grafana.com/access/",s=(o,E)=>o.metadata?.annotations?.[E],c=o=>s(o,r.T.AccessWrite)==="true",d=o=>s(o,r.T.AccessAdmin)==="true",u=o=>s(o,r.T.AccessDelete)==="true",g=o=>o.replaceAll(/\\/g,"\\\\").replaceAll(/\=/g,"\\=").replaceAll(/,/g,"\\,")},70584:(q,j,e)=>{"use strict";e.d(j,{Dd:()=>a,F2:()=>d,M4:()=>r,lL:()=>s,rm:()=>c,w0:()=>u,x4:()=>x,zm:()=>i});var t=e(2543),n=e.n(t);function r(g){return Object.entries(g).map(([o,E])=>`${o}=${E}`).sort()}function a(g){return Object.entries(g)}function i(g){const o={};return g.forEach(E=>{o[E[0]]=E[1]}),o}function x(g){const o={};return g.forEach(E=>{E.key&&(o[E.key]=E.value)}),o}const s="__grafana_origin";function c(g){return(0,t.isEmpty)(g)?0:Object.keys(g).filter(o=>!d(o)).length}function d(g){return g.startsWith("__")&&g.endsWith("__")||g===s}const u=([g,o])=>d(g)},55936:(q,j,e)=>{"use strict";e.d(j,{Ig:()=>l,J$:()=>m,J9:()=>E,S6:()=>u,So:()=>c,Zc:()=>g,b2:()=>C,ou:()=>o,qR:()=>s,ry:()=>S,t8:()=>v,yk:()=>D});var t=e(2543),n=e.n(t),r=e(37535),a=e(80187),i=e(70584);const x=[a.ho.regex,a.ho.notRegex,a.ho.notEqual,a.ho.equal];function s(L){if(L.startsWith("{")&&L.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const B=x.map(A=>[A,L.indexOf(A)]).filter(([A,N])=>N>-1).sort((A,N)=>A[1]-N[1]);if(!B.length)throw new Error(`Invalid matcher: ${L}`);const[F,I]=B[0],U=L.slice(0,I).trim(),W=L.slice(I+F.length);if(!U)throw new Error(`Invalid matcher: ${L}`);return{name:U,value:W,isRegex:F===a.ho.regex||F===a.ho.notRegex,isEqual:F===a.ho.equal||F===a.ho.regex}}function c(L){return y(L)?d(L):[s(L)]}function d(L){if(!y(L))throw new Error("not a PromQL style matcher");return u(L)}function u(L){const B=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,F=L.replace(/^\{/,"").replace(/\}$/,"").trim().split(B);return(0,t.compact)(F).flatMap(s).map(I=>({...I,name:l(I.name),value:l(I.value)}))}function g(L){try{return u(L)}catch{return[]}}function o(L){const B=L.filter(F=>!!F.trim()).map(F=>s(F));return(0,t.uniqBy)(B,F=>F.name)}const E=L=>{const B=Object.entries(L).filter(([I])=>!(0,i.F2)(I)),F=new URLSearchParams;return B.forEach(([I,U])=>F.append("matcher",`${I}=${U}`)),F},m=L=>{let B=[];return L.matchers&&L.matchers.forEach(F=>{const I=c(F).map(P);B=B.concat(I)}),L.object_matchers&&B.push(...L.object_matchers),L.match_re&&Object.entries(L.match_re).forEach(([F,I])=>{B.push([F,a.ho.regex,I])}),L.match&&Object.entries(L.match).forEach(([F,I])=>{B.push([F,a.ho.equal,I])}),B};function f(L){return`"${L.replace(/[\\"]/g,F=>`\\${F}`)}"`}const p=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function h(L){return p.test(L)?f(L):L}function D(L){return h(l(L))}const C=({name:L,operator:B,value:F})=>{const I=h(L),U=f(F);return`${I}${B}${U}`};function l(L){return/^"(.*)"$/.test(L)?L.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):L}const v={default:([L,B,F])=>`${L} ${B} ${F||""}`,unquote:([L,B,F])=>{const I=l(L),U=l(F)||'""';return`${I} ${B} ${U}`}};function y(L){return L.startsWith("{")&&L.endsWith("}")}function P(L){const B=b(L);return[L.name,B,L.value]}function b(L){return L.isEqual?L.isRegex?a.ho.regex:a.ho.equal:L.isRegex?a.ho.notRegex:a.ho.notEqual}function S(L,B){for(const F of L)if(!O(F,B))return!1;return!0}const M={[a.ho.equal]:(L,B)=>L===B,[a.ho.notEqual]:(L,B)=>L!==B,[a.ho.regex]:(L,B)=>{const F=(0,r.bQ)(`^(?:${B})$`);return new RegExp(F.cleaned,F.flags).test(L)},[a.ho.notRegex]:(L,B)=>{const F=(0,r.bQ)(`^(?:${B})$`);return!new RegExp(F.cleaned,F.flags).test(L)}};function O(L,B){const[F,I,U]=L;let W="";const A=Object.fromEntries(B)[F];A&&(W=A);const N=M[I];if(!N)throw new Error(`no such operator: ${I}`);try{return N(W,U)}catch(K){return console.warn(K),!1}}function R(L,B){const[F,I]=B,[U,W,A]=L;if(F!==U)return!1;const N=M[W];if(!N)throw new Error(`no such operator: ${W}`);return N(I,A)}},85651:(q,j,e)=>{"use strict";e.d(j,{BK:()=>L,Cp:()=>V,D2:()=>A,E2:()=>G,ES:()=>w,GD:()=>B,Ht:()=>b,JM:()=>W,JZ:()=>k,KT:()=>O,NH:()=>F,S2:()=>y,Sl:()=>P,Yp:()=>D,bI:()=>l,bg:()=>C,i7:()=>v,i9:()=>N,nL:()=>R,qN:()=>U,qc:()=>z,qy:()=>M,u7:()=>H,w$:()=>p,y$:()=>T});var t=e(2543),n=e.n(t),r=e(96698),a=e(32370),i=e(28082),x=e(61351),s=e(68639),c=e(82700),d=e(2255),u=e(51876),g=e(83466),o=e(88214),E=e(16361),m=e(55936),f=e(35874);function p(_,ee,J){const Z=(0,o.EV)(_),te=s.UP(Z,ee),ae=encodeURIComponent(s.$9(te)),re=encodeURIComponent(Z);return(0,f.G)(`/alerting/${re}/${ae}/view`,J?{returnTo:J}:{})}function h(_,ee,J){const Z=_.rulesSource.name,te=ruleId.fromRule(Z,_.namespace.name,_.groupName,ee),ae=encodeURIComponent(ruleId.stringifyIdentifier(te)),re=encodeURIComponent(Z);return createRelativeUrl(`/alerting/${re}/${ae}/view`,J?{returnTo:J}:{})}function D(_,ee){const{uid:J,type:Z}=_;return(0,f.G)("/explore",{left:JSON.stringify({datasource:_.uid,queries:[{refId:"A",datasource:{uid:J,type:Z},expr:ee}],range:{from:"now-1h",to:"now"}})})}function C(_,ee=""){return(0,f.G)(`/alerting/notifications/receivers/${encodeURIComponent(_)}/edit`,{alertmanager:ee})}function l(_,ee=""){return(0,f.G)("/alerting/notifications",{search:_,tab:"contact_points",alertmanager:ee})}function v(_,ee=""){return(0,f.G)("/alerting/routes/mute-timing/edit",{muteName:_,alertmanager:ee})}function y(_){if((0,c.X4)(_)||(0,c.Mj)(_))return(0,f.z)(`/alerting/${encodeURIComponent(_.ruleSourceName)}/${encodeURIComponent((0,s.PH)(_.ruleName))}/find`);if((0,c.A4)(_))return(0,f.z)(`/alerting/grafana/${_.uid}/view`)}function P(_){return _.reduce((ee,{key:J,value:Z})=>(ee[J]=Z,ee),{})}const b=_=>{const ee=_.queryString===void 0?void 0:String(_.queryString),J=_.alertState===void 0?void 0:String(_.alertState),Z=_.dataSource===void 0?void 0:String(_.dataSource),te=_.ruleType===void 0?void 0:String(_.ruleType),ae=_.groupBy===void 0?void 0:String(_.groupBy).split(",");return{queryString:ee,alertState:J,dataSource:Z,groupBy:ae,ruleType:te}},S=_=>({queryString:_.get("queryString")??void 0,contactPoint:_.get("contactPoint")??void 0}),M=_=>{const ee=_.queryString===void 0?void 0:String(_.queryString),J=_.silenceState===void 0?void 0:String(_.silenceState);return{queryString:ee,silenceState:J}};function O(_){return Object.entries(_).map(([ee,J])=>({key:ee,value:J}))}function R(_,ee,J){const Z=new URLSearchParams(J);return ee&&Z.set(g.DD,ee),`${_}?${Z.toString()}`}function L(_,ee){const J=new URLSearchParams;return J.append("alertmanager",_),(0,m.J9)(ee).forEach((te,ae)=>J.append(ae,te)),(0,f.G)("/alerting/silence/new",J)}function B(_){return(0,f.G)(`/datasources/edit/${_}`)}function F(_){return(0,f.G)(`/dashboards/f/${_}`)}function I(_,ee){return createRelativeUrl(`/dashboards/f/${_}/${ee}/alerting`)}function U(_){return(0,f.G)(`/dashboards/f/${_}/settings`)}function W(_){return(0,f.G)(`/d/${encodeURIComponent(_)}`)}function A(_,ee){const J=new URLSearchParams({viewPanel:ee});return(0,f.G)(`/d/${encodeURIComponent(_)}`,J)}function N(_,ee,J,Z=1e3){const te=new Date().getTime(),ae=()=>_().catch(re=>{if(ee(re)&&new Date().getTime()-te<J)return new Promise(ne=>setTimeout(ne,Z)).then(ae);throw re});return ae()}const K={[u.Gi.Alerting]:1,[u.cF.Firing]:1,[u.Gi.Error]:1,[u.Gi.Pending]:2,[u.cF.Pending]:2,[u.cF.Inactive]:2,[u.Gi.NoData]:3,[u.Gi.Normal]:4};function V(_,ee){if(_===d.xB.Importance)return(0,t.sortBy)(ee,Z=>[K[(0,u.lh)(Z.state)],(0,c.RI)(Z).toLocaleLowerCase()]);if(_===d.xB.TimeAsc)return(0,t.sortBy)(ee,Z=>[new Date(Z.activeAt)||new Date,(0,c.RI)(Z).toLocaleLowerCase()]);if(_===d.xB.TimeDesc)return(0,t.sortBy)(ee,Z=>[new Date(Z.activeAt)||new Date,(0,c.RI)(Z).toLocaleLowerCase()]).reverse();const J=(0,t.sortBy)(ee,Z=>(0,c.RI)(Z).toLocaleLowerCase());return _===d.xB.AlphaDesc&&J.reverse(),J}function T(){return a.$.buildInfo.edition===r.r.OpenSource}function z(){return x.TP.hasRole("Admin")||x.TP.isGrafanaAdmin}function w(){return a.$.buildInfo.env==="development"}function H(_){return!!(_&&typeof _=="object"&&"message"in _)}function G(_){return(0,E.jX)(_)&&_.data.details?_.data.details.uid:_.cause}function X(_,ee){return _?G(_)===ee:!1}function k(_){if((0,i.NF)(_)){if((0,E.jX)(_)&&_.data.details){const Z=(0,E.j2)(_.data.details.uid);if(Z)return Z}return _.message?_.message:"message"in _.data&&typeof _.data.message=="string"?_.data.message:_.statusText?_.statusText:String(_.status)||"Unknown error"}if(!H(_))return String(_);const J=G(_);if(typeof J=="string"){const Z=(0,E.j2)(J);if(Z)return Z}return _.cause?`${_.message}, cause: ${k(_.cause)}`:_.message}},86655:(q,j,e)=>{"use strict";e.d(j,{Rs:()=>a,W$:()=>u,Wn:()=>o,_I:()=>g,rJ:()=>s});var t=e(2543),n=e.n(t),r=e(55936);const a=["receiver","group_by","group_wait","group_interval","repeat_interval"];function i(E,m){const f=matchLabelsSet(E,m),p=new Map(m.map(h=>[h,{match:!1,matcher:null}]));return E.forEach(h=>{const D=m.find(C=>isLabelMatch(h,C));D&&p.set(D,{match:!0,matcher:h})}),{matches:f,labelsMatch:p}}function x(E,m){let f=[];const p=i(E.object_matchers??[],m);if(!p.matches)return[];if(E.routes)for(const h of E.routes){const D=x(h,m);if(f=f.concat(D),D.length&&!h.continue)break}return f.length===0&&f.push({route:E,labelsMatch:p.labelsMatch}),f}function s(E){function m(p){p.object_matchers=(0,r.J$)(p),delete p.matchers,delete p.match,delete p.match_re,p.routes?.forEach(m)}const f=structuredClone(E);return m(f),f}function c(E){function m(p){p.object_matchers=p.object_matchers?.map(([h,D,C])=>[unquoteWithUnescape(h),D,unquoteWithUnescape(C)]),p.routes?.forEach(m)}const f=structuredClone(E);return m(f),f}function d(E,m,f){const p=[];return f.reduce((h,D)=>{const C=D.alerts.filter(l=>{const v=Object.entries(l.labels);return x(E,v).some(y=>y.route===m)});return C.length&&h.push({...D,alerts:C}),h},p)}function u(E,m,f){const h={...(0,t.pick)(E,a),...f};return(0,t.reduce)(h,(C,l,v)=>{const y=l!=null,S=[void 0,"",null].some(R=>m[v]===R)&&y,M=v==="group_by"&&y&&(0,t.isArray)(m[v])&&m[v]?.length===0;return(S||M)&&(C[v]=l),C},{})}function g(E){return{...E,routes:E.routes?.map(m=>{const f=u(E,m);return g({...m,...f})})}}function o(E,m,f){const p={...E};return p.receiver===m&&(p.receiver=f),p.routes&&(p.routes=p.routes.map(h=>o(h,m,f))),p}},40113:(q,j,e)=>{"use strict";e.d(j,{u:()=>t});function t(n,r,a,i={}){return{propertyName:n,label:r,description:a,element:"input",inputType:"",required:!1,secure:!1,placeholder:"",validationRule:"",showWhen:{field:"",is:""},dependsOn:"",...i}}},4013:(q,j,e)=>{"use strict";e.d(j,{$I:()=>g,BU:()=>v,CZ:()=>m,J7:()=>d,ML:()=>y,Vf:()=>C,Xw:()=>u,jA:()=>s,p0:()=>f,t4:()=>l,v5:()=>o});var t=e(65307),n=e(52718),r=e(28082),a=e(87638),i=e(83893),x=e(85651);const s=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function c(P,b=s,S){if(P.pending.match(S))return{result:b.result,loading:!0,error:b.error,dispatched:!0,requestId:S.meta.requestId};if(P.fulfilled.match(S)){if(b.requestId===void 0||b.requestId===S.meta.requestId)return{...b,result:S.payload,loading:!1,error:void 0}}else if(P.rejected.match(S)&&b.requestId===S.meta.requestId)return{...b,loading:!1,error:S.error};return b}function d(P,b){return(0,t.Z0)({name:P,initialState:s,reducers:{},extraReducers:S=>S.addDefaultCase((M,O)=>c(b,M,O))})}function u(P,b,S){return(0,t.Z0)({name:P,initialState:{},reducers:{},extraReducers:M=>M.addDefaultCase((O,R)=>{if((0,t.$S)(b)(R)){const L=R,B=S(L.meta.arg);return{...O,[B]:c(b,O[B],L)}}return O})})}function g(P){return P.catch(b=>{throw{message:m(b),code:b.statusCode}})}function o(P,b){return P.then(S=>(b.successMessage&&a.lE.emit(n.r1.alertSuccess,[b.successMessage]),S)).catch(S=>{const M=m(S);throw a.lE.emit(n.r1.alertError,[`${b.errorMessage??"Error"}: ${M}`]),S})}const E="Unknown Error";function m(P){if((0,r.NF)(P))if(P.data?.message){let b=P.data?.message;return typeof P.data?.error=="string"&&(b+=`; ${P.data.error}`),b}else{if(Array.isArray(P.data)&&P.data.length&&P.data[0]?.message)return P.data.map(b=>b?.message).filter(b=>!!b).join(" ");if(P.statusText)return P.statusText}return(0,x.u7)(P)?P.message:((0,i.fH)(i.le.unknownMessageFromError,{error:JSON.stringify(P)}),E)}function f(P){return Object.values(P).every(p)}function p(P){return P.dispatched&&!P.loading}function h(P){return Object.values(P).every(D)}function D(P){return P.dispatched&&!P.loading&&!P.error}function C(P){return Object.values(P).some(y)}function l(P){return Object.values(P).some(b=>b.dispatched)}function v(P){return Object.values(P).some(D)}function y(P){return P?P.dispatched&&P.loading:!1}},27174:(q,j,e)=>{"use strict";e.d(j,{AB:()=>c,AS:()=>d,HO:()=>E,I8:()=>u,KR:()=>f,dn:()=>o,eM:()=>m});var t=e(1932),n=e(2543),r=e.n(n),a=e(6562),i=e(80187),x=e(12444),s=e(16361);const c=(D,C,l)=>{if(!m(C.id??"",l))throw new Error(`No such route with ID '${C.id}'`,{cause:s.g2});function y(P){let b=P;if(P.id===C.id){const S=(0,x.SJ)(D,C,l);b={...P,...S}}return{...b,routes:P.routes?.map(y)}}return y(l)},d=(D,C)=>{if(D===C.id)throw new Error("You cant remove the root policy");function l(v){return{...v,routes:v.routes?.reduce((y=[],P)=>(P.id===D||y.push(l(P)),y),[])}}return l(C)},u=(D,C,l,v,y)=>{const P=(0,x.SJ)(D,C,v);return(0,t.jM)(v,b=>{const[S,M,O]=g(b,l);if(S===void 0||M===void 0||O===void 0)throw new Error(`could not find reference route "${l}" in tree`,{cause:s.g2});y==="child"&&(S.routes?S.routes.push(P):S.routes=[P]),y==="above"&&(M.routes=(0,a.insertBeforeImmutably)(M.routes??[],P,O)),y==="below"&&(M.routes=(0,a.insertAfterImmutably)(M.routes??[],P,O))})};function g(D,C){let l,v,y;function P(b,S,M){l||(b.id===C&&(l=b,v=M,y=S),b.routes&&b.routes.forEach((O,R)=>P(O,R,b)))}return P(D,0,D),[l,v,y]}function o(D){return(0,n.omit)({...D,routes:D.routes?.map(C=>o(C))},"id")}function E(D){return(0,t.jM)(D,C=>{C.spec.routes=C.spec.routes.map(o)})}function m(D,C){return C.id===D?C:C.routes?.find(l=>m(D,l))}function f(D){const C=JSON.stringify(p(D));let l=0;for(let v=0;v<C.length;v++){const y=C.charCodeAt(v);l=(l<<5)-l+y,l=l&l}return l.toString(36)}function p(D){return{receiver:D.receiver??"",group_by:D.group_by?[...D.group_by].sort():[],continue:D.continue??!1,object_matchers:D.object_matchers?[...D.object_matchers].sort():[],matchers:D.matchers?[...D.matchers].sort():[],match:D.match?h(D.match):{},match_re:D.match_re?h(D.match_re):{},group_wait:D.group_wait??"",group_interval:D.group_interval??"",repeat_interval:D.repeat_interval??"",routes:D.routes??[],mute_time_intervals:D.mute_time_intervals?[...D.mute_time_intervals].sort():[],active_time_intervals:D.active_time_intervals?[...D.active_time_intervals].sort():[],provenance:D.provenance??"",[i.uz]:{}}}function h(D){const C={};return Object.keys(D).sort().forEach(l=>{C[l]=D[l]}),C}},82096:(q,j,e)=>{"use strict";e.d(j,{Bu:()=>X,J6:()=>z,Os:()=>l,Q8:()=>C,QX:()=>F,Qk:()=>I,XI:()=>U,Z9:()=>S,l1:()=>v,mY:()=>k,mp:()=>T,qO:()=>W});var t=e(55801),n=e(59577),r=e(44099),a=e(32370),i=e(98437),x=e(65502),s=e(61034),c=e(2044),d=e(44684),u=e(71481),g=e(69064),o=e(9469),E=e(39180),m=e(83466),f=e(88214),p=e(85651),h=e(82700),D=e(32266);const C="grafana.alerting.manualRouting",l="grafana.alerting.simplifiedQueryEditor";function v(_){const{name:ee,expression:J,forTime:Z,forTimeUnit:te,keepFiringForTime:ae,keepFiringForTimeUnit:re,type:ne}=_,ce=(0,p.Sl)(M(_.annotations)),le=(0,p.Sl)(O(_.labels));if(ne===E.Z.cloudAlerting){let he;return ae&&re&&(he=`${ae}${re}`),{alert:ee,for:`${Z}${te}`,keep_firing_for:he,annotations:ce,labels:le,expr:J}}else if(ne===E.Z.cloudRecording)return{record:ee,labels:le,expr:J};throw new Error(`unexpected rule type: ${ne}`)}function y(_,ee){const J=[...(0,p.KT)(_||{})];return ee&&J.push({key:"",value:""}),J}function P(_,ee){if(ee?.grafana?.selectedContactPoint&&_)return{receiver:ee?.grafana?.selectedContactPoint,mute_time_intervals:ee?.grafana?.muteTimeIntervals,group_by:ee?.grafana?.overrideGrouping?ee?.grafana?.groupBy:void 0,group_wait:ee?.grafana?.overrideTimings&&ee?.grafana?.groupWaitValue?ee?.grafana?.groupWaitValue:void 0,group_interval:ee?.grafana?.overrideTimings&&ee?.grafana?.groupIntervalValue?ee?.grafana?.groupIntervalValue:void 0,repeat_interval:ee?.grafana?.overrideTimings&&ee?.grafana?.repeatIntervalValue?ee?.grafana?.repeatIntervalValue:void 0}}function b(_){return{simplified_query_and_expressions_section:_.simplifiedQueryEditor,simplified_notifications_section:_.simplifiedNotificationEditor}}function S(_){const{name:ee,condition:J,noDataState:Z,execErrState:te,evaluateFor:ae,queries:re,isPaused:ne,contactPoints:ce,manualRouting:le,type:he,metric:oe}=_;if(!J)throw new Error("You cannot create an alert rule without specifying the alert condition");const de=P(le,ce),me=_.editorSettings?{editor_settings:b(_.editorSettings)}:void 0,Pe=(0,p.Sl)(M(_.annotations)),Ee=(0,p.Sl)(O(_.labels)),be=(0,h.Mu)(he),Se=(0,h.pq)(he);if(be)return{grafana_alert:{title:ee,condition:J,data:re.map(H),is_paused:!!ne,no_data_state:Z,exec_err_state:te,notification_settings:de,metadata:me},annotations:Pe,labels:Ee,for:ae};if(Se)return{grafana_alert:{title:ee,condition:J,data:re.map(H),is_paused:!!ne,record:{metric:oe??ee,from:J}},annotations:Pe,labels:Ee};throw new Error(`Failed to convert form values to Grafana rule: unknown type ${he}`)}const M=_=>_.map(R).filter(({key:ee,value:J})=>!!ee&&!!J),O=_=>_.map(R).filter(({key:ee})=>!!ee),R=({key:_,value:ee})=>({key:_.trim(),value:ee.trim()});function L(_){const ee=_.notification_settings?{selectedContactPoint:_.notification_settings.receiver,muteTimeIntervals:_.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(_.notification_settings.group_by)&&_.notification_settings.group_by.length>0,overrideTimings:[_.notification_settings.group_wait,_.notification_settings.group_interval,_.notification_settings.repeat_interval].some(Boolean),groupBy:_.notification_settings.group_by||[],groupWaitValue:_.notification_settings.group_wait||"",groupIntervalValue:_.notification_settings.group_interval||"",repeatIntervalValue:_.notification_settings.repeat_interval||""}:void 0;return ee?{[f.hY]:ee}:void 0}function B(_){if(a.$.featureToggles.alertingQueryAndExpressionsStepMode)return _.metadata?.editor_settings?{simplifiedQueryEditor:_.metadata.editor_settings.simplified_query_and_expressions_section,simplifiedNotificationEditor:_.metadata.editor_settings.simplified_notifications_section}:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!!_.notification_settings}}function F(_){const{ruleSourceName:ee,namespace:J,group:Z,rule:te}=_,ae=(0,g.IJ)();if((0,f.z2)(ee))if((0,h.Gy)(te)){const re=te.grafana_alert;return{...ae,name:re.title,type:E.Z.grafanaRecording,group:Z.name,evaluateEvery:Z.interval||ae.evaluateEvery,queries:re.data,condition:re.condition,annotations:(0,o.JE)(y(te.annotations,!1)),labels:y(te.labels,!0),folder:{title:J,uid:re.namespace_uid},isPaused:re.is_paused,metric:re.record?.metric}}else if((0,h.lT)(te)){const re=te.grafana_alert,ne=L(re);if(re.no_data_state!==void 0&&re.exec_err_state!==void 0)return{...ae,name:re.title,type:E.Z.grafana,group:Z.name,evaluateEvery:Z.interval||ae.evaluateEvery,evaluateFor:te.for||"0",noDataState:re.no_data_state,execErrState:re.exec_err_state,queries:re.data,condition:re.condition,annotations:(0,o.JE)(y(te.annotations,!1)),labels:y(te.labels,!0),folder:{title:J,uid:re.namespace_uid},isPaused:re.is_paused,contactPoints:ne,manualRouting:!!ne,editorSettings:B(re)};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,h.$y)(te)){const ne={refId:"A",datasourceUid:(0,i.l)().getInstanceSettings(ee)?.uid??"",queryType:"",relativeTimeRange:(0,t.Cn)(),expr:te.expr,model:{refId:"A",hide:!1,expr:te.expr}},ce=I(te);return{...ae,...ce,queries:[ne],annotations:(0,o.JE)(y(te.annotations,!1)),type:E.Z.cloudAlerting,dataSourceName:ee,namespace:J,group:Z.name}}else if((0,h.i7)(te)){const re=U(te);return{...ae,...re,type:E.Z.cloudRecording,dataSourceName:ee,namespace:J,group:Z.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function I(_){const ee=(0,g.IJ)(),[J,Z]=_.for?(0,D.P1)(_.for):[0,"s"],[te,ae]=_.keep_firing_for?(0,D.P1)(_.keep_firing_for):[ee.keepFiringForTime,ee.keepFiringForTimeUnit];return{name:_.alert,expression:_.expr,forTime:J,forTimeUnit:Z,keepFiringForTime:te,keepFiringForTimeUnit:ae,annotations:y(_.annotations,!1),labels:y(_.labels,!0)}}function U(_){return{name:_.record,expression:_.expr,labels:y(_.labels,!0)}}const W=(_=!1)=>{const ee=(0,f.y9)();if(!ee)return[..._?K("A"):N("A","B")];const J=(0,t.Cn)(),Z=_?K("B"):N("B","C"),te=ee?.type===f.ol.Prometheus||ee?.type===f.ol.Loki;return[{refId:"A",datasourceUid:ee.uid,queryType:"",relativeTimeRange:J,model:{refId:"A",instant:te?!0:void 0}},...Z]},A=_=>{const ee=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:_[0]?.uid||"",queryType:"",relativeTimeRange:ee,model:{refId:"A"}}]},N=(..._)=>{const ee=_[0],J=_[1],Z={refId:_[0],type:d.Tz.reduce,datasource:{uid:d.Uj,type:x.dR.type},conditions:[{type:"query",evaluator:{params:[],type:u.p.IsAbove},operator:{type:"and"},query:{params:[ee]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},te={refId:J,type:d.Tz.threshold,datasource:{uid:d.Uj,type:x.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:u.p.IsAbove},operator:{type:"and"},query:{params:[J]},reducer:{params:[],type:"last"}}],expression:ee};return[{refId:ee,datasourceUid:d.Uj,queryType:"",model:Z},{refId:J,datasourceUid:d.Uj,queryType:"",model:te}]},K=_=>{const ee={refId:_,type:d.Tz.reduce,datasource:{uid:d.Uj,type:x.dR.type},conditions:[{type:"query",evaluator:{params:[],type:u.p.IsAbove},operator:{type:"and"},query:{params:[_]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"};return[{refId:_,datasourceUid:d.Uj,queryType:"",model:ee}]},V=async(_,ee,J,Z,te,ae)=>{const re=[];for(const ne of _){const ce=await(0,i.l)().get(ne.datasource?.uid?ne.datasource:Z),le={uid:ce.uid,type:ce.type},he=n.relativeToTimeRange(ee),{interval:oe,intervalMs:de}=w(he,ae??ce.interval,te),me={__interval:{text:oe,value:oe},__interval_ms:{text:de,value:de},...J},Pe=ce.interpolateVariablesInQueries?ce.interpolateVariablesInQueries([ne],me)[0]:ne;if(le.uid===d.Uj){const Ee={refId:Pe.refId,queryType:"",relativeTimeRange:ee,datasourceUid:d.Uj,model:Pe};re.push(Ee)}else{const Ee=(0,i.l)().getInstanceSettings(le);if(Ee&&Ee.meta.alerting){const be={refId:Pe.refId,queryType:Pe.queryType??"",relativeTimeRange:ee,datasourceUid:Ee.uid,model:{...Pe,maxDataPoints:te,intervalMs:de}};re.push(be)}}}return re},T=async(_,ee)=>{const{targets:J}=_;if(!_.id||!ee.uid)return;const Z=n.timeRangeToRelative(n.convertRawToRange(ee.time)),te=await V(J,Z,_.scopedVars||{},_.datasource??void 0,_.maxDataPoints??void 0,_.interval??void 0);if(!te.length||!te.find(le=>le.datasourceUid!==d.Uj))return;if(!te.find(le=>le.datasourceUid===d.Uj)){const[le,he]=N((0,r.M)(te),"-");te.push(le);const[oe,de]=N(le.refId,(0,r.M)(te));te.push(de)}const{folderTitle:ae,folderUid:re}=ee.meta,ne=re&&ae?{kind:"folder",uid:re,title:ae}:void 0;return{type:E.Z.grafana,folder:ne,queries:te,name:_.title,condition:te[te.length-1].refId,annotations:[{key:m.YH.dashboardUID,value:ee.uid},{key:m.YH.panelID,value:String(_.id)}]}},z=async _=>{if(!_.state.key)return;const ee=s.jh.getTimeRange(_),J=(0,c.un)(_);if(!J)return;const{queries:Z,datasource:te,maxDataPoints:ae,minInterval:re}=J.state,ne=(0,c.YQ)(_);if(!ne||!ne.state.uid)return;const ce=await V(Z,n.timeRangeToRelative(n.convertRawToRange(ee.state.value.raw)),{__sceneObject:{value:_}},te,ae,re);if(!ce.length||!ce.find(me=>me.datasourceUid!==d.Uj))return;if(!ce.find(me=>me.datasourceUid===d.Uj)){const[me,Pe]=N((0,r.M)(ce),"-");ce.push(me);const[Ee,be]=N(me.refId,(0,r.M)(ce));ce.push(be)}const{folderTitle:le,folderUid:he}=ne.state.meta,oe=he&&le?{kind:"folder",uid:he,title:le}:void 0;return{type:E.Z.grafana,folder:oe,queries:ce,name:_.state.title,condition:ce[ce.length-1].refId,annotations:[{key:m.YH.dashboardUID,value:ne.state.uid},{key:m.YH.panelID,value:String((0,c.Cs)(_))}]}};function w(_,ee,J){return J?n.calculateInterval(_,J,ee):ee&&n.intervalToMs(ee)>1e3?{interval:ee,intervalMs:n.intervalToMs(ee)}:{interval:"1s",intervalMs:1e3}}function H(_){const ee=_.model;return G(ee)&&ee.instant&&ee.range?{..._,model:{...ee,range:!0,instant:!1}}:_}function G(_){return"expr"in _&&"instant"in _&&"range"in _}function X(_){return"expr"in _}function k(_,ee){if(ee!==f.ol.Prometheus&&ee!==f.ol.Loki)return"instant"in _?_.instant:"queryType"in _?_.queryType==="instant":void 0;const J="instant"in _&&_.instant!==void 0?_.instant:!0,Z="queryType"in _&&_.queryType!==void 0?_.queryType==="instant":!0;return ee===f.ol.Prometheus?J:Z}},68639:(q,j,e)=>{"use strict";e.d(j,{$9:()=>b,LC:()=>f,Lg:()=>o,Ns:()=>M,P1:()=>d,PH:()=>l,UP:()=>E,VY:()=>I,c:()=>v,co:()=>u,h1:()=>B,jY:()=>R,mw:()=>g,qg:()=>y,uE:()=>U,x6:()=>P});var t=e(2543),n=e.n(t),r=e(53027),a=e(51876),i=e(83893),x=e(3674),s=e(88214),c=e(82700);function d(W,A,N,K){return(0,c.lT)(K)?{uid:K.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:W,namespace:A,groupName:N,ruleName:(0,c.$y)(K)?K.alert:K.record,rulerRuleHash:M(K)}}function u(W,A){if(W.groupOrigin==="grafana"){if((0,c.lT)(A))return{uid:A.grafana_alert.uid,ruleSourceName:"grafana"};throw(0,i.vV)(new Error("Rule is not a Grafana Ruler rule")),new Error("Rule is not a Grafana Ruler rule")}return d(W.rulesSource.name,W.namespace.name,W.groupName,A)}function g(W,A){const{dataSourceName:N,namespaceName:K,groupName:V}=W;return d(N,K,V,A)}function o(W,A,N,K){return{ruleSourceName:W,namespace:A,groupName:N,ruleName:K.name,ruleHash:R(K)}}function E(W,A){const N=A.namespace.name,K=A.group.name;if(A.rulerRule)return d(W,N,K,A.rulerRule);if(A.promRule)return o(W,N,K,A.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function m(W){return d(W.ruleSourceName,W.namespace,W.group.name,W.rule)}function f(W,A){return(0,c.A4)(W)&&(0,c.A4)(A)?W.uid===A.uid:(0,c.X4)(W)&&(0,c.X4)(A)?W.groupName===A.groupName&&W.namespace===A.namespace&&W.ruleName===A.ruleName&&W.rulerRuleHash===A.rulerRuleHash&&W.ruleSourceName===A.ruleSourceName:(0,c.Mj)(W)&&(0,c.Mj)(A)?W.groupName===A.groupName&&W.namespace===A.namespace&&W.ruleName===A.ruleName&&W.ruleHash===A.ruleHash&&W.ruleSourceName===A.ruleSourceName:(0,c.X4)(W)&&(0,c.Mj)(A)?W.groupName===A.groupName&&W.namespace===A.namespace&&W.ruleName===A.ruleName&&W.rulerRuleHash===A.ruleHash&&W.ruleSourceName===A.ruleSourceName:(0,c.Mj)(W)&&(0,c.X4)(A)?W.groupName===A.groupName&&W.namespace===A.namespace&&W.ruleName===A.ruleName&&W.ruleHash===A.rulerRuleHash&&W.ruleSourceName===A.ruleSourceName:!1}const p="cri",h="pri";function D(W){return W.replace(/\$/g,"_DOLLAR_")}function C(W){return W.replace(/\_DOLLAR\_/g,"$")}function l(W){return W.replace(/\//g,"").replace(/\\/g,"")}function v(W){return W.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function y(W,A=!1){const K=(A?decodeURIComponent(W):W).split("$");if(K.length===1)return{uid:W,ruleSourceName:"grafana"};if(K.length===6){const[V,T,z,w,H,G]=K.map(C).map(v);if(V===p)return{ruleSourceName:T,namespace:z,groupName:w,ruleName:H,rulerRuleHash:G};if(V===h)return{ruleSourceName:T,namespace:z,groupName:w,ruleName:H,ruleHash:G}}throw new Error(`Failed to parse rule location: ${W}`)}function P(W,A=!1){if(W)try{return y(W,A)}catch{return}}function b(W){return(0,c.A4)(W)?W.uid:(0,c.X4)(W)?[p,W.ruleSourceName,W.namespace,W.groupName,W.ruleName,W.rulerRuleHash].map(String).map(D).map(l).join("$"):[h,W.ruleSourceName,W.namespace,W.groupName,W.ruleName,W.ruleHash].map(String).map(D).map(l).join("$")}function S(W){let A=0;if(W.length===0)return A;for(let N=0;N<W.length;N++){const K=W.charCodeAt(N);A=(A<<5)-A+K,A=A&A}return A}function M(W){if((0,c.lT)(W))return W.grafana_alert.uid;const A=O(W);return S(JSON.stringify(A)).toString()}function O(W){const N=(0,x.w)()?"":B(W.expr),K=F(W.labels);if((0,c.i7)(W))return[W.record,a.JS.Recording,N,K];if((0,c.$y)(W))return[W.alert,a.JS.Alerting,N,F(W.annotations),K];throw new Error("Only recording and alerting ruler rules can be hashed")}function R(W){const A=L(W);return S(JSON.stringify(A)).toString()}function L(W){const N=(0,x.w)()?"":B(W.query),K=F(W.labels);if((0,c.KB)(W))return[W.name,a.JS.Recording,N,K];if((0,c.Z8)(W))return[W.name,a.JS.Alerting,N,F(W.annotations),K];throw new Error("Only recording and alerting rules can be hashed")}function B(W){return W.length>1&&W[0]==="("&&W[W.length-1]===")"&&(W=W.slice(1,-1)),W=W.replace(/\s|\n/g,""),W.split("").sort().join("")}function F(W){return JSON.stringify(Object.entries(W||{}).sort((A,N)=>A[0].localeCompare(N[0])))}function I(W){return(0,c.A4)(W)?s.hY:W.ruleSourceName}function U(W){const{pathname:A=""}=r.Ny.getLocation(),{id:N}=W;return N?(0,t.nth)(A.split("/"),-2):void 0}},82700:(q,j,e)=>{"use strict";e.d(j,{$7:()=>P,$y:()=>m,A4:()=>b,BL:()=>ne,Gy:()=>h,H2:()=>le,HH:()=>v,I2:()=>J,KB:()=>E,Mj:()=>O,Mt:()=>l,Mu:()=>ae,Nv:()=>L,OF:()=>ce,Om:()=>H,RI:()=>y,Rh:()=>I,TU:()=>V,Tm:()=>A,UL:()=>p,Wy:()=>z,X4:()=>S,XI:()=>N,YN:()=>G,Z8:()=>o,dS:()=>T,f6:()=>B,fC:()=>F,i7:()=>f,j_:()=>Z,jg:()=>k,lT:()=>C,nf:()=>M,pq:()=>re,pv:()=>D,qz:()=>X,s_:()=>oe,uo:()=>U,vE:()=>he,y1:()=>te});var t=e(2543),n=e.n(t),r=e(91323),a=e(32370),i=e(51876),x=e(60344),s=e(39180),c=e(83466),d=e(88214),u=e(70584),g=e(32266);function o(de){return typeof de=="object"&&de.type===i.JS.Alerting}function E(de){return typeof de=="object"&&de.type===i.JS.Recording}function m(de){return typeof de=="object"&&"alert"in de}function f(de){return typeof de=="object"&&"record"in de}function p(de){return typeof de=="object"&&f(de)||C(de)&&"record"in de.grafana_alert}function h(de){return typeof de=="object"&&p(de)&&C(de)}function D(de){return typeof de=="object"&&C(de)&&!p(de)}function C(de){return typeof de=="object"&&"grafana_alert"in de}function l(de){return typeof de=="object"&&!C(de)}function v(de){return de&&C(de)&&!!de.grafana_alert.is_paused}function y(de){return JSON.stringify(de.labels)}function P(de){return de.error&&de.error?.message?.includes(c.UU)}function b(de){return"uid"in de}function S(de){return"rulerRuleHash"in de}function M(de){return Object.values(i.JS).includes(de)}function O(de){return"ruleHash"in de}function R(de){return b(de)||S(de)}function L(de){return C(de)&&!!de.grafana_alert.provenance}function B(de){switch(de){case"ok":return x.Jc.Ok;case"nodata":return x.Jc.NoData;case"error":case"err":return x.Jc.Error;case"unknown":return x.Jc.Unknown;default:return}}function F(de){if(!(f(de.rulerRule)||E(de.promRule)||h(de.rulerRule))){if(m(de.rulerRule))return de.rulerRule.for;if(o(de.promRule)){const me=(de.promRule.duration??0)*1e3;return(0,g.an)(me)}}}function I(de){if(!(f(de.rulerRule)||E(de.promRule)||h(de.rulerRule)))return de.annotations??[]}function U(de){if(!de)return;const me=de.labels?.[u.lL];if(!me)return;const Pe=me.match(/^plugin\/(?<pluginId>.+)$/);if(!Pe?.groups)return;const Ee=Pe.groups.pluginId;if(W(Ee))return{pluginId:Ee}}function W(de){return!!a.$.apps[de]}function A(de){return!!U(de)}function N(de){return de===i.cF.Inactive?"Normal":(0,t.capitalize)(de)}const K=de=>de.reduce((me,{dataSourceName:Pe,name:Ee,groups:be})=>(be.forEach(({name:Se,rules:Xe})=>{Xe.forEach(Qe=>{o(Qe)&&me.push({dataSourceName:Pe,namespaceName:Ee,groupName:Se,rule:Qe})})}),me),[]),V=de=>o(de.promRule)?de.promRule:null,T=de=>de.reduce((me,{rulesSource:Pe,name:Ee,groups:be})=>(be.forEach(({name:Se,rules:Xe})=>{Xe.forEach(Qe=>{Qe.promRule&&o(Qe.promRule)&&me.push({dataSourceName:(0,d.EV)(Pe),namespaceName:Ee,groupName:Se,...Qe})})}),me),[]);function z(de){let me;return Object.values(r.O).includes(de)?me=de:me=(0,i.lh)(de),w[me]}const w={[i.cF.Inactive]:"good",[i.cF.Firing]:"bad",[i.cF.Pending]:"warning",[i.Gi.Alerting]:"bad",[i.Gi.Error]:"bad",[i.Gi.NoData]:"info",[i.Gi.Normal]:"good",[i.Gi.Pending]:"warning",[r.O.NoData]:"info",[r.O.Paused]:"warning",[r.O.Alerting]:"bad",[r.O.OK]:"good",[r.O.Unknown]:"info"};function H(de){return de?.alerts?de.alerts.reduce((me,Pe)=>{const Ee=(0,i.lh)(Pe.state)!==i.Gi.Normal;if(Pe.activeAt&&Ee){const be=new Date(Pe.activeAt);if(me===null||me.getTime()>be.getTime())return be}return me},null):null}function G(de){return Array.isArray(de.source_tenants)}function X(de){return C(de)?de.grafana_alert.title:m(de)?de.alert:f(de)?de.record:""}const k=(de,me)=>{const Pe={alertName:"",forDuration:"0s",evaluationsToFire:0};return C(de)?{alertName:de.grafana_alert.title,forDuration:de.for,evaluationsToFire:de.for?_(de.for,me):null}:m(de)?{alertName:de.alert,forDuration:de.for??"0s",evaluationsToFire:_(de.for??"0s",me)}:Pe},_=(de,me)=>{const Pe=(0,g.P8)(me),Ee=(0,g.P8)(de);return Ee===0&&Pe!==0?1:Pe===0||Ee/Pe<1?0:Math.ceil(Ee/Pe)+1};function ee(de){const me=isGrafanaRulesSource(de.namespace.rulesSource)?de.namespace.rulesSource:de.namespace.rulesSource.name,Pe=C(de.rulerRule)?de.rulerRule.grafana_alert.namespace_uid:de.namespace.name;return{dataSourceName:me,namespaceName:Pe,groupName:de.group.name}}function J(de){const me=de.ruleSourceName,Pe=C(de.rule)?de.rule.grafana_alert.namespace_uid:de.namespace,Ee=de.group.name;return{dataSourceName:me,namespaceName:Pe,groupName:Ee}}function Z(de){const me=de.dataSourceName,Pe=de.folder?.uid??de.namespace,Ee=de.group;if(!me)throw new Error("no datasource name in form values");return{dataSourceName:me,namespaceName:Pe,groupName:Ee}}function te(de){return(0,d.z2)(de)?de:de.name}function ae(de){return de===s.Z.grafana}function re(de){return de===s.Z.grafanaRecording}function ne(de){return de===s.Z.cloudAlerting}function ce(de){return de===s.Z.cloudRecording}function le(de){return ae(de)||re(de)}function he(de){return re(de)||ce(de)}function oe(de){return ne(de)||ce(de)}},5900:(q,j,e)=>{"use strict";e.d(j,{a:()=>a,o:()=>r});var t=e(2543),n=e.n(t);function r(i,x){let s=x.trim();if(!s.match(/\{\{\s*define/)){const c=s.split(`
`).map(d=>"  "+d).join(`
`);s=`{{ define "${i}" }}
${c}
{{ end }}`}return s}function a(i){const x=(s,c)=>`{{ define "${c}_NEW_${(0,t.now)()}" }}`;return i.replace(/\{\{\s*define\s*\"(?<defineName>.*)\"\s*\}\}/g,x)}},32266:(q,j,e)=>{"use strict";e.d(j,{M9:()=>d,P1:()=>n,P8:()=>g,TN:()=>i,an:()=>u,mo:()=>o,sc:()=>a,yl:()=>E});var t=e(42430);function n(m){const f=m.match(/(\d+)(\w+)/);if(f)return[Number(f[1]),f[2]];throw new Error(`Invalid interval description: ${m}`)}function r(m){const{sec:f,count:p}=describeInterval(m);return f*p}const a=Object.entries(t.y).map(([m,f])=>({label:m[0].toUpperCase()+m.slice(1),value:f}));function i(m){try{return d(m),!0}catch{return!1}}const x={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},s=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),c=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(t.y).join(", ")}`);function d(m){let f=m;const p=[];function h(C){const l=s.exec(C),v=l?.groups?.value&&l?.groups?.type;if(!l||!v)throw c;l&&l.groups?.value&&l.groups?.type&&(f=f.replace(l[0],""),p.push([Number(l.groups.value),l.groups.type])),f&&h(f)}if(h(m),!p.length)throw c;return p.reduce((C,[l,v])=>{const y=l*x[v];return C+y},0)}function u(m){const f=Math.floor(m/1e3),p=Math.floor(f/60),h=Math.floor(p/60),D=Math.floor(h/24),C=Math.floor(D/7),l=Math.floor(D/365);return m===0?"0s":[[l,"y"],[C%52,"w"],[D%365-7*(C%52),"d"],[h%24,"h"],[p%60,"m"],[f%60,"s"],[m%1e3,"ms"]].filter(([y])=>y>0).map(([y,P])=>y+P).join("")}const g=m=>{try{return d(m)}catch{return 0}},o=m=>m.includes("0001-01-01T00");function E(m){return m%(1e3*60*60)===0?m/(1e3*60*60)+"h":m%(1e3*60)===0?m/(1e3*60)+"m":m%1e3===0?m/1e3+"s":m.toFixed()+"ms"}},35874:(q,j,e)=>{"use strict";e.d(j,{G:()=>n,z:()=>r});var t=e(32370);function n(a,i){const s=new URLSearchParams(i).toString();return`${t.$.appSubUrl}${a}${s?`?${s}`:""}`}function r(a,i){const s=new URLSearchParams(i).toString();try{return`${new URL(t.$.appSubUrl+a,t.$.appUrl).href}${s?`?${s}`:""}`}catch{return n(a,i)}}},37104:(q,j,e)=>{"use strict";e.d(j,{S:()=>r});var t=e(49816),n=e(83893);function r(a,i={}){return(0,t.Xc)(a,{...i,style:"page",errorLogger:n.vV})}},65596:(q,j,e)=>{"use strict";e.d(j,{Xm:()=>a,rJ:()=>r,vJ:()=>n,vy:()=>i});var t=e(28082);function n(x){return(0,t.AI)().post("/api/annotations",x)}function r(x){return(0,t.AI)().put(`/api/annotations/${x.id}`,x)}function a(x){return(0,t.AI)().delete(`/api/annotations/${x.id}`)}async function i(){return(await(0,t.AI)().get("/api/annotations/tags")).result.tags.map(({tag:s,count:c})=>({term:s,count:c}))}},68358:(q,j,e)=>{"use strict";e.d(j,{A:()=>P});var t=e(74848),n=e(96540),r=e(75505),a=e(8392),i=e(83821),x=e(58779),s=e(9968),c=e(20968),d=e(54594),u=e(37e3),g=e(16910),o=e(80757),E=e(63845),m=e(71184),f=e(89107),p=e(23570),h=e(59764),D=e(59141),C=e(6736),l=e(79784),v=e(44826);class y extends n.PureComponent{constructor(S){super(S),this.updateFields=()=>{const M=this.props.response?.panelData,O=M?.series?.[0]??M?.annotations?.[0];if(O&&O.fields){const R=O.fields.map(L=>{const B=(0,p.Ct)(L,O);let F="";for(let I=0;I<O.length;I++){if(I>0&&(F+=", "),I>2){F+="...";break}F+=L.values[I]}return F.length>50&&(F=F.substring(0,50)+"..."),{label:`${B} (${L.type})`,value:B,description:F}});this.setState({fieldNames:R})}},this.onFieldSourceChange=(M,O)=>{const R=this.props.mappings||{},L=R[M]||{};this.props.change({...R,[M]:{...L,source:O.value||h.V.Field}})},this.onFieldNameChange=(M,O)=>{const R=this.props.mappings||{};if(!O){const B={...this.props.mappings};delete B[M],this.props.change(B);return}const L=R[M]||{};this.props.change({...R,[M]:{...L,value:O.value,source:h.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(S){S.response!==this.props.response&&this.updateFields()}renderRow(S,M,O){const{fieldNames:R}=this.state;let L=[...R];const B=M.value;let F=R.find(U=>B===U.value);B&&!F&&L.push({label:B,value:B});let I=O?O[S.key]:"";if(I&&S.key.startsWith("time")){const U=(0,D.j_)("dateTimeAsIso");I=(0,D.cN)(U(I))}return I==null&&(I=""),(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[S.label||S.key," ",S.help&&(0,t.jsx)(C.m,{content:S.help,children:(0,t.jsx)(l.I,{name:"info-circle"})})]}),(0,t.jsx)("td",{children:(0,t.jsx)(v.l6,{value:F,options:L,placeholder:S.placeholder||S.key,onChange:U=>{this.onFieldNameChange(S.key,U)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})}),(0,t.jsx)("td",{children:`${I}`})]},S.key)}render(){const S=this.props.response?.events?.[0],M=this.props.mappings||{};return(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Annotation"}),(0,t.jsx)("th",{children:"From"}),(0,t.jsx)("th",{children:"First Value"})]})}),(0,t.jsx)("tbody",{children:f.kj.map(O=>this.renderRow(O,M[O.key]||{},S))})]})}}class P extends n.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:S,annotation:M}=this.props;if((0,f.E7)(S))return;const O=(0,g.UA)().getCurrent();if(!O)return;this.setState({running:!0});const R=await(0,r.s)((0,m.b)({range:(0,o.jG)().timeRange(),panel:new E.a9({}),dashboard:O},S,M));this.setState({running:!1,response:R})},this.onQueryChange=S=>{this.props.onChange({...this.props.annotation,target:S})},this.onMappingChange=S=>{this.props.onChange({...this.props.annotation,mappings:S})},this.onAnnotationChange=S=>{this.props.onChange(S)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(S){this.props.annotation!==S.annotation&&!(0,f.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:S,annotation:M}=this.props,R={...f.CU,...S.annotations}.prepareAnnotation(M);R!==M?this.props.onChange(R):this.onRunQuery()}getStatusSeverity(S){const{events:M,panelData:O}=S;return O?.errors||O?.error?"error":M?.length?"success":"warning"}renderStatusText(S,M){const{events:O,panelData:R}=S;if(M||S?.panelData?.state===a.Gu.Loading||!S)return(0,t.jsx)("p",{children:"loading..."});if(R?.errors)return(0,t.jsx)(t.Fragment,{children:R.errors.map((B,F)=>(0,t.jsx)("p",{children:B.message},F))});if(R?.error)return(0,t.jsx)("p",{children:R.error.message??"There was an error fetching data"});if(!O?.length)return(0,t.jsx)("p",{children:"No events found"});const L=R?.series?.[0]??R?.annotations?.[0];return(0,t.jsxs)("p",{children:[O.length," events (from ",L?.fields.length," fields)"]})}renderStatus(){const{response:S,running:M}=this.state;return S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.$,{v:2}),(0,t.jsx)("div",{children:M?(0,t.jsx)(c.y,{}):(0,t.jsx)(d.$n,{"data-testid":x.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:"Test annotation query"})}),(0,t.jsx)(s.$,{v:2,layout:"block"}),(0,t.jsx)(u.F,{"data-testid":x.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(S),title:"Query result",children:this.renderStatusText(S,M)})]}):null}render(){const{datasource:S,annotation:M,datasourceInstanceSettings:O}=this.props,{response:R}=this.state;let L=S.annotations?.QueryEditor||S.components?.QueryEditor;if(!L)return(0,t.jsx)("div",{children:"Annotations are not supported. This datasource needs to export a QueryEditor"});const B={...S.annotations?.getDefaultQuery?.(),...M.target??{refId:"Anno"}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{instanceSettings:O,children:(0,t.jsx)(L,{query:B,datasource:S,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:R?.panelData,range:(0,o.jG)().timeRange(),annotation:M,onAnnotationChange:this.onAnnotationChange},S?.name)}),(0,f.JX)(S)&&(0,t.jsxs)(t.Fragment,{children:[this.renderStatus(),(0,t.jsx)(y,{response:R,mappings:M.mappings,change:this.onMappingChange})]})]})}}},71184:(q,j,e)=>{"use strict";e.d(j,{b:()=>u});var t=e(62467),n=e(69862),r=e(81160),a=e(59577),i=e(16753),x=e(23234),s=e(89107);let c=100;function d(){return"AQ"+c++}function u(g,o,E){const m={...s.CU,...o.annotations},f={...m.getDefaultQuery?.(),...E},p=m.prepareAnnotation(f);if(!p)return(0,t.of)({});const h=m.prepareQuery(p);if(!h)return(0,t.of)({});const D=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,C=a.calculateInterval(g.range,D,o.interval),l={__interval:{text:C.interval,value:C.interval},__interval_ms:{text:C.intervalMs.toString(),value:C.intervalMs},__annotation:{text:p.name,value:p}},v={startTime:Date.now(),requestId:d(),range:g.range,maxDataPoints:D,scopedVars:l,...C,app:i.Jk.Dashboard,timezone:g.dashboard.timezone,targets:[{...h,refId:"Anno"}]};return(0,x.BN)(o,v).pipe((0,n.Z)(y=>{const P=y?.series.length?y.series:y.annotations;return P?.length?m.processEvents(p,P).pipe((0,r.T)(b=>({panelData:y,events:b}))):(0,t.of)({panelData:y,events:[]})}))}},89107:(q,j,e)=>{"use strict";e.d(j,{CU:()=>g,E7:()=>C,JX:()=>D,kj:()=>E});var t=e(2543),n=e.n(t),r=e(62467),a=e(69862),i=e(81160),x=e(36596),s=e(63739),c=e(23570),d=e(59764),u=e(88023);const g={prepareAnnotation:l=>{if((0,t.isString)(l?.query)){const{query:v,...y}=l;return{...y,target:{refId:"annotation_query",query:v},mappings:{}}}return l},prepareQuery:l=>l.target,processEvents:(l,v)=>p(v,l.mappings)};function o(){return l=>l.pipe((0,a.Z)(v=>{if(!v?.length)return(0,r.of)(void 0);if(v.length===1)return(0,r.of)(v[0]);const y={interpolate:P=>P};return(0,r.of)(v).pipe(x.c.mergeTransformer.operator({},y),(0,i.T)(P=>P[0]))}))}const E=[{key:"time",field:l=>l.fields.find(v=>v.type===s.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:l=>l.fields.find(v=>v.type===s.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],m=[{key:"color"},{key:"isRegion"},{key:"source"}],f=[...u.$W.publicDashboardAccessToken?m:[],...E,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function p(l,v){return(0,r.of)(l).pipe(o(),(0,i.T)(y=>{if(!y?.length)return[];let P=!1,b=!1;const S={};for(const R of y.fields){const L=(0,c.Ct)(R,y);S[L.toLowerCase()]=R}v||(v={});const M=[];for(const R of f){const L=v[R.key]||{};if(L.source===d.V.Skip)continue;const B={key:R.key,split:R.split};if(L.source===d.V.Text)B.text=L.value;else{const F=(L.value||R.key).toLowerCase();B.field=S[F],!B.field&&R.field&&(B.field=R.field(y))}(B.field||B.text)&&(M.push(B),B.key==="time"?P=!0:B.key==="text"&&(b=!0))}if(!P||!b)return console.error("Cannot process annotation fields. No time or text present."),[];const O=[];for(let R=0;R<y.length;R++){const L={type:"default",color:"red"};for(const B of M){let F;if(B.text)F=B.text;else if(B.field&&(F=B.field.values[R],F!==void 0&&B.regex)){const I=B.regex.exec(F);I&&(F=I[1]?I[1]:I[0])}F!=null&&(B.split&&typeof F=="string"&&(F=F.split(",")),L[B.key]=F)}O.push(L)}return O}))}const h=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function D(l){const{type:v}=l;return!(v==="datasource"||h.includes(v))}function C(l){const{type:v}=l;return h.includes(v)}},95242:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>u,QB:()=>c,Ri:()=>s,Sf:()=>a,cV:()=>i,h8:()=>x});var t=e(65307);const n={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},r=(0,t.Z0)({name:"apiKeys",initialState:n,reducers:{apiKeysLoaded:(g,o)=>{const{keys:E,keysIncludingExpired:m}=o.payload,f=o.payload.keys.length===0&&o.payload.keysIncludingExpired.length>0?!0:g.includeExpired;return{...g,hasFetched:!0,keys:E,keysIncludingExpired:m,includeExpired:f}},setSearchQuery:(g,o)=>({...g,searchQuery:o.payload}),includeExpiredToggled:g=>({...g,includeExpired:!g.includeExpired}),isFetching:g=>({...g,hasFetched:!1}),setMigrationResult:(g,o)=>({...g,migrationResult:o.payload})}}),{apiKeysLoaded:a,includeExpiredToggled:i,isFetching:x,setSearchQuery:s,setMigrationResult:c}=r.actions,u={apiKeys:r.reducer}},72458:(q,j,e)=>{"use strict";e.d(j,{H1:()=>m,ws:()=>o});var t=e(16126),n=e(81160),r=e(69862),a=e(65474),i=e(33160),x=e(66847),s=e(28082),c=e(32370),d=e(87638),u=e(77855),g=e(20708);class o{constructor(h,D=!0){this.parseListOptionsSelector=f;const C=D?`namespaces/${(0,u.G)()}/`:"";this.url=`/apis/${h.group}/${h.version}/${C}${h.resource}`}async get(h){return(0,s.AI)().get(`${this.url}/${h}`)}watch(h,D){const C=new TextDecoder,{name:l,...v}=h??{},y={...v,watch:!0,labelSelector:this.parseListOptionsSelector(h?.labelSelector),fieldSelector:this.parseListOptionsSelector(h?.fieldSelector)};return l&&(y.fieldSelector=`metadata.name=${l}`),(0,s.AI)().chunked({url:this.url,params:y,...D}).pipe((0,t.p)(P=>P.ok&&P.data instanceof Uint8Array),(0,n.T)(P=>C.decode(P.data).split(`
`)),(0,r.Z)(P=>(0,a.H)(P)),(0,t.p)(P=>P.length>0),(0,n.T)(P=>{try{return JSON.parse(P)}catch(b){return console.warn("Invalid JSON in watch stream:",b),null}}),(0,t.p)(P=>P!==null),(0,i.L)({count:3,delay:1e3}),(0,x.W)(P=>{throw console.error("Watch stream error:",P),P}))}async subresource(h,D){return(0,s.AI)().get(`${this.url}/${h}/${D}`)}async list(h){const D=h||{};return D.labelSelector=this.parseListOptionsSelector(D?.labelSelector),D.fieldSelector=this.parseListOptionsSelector(D?.fieldSelector),(0,s.AI)().get(this.url,h)}async create(h){if(!h.metadata.name&&!h.metadata.generateName){const D=d.TP.user.login;h.metadata.generateName=D?D.slice(0,2):"g"}return E(h.metadata),(0,s.AI)().post(this.url,h)}async update(h){return E(h.metadata),(0,s.AI)().put(`${this.url}/${h.metadata.name}`,h)}async delete(h,D){return(0,s.AI)().delete(`${this.url}/${h}`,void 0,{showSuccessAlert:D})}}function E(p){p.annotations||(p.annotations={}),p.annotations[g.Pd]=c.$.buildInfo.versionString}class m{async get(h){if(this.apiVersions)return this.apiVersions[h];const D=await(0,s.AI)().get("/apis"),C={};return D.groups.forEach(l=>{if(l.name.includes("datasource.grafana.app")){const v=l.name.split(".")[0];C[v]=l.preferredVersion.version,v.endsWith("-datasource")||(v.includes("-")?C[`${v}-datasource`]=l.preferredVersion.version:C[`grafana-${v}-datasource`]=l.preferredVersion.version)}}),this.apiVersions=C,C[h]}}const f=p=>Array.isArray(p)?p.map(h=>{const D=String(h.key),C=h.operator;switch(C){case"=":case"!=":return`${D}${C}${h.value}`;case"in":case"notin":return`${D} ${C} (${h.value.join(",")})`;case"":case"!":return`${C}${D}`;default:return null}}).filter(Boolean).join(","):p},20708:(q,j,e)=>{"use strict";e.d(j,{D1:()=>s,Pd:()=>m,Qu:()=>r,UL:()=>h,Y5:()=>C,ew:()=>a,fY:()=>c,hX:()=>d,hc:()=>t,hm:()=>D,nB:()=>x,qw:()=>p,w2:()=>i,xU:()=>n});const t="grafana.app/createdBy",n="grafana.app/updatedTimestamp",r="grafana.app/updatedBy",a="grafana.app/folder",i="grafana.app/folderTitle",x="grafana.app/folderId",s="grafana.app/folderUrl",c="grafana.app/message",d="grafana.app/slug",u="grafana.app/repoName",g="grafana.app/repoPath",o="grafana.app/repoHash",E="grafana.app/repoTimestamp",m="grafana.app/saved-from-ui",f="grafana.app/dashboard-not-found",p="grafana.app/dashboard-is-snapshot",h="grafana.app/dashboard-snapshot-original-url",D="grafana.app/dashboard-gnet-id",C="grafana.app/deprecatedInternalID"},4545:(q,j,e)=>{"use strict";e.d(j,{getAuthProviderStatus:()=>g,getRegisteredAuthProviders:()=>c,initAuthConfig:()=>o});var t=e(88023),n=e(87638),r=e(75911),a=e(61491);const i=[],x={};function s(m,f){i.find(p=>p.id===m.id)||(i.push(m),f&&(x[m.id]=f))}function c(){return i}function d(m){return i.find(f=>f.id===m)}function u(m){const f=[];for(const[p,h]of Object.entries(m)){const D=i.find(C=>`auth.${C.id}`===p);if(D){const C={...h,providerId:D.id,displayName:h.name||D.displayName};f.push(C)}}return f}async function g(m){if(x[m]){const f=x[m];return f()}return{configured:!1,enabled:!1}}function o(){if(t.Ay.featureToggles.ssoSettingsApi&&t.Ay.featureToggles.ssoSettingsLDAP)return;s({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},E)}async function E(){if(n.TP.hasPermission(a.AccessControlAction.SettingsRead)){const f=(await(0,r.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:f.enabled==="true",enabled:f.enabled==="true",hide:f.enabled!=="true"}}return{configured:!1,enabled:!1}}},33790:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>m,MH:()=>s,Nh:()=>c,Oy:()=>o,SH:()=>d,TO:()=>i,jA:()=>a,sr:()=>x});var t=e(65307);const n={settings:{},providerStatuses:{},isLoading:!1,providers:[]},r=(0,t.Z0)({name:"authConfig",initialState:n,reducers:{settingsUpdated:(f,p)=>({...f,settings:p.payload}),providerStatusesLoaded:(f,p)=>({...f,providerStatuses:p.payload}),loadingBegin:f=>({...f,isLoading:!0}),loadingEnd:f=>({...f,isLoading:!1}),setError:(f,p)=>({...f,updateError:p.payload}),resetError:f=>({...f,updateError:void 0}),setWarning:(f,p)=>({...f,warning:p.payload}),resetWarning:f=>({...f,warning:void 0}),providersLoaded:(f,p)=>({...f,providers:p.payload})}}),{settingsUpdated:a,providerStatusesLoaded:i,loadingBegin:x,loadingEnd:s,setError:c,resetError:d,setWarning:u,resetWarning:g,providersLoaded:o}=r.actions,m={authConfig:r.reducer}},15664:(q,j,e)=>{"use strict";e.d(j,{D$:()=>B,G2:()=>y,Ko:()=>l,Vc:()=>M,aF:()=>b,cU:()=>D,e8:()=>O,hT:()=>h.hT,iB:()=>R,kH:()=>P,uz:()=>v,vR:()=>L,vZ:()=>C,wt:()=>S});var t=e(75816),n=e(8392),r=e(52718),a=e(2567),i=e(28082),x=e(32370),s=e(53027),c=e(31226),d=e(22492),u=e(87638),g=e(15543),o=e(66952),E=e(10474),m=e(11817),f=e(86843),p=e(86865),h=e(10378);const D=(0,t.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:(0,c.W)({baseURL:"/api"}),endpoints:F=>({listFolders:F.query({providesTags:I=>I&&I.length>0?I.map(U=>({type:"getFolder",id:U.uid})):[{type:"getFolder",id:"EMPTY_RESULT"}],query:({parentUid:I,limit:U,page:W,permission:A})=>({url:"/folders",params:{parentUid:I,limit:U,page:W,permission:A}})}),getFolder:F.query({providesTags:(I,U,W)=>[{type:"getFolder",id:W}],query:I=>({url:`/folders/${I}`,params:{accesscontrol:!0}})}),newFolder:F.mutation({invalidatesTags:["getFolder"],query:({title:I,parentUid:U})=>({method:"POST",url:"/folders",body:{title:I,parentUid:U}}),onQueryStarted:({parentUid:I},{queryFulfilled:U,dispatch:W})=>{U.then(async({data:A})=>{await u.TP.fetchUserPermissions(),W((0,f.bw)({parentUID:I,pageSize:p.md}))})}}),saveFolder:F.mutation({invalidatesTags:["getFolder"],query:({uid:I,title:U,version:W})=>({method:"PUT",url:`/folders/${I}`,body:{title:U,version:W}}),onQueryStarted:({parentUid:I},{queryFulfilled:U,dispatch:W})=>{U.then(()=>{W((0,f.bw)({parentUID:I,pageSize:p.md}))})}}),moveFolder:F.mutation({invalidatesTags:["getFolder"],query:({folder:I,destinationUID:U})=>({url:`/folders/${I.uid}/move`,method:"POST",body:{parentUID:U}}),onQueryStarted:({folder:I,destinationUID:U},{queryFulfilled:W,dispatch:A})=>{const{parentUid:N}=I;W.then(()=>{A((0,f.bw)({parentUID:N,pageSize:p.md})),A((0,f.bw)({parentUID:U,pageSize:p.md}))})}}),deleteFolder:F.mutation({query:({uid:I})=>({url:`/folders/${I}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:I},{queryFulfilled:U,dispatch:W})=>{U.then(()=>{W((0,f.bw)({parentUID:I,pageSize:p.md}))})}}),getAffectedItems:F.query({keepUnusedDataFor:0,queryFn:async I=>{const W=Object.keys(I.folder).filter(K=>I.folder[K]).map(K=>(0,i.AI)().get(`/api/folders/${K}/counts`)),A=await Promise.all(W),N={folder:Object.values(I.folder).filter(n.zz).length,dashboard:Object.values(I.dashboard).filter(n.zz).length,libraryPanel:0,alertRule:0};for(const K of A)N.folder+=K.folder??0,N.dashboard+=K.dashboard,N.alertRule+=K.alertrule,N.libraryPanel+=K.librarypanel;return{data:N}}}),moveItems:F.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:I,destinationUID:U},W,A,N)=>{const K=Object.keys(I.dashboard).filter(T=>I.dashboard[T]),V=Object.keys(I.folder).filter(T=>I.folder[T]);for(const T of V)await N({url:`/folders/${T}/move`,method:"POST",body:{parentUID:U}});for(const T of K)if(x.$.featureToggles.useV2DashboardsAPI){const z=await(0,g.n)("v2").getDashboardDTO(T);await(0,g.n)("v2").saveDashboard({dashboard:z.spec,folderUid:U,overwrite:!1,message:"",k8s:z.metadata})}else{const z=await(0,g.n)().getDashboardDTO(T);await(0,g.n)().saveDashboard({dashboard:z.dashboard,folderUid:U,overwrite:!1,message:""})}return{data:void 0}},onQueryStarted:({destinationUID:I,selectedItems:U},{queryFulfilled:W,dispatch:A})=>{const N=Object.keys(U.dashboard).filter(V=>U.dashboard[V]),K=Object.keys(U.folder).filter(V=>U.folder[V]);W.then(()=>{A((0,f.bw)({parentUID:I,pageSize:p.md})),A((0,f.Zw)([...K,...N]))})}}),deleteItems:F.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:I},U,W,A)=>{const N=Object.keys(I.dashboard).filter(V=>I.dashboard[V]),K=Object.keys(I.folder).filter(V=>I.folder[V]);for(const V of K)await A({url:`/folders/${V}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const V of N){const T=await(0,g.n)().deleteDashboard(V,!0);if(x.$.featureToggles.dashboardRestore){const z=T?.title;if(z){const w=x.$.featureToggles.useV2DashboardsAPI||x.$.featureToggles.kubernetesDashboards?["Dashboard moved to Recently deleted"]:[(0,m.t)("browse-dashboards.soft-delete.success","Dashboard {{name}} moved to Recently deleted",{name:z})];d.A.publish({type:r.r1.alertSuccess.name,payload:w})}}else(x.$.featureToggles.useV2DashboardsAPI||x.$.featureToggles.kubernetesDashboards)&&d.A.publish({type:r.r1.alertSuccess.name,payload:["Dashboard deleted"]})}return{data:void 0}},onQueryStarted:({selectedItems:I},{queryFulfilled:U,dispatch:W})=>{const A=Object.keys(I.dashboard).filter(K=>I.dashboard[K]),N=Object.keys(I.folder).filter(K=>I.folder[K]);U.then(()=>{W((0,f.Zw)([...N,...A]))})}}),saveDashboard:F.mutation({queryFn:async I=>{try{if(x.$.featureToggles.useV2DashboardsAPI&&(0,o.mi)(I))return{data:await(0,g.n)("v2").saveDashboard(I)};if((0,o.rL)(I))return{data:await(0,g.n)().saveDashboard(I)};throw new Error("Invalid dashboard version")}catch(U){return(0,c.s)(U)}},onQueryStarted:({folderUid:I},{queryFulfilled:U,dispatch:W})=>{E.t.ignoreNextSave(),U.then(async()=>{await u.TP.fetchUserPermissions(),W((0,f.bw)({parentUID:I,pageSize:p.md}))})}}),importDashboard:F.mutation({query:({dashboard:I,overwrite:U,inputs:W,folderUid:A})=>({method:"POST",url:"/dashboards/import",body:{dashboard:I,overwrite:U,inputs:W,folderUid:A}}),onQueryStarted:({folderUid:I},{queryFulfilled:U,dispatch:W})=>{U.then(async A=>{W((0,f.bw)({parentUID:I,pageSize:p.md}));const N=a.I.stripBaseFromUrl(A.data.importedUrl);s.Ny.push(N)})}}),restoreDashboard:F.mutation({query:({dashboardUID:I,targetFolderUID:U})=>({url:`/dashboards/uid/${I}/trash`,body:{folderUid:U},method:"PATCH"})}),hardDeleteDashboard:F.mutation({queryFn:async({dashboardUID:I},U,W,A)=>{const K=(await A({url:`/dashboards/uid/${I}/trash`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;return K&&d.A.publish({type:r.r1.alertSuccess.name,payload:[(0,m.t)("browse-dashboards.hard-delete.success","Dashboard {{name}} deleted",{name:K})]}),{data:void 0}},onQueryStarted:({dashboardUID:I},{queryFulfilled:U,dispatch:W})=>{U.then(()=>{W((0,f.Zw)([I]))})}})})}),{endpoints:C,useDeleteFolderMutation:l,useDeleteItemsMutation:v,useGetAffectedItemsQuery:y,useGetFolderQuery:P,useMoveFolderMutation:b,useMoveItemsMutation:S,useNewFolderMutation:M,useSaveDashboardMutation:O,useSaveFolderMutation:R,useRestoreDashboardMutation:L,useHardDeleteDashboardMutation:B}=D},86865:(q,j,e)=>{"use strict";e.d(j,{aw:()=>g,md:()=>d,uT:()=>u});var t=e(32370),n=e(28082),r=e(93719),a=e(92914),i=e(1167),x=e(87638),s=e(61491),c=e(23758);const d=50;async function u(o,E,m=1,f=d){if(o&&!t.$.featureToggles.nestedFolders)return[];const p=(0,n.AI)();let h=[];return x.TP.hasPermission(s.AccessControlAction.FoldersRead)&&(h=await p.get("/api/folders",{parentUid:o,page:m,limit:f})),h.map(D=>({kind:"folder",uid:D.uid,title:D.title,parentTitle:E,parentUID:o,url:(0,c.I2)(D.uid)?void 0:(0,c._0)(D.uid)}))}async function g(o,E=1,m=d){const p=await(0,a.S)().search({kind:["dashboard"],query:"*",location:o||"general",from:(E-1)*m,limit:m});return p.view.map(h=>{const D=(0,i.hI)(h,p.view);return D.parentUID===r.TF&&(D.parentUID=void 0),D})}},97204:(q,j,e)=>{"use strict";e.d(j,{x:()=>c});var t=e(74848),n=e(70255),r=e(37e3),a=e(45565),i=e(15664),x=e(11817);function s(d,u,g,o){const E=d+u+g+o,m=[];d&&m.push((0,x.t)("browse-dashboards.counts.folder","{{count}} folder",{count:d})),u&&m.push((0,x.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:u})),g&&m.push((0,x.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:g})),o&&m.push((0,x.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:o}));let f=(0,x.t)("browse-dashboards.counts.total","{{count}} item",{count:E});return m.length>0&&(f+=`: ${m.join(", ")}`),f}const c=({selectedItems:d})=>{const{data:u,isFetching:g,isLoading:o,error:E}=(0,i.G2)(d);return E?(0,t.jsx)(r.F,{severity:"error",title:"Unable to retrieve descendant information"}):(0,t.jsxs)(a.E,{element:"p",color:"secondary",children:[u&&s(u.folder,u.dashboard,u.libraryPanel,u.alertRule),(g||o)&&(0,t.jsx)(n.A,{width:200})]})}},23758:(q,j,e)=>{"use strict";e.d(j,{I2:()=>a,_0:()=>i,eM:()=>r});var t=e(32370),n=e(87638);function r(x,s){return x+s.uid}function a(x){return x===t.$.sharedWithMeFolderUID}function i(x){const{orgId:s}=n.TP.user,d=`${t.$.appSubUrl??""}/dashboards/f/${x}/`;return s?`${d}?orgId=${s}`:d}},10655:(q,j,e)=>{"use strict";e.d(j,{Ii:()=>s,Zw:()=>i,bw:()=>x});var t=e(93719),n=e(61491),r=e(86865),a=e(5741);const i=(0,n.createAsyncThunk)("browseDashboards/refreshParents",async(c,{getState:d,dispatch:u})=>{const{browseDashboards:g}=d(),{rootItems:o,childrenByParentUID:E}=g,m=new Set;for(const f of c){const p=(0,a.R)(o?.items??[],E,f);m.add(p?.parentUID)}for(const f of m)u(x({parentUID:f,pageSize:r.md}))}),x=(0,n.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:c,pageSize:d})=>{const u=c===t.TF?void 0:c;let g=1,o="folder",E=await(0,r.uT)(u,void 0,g,d),m=E.length<d;if(o==="folder"&&m){o="dashboard",g=1;const f=await(0,r.aw)(u,g,d);m=f.length<d,E=E.concat(f)}return{children:E,lastPageOfKind:m,page:g,kind:o}}),s=(0,n.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:c,excludeKinds:d=[],pageSize:u},g)=>{const o=!d.includes("dashboard"),E=c===t.TF?void 0:c,m=g.getState().browseDashboards,f=E?m.childrenByParentUID[E]:m.rootItems;let p=1,h;if(f?f.lastFetchedKind==="dashboard"&&!f.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${E} but that collection is fully loaded`):f.lastFetchedKind==="folder"&&f.lastKindHasMoreItems?(p=f.lastFetchedPage+1,h="folder"):o&&(p=f.lastFetchedKind==="folder"?1:f.lastFetchedPage+1,h="dashboard"):(p=1,h="folder"),!h)return;let D=h==="folder"?await(0,r.uT)(E,void 0,p,u):await(0,r.aw)(E,p,u),C=D.length<u;if(h==="folder"&&C&&o){h="dashboard",p=1;const l=await(0,r.aw)(E,p,u);C=l.length<u,D=D.concat(l)}return{children:D,lastPageOfKind:C,page:p,kind:h}})},86843:(q,j,e)=>{"use strict";e.d(j,{Am:()=>u,xN:()=>t.xN,Ii:()=>n.Ii,bw:()=>n.bw,Zw:()=>n.Zw,ku:()=>d,cT:()=>t.cT,wn:()=>t.wn,t$:()=>t.t$,xK:()=>v,eC:()=>p,Ms:()=>C,V6:()=>l,q0:()=>h,QE:()=>D,Zg:()=>y});var t=e(41900),n=e(10655),r=e(96540),a=e(25508),i=e(61491),x=e(86865),s=e(23758),c=e(5741);const d=b=>b.browseDashboards.rootItems,u=b=>b.browseDashboards.childrenByParentUID,g=b=>b.browseDashboards.openFolders,o=b=>b.browseDashboards.selectedItems,E=(0,a.Mz)(d,u,g,(b,S)=>S,(b,S,M,O)=>P(O,b,S,M)),m=(0,a.Mz)(o,b=>Object.values(b).some(S=>Object.values(S).some(M=>M))),f=(0,a.Mz)(o,u,(b,S)=>{const M={dashboard:{...b.dashboard},folder:{...b.folder}};for(const O of Object.keys(b.folder))if(b.folder[O]){const L=S[O];if(L)for(const B of L.items)B.kind==="dashboard"&&(M.dashboard[B.uid]=!1),B.kind==="folder"&&(M.folder[B.uid]=!1)}return M});function p(b){return(0,i.useSelector)(S=>(b?S.browseDashboards.childrenByParentUID[b]:S.browseDashboards.rootItems)?"fulfilled":"pending")}function h(b){return(0,i.useSelector)(S=>E(S,b))}function D(){return(0,i.useSelector)(b=>m(b))}function C(){return(0,i.useSelector)(o)}function l(){return(0,i.useSelector)(b=>b.browseDashboards.childrenByParentUID)}function v(){return(0,i.useSelector)(b=>f(b))}function y(b=[]){const S=(0,i.useDispatch)(),M=(0,r.useRef)(!1);return(0,r.useCallback)(R=>{if(M.current)return Promise.resolve();M.current=!0;const L=S((0,n.Ii)({parentUID:R,excludeKinds:b,pageSize:x.md}));return L.finally(()=>M.current=!1),L},[S,b])}function P(b,S,M,O,R=0,L=[],B=[]){function F(V,T,z){if(L.includes(V.kind)||B.includes(V.uid))return[];const w=P(V.uid,S,M,O,z+1,L,B),H=!!O[V.uid],G=M[V.uid]?.items.length===0;H&&G&&!L.includes("empty-folder")&&w.push({isOpen:!1,level:z+1,item:{kind:"ui",uiKind:"empty-folder",uid:V.uid+"empty-folder"},parentUID:T});const X={item:V,parentUID:T,level:z,isOpen:H},k=[X,...w];return(0,s.I2)(X.item.uid)&&k.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:T,level:z+1,isOpen:!1}),k}const I=b&&O[b]||R===0,U=b?M[b]:S;let A=((b?I&&U?.items:U?.items)||[]).flatMap(V=>F(V,b,R));const N=L.includes("dashboard")&&U?.lastFetchedKind==="dashboard";return(R===0&&!U||I&&U&&!(U.isFullyLoaded||N))&&(A=A.concat((0,c.T)(x.md,b,R))),A}},41900:(q,j,e)=>{"use strict";e.d(j,{xN:()=>v,Ay:()=>y,cT:()=>l,wn:()=>D,t$:()=>C});var t={};e.r(t),e.d(t,{clearFolders:()=>g,fetchNextChildrenPageFulfilled:()=>s,refetchChildrenFulfilled:()=>x,setAllSelection:()=>u,setFolderOpenState:()=>c,setItemSelectionState:()=>d});var n=e(65307),r=e(10655),a=e(23758),i=e(5741);function x(P,b){const{children:S,page:M,kind:O,lastPageOfKind:R}=b.payload,{parentUID:L}=b.meta.arg,B={items:S,lastFetchedKind:O,lastFetchedPage:M,lastKindHasMoreItems:!R,isFullyLoaded:O==="dashboard"&&R};L?P.childrenByParentUID[L]=B:P.rootItems=B}function s(P,b){const S=b.payload;if(!S)return;const{children:M,page:O,kind:R,lastPageOfKind:L}=S,{parentUID:B,excludeKinds:F=[]}=b.meta.arg,W={items:((B?P.childrenByParentUID[B]:P.rootItems)?.items??[]).concat(M),lastFetchedKind:R,lastFetchedPage:O,lastKindHasMoreItems:!L,isFullyLoaded:(F.includes("dashboard")||R==="dashboard")&&L};if(!B){P.rootItems=W;return}if(P.childrenByParentUID[B]=W,P.selectedItems.folder[B])for(const N of M)P.selectedItems[N.kind][N.uid]=!0}function c(P,b){const{folderUID:S,isOpen:M}=b.payload;P.openFolders[S]=M}function d(P,b){const{item:S,isSelected:M}=b.payload;if((0,a.I2)(S.uid))return;function O(R,L){if(P.selectedItems[R][L]=M,R!=="folder")return;let B=P.childrenByParentUID[L];for(const F of B?.items??[])O(F.kind,F.uid)}if(O(S.kind,S.uid),!M){let R=S.parentUID;for(;R;){const L=(0,i.R)(P.rootItems?.items??[],P.childrenByParentUID,R);if(!L)break;P.selectedItems[L.kind][L.uid]=!1,R=L.parentUID}}P.selectedItems.$all=P.rootItems?.items?.every(R=>P.selectedItems[R.kind][R.uid])??!1}function u(P,b){const{isSelected:S,folderUID:M}=b.payload;if(!(M&&(0,a.I2)(M)))if(P.selectedItems.$all=S,S){let R=function(L){if(L&&(0,a.I2)(L))return;const B=L?P.childrenByParentUID[L]:P.rootItems;if(B)for(const F of B.items)(0,a.I2)(F.uid)||(P.selectedItems[F.kind][F.uid]=S,F.kind==="folder"&&R(F.uid))};var O=R;R(M)}else for(const R in P.selectedItems){if(!(R==="dashboard"||R==="panel"||R==="folder"))continue;const L=P.selectedItems[R];for(const B in L)L[B]=S}}function g(P,b){const S=Array.isArray(b.payload)?b.payload:[b.payload];for(const M of S)M?(P.childrenByParentUID[M]=void 0,P.openFolders[M]=!1):P.rootItems=void 0}const{fetchNextChildrenPageFulfilled:o,refetchChildrenFulfilled:E,...m}=t,f={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},p=(0,n.Z0)({name:"browseDashboards",initialState:f,reducers:m,extraReducers:P=>{P.addCase(r.Ii.fulfilled,o),P.addCase(r.bw.fulfilled,E)}}),h=p.reducer,{setFolderOpenState:D,setItemSelectionState:C,setAllSelection:l,clearFolders:v}=p.actions,y={browseDashboards:h}},5741:(q,j,e)=>{"use strict";e.d(j,{R:()=>t,T:()=>n});function t(r,a,i){for(const x of r)if(x.uid===i)return x;for(const x in a){const s=a[x];if(s){for(const c of s.items)if(c.uid===i)return c}}}function n(r,a,i){return new Array(r).fill(null).map((x,s)=>({parentUID:a,level:i,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${a}-pagination-${s}`}}))}},61674:(q,j,e)=>{"use strict";e.d(j,{b:()=>n,q:()=>t});const t="connections",n={Base:`/${t}`,DataSources:`/${t}/datasources`,DataSourcesNew:`/${t}/datasources/new`,DataSourcesEdit:`/${t}/datasources/edit/:uid`,DataSourcesDashboards:`/${t}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${t}/add-new-connection`,DataSourcesDetails:`/${t}/datasources/:id`,ConnectDataOutdated:`/${t}/connect-data`,YourConnectionsOutdated:`/${t}/your-connections`}},44853:(q,j,e)=>{"use strict";e.d(j,{k:()=>i});var t=e(60455),n=e.n(t),r=e(47180),a=e(95536);const i=(x,s,c)=>{let d={},u={};if(x.type===r.CC.Regex&&x.expression){const g=new RegExp(x.expression,"gi"),E=(typeof s=="string"?s:(0,a.MA)(s)).matchAll(g);for(const m of E)m.groups?u=m.groups:u[x.mapValue||c]=m[1]||m[0]}else x.type===r.CC.Logfmt&&(u=n().parse(s));return Object.keys(u).forEach(g=>{const o=typeof u[g]=="string"?u[g]:(0,a.MA)(u[g]);d[g]={value:o}}),d}},24609:(q,j,e)=>{"use strict";e.d(j,{F0:()=>c,bQ:()=>d,lW:()=>u});var t=e(41053),n=e(75505),r=e(98437),a=e(95382),i=e(3930);const x=({sourceUID:g,...o})=>{const E=(0,r.l)().getInstanceSettings(g),m=o.type==="query"?(0,r.l)().getInstanceSettings(o.targetUID):void 0;if((o?.orgId===void 0||o?.orgId===null||o?.orgId===0)&&i.kb.logWarning("Invalid correlation config: Missing org id."),E&&E?.uid!==void 0&&m?.uid!==void 0&&o.type==="query")return{...o,source:E,target:m};if(E&&E?.uid!==void 0&&m?.uid===void 0&&o.type==="external")return{...o,source:E};i.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(E),target:JSON.stringify(m)})},s=g=>!!g,c=g=>({...g,correlations:g.correlations.map(x).filter(s)});function d(g){return g.data}const u=()=>{const{backend:g}=(0,a.Il)(),[o,E]=(0,t.A)(l=>(0,n.s)(g.fetch({url:"/api/datasources/correlations",params:{page:l.page},method:"GET",showErrorAlert:!1})).then(d).then(c),[g]),[m,f]=(0,t.A)(({sourceUID:l,...v})=>g.post(`/api/datasources/uid/${l}/correlations`,v).then(y=>{const P=x(y.result);if(P!==void 0)return P;throw new Error("invalid sourceUID")}),[g]),[p,h]=(0,t.A)(({sourceUID:l,uid:v})=>g.delete(`/api/datasources/uid/${l}/correlations/${v}`),[g]),[D,C]=(0,t.A)(({sourceUID:l,uid:v,...y})=>g.patch(`/api/datasources/uid/${l}/correlations/${v}`,y).then(P=>{const b=x(P.result);if(b!==void 0)return b;throw new Error("invalid sourceUID")}),[g]);return{create:{execute:f,...m},update:{execute:C,...D},get:{execute:E,...o},remove:{execute:h,...p}}}},3930:(q,j,e)=>{"use strict";e.d(j,{$q:()=>m,J6:()=>E,cA:()=>u,kb:()=>h,tZ:()=>p});var t=e(75505),n=e(47180),r=e(32370),a=e(28082),i=e(98437),x=e(18729),s=e(83605),c=e(33504),d=e(24609);const u=(D,C,l)=>(D.forEach(v=>{const y=v.refId;if(!y)return;let P=l[y];if(P===void 0&&v.meta?.preferredVisualisationType==="rawPrometheus"){const S=(0,s.a)(y);P=l[S]}const b=C.filter(S=>S.source.uid===P);g(v,o(b,v))}),D),g=(D,C)=>{D.fields.forEach(l=>{l.config.links=l.config.links?.filter(v=>v.origin!==n.x0.Correlations)||[],C.map(v=>{if(v.config.field===l.name){if(v.type==="query"){const y=v.config.target||{};l.config.links.push({internal:{query:{...y,datasource:{uid:v.target.uid}},datasourceUid:v.target.uid,datasourceName:v.target.name},url:"",title:v.label||v.target.name,origin:n.x0.Correlations,meta:{transformations:v.config.transformations}})}else if(v.type==="external"){const y=v.config.target;l.config.links.push({url:y.url,title:v.label||"External URL",origin:n.x0.Correlations,meta:{transformations:v.config?.transformations}})}}})})},o=(D,C)=>D.map(l=>{if(l.source.meta?.id==="loki"&&r.$.featureToggles.lokiLogsDataplane===!0&&l.config.field==="Line"){const v=(0,c.Os)(C);v!=null&&v.bodyField.name!==void 0&&(l.config.field=v?.bodyField.name)}return l}),E=async D=>(0,t.s)((0,a.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:D}})).then(d.bQ).then(d.F0),m=async(D,C)=>(0,a.AI)().post(`/api/datasources/uid/${D}/correlations`,C),f=async D=>D.datasourceInstance?.meta.mixed?await(0,i.l)().get(D.queries[0].datasource):D.datasourceInstance,p=async(D,C)=>Promise.all([f(D),f(C)]).then(l=>l[0]?.name!==void 0&&l[1]?.name!==void 0?`${l[0]?.name} to ${l[1]?.name}`:""),h=(0,x.DW)("features.correlations")},4981:(q,j,e)=>{"use strict";e.d(j,{U:()=>x});var t=e(61034),n=e(82856),r=e(36503),a=e(61491),i=e(47506);function x(s){const c=n.A.getObject(a.DASHBOARD_FROM_LS_KEY);if(c){console.log("asd",c);const d=new r.G(c.dashboard);for(const u of d.panels){const g=(0,i.tt)(u);s.addPanel(g.state.body)}if(c.dashboard.time){const u=new t.JZ({from:c.dashboard.time.from,to:c.dashboard.time.to}),g=s.state.$timeRange;g&&g.setState({value:u.state.value,from:u.state.from,to:u.state.to})}}n.A.delete(a.DASHBOARD_FROM_LS_KEY)}},71020:(q,j,e)=>{"use strict";e.d(j,{d:()=>n});var t=e(88544);function n(){return(0,t.A)("grafana.dashboards.edit-pane.isCollapsed",!1)}},48806:(q,j,e)=>{"use strict";e.d(j,{W:()=>r});var t=e(63739);function n(){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="abcdefghijklmnopqrstuvwxyz",x=a.length,s=new Map;return c=>{const d=s.get(c);if(d!=null)return d;const u=[...c].map(g=>g.toLowerCase()&&g!==g.toUpperCase()?i.charAt(Math.floor(Math.random()*x)):g.toUpperCase()&&g!==g.toUpperCase()?a.charAt(Math.floor(Math.random()*x)):g).join("");return s.set(c,u),u}}function r(a,i){if(!(i.labels||i.names||i.values))return a;const x=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),s=n();return a.map(c=>{let{schema:d,data:u}=c;if(d&&u){if(i.labels){for(const g of d.fields)if(g.labels){const o={};for(const[E,m]of Object.entries(g.labels))o[E]=s(m);g.labels=o}}if(i.names)for(const g of d.fields)g.name?.length&&!x.has(g.name.toLowerCase())&&(g.name=s(g.name));i.values&&d.fields.forEach((g,o)=>{if(g.type===t.PU.string&&u){const E=u.values[o].map(m=>s(String(m)));u.values[o]=E}})}return{schema:d,data:u}})}},44172:(q,j,e)=>{"use strict";e.d(j,{m6:()=>le,sP:()=>Pe});var t=e(2543),n=e(2567),r=e(32370),a=e(28082),i=e(53027),x=e(61034),s=e(5761),c=e(44608),d=e(36314),u=e(20708),g=e(5174),o=e(66952),E=e(55227),m=e(16910),f=e(94038),p=e(68131),h=e(61491),D=e(25202),C=e(98437),l=e(46004),v=e(5956),y=e(4981),P=e(62652),b=e(51085),S=e(7001),M=e(79938),O=e(65302),R=e(12035),L=e(11997),B=e(60887),F=e(79556),I=e(2044),U=e(85388),W=e(60543),A=e(47506),N=e(97910),K=e(32815);const V="default";function T(Ee){const{spec:be,metadata:Se}=Ee,Xe=be.annotations.map(Ge=>new P.g({key:(0,t.uniqueId)("annotations-"),query:{...Ge.spec,builtIn:Ge.spec.builtIn?1:0},name:Ge.spec.name,isEnabled:!!Ge.spec.enable,isHidden:!!Ge.spec.hide})),Qe=!!be.editable,we=Ee.access.canSave!==!1;let $e;Se.labels?.[u.Y5]&&($e=parseInt(Se.labels[u.Y5],10));const Fe={canShare:Ee.access.canShare!==!1,canSave:we,canStar:Ee.access.canStar!==!1,canEdit:Ee.access.canEdit!==!1,canDelete:Ee.access.canDelete!==!1,canAdmin:Ee.access.canAdmin!==!1,url:Ee.access.url,slug:Ee.access.slug,annotationsPermissions:Ee.access.annotationsPermissions,created:Se.creationTimestamp,createdBy:Se.annotations?.[u.hc],updated:Se.annotations?.[u.xU],updatedBy:Se.annotations?.[u.Qu],folderUid:Se.annotations?.[u.ew],isSnapshot:!!Se.annotations?.[u.qw],showSettings:!!Ee.access.canEdit,canMakeEditable:we&&!Qe,hasUnsavedFolderChange:!1,version:parseInt(Se.resourceVersion,10),k8s:Se};Qe||(Fe.canEdit=!1,Fe.canDelete=!1,Fe.canSave=!1);const Te=W.O.get(be.layout.kind).serializer.deserialize(be.layout,be.elements,be.preload),Le=new L.H$({description:be.description,editable:be.editable,preload:be.preload,id:$e,isDirty:!1,links:be.links,meta:Fe,tags:be.tags,title:be.title,uid:Se.name,version:parseInt(Se.resourceVersion,10),body:Te,$timeRange:new x.JZ({from:be.timeSettings.from,to:be.timeSettings.to,fiscalYearStartMonth:be.timeSettings.fiscalYearStartMonth,timeZone:be.timeSettings.timezone,weekStart:be.timeSettings.weekStart,UNSAFE_nowDelay:be.timeSettings.nowDelay}),$variables:G(be,Fe.isSnapshot??!1),$behaviors:[new x.Gg.K2({sync:(0,N.Y_)(be.cursorSync)}),new x.Gg.Hf,O.M,A.A2,new x.Gg.en({enabled:be.liveNow}),F.zf,y.U,new B.m({reloadOnParamsChange:r.$.featureToggles.reloadDashboardsOnParamsChange,uid:$e?.toString()}),new R.s({reloadOnParamsChange:r.$.featureToggles.reloadDashboardsOnParamsChange,uid:$e?.toString(),version:1})],$data:new S.s({annotationLayers:Xe}),controls:new b.x({variableControls:[new x.K8({}),new x.i7],timePicker:new x.KE({}),refreshPicker:new x.WM({refresh:be.timeSettings.autoRefresh,intervals:be.timeSettings.autoRefreshIntervals,withText:!0}),hideTimeControls:be.timeSettings.hideTimepicker})});return Le.setInitialSaveModel(Ee.spec,Ee.metadata),Le}function z(Ee){if(!Ee.spec.data?.spec.queries?.length)return;let be,Se=!1;return Ee.spec.data.spec.queries.forEach(Xe=>{be?(be.uid!==Xe.spec.datasource?.uid||be.type!==Xe.spec.datasource?.type)&&(Se=!0):be=Xe.spec.datasource}),Se?{type:"mixed",uid:MIXED_DATASOURCE_NAME}:be}function w(Ee){return{refId:Ee.spec.refId,datasource:Ee.spec.datasource,hide:Ee.spec.hidden,...Ee.spec.query.spec}}function H(Ee){const be=Ee.spec,Se=be.data?.spec.queries??[];if(!Se?.length||config.panels[be.vizConfig.kind]?.skipDataQuery)return;let Xe;const Qe=z(Ee);return Xe=new SceneQueryRunner({datasource:Qe,queries:Se.map(w),maxDataPoints:be.data.spec.queryOptions.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:be.data.spec.queryOptions.cacheTimeout,queryCachingTTL:be.data.spec.queryOptions.queryCachingTTL,minInterval:be.data.spec.queryOptions.interval??void 0,dataLayerFilter:{panelId:be.id},$behaviors:[new DashboardDatasourceBehaviour({})]}),new SceneDataTransformer({$data:Xe,transformations:be.data.spec.transformations.map(we=>we.spec)})}function G(Ee,be){let Se;return Ee.variables.length?be?Se=J(Ee):Se=X(Ee):Se=new x.Pj({variables:[]}),Se}function X(Ee){const be=Ee.variables.map(Se=>{try{return k(Se)}catch(Xe){return console.error(Xe),null}}).filter(Se=>!!Se);return new x.Pj({variables:be})}function k(Ee){const be={name:Ee.spec.name,label:Ee.spec.label,description:Ee.spec.description};if(Ee.kind===(0,l.l_)().kind)return new x.H9({...be,description:Ee.spec.description,skipUrlSync:Ee.spec.skipUrlSync,hide:(0,N.cc)(Ee.spec.hide),datasource:Ee.spec.datasource,applyMode:"auto",filters:Ee.spec.filters??[],baseFilters:Ee.spec.baseFilters??[],defaultKeys:Ee.spec.defaultKeys,useQueriesAsFilterForOptions:!0,layout:r.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,C.l)().getInstanceSettings(Ee.spec.datasource)?.meta.multiValueFilterOperators});if(Ee.kind===(0,l.ns)().kind)return new x.yP({...be,value:Ee.spec.current?.value??"",text:Ee.spec.current?.text??"",query:Ee.spec.query,isMulti:Ee.spec.multi,allValue:Ee.spec.allValue||void 0,includeAll:Ee.spec.includeAll,defaultToAll:!!Ee.spec.includeAll,skipUrlSync:Ee.spec.skipUrlSync,hide:(0,N.cc)(Ee.spec.hide)});if(Ee.kind===(0,l.m6)().kind)return new x.fS({...be,value:Ee.spec.current?.value??"",text:Ee.spec.current?.text??"",query:_(Ee),datasource:Ee.spec.datasource,sort:(0,N.ES)(Ee.spec.sort),refresh:(0,N.tH)(Ee.spec.refresh),regex:Ee.spec.regex,allValue:Ee.spec.allValue||void 0,includeAll:Ee.spec.includeAll,defaultToAll:!!Ee.spec.includeAll,isMulti:Ee.spec.multi,skipUrlSync:Ee.spec.skipUrlSync,hide:(0,N.cc)(Ee.spec.hide),definition:Ee.spec.definition});if(Ee.kind===(0,l.X1)().kind)return new x.mI({...be,value:Ee.spec.current?.value??"",text:Ee.spec.current?.text??"",regex:Ee.spec.regex,pluginId:Ee.spec.pluginId,allValue:Ee.spec.allValue||void 0,includeAll:Ee.spec.includeAll,defaultToAll:!!Ee.spec.includeAll,skipUrlSync:Ee.spec.skipUrlSync,isMulti:Ee.spec.multi,hide:(0,N.cc)(Ee.spec.hide),defaultOptionEnabled:Ee.spec.current?.value===V&&Ee.spec.current?.text==="default"});if(Ee.kind===(0,l.pK)().kind){const Se=(0,I.Sm)(Ee.spec.query),Xe=ee(Ee,Se);return new x.Yj({...be,value:Xe,intervals:Se,autoEnabled:Ee.spec.auto,autoStepCount:Ee.spec.auto_count,autoMinInterval:Ee.spec.auto_min,refresh:(0,N.tH)(Ee.spec.refresh),skipUrlSync:Ee.spec.skipUrlSync,hide:(0,N.cc)(Ee.spec.hide)})}else{if(Ee.kind===(0,l.ET)().kind)return new x.x0({...be,value:Ee.spec.query,skipUrlSync:Ee.spec.skipUrlSync,hide:(0,N.cc)(Ee.spec.hide)});if(Ee.kind===(0,l.t1)().kind){let Se;return Ee?.spec.current?.value?typeof Ee.spec.current.value=="string"?Se=Ee.spec.current.value:Se=Ee.spec.current.value[0]:Se=Ee.spec.query,new x.TS({...be,value:Se,skipUrlSync:Ee.spec.skipUrlSync,hide:(0,N.cc)(Ee.spec.hide)})}else{if(r.$.featureToggles.groupByVariable&&Ee.kind===(0,l.uB)().kind)return new x.ZG({...be,datasource:Ee.spec.datasource,value:Ee.spec.current?.value||[],text:Ee.spec.current?.text||[],skipUrlSync:Ee.spec.skipUrlSync,isMulti:Ee.spec.multi,hide:(0,N.cc)(Ee.spec.hide),defaultOptions:Ee.options});throw new Error(`Scenes: Unsupported variable type ${Ee.kind}`)}}}function _(Ee){return K.sB in Ee.spec.query.spec?Ee.spec.query.spec[K.sB]??"":{...Ee.spec.query.spec,refId:Ee.spec.query.spec.refId??"A"}}function ee(Ee,be){const Se=Array.isArray(Ee.spec.current.value)?Ee.spec.current.value[0]:Ee.spec.current.value;return Se.startsWith("$__auto_interval_")?"$__auto":be.includes(Se)?Se:be[0]}function J(Ee){const be=Ee.variables.map(Se=>{try{return Se.kind==="AdhocVariable"?new x.H9({name:Se.spec.name,label:Se.spec.label,readOnly:!0,description:Se.spec.description,skipUrlSync:Se.spec.skipUrlSync,hide:(0,N.cc)(Se.spec.hide),datasource:Se.spec.datasource,applyMode:"auto",filters:Se.spec.filters??[],baseFilters:Se.spec.baseFilters??[],defaultKeys:Se.spec.defaultKeys,useQueriesAsFilterForOptions:!0,layout:r.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,C.l)().getInstanceSettings(Se.spec.datasource)?.meta.multiValueFilterOperators}):Z(Se)}catch(Xe){return console.error(Xe),null}}).filter(Se=>!!Se);return new x.Pj({variables:be})}function Z(Ee){let be,Se;if(Ee.kind==="IntervalVariable"){const Xe=(0,I.Sm)(Ee.spec.query),Qe=ee(Ee,Xe);return be=new U.B({name:Ee.spec.name,label:Ee.spec.label,description:Ee.spec.description,value:Qe,text:Qe,hide:(0,N.cc)(Ee.spec.hide)}),be}return Ee.kind==="ConstantVariable"||Ee.kind==="AdhocVariable"?Se={value:"",text:""}:Se={value:Ee.spec.current?.value??"",text:Ee.spec.current?.text??""},be=new U.B({name:Ee.spec.name,label:Ee.spec.label,description:Ee.spec.description,value:Se?.value??"",text:Se?.text??"",hide:(0,N.cc)(Ee.spec.hide)}),be}function te(Ee,be){return Ee.elements[be].kind==="Panel"?Ee.elements[be]:void 0}function ae(Ee,be){return Ee.elements[be].kind==="LibraryPanel"?Ee.elements[be]:void 0}var re=e(10037);const ne=500,ce="loadDashboardScene",le="__grafana_home_uid__";class he extends s.Q{constructor(){super(...arguments),this.cache={}}getCache(){return this.cache}async loadSnapshot(be){try{const Se=await this.loadSnapshotScene(be);this.setState({dashboard:Se,isLoading:!1})}catch(Se){const Xe=(0,c.do)(Se),Qe=(0,c.q6)(Se),we=(0,c.rE)(Se);this.setState({isLoading:!1,loadError:{status:Xe,message:Qe,messageId:we}})}}async loadDashboard(be){try{(0,d.j)(ce);const Se=await this.loadScene(be);if(!Se)return;r.$.featureToggles.preserveDashboardStateWhenNavigating&&be.uid&&(0,F.Gq)(Se),this.setState({dashboard:Se,isLoading:!1,options:be});const Xe=(0,d.z)(ce),Qe=x.jh.getQueryController(Se);(0,p.Dd)(Se,Xe?.duration),Qe?.startProfile(Se),be.route!==h.DashboardRoutes.New&&(0,f.B)({meta:Se.state.meta,uid:Se.state.uid,title:Se.state.title,id:Se.state.id})}catch(Se){const Xe=(0,c.do)(Se),Qe=(0,c.q6)(Se),we=(0,c.rE)(Se);this.setState({isLoading:!1,loadError:{status:Xe,message:Qe,messageId:we}})}}async loadScene(be){this.setState({dashboard:void 0,isLoading:!0});const Se=await this.fetchDashboard(be);return Se?this.transformResponseToScene(Se,be):null}getDashboardFromCache(be){const Se=this.dashboardCache;return Se&&Se.cacheKey===be&&Date.now()-Se?.ts<ne?Se.dashboard:null}clearState(){(0,m.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(be,Se){this.dashboardCache={dashboard:Se,ts:Date.now(),cacheKey:be}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(be){return this.cache[be]}setSceneCache(be,Se){this.cache[be]=Se}clearSceneCache(){this.cache={}}}class oe extends he{transformResponseToScene(be,Se){const Xe=this.getSceneFromCache(Se.uid);if(Xe&&Xe.state.version===be?.dashboard.version)return Xe;if(be?.dashboard){const Qe=(0,A.wM)(be);return Se.uid&&this.setSceneCache(Se.uid,Qe),Qe}throw new Error("Dashboard not found")}async loadSnapshotScene(be){const Se=await E.np.loadSnapshot(be);if(Se?.dashboard)return(0,A.wM)(Se);throw new Error("Snapshot not found")}async fetchDashboard({type:be,slug:Se,uid:Xe,route:Qe,urlFolderUid:we,params:$e}){const Fe=Qe===h.DashboardRoutes.Home?le:Xe;if(!$e){const Le=this.getDashboardFromCache(Fe);if(Le)return Le}let Te;try{switch(Qe){case h.DashboardRoutes.New:Te=await(0,D.X)(we);break;case h.DashboardRoutes.Home:if(Te=await(0,a.AI)().get("/api/dashboards/home"),(0,h.isRedirectResponse)(Te)){const Ge=n.I.stripBaseFromUrl(Te.redirectUri);return i.Ny.replace(Ge),null}if((0,o.aK)(Te.dashboard))throw new Error("v2 dashboard spec is not supported. Enable useV2DashboardsAPI feature toggle");Te?.meta&&(Te.meta.canSave=!1,Te.meta.canShare=!1,Te.meta.canStar=!1);break;case h.DashboardRoutes.Public:return await E.np.loadDashboard("public","",Xe);default:const Le=$e?{version:$e.version,scopes:$e.scopes,from:$e.timeRange.from,to:$e.timeRange.to,...$e.variables}:void 0;Te=await E.np.loadDashboard(be||"db",Se||"",Xe,Le),Qe===h.DashboardRoutes.Embedded&&(Te.meta.isEmbedded=!0)}if(Te.meta.url&&Qe===h.DashboardRoutes.Normal){const Le=n.I.stripBaseFromUrl(Te.meta.url),Ge=i.Ny.getLocation().pathname;Le!==Ge&&(i.Ny.replace({...i.Ny.getLocation(),pathname:Le}),console.log("not correct url correcting",Le,Ge))}Te.meta.folderUid&&await(0,re.Q)(Te.meta.folderUid),this.setDashboardCache(Fe,Te)}catch(Le){if((0,a.NF)(Le)&&Le.cancelled)return null;throw Le}return Te}async reloadDashboard(be){const Se=this.state.options;if(!Se)return;const Xe={...Se,params:be};if(!((0,t.isEqual)(Xe.params?.variables,Se.params?.variables)&&(0,t.isEqual)(Xe.params?.scopes,Se.params?.scopes)))try{this.setState({isLoading:!0});const Qe=await this.fetchDashboard(Xe),we=this.getSceneFromCache(Xe.uid);if(we&&we.state.version===Qe?.dashboard.version){this.setState({isLoading:!1});return}if(!Qe?.dashboard){this.setState({isLoading:!1,loadError:{status:404,message:"Dashboard not found"}});return}const $e=(0,A.wM)(Qe);this.setSceneCache(Xe.uid,$e),this.setState({dashboard:$e,isLoading:!1,options:Xe})}catch(Qe){const we=(0,c.do)(Qe),$e=(0,c.q6)(Qe);this.setState({isLoading:!1,loadError:{message:$e,status:we}})}}}class de extends he{constructor(){super(...arguments),this.dashboardLoader=new E.t0}async loadSnapshotScene(be){const Se=await this.dashboardLoader.loadSnapshot(be);if(Se?.spec)return T(Se);throw new Error("Snapshot not found")}transformResponseToScene(be,Se){const Xe=this.getSceneFromCache(Se.uid);if(Xe&&be?.metadata.resourceVersion&&Xe.state.version===parseInt(be?.metadata.resourceVersion,10))return Xe;if(be){const Qe=T(be);return Se.uid&&this.setSceneCache(Se.uid,Qe),Qe}throw new Error("Dashboard not found")}reloadDashboard(be){throw new Error("Method not implemented.")}async fetchDashboard({type:be,slug:Se,uid:Xe,route:Qe,urlFolderUid:we,params:$e}){const Fe=Qe===h.DashboardRoutes.Home?le:Xe;if(!$e){const Le=this.getDashboardFromCache(Fe);if(Le)return Le}let Te;try{switch(Qe){case h.DashboardRoutes.New:Te=await(0,D.V)(we);break;case h.DashboardRoutes.Home:const Le=await(0,a.AI)().get("/api/dashboards/home");if((0,h.isRedirectResponse)(Le)){const Me=n.I.stripBaseFromUrl(Le.redirectUri);return i.Ny.replace(Me),null}Te=g.Op.ensureV2Response(Le),(0,o.aK)(Le.dashboard)&&(Te.spec=Le.dashboard),Te.access.canSave=!1,Te.access.canShare=!1,Te.access.canStar=!1;break;case h.DashboardRoutes.Public:return await this.dashboardLoader.loadDashboard("public","",Xe);default:const Ge=$e?{version:$e.version,scopes:$e.scopes,from:$e.timeRange.from,to:$e.timeRange.to,...$e.variables}:void 0;if(Te=await this.dashboardLoader.loadDashboard(be||"db",Se||"",Xe,Ge),Qe===h.DashboardRoutes.Embedded)throw new Error("Method not implemented.")}if(Te.access.url&&Qe===h.DashboardRoutes.Normal){const Le=n.I.stripBaseFromUrl(Te.access.url),Ge=i.Ny.getLocation().pathname;Le!==Ge&&(i.Ny.replace({...i.Ny.getLocation(),pathname:Le}),console.log("not correct url correcting",Le,Ge))}Te.metadata.annotations?.[u.ew]&&await(0,re.Q)(Te.metadata.annotations?.[u.ew]),this.setDashboardCache(Fe,Te)}catch(Le){if((0,a.NF)(Le)&&Le.cancelled)return null;throw Le}return Te}}const me={v1:void 0,v2:void 0};function Pe(Ee){return Ee==="v2"?(me.v2||(me.v2=new de({})),me.v2):(me.v1||(me.v1=new oe({})),me.v1)}},10037:(q,j,e)=>{"use strict";e.d(j,{Q:()=>i});var t=e(23737),n=e(75911),r=e(64199),a=e(83394);async function i(x){try{const s=await n.IB.getFolderByUid(x);a.M_.dispatch((0,t.Vz)((0,r.R4)(s)))}catch(s){console.warn("Error fetching parent folder",x,"for dashboard",s)}}},42090:(q,j,e)=>{"use strict";e.d(j,{p:()=>c});var t=e(74848),n=e(58779),r=e(90231),a=e(48583),i=e(45565),x=e(54594),s=e(11817);function c(d){return(0,t.jsx)(r.a,{alignItems:"center",padding:4,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(i.E,{element:"h3",textAlignment:"center",children:(0,t.jsx)(s.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,t.jsx)(i.E,{element:"p",textAlignment:"center","data-testid":n.Tp.components.Transforms.noTransformationsMessage,children:(0,t.jsxs)(s.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,t.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,t.jsx)(x.$n,{icon:"plus",variant:"primary",size:"md",onClick:d.onShowPicker,"data-testid":n.Tp.components.Transforms.addTransformationButton,children:"Add transformation"})]})})}},97805:(q,j,e)=>{"use strict";e.d(j,{L:()=>zn});var t=e(2543),n=e(53027),r=e(32370),a=e(61034),i=e(91098),x=e(61976),s=e(81569),c=e(81559),d=e(80727),u=e(29679),g=e(10817),o=e(2044);class E extends a.Bs{constructor(zt){super({source:zt.source,data:zt.source.resolve().state.data}),this.addActivationHandler(()=>{this._subs.add(this.state.source.resolve().subscribeToState((Qt,an)=>{Qt.data!==an.data&&this.setState({data:Qt.data})}))})}setContainerWidth(zt){this.state.source.resolve().setContainerWidth?.(zt)}isDataReadyToDisplay(){return this.state.source.resolve().isDataReadyToDisplay?.()??!0}cancelQuery(){this.state.source.resolve().cancelQuery?.()}getResultsStream(){return this.state.source.resolve().getResultsStream()}}var m=e(74848),f=e(22803),p=e(58779),h=e(29675),D=e(10247),C=e(99134),l=e(11238),v=e(19550),y=e(88023),P=e(87638),b=e(96621),S=e(88214),M=e(37e3),O=e(81876),R=e(88849),L=e(11817),B=e(88755),F=e(32757),I=e(85651),U=e(54148),W=e(16817),A=e(93407),N=e(18729),K=e(54594),V=e(83893),T=e(82096);const z=({panel:St,className:zt})=>{const Qt=(0,U.zy)(),{loading:an,value:mn}=(0,W.A)(()=>(0,T.J6)(St),[St]);if(an)return(0,m.jsx)(K.$n,{disabled:!0,children:"New alert rule"});if(!mn)return(0,m.jsx)(M.F,{severity:"info",title:"No alerting capable query found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."});const yn=async()=>{(0,N.fH)(V.le.alertRuleFromPanel);const Ct=await(0,T.J6)(St),ut=A.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Ct),returnTo:Qt.pathname+Qt.search});n.Ny.push(ut)};return(0,m.jsx)(K.$n,{icon:"bell",onClick:yn,className:zt,"data-testid":"create-alert-rule-button",children:"New alert rule"})};var w=(St=>(St.Queries="queries",St.Transformations="transformations",St.Alert="alert",St))(w||{});class H extends a.Bs{constructor(){super(...arguments),this.tabId=w.Alert}static{this.Component=G}renderTab(zt){return(0,m.jsx)(k,{model:this,...zt},this.getTabLabel())}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,o.YQ)(this)}getLegacyPanelId(){return(0,o.Cs)(this.state.panelRef.resolve())}getCanCreateRules(){const zt=(0,b.Wd)("grafana");return r.$.unifiedAlerting&&this.getDashboard().state.meta.canSave&&P.TP.hasPermission(zt.create)}}function G({model:St}){const zt=(0,h.of)(X),{errors:Qt,loading:an,rules:mn}=(0,F.S)({dashboardUID:St.getDashboardUID(),panelId:St.getLegacyPanelId()}),yn=Qt.length?(0,m.jsx)(M.F,{title:"Errors loading rules",severity:"error",children:Qt.map((Wt,gt)=>(0,m.jsxs)("div",{children:["Failed to load Grafana rules state: ",(0,I.JZ)(Wt)]},gt))}):null;if(an&&!mn.length)return(0,m.jsxs)(m.Fragment,{children:[yn,(0,m.jsx)(O._,{text:"Loading rules..."})]});const Ct=St.state.panelRef.resolve(),ut=St.getCanCreateRules();if(mn.length)return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(B.sF,{rules:mn}),ut&&(0,m.jsx)(z,{className:zt.newButton,panel:Ct})]});const Et=!St.getDashboardUID(),Ut=St.getDashboard();return(0,m.jsxs)("div",{className:zt.noRulesWrapper,children:[!Et&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("p",{children:(0,m.jsx)(L.x6,{i18nKey:"dashboard.panel-edit.alerting-tab.no-rules",children:"There are no alert rules linked to this panel."})}),ut&&(0,m.jsx)(z,{panel:Ct})]}),Et&&!!Ut.state.meta.canSave&&(0,m.jsx)(M.F,{severity:"info",title:"Dashboard not saved",children:(0,m.jsx)(L.x6,{i18nKey:"dashboard.panel-edit.alerting-tab.dashboard-not-saved",children:"Dashboard must be saved before alerts can be added."})})]})}const X=St=>({newButton:(0,f.css)({marginTop:St.spacing(3)}),noRulesWrapper:(0,f.css)({margin:St.spacing(2),backgroundColor:St.colors.background.secondary,padding:St.spacing(3)})});function k(St){const{model:zt}=St,{rules:Qt}=(0,F.S)({dashboardUID:zt.getDashboardUID(),panelId:zt.getLegacyPanelId(),poll:!1});return(0,m.jsx)(R.o,{label:zt.getTabLabel(),icon:"bell",counter:Qt.length,active:St.active,onChangeTab:St.onChangeTab})}var _=e(61809),ee=e(16753),J=e(98437),Z=e(48583),te=e(27315),ae=e(37485),re=e(21475),ne=e(54230),ce=e(33405),le=e(61648),he=e(11147),oe=e(52488),de=e(5956),me=e(59485),Pe=e(44684),Ee=e(10059),be=e(36054),Se=e(48366);class Xe extends a.Bs{constructor(zt){super(zt),this.tabId=w.Queries,this.onOpenInspector=()=>{const Qt=this.state.panelRef.resolve(),an=(0,o.Cs)(Qt);n.Ny.partial({inspect:an,inspectTab:"query"})},this.onChangeDataSource=async(Qt,an)=>{const{dsSettings:mn}=this.state,yn=this.queryRunner,Ct=mn?await(0,J.l)().get({uid:mn.uid}):void 0,ut=await(0,J.l)().get({uid:Qt.uid}),Et=yn.state.queries,Ut=an||await(0,he.y)(ut,Qt.uid,Et,Ct);yn.setState({datasource:(0,_.p$)(Qt),queries:Ut}),an&&yn.runQueries(),this.loadDataSource()},this.onQueryOptionsChange=Qt=>{const an=this.state.panelRef.resolve(),mn=this.queryRunner,yn={},Ct={};Qt.maxDataPoints!==mn.state.maxDataPoints&&(yn.maxDataPoints=Qt.maxDataPoints??void 0),Qt.minInterval!==mn.state.minInterval&&(yn.minInterval=Qt.minInterval??void 0);const ut=Qt.timeRange?.from??void 0,Et=Qt.timeRange?.shift??void 0,Ut=Qt.timeRange?.hide;ut!==void 0||Et!==void 0?(Ct.$timeRange=new be.v({timeFrom:ut,timeShift:Et,hideTimeOverride:Ut}),Ct.hoverHeader=(0,Se.$7)(an.state.title,Ct.$timeRange)):(Ct.$timeRange=void 0,Ct.hoverHeader=(0,Se.$7)(an.state.title,void 0)),Qt.cacheTimeout!==mn?.state.cacheTimeout&&(yn.cacheTimeout=Qt.cacheTimeout),Qt.queryCachingTTL!==mn?.state.queryCachingTTL&&(yn.queryCachingTTL=Qt.queryCachingTTL),an.setState(Ct),mn.setState(yn),mn.runQueries()},this.onQueriesChange=Qt=>{this.queryRunner.setState({queries:Qt})},this.onRunQueries=()=>{this.queryRunner.runQueries()},this.addQueryClick=()=>{const Qt=this.getQueries();this.onQueriesChange((0,te.U7)(Qt,this.newQuery()))},this.onAddQuery=Qt=>{const an=this.getQueries(),mn=this.state.dsSettings;this.onQueriesChange((0,te.U7)(an,Qt,mn?(0,_.p$)(mn):{type:void 0,uid:void 0}))},this.onAddExpressionClick=()=>{const Qt=this.getQueries();this.onQueriesChange((0,te.U7)(Qt,re.Ex.newQuery()))},this.addActivationHandler(()=>this.onActivate())}static{this.Component=Qe}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}renderTab(zt){return(0,m.jsx)($e,{model:this,...zt},this.getTabLabel())}onActivate(){this.loadDataSource()}async loadDataSource(){if(!this.state.panelRef.resolve().state.$data)return;let an=this.queryRunner.state.datasource;try{let mn,yn;if(an)mn=await(0,J.l)().get(an),yn=(0,J.l)().getInstanceSettings(an);else{const ut=(0,o.YQ)(this).state.uid??"",Et=(0,x.CW)(ut);Et?.datasourceUid!==null&&(yn=(0,J.l)().getInstanceSettings({uid:Et?.datasourceUid}),yn&&(mn=await(0,J.l)().get({uid:Et?.datasourceUid,type:yn.type}),this.queryRunner.setState({datasource:{...(0,_.p$)(yn),uid:Et?.datasourceUid}})))}mn&&yn&&(this.setState({datasource:mn,dsSettings:yn}),(0,ae.tw)((0,_.p$)(yn)||{default:!0}))}catch(mn){const yn=await(0,J.l)().get(r.$.defaultDatasource),Ct=(0,J.l)().getInstanceSettings(r.$.defaultDatasource);yn&&Ct&&(this.setState({datasource:yn,dsSettings:Ct}),this.queryRunner.setState({datasource:(0,_.p$)(Ct)})),console.error(mn)}}buildQueryOptions(){const zt=this.state.panelRef.resolve(),Qt=(0,o.un)(zt),an=a.jh.getTimeRange(zt);let mn={from:void 0,shift:void 0,hide:void 0};an instanceof be.v&&(mn={from:an.state.timeFrom,shift:an.state.timeShift,hide:an.state.hideTimeOverride});let yn=Qt.state.queries;const Ct=this.state.dsSettings;return{cacheTimeout:Ct?.meta.queryOptions?.cacheTimeout?Qt.state.cacheTimeout:void 0,queryCachingTTL:Ct?.cachingConfig?.enabled?Qt.state.queryCachingTTL:void 0,dataSource:{default:Ct?.isDefault,...Ct?(0,_.p$)(Ct):{type:void 0,uid:void 0}},queries:yn,maxDataPoints:Qt.state.maxDataPoints,minInterval:Qt.state.minInterval,timeRange:mn}}getQueries(){return this.queryRunner.state.queries}newQuery(){const{dsSettings:zt,datasource:Qt}=this.state;let an;return zt?.meta.mixed?Qt?.meta.mixed?an=(0,J.l)().getInstanceSettings(r.$.defaultDatasource):an=Qt:an=zt,{...Qt?.getDefaultQuery?.(ee.Jk.PanelEditor),datasource:{uid:an?.uid,type:an?.type}}}isExpressionsSupported(zt){return(zt.meta.alerting||zt.meta.mixed)===!0}renderExtraActions(){return ne.m.getAllExtraRenderAction().map((zt,Qt)=>zt({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:Qt})).filter(Boolean)}get queryRunner(){return(0,o.un)(this.state.panelRef.resolve())}}function Qe({model:St}){const{datasource:zt,dsSettings:Qt}=St.useState(),{data:an,queries:mn}=St.queryRunner.useState(),{openDrawer:yn,queryLibraryEnabled:Ct}=(0,me.Y)();if(!zt||!Qt||!an)return null;const ut=!(0,oe.k)(Qt.name),Et=async Ut=>{const Wt=mn.map(Vt=>Vt.datasource?Vt:{...Vt,datasource:zt.getRef()}),gt=(0,te.U7)(Wt,Ut);if(St.onQueriesChange(gt),Ut.datasource?.uid){const dn={uid:new Set(gt.map(Un=>Un.datasource?.uid).filter(Un=>Un!==Pe.Uj)).size>1?de.uv:Ut.datasource.uid};if(zt.uid!==dn.uid){const Un=(0,Ee.tR)().getInstanceSettings(dn);Un&&await St.onChangeDataSource(Un)}}};return(0,m.jsxs)("div",{"data-testid":p.Tp.components.QueryTab.content,children:[(0,m.jsx)(le.K,{data:an,dsSettings:Qt,dataSource:zt,options:St.buildQueryOptions(),onDataSourceChange:St.onChangeDataSource,onOptionsChange:St.onQueryOptionsChange,onOpenQueryInspector:St.onOpenInspector}),(0,m.jsx)(ce.L,{data:an,queries:mn,dsSettings:Qt,onAddQuery:St.onAddQuery,onQueriesChange:St.onQueriesChange,onRunQueries:St.onRunQueries}),(0,m.jsxs)(Z.B,{gap:2,children:[ut&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(K.$n,{icon:"plus",onClick:St.addQueryClick,variant:"secondary","data-testid":p.Tp.components.QueryTab.addQuery,children:"Add query"}),Ct&&(0,m.jsx)(K.$n,{icon:"plus",onClick:()=>yn(we(zt,mn),Et),variant:"secondary","data-testid":p.Tp.components.QueryTab.addQuery,children:(0,m.jsx)(L.x6,{i18nKey:"dashboards.panel-queries.add-query-from-library",children:"Add query from library"})})]}),r.$.expressionsEnabled&&St.isExpressionsSupported(Qt)&&(0,m.jsx)(K.$n,{icon:"plus",onClick:St.onAddExpressionClick,variant:"secondary","data-testid":p.Tp.components.QueryTab.addExpression,children:(0,m.jsx)("span",{children:"Expression\xA0"})}),St.renderExtraActions()]})]})}function we(St,zt){if(St.uid==="-- Mixed --"){const Qt=(0,J.l)();return zt.map(an=>Qt.getInstanceSettings(an.datasource)?.name).filter(an=>an!==void 0)}else return[St.name]}function $e(St){const{model:zt}=St,Qt=zt.queryRunner.useState();return(0,m.jsx)(R.o,{label:zt.getTabLabel(),icon:"database",counter:Qt.queries.length,active:St.active,onChangeTab:St.onChangeTab})}var Fe=e(57095),Te=e(96540),Le=e(90333),Ge=e(65164),Me=e(40577),De=e(42090),Ke=e(48279),Ie=e(99764),Ne=e(24929),ie=e(45177);function ve(St){const{isOpen:zt,series:Qt,onClose:an,onTransformationAdd:mn}=St,[yn,Ct]=(0,Te.useState)({search:"",showIllustrations:!0}),ut=Ft=>Ct({...yn,search:Ft.currentTarget.value}),Et=Ft=>Ct({...yn,showIllustrations:Ft}),Ut=Ft=>Ct({...yn,selectedFilter:Ft}),Wt=(0,Te.useMemo)(()=>Ke.h.list().sort((Ft,dn)=>Ft.name>dn.name?1:dn.name>Ft.name?-1:0),[]),gt=Wt.filter(Ft=>yn.selectedFilter&&yn.selectedFilter!==ie.e&&!Ft.categories?.has(yn.selectedFilter)?!1:Ft.name.toLocaleLowerCase().includes(yn.search.toLocaleLowerCase())||Ft.description?.toLocaleLowerCase().includes(yn.search.toLocaleLowerCase())),Vt=(0,m.jsxs)(m.Fragment,{children:[gt.length," / ",Wt.length," \xA0\xA0",(0,m.jsx)(Ie.K,{name:"times",onClick:()=>{Ct({...yn,search:""})},tooltip:"Clear search"})]});if(zt)return(0,m.jsx)(Ne.R,{data:Qt,onTransformationAdd:mn,xforms:gt,search:yn.search,noTransforms:!1,suffix:yn.search!==""?Vt:(0,m.jsx)(m.Fragment,{}),selectedFilter:yn.selectedFilter,onSearchChange:ut,onSearchKeyDown:()=>{},showIllustrations:yn.showIllustrations,onShowIllustrationsChange:Et,onSelectedFilterChange:Ut,onClose:an})}class fe extends a.Bs{constructor(){super(...arguments),this.tabId=w.Transformations}static{this.Component=ge}getTabLabel(){return"Transformations"}renderTab(zt){return(0,m.jsx)(Ve,{model:this,...zt},this.getTabLabel())}getQueryRunner(){return(0,o.un)(this.state.panelRef.resolve())}getDataTransformer(){const zt=this.state.panelRef.resolve().state.$data;if(!zt||!(zt instanceof a.Es))throw new Error("Could not find SceneDataTransformer for panel");return zt}onChangeTransformations(zt){const Qt=this.getDataTransformer();Qt.setState({transformations:zt}),Qt.reprocessTransformations()}}function ge({model:St}){const zt=(0,h.of)(je),Qt=St.getQueryRunner().useState(),{data:an,transformations:mn}=St.getDataTransformer().useState(),yn=mn,[Ct,ut]=(0,Te.useState)(!1),[Et,Ut]=(0,Te.useState)(!1),Wt=()=>ut(!0),gt=()=>ut(!1);if(!an||!Qt.data)return;const Vt=(0,m.jsx)(ve,{onClose:gt,onTransformationAdd:Ft=>{Ft.value!==void 0&&(St.onChangeTransformations([...yn,{id:Ft.value,options:{}}]),gt())},isOpen:Ct,series:an.series});return yn.length<1?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(De.p,{onShowPicker:Wt}),Vt]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(xe,{data:Qt.data,transformations:yn,model:St}),(0,m.jsxs)(Le.e,{children:[(0,m.jsx)(K.$n,{icon:"plus",variant:"secondary",onClick:Wt,"data-testid":p.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),(0,m.jsx)(K.$n,{"data-testid":p.Tp.components.Transforms.removeAllTransformationsButton,className:zt.removeAll,icon:"times",variant:"secondary",onClick:()=>Ut(!0),children:"Delete all transformations"})]}),(0,m.jsx)(Ge.u,{isOpen:Et,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{St.onChangeTransformations([]),Ut(!1)},onDismiss:()=>Ut(!1)}),Vt]})}function xe({transformations:St,model:zt,data:Qt}){const an=St.map((yn,Ct)=>({id:`${Ct} - ${yn.id}`,transformation:yn})),mn=yn=>{if(!yn||!yn.destination)return;const Ct=yn.source.index,ut=yn.destination.index;if(Ct===ut)return;const Et=Array.from(an),[Ut]=Et.splice(Ct,1);Et.splice(ut,0,Ut),zt.onChangeTransformations(Et.map(Wt=>Wt.transformation))};return(0,m.jsx)(Fe.DragDropContext,{onDragEnd:mn,children:(0,m.jsx)(Fe.Droppable,{droppableId:"transformations-list",direction:"vertical",children:yn=>(0,m.jsxs)("div",{ref:yn.innerRef,...yn.droppableProps,children:[(0,m.jsx)(Me.A,{onChange:(Ct,ut)=>{const Et=St.slice();Et[Ct]=ut,zt.onChangeTransformations(Et)},onRemove:Ct=>{const ut=St.slice();ut.splice(Ct,1),zt.onChangeTransformations(ut)},configs:an,data:Qt}),yn.placeholder]})})})}const je=St=>({removeAll:(0,f.css)({marginLeft:St.spacing(2)})});function Ve(St){const{model:zt}=St,Qt=zt.getDataTransformer().useState();return(0,m.jsx)(R.o,{label:zt.getTabLabel(),icon:"process",counter:Qt.transformations.length,active:St.active,onChangeTab:St.onChangeTab})}class ke extends a.Bs{constructor(){super(...arguments),this._urlSync=new a.So(this,{keys:["tab"]}),this.onChangeTab=zt=>{this.setState({tab:zt.tabId})}}static{this.Component=Oe}static createFor(zt){const Qt=zt.getRef(),an=[new Xe({panelRef:Qt}),new fe({panelRef:Qt})];return nt(zt.state.pluginId)&&an.push(new H({panelRef:Qt})),new ke({panelRef:Qt,tabs:an,tab:w.Queries})}getUrlState(){return{tab:this.state.tab}}updateFromUrl(zt){zt.tab&&typeof zt.tab=="string"&&this.setState({tab:zt.tab})}}function Oe({model:St}){const{tab:zt,tabs:Qt}=St.useState(),an=(0,h.of)(Je);if(!Qt||!Qt.length)return;const mn=Qt.find(yn=>yn.tabId===zt);return(0,m.jsxs)("div",{className:an.dataPane,"data-testid":p.Tp.components.PanelEditor.DataPane.content,children:[(0,m.jsx)(D.U,{className:an.tabsBar,children:Qt.map(yn=>yn.renderTab({active:yn.tabId===zt,onChangeTab:()=>St.onChangeTab(yn)}))}),(0,m.jsx)(C.P,{backgroundColor:"primary",children:(0,m.jsx)(l.J,{className:an.tabContent,children:(0,m.jsx)(v.mc,{children:mn&&(0,m.jsx)(mn.Component,{model:mn})})})})]})}function nt(St){const{unifiedAlertingEnabled:zt=!1}=(0,y.zj)(),Qt=P.TP.hasPermission((0,b.Wd)(S.hY).read);return zt&&Qt?St==="graph"||St==="timeseries":!1}function Je(St){return{dataPane:(0,f.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,f.css)({padding:St.spacing(2),border:`1px solid ${St.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:St.shape.radius.default,flexGrow:1}),tabsBar:(0,f.css)({flexShrink:0,paddingLeft:St.spacing(2)})}}var Be=e(52120),Ze=e(20968),tt=e(71020),Re=e(40284),at=e(46888),yt=e(28565),ze=e(96129);function st({model:St}){const zt=(0,o.YQ)(St),{optionsPane:Qt}=St.useState(),an=(0,h.of)(Gt),[mn,yn]=(0,tt.d)(),{containerProps:Ct,primaryProps:ut,secondaryProps:Et,splitterProps:Ut,splitterState:Wt,onToggleCollapse:gt}=(0,ze.L)({direction:"row",dragPosition:"end",initialSize:.8,collapsed:mn,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return(0,Te.useEffect)(()=>{yn(Wt.collapsed)},[Wt.collapsed,yn]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Re.c,{dashboard:zt}),(0,m.jsxs)("div",{...Ct,className:(0,f.cx)(Ct.className,an.content),"data-testid":p.Tp.components.PanelEditor.General.content,children:[(0,m.jsx)("div",{...ut,className:(0,f.cx)(ut.className,an.body),children:(0,m.jsx)(ht,{model:St})}),(0,m.jsx)("div",{...Ut}),(0,m.jsxs)("div",{...Et,className:(0,f.cx)(Et.className,an.optionsPane),children:[Wt.collapsed&&(0,m.jsx)("div",{className:an.expandOptionsWrapper,children:(0,m.jsx)(Be.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:gt,variant:"canvas",className:an.rotate180,"aria-label":"Open options pane"})}),!Wt.collapsed&&Qt&&(0,m.jsx)(Qt.Component,{model:Qt}),!Wt.collapsed&&!Qt&&(0,m.jsx)(Ze.y,{})]})]})]})}function ht({model:St}){const zt=(0,o.YQ)(St),{dataPane:Qt,showLibraryPanelSaveModal:an,showLibraryPanelUnlinkModal:mn,tableView:yn}=St.useState(),Ct=St.getPanel(),ut=(0,o.iL)(Ct),{controls:Et}=zt.useState(),Ut=(0,h.of)(Gt),{containerProps:Wt,primaryProps:gt,secondaryProps:Vt,splitterProps:Ft,splitterState:dn,onToggleCollapse:Cn}=(0,ze.L)({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return Wt.className=(0,f.cx)(Wt.className,Ut.container),Qt||(gt.style.flexGrow=1),(0,m.jsxs)("div",{className:(0,f.cx)(Ut.pageContainer,Et&&Ut.pageContainerWithControls),children:[Et&&(0,m.jsx)("div",{className:Ut.controlsWrapper,children:(0,m.jsx)(Et.Component,{model:Et})}),(0,m.jsxs)("div",{...Wt,children:[(0,m.jsx)("div",{...gt,children:(0,m.jsx)(It,{panel:Ct,tableView:yn})}),an&&ut&&(0,m.jsx)(yt.Z,{libraryPanel:ut,onDismiss:St.onDismissLibraryPanelSaveModal,onConfirm:St.onConfirmSaveLibraryPanel,onDiscard:St.onDiscard}),mn&&ut&&(0,m.jsx)(at.l,{onDismiss:St.onDismissUnlinkLibraryPanelModal,onConfirm:St.onConfirmUnlinkLibraryPanel,isOpen:!0}),Qt&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{...Ft}),(0,m.jsxs)("div",{...Vt,children:[dn.collapsed&&(0,m.jsx)("div",{className:Ut.expandDataPane,children:(0,m.jsx)(K.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Cn,variant:"secondary",size:"sm",className:Ut.openDataPaneButton,"aria-label":"Open query pane"})}),!dn.collapsed&&(0,m.jsx)(Qt.Component,{model:Qt})]})]})]})]})}function It({panel:St,tableView:zt}){const Qt=(0,h.of)(Gt),an=zt??St;return(0,m.jsx)("div",{className:Qt.vizWrapper,children:(0,m.jsx)(an.Component,{model:an})})}function Gt(St){return{pageContainer:(0,f.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,f.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),container:(0,f.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,f.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,f.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,f.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,f.css)({flexDirection:"column",borderLeft:`1px solid ${St.colors.border.weak}`,background:St.colors.background.primary}),expandOptionsWrapper:(0,f.css)({display:"flex",flexDirection:"column",padding:St.spacing(2,1)}),expandDataPane:(0,f.css)({display:"flex",flexDirection:"row",padding:St.spacing(1),borderTop:`1px solid ${St.colors.border.weak}`,borderRight:`1px solid ${St.colors.border.weak}`,background:St.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,f.css)({rotate:"180deg"}),controlsWrapper:(0,f.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls"}),openDataPaneButton:(0,f.css)({width:St.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}}),vizWrapper:(0,f.css)({height:"100%",width:"100%",paddingLeft:St.spacing(2)})}}var un=e(27999),vn=e(41007),pn=e(56276),xn=e(22560),cn=e(60641),jn=e(6210),_n=e(84132),Ot=e(55452),Rt=e(93420),Ye=e(15407),dt=e(81003),lt=e(4527),Pt=e(72929);const Bt=Te.memo(({panel:St,searchQuery:zt,listMode:Qt,data:an})=>{const{options:mn,fieldConfig:yn,_pluginInstanceState:Ct}=St.useState(),ut=(0,Te.useMemo)(()=>(0,Se.yH)(St),[St]),Et=(0,Te.useMemo)(()=>{const Ft=St.getPlugin();if(Ft)return(0,lt.Z4)({panel:St,data:an,plugin:Ft,eventBus:St.getPanelContext().eventBus,instanceState:Ct})},[an,St,mn,yn,Ct]),Ut=(0,Te.useMemo)(()=>{if(St instanceof a.Eb&&(0,o.ME)(St)){const Ft=(0,o.iL)(St);return Ft instanceof Pt.u?(0,lt.tN)(Ft):void 0}},[St]),Wt=(0,Te.useMemo)(()=>(0,dt.v)(yn,St.getPlugin()?.fieldConfigRegistry,an?.series??[],zt,Ft=>{St.onFieldConfigChange(Ft,!0)}),[an,zt,St,yn]),gt=zt.length>0,Vt=[];if(gt)Vt.push((0,i.Po)([ut,...Ut?[Ut]:[],...Et??[]],Wt,zt));else switch(Qt){case i.gs.All:Ut&&Vt.push(Ut.render()),Vt.push(ut.render());for(const Ft of Et??[])Vt.push(Ft.render());for(const Ft of Wt)Vt.push(Ft.render());break;case i.gs.Overrides:for(const Ft of Wt)Vt.push(Ft.render());default:break}return Vt});Bt.displayName="PanelOptions";var Jt=e(78685),qt=e(86489),gn=e(40828),On=e(75342),Tn=e(31099),wn=e(74201),ps=e(95761);const es="dashboards_panel_plugin_picker_clicked",ls={TOGGLE_DROPDOWN:"toggle_panel_plugin_picker",SELECT_PANEL_PLUGIN:"select_panel_plugin",CHANGE_TAB:"change_tab",SEARCH:"search"};function Lt({panel:St,data:zt,onChange:Qt,onClose:an}){const mn=(0,h.of)($t),[yn,Ct]=(0,Te.useState)(""),ut=(0,Te.useMemo)(()=>(0,t.debounce)((ts,ms)=>{ts&&(0,pn.rR)(es,{item:ls.SEARCH,query:ts,result_count:ms,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),[]),Et=ts=>{Ct(ts)},Ut=gn.wV,Wt=On.__.Visualizations,gt=(0,Te.useMemo)(()=>new ps.R(St),[St]),Vt=(0,Te.useMemo)(()=>new Set([On.__.Visualizations,On.__.Suggestions]),[]),[Ft,dn]=(0,Jt.A)(Ut,Wt),Cn=ts=>{(0,pn.rR)(es,{item:ls.CHANGE_TAB,tab:On.__[ts],creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}),dn(ts)};(0,Te.useEffect)(()=>{Ft&&!Vt.has(Ft)&&dn(Wt)},[Wt,Ft,dn,Vt]);const Un=[{label:"Visualizations",value:On.__.Visualizations},{label:"Suggestions",value:On.__.Suggestions}];return(0,m.jsxs)("div",{className:mn.wrapper,children:[(0,m.jsxs)("div",{className:mn.searchRow,children:[(0,m.jsx)(xn.Z,{className:mn.filter,value:yn,onChange:Et,autoFocus:!0,placeholder:"Search for..."}),(0,m.jsx)(K.$n,{title:"Close",variant:"secondary",icon:"angle-up",className:mn.closeButton,"data-testid":p.Tp.components.PanelEditor.toggleVizPicker,onClick:an})]}),(0,m.jsx)(qt.D,{className:mn.customFieldMargin,children:(0,m.jsx)(cn.z,{options:Un,value:Ft,onChange:Cn,fullWidth:!0})}),(0,m.jsxs)(C.P,{children:[Ft===On.__.Visualizations&&(0,m.jsx)(wn.G,{pluginId:St.state.pluginId,searchQuery:yn,trackSearch:ut,onChange:Qt}),Ft===On.__.Suggestions&&(0,m.jsx)(Tn.a,{onChange:Qt,trackSearch:ut,searchQuery:yn,panel:gt,data:zt})]})]})}const $t=St=>({wrapper:(0,f.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:St.spacing(2,1),height:"100%",gap:St.spacing(2),border:`1px solid ${St.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:St.shape.radius.default}),searchRow:(0,f.css)({display:"flex",marginBottom:St.spacing(1)}),closeButton:(0,f.css)({marginLeft:St.spacing(1)}),customFieldMargin:(0,f.css)({marginBottom:St.spacing(1)}),filter:(0,f.css)({minHeight:St.spacing(4)})});class nn extends a.Bs{constructor(){super(...arguments),this._cachedPluginOptions={},this.onToggleVizPicker=()=>{(0,pn.rR)(es,{item:ls.TOGGLE_DROPDOWN,open:!this.state.isVizPickerOpen}),this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onChangePanelPlugin=zt=>{const Qt=this.state.panelRef.resolve(),{options:an,fieldConfig:mn,pluginId:yn}=Qt.state,Ct=zt.pluginId;(0,pn.rR)(es,{item:ls.SELECT_PANEL_PLUGIN,plugin_id:Ct});let ut={defaults:{...mn.defaults,custom:{}},overrides:(0,un.aW)(mn.overrides,un.nx)};this._cachedPluginOptions[yn]={options:an,fieldConfig:mn};const Et=this._cachedPluginOptions[Ct]?.options,Ut=this._cachedPluginOptions[Ct]?.fieldConfig;Ut&&(ut=(0,un.H9)(ut,Ut)),Qt.changePluginType(Ct,Et,ut),this.onToggleVizPicker()},this.onSetSearchQuery=zt=>{this.setState({searchQuery:zt})},this.onSetListMode=zt=>{this.setState({listMode:zt})},this.onOpenPanelJSON=zt=>{n.Ny.partial({inspect:zt.state.key,inspectTab:"json"})}}getOptionRadioFilters(){return[{label:i.gs.All,value:i.gs.All},{label:i.gs.Overrides,value:i.gs.Overrides}]}static{this.Component=({model:zt})=>{const{isVizPickerOpen:Qt,searchQuery:an,listMode:mn,panelRef:yn}=zt.useState(),Ct=yn.resolve(),{pluginId:ut}=Ct.useState(),{data:Et}=a.jh.getData(Ct).useState(),Ut=(0,h.of)(on),Wt=(0,Ye.Wu)(Ct),Vt=!(an.length>0)&&!Ct.getPlugin()?.fieldConfigRegistry.isEmpty();return(0,m.jsxs)(m.Fragment,{children:[!Qt&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:Ut.top,children:[(0,m.jsx)(bn,{pluginId:ut,onOpen:zt.onToggleVizPicker}),(0,m.jsx)(xn.Z,{className:Ut.searchOptions,value:an,placeholder:"Search options",onChange:zt.onSetSearchQuery}),Vt&&(0,m.jsx)(cn.z,{options:zt.getOptionRadioFilters(),value:mn,fullWidth:!0,onChange:zt.onSetListMode})]}),Wt&&(0,m.jsx)("div",{className:Ut.angularDeprecationContainer,children:(0,m.jsxs)(Rt.c,{showPluginDetailsLink:!0,pluginId:ut,pluginType:vn.QE.panel,angularSupportEnabled:r.$?.angularSupportEnabled,interactionElementId:"panel-options",children:[(0,m.jsx)(jn.Z.Heading,{children:(0,m.jsx)(L.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-heading",children:"Panel options"})}),(0,m.jsx)(jn.Z.Description,{children:(0,m.jsx)(L.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-description",children:"Angular panels options can only be edited using the JSON editor."})}),(0,m.jsx)(jn.Z.Actions,{children:(0,m.jsx)(K.$n,{variant:"secondary",fullWidth:!1,onClick:()=>{zt.onOpenPanelJSON(Ct)},children:(0,m.jsx)(L.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-button-open-panel-json",children:"Open JSON editor"})})})]})}),(0,m.jsx)(C.P,{children:(0,m.jsx)(Bt,{panel:Ct,searchQuery:an,listMode:mn,data:Et})})]}),Qt&&(0,m.jsx)(Lt,{panel:Ct,onChange:zt.onChangePanelPlugin,onClose:zt.onToggleVizPicker,data:Et})]})}}}function on(St){return{top:(0,f.css)({display:"flex",flexDirection:"column",padding:St.spacing(2,1),gap:St.spacing(2)}),searchOptions:(0,f.css)({minHeight:St.spacing(4)}),searchWrapper:(0,f.css)({padding:St.spacing(2,2,2,0)}),vizField:(0,f.css)({marginBottom:St.spacing(1)}),rotateIcon:(0,f.css)({rotate:"180deg"}),angularDeprecationContainer:(0,f.css)({label:"angular-deprecation-container",padding:St.spacing(1),display:"flex",flexDirection:"column",alignItems:"flex-end"})}}function bn({pluginId:St,onOpen:zt}){const Qt=(0,h.of)(In);let an=(0,Te.useMemo)(()=>(0,Ot.A4)().filter(mn=>mn.id===St)[0],[St]);return an||(an=(0,_n.$)(`Panel plugin not found (${St})`,!0).meta),(0,m.jsx)(Z.B,{gap:1,children:(0,m.jsx)(Be.I,{className:Qt.vizButton,tooltip:"Click to change visualization",imgSrc:an.info.logos.small,onClick:zt,"data-testid":p.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0,children:an.name})})}function In(St){return{vizButton:(0,f.css)({textAlign:"left"})}}class Yn extends a.Bs{constructor(zt){super(zt),this._changesHaveBeenMade=!1,this.debounceSaveModelDiff=!0,this.onDiscard=()=>{this.setState({isDirty:!1});const mn=this.state.panelRef.resolve();this.state.isNewPanel?(0,o.YQ)(this).removePanel(mn):this._layoutItem.setState(this._layoutItemState),n.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{(0,s.DW)(this.state.panelRef.resolve()),this.setState({isDirty:!1}),n.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{const mn=(0,o.iL)(this.getPanel());mn&&(mn.unlink(),this.setState({showLibraryPanelUnlinkModal:!1}))},this.onToggleTableView=()=>{if(this.state.tableView){this.setState({tableView:void 0});return}const yn=this.state.panelRef.resolve().state.$data;yn&&this.setState({tableView:a.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(new E({source:yn.getRef()})).build()})};const an=this.state.panelRef.resolve().parent;if(!an||!(0,u.y)(an))throw new Error("Panel must have a parent of type DashboardLayoutItem");this._layoutItem=an,this.setOriginalState(this.state.panelRef),this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=st}_activationHandler(){const zt=this.state.panelRef.resolve(),Qt=(0,o.sf)(zt);return this.waitForPlugin(),()=>{this._layoutItem.editingCompleted?.(this.state.isDirty||this._changesHaveBeenMade),Qt&&Qt()}}waitForPlugin(zt=0){const Qt=this.getPanel(),an=Qt.getPlugin();if(!an||an.meta.id!==Qt.state.pluginId){zt<100?setTimeout(()=>this.waitForPlugin(zt+1),zt*10):this.setState({pluginLoadErrror:"Failed to load panel plugin"});return}this.gotPanelPlugin(an)}setOriginalState(zt){const Qt=zt.resolve();this._originalSaveModel=(0,g.Z6)(Qt),this._layoutItemState=a.Go.cloneSceneObjectState(this._layoutItem.state)}_setupChangeDetection(){const zt=this.state.panelRef.resolve(),Qt=()=>{const{hasChanges:yn}=(0,d.yO)(this._originalSaveModel,(0,g.Z6)(zt));this.setState({isDirty:yn})},an=this.debounceSaveModelDiff?(0,t.debounce)(Qt,250):Qt,mn=yn=>{c.l.isUpdatingPersistedState(yn)&&an()};this._subs.add(this._layoutItem.subscribeToEvent(a.bZ,mn))}getPanel(){return this.state.panelRef?.resolve()}gotPanelPlugin(zt){const Qt=this.getPanel();this.state.isInitializing?(this.setOriginalState(this.state.panelRef),this._layoutItem.editingStarted?.(),this._setupChangeDetection(),this._updateDataPane(zt),this._subs.add(Qt.subscribeToState((an,mn)=>{an.pluginId!==mn.pluginId&&this.waitForPlugin()})),this.setState({optionsPane:new nn({panelRef:this.state.panelRef,searchQuery:"",listMode:i.gs.All}),isInitializing:!1})):this._updateDataPane(zt)}_updateDataPane(zt){const Qt=zt.meta.skipDataQuery,an=this.state.panelRef.resolve();if(Qt&&(this.state.dataPane&&(n.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),an.state.$data&&an.setState({$data:void 0})),!Qt&&(this.state.dataPane||this.setState({dataPane:ke.createFor(this.getPanel())}),!an.state.$data)){let mn=(0,x.CW)((0,o.YQ)(this).state.uid)?.datasourceUid;mn||(mn=r.$.defaultDatasource),an.setState({$data:new a.Es({$data:new a.dt({datasource:{uid:mn},queries:[{refId:"A"}]}),transformations:[]})})}}getUrlKey(){return this.getPanelId().toString()}getPanelId(){return(0,o.Cs)(this.state.panelRef.resolve())}getPageNav(zt,Qt){return{text:"Edit panel",parentItem:(0,o.YQ)(this).getPageNav(zt,Qt)}}dashboardSaved(){this.setOriginalState(this.state.panelRef),this.setState({isDirty:!1}),this._changesHaveBeenMade=!0}}function zn(St,zt=!1){return new Yn({isInitializing:!0,panelRef:St.getRef(),isNewPanel:zt})}},28565:(q,j,e)=>{"use strict";e.d(j,{Z:()=>o});var t=e(74848),n=e(96540),r=e(16817),a=e(40996),i=e(29675),x=e(25356),s=e(34128),c=e(79784),d=e(54594),u=e(81569),g=e(18949);const o=({libraryPanel:E,isUnsavedPrompt:m,onDismiss:f,onConfirm:p,onDiscard:h})=>{const[D,C]=(0,n.useState)(""),l=(0,r.A)(async()=>{const M=await(0,u.xV)(E.state.uid);return M.length>0?M.map(O=>O.title):[]},[E.state.uid]),[v,y]=(0,n.useState)([]);(0,a.A)(()=>l.value?y(l.value.filter(M=>M.toLowerCase().includes(D.toLowerCase()))):y([]),300,[l.value,D]);const P=(0,i.of)(g.o),b=(0,n.useCallback)(()=>{h()},[h]),S=m?"Unsaved library panel changes":"Save library panel";return(0,t.jsx)(x.a,{title:S,icon:"save",onDismiss:f,isOpen:!0,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:P.textInfo,children:["This update will affect ",(0,t.jsxs)("strong",{children:[E.state._loadedPanel?.meta?.connectedDashboards," ",E.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."]}),"The following dashboards using the panel will be affected:"]}),(0,t.jsx)(s.p,{className:P.dashboardSearch,prefix:(0,t.jsx)(c.I,{name:"search"}),placeholder:"Search affected dashboards",value:D,onChange:M=>C(M.currentTarget.value)}),l.loading?(0,t.jsx)("p",{children:"Loading connected dashboards..."}):(0,t.jsxs)("table",{className:P.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:v.map((M,O)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:M})},`dashrow-${O}`))})]}),(0,t.jsxs)(x.a.ButtonRow,{children:[(0,t.jsx)(d.$n,{variant:"secondary",onClick:f,fill:"outline",children:"Cancel"}),m&&(0,t.jsx)(d.$n,{variant:"destructive",onClick:b,children:"Discard"}),(0,t.jsx)(d.$n,{onClick:()=>{p()},children:"Update all"})]})]})})}},48366:(q,j,e)=>{"use strict";e.d(j,{$7:()=>b,R4:()=>y,dF:()=>v,m:()=>l,yH:()=>D});var t=e(74848),n=e(58779),r=e(32370),a=e(99153),i=e(34128),x=e(50926),s=e(29010),c=e(65988),d=e(36292),u=e(12422),g=e(12600),o=e(89146),E=e(36054),m=e(29679),f=e(10817),p=e(18745),h=e(2044);function D(S){const M=new u.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),O=p.b4.getPanelLinks(S),R=O?.state.rawLinks??[],L=(0,h.YQ)(S),B=S.parent;return M.addItem(new g.v({title:"Title",value:S.state.title,popularRank:1,render:function(){return(0,t.jsx)(l,{panel:S})},addon:r.$.featureToggles.dashgpt&&(0,t.jsx)(d.h,{onGenerate:F=>P(S,F),panel:(0,f.Z6)(S),dashboard:(0,f.Uy)(L)})})).addItem(new g.v({title:"Description",value:S.state.description,render:function(){return(0,t.jsx)(v,{panel:S})},addon:r.$.featureToggles.dashgpt&&(0,t.jsx)(c.t,{onGenerate:F=>S.setState({description:F}),panel:(0,f.Z6)(S)})})).addItem(new g.v({title:"Transparent background",render:function(){return(0,t.jsx)(y,{panel:S})}})).addCategory(new u.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:R?.length}).addItem(new g.v({title:"Panel links",render:()=>(0,t.jsx)(C,{panelLinks:O??void 0})}))),(0,m.y)(B)&&B.getOptions&&M.addCategory(B.getOptions()),M}function C({panelLinks:S}){const{rawLinks:M}=S?S.useState():{rawLinks:[]};return(0,t.jsx)(a.e,{links:M,onChange:O=>S?.setState({rawLinks:O}),getSuggestions:o.Fq,data:[]})}function l({panel:S}){const{title:M}=S.useState();return(0,t.jsx)(i.p,{"data-testid":n.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),value:M,onChange:O=>P(S,O.currentTarget.value)})}function v({panel:S}){const{description:M}=S.useState();return(0,t.jsx)(x.f,{id:"description-text-area",value:M,onChange:O=>S.setState({description:O.currentTarget.value})})}function y({panel:S}){const{displayMode:M}=S.useState();return(0,t.jsx)(s.d,{value:M==="transparent",id:"transparent-background",onChange:()=>{S.setState({displayMode:S.state.displayMode==="transparent"?"default":"transparent"})}})}function P(S,M){S.setState({title:M,hoverHeader:b(M,S.state.$timeRange)})}function b(S,M){return!(S!==""||M instanceof E.v&&!M.state.hideTimeOverride&&(M.state.timeFrom||M.state.timeShift))}},96129:(q,j,e)=>{"use strict";e.d(j,{L:()=>r});var t=e(96540),n=e(13147);function r(a){const{paneOptions:i}=a,[x,s]=(0,t.useState)({collapsed:a.collapsed??!1,snapSize:a.collapsed?0:void 0}),c=(0,t.useCallback)((f,p)=>{if(f<=0&&p<=0)return;const h=p/f*(1-f);x.collapsed&&h>i.collapseBelowPixels&&s({collapsed:!1}),!x.collapsed&&h<i.collapseBelowPixels&&s({collapsed:!0})},[x,i.collapseBelowPixels]),d=(0,t.useCallback)((f,p)=>{if(f<=0&&p<=0)return;const h=1-f,D=x.snapSize===0,C=p/f,v=(i.snapOpenToPixels??C/2)/C;x.collapsed?s(D?{snapSize:Math.max(h,v),collapsed:!1}:{snapSize:0,collapsed:!0}):D&&s({snapSize:h,collapsed:!1})},[x,i.snapOpenToPixels]),u=(0,t.useCallback)(()=>{s({collapsed:!x.collapsed})},[x.collapsed]),{containerProps:g,primaryProps:o,secondaryProps:E,splitterProps:m}=(0,n.h)({direction:a.direction,dragPosition:a.dragPosition,handleSize:a.handleSize,initialSize:a.initialSize,onResizing:c,onSizeChanged:d});return E.style.overflow="hidden",E.style.minWidth="unset",E.style.minHeight="unset",x.snapSize?(o.style={...o.style,flexGrow:1-x.snapSize},E.style.flexGrow=x.snapSize):x.snapSize===0&&(o.style.flexGrow=1,E.style.flexGrow=0,E.style.minWidth="unset",E.style.minHeight="unset",E.style.overflow="unset"),{containerProps:g,primaryProps:o,secondaryProps:E,splitterProps:m,splitterState:x,onToggleCollapse:u}}},81559:(q,j,e)=>{"use strict";e.d(j,{l:()=>m});var t=e(2543),n=e(61034),r=e(89956);const a=()=>new r.c(new URL(e.p+e.u(9838),e.b));var i=e(62652),x=e(51085),s=e(11997),c=e(72929),d=e(3987),u=e(36054),g=e(60101),o=e(10817),E=e(23672);class m{constructor(h){this._dashboard=h}static isUpdatingPersistedState({payload:h}){return Object.keys(h.partialUpdate).length===0?!1:!!(h.changedObject instanceof n.Eb||h.changedObject instanceof g.U||h.changedObject instanceof u.v||h.changedObject instanceof n.dt&&!Object.prototype.hasOwnProperty.call(h.partialUpdate,"data")||h.changedObject instanceof n.Es&&!Object.prototype.hasOwnProperty.call(h.partialUpdate,"data")||h.changedObject instanceof d.$||h.changedObject instanceof n.WM&&(Object.prototype.hasOwnProperty.call(h.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(h.partialUpdate,"refresh"))||h.changedObject instanceof c.u&&Object.prototype.hasOwnProperty.call(h.partialUpdate,"name")||h.changedObject instanceof n.Gg.K2||h.changedObject instanceof n.kh||h.changedObject instanceof g.U||h.changedObject instanceof n.hy||h.changedObject instanceof s.H$&&Object.keys(h.partialUpdate).some(D=>s.vk.includes(D))||h.changedObject instanceof n.JZ||h.changedObject instanceof x.x&&Object.prototype.hasOwnProperty.call(h.partialUpdate,"hideTimeControls")||h.changedObject instanceof n.Pj||h.changedObject instanceof i.g&&!Object.prototype.hasOwnProperty.call(h.partialUpdate,"data")||h.changedObject instanceof n.Gg.en||(0,E.c7)(h.changedObject))}detectSaveModelChanges(){const h=(0,o.Uy)(this._dashboard),D=this._dashboard.getInitialSaveModel(),C=typeof h=="object"?JSON.parse(JSON.stringify(h)):h,l=typeof D=="object"?JSON.parse(JSON.stringify(D)):D;this._changesWorker?.postMessage({initial:l,changed:C})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(h){const{hasChanges:D}=h;D||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=a()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=D=>{this.updateIsDirty(D.data)};const h=f(this.detectSaveModelChanges.bind(this));this._changeTrackerSub=this._dashboard.subscribeToEvent(n.bZ,D=>{m.isUpdatingPersistedState(D)&&h()})}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}function f(p){return(0,t.debounce)(p,250)}},80727:(q,j,e)=>{"use strict";e.d(j,{AM:()=>i,Cj:()=>x,yO:()=>g});var t=e(91354);function n(o,E){try{let m=o;for(const f of E)m=m[f];return m}catch{return}}function r(o,E){return typeof o==typeof E&&(typeof o=="string"&&o===E||Array.isArray(o)&&o.length===E.length&&o.every((m,f)=>m===E[f]))}function a(o,E){return o===E||o&&E&&o.selected===E.selected&&r(o.text,E.text)&&r(o.value,E.value)}function i(o,E,m,f,p){const h=o,D=E,C=s(D.timeSettings,h.timeSettings),l=d(D,h,f),v=D.timeSettings.autoRefresh!==h.timeSettings.autoRefresh;m||(D.timeSettings.from=h.timeSettings.from,D.timeSettings.to=h.timeSettings.to),p||(D.timeSettings.autoRefresh=h.timeSettings.autoRefresh);const y=(0,t.G4)(h,D),P=Object.values(y).reduce((b,S)=>b+S.length,0);return{changedSaveModel:D,initialSaveModel:h,diffs:y,diffCount:P,hasChanges:P>0,hasTimeChanges:C,hasVariableValueChanges:l,hasRefreshChange:v}}function x(o,E,m,f,p){const h=o,D=E,C=s(D.time,h.time),l=u(D,h,f),v=D.refresh!==h.refresh;m||(D.time=h.time),p||(D.refresh=h.refresh);const y=(0,t.G4)(h,D),P=Object.values(y).reduce((b,S)=>b+S.length,0);return{changedSaveModel:D,initialSaveModel:h,diffs:y,diffCount:P,hasChanges:P>0,hasTimeChanges:C,isNew:D.version===0,hasVariableValueChanges:l,hasRefreshChange:v}}function s(o={},E={}){return o.from!==E.from||o.to!==E.to}function c(o,E){if(o===void 0&&E===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(o===void 0&&E!==void 0||E===void 0&&o!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(o?.length!==E?.length)return!1;for(let m=0;m<(o?.length??0);m++){const f=o?.[m],p=E?.[m];if(f?.key!==p?.key||f?.operator!==p?.operator||f?.value!==p?.value)return!1}return!0}function d(o,E,m){const f=E.variables??[],p=o.variables??[];let h=!1;for(const D of p){const C=y=>y.kind==="QueryVariable"||y.kind==="CustomVariable"||y.kind==="DatasourceVariable"||y.kind==="ConstantVariable"||y.kind==="IntervalVariable"||y.kind==="TextVariable"||y.kind==="GroupByVariable",l=y=>y.kind==="QueryVariable"||y.kind==="CustomVariable"||y.kind==="DatasourceVariable"||y.kind==="IntervalVariable"||y.kind==="GroupByVariable",v=f.find(({spec:y,kind:P})=>y.name===D.spec.name&&P===D.kind);v&&((C(D)&&C(v)&&!a(D.spec.current,v.spec.current)||D.kind==="AdhocVariable"&&v.kind==="AdhocVariable"&&!c(D.spec.filters,v.spec.filters))&&(h=!0),m||(D.kind==="AdhocVariable"?D.spec.filters=v.spec.filters:(C(D)&&C(v)&&(D.spec.current=v.spec.current),l(D)&&l(v)&&(D.spec.options=v.spec.options))))}return h}function u(o,E,m){const f=E.templating?.list??[],p=o.templating?.list??[];let h=!1;for(const D of p){const C=f.find(({name:l,type:v})=>l===D.name&&v===D.type);if(C&&(C.current&&delete C.current.selected,a(D.current,C.current)?D.type==="adhoc"&&!c(D?.filters,C?.filters)&&(h=!0):h=!0,!m)){const l=D;l.type==="adhoc"?l.filters=C.filters:(D.current=C.current,D.options=C.options)}}return h}function g(o,E){const m=(0,t.G4)(E,o),f=Object.values(m).reduce((p,h)=>p+h.length,0);return{changedSaveModel:o,initialSaveModel:E,diffs:m,diffCount:f,hasChanges:f>0}}},82991:(q,j,e)=>{"use strict";e.d(j,{C:()=>y,S:()=>P});var t=e(65474),n=e(81160),r=e(7500),a=e(91323),i=e(4038),x=e(8392),s=e(32370),c=e(61034),d=e(23737),u=e(17687),g=e(87638),o=e(44608),E=e(5240),m=e(76204),f=e(83466),p=e(88214),h=e(82700),D=e(83394),C=e(61491),l=e(51876),v=e(2044);class y extends c.VE{constructor(S){super({isEnabled:!0,...S,isHidden:!0}),this.hasAlertRules=!0,this.topic=r.QR.AlertStates,this.handleError=M=>{const O=(0,u.gi)("AlertStatesDataLayer",(0,o.q6)(M));(0,D.JD)((0,d.dx)(O))}}onEnable(){const S=c.jh.getTimeRange(this);this._timeRangeSub=S.subscribeToState(()=>{this.runWithTimeRange(S)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const S=c.jh.getTimeRange(this);this.runWithTimeRange(S)}async runWithTimeRange(S){const M=(0,v.YQ)(this),{uid:O,id:R}=M.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(S))return;const L=async()=>{const I=await(0,D.JD)(E.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:p.hY,dashboardUid:O},{forceRefetch:!0}));if(I.error)throw new Error("Unexpected alert rules response.");return I.data},F=(0,t.H)(L()).pipe((0,n.T)(I=>(0,m.Kw)(I))).pipe((0,n.T)(I=>{this.hasAlertRules=!1;const U={};return I.forEach(W=>W.rules.forEach(A=>{if((0,h.Z8)(A)&&A.annotations&&A.annotations[f.YH.panelID]){this.hasAlertRules=!0;const N=Number(A.annotations[f.YH.panelID]),K=P(A.state);U[N]?K===a.O.Alerting&&U[N].state!==a.O.Alerting?U[N].state=a.O.Alerting:K===a.O.Pending&&U[N].state!==a.O.Alerting&&U[N].state!==a.O.Pending&&(U[N].state=a.O.Pending):U[N]={state:K,id:Object.keys(U).length,panelId:N,dashboardId:R}}})),Object.values(U)}));this.querySub=F.subscribe({next:I=>{const U=(0,i.Vc)(I);this.publishResults({state:x.Gu.Done,series:[{...U,meta:{...U.meta,dataTopic:r.QR.AlertStates}}],timeRange:S.state.value})},error:I=>{this.handleError(I),this.publishResults({state:x.Gu.Error,series:[],errors:[{message:(0,o.q6)(I)}],timeRange:S.state.value})}})}canWork(S){const M=(0,v.YQ)(this),{uid:O}=M.state;return!(!O||s.$.publicDashboardAccessToken||S.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(g.TP.hasPermission(C.AccessControlAction.AlertingRuleRead)&&g.TP.hasPermission(C.AccessControlAction.AlertingRuleExternalRead)))}}function P(b){return b===l.cF.Firing?a.O.Alerting:b===l.cF.Pending?a.O.Pending:a.O.OK}},62652:(q,j,e)=>{"use strict";e.d(j,{g:()=>s});var t=e(55801),n=e(75906),r=e(7500),a=e(32370),i=e(61034),x=e(76019);class s extends i.tV.g{async resolveDataSource(d){return a.$.publicDashboardAccessToken?new x.X:super.resolveDataSource(d)}processEvents(d,u){if(a.$.publicDashboardAccessToken){const g={series:[],timeRange:(0,t.E2)(),state:u.state},o=(0,n.I)(u.events);return o.meta={...o.meta,dataTopic:r.QR.Annotations},g.annotations=[o],g}else return super.processEvents(d,u)}}},51085:(q,j,e)=>{"use strict";e.d(j,{x:()=>D});var t=e(74848),n=e(22803),r=e(14964),a=e(58779),i=e(61034),x=e(29675),s=e(90231),c=e(48583),d=e(29010);function u({panelEditor:v}){const{tableView:y,dataPane:P}=v.useState();return(0,t.jsx)(t.Fragment,{children:P&&(0,t.jsx)(d.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!y,onClick:v.onToggleTableView,"aria-label":"toggle-table-view","data-testid":a.Tp.components.PanelEditor.toggleTableView})})}var g=e(2044),o=e(84099),E=e(6736),m=e(92498),f=e(89146),p=e(80342);function h({links:v,dashboard:y}){i.jh.getTimeRange(y).useState();const P=y.state.uid;return!v||!P?null:(0,t.jsx)(t.Fragment,{children:v.map((b,S)=>{const M=(0,f.mQ)().getAnchorInfo(b),O=`${b.title}-$${S}`;if(b.type==="dashboards")return(0,t.jsx)(m.aK,{link:b,linkInfo:M,dashboardUID:P},O);const R=p.G[b.icon],L=(0,t.jsx)(m.Zx,{icon:R,href:(0,o.Jf)(M.href),target:b.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":a.Tp.components.DashboardLinks.link,children:M.title});return(0,t.jsx)("div",{"data-testid":a.Tp.components.DashboardLinks.container,children:b.tooltip?(0,t.jsx)(E.m,{content:M.tooltip,children:L}):L},O)})})}class D extends i.Bs{constructor(y){super({variableControls:[],timePicker:y.timePicker??new i.KE({}),refreshPicker:y.refreshPicker??new i.WM({}),...y}),this._variableDependency=new i.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new i.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let P;return this.state.hideTimeControls&&(P=this.state.refreshPicker.activate()),()=>{P&&P()}})}static{this.Component=C}getUrlState(){return{}}updateFromUrl(y){const{hideTimeControls:P,hideVariableControls:b,hideLinksControls:S}=this.state,M=O=>y[O]==="true"||y[O]==="";!P&&M("_dash.hideTimePicker")&&this.setState({hideTimeControls:!0}),!b&&M("_dash.hideVariables")&&this.setState({hideVariableControls:!0}),!S&&M("_dash.hideLinks")&&this.setState({hideLinksControls:!0})}_onAnyVariableChanged(){(0,g.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const y=i.jh.getVariables(this)?.state.variables.some(R=>R.state.hide!==r.zL.hideVariable),P=i.jh.getDataLayers(this).some(R=>R.state.isEnabled&&!R.state.isHidden),b=(0,g.YQ)(this).state.links?.length>0,S=this.state.hideLinksControls||!b,M=this.state.hideVariableControls||!P&&!y,O=this.state.hideTimeControls;return!(M&&S&&O)}}function C({model:v}){const{variableControls:y,refreshPicker:P,timePicker:b,hideTimeControls:S,hideVariableControls:M,hideLinksControls:O}=v.useState(),R=(0,g.YQ)(v),{links:L,editPanel:B}=R.useState(),F=(0,x.of)(l),I=location.search.includes("scene-debugger");return v.hasControls()?(0,t.jsxs)("div",{"data-testid":a.Tp.pages.Dashboard.Controls,className:(0,n.cx)(F.controls,B&&F.controlsPanelEdit),children:[(0,t.jsxs)(c.B,{grow:1,wrap:"wrap",children:[!M&&y.map(U=>(0,t.jsx)(U.Component,{model:U},U.state.key)),(0,t.jsx)(s.a,{grow:1}),!O&&!B&&(0,t.jsx)(h,{links:L,dashboard:R}),B&&(0,t.jsx)(u,{panelEditor:B})]}),!S&&(0,t.jsxs)(c.B,{justifyContent:"flex-end",children:[(0,t.jsx)(b.Component,{model:b}),(0,t.jsx)(P.Component,{model:P})]}),I&&(0,t.jsx)(i.or,{scene:v},"scene-debugger")]}):(0,t.jsx)(s.a,{padding:1})}function l(v){return{controls:(0,n.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:v.spacing(1),padding:v.spacing(2),flexDirection:"row",flexWrap:"nowrap",position:"relative",width:"100%",marginLeft:"auto",[v.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),controlsPanelEdit:(0,n.css)({paddingRight:0}),embedded:(0,n.css)({background:"unset",position:"unset"})}}},7001:(q,j,e)=>{"use strict";e.d(j,{s:()=>r});var t=e(74848),n=e(61034);class r extends n.ps{constructor(i){super({...i,name:i.name??"Data layers",annotationLayers:i.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((i,x)=>{i.annotationLayers!==x.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(i){this.setState({annotationLayers:[...this.state.annotationLayers,i]})}getAllLayers(){const i=[...this.state.annotationLayers];return this.state.alertStatesLayer&&i.push(this.state.alertStatesLayer),i}static{this.Component=({model:i})=>{const{annotationLayers:x}=i.useState();return(0,t.jsx)(t.Fragment,{children:x.map(s=>(0,t.jsx)(s.Component,{model:s},s.state.key))})}}}},79938:(q,j,e)=>{"use strict";e.d(j,{L:()=>i});var t=e(61034),n=e(11747),r=e(5956),a=e(2044);class i extends t.Bs{constructor(s){super(s),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const s=this.parent;let c,d,u;if(!(s instanceof t.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(!this.containsDashboardDSQueries(s))return;try{u=(0,a.YQ)(s)}catch{return}const g=s.state.queries.find(D=>D.panelId!==void 0);if(!g)return;const o=g.panelId,E=(0,a.XA)(o),m=(0,a.EX)(u,E);if(!(m instanceof t.Eb))return;const f=(0,a.iL)(m);if(f&&!f.state.isLoaded){c=f.subscribeToState(D=>{this.handleLibPanelStateUpdates(D,s,m)});return}const p=(0,a.un)(m);if(!p)throw new Error("Could not find SceneQueryRunner for panel");const h=p.parent;return h instanceof t.Es&&h.state.transformations.length&&(d=h.subscribeToState((D,C)=>{D.data!==C.data&&s.runQueries()})),this.prevRequestId&&this.prevRequestId!==p.state.data?.request?.requestId&&s.runQueries(),()=>{this.prevRequestId=p?.state.data?.request?.requestId,c&&c.unsubscribe(),d&&d.unsubscribe()}}containsDashboardDSQueries(s){return s.state.datasource?.uid===n.K?!0:s.state.datasource?.uid===r.uv&&s.state.queries.some(c=>c.datasource?.uid===n.K)}handleLibPanelStateUpdates(s,c,d){if(s&&s?.isLoaded){if(!((0,a.un)(d)instanceof t.dt))throw new Error("Could not find SceneQueryRunner for library panel");c.runQueries()}}}},65302:(q,j,e)=>{"use strict";e.d(j,{M:()=>a});var t=e(61034),n=e(2044);class r{constructor(x,s){this._sceneObject=s,this.state={name:x,type:"dashboard_macro"}}getValue(x){const s=(0,n.YQ)(this._sceneObject);switch(x){case"uid":return s.state.uid||"";case"title":case"name":case"id":default:return s.state.title}}getValueText(){return""}}function a(){const i=t.Go.registerVariableMacro("__dashboard",r);return()=>i()}},12035:(q,j,e)=>{"use strict";e.d(j,{s:()=>x});var t=e(2543),n=e.n(t),r=e(61034),a=e(81635),i=e(44172);class x extends r.Bs{constructor(c){const d=c.reloadOnParamsChange&&c.uid;super(c),this.reloadDashboard=(0,t.debounce)(this.reloadDashboard).bind(this),d&&this.addActivationHandler(()=>{(0,a.DF)(this)?.setState({handler:this.reloadDashboard}),this._variableDependency=new r.Sh(this,{onAnyVariableChanged:this.reloadDashboard}),this._subs.add(r.jh.getTimeRange(this).subscribeToState((u,g)=>{(0,t.isEqual)(u.value,g.value)||this.reloadDashboard()})),this.reloadDashboard()})}isEditing(){return this.parent&&"isEditing"in this.parent.state&&this.parent.state.isEditing}isWaitingForVariables(){const c=r.jh.getVariables(this.parent);return c.state.variables.some(d=>c.isVariableLoadingOrWaitingToUpdate(d))}reloadDashboard(){if(!this.isEditing()&&!this.isWaitingForVariables()){const c=r.jh.getTimeRange(this);setTimeout(()=>{(0,i.sP)().reloadDashboard({version:this.state.version,scopes:(0,a.DF)(this)?.value.map(d=>d.metadata.name)??[],timeRange:{from:c.state.value.from.toISOString(),to:c.state.value.to.toISOString()},variables:r.jh.getVariables(this).state.variables.reduce((d,u)=>({...d,...u.urlSync?.getUrlState()}),{})})})}}}},11997:(q,j,e)=>{"use strict";e.d(j,{H$:()=>ur,vk:()=>qs});var t=e(2567),n=e(52718),r=e(16753),a=e(53027),i=e(32370),x=e(86833),s=e(61034),c=e(22492),d=e(40828),u=e(12636),g=e(82856),o=e(31788),E=e(16910),m=e(36503),f=e(63845),p=e(10474),h=e(81635),D=e(76802),C=e(91830),l=e(74848),v=e(22803),y=e(33149),P=e(96540),b=e(29675),S=e(52120),M=e(10247),O=e(88849),R=e(11817),L=e(9964),B=e(2044),F=e(58779),I=e(90231),U=e(6210),W=e(79784),A=e(83424);function N({editPane:Ae}){const pe=(0,B.YQ)(Ae);return(0,l.jsxs)(I.a,{display:"flex",direction:"column",gap:1,padding:2,children:[(0,l.jsxs)(U.Z,{onClick:()=>pe.onCreateNewPanel(),"data-testid":F.Tp.components.PageToolbar.itemButton("add_visualization"),title:(0,R.t)("dashboard.toolbar.add-panel-description","A container for visualizations and other content"),children:[(0,l.jsx)(U.Z.Heading,{children:(0,l.jsx)(R.x6,{i18nKey:"dashboard.toolbar.add-panel",children:"Panel"})}),(0,l.jsx)(U.Z.Figure,{children:(0,l.jsx)(W.I,{name:"graph-bar",size:"xl"})})]}),(0,l.jsxs)(U.Z,{onClick:()=>{pe.onShowAddLibraryPanelDrawer(),A.c.toolbarAddButtonClicked({item:"add_library_panel"})},"data-testid":F.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),title:(0,R.t)("dashboard.toolbar.libray-panel-description","Libray panels allow you share and reuse panels between dashboards"),children:[(0,l.jsx)(U.Z.Heading,{children:(0,l.jsx)(R.x6,{i18nKey:"dashboard.toolbar.add-panel-lib",children:"Import library panel"})}),(0,l.jsx)(U.Z.Figure,{children:(0,l.jsx)(W.I,{name:"import",size:"xl"})})]}),(0,l.jsxs)(U.Z,{onClick:()=>pe.onCreateNewRow(),"data-testid":F.Tp.components.PageToolbar.itemButton("add_row"),title:(0,R.t)("dashboard.toolbar.row-description","A group of panels with an optional header"),children:[(0,l.jsx)(U.Z.Heading,{children:(0,l.jsx)(R.x6,{i18nKey:"dashboard.toolbar.add-row",children:"Row"})}),(0,l.jsx)(U.Z.Figure,{children:(0,l.jsx)(W.I,{name:"list-ul",size:"xl"})})]}),(0,l.jsxs)(U.Z,{onClick:()=>pe.onCreateNewTab(),"data-testid":F.Tp.components.PageToolbar.itemButton("add_tab"),title:(0,R.t)("dashboard.toolbar.tabs-description","Break up your dashboard into different horizontal tabs"),children:[(0,l.jsx)(U.Z.Heading,{children:(0,l.jsx)(R.x6,{i18nKey:"dashboard.toolbar.add-tab",children:"Tab"})}),(0,l.jsx)(U.Z.Figure,{children:(0,l.jsx)(W.I,{name:"layer-group",size:"xl"})})]})]})}var K=e(48583),V=e(20621);function T({element:Ae}){const pe=Ae.useEditPaneOptions?Ae.useEditPaneOptions():[],We=(0,b.of)(z);return(0,l.jsxs)(K.B,{direction:"column",gap:0,children:[Ae.renderActions&&(0,l.jsx)(V.D,{id:"selected-item",title:Ae.typeName,isOpenDefault:!0,className:We.noBorderTop,children:(0,l.jsx)("div",{className:We.actionsBox,children:Ae.renderActions()})}),pe.map(et=>et.render())]})}function z(Ae){return{noBorderTop:(0,v.css)({borderTop:"none"}),actionsBox:(0,v.css)({display:"flex",alignItems:"center",gap:Ae.spacing(1),paddingBottom:Ae.spacing(1)})}}function w(Ae){return"onDelete"in Ae}function H(Ae){return"isEditableDashboardElement"in Ae}var G=e(34128),X=e(50926),k=e(12422),_=e(12600),ee=e(98933);class J{constructor(pe){this.dashboard=pe,this.isEditableDashboardElement=!0,this.typeName="Dashboard"}useEditPaneOptions(){const pe=this.dashboard,{body:We}=pe.useState(),et=(0,P.useMemo)(()=>new k.C({title:(0,R.t)("dashboard.options.title","Dashboard options"),id:"dashboard-options",isOpenDefault:!0}).addItem(new _.v({title:(0,R.t)("dashboard.options.title-option","Title"),render:function(){return(0,l.jsx)(Z,{dashboard:pe})}})).addItem(new _.v({title:(0,R.t)("dashboard.options.description","Description"),render:function(){return(0,l.jsx)(te,{dashboard:pe})}})),[pe]),At=(0,ee.W)(We);return[et,At]}}function Z({dashboard:Ae}){const{title:pe}=Ae.useState();return(0,l.jsx)(G.p,{value:pe,onChange:We=>Ae.setState({title:We.currentTarget.value})})}function te({dashboard:Ae}){const{description:pe}=Ae.useState();return(0,l.jsx)(X.f,{value:pe,onChange:We=>Ae.setState({title:We.currentTarget.value})})}var ae=e(24726),re=e(45565),ne=e(54594);class ce{constructor(pe){this._elements=pe,this.isMultiSelectedEditableDashboardElement=!0,this.typeName="Objects",this.key=(0,ae.A)()}renderActions(){return(0,l.jsxs)(K.B,{direction:"column",children:[(0,l.jsx)(re.E,{children:(0,l.jsxs)(R.x6,{i18nKey:"dashboard.edit-pane.objects.multi-select.selection-number",values:{length:this._elements.length},children:["No. of objects selected: ",{length}]})}),(0,l.jsxs)(K.B,{direction:"row",children:[(0,l.jsx)(ne.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,l.jsx)(ne.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:()=>this.onDelete(),icon:"trash-alt"})]})]})}onDelete(){this._elements.forEach(pe=>pe.onDelete())}}var le=e(18745);class he{constructor(pe){this._panels=pe,this.isMultiSelectedEditableDashboardElement=!0,this.typeName="Panels",this.key=(0,ae.A)()}renderActions(){return(0,l.jsxs)(K.B,{direction:"column",children:[(0,l.jsx)(re.E,{children:(0,l.jsxs)(R.x6,{i18nKey:"dashboard.edit-pane.panels.multi-select.selection-number",values:{length:this._panels.length},children:["No. of panels selected: ",{length}]})}),(0,l.jsxs)(K.B,{direction:"row",children:[(0,l.jsx)(ne.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,l.jsx)(ne.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:()=>this.onDelete(),icon:"trash-alt"})]})]})}onDelete(){this._panels.forEach(pe=>{le.b4.getLayoutManagerFor(pe).removePanel?.(pe)})}}var oe=e(4527),de=e(48366),me=e(29679);class Pe{constructor(pe){this.panel=pe,this.isEditableDashboardElement=!0,this.typeName="Panel",this.onDelete=()=>{le.b4.getLayoutManagerFor(this.panel).removePanel?.(this.panel)}}useEditPaneOptions(){const pe=this.panel,We=pe.parent,et=(0,P.useMemo)(()=>new k.C({title:(0,R.t)("dashboard.viz-panel.options.title","Panel options"),id:"panel-options",isOpenDefault:!0}).addItem(new _.v({title:(0,R.t)("dashboard.viz-panel.options.title-option","Title"),value:pe.state.title,popularRank:1,render:function(){return(0,l.jsx)(de.m,{panel:pe})}})).addItem(new _.v({title:(0,R.t)("dashboard.viz-panel.options.description","Description"),value:pe.state.description,render:function(){return(0,l.jsx)(de.dF,{panel:pe})}})).addItem(new _.v({title:(0,R.t)("dashboard.viz-panel.options.transparent-background","Transparent background"),render:function(){return(0,l.jsx)(de.R4,{panel:pe})}})),[pe]),At=(0,P.useMemo)(()=>{if((0,me.y)(We)&&We.getOptions)return We.getOptions()},[We]),{options:Nt,fieldConfig:_t,_pluginInstanceState:rn}=pe.useState(),An=s.jh.getData(pe),{data:en}=An.useState(),Nn=(0,P.useMemo)(()=>{const os=pe.getPlugin();return os?(0,oe.Z4)({panel:pe,data:en,plugin:os,eventBus:pe.getPanelContext().eventBus,instanceState:rn}):[]},[en,pe,Nt,_t,rn]),as=[et];return At&&as.push(At),as.push(...Nn),as}renderActions(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ne.$n,{size:"sm",variant:"secondary",children:(0,l.jsx)(R.x6,{i18nKey:"panel.header-menu.edit",children:"Edit"})}),(0,l.jsx)(ne.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,l.jsx)(ne.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:this.onDelete,icon:"trash-alt"})]})}}class Ee{constructor(pe){this.selectedObjects=new Map(pe),this._isMultiSelection=pe.length>1,this.isMultiSelection&&(this.sameType=this.checkSameType())}checkSameType(){const pe=this.selectedObjects?.values(),We=pe?.next().value?.resolve()?.constructor.name;if(!We)return!1;for(let et of pe??[])if(et.resolve()?.constructor.name!==We)return!1;return!0}hasValue(pe){return this.selectedObjects?.has(pe)}removeValue(pe){this.selectedObjects?.delete(pe),this.selectedObjects&&this.selectedObjects.size<2&&(this.sameType=void 0,this._isMultiSelection=!1)}getStateWithValue(pe,We,et){const At=We.getRef();let Nt=[{id:pe}],_t=[[pe,At]];const rn=this.getSelectionEntries()??[],An=rn.map(([en])=>({id:en}));return et&&(_t=[[pe,At],...rn],Nt=[{id:pe},...An]),{selection:_t,contextItems:Nt}}getStateWithoutValueAt(pe){this.removeValue(pe);const We=this.getSelectionEntries()??[],et=We.map(([At])=>({id:At}));return{entries:We,contextItems:et}}getSelection(){return this.isMultiSelection?this.getSceneObjects():this.getFirstObject()}getSelectionEntries(){return Array.from(this.selectedObjects?.entries()??[])}getFirstObject(){return this.selectedObjects?.values().next().value?.resolve()}get isMultiSelection(){return this._isMultiSelection}getSceneObjects(){return Array.from(this.selectedObjects?.values()??[]).map(pe=>pe.resolve())}createSelectionElement(){return this.isMultiSelection?this.createMultiSelectedElement():this.createSingleSelectedElement()}createSingleSelectedElement(){const pe=this.selectedObjects?.values().next().value?.resolve();if(pe){if(H(pe))return pe;if(pe instanceof s.Eb)return new Pe(pe);if(pe instanceof ur)return new J(pe)}}createMultiSelectedElement(){if(!this.isMultiSelection)return;const pe=this.getSceneObjects();if(this.sameType){const et=this.selectedObjects?.values().next().value?.resolve();if(et instanceof s.Eb)return new he(pe.filter(At=>At instanceof s.Eb));if(H(et))return et.createMultiSelectedElement?.(pe)}const We=[];for(const et of pe){if(et instanceof s.Eb){const At=new Pe(et);We.push(At)}w(et)&&We.push(et)}if(We.length)return new ce(We)}}function be(Ae){return(0,P.useMemo)(()=>{if(Ae)return Ae.createSelectionElement()},[Ae])}class Se extends s.Bs{constructor(){super({selectionContext:{enabled:!1,selected:[],onSelect:(pe,We)=>this.selectElement(pe,We)}}),this.onChangeTab=pe=>{this.setState({tab:pe})}}enableSelection(){this.setState({selectionContext:{...this.state.selectionContext,enabled:!0}})}disableSelection(){this.setState({selectionContext:{...this.state.selectionContext,selected:[],enabled:!1},selection:void 0})}selectElement(pe,We){if((0,L.uc)(pe.id)){if(We)return;this.clearSelection();return}const et=s.jh.findByKey(this,pe.id);et&&this.selectObject(et,pe.id,We)}selectObject(pe,We,et){if(!this.state.selection)return;if(this.state.selection.getFirstObject()===pe&&!et){this.clearSelection();return}if(et&&this.state.selection.hasValue(We)){this.removeMultiSelectedObject(We);return}const{selection:Nt,contextItems:_t}=this.state.selection.getStateWithValue(We,pe,!!et);this.setState({selection:new Ee(Nt),selectionContext:{...this.state.selectionContext,selected:_t}})}removeMultiSelectedObject(pe){if(!this.state.selection)return;const{entries:We,contextItems:et}=this.state.selection.getStateWithoutValueAt(pe);if(We.length===0){this.clearSelection();return}this.setState({selection:new Ee([...We]),selectionContext:{...this.state.selectionContext,selected:et}})}clearSelection(){const pe=(0,B.YQ)(this);this.state.selection?.getFirstObject()!==pe&&this.setState({selection:new Ee([[pe.state.uid,pe.getRef()]]),selectionContext:{...this.state.selectionContext,selected:[]}})}}function Xe({editPane:Ae,isCollapsed:pe,onToggleCollapse:We,openOverlay:et}){(0,P.useEffect)(()=>{if(!Ae.state.selection){const en=(0,B.YQ)(Ae);Ae.setState({selection:new Ee([[en.state.uid,en.getRef()]])})}return Ae.enableSelection(),()=>{Ae.disableSelection()}},[Ae]),(0,P.useEffect)(()=>{pe&&Ae.state.selection?.getSelectionEntries().length&&Ae.clearSelection()},[Ae,pe]);const{selection:At,tab:Nt="configure"}=(0,s.gn)(Ae,{shouldActivateOrKeepAlive:!0}),_t=(0,b.of)(Qe),rn=(0,P.useRef)(null),An=be(At);return An?pe?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:_t.expandOptionsWrapper,children:(0,l.jsx)(S.I,{tooltip:(0,R.t)("dashboard.edit-pane.open","Open options pane"),icon:"arrow-to-right",onClick:We,variant:"canvas",className:_t.rotate180,"aria-label":(0,R.t)("dashboard.edit-pane.open","Open options pane")})}),et&&(0,l.jsx)(y.c,{className:(0,v.cx)(_t.fixed,_t.container),defaultSize:{height:"100%",width:"20vw"},children:(0,l.jsx)(T,{element:An},An.typeName)})]}):(0,l.jsxs)("div",{className:_t.wrapper,ref:rn,children:[(0,l.jsxs)(M.U,{className:_t.tabsbar,children:[(0,l.jsx)(O.o,{active:Nt==="add",label:(0,R.t)("dashboard.editpane.add","Add"),onChangeTab:()=>Ae.onChangeTab("add")}),(0,l.jsx)(O.o,{active:Nt==="configure",label:(0,R.t)("dashboard.editpane.configure","Configure"),onChangeTab:()=>Ae.onChangeTab("configure")}),(0,l.jsx)(O.o,{active:Nt==="outline",label:(0,R.t)("dashboard.editpane.outline","Outline"),onChangeTab:()=>Ae.onChangeTab("outline")})]}),(0,l.jsxs)("div",{className:_t.tabContent,children:[Nt==="add"&&(0,l.jsx)(N,{editPane:Ae}),Nt==="configure"&&(0,l.jsx)(T,{element:An},An.typeName),Nt==="outline"&&(0,l.jsx)("div",{})]})]}):null}function Qe(Ae){return{wrapper:(0,v.css)({display:"flex",flexDirection:"column",flex:"1 1 0"}),tabContent:(0,v.css)({display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,overflow:"auto"}),rotate180:(0,v.css)({rotate:"180deg"}),tabsbar:(0,v.css)({padding:Ae.spacing(0,1),margin:Ae.spacing(.5,1)}),expandOptionsWrapper:(0,v.css)({display:"flex",flexDirection:"column",padding:Ae.spacing(2,1)}),fixed:(0,v.css)({position:"absolute !important"}),container:(0,v.css)({right:0,background:Ae.colors.background.primary,borderLeft:`1px solid ${Ae.colors.border.weak}`,boxShadow:Ae.shadows.z3,zIndex:Ae.zIndex.navbarFixed,overflowX:"hidden",overflowY:"scroll"})}}var we=e(81559),$e=e(58528),Fe=e(56721),Te=e(76459),Le=e.n(Te),Ge=e(49785),Me=e(37e3),De=e(86489),Ke=e(29010),Ie=e(40271),Ne=e(62851),ie=e(3142),ve=e(28082);function fe(Ae){return(0,ve.NF)(Ae)&&Ae.data&&Ae.data.status==="version-mismatch"}function ge(Ae){return(0,ve.NF)(Ae)&&Ae.data&&Ae.data.status==="name-exists"}function xe(Ae){return(0,ve.NF)(Ae)&&Ae.data&&Ae.data.status==="plugin-dashboard"}function je({cancelButton:Ae,saveButton:pe}){return i.$.featureToggles.dashboardRestore?(0,l.jsxs)(Me.F,{title:(0,R.t)("save-dashboards.name-exists.title","Dashboard name already exists"),severity:"error",children:[(0,l.jsx)("p",{children:(0,l.jsx)(R.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,l.jsx)("p",{children:(0,l.jsx)(R.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,l.jsxs)(Me.F,{title:"Name already exists",severity:"error",children:[(0,l.jsx)("p",{children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsxs)(K.B,{alignItems:"center",children:[Ae,pe(!0)]})})]})}function Ve({overwrite:Ae,isLoading:pe,isValid:We,onSave:et}){return(0,l.jsx)(ne.$n,{disabled:!We||pe,icon:pe?"spinner":void 0,onClick:()=>et(Ae),variant:Ae?"destructive":"primary","data-testid":F.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:pe?"Saving...":Ae?"Save and overwrite":"Save"})}var ke=e(41053),Oe=e(56276),nt=e(17687),Je=e(19606),Be=e(15664),Ze=e(61491),tt=e(61976);function Re(Ae=!1){const pe=(0,Ze.useDispatch)(),We=(0,nt._2)(),[et]=(0,Be.e8)(),[At,Nt]=(0,ke.A)(async(_t,rn)=>{{let An=rn.rawDashboardJSON??_t.getSaveModel();rn.saveAsCopy&&(An=_t.getSaveAsModel({isNew:rn.isNew,title:rn.title,description:rn.description,copyTags:rn.copyTags}));const en=await et({dashboard:An,folderUid:rn.folderUid,message:rn.message,overwrite:rn.overwrite,showErrorAlert:!1,k8s:rn.k8s});if("error"in en)throw en.error;const Nn=en.data;_t.saveCompleted(An,Nn,rn.folderUid),c.A.publish(new C.Eu),We.success("Dashboard saved"),(0,tt.ko)(Nn.uid),Ae?(0,Oe.rR)("grafana_dashboard_copied",{name:An.title,url:Nn.url}):(0,Oe.rR)(`grafana_dashboard_${Nn.uid?"saved":"created"}`,{name:An.title,url:Nn.url});const as=a.Ny.getLocation(),os=t.I.stripBaseFromUrl(Nn.url);return os!==as.pathname&&setTimeout(()=>{a.Ny.push({pathname:os,search:as.search})}),_t.state.meta.isStarred&&pe((0,Je.TU)({id:Nn.uid,title:_t.state.title,url:os})),en.data}},[pe,We]);return{state:At,onSaveDashboard:Nt}}function at({dashboard:Ae,changeInfo:pe}){const{changedSaveModel:We}=pe,{register:et,handleSubmit:At,setValue:Nt,formState:_t,getValues:rn,watch:An}=(0,Ge.mN)({mode:"onBlur",defaultValues:{title:pe.isNew?We.title:`${We.title} Copy`,description:We.description??"",folder:{uid:Ae.state.meta.folderUid,title:Ae.state.meta.folderTitle},copyTags:!1}}),{errors:en,isValid:Nn,defaultValues:as}=_t,os=An(),{state:Bn,onSaveDashboard:Dn}=Re(!1),[ys,is]=(0,P.useState)({}),[Us,Qs]=(0,P.useState)(!1),ga=async ua=>{const Ca=rn();(await Dn(Ae,{overwrite:ua,folderUid:Ca.folder.uid,saveAsCopy:!0,isNew:pe.isNew,copyTags:Ca.copyTags,title:Ca.title,description:Ca.description})).status==="success"?Ae.closeModal():is({title:Ca.title,folderUid:Ca.folder.uid})},xs=(0,l.jsx)(ne.$n,{variant:"secondary",onClick:()=>Ae.closeModal(),fill:"outline",children:"Cancel"}),aa=ua=>{const Ca=!Nn&&Us?!0:Nn;return(0,l.jsx)(Ve,{isValid:Ca,isLoading:Bn.loading,onSave:ga,overwrite:ua})};function rr(ua){const Ca=os.title.trim()===ys.title&&os.folder.uid===ys.folderUid;return ge(ua)&&Ca?(0,l.jsx)(je,{cancelButton:xs,saveButton:aa}):(0,l.jsxs)(l.Fragment,{children:[ua&&Ca&&(0,l.jsx)(Me.F,{title:"Failed to save dashboard",severity:"error",children:ua.message&&(0,l.jsx)("p",{children:ua.message})}),(0,l.jsxs)(K.B,{alignItems:"center",children:[xs,aa(!1)]})]})}return(0,l.jsxs)("form",{onSubmit:At(()=>ga(!1)),children:[(0,l.jsx)(De.D,{label:(0,l.jsx)(yt,{onChange:Nt}),invalid:!!en.title,error:en.title?.message,children:(0,l.jsx)(G.p,{...et("title",{required:"Required",validate:st}),"aria-label":"Save dashboard title field","data-testid":F.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:Le()(async ua=>{Nt("title",ua.target.value,{shouldValidate:!0})},400)})}),(0,l.jsx)(De.D,{label:(0,l.jsx)(ze,{onChange:Nt}),invalid:!!en.description,error:en.description?.message,children:(0,l.jsx)(X.f,{...et("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})}),(0,l.jsx)(De.D,{label:"Folder",children:(0,l.jsx)(Ne.d,{onChange:(ua,Ca)=>{Nt("folder",{uid:ua,title:Ca});const la=Ae.state.meta.folderUid;Qs(ua!==la)},value:os.folder?.uid,initialTitle:as.folder.title,dashboardId:Ae.state.id??void 0,enableCreateNew:!0})}),!pe.isNew&&(0,l.jsx)(De.D,{label:"Copy tags",children:(0,l.jsx)(Ke.d,{...et("copyTags")})}),(0,l.jsx)(I.a,{paddingTop:2,children:rr(Bn.error)})]})}function yt(Ae){return(0,l.jsx)(K.B,{justifyContent:"space-between",children:(0,l.jsx)(Ie.J,{htmlFor:"description",children:"Title"})})}function ze(Ae){return(0,l.jsx)(K.B,{justifyContent:"space-between",children:(0,l.jsx)(Ie.J,{htmlFor:"description",children:"Description"})})}async function st(Ae,pe){if(Ae===pe.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await ie.P.validateNewDashboardName(pe.folder.uid??"general",Ae),!0}catch(We){return We instanceof Error?We.message:"Dashboard name is invalid"}}var ht=e(81942);function It({dashboard:Ae,drawer:pe,changeInfo:We}){const{hasChanges:et}=We,{state:At,onSaveDashboard:Nt}=Re(!1),[_t,rn]=(0,P.useState)({folderUid:Ae.state.meta.folderUid,k8s:{...Ae.state.meta.k8s}}),An=async Bn=>{(await Nt(Ae,{..._t,overwrite:Bn})).status==="success"&&(Ae.closeModal(),pe.state.onSaveSuccess?.())},en=(0,l.jsx)(ne.$n,{variant:"secondary",onClick:()=>Ae.closeModal(),fill:"outline",children:"Cancel"}),Nn=Bn=>(0,l.jsx)(Ve,{isValid:et,isLoading:At.loading,onSave:An,overwrite:Bn}),as=Bn=>Bn&&Bn.length>500;function os(Bn){if(as(_t.message)){const Dn=_t.message?.length??0;return(0,l.jsx)(Me.F,{title:(0,R.t)("save-dashboards.message-length.title","Message too long"),severity:"error",children:(0,l.jsx)("p",{children:(0,l.jsxs)(R.x6,{i18nKey:"save-dashboards.message-length.info",children:["The message is ",{messageLength:Dn}," characters, which exceeds the maximum length of 500 characters. Please shorten it before saving."]})})})}return fe(Bn)?(0,l.jsxs)(Me.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,l.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsxs)(K.B,{alignItems:"center",children:[en,Nn(!0)]})})]}):ge(Bn)?(0,l.jsx)(je,{cancelButton:en,saveButton:Nn}):xe(Bn)?(0,l.jsxs)(Me.F,{title:"Plugin dashboard",severity:"error",children:[(0,l.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,l.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsxs)(K.B,{alignItems:"center",children:[en,Nn(!0)]})})]}):(0,l.jsxs)(l.Fragment,{children:[Bn&&(0,l.jsx)(Me.F,{title:"Failed to save dashboard",severity:"error",children:(0,l.jsx)("p",{children:Bn.message})}),(0,l.jsxs)(K.B,{alignItems:"center",children:[en,Nn(!1),!et&&(0,l.jsx)("div",{children:"No changes to save"})]})]})}return(0,l.jsxs)(K.B,{gap:2,direction:"column",children:[(0,l.jsx)(Gt,{drawer:pe,changeInfo:We}),(0,l.jsx)(De.D,{label:"Message",children:(0,l.jsx)(X.f,{"aria-label":"message",value:_t.message??"",onChange:Bn=>{rn({..._t,message:Bn.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})}),os(At.error)]})}function Gt({drawer:Ae,changeInfo:pe}){const{saveVariables:We=!1,saveTimeRange:et=!1,saveRefresh:At=!1}=Ae.useState(),{hasTimeChanges:Nt,hasVariableValueChanges:_t,hasRefreshChange:rn}=pe;return(0,l.jsxs)(K.B,{direction:"column",alignItems:"flex-start",children:[Nt&&(0,l.jsx)(ht.S,{id:"save-timerange",checked:et,onChange:Ae.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":F.Tp.pages.SaveDashboardModal.saveTimerange}),rn&&(0,l.jsx)(ht.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:At,onChange:Ae.onToggleSaveRefresh,"data-testid":F.Tp.pages.SaveDashboardModal.saveRefresh}),_t&&(0,l.jsx)(ht.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:We,onChange:Ae.onToggleSaveVariables,"data-testid":F.Tp.pages.SaveDashboardModal.saveVariables})]})}var un=e(4213),vn=e.n(un),pn=e(70713),xn=e(3886),cn=e(93604);function jn({dashboard:Ae,drawer:pe,changeInfo:We}){const et=(0,P.useMemo)(()=>JSON.stringify(We.changedSaveModel,null,2),[We]),At=(0,P.useCallback)(()=>{const Nt=new Blob([et],{type:"application/json;charset=utf-8"});(0,un.saveAs)(Nt,We.changedSaveModel.title+"-"+new Date().getTime()+".json")},[We.changedSaveModel,et]);return(0,l.jsx)("div",{className:_n.container,children:(0,l.jsxs)(K.B,{direction:"column",gap:2,grow:1,children:[(0,l.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,l.jsx)("br",{}),(0,l.jsxs)("i",{children:["See"," ",(0,l.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,l.jsx)("br",{})," ",(0,l.jsx)("br",{}),(0,l.jsx)("strong",{children:"File path: "})," ",Ae.state.meta.provisionedExternalId]}),(0,l.jsx)(Gt,{drawer:pe,changeInfo:We}),(0,l.jsx)("div",{className:_n.json,children:(0,l.jsx)(pn.default,{disableWidth:!0,children:({height:Nt})=>(0,l.jsx)(xn.B,{width:"100%",height:Nt,language:"json",showLineNumbers:!0,showMiniMap:et.length>100,value:et,readOnly:!0})})}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsxs)(K.B,{gap:2,children:[(0,l.jsx)(ne.$n,{variant:"secondary",onClick:pe.onClose,fill:"outline",children:"Cancel"}),(0,l.jsx)(cn.b,{icon:"copy",getText:()=>et,children:"Copy JSON to clipboard"}),(0,l.jsx)(ne.$n,{type:"submit",onClick:At,children:"Save JSON to file"})]})})]})})}const _n={container:(0,v.css)({height:"100%",display:"flex"}),json:(0,v.css)({flexGrow:1,maxHeight:"800px"})};class Ot extends s.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:pe})=>{const{showDiff:We,saveAsCopy:et,saveTimeRange:At,saveVariables:Nt,saveRefresh:_t}=pe.useState(),rn=pe.state.dashboardRef.resolve().getDashboardChanges(At,Nt,_t),{changedSaveModel:An,initialSaveModel:en,diffs:Nn,diffCount:as,hasFolderChanges:os}=rn,Bn=as+(os?1:0),Dn=pe.state.dashboardRef.resolve(),{meta:ys}=Dn.useState(),{provisioned:is,folderTitle:Us}=ys,Qs=(0,l.jsxs)(M.U,{children:[(0,l.jsx)(O.o,{label:"Details",active:!We,onChangeTab:()=>pe.setState({showDiff:!1})}),Bn>0&&(0,l.jsx)(O.o,{label:"Changes",active:We,onChangeTab:()=>pe.setState({showDiff:!0}),counter:Bn})]});let ga="Save dashboard";et?ga="Save dashboard copy":is&&(ga="Provisioned dashboard");const xs=()=>We?(0,l.jsx)(Fe.l,{diff:Nn,oldValue:en,newValue:An,hasFolderChanges:os,oldFolder:Dn.getInitialState()?.meta.folderTitle,newFolder:Us}):et||rn.isNew?(0,l.jsx)(at,{dashboard:Dn,changeInfo:rn}):is?(0,l.jsx)(jn,{dashboard:Dn,changeInfo:rn,drawer:pe}):(0,l.jsx)(It,{dashboard:Dn,changeInfo:rn,drawer:pe});return(0,l.jsx)($e._,{title:ga,subtitle:Dn.state.title,onClose:pe.onClose,tabs:Qs,children:xs()})}}}var Rt=e(20708),Ye=e(5597),dt=e(68131),lt=e(80727),Pt=e(10817),Bt=e(11686);class Jt{getSaveModel(pe){return(0,Pt.Uy)(pe)}getSaveAsModel(pe,We){const et=this.getSaveModel(pe);return{...et,id:null,uid:"",title:We.title||"",description:We.description||void 0,tags:We.isNew||We.copyTags?et.tags:[]}}getDashboardChangesFromScene(pe,We){const et=this.getSaveModel(pe),At=(0,lt.Cj)(this.initialSaveModel,et,We.saveTimeRange,We.saveVariables,We.saveRefresh),Nt=pe.getInitialState()?.meta.folderUid!==pe.state.meta.folderUid;return{...At,hasFolderChanges:Nt,hasChanges:At.hasChanges||Nt}}onSaveComplete(pe,We){this.initialSaveModel={...pe,id:We.id,uid:We.uid,version:We.version}}getTrackingInformation(){const pe=this.initialSaveModel?.panels?.map(At=>At.type)||[],We=(0,dt.GC)(pe),et=(0,dt.wM)(this.initialSaveModel?.templating?.list||[]);if(this.initialSaveModel)return{uid:this.initialSaveModel.uid,title:this.initialSaveModel.title,schemaVersion:this.initialSaveModel.schemaVersion,panels_count:this.initialSaveModel.panels?.length||0,settings_nowdelay:void 0,settings_livenow:!!this.initialSaveModel.liveNow,...We,...et}}getSnapshotUrl(){return this.initialSaveModel?.snapshot?.originalUrl}}class qt{getSaveModel(pe){return(0,Bt.Xl)(pe)}getSaveAsModel(pe,We){const et=this.getSaveModel(pe);return{...et,title:We.title||"",description:We.description||"",tags:We.isNew||We.copyTags?et.tags:[]}}getDashboardChangesFromScene(pe,We){const et=this.getSaveModel(pe),At=(0,lt.AM)(this.initialSaveModel,et,We.saveTimeRange,We.saveVariables,We.saveRefresh),Nt=pe.getInitialState()?.meta.folderUid!==pe.state.meta.folderUid,_t=!pe.getInitialState()?.uid;return{...At,hasFolderChanges:Nt,hasChanges:At.hasChanges||Nt,isNew:_t}}onSaveComplete(pe,We){this.initialSaveModel={...pe}}getTrackingInformation(pe){const We=Object.values(this.initialSaveModel?.elements??[]).filter(Nt=>Nt.kind==="Panel").map(Nt=>Nt.spec.vizConfig.kind)||[],et=(0,dt.GC)(We),At=(0,dt.z9)(this.initialSaveModel?.variables||[]);if(this.initialSaveModel)return{schemaVersion:Ye.O2,uid:pe.state.uid,title:this.initialSaveModel.title,panels_count:We.length||0,settings_nowdelay:void 0,settings_livenow:!!this.initialSaveModel.liveNow,...et,...At}}getSnapshotUrl(){return this.metadata?.annotations?.[Rt.UL]}}function gn(){return i.$.featureToggles.useV2DashboardsAPI?new qt:new Jt}var On=e(47506),Tn=e(71857),wn=e(64423),ps=e(10112),es=e(74958),ls=e(88090),Lt=e(7001),$t=e(34263),nn=e(95761);class on{constructor(pe){this._scene=pe,this.events=new ps.o,this._subs=new wn.yU;const We=s.jh.getTimeRange(pe);this.formatDate=this.formatDate.bind(this),this._subs.add(We.subscribeToState((et,At)=>{et.value!==At.value&&this.events.publish(new x.sR(et.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return s.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const pe=s.jh.getTimeRange(this._scene);return{from:pe.state.from,to:pe.state.to}}get panels(){return bn(this._scene,We=>We instanceof s.Eb).map(We=>new nn.R(We))}get annotations(){const pe={list:[]};return this._scene.state.$data instanceof Lt.s&&(pe.list=(0,$t.O)(this._scene.state.$data.state.annotationLayers)),pe}getTimezone(){return s.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const pe of this._scene.state.$behaviors)if(pe instanceof s.Gg.K2)return pe.state.sync}return es.y.Off}otherPanelInFullscreen(pe){return!1}formatDate(pe,We){return(0,ls.LE)(pe,{format:We,timeZone:this.getTimezone()})}getPanelById(pe){const We=(0,B.vL)(this._scene,(0,B.XA)(pe));return We?new nn.R(We):null}removePanel(pe){const We=(0,B.vL)(this._scene,(0,B.XA)(pe.id));if(!We){console.error("Trying to remove a panel that was not found in scene",pe);return}this._scene.removePanel(We)}canEditAnnotations(pe){return this._scene.canEditDashboard()?pe?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function bn(Ae,pe){let We=[];return Ae.forEachChild(et=>{pe(et)?We.push(et):We=We.concat(bn(et,pe))}),We}function In(Ae){let pe=5381;for(let We=0;We<Ae.length;We++)pe=pe*33^Ae.charCodeAt(We);return pe>>>0}var Yn=e(32480),zn=e(19892);class St extends s.Bs{constructor(pe){super({...pe,jsonText:""}),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onSave=()=>{},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getJsonText(){const pe=this.state.dashboardRef.resolve();return JSON.stringify((0,Bt.Xl)(pe),null,2)}static{this.Component=({model:pe})=>{const{jsonText:We}=pe.useState(),et=(0,b.of)(zt),At=()=>(0,l.jsxs)("div",{className:et.wrapper,children:[(0,l.jsx)(xn.B,{width:"100%",value:We,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:et.codeEditor,onBlur:Nt=>pe.setState({jsonText:Nt})}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsx)(ne.$n,{onClick:pe.onSave,disabled:!0,children:"Update dashboard"})})]});return(0,l.jsx)($e._,{title:"[DEV] Schema V2 editor",subtitle:"Allows editing dashboard using v2 schema. Changes are not persited in db.",onClose:pe.onClose,children:At()})}}}const zt=Ae=>({wrapper:(0,v.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ae.spacing(2)}),codeEditor:(0,v.css)({flexGrow:1})});var Qt=e(43518),an=e(72929),mn=e(60101);class yn extends s.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,B.YQ)(this).closeModal()},this.onAddLibraryPanel=pe=>{const We=(0,B.YQ)(this),et=(0,B.O8)();et.setState({title:pe.model.title,hoverHeader:!pe.model.title,$behaviors:[new an.u({uid:pe.uid,name:pe.name})]});const At=this.state.panelToReplaceRef?.resolve();if(At){const Nt=At.parent;if(!(Nt instanceof mn.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");Nt.setState({body:et})}else We.addPanel(et);this.onClose()}}static{this.Component=({model:pe})=>{const We=(0,R.t)("library-panel.add-widget.title","Add panel from panel library");return(0,l.jsx)($e._,{title:We,onClose:pe.onClose,children:(0,l.jsx)(Qt.j,{onClick:pe.onAddLibraryPanel,variant:Qt.s.Tight,showPanelFilter:!0})})}}}var Ct=e(54148),ut=e(80426),Et=e(54122),Ut=e(57862),Wt=e(79592),gt=e(94259),Vt=e(96129),Ft=e(40284),dn=e(71020);function Cn({dashboard:Ae,isEditing:pe,body:We,controls:et}){const At=(0,Ut.k)(),{editPane:Nt}=Ae.state,_t=(0,b.of)(Un,At??0),[rn,An]=(0,dn.d)();if(!i.$.featureToggles.dashboardNewLayouts)return(0,l.jsx)(gt.A,{onSetScrollRef:Ae.onSetScrollRef,children:(0,l.jsxs)("div",{className:_t.canvasWrappperOld,children:[(0,l.jsx)(Ft.c,{dashboard:Ae}),(0,l.jsx)("div",{className:_t.controlsWrapperSticky,children:et}),(0,l.jsx)("div",{className:_t.body,children:We})]})});const{containerProps:en,primaryProps:Nn,secondaryProps:as,splitterProps:os,splitterState:Bn,onToggleCollapse:Dn}=(0,Vt.L)({direction:"row",dragPosition:"end",initialSize:.8,handleSize:"sm",collapsed:rn,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});(0,P.useEffect)(()=>{An(Bn.collapsed)},[Bn.collapsed,An]);const{selectionContext:ys}=(0,s.gn)(Nt,{shouldActivateOrKeepAlive:!0}),is={};pe||(Nn.style.flexGrow=1,Nn.style.width="100%",Nn.style.minWidth="unset",is.overflow="unset");const Us=Qs=>{Ae.onSetScrollRef(new gt.X(Qs))};return(0,l.jsxs)("div",{...en,style:is,children:[(0,l.jsxs)("div",{...Nn,className:(0,v.cx)(Nn.className,_t.canvasWithSplitter),onPointerDown:Qs=>{Qs.shiftKey||Nt.clearSelection()},children:[(0,l.jsx)(Ft.c,{dashboard:Ae}),(0,l.jsx)("div",{className:(0,v.cx)(!pe&&_t.controlsWrapperSticky),children:et}),(0,l.jsx)("div",{className:_t.bodyWrapper,children:(0,l.jsx)("div",{className:(0,v.cx)(_t.body,pe&&_t.bodyEditing),ref:Us,children:(0,l.jsx)(Wt._.Provider,{value:ys,children:We})})})]}),pe&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{...os,"data-edit-pane-splitter":!0}),(0,l.jsx)("div",{...as,className:(0,v.cx)(as.className,_t.editPane),children:(0,l.jsx)(Xe,{editPane:Nt,isCollapsed:Bn.collapsed,onToggleCollapse:Dn,openOverlay:ys.selected.length>0})})]})]})}function Un(Ae,pe){return{canvasWrappperOld:(0,v.css)({label:"canvas-wrapper-old",display:"flex",flexDirection:"column",flexGrow:1}),canvasWithSplitter:(0,v.css)({overflow:"unset",display:"flex",flexDirection:"column",flexGrow:1}),canvasWithSplitterEditing:(0,v.css)({overflow:"unset"}),bodyWrapper:(0,v.css)({label:"body-wrapper",display:"flex",flexDirection:"column",flexGrow:1,position:"relative"}),body:(0,v.css)({label:"body",display:"flex",flexGrow:1,gap:"8px",boxSizing:"border-box",flexDirection:"column",padding:Ae.spacing(0,2,2,2)}),bodyEditing:(0,v.css)({position:"absolute",left:0,top:0,right:0,bottom:0,overflow:"auto",scrollbarWidth:"thin",paddingTop:"2px"}),editPane:(0,v.css)({flexDirection:"column",borderLeft:`1px solid ${Ae.colors.border.weak}`,background:Ae.colors.background.primary}),controlsWrapperSticky:(0,v.css)({[Ae.breakpoints.up("md")]:{position:"sticky",zIndex:Ae.zIndex.activePanel,background:Ae.colors.background.canvas,top:pe}})}}var ts=e(46942),ms=e.n(ts),us=e(63831),Yt=e(93300);const ot="--panels-per-row";function ct({dashboard:Ae,panelSearch:pe="",panelsPerRow:We}){const{body:et}=Ae.state,At=[],Nt=(0,b.of)(vt),[_t,rn]=(0,P.useState)(""),An=et instanceof us.D?et.state.grid:null;if(!An)return(0,l.jsx)(R.x6,{i18nKey:"panel-search.unsupported-layout",children:"Unsupported layout"});for(const en of An.state.children)if(en instanceof mn.U)Kt(en,Ae,pe,At,rn);else if(en instanceof s.tI)for(const Nn of en.state.children)Nn instanceof mn.U&&Kt(Nn,Ae,pe,At,rn);return At.length>0?(0,l.jsx)("div",{className:ms()(Nt.grid,{[Nt.perRow]:We!==void 0}),style:{[ot]:We},children:At.map(en=>(0,l.jsx)(ft,{panel:en},en.state.key))}):(0,l.jsx)("p",{className:Nt.noHits,children:(0,l.jsx)(R.x6,{i18nKey:"panel-search.no-matches",children:"No matches found"})})}function ft({panel:Ae}){return(0,P.useEffect)(()=>{const pe=(0,B.zo)(Ae);return()=>{pe?.()}},[Ae]),(0,l.jsx)(Ae.Component,{model:Ae})}function vt(Ae){return{grid:(0,v.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:Ae.spacing(1),gridAutoRows:"320px"}),perRow:(0,v.css)({gridTemplateColumns:`repeat(var(${ot}, 3), 1fr)`}),noHits:(0,v.css)({display:"grid",placeItems:"center"})}}function Kt(Ae,pe,We,et,At){const Nt=s.jh.interpolate(pe,We).toLowerCase();if(Ae.state.variableName&&!Ae.isActive){const rn=Ae.state.body;rn.interpolate(rn.state.title,void 0,"text").toLowerCase().includes(Nt)&&(Ae.subscribeToEvent(Yt.d,en=>{en.payload.source instanceof mn.U&&At(en.payload.source.state.key??"")}),Ae.activate())}const _t=Ae.state.repeatedPanels??[Ae.state.body];for(const rn of _t)rn.interpolate(rn.state.title,void 0,"text").toLowerCase().includes(Nt)&&et.push(rn);return et}var Zt=e(67853);const tn=({dashboard:Ae})=>{const We=Ae.getDashboardPanels().some(At=>At instanceof s.Eb?f.vI.includes(At.state.pluginId):!1);return i.$.featureToggles.angularDeprecationUI&&Ae.hasDashboardAngularPlugins()&&Ae.state.uid?(0,l.jsx)(Zt.j,{dashboardUid:Ae.state.uid,showAutoMigrateLink:We},Ae.state.uid):null};function En({model:Ae}){const{controls:pe,overlay:We,editview:et,editPanel:At,viewPanelScene:Nt,panelSearch:_t,panelsPerRow:rn,isEditing:An}=Ae.useState(),{type:en}=(0,Ct.g)(),Nn=(0,Ct.zy)(),as=(0,Ze.useSelector)(Us=>Us.navIndex),os=Ae.getPageNav(Nn,as),Bn=Ae.getBodyToRender(),Dn=(0,u.tc)(as,`dashboards/${en==="snapshot"?"snapshots":"browse"}`),ys=et!==void 0;if((0,P.useMemo)(()=>{(Nt||ys||At)&&Ae.rememberScrollPos()},[ys,At,Nt,Ae]),(0,P.useEffect)(()=>{!Nt&&!ys&&!At&&Ae.restoreScrollPos()},[ys,At,Nt,Ae]),et)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(et.Component,{model:et}),We&&(0,l.jsx)(We.Component,{model:We})]});function is(){return _t||rn?(0,l.jsx)(ct,{panelSearch:_t,panelsPerRow:rn,dashboard:Ae}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tn,{dashboard:Ae},"angular-deprecation-banner"),(0,l.jsx)(Bn.Component,{model:Bn})]})}return(0,l.jsxs)(Et.Y,{navModel:Dn,pageNav:os,layout:ut.k.Custom,children:[At&&(0,l.jsx)(At.Component,{model:At}),!At&&(0,l.jsx)(Cn,{dashboard:Ae,isEditing:An,controls:pe&&(0,l.jsx)(pe.Component,{model:pe}),body:is()}),We&&(0,l.jsx)(We.Component,{model:We})]})}var Ln=e(87638),Gn=e(52933),Hn=e(14770),Qn=e(76530),cs=e(83508),vs=e(20968),hs=e(44826),Vs=e(61351),As=e(59141),Ys=e(5761),ha=e(2543),Da=e(26701),Sa=e(7500),na=e(8392),Zs=e(92980),sa=e(48806);function Ha(Ae){const pe=[];if(Ae?.series)for(const We of Ae.series)pe.push((0,Da.Nw)(We));if(Ae?.annotations)for(const We of Ae.annotations){const et=(0,Da.Nw)(We);et.schema?.meta||(et.schema.meta={}),et.schema.meta.dataTopic=Sa.QR.Annotations,pe.push(et)}return pe}function Ma(Ae,pe){const We={panelType:Ae.state.pluginId,datasource:"??"},et=i.$.buildInfo.versionString;let At=`| Key | Value |
|--|--|
| Panel | ${We.panelType} @ ${Ae.state.pluginVersion??et} |
| Grafana | ${et} // ${i.$.buildInfo.edition} |
`;return pe&&(At+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+pe+"\n```\n</details>"),At}async function fa(Ae,pe,We){let et={type:""};const At=Ae.parent;(0,B.ME)(Ae)?et={...(0,Pt.ZB)(At),...(0,Pt.Z6)(Ae)}:et=(0,Pt.ZB)(At);const Nt=(0,ha.cloneDeep)(pt),_t={panelType:Ae.state.pluginId,datasource:"??"},rn=(0,B.un)(Ae);if(!rn.state.data)return;const An=rn.state.data,en=rn?.state.datasource,Nn=(0,sa.W)(Ha(An),pe),as=i.$.buildInfo.versionString,os=rn.state.queries??[],Bn=An.annotations?An.annotations.reduce((ys,is)=>is.length+ys,0):0,Dn=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${_t.panelType} @ ${et.pluginVersion??as}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${os.map(ys=>{const is=ys.datasource??en;return`${ys.refId}[${is?.type}]`}).join(", ")}</td>
    </tr>
    ${Rs(et)}
    ${xa(An,Nn)}
    ${fr(An)}
    <tr>
      <th>Grafana</th>
      <td>${as} // ${i.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(Nt.panels[0]={...et,...Nt.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:Zs.nj.Snapshot,snapshot:Nn}]},delete Nt.panels[0].libraryPanel,et.transformations?.length){const ys=Nt.panels[Nt.panels.length-1];ys.title=ys.title+" (after transformations)";const is=(0,ha.cloneDeep)(ys);is.id=100,is.title="Data (before transformations)",is.gridPos.w=24,is.targets[0].withTransforms=!1,Nt.panels.push(is)}return Bn>0&&Nt.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:Sa.QR.Annotations,refId:"A"}]}),Nt.panels[1].options.content=Dn,Nt.panels[2].options.content=JSON.stringify(et,null,2),Nt.title=`Debug: ${et.title} // ${(0,ls.LE)(new Date)}`,Nt.tags=["debug",`debug-${_t.panelType}`],Nt.time={from:We.from.toISOString(),to:We.to.toISOString()},Nt}function Rs(Ae){return Ae.transformations?`<tr>
      <th>Transform</th>
      <td>${Ae.transformations.map(pe=>pe.id).join(", ")}</td>
  </tr>`:""}function xa(Ae,pe){let We=Ae.series.length??0,et=0,At=0;for(const Nt of Ae.series)et+=Nt.fields.length,At+=Nt.length;return`<tr><th>Data</th><td>${Ae.state!==na.Gu.Done?Ae.state:""} ${We} frames, ${et} fields, ${At} rows </td></tr>`}function fr(Ae){return Ae.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${Ae.annotations.reduce((pe,We)=>We.length+pe,0)}</td>
</tr>`:""}const pt={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Xt=(Ae=>(Ae[Ae.Support=0]="Support",Ae[Ae.Data=1]="Data",Ae))(Xt||{}),hn=(Ae=>(Ae[Ae.PanelSnapshot=0]="PanelSnapshot",Ae[Ae.GithubComment=1]="GithubComment",Ae))(hn||{});class Sn extends Ys.Q{constructor(pe){super({panel:pe,panelTitle:s.jh.interpolate(pe,pe.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=We=>{this.setState({currentTab:We})},this.onShowMessageChange=We=>{this.setState({showMessage:We.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:We}=this.state,et=Math.pow(1024,2)*1.5;return We.length>et?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):We},this.onDownloadDashboard=()=>{const{snapshotText:We,panelTitle:et}=this.state,At=new Blob([We],{type:"text/plain"}),Nt=`debug-${et}-${(0,ls.LE)(new Date)}.json.txt`;vn()(At,Nt)},this.onSetSnapshotText=We=>{this.setState({snapshotText:We})},this.onToggleRandomize=We=>{const{randomize:et}=this.state;this.setState({randomize:{...et,[We]:!et[We]}})}}async buildDebugDashboard(){const{panel:pe,randomize:We,snapshotUpdate:et}=this.state,At=await fa(pe,We,s.jh.getTimeRange(pe).state.value),Nt=JSON.stringify(At,null,2),_t=Ma(pe,Nt),rn=(0,As.cN)((0,As.j_)("bytes")(Nt?.length??0));let An;if(At)try{An=(0,On.wM)({dashboard:At,meta:{isEmbedded:!0}}).state.body}catch(en){console.log("Error creating scene:",en)}this.setState({snapshot:At,snapshotText:Nt,markdownText:_t,snapshotSize:rn,snapshotUpdate:et+1,scene:An})}}function Wn({panel:Ae,onClose:pe}){const We=(0,b.of)(Jn),et=(0,P.useMemo)(()=>new Sn(Ae),[Ae]),At=Ae.getPlugin(),{currentTab:Nt,loading:_t,error:rn,options:An,showMessage:en,snapshotSize:Nn,markdownText:as,snapshotText:os,randomize:Bn,panelTitle:Dn,scene:ys}=et.useState();if((0,P.useEffect)(()=>{et.buildDebugDashboard()},[et,At,Bn]),!At)return null;const is=[{label:"Snapshot",value:Xt.Support},{label:"Data",value:Xt.Data}],Us=i.$.supportBundlesEnabled&&Vs.TP.hasPermission(Ze.AccessControlAction.ActionSupportBundlesCreate);return(0,l.jsxs)($e._,{title:"Get help with this panel",size:"lg",onClose:pe,subtitle:(0,l.jsxs)(K.B,{direction:"column",gap:1,children:[(0,l.jsxs)(K.B,{direction:"row",gap:1,children:[(0,l.jsx)(cs.y,{featureState:r.Ay.beta}),(0,l.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer",children:["Troubleshooting docs ",(0,l.jsx)(W.I,{name:"external-link-alt"})]})]}),(0,l.jsx)("span",{className:"muted",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."}),Us&&(0,l.jsxs)("span",{className:"muted",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,l.jsx)("a",{href:"/support-bundles",children:"support bundles section"}),"."]})]}),tabs:(0,l.jsx)(M.U,{children:is.map((Qs,ga)=>(0,l.jsx)(O.o,{label:Qs.label,active:Qs.value===Nt,onChangeTab:()=>et.onCurrentTabChange(Qs.value)},`${Qs.value}-${ga}`))}),children:[_t&&(0,l.jsx)(vs.y,{}),rn&&(0,l.jsx)(Me.F,{title:rn.title,children:rn.message}),Nt===Xt.Data&&(0,l.jsxs)("div",{className:We.code,children:[(0,l.jsxs)("div",{className:We.opts,children:[(0,l.jsx)(De.D,{label:"Template",className:We.field,children:(0,l.jsx)(hs.l6,{options:An,value:en,onChange:et.onShowMessageChange})}),en===hn.GithubComment?(0,l.jsx)(cn.b,{icon:"copy",getText:et.onGetMarkdownForClipboard,children:"Copy to clipboard"}):(0,l.jsxs)(ne.$n,{icon:"download-alt",onClick:et.onDownloadDashboard,children:["Download (",Nn,")"]})]}),(0,l.jsx)(pn.default,{disableWidth:!0,children:({height:Qs})=>(0,l.jsx)(xn.B,{width:"100%",height:Qs,language:en===hn.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:en===hn.GithubComment?as:os,readOnly:!1,onBlur:et.onSetSnapshotText})})]}),Nt===Xt.Support&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(De.D,{label:"Randomize data",description:"Modify the original data to hide sensitive information.  Note the lengths will stay the same, and duplicate values will be equal.",children:(0,l.jsxs)(K.B,{children:[(0,l.jsx)(Ke.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!Bn.labels,onChange:()=>et.onToggleRandomize("labels")}),(0,l.jsx)(Ke.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!Bn.names,onChange:()=>et.onToggleRandomize("names")}),(0,l.jsx)(Ke.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!Bn.values,onChange:()=>et.onToggleRandomize("values")})]})}),(0,l.jsx)(De.D,{label:"Support snapshot",description:`Panel: ${Dn}`,children:(0,l.jsxs)(K.B,{children:[(0,l.jsxs)(ne.$n,{icon:"download-alt",onClick:et.onDownloadDashboard,children:["Dashboard (",Nn,")"]}),(0,l.jsx)(cn.b,{icon:"github",getText:et.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard",children:"Copy to clipboard"})]})}),(0,l.jsx)("div",{style:{height:"100%",overflow:"auto",display:"flex"},children:ys&&(0,l.jsx)(ys.Component,{model:ys})})]})]})}const Jn=Ae=>({code:(0,v.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,v.css)({width:"100%"}),opts:(0,v.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:Ae.spacing(1)}})});var fs=e(16568);class qn extends s.Bs{constructor(pe){super({...pe,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=We=>{this.setState({options:We})}}getTabLabel(){return(0,R.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return Qn.q.Data}static{this.Component=({model:pe})=>{const{options:We}=pe.useState(),et=pe.state.panelRef.resolve(),At=s.jh.getData(et),{data:Nt}=_s(At,We.withTransforms).useState(),_t=s.jh.getTimeRange(et);return(0,l.jsx)(fs.q,{isLoading:Nt?.state===na.Gu.Loading,data:Nt?.series,options:We,hasTransformations:Cs(At),timeZone:_t.getTimeZone(),panelPluginId:et.state.pluginId,dataName:s.jh.interpolate(et,et.state.title),fieldConfig:et.state.fieldConfig,onOptionsChange:pe.onOptionsChange})}}}function Cs(Ae){return Ae instanceof s.Es?Ae.state.transformations.length>0:!1}function _s(Ae,pe){return!pe&&Ae instanceof s.Es&&Ae.state.$data?Ae.state.$data:Ae}var Ls=e(5573),$s=e(18117),Ea=e(13468),Ga=e(19614);class Wa extends s.Bs{constructor(pe){super({...pe,source:"panel-json",jsonText:To("panel-json",pe.panelRef.resolve())}),this.onChangeSource=We=>{this.setState({source:We.value,jsonText:To(We.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const We=this.state.panelRef.resolve(),et=(0,B.YQ)(We),At=JSON.parse(this.state.jsonText),Nt=new f.a9(At),_t=(0,On.tt)(Nt),rn=s.Go.cloneSceneObjectState(_t.state);if(!(We.parent instanceof mn.U)){console.error("Cannot update state of panel",We,_t);return}this.state.onClose(),et.state.isEditing||et.onEnterEditMode(),We.parent.setState(rn),(0,Ga.B9)(Qn.q.JSON,"apply",{panel_type_changed:We.state.pluginId!==Nt.type,panel_id_changed:(0,B.Cs)(We)!==Nt.id,panel_grid_pos_changed:Br(We.parent.state,rn),panel_targets_changed:hi((0,B.un)(We),(0,B.un)(rn.$data))})},this.onCodeEditorBlur=We=>{this.setState({jsonText:We})}}getTabLabel(){return(0,R.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return Qn.q.JSON}getOptions(){const pe=this.state.panelRef.resolve(),We=pe.state.$data??pe.parent?.state.$data,et=[{label:(0,R.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,R.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return We&&(et.push({label:(0,R.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,R.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),et.push({label:(0,R.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,R.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),et}isEditable(){if(this.state.source!=="panel-json")return!1;const pe=this.state.panelRef.resolve();return(0,B.ME)(pe)||pe.parent instanceof mn.U&&pe.parent.isRepeated()?!1:(0,B.YQ)(pe).state.meta.canEdit}static{this.Component=({model:pe})=>{const{source:We,jsonText:et}=pe.useState(),At=(0,b.of)($s.A),Nt=pe.getOptions();return(0,l.jsxs)("div",{className:At.wrap,children:[(0,l.jsxs)("div",{className:At.toolbar,"data-testid":F.Tp.components.PanelInspector.Json.content,children:[(0,l.jsx)(De.D,{label:(0,R.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,l.jsx)(hs.l6,{inputId:"select-source-dropdown",options:Nt,value:Nt.find(_t=>_t.value===We)??Nt[0].value,onChange:pe.onChangeSource})}),pe.isEditable()&&(0,l.jsx)(ne.$n,{className:At.toolbarItem,onClick:pe.onApplyChange,children:"Apply"})]}),(0,l.jsx)("div",{className:At.content,children:(0,l.jsx)(pn.default,{disableWidth:!0,children:({height:_t})=>(0,l.jsx)(xn.B,{width:"100%",height:_t,language:"json",showLineNumbers:!0,showMiniMap:et.length>100,value:et,readOnly:!pe.isEditable(),onBlur:pe.onCodeEditorBlur})})})]})}}}function To(Ae,pe){let We={};switch(Ae){case"panel-json":{(0,Ga.B9)(Qn.q.JSON,"panelData");const et=(0,B.ME)(pe),At=pe.parent;if(et){We=ui(pe);break}At instanceof mn.U&&(We=(0,Pt.ZB)(At));break}case"panel-data":{(0,Ga.B9)(Qn.q.JSON,"panelJSON");const et=s.jh.getData(pe);et.state.data&&(We=pe.applyFieldConfig(et.state.data));break}case"data-frames":{(0,Ga.B9)(Qn.q.JSON,"dataFrame");const et=s.jh.getData(pe);et.state.data&&(et instanceof s.Es&&et.state.$data?.state.data?We=(0,Ls.B6)(et.state.$data.state.data):We=(0,Ls.B6)(et.state.data))}}return(0,Ea.p)(We)}function ui(Ae){if(!(0,B.ME)(Ae))throw"Panel not a library panel";const pe=Ae.parent;if(!(pe instanceof mn.U))throw"LibraryPanel not child of DashboardGridItem";const We={x:pe.state.x||0,y:pe.state.y||0,h:pe.state.height||0,w:pe.state.width||0},et=jr(Ae),At=(0,Pt.Z6)(Ae.clone({$behaviors:void 0}),We,!1,pe);return{libraryPanel:{...et},...At}}function jr(Ae){if(!(0,B.ME)(Ae))throw new Error("Panel not a Library panel");const pe=(0,B.iL)(Ae);if(!pe)throw new Error("Library panel behavior not found");if(!pe.state._loadedPanel)throw new Error("Library panel not loaded");return pe.state._loadedPanel}function Br(Ae,pe){return Ae.x!==pe.x||Ae.y!==pe.y||Ae.width!==pe.width||Ae.height!==pe.height}function hi(Ae,pe){return Ae===void 0||pe===void 0?!1:!(0,ha.isEqual)(Ae.state.queries,pe.state.queries)}class fi extends s.Bs{getTabLabel(){return(0,R.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return Qn.q.Meta}static{this.Component=({model:pe})=>{const{panelRef:We,dataSource:et}=pe.state,At=s.jh.getData(We.resolve()),Nt=et.components?.MetadataInspector;return!At.state.data||!Nt?null:(0,l.jsx)(Nt,{datasource:et,data:At.state.data.series})}}}var gi=e(64050);class Ur extends s.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const pe=(0,B.un)(this.state.panelRef.resolve());pe&&pe.runQueries()}}getTabLabel(){return(0,R.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return Qn.q.Query}static{this.Component=({model:pe})=>{const We=s.jh.getData(pe.state.panelRef.resolve()).useState();return We.data?(0,l.jsx)(gi.e,{data:We.data,onRefreshQuery:pe.onRefreshQuery}):null}}}var pi=e(94681);class mi extends s.Bs{getTabLabel(){return(0,R.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return Qn.q.Stats}static{this.Component=({model:pe})=>{const We=s.jh.getData(pe.state.panelRef.resolve()).useState(),et=s.jh.getTimeRange(pe.state.panelRef.resolve());return We.data?(0,l.jsx)(pi.N,{data:We.data,timeZone:et.getTimeZone()}):null}}}class So extends s.Bs{constructor(pe){super(pe),this.onClose=()=>{Oo((0,B.YQ)(this))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Mo}_activationHandler(){this.buildTabs(0)}async buildTabs(pe){const We=this.state.panelRef,et=We.resolve()?.getPlugin(),At=[];if(et||(pe<2e3?setTimeout(()=>this.buildTabs(pe+100),100):this.setState({pluginNotLoaded:!0})),We){if((0,Hn.$)(et)){const Nt=s.jh.getData(We.resolve());At.push(new qn({panelRef:We})),At.push(new mi({panelRef:We})),At.push(new Ur({panelRef:We}));const _t=await(0,Gn.BN)(Nt.state.data);_t&&At.push(new fi({panelRef:We,dataSource:_t}))}At.push(new Wa({panelRef:We,onClose:this.onClose}))}this.setState({tabs:At})}getDrawerTitle(){const pe=this.state.panelRef?.resolve();return pe?s.jh.interpolate(pe,`Inspect: ${pe.state.title}`):"Inspect panel"}}function Mo({model:Ae}){const{tabs:pe,pluginNotLoaded:We,panelRef:et}=Ae.useState(),At=(0,Ct.zy)(),Nt=new URLSearchParams(At.search);if(!pe)return null;const _t=Nt.get("inspectTab"),rn=pe.find(en=>en.getTabValue()===_t)??pe[0],An=et.resolve();return _t===Qn.q.Help?(0,l.jsx)(Wn,{panel:An,onClose:Ae.onClose}):(0,l.jsxs)($e._,{title:Ae.getDrawerTitle(),onClose:Ae.onClose,size:"md",tabs:(0,l.jsx)(M.U,{children:pe.map(en=>(0,l.jsx)(O.o,{label:en.getTabLabel(),active:en===rn,href:t.I.getUrlForPartial(At,{inspectTab:en.getTabValue()})},en.state.key))}),children:[We&&(0,l.jsx)(Me.F,{title:"Panel plugin not loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."}),rn&&rn.Component&&(0,l.jsx)(rn.Component,{model:rn})]})}function Oo(Ae){const pe=Ae.state.meta,We=!Ae.state.uid&&a.Ny.getLocation().pathname==="/dashboard/new";a.Ny.push((0,Yn.u)({uid:Ae.state.uid,slug:Ae.state.meta.slug,currentQueryParams:a.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null},isHomeDashboard:!pe.url&&!pe.slug&&!We}))}var Nr=e(97805),Io=e(61809),Wr=e(98437),Ua=e(62652);class Fr{constructor(pe){this._scene=pe}getKeys(){return["editIndex"]}getUrlState(){const pe=this._scene.state;return{editIndex:pe.editIndex!==void 0?String(pe.editIndex):void 0}}updateFromUrl(pe){let We={};typeof pe.editIndex=="string"?We={editIndex:Number(pe.editIndex)}:We={editIndex:void 0},Object.keys(We).length>0&&this._scene.setState(We)}}var Ao=e(16817),Ro=e(44617),vi=e(8106),yi=e(68358),xi=e(15773),gr=e(81208);const da="New annotation",er=({annotation:Ae,editIndex:pe,panels:We,onUpdate:et,onBackToList:At,onDelete:Nt})=>{const _t=(0,b.of)(Ei),rn=(0,P.useMemo)(()=>Ae.filter?Ae.filter.exclude?2:1:0,[Ae.filter]),{value:An}=(0,Ao.A)(()=>(0,Wr.l)().get(Ae.datasource),[Ae.datasource]),en=(0,Wr.l)().getInstanceSettings(Ae.datasource),Nn=xs=>{et({...Ae,name:xs.currentTarget.value},pe)},as=xs=>{const aa=(0,Io.p$)(xs);Ae.datasource?.type!==aa.type?et({datasource:aa,builtIn:Ae.builtIn,enable:Ae.enable,iconColor:Ae.iconColor,name:Ae.name,hide:Ae.hide,filter:Ae.filter,mappings:Ae.mappings,type:Ae.type},pe):et({...Ae,datasource:aa},pe)},os=xs=>{const aa=xs.currentTarget;et({...Ae,[aa.name]:aa.type==="checkbox"?aa.checked:aa.value},pe)},Bn=xs=>{et({...Ae,iconColor:xs},pe)},Dn=xs=>{let aa=xs.value===0?void 0:{exclude:xs.value===2,ids:Ae.filter?.ids??[]};et({...Ae,filter:aa},pe)},ys=xs=>{if(!Array.isArray(xs))return;const aa={exclude:rn===2,ids:[]};xs.forEach(rr=>rr.value&&aa.ids.push(rr.value)),et({...Ae,filter:aa},pe)},is=()=>{Nt(pe),At()},Us=Ae.name===da,Qs=(xs,aa)=>xs.label&&aa.label?xs.label.toLowerCase().localeCompare(aa.label.toLowerCase()):-1,ga=(0,P.useMemo)(()=>We.filter(xs=>i.$.panels[xs.state.pluginId]).map(xs=>({value:(0,B.Cs)(xs),label:xs.state.title??`Panel ${(0,B.Cs)(xs)}`,description:xs.state.description,imgUrl:i.$.panels[xs.state.pluginId].info.logos.small})).sort(Qs)??[],[We]);return(0,l.jsxs)("div",{children:[(0,l.jsxs)(Ro.n,{className:_t.settingsForm,children:[(0,l.jsx)(De.D,{label:"Name",children:(0,l.jsx)(G.p,{"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Us,value:Ae.name,onChange:Nn})}),(0,l.jsx)(De.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,l.jsx)(xi.s,{annotations:!0,variables:!0,current:Ae.datasource,onChange:as})}),!An?.meta.annotations&&(0,l.jsx)(Me.F,{title:"No annotation support for this data source",severity:"error",children:(0,l.jsx)(R.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,l.jsx)(De.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,l.jsx)(ht.S,{name:"enable",id:"enable",value:Ae.enable,onChange:os,"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,l.jsx)(De.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,l.jsx)(ht.S,{name:"hide",id:"hide",value:Ae.hide,onChange:os,"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,l.jsx)(De.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,l.jsx)(K.B,{children:(0,l.jsx)(vi.a,{value:Ae?.iconColor,onChange:Bn})})}),(0,l.jsx)(De.D,{label:"Show in","data-testid":F.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(hs.l6,{options:Di,value:rn,onChange:Dn,"data-testid":F.Tp.components.Annotations.annotationsTypeInput}),rn!==0&&(0,l.jsx)(hs.KF,{options:ga,value:ga.filter(xs=>Ae.filter?.ids.includes(xs.value)),onChange:ys,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:_t.select,"data-testid":F.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,l.jsxs)(Ro.n,{children:[(0,l.jsx)("h3",{className:"page-heading",children:"Query"}),An?.annotations&&en&&(0,l.jsx)(yi.A,{datasource:An,datasourceInstanceSettings:en,annotation:Ae,onChange:xs=>et(xs,pe)}),An&&!An.annotations&&(0,l.jsx)(gr.F,{datasource:An,annotation:Ae,onChange:xs=>et(xs,pe)})]}),(0,l.jsxs)(K.B,{children:[!Ae.builtIn&&(0,l.jsx)(ne.$n,{variant:"destructive",onClick:is,"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:"Delete"}),(0,l.jsx)(ne.$n,{variant:"secondary",onClick:At,"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:"Back to list"})]})]})},Ei=Ae=>({settingsForm:(0,v.css)({maxWidth:Ae.spacing(60),marginBottom:Ae.spacing(2)}),select:(0,v.css)({marginTop:"8px"})});var Pi=(Ae=>(Ae[Ae.AllPanels=0]="AllPanels",Ae[Ae.IncludePanels=1]="IncludePanels",Ae[Ae.ExcludePanels=2]="ExcludePanels",Ae))(Pi||{});const Di=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var ir=e(99764),Ci=e(87731),Pa=e(59830),ro=e(54731),bi=e(64625);const Kr="Add annotation query",Lo=({annotations:Ae,onNew:pe,onEdit:We,onMove:et,onDelete:At})=>{const Nt=(0,b.of)(Ti),_t=Ae.length===0||Ae.length===1&&Ae[0].builtIn,rn=en=>en.enable===!1?(0,l.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",en.name]}):en.builtIn?(0,l.jsxs)("em",{className:"muted",children:[en.name," \xA0 (Built-in)"]}):(0,l.jsx)(l.Fragment,{children:en.name}),An=(0,Wr.l)();return(0,l.jsxs)(K.B,{direction:"column",children:[Ae.length>0&&(0,l.jsx)("div",{className:Nt.table,children:(0,l.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Query name"}),(0,l.jsx)("th",{children:"Data source"}),(0,l.jsx)("th",{colSpan:3})]})}),(0,l.jsx)("tbody",{"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:Ae.map((en,Nn)=>(0,l.jsxs)("tr",{children:[en.builtIn?(0,l.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>We(Nn),children:(0,l.jsx)(ne.$n,{size:"sm",fill:"text",variant:"secondary",children:rn(en)})}):(0,l.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>We(Nn),children:(0,l.jsx)(ne.$n,{size:"sm",fill:"text",variant:"secondary",children:rn(en)})}),(0,l.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>We(Nn),children:An.getInstanceSettings(en.datasource)?.name||en.datasource?.uid}),(0,l.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Nn!==0&&(0,l.jsx)(ir.K,{name:"arrow-up",onClick:()=>et(Nn,oo.UP),tooltip:"Move up"})}),(0,l.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Ae.length>1&&Nn!==Ae.length-1?(0,l.jsx)(ir.K,{name:"arrow-down",onClick:()=>et(Nn,oo.DOWN),tooltip:"Move down"}):null}),(0,l.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!en.builtIn&&(0,l.jsx)(Ci.e,{size:"sm",onConfirm:()=>At(Nn),"aria-label":`Delete query with title "${en.name}"`})})]},`${en.name}-${Nn}`))})]})}),_t&&(0,l.jsx)(K.B,{direction:"column",children:(0,l.jsxs)(Pa.p,{variant:"call-to-action",button:(0,l.jsx)(ne.$n,{"data-testid":F.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:pe,size:"lg",children:(0,l.jsx)(R.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,R.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,l.jsx)(R.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,l.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,l.jsxs)(R.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,l.jsx)(ro.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!_t&&(0,l.jsx)(bi.d,{"data-testid":F.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:pe,children:"New query"})]})},Ti=()=>({table:(0,v.css)({width:"100%",overflowX:"auto"})});var oo=(Ae=>(Ae[Ae.UP=-1]="UP",Ae[Ae.DOWN=1]="DOWN",Ae))(oo||{});class Si extends s.Bs{constructor(){super(...arguments),this._urlSync=new Fr(this),this.getDataSourceRefForAnnotation=()=>{const pe=(0,Wr.l)().getInstanceSettings(null);if(!pe||!pe.meta.annotations){console.error("Default datasource does not support annotations");return}return(0,Io.p$)(pe)},this.onNew=async()=>{const pe={name:da,enable:!0,datasource:this.getDataSourceRefForAnnotation(),iconColor:"red"},We=new Ua.g({query:pe,name:pe.name,isEnabled:!!pe.enable,isHidden:!!pe.hide}),et=le.b4.getDataLayers(this._dashboard);et.addAnnotationLayer(We),this.setState({editIndex:et.state.annotationLayers.length-1})},this.onEdit=pe=>{this.setState({editIndex:pe})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(pe,We)=>{const et=le.b4.getDataLayers(this._dashboard),At=[...et.state.annotationLayers],[Nt]=At.splice(pe,1);At.splice(pe+We,0,Nt),et.setState({annotationLayers:At})},this.onDelete=pe=>{const We=le.b4.getDataLayers(this._dashboard),et=[...We.state.annotationLayers];et.splice(pe,1),We.setState({annotationLayers:et})},this.onUpdate=(pe,We)=>{const et=this.getDataLayer(We);et.setState({name:pe.name,isEnabled:!!pe.enable,isHidden:!!pe.hide,query:pe}),et.runLayer()}}static{this.Component=tr}getUrlKey(){return"annotations"}get _dashboard(){return(0,B.YQ)(this)}getDataLayer(pe){const et=le.b4.getDataLayers(this._dashboard).state.annotationLayers[pe];if(!(et instanceof s.tV.g))throw new Error("AnnotationsDataLayer not found at index "+pe);return et}getDashboard(){return this._dashboard}}function tr({model:Ae}){const pe=Ae.getDashboard(),{annotationLayers:We}=le.b4.getDataLayers(pe).useState(),{navModel:et,pageNav:At}=qa(pe,Ae.getUrlKey()),{editIndex:Nt}=Ae.useState(),_t=le.b4.getVizPanels(pe),rn=(0,$t.O)(We);return Nt!=null&&Nt<We.length?(0,l.jsx)(Na,{annotationLayer:Ae.getDataLayer(Nt),pageNav:At,panels:_t,editIndex:Nt,navModel:et,dashboard:pe,onUpdate:Ae.onUpdate,onBackToList:Ae.onBackToList,onDelete:Ae.onDelete}):(0,l.jsxs)(Et.Y,{navModel:et,pageNav:At,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:pe}),(0,l.jsx)(Lo,{annotations:rn,onNew:Ae.onNew,onEdit:Ae.onEdit,onDelete:Ae.onDelete,onMove:Ae.onMove})]})}function Na({annotationLayer:Ae,pageNav:pe,navModel:We,panels:et,editIndex:At,dashboard:Nt,onUpdate:_t,onBackToList:rn,onDelete:An}){const{name:en,query:Nn}=Ae.useState(),as={text:en,parentItem:pe};return(0,l.jsxs)(Et.Y,{navModel:We,pageNav:as,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:Nt}),(0,l.jsx)(er,{annotation:Nn,editIndex:At,panels:et,onUpdate:_t,onBackToList:rn,onDelete:An})]})}var Mi=e(6562),wr=e(575),Oi=e(69253),io=e(80342);class jo extends s.Bs{constructor(){super(...arguments),this._urlSync=new Fr(this),this.onNewLink=()=>{this.links=[...this.links,io.q],this.setState({editIndex:this.links.length-1})},this.onDelete=pe=>{this.links=[...this.links.slice(0,pe),...this.links.slice(pe+1)],this.setState({editIndex:void 0})},this.onDuplicate=pe=>{this.links=[...this.links,{...pe}]},this.onOrderChange=(pe,We)=>{this.links=Mi.moveItemImmutably(this.links,pe,pe+We)},this.onEdit=pe=>{this.setState({editIndex:pe})},this.onUpdateLink=pe=>{const We=this.state.editIndex;We!==void 0&&(this.links=[...this.links.slice(0,We),pe,...this.links.slice(We+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=Bo}getUrlKey(){return"links"}get dashboard(){return(0,B.YQ)(this)}get links(){return this.dashboard.state.links}set links(pe){this.dashboard.setState({links:pe})}}function Bo({model:Ae}){const{editIndex:pe}=Ae.useState(),We=(0,B.YQ)(Ae),{links:et}=We.useState(),{navModel:At,pageNav:Nt}=qa(We,Ae.getUrlKey()),_t=pe!==void 0?et[pe]:void 0;return _t?(0,l.jsx)(Ii,{pageNav:Nt,navModel:At,link:_t,dashboard:We,onChange:Ae.onUpdateLink,onGoBack:Ae.onGoBack}):(0,l.jsxs)(Et.Y,{navModel:At,pageNav:Nt,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:We}),(0,l.jsx)(Oi.X,{links:et,onNew:Ae.onNewLink,onEdit:Ae.onEdit,onDelete:Ae.onDelete,onDuplicate:Ae.onDuplicate,onOrderChange:Ae.onOrderChange})]})}function Ii({pageNav:Ae,link:pe,navModel:We,dashboard:et,onChange:At,onGoBack:Nt}){const _t={text:"Edit link",parentItem:Ae};return(0,l.jsxs)(Et.Y,{navModel:We,pageNav:_t,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:et}),(0,l.jsx)(wr.d,{link:pe,onUpdate:At,onGoBack:Nt})]})}var Uo=e(32319),pr=e(60641),No=e(91036),Ai=e(15832),Wo=e(87156),Ri=e(36180),Fo=e(10037),lr=e(4432);const Li=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],lo=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class Ko extends s.Bs{constructor(){super(...arguments),this.onTitleChange=pe=>{this._dashboard.setState({title:pe})},this.onDescriptionChange=pe=>{this._dashboard.setState({description:pe})},this.onTagsChange=pe=>{this._dashboard.setState({tags:pe})},this.onFolderChange=async(pe,We)=>{const et={...this._dashboard.state.meta,folderUid:pe||this._dashboard.state.meta.folderUid,folderTitle:We||this._dashboard.state.meta.folderTitle};et.folderUid&&await(0,Fo.Q)(et.folderUid),this._dashboard.setState({meta:et})},this.onEditableChange=pe=>{this._dashboard.setState({editable:pe})},this.onTimeZoneChange=pe=>{this.getTimeRange().setState({timeZone:pe})},this.onWeekStartChange=pe=>{this.getTimeRange().setState({weekStart:pe})},this.onRefreshIntervalChange=pe=>{this.getRefreshPicker()?.setState({intervals:pe})},this.onNowDelayChange=pe=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:pe})},this.onHideTimePickerChange=pe=>{this.getDashboardControls()?.setState({hideTimeControls:pe})},this.onLiveNowChange=pe=>{try{const We=this.getLiveNowTimer();pe?We.enable():We.disable()}catch(We){console.error(We)}},this.onTooltipChange=pe=>{this.getCursorSync()?.setState({sync:pe})},this.onPreloadChange=pe=>{this._dashboard.setState({preload:pe})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,B.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return s.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return le.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const pe=s.jh.findObject(this._dashboard,We=>We instanceof s.Gg.en);if(pe instanceof s.Gg.en)return pe;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:pe})=>{const We=pe.getDashboard(),{navModel:et,pageNav:At}=qa(We,pe.getUrlKey()),{title:Nt,description:_t,tags:rn,meta:An,editable:en}=We.useState(),{sync:Nn}=pe.getCursorSync()?.useState()||{},{timeZone:as,weekStart:os,UNSAFE_nowDelay:Bn}=pe.getTimeRange().useState(),{intervals:Dn}=pe.getRefreshPicker().useState(),{hideTimeControls:ys}=pe.getDashboardControls().useState(),{enabled:is}=pe.getLiveNowTimer().useState();return(0,l.jsxs)(Et.Y,{navModel:et,pageNav:At,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:We}),(0,l.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,l.jsxs)(I.a,{marginBottom:5,children:[(0,l.jsx)(De.D,{label:(0,l.jsxs)(K.B,{justifyContent:"space-between",children:[(0,l.jsx)(Ie.J,{htmlFor:"title-input",children:(0,l.jsx)(R.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),i.$.featureToggles.dashgpt&&(0,l.jsx)(Ri.Z,{onGenerate:Us=>pe.onTitleChange(Us)})]}),children:(0,l.jsx)(G.p,{id:"title-input",name:"title",value:Nt,onChange:Us=>pe.onTitleChange(Us.target.value)})}),(0,l.jsx)(De.D,{label:(0,l.jsxs)(K.B,{justifyContent:"space-between",children:[(0,l.jsx)(Ie.J,{htmlFor:"description-input",children:(0,R.t)("dashboard-settings.general.description-label","Description")}),i.$.featureToggles.dashgpt&&(0,l.jsx)(Wo.V,{onGenerate:Us=>pe.onDescriptionChange(Us)})]}),children:(0,l.jsx)(X.f,{id:"description-input",name:"description",value:_t,onChange:Us=>pe.onDescriptionChange(Us.target.value)})}),(0,l.jsx)(De.D,{label:(0,R.t)("dashboard-settings.general.tags-label","Tags"),children:(0,l.jsx)(Uo.u,{id:"tags-input",tags:rn,onChange:pe.onTagsChange,width:40})}),(0,l.jsx)(De.D,{label:(0,R.t)("dashboard-settings.general.folder-label","Folder"),children:(0,l.jsx)(Ne.d,{value:An.folderUid,onChange:pe.onFolderChange,initialTitle:An.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})}),(0,l.jsx)(De.D,{label:(0,R.t)("dashboard-settings.general.editable-label","Editable"),description:(0,R.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,l.jsx)(pr.z,{value:en,options:Li,onChange:pe.onEditableChange})})]}),(0,l.jsx)(Ai.p,{onTimeZoneChange:pe.onTimeZoneChange,onWeekStartChange:pe.onWeekStartChange,onRefreshIntervalChange:pe.onRefreshIntervalChange,onNowDelayChange:pe.onNowDelayChange,onHideTimePickerChange:pe.onHideTimePickerChange,onLiveNowChange:pe.onLiveNowChange,refreshIntervals:Dn,timePickerHidden:ys,nowDelay:Bn||"",liveNow:is,timezone:as||"",weekStart:os||""}),(0,l.jsxs)(No.M,{label:(0,R.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:[(0,l.jsx)(De.D,{label:(0,R.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,R.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,l.jsx)(pr.z,{onChange:pe.onTooltipChange,options:lo,value:Nn})}),(0,l.jsx)(De.D,{label:(0,R.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,R.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,l.jsx)(Ke.d,{id:"preload-panels-dashboards-toggle",value:We.state.preload,onChange:Us=>pe.onPreloadChange(Us.currentTarget.checked)})})]}),(0,l.jsx)(I.a,{marginTop:3,children:An.canDelete&&(0,l.jsx)(lr.c,{dashboard:We})})]})]})}}}class co extends s.Bs{constructor(pe){super({...pe,jsonText:""}),this.onCodeEditorBlur=We=>{this.setState({jsonText:We})},this.onSaveSuccess=We=>{const et=JSON.parse(this.state.jsonText),At=this.getDashboard();et.version=We.version;const Nt={dashboard:et,meta:At.state.meta},_t=(0,On.wM)(Nt),rn=s.Go.cloneSceneObjectState(_t.state);At.pauseTrackingChanges(),At.setInitialSaveModel(Nt.dashboard),At.setState(rn),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,B.YQ)(this)}getSaveModel(){const pe=this.getDashboard();return(0,Pt.Uy)(pe)}getJsonText(){const pe=this.getSaveModel();return(0,Ea.p)(pe)}static{this.Component=({model:pe})=>{const{state:We,onSaveDashboard:et}=Re(!1),[At,Nt]=(0,P.useState)(!1),_t=pe.getDashboard(),{navModel:rn,pageNav:An}=qa(_t,pe.getUrlKey()),en=_t.useState().meta.canSave,{jsonText:Nn}=pe.useState(),as=async is=>{const Us=await et(_t,{folderUid:_t.state.meta.folderUid,overwrite:is,rawDashboardJSON:JSON.parse(pe.state.jsonText)});Nt(!0),Us.status==="success"?(pe.onSaveSuccess(Us),Nt(!1)):Nt(!0)},os=is=>(0,l.jsx)(ne.$n,{type:"submit",onClick:()=>{as(is)},variant:is?"destructive":"primary",children:is?"Save and overwrite":(0,l.jsx)(R.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Bn=(0,l.jsx)(ne.$n,{variant:"secondary",onClick:()=>Nt(!1),fill:"outline",children:"Cancel"}),Dn=(0,b.of)(ji);function ys(is){if(is&&At){if(fe(is))return(0,l.jsxs)(Me.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,l.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsxs)(K.B,{alignItems:"center",children:[Bn,os(!0)]})})]});if(ge(is))return(0,l.jsx)(je,{saveButton:os,cancelButton:Bn});if(xe(is))return(0,l.jsxs)(Me.F,{title:"Plugin dashboard",severity:"error",children:[(0,l.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,l.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,l.jsx)(I.a,{paddingTop:2,children:(0,l.jsx)(K.B,{alignItems:"center",children:os(!0)})})]})}return(0,l.jsxs)(l.Fragment,{children:[is&&At&&(0,l.jsx)(Me.F,{title:"Failed to save dashboard",severity:"error",children:(0,l.jsx)("p",{children:is.message})}),(0,l.jsx)(K.B,{alignItems:"center",children:os(!1)})]})}return(0,l.jsxs)(Et.Y,{navModel:rn,pageNav:An,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:_t}),(0,l.jsxs)("div",{className:Dn.wrapper,children:[(0,l.jsx)(R.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,l.jsx)(xn.B,{width:"100%",value:Nn,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Dn.codeEditor,onBlur:pe.onCodeEditorBlur}),en&&(0,l.jsx)(I.a,{paddingTop:2,children:ys(We.error)})]})]})}}}const ji=Ae=>({wrapper:(0,v.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ae.spacing(2)}),codeEditor:(0,v.css)({flexGrow:1})});var mr=e(12590);class nr extends s.Bs{static{this.Component=wo}get _dashboard(){return(0,B.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function wo({model:Ae}){const pe=Ae.getDashboard(),{uid:We}=pe.useState(),{navModel:et,pageNav:At}=qa(pe,Ae.getUrlKey()),Nt=Ln.TP.hasPermission(Ze.AccessControlAction.DashboardsPermissionsWrite);return(0,l.jsxs)(Et.Y,{navModel:et,pageNav:At,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:pe}),(0,l.jsx)(mr.x,{resource:"dashboards",resourceId:We??"",canSetPermissions:Nt})]})}var Vo=e(95536),$o=e(66012);const Vr=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function Bi(Ae){return Ae.map(pe=>({id:pe.state.name,label:`${pe.state.name}`}))}function Ui(Ae,pe){return Ae.filter(We=>pe.some(et=>et.from===We.id||et.to===We.id))}const Ni=Ae=>{const pe=[];for(const We of Ae)for(const et of Ae){if(We===et)continue;We.variableDependency?.hasDependencyOn(et.state.name)&&pe.push({from:We.state.name,to:et.state.name})}return pe};function Wi(Ae,pe){if(!pe)return[];let We=[];for(const et of Ae){const At=et.state.name,Nt=(0,$o.Jx)(At,{key:"model",value:pe},{});Object.keys(Nt).length&&We.push({variable:et,tree:Nt})}return We}function zo(Ae){const pe=[];for(const We of Ae){const{variable:et,tree:At}=We,Nt={variable:et,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};pe.push(uo(Nt,{id:"dashboard",value:At}))}return pe}const uo=(Ae,pe)=>{const{id:We,value:et}=pe,{nodes:At,edges:Nt}=Ae;if(et&&typeof et=="string"){const _t=`${pe.id}-${et}`;return At.push({id:_t,label:et}),Nt.push({from:_t,to:We}),Ae}if(ko(et)){const _t=Object.keys(et);for(const rn of _t){const An=`${pe.id}-${rn}`;At.push({id:An,label:rn}),Nt.push({from:An,to:We}),Ae=uo(Ae,{id:An,value:et[rn]})}return Ae}return Ae},Ho=(Ae,pe)=>{const We=pe.find(et=>et.variable.state.name===Ae);return We&&ko(We.tree)?_o(We.tree):0},_o=Ae=>Object.values(Ae).reduce((We,et)=>typeof et=="object"?We+_o(et):We+1,0);async function Fi(Ae,pe){return new Promise((We,et)=>{setTimeout(()=>{try{const At=Go(Ae,pe);We(zo(At))}catch(At){et(At)}},200)})}function Go(Ae,pe){if(!pe)return[];let We=[];const et=Ki(Ae,pe);for(const At of et){const Nt=(0,$o.Jx)(At,{key:"model",value:pe},{});Object.keys(Nt).length&&We.push({variable:At,tree:Nt})}return We}const Ki=(Ae,pe)=>{Vr.lastIndex=0;const We=[],At=(0,Vo.MA)(pe,2).match(Vr);if(!At)return We;for(const Nt of At){if(!Nt||Nt.indexOf("$__")!==-1||Nt.indexOf("${__")!==-1||Nt.indexOf("$hashKey")!==-1)continue;const _t=$r(Nt);Ae.some(rn=>rn.state.name===_t)||We.find(rn=>rn===_t)||_t&&We.push(_t)}return We};function $r(Ae){const pe=Qo(Ae);if(!pe)return;const We=pe.slice(1).find(et=>et!==void 0);if(!(We in{}))return We}const Qo=Ae=>(Vr.lastIndex=0,Vr.exec(Ae));function ko(Ae){return typeof Ae=="object"&&Ae!==null&&!Array.isArray(Ae)}var wi=e(75505),Za=e(39344),ho=e(43908),Yo=e(65164),cr=e(81876),Vi=e(92226),Jo=e(17077),$i=e(36390),sr=e(7807),zi=e(10666),bs=e(86796),Xo=e(99384),Ra=e(23672);function Zo({onChange:Ae,type:pe}){const We=(0,P.useMemo)(()=>(0,Ra.B$)(),[]),et=(0,P.useMemo)(()=>We.find(At=>At.value===pe)??We[0],[We,pe]);return(0,l.jsx)(Xo.v,{name:"Select variable type",value:et,options:We,onChange:Ae,testId:F.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function fo({variable:Ae,onTypeChange:pe,onGoBack:We,onDelete:et,onValidateVariableName:At}){const Nt=(0,b.of)(Hi),[_t,rn]=(0,P.useState)(null),{name:An,type:en,label:Nn,description:as,hide:os,key:Bn}=Ae.useState(),Dn=(0,Ra.bZ)(en)?(0,Ra.CD)(en):void 0,[ys,is]=(0,ke.A)(async()=>{await(0,wi.s)(Ae.validateAndUpdate())},[Ae]),Us=la=>{la.value&&pe(la.value)},Qs=(0,P.useCallback)(la=>{const[,br]=At(la.currentTarget.value,Bn);_t!==br&&rn(br)},[Bn,_t,At]),ga=la=>{_t||Ae.setState({name:la.currentTarget.value})},xs=la=>Ae.setState({label:la.currentTarget.value}),aa=la=>Ae.setState({description:la.currentTarget.value}),rr=la=>Ae.setState({hide:la}),ua=(0,Ra.n_)(Ae),Ca=la=>()=>{(0,Oe.rR)("Delete variable"),et(An),la()};return(0,l.jsxs)("form",{"aria-label":"Variable editor Form",children:[(0,l.jsx)(Zo,{onChange:Us,type:en}),(0,l.jsx)(Jo.Y,{children:"General"}),(0,l.jsx)(sr._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:An??"",onChange:Qs,onBlur:ga,testId:F.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:bs.M.MaxSize,required:!0,invalid:!!_t,error:_t}),(0,l.jsx)(sr._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:Nn??"",onBlur:xs,testId:F.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,l.jsx)($i.Z,{name:"Description",defaultValue:as??"",placeholder:"Descriptive text",onBlur:aa,width:52}),(0,l.jsx)(Vi.D,{onChange:rr,hide:os||Za.rw.hide,type:en}),Dn&&(0,l.jsx)(Dn,{variable:Ae,onRunQuery:is}),ua&&(0,l.jsx)(zi.j,{options:Ae.getOptionsForSelect(!1)}),(0,l.jsx)("div",{className:Nt.buttonContainer,children:(0,l.jsxs)(K.B,{gap:2,children:[(0,l.jsx)(ho.$s,{children:({showModal:la,hideModal:br})=>(0,l.jsx)(ne.$n,{variant:"destructive",fill:"outline",onClick:()=>{la(Yo.u,{title:"Delete variable",body:`Are you sure you want to delete: ${An}?`,confirmText:"Delete variable",onConfirm:Ca(br),onDismiss:br,isOpen:!0})},children:"Delete"})}),(0,l.jsx)(ne.$n,{variant:"secondary","data-testid":F.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:We,children:"Back to list"}),ua&&(0,l.jsx)(ne.$n,{disabled:ys.loading,variant:"secondary","data-testid":F.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:is,children:ys.loading?(0,l.jsx)(cr._,{className:Nt.loadingPlaceHolder,text:"Running query..."}):"Run query"})]})})]})}const Hi=Ae=>({buttonContainer:(0,v.css)({marginTop:Ae.spacing(2)}),loadingPlaceHolder:(0,v.css)({marginBottom:0})});var go=e(57095),qo=e(41079);const zr=({variables:Ae})=>{const pe=(0,P.useMemo)(()=>Bi(Ae),[Ae]),We=(0,P.useMemo)(()=>Ni(Ae),[Ae]);return We.length?(0,l.jsx)(qo.i,{show:!1,title:(0,R.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:Ui(pe,We),edges:We,children:({showModal:et})=>(0,l.jsx)(ne.$n,{onClick:()=>{(0,Oe.rR)("Show variable dependencies"),et()},icon:"channel-add",variant:"secondary",children:(0,l.jsx)(R.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};var ar=e(6736);const vr=({id:Ae,usages:pe,isAdhoc:We})=>{const et=(0,P.useMemo)(()=>pe.find(Nt=>(typeof Nt.variable=="string"?Nt.variable:Nt.variable.state.name)===Ae),[pe,Ae]);if(pe.length===0||We||!et)return null;const At=et.nodes.map(Nt=>Nt.label.includes(`$${Ae}`)?{...Nt,color:"#FB7E81"}:Nt);return(0,l.jsx)(qo.i,{show:!1,title:`Showing usages for: $${Ae}`,nodes:At,edges:et.edges,children:({showModal:Nt})=>(0,l.jsx)(ir.K,{onClick:()=>{(0,Oe.rR)("Show variable usages"),Nt()},name:"code-branch",tooltip:"Show usages"})})};function po({index:Ae,variable:pe,usageTree:We,usagesNetwork:et,onEdit:At,onDuplicate:Nt,onDelete:_t}){const rn=(0,b.$j)(),An=(0,b.of)(ei),en=(0,Ra.Ao)(pe),Nn=pe.state,as=Nn.name,Bn=Ho(as,We)>0||Nn.type==="adhoc",[Dn,ys]=(0,P.useState)(!1),is=Qs=>()=>{ys(Qs)},Us=()=>{(0,Oe.rR)("Delete variable"),_t(as)};return(0,l.jsx)(go.Draggable,{draggableId:JSON.stringify(as),index:Ae,children:(Qs,ga)=>(0,l.jsxs)("tr",{ref:Qs.innerRef,...Qs.draggableProps,style:{userSelect:ga.isDragging?"none":"auto",background:ga.isDragging?rn.colors.background.secondary:void 0,...Qs.draggableProps.style},children:[(0,l.jsx)("td",{role:"gridcell",className:An.column,children:(0,l.jsx)(ne.$n,{size:"xs",fill:"text",onClick:xs=>{xs.preventDefault(),At(as)},className:An.nameLink,"data-testid":F.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(Nn.name),children:Nn.name})}),(0,l.jsx)("td",{role:"gridcell",className:An.definitionColumn,onClick:xs=>{xs.preventDefault(),At(as)},"data-testid":F.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(Nn.name),children:en}),(0,l.jsx)("td",{role:"gridcell",className:An.column,children:(0,l.jsxs)("div",{className:An.icons,children:[(0,l.jsx)(yr,{passed:Bn}),(0,l.jsx)(vr,{id:Nn.name,isAdhoc:Nn.type==="adhoc",usages:et}),(0,l.jsx)(ir.K,{onClick:xs=>{xs.preventDefault(),(0,Oe.rR)("Duplicate variable"),Nt(as)},name:"copy",tooltip:"Duplicate variable","data-testid":F.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(Nn.name)}),(0,l.jsx)(ir.K,{onClick:xs=>{xs.preventDefault(),ys(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":F.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(Nn.name)}),(0,l.jsx)(Yo.u,{isOpen:Dn,title:"Delete variable",body:`Are you sure you want to delete: ${Nn.name}?`,confirmText:"Delete variable",onConfirm:Us,onDismiss:is(!1)}),(0,l.jsx)("div",{...Qs.dragHandleProps,className:An.dragHandle,children:(0,l.jsx)(W.I,{name:"draggabledots",size:"lg"})})]})})]})})}function yr({passed:Ae}){const pe=(0,b.of)(ei);return Ae?(0,l.jsx)(ar.m,{content:"This variable is referenced by other variables or dashboard.",children:(0,l.jsx)(W.I,{name:"check",className:pe.iconPassed,"aria-label":"This variable is referenced by other variables or dashboard."})}):(0,l.jsx)(ar.m,{content:"This variable is not referenced by other variables or dashboard.",children:(0,l.jsx)(W.I,{name:"exclamation-triangle",className:pe.iconFailed,"aria-label":"This variable is not referenced by any variable or dashboard."})})}function ei(Ae){return{dragHandle:(0,v.css)({cursor:"grab",marginLeft:Ae.spacing(1)}),column:(0,v.css)({width:"1%"}),nameLink:(0,v.css)({cursor:"pointer",color:Ae.colors.primary.text}),definitionColumn:(0,v.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,v.css)({color:Ae.v1.palette.greenBase,marginRight:Ae.spacing(2)}),iconFailed:(0,v.css)({color:Ae.v1.palette.orange,marginRight:Ae.spacing(2)}),icons:(0,v.css)({display:"flex",gap:Ae.spacing(2),alignItems:"center"})}}function _i({variables:Ae,usages:pe,usagesNetwork:We,onChangeOrder:et,onDelete:At,onDuplicate:Nt,onAdd:_t,onEdit:rn}){const An=(0,b.of)(ti),en=Nn=>{!Nn.destination||!Nn.source||((0,Oe.rR)("Variable drag and drop"),et(Nn.source.index,Nn.destination.index))};return Ae.length<=0?(0,l.jsx)(xr,{onAdd:_t}):(0,l.jsxs)(K.B,{direction:"column",gap:3,children:[(0,l.jsxs)("table",{className:ms()("filter-table","filter-table--hover",An.tableContainer),"data-testid":F.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Variable"}),(0,l.jsx)("th",{children:"Definition"}),(0,l.jsx)("th",{colSpan:5})]})}),(0,l.jsx)(go.DragDropContext,{onDragEnd:en,children:(0,l.jsx)(go.Droppable,{droppableId:"variables-list",direction:"vertical",children:Nn=>(0,l.jsxs)("tbody",{ref:Nn.innerRef,...Nn.droppableProps,children:[Ae.map((as,os)=>{const Bn=as.state;return(0,l.jsx)(po,{index:os,variable:as,onDelete:At,onDuplicate:Nt,onEdit:rn,usageTree:pe,usagesNetwork:We},`${Bn.name}-${os}`)}),Nn.placeholder]})})})]}),(0,l.jsxs)(K.B,{children:[(0,l.jsx)(zr,{variables:Ae}),(0,l.jsx)(ne.$n,{"data-testid":F.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:_t,icon:"plus",children:"New variable"})]})]})}function xr({onAdd:Ae}){return(0,l.jsx)(K.B,{direction:"column",children:(0,l.jsxs)(Pa.p,{variant:"call-to-action",button:(0,l.jsx)(ne.$n,{"data-testid":F.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Ae,size:"lg",children:(0,l.jsx)(R.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,R.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,l.jsx)("p",{children:(0,l.jsx)(R.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,l.jsxs)(R.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,l.jsx)(ro.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const ti=()=>({tableContainer:(0,v.css)({overflow:"auto"})}),Qa=1e3;function mo({variables:Ae,dashboard:pe}){const[We,et]=(0,P.useState)(!1),[At,Nt]=(0,P.useState)(0),_t=(0,b.of)(zs);(0,P.useEffect)(()=>Nt(as=>as+1),[Ae,pe]);const[{loading:rn,value:An},en]=(0,ke.A)(async()=>{const as=Date.now(),os=await Fi(Ae,pe),Dn=Date.now()-as;return Dn>=Qa&&(0,Oe.rR)("Slow unknown variables expansion",{elapsed:Dn}),Nt(0),os},[Ae,pe]),Nn=as=>{as&&((0,Oe.rR)("Unknown variables section expanded"),At>0&&en()),et(as)};return(0,l.jsx)("div",{className:_t.container,children:(0,l.jsx)(No.M,{label:(0,l.jsx)(ka,{}),isOpen:We,onToggle:Nn,children:rn||!An?(0,l.jsx)(K.B,{justifyContent:"center",direction:"column",children:(0,l.jsxs)(K.B,{justifyContent:"center",children:[(0,l.jsx)("span",{children:(0,l.jsx)(R.x6,{i18nKey:"variables.unknown-table.loading",children:"Loading..."})}),(0,l.jsx)(vs.y,{})]})}):An.length>0?(0,l.jsx)(vo,{usages:An}):(0,l.jsx)(Ya,{})})})}function ka(){const Ae=(0,b.of)(zs);return(0,l.jsxs)("h5",{children:[(0,l.jsx)(R.x6,{i18nKey:"variables.unknown-table.renamed-or-missing-variables",children:"Renamed or missing variables"}),(0,l.jsx)(ar.m,{content:"Click to expand a list with all variable references that have been renamed or are missing from the dashboard.",children:(0,l.jsx)(W.I,{name:"info-circle",className:Ae.infoIcon})})]})}function Ya(){return(0,l.jsx)("span",{children:(0,l.jsx)(R.x6,{i18nKey:"variables.unknown-table.no-unknowns",children:"No renamed or missing variables found."})})}function vo({usages:Ae}){const pe=(0,b.of)(zs);return(0,l.jsxs)("table",{className:"filter-table filter-table--hover",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:(0,l.jsx)(R.x6,{i18nKey:"variables.unknown-table.variable",children:"Variable"})}),(0,l.jsx)("th",{colSpan:5})]})}),(0,l.jsx)("tbody",{children:Ae.map(We=>{const et=typeof We.variable=="string"?We.variable:We.variable.state.name;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:pe.firstColumn,children:(0,l.jsx)("span",{children:et})}),(0,l.jsx)("td",{className:pe.defaultColumn}),(0,l.jsx)("td",{className:pe.defaultColumn}),(0,l.jsx)("td",{className:pe.defaultColumn}),(0,l.jsx)("td",{className:pe.lastColumn,children:(0,l.jsx)(vr,{id:et,usages:Ae,isAdhoc:!1})})]},et)})})]})}const zs=Ae=>({container:(0,v.css)({marginTop:Ae.spacing(4),paddingTop:Ae.spacing(4)}),infoIcon:(0,v.css)({marginLeft:Ae.spacing(1)}),defaultColumn:(0,v.css)({width:"1%"}),firstColumn:(0,v.css)({width:"1%",verticalAlign:"top",color:Ae.colors.text.maxContrast}),lastColumn:(0,v.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",textAlign:"right"})});class ni extends s.Bs{constructor(){super(...arguments),this._urlSync=new Fr(this),this.getVariableIndex=pe=>this.getVariables().findIndex(et=>et.state.name===pe),this.replaceEditVariable=pe=>{const We=this.state.editIndex??-1,{variables:et}=this.getVariableSet().state;if(!et[We]){console.error("Variable not found");return}const Nt=[...et.slice(0,We),pe,...et.slice(We+1)];this.getVariableSet().setState({variables:Nt})},this.onDelete=pe=>{const We=this.getVariableIndex(pe),{variables:et}=this.getVariableSet().state;if(We===-1){console.error("Variable not found");return}const At=[...et.slice(0,We),...et.slice(We+1)];this.getVariableSet().setState({variables:At}),this.setState({editIndex:void 0})},this.onDuplicated=pe=>{const We=this.getVariableIndex(pe),et=this.getVariableSet().state.variables;if(We===-1){console.error("Variable not found");return}const At=et[We];let Nt=0,_t=`copy_of_${At.state.name}`;for(;et.some(en=>en.state.name===_t);)Nt++,_t=`copy_of_${At.state.name}_${Nt}`;const rn=At.clone(At.state);rn.setState({name:_t});const An=[...et.slice(0,We+1),rn,...et.slice(We+1)];this.getVariableSet().setState({variables:An})},this.onOrderChanged=(pe,We)=>{const et=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(pe<0||pe>=et.length||We<0||We>=et.length){console.error("Invalid index");return}const At=[...et],Nt=At.splice(pe,1);At.splice(We,0,Nt[0]),this.getVariableSet().setState({variables:At})},this.onEdit=pe=>{const We=this.getVariableIndex(pe);if(We===-1){console.error("Variable not found");return}this.setState({editIndex:We})},this.onAdd=()=>{const pe=this.getVariables(),We=pe.length,et=(0,Ra.kh)(pe);this.getVariableSet().setState({variables:[...this.getVariables(),et]}),this.setState({editIndex:We})},this.onTypeChange=pe=>{const We=this.state.editIndex??-1,{variables:et}=this.getVariableSet().state,At=et[We];if(!At){console.error("Variable not found");return}const{name:Nt,label:_t}=At.state,rn=(0,Ra.No)(pe,{name:Nt,label:_t});this.replaceEditVariable(rn)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(pe,We)=>{let et=null;Ra.cH.test(pe)||(et="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Ra.mJ.test(pe)||(et="Only word characters are allowed in variable names");const At=this.getVariableSet().getByName(pe)?.state;return At&&At.key!==We&&(et="Variable with the same name already exists"),et?[!0,et]:[!1,null]},this.getSaveModel=()=>(0,Pt.Uy)(this.getDashboard()),this.getUsages=()=>{const pe=this.getSaveModel();return Wi(this.getVariables(),pe)},this.getUsagesNetwork=()=>{const pe=this.getUsages();return zo(pe)}}static{this.Component=Er}getUrlKey(){return"variables"}getDashboard(){return(0,B.YQ)(this)}getVariableSet(){return s.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function Er({model:Ae}){const pe=Ae.getDashboard(),{navModel:We,pageNav:et}=qa(pe,Ae.getUrlKey()),{onDelete:At,onDuplicated:Nt,onOrderChanged:_t,onEdit:rn,onTypeChange:An,onGoBack:en,onAdd:Nn}=Ae,{variables:as}=Ae.getVariableSet().useState(),{editIndex:os}=Ae.useState(),Bn=(0,P.useMemo)(()=>Ae.getUsagesNetwork(),[Ae]),Dn=(0,P.useMemo)(()=>Ae.getUsages(),[Ae]),ys=Ae.getSaveModel();if(os!==void 0&&as[os]){const is=as[os];if(is)return(0,l.jsx)(yo,{variable:is,onTypeChange:An,onGoBack:en,pageNav:et,navModel:We,dashboard:pe,onDelete:At,onValidateVariableName:Ae.onValidateVariableName})}return(0,l.jsxs)(Et.Y,{navModel:We,pageNav:et,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:pe}),(0,l.jsx)(_i,{variables:as,usages:Dn,usagesNetwork:Bn,onDelete:At,onDuplicate:Nt,onChangeOrder:_t,onAdd:Nn,onEdit:rn}),(0,l.jsx)(mo,{variables:as,dashboard:ys})]})}function yo({variable:Ae,pageNav:pe,navModel:We,dashboard:et,onTypeChange:At,onGoBack:Nt,onDelete:_t,onValidateVariableName:rn}){const{name:An}=Ae.useState(),en={text:An,parentItem:pe};return(0,l.jsxs)(Et.Y,{navModel:We,pageNav:en,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:et}),(0,l.jsx)(fo,{variable:Ae,onTypeChange:At,onGoBack:Nt,onDelete:_t,onValidateVariableName:rn},Ae.state.key)]})}const Hr=10;class xo extends s.Bs{constructor(pe){super({...pe,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=Hr,this._start=0,this._continueToken="",this.fetchVersions=(We=!1)=>{const et=this._dashboard.state.uid;if(!et)return;this.setState({isAppending:We});const At=this._continueToken?{limit:this._limit,start:this._start,continueToken:this._continueToken}:{limit:this._limit,start:this._start};Tn.wL.getHistoryList(et,At).then(Nt=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(Nt.versions)]}),this._start+=this._limit,this._continueToken=Nt.continueToken??""}).catch(Nt=>console.log(Nt)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const We=this.versions.filter(An=>An.checked),[et,At]=We,Nt=et.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;let _t,rn;i.$.featureToggles.kubernetesClientDashboardsFolders?(_t=await Tn.wL.getDashboardVersion(this._dashboard.state.uid,At.id),rn=await Tn.wL.getDashboardVersion(this._dashboard.state.uid,et.id)):(_t=await Tn.wL.getDashboardVersion(this._dashboard.state.uid,At.version),rn=await Tn.wL.getDashboardVersion(this._dashboard.state.uid,et.version)),this.setState({baseInfo:At,isLoading:!1,isNewLatest:Nt,newInfo:et,viewMode:"compare",diffData:{lhs:_t.data,rhs:rn.data}})},this.reset=()=>{this._continueToken="",this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(We=>({...We,checked:!1})),viewMode:"list"})},this.onCheck=(We,et)=>{this.setState({versions:this.versions.map(At=>At.id===et?{...At,checked:We.currentTarget.checked}:At)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=si}get _dashboard(){return(0,B.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return s.jh.getTimeRange(this._dashboard)}decorateVersions(pe){const We=this.getTimeRange().getTimeZone();return pe.map(et=>({...et,createdDateString:(0,ls.LE)(et.created,{timeZone:We}),ageString:(0,ls.fq)(et.created,{timeZone:We}),checked:!1}))}}function si({model:Ae}){const pe=Ae.getDashboard(),{isLoading:We,isAppending:et,viewMode:At,baseInfo:Nt,newInfo:_t,isNewLatest:rn}=Ae.useState(),{navModel:An,pageNav:en}=qa(pe,Ae.getUrlKey()),Nn=Ae.versions.filter(is=>is.checked).length===2,as=Ae.versions.length>1,os=Ae.versions.length>=Ae.limit,Bn=Ae.versions.find(is=>is.version===1),Dn=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Tn.me,{onClick:Ae.reset,baseVersion:Nt?.version,newVersion:_t?.version,isNewLatest:rn}),We?(0,l.jsx)(Pr,{msg:"Fetching changes\u2026"}):(0,l.jsx)(Tn.Cc,{newInfo:_t,baseInfo:Nt,isNewLatest:rn,diffData:Ae.diffData,onRestore:pe.onRestore})]}),ys=(0,l.jsxs)(l.Fragment,{children:[We?(0,l.jsx)(Pr,{msg:"Fetching history list\u2026"}):(0,l.jsx)(Tn.bS,{versions:Ae.versions,onCheck:Ae.onCheck,canCompare:Nn,onRestore:pe.onRestore}),et&&(0,l.jsx)(Pr,{msg:"Fetching more entries\u2026"}),as&&(0,l.jsx)(Tn.rJ,{hasMore:os,canCompare:Nn,getVersions:Ae.fetchVersions,getDiff:Ae.getDiff,isLastPage:!!Bn})]});return(0,l.jsxs)(Et.Y,{navModel:An,pageNav:en,layout:ut.k.Standard,children:[(0,l.jsx)(Ft.c,{dashboard:pe}),At==="compare"?Dn:ys]})}const Pr=({msg:Ae})=>(0,l.jsxs)(K.B,{children:[(0,l.jsx)(vs.y,{}),(0,l.jsx)("em",{children:Ae})]});function qa(Ae,pe){const We=(0,Ct.zy)(),et=(0,Ze.useSelector)(rn=>rn.navIndex),At=(0,u.tc)(et,"dashboards/browse"),Nt=Ae.getPageNav(We,et),_t={text:"Settings",url:t.I.getUrlForPartial(We,{editview:"settings",editIndex:null}),children:[],parentItem:Nt};return Ae.state.meta.canEdit&&(_t.children.push({text:(0,R.t)("dashboard-settings.general.title","General"),url:t.I.getUrlForPartial(We,{editview:"settings",editIndex:null}),active:pe==="settings"}),_t.children.push({text:(0,R.t)("dashboard-settings.annotations.title","Annotations"),url:t.I.getUrlForPartial(We,{editview:"annotations",editIndex:null}),active:pe==="annotations"}),_t.children.push({text:(0,R.t)("dashboard-settings.variables.title","Variables"),url:t.I.getUrlForPartial(We,{editview:"variables",editIndex:null}),active:pe==="variables"}),_t.children.push({text:(0,R.t)("dashboard-settings.links.title","Links"),url:t.I.getUrlForPartial(We,{editview:"links",editIndex:null}),active:pe==="links"})),Ae.state.uid&&Ae.state.meta.canSave&&_t.children.push({text:(0,R.t)("dashboard-settings.versions.title","Versions"),url:t.I.getUrlForPartial(We,{editview:"versions",editIndex:null}),active:pe==="versions"}),Ae.state.uid&&Ae.state.meta.canAdmin&&Ln.TP.hasPermission(Ze.AccessControlAction.DashboardsPermissionsRead)&&_t.children.push({text:(0,R.t)("dashboard-settings.permissions.title","Permissions"),url:t.I.getUrlForPartial(We,{editview:"permissions",editIndex:null}),active:pe==="permissions"}),_t.children.push({text:(0,R.t)("dashboard-settings.json-editor.title","JSON Model"),url:t.I.getUrlForPartial(We,{editview:"json-model",editIndex:null}),active:pe==="json-model"}),{navModel:At,pageNav:_t}}function il(Ae){switch(Ae){case"annotations":return new Si({});case"variables":return new ni({});case"links":return new jo({});case"versions":return new xo({});case"json-model":return new co({});case"permissions":return new nr({});case"settings":default:return new Ko({})}}var _r=e(60712),Dr=e(19580);class dr extends s.Bs{constructor(pe){super(pe),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const pe=this.state.panelRef.resolve();return(0,B.sf)(pe)}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:pe})=>{const{panelRef:We}=pe.useState(),et=We.resolve();return(0,l.jsx)(et.Component,{model:et})}}}class Gi{constructor(pe){this._scene=pe}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk","shareView"]}getUrlState(){const pe=this._scene.state;return{inspect:pe.inspectPanelKey,autofitpanels:this.getAutoFitPanels(),viewPanel:pe.viewPanelScene?.getUrlKey(),editview:pe.editview?.getUrlKey(),editPanel:pe.editPanel?.getUrlKey()||void 0,kiosk:pe.kioskMode===Ze.KioskMode.Full?"":void 0,shareView:pe.shareView,orgId:Ln.TP.user.orgId.toString()}}getAutoFitPanels(){if(this._scene.state.body instanceof us.D)return this._scene.state.body.state.grid.state.UNSAFE_fitPanels?"true":void 0}updateFromUrl(pe){const{inspectPanelKey:We,viewPanelScene:et,isEditing:At,editPanel:Nt,shareView:_t}=this._scene.state,rn={};if(typeof pe.editview=="string"&&this._scene.canEditDashboard()?(rn.editview=il(pe.editview),At||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):rn.editview=void 0)):pe.hasOwnProperty("editview")&&(rn.editview=void 0),typeof pe.inspect=="string"){let en=(0,B.vL)(this._scene,pe.inspect);if(!en){if((0,L.ag)(pe.inspect)){this._handleInspectRepeatClone(pe.inspect);return}c.A.emit(n.r1.alertError,["Panel not found"]),a.Ny.partial({inspect:null});return}rn.inspectPanelKey=pe.inspect,rn.overlay=new So({panelRef:en.getRef()})}else We&&(rn.inspectPanelKey=void 0,rn.overlay=void 0);if(typeof pe.viewPanel=="string"){const en=(0,B.vL)(this._scene,pe.viewPanel);if(!en){if((0,L.ag)(pe.viewPanel)){this._handleViewRepeatClone(pe.viewPanel);return}c.A.emit(n.r1.alertError,["Panel not found"]),a.Ny.partial({viewPanel:null});return}rn.viewPanelScene=new dr({panelRef:en.getRef()})}else et&&pe.viewPanel===null&&(rn.viewPanelScene=void 0);if(typeof pe.editPanel=="string"){const en=(0,B.Uv)(this._scene,pe.editPanel);if(!en){console.warn(`Panel ${pe.editPanel} not found`);return}this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),At||this._scene.onEnterEditMode();const Nn=(0,B.iL)(en);if(Nn&&!Nn?.state.isLoaded){this._waitForLibPanelToLoadBeforeEnteringPanelEdit(en,Nn);return}rn.editPanel=(0,Nr.L)(en)}else Nt&&pe.editPanel===null&&(rn.editPanel=void 0);typeof pe.shareView=="string"?(rn.shareView=pe.shareView,rn.overlay=i.$.featureToggles.newDashboardSharingComponent?new _r.j({shareView:pe.shareView}):new Dr.Z({activeTab:pe.shareView})):_t&&pe.shareView===null&&(rn.overlay=void 0,rn.shareView=void 0);const An=this._scene.state.body;if(An instanceof us.D){const en=typeof pe.autofitpanels=="string";!!An.state.grid.state.UNSAFE_fitPanels!==en&&An.state.grid.setState({UNSAFE_fitPanels:en})}typeof pe.kiosk=="string"&&(pe.kiosk==="true"||pe.kiosk==="")&&(rn.kioskMode=Ze.KioskMode.Full),Object.keys(rn).length>0&&this._scene.setState(rn)}_handleInspectRepeatClone(pe){this._inspectEventSub||(this._inspectEventSub=this._scene.subscribeToEvent(Yt.d,()=>{const We=(0,B.vL)(this._scene,pe);We&&(this._inspectEventSub?.unsubscribe(),this._scene.setState({inspectPanelKey:pe,overlay:new So({panelRef:We.getRef()})}))}))}_handleViewRepeatClone(pe){this._viewEventSub||(this._viewEventSub=this._scene.subscribeToEvent(Yt.d,()=>{const We=(0,B.vL)(this._scene,pe);We&&(this._viewEventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new dr({panelRef:We.getRef()})}))}))}_waitForLibPanelToLoadBeforeEnteringPanelEdit(pe,We){const et=We.subscribeToState(At=>{At.isLoaded&&(this._scene.setState({editPanel:(0,Nr.L)(pe)}),et.unsubscribe())})}}var Cr=e(15407),Eo=e(35383),Po=e(14765);class Fa{constructor(){this._binds=[]}addBinding(pe){Po.R.bind(pe.key,We=>{We.preventDefault(),We.stopPropagation(),We.returnValue=!1,pe.onTrigger()},"keydown"),this._binds.push(pe)}removeAll(){this._binds.forEach(pe=>{Po.R.unbind(pe.key,pe.type)}),this._binds=[]}}var Gr=e(25309),ai=e(66110);function Js(Ae){const pe=new Fa;let We=null;const et=Ae.canEditDashboard(),At=c.A.subscribe(Eo.Tp,_t=>{typeof _t.payload.panelId=="string"&&(We=_t.payload.panelId)});function Nt(_t,rn){return()=>{const An=s.jh.findObject(_t,en=>en.state.key===We);if(An&&An instanceof s.Eb){rn(An);return}}}return pe.addBinding({key:"v",onTrigger:Nt(Ae,_t=>{if(!Ae.state.viewPanelScene){const rn=t.I.stripBaseFromUrl((0,zn.r7)(_t));a.Ny.push(rn)}})}),i.$.featureToggles.newDashboardSharingComponent?(pe.addBinding({key:"p u",onTrigger:Nt(Ae,async _t=>{const rn=new _r.j({shareView:Gr.wr.link,panelRef:_t.getRef()});Ae.showModal(rn)})}),pe.addBinding({key:"p e",onTrigger:Nt(Ae,async _t=>{const rn=new _r.j({shareView:Gr.wr.embed,panelRef:_t.getRef()});Ae.showModal(rn)})}),Vs.TP.isSignedIn&&i.$.snapshotEnabled&&Vs.TP.hasPermission(Ze.AccessControlAction.SnapshotsCreate)&&pe.addBinding({key:"p s",onTrigger:Nt(Ae,async _t=>{const rn=new _r.j({shareView:Gr.wr.snapshot,panelRef:_t.getRef()});Ae.showModal(rn)})})):pe.addBinding({key:"p s",onTrigger:Nt(Ae,async _t=>{Ae.showModal(new Dr.Z({panelRef:_t.getRef()}))})}),pe.addBinding({key:"i",onTrigger:Nt(Ae,async _t=>{a.Ny.push(t.I.stripBaseFromUrl((0,zn.Uu)(_t)))})}),pe.addBinding({key:"p x",onTrigger:Nt(Ae,async _t=>{const rn=await(0,zn.Lp)(_t);rn&&a.Ny.push(rn)})}),pe.addBinding({key:"p l",onTrigger:Nt(Ae,ai.vR)}),pe.addBinding({key:"d r",onTrigger:()=>s.jh.getTimeRange(Ae).onRefresh()}),pe.addBinding({key:"t z",onTrigger:()=>{ri(Ae)}}),pe.addBinding({key:"ctrl+z",onTrigger:()=>{ri(Ae)}}),pe.addBinding({key:"t a",onTrigger:()=>{le.b4.getTimePicker(Ae)?.toAbsolute()}}),pe.addBinding({key:"t left",onTrigger:()=>{Ja(Ae,"left")}}),pe.addBinding({key:"t right",onTrigger:()=>{Ja(Ae,"right")}}),et&&(pe.addBinding({key:"e",onTrigger:Nt(Ae,async _t=>{if(_t.getRoot()instanceof ur){const An=(0,B.Cs)(_t);if(!Ae.state.editPanel){const en=t.I.stripBaseFromUrl((0,zn.e0)(An));a.Ny.push(en)}}})}),pe.addBinding({key:"d s",onTrigger:Ae.onOpenSettings}),pe.addBinding({key:"mod+s",onTrigger:()=>Ae.openSaveDrawer({})}),pe.addBinding({key:"p r",onTrigger:Nt(Ae,_t=>{Ae.state.isEditing&&(0,ai.MI)(Ae,_t)})}),pe.addBinding({key:"p d",onTrigger:Nt(Ae,_t=>{Ae.state.isEditing&&Ae.duplicatePanel(_t)})}),pe.addBinding({key:"d shift+c",onTrigger:()=>{Ae.state.body instanceof us.D&&Ae.state.body.collapseAllRows()}}),pe.addBinding({key:"d shift+e",onTrigger:()=>{Ae.state.body instanceof us.D&&Ae.state.body.expandAllRows()}})),()=>{pe.removeAll(),At.unsubscribe()}}function ri(Ae){le.b4.getTimePicker(Ae)?.onZoom()}function Ja(Ae,pe){const We=le.b4.getTimePicker(Ae);We&&(pe==="left"&&We.onMoveBackward(),pe==="right"&&We.onMoveForward())}const qs=["title","description","tags","editable","graphTooltip","links","meta","preload"],_a="systemPanelFilterVar",Do="systemDynamicRowSizeVar";class ur extends s.Bs{constructor(pe){super({title:"Dashboard",meta:{},editable:!0,$timeRange:pe.$timeRange??new s.JZ({}),body:pe.body??us.D.fromVizPanels(),links:pe.links??[],...pe,editPane:new Se}),this._urlSync=new Gi(this),this._variableDependency=new oi(this),this._serializer=gn(),this.onEnterEditMode=()=>{this._initialState=s.Go.cloneSceneObjectState(this.state),this._initialUrlState=a.Ny.getLocation(),this.setState({isEditing:!0,showHiddenElements:!0}),this.state.body.editModeChanged?.(!0),this._scopesFacade?.enterReadOnly(),this._changeTracker.startTrackingChanges()},this.onToggleHiddenElements=()=>this.setState({showHiddenElements:!this.state.showHiddenElements}),this.onRestore=async We=>{let et;if(i.$.featureToggles.kubernetesClientDashboardsFolders?et=await Tn.wL.restoreDashboard(We.uid,We.id):et=await Tn.wL.restoreDashboard(We.uid,We.version),!Number.isInteger(et.version))return!1;const At={dashboard:new m.G(We.data),meta:this.state.meta},Nt=(0,On.wM)(At),_t=s.Go.cloneSceneObjectState(Nt.state);return _t.version=et.version,this.setState(_t),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{a.Ny.partial({editview:"settings"})},this.getSnapshotUrl=()=>this._serializer.getSnapshotUrl(),this.onSetScrollRef=We=>{this._scrollRef=We},this._scopesFacade=(0,h.DF)(this),this._changeTracker=new we.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=En}_activationHandler(){let pe=window.__grafanaSceneContext;const We=a.Ny.getLocation().pathname==="/dashboard/new";window.__grafanaSceneContext=this,this._initializePanelSearch(),this.state.isEditing&&(this._initialUrlState=a.Ny.getLocation(),this._changeTracker.startTrackingChanges()),We&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&p.t.watch(this.state.uid);let et=()=>{};i.$.publicDashboardAccessToken||(et=Js(this));const At=new on(this);return(0,E.UA)().setCurrent(At),()=>{window.__grafanaSceneContext=pe,et(),this._changeTracker.terminate(),At.destroy(),p.t.leave()}}_initializePanelSearch(){const pe=s.jh.lookupVariable(_a,this)?.getValue();typeof pe=="string"&&this.setState({panelSearch:pe});const We=s.jh.lookupVariable(Do,this)?.getValue();if(typeof We=="string"){const et=Number.parseInt(We,10);this.setState({panelsPerRow:Number.isInteger(et)?et:void 0})}}saveCompleted(pe,We,et){this._serializer.onSaveComplete(pe,We),this._changeTracker.stopTrackingChanges(),this.setState({version:We.version,isDirty:!1,uid:We.uid,id:We.id,meta:{...this.state.meta,uid:We.uid,url:We.url,slug:We.slug,folderUid:et,version:We.version}}),this.state.editPanel?.dashboardSaved(),this._changeTracker.startTrackingChanges()}exitEditMode({skipConfirm:pe,restoreInitialState:We}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||pe){this.exitEditModeConfirmed(We||this.state.isDirty),this._scopesFacade?.exitReadOnly();return}c.A.publish(new C.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:()=>{this.exitEditModeConfirmed(),this._scopesFacade?.exitReadOnly()}}))}exitEditModeConfirmed(pe=!0){this._changeTracker.stopTrackingChanges();const We=t.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null,shareView:null});a.Ny.replace(t.I.stripBaseFromUrl(We)),pe?this.setState({...this._initialState,isEditing:!1,showHiddenElements:!1}):this.setState({isEditing:!1,showHiddenElements:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.state.body.editModeChanged?.(!1)}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:pe,onSaveSuccess:We}){this.state.isEditing&&this.setState({overlay:new Ot({dashboardRef:this.getRef(),saveAsCopy:pe,onSaveSuccess:We})})}openV2SchemaEditor(){this.setState({overlay:new St({dashboardRef:this.getRef()})})}getPageNav(pe,We){const{meta:et,viewPanelScene:At,editPanel:Nt,title:_t,uid:rn}=this.state,An=!rn;let en={text:_t,url:(0,Yn.u)({uid:rn,slug:et.slug,currentQueryParams:pe.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null,shareView:null},isHomeDashboard:!et.url&&!et.slug&&!An&&!et.isSnapshot,isSnapshot:et.isSnapshot})};const{folderUid:Nn}=et;if(Nn){const as=(0,u.tc)(We,`folder-dashboards-${Nn}`).main;as.id!=="not-found"&&(en={...en,parentItem:as})}return At&&(en={text:"View panel",parentItem:en,url:(0,zn.r7)(At.state.panelRef.resolve())}),Nt&&(en={text:"Edit panel",parentItem:en}),en}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addPanel(pe){this.state.isEditing||this.onEnterEditMode(),this.state.body.addPanel(pe)}createLibraryPanel(pe,We){const et=pe.clone({$behaviors:[new an.u({uid:We.uid,name:We.name})]}),At=pe.parent;if(!(At instanceof mn.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");At.setState({body:et})}duplicatePanel(pe){(0,B.h$)(pe).duplicatePanel?.(pe)}copyPanel(pe){if(!pe.parent)return;let We=pe.parent;if(!(We instanceof mn.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const et=(0,Pt.ZB)(We);g.A.set(d.tH,JSON.stringify(et)),c.A.emit(n.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){const pe=g.A.get(d.tH),We=JSON.parse(pe),et=new f.a9(We),Nt=(0,On.tt)(et).state.body;this.addPanel(Nt),g.A.delete(d.tH)}removePanel(pe){(0,B.h$)(pe).removePanel?.(pe)}unlinkLibraryPanel(pe){if(!pe.parent)return;const We=pe.parent;if(!(We instanceof mn.U)){console.error("Trying to unlink a lib panel in a layout that is not DashboardGridItem");return}We.state.body.setState({$behaviors:void 0})}showModal(pe){this.setState({overlay:pe})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:pe,uid:We}=this.state;if(We)try{const et=await(0,E.UA)().starDashboard(We,!!pe.isStarred);this.setState({meta:{...pe,isStarred:et}})}catch(et){console.error("Failed to star dashboard",et)}}onShowAddLibraryPanelDrawer(pe){this.setState({overlay:new yn({panelToReplaceRef:pe})})}onCreateNewRow(){this.state.body.addNewRow()}onCreateNewTab(){this.state.body.addNewTab()}onCreateNewPanel(){const pe=(0,B.O8)();return this.addPanel(pe),pe}switchLayout(pe){this.setState({body:pe}),pe.activateRepeaters?.()}enrichDataRequest(pe){const We=(0,B.YQ)(pe);let et=(0,B.xz)(pe);We.state.isEditing&&We.state.editPanel&&(et=We.state.editPanel.state.panelRef.resolve());let At=0;return et&&et.state.key&&((0,L.uc)(et.state.key)?At=In(et?.state.key):At=(0,B.Cs)(et)),{app:r.Jk.Dashboard,dashboardUID:this.state.uid,panelId:At,panelName:et?.state?.title,panelPluginId:et?.state.pluginId,scopes:this._scopesFacade?.value}}enrichFiltersRequest(){return{scopes:this._scopesFacade?.value}}canEditDashboard(){const{meta:pe}=this.state;return!!(pe.canEdit||pe.canMakeEditable)}getInitialSaveModel(){return this._serializer.initialSaveModel}setInitialSaveModel(pe,We){this._serializer.initialSaveModel=(0,o.v)(pe),this._serializer.metadata=We}getTrackingInformation(){return this._serializer.getTrackingInformation(this)}async onDashboardDelete(){this.setState({isDirty:!1}),a.Ny.replace("/")}getDashboardPanels(){return le.b4.getVizPanels(this)}hasDashboardAngularPlugins(){const pe=this.state.body;return pe instanceof us.D?pe.state.grid.state.children.some(At=>{if(!(At instanceof mn.U))return!1;const Nt=(0,Cr.Wu)(At.state.body),_t=(0,Cr.Tr)(At.state.body);return Nt||_t}):!1}rememberScrollPos(){this._prevScrollPos=this._scrollRef?.scrollTop}restoreScrollPos(){this._prevScrollPos!==void 0&&this._scrollRef?.scrollTo(0,this._prevScrollPos)}getSaveModel(){return this._serializer.getSaveModel(this)}getSaveAsModel(pe){return this._serializer.getSaveAsModel(this,pe)}getDashboardChanges(pe,We,et){return this._serializer.getDashboardChangesFromScene(this,{saveTimeRange:pe,saveVariables:We,saveRefresh:et})}}class oi{constructor(pe){this._dashboard=pe,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(pe,We){if(We&&(c.A.publish(new D.og({refreshAll:!0,panelIds:[]})),this._dashboard.publishEvent(new x._)),pe.state.name===_a){const et=pe.getValue();typeof et=="string"&&this._dashboard.setState({panelSearch:et})}else if(pe.state.name===Do){const et=pe.getValue();if(typeof et=="string"){const At=Number.parseInt(et,10);this._dashboard.setState({panelsPerRow:Number.isInteger(At)?At:void 0})}}}}function Qi(Ae){return"elements"in Ae}},60887:(q,j,e)=>{"use strict";e.d(j,{m:()=>r});var t=e(61034),n=e(81635);class r extends n.mN{constructor({reloadOnParamsChange:i,uid:x}){super({handler:s=>{(!i||!x)&&t.jh.getTimeRange(s).onRefresh()}})}}},72929:(q,j,e)=>{"use strict";e.d(j,{u:()=>p});var t=e(74848),n=e(68256),r=e(32370),a=e(61034),i=e(48583),x=e(11817),s=e(63845),c=e(81569),d=e(78974),u=e(3987),g=e(66110),o=e(86359),E=e(36054),m=e(15407),f=e(60101);class p extends a.Bs{static{this.LOADING_VIZ_PANEL_PLUGIN_ID="library-panel-loading-plugin"}constructor(l){super(l),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.isLoaded||this.loadLibraryPanelFromPanelModel()}setPanelFromLibPanel(l){if(this.state._loadedPanel?.version===l.version)return;const v=this.parent;if(!(v instanceof a.Eb))return;const y=new s.a9(l.model),P=[];r.$.featureToggles.angularDeprecationUI&&P.push(new m.$L),P.push(new u.$({rawLinks:y.links,menu:new u.m({$behaviors:[g.oV]})})),P.push(new o.W);const b={title:v.state.title??y.title,options:y.options??{},fieldConfig:y.fieldConfig,pluginId:y.type,pluginVersion:y.pluginVersion,displayMode:y.transparent?"transparent":void 0,description:y.description,titleItems:P,$data:(0,d.w)(y)};(y.timeFrom||y.timeShift)&&(b.$timeRange=new E.v({timeFrom:y.timeFrom,timeShift:y.timeShift,hideTimeOverride:y.hideTimeOverride})),v.setState(b),v.changePluginType(y.type,b.options,b.fieldConfig),this.setState({_loadedPanel:l,isLoaded:!0,name:l.name});const S=v.parent;y.repeat&&S instanceof f.U&&(S.setState({variableName:y.repeat,repeatDirection:y.repeatDirection==="h"?"h":"v",maxPerRow:y.maxPerRow,itemHeight:S.state.height??10}),S.performRepeat())}unlink(){const l=this.parent;l instanceof a.Eb&&l.setState({$behaviors:l.state.$behaviors?.filter(v=>v!==this)})}async loadLibraryPanelFromPanelModel(){let l=this.parent;if(l instanceof a.Eb)try{const v=await(0,c.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(v)}catch{l.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}const h=new n.m(D);function D(C){return(0,t.jsx)(i.B,{direction:"column",justifyContent:"space-between",children:(0,t.jsx)(x.x6,{i18nKey:"library-panels.loading-panel-text",children:"Loading library panel"})})}a.Go.registerRuntimePanelPlugin({pluginId:p.LOADING_VIZ_PANEL_PLUGIN_ID,plugin:h})},40284:(q,j,e)=>{"use strict";e.d(j,{c:()=>me});var t=e(74848),n=e(96540),r=e(22803),a=e(69199),i=e(58779),x=e(32370),s=e(53027),c=e(29675),d=e(52120),u=e(79784),g=e(66384),o=e(76302),E=e(29010),m=e(60232),f=e(19224),p=e(54594),h=e(90333),D=e(48583),C=e(48194),l=e(91536),v=e(23838),y=e(40828),P=e(87638),b=e(11817),S=e(16910),M=e(40819),O=e(81635),R=e(25309),L=e(97805),B=e(83424);const F=i.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,I=[];function U(Qe){I.push(Qe)}function W({dashboard:Qe}){const we=Te=>{s.Ny.partial({shareView:Te})},$e=(0,n.useCallback)(()=>{const Te=[];return I.forEach(Le=>Te.push(Le)),Te.push({shareId:R.wr.export,testId:F.exportAsJson,icon:"arrow",label:(0,b.t)("share-dashboard.menu.export-json-title","Export as JSON"),renderCondition:!0,onClick:()=>we(R.wr.export)}),Te.filter(Le=>Le.renderCondition)},[]),Fe=Te=>{B.c.sharingCategoryClicked({item:Te.shareId,shareResource:(0,R.hD)()}),Te.onClick(Qe)};return(0,t.jsx)(f.W,{"data-testid":F.container,children:$e().map(Te=>(0,t.jsx)(f.W.Item,{testId:Te.testId,label:Te.label,icon:Te.icon,description:Te.description,onClick:()=>Fe(Te)},Te.label))})}const A=i.Tp.pages.Dashboard.DashNav.NewExportButton;function N({dashboard:Qe}){const[we,$e]=(0,n.useState)(!1),Fe=(0,n.useCallback)(Le=>{$e(Le)},[]),Te=()=>(0,t.jsx)(W,{dashboard:Qe});return(0,t.jsx)(h.e,{"data-testid":A.container,children:(0,t.jsx)(m.m,{overlay:Te,placement:"bottom-end",onVisibleChange:Fe,children:(0,t.jsxs)(p.$n,{"data-testid":A.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,b.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,t.jsx)(b.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,t.jsx)(u.I,{name:we?"angle-up":"angle-down",size:"sm"})]})})})}var K=e(41053),V=e(61491),T=e(71488),z=e(23431);const w=i.Tp.pages.Dashboard.DashNav.newShareButton.menu;let H=[];function G(Qe){H.push(Qe)}function X(){H=[]}function k({dashboard:Qe,panel:we}){const $e=(0,c.of)(_),Fe=Ge=>{s.Ny.partial({shareView:Ge})},Te=(0,n.useCallback)(()=>{const Ge=[];return Ge.push({shareId:R.wr.link,testId:w.shareInternally,icon:"building",label:(0,b.t)("share-dashboard.menu.share-internally-title","Share internally"),renderCondition:!0,onClick:()=>Fe(R.wr.link)}),Ge.push({shareId:R.wr.publicDashboard,testId:w.shareExternally,icon:"share-alt",label:(0,b.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!we&&(0,T.iR)(),onClick:()=>{Fe(R.wr.publicDashboard)}}),Ge.push({shareId:R.wr.snapshot,testId:w.shareSnapshot,icon:"camera",label:(0,b.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:P.TP.isSignedIn&&x.$.snapshotEnabled&&P.TP.hasPermission(V.AccessControlAction.SnapshotsCreate),onClick:()=>{Fe(R.wr.snapshot)}}),H.forEach(Me=>Ge.push(Me)),Ge.push({shareId:R.wr.inviteUser,testId:w.inviteUser,icon:"add-user",label:(0,b.t)("share-dashboard.menu.invite-user-title","Invite new member"),renderCondition:!!x.$.externalUserMngLinkUrl&&P.TP.hasPermission(V.AccessControlAction.OrgUsersAdd),onClick:()=>{const Me=(0,z.o)("share-invite");window.open(Me.toString(),"_blank")},renderDividerAbove:!0,component:()=>(0,t.jsx)(u.I,{name:"external-link-alt",className:$e.inviteUserItemIcon}),className:$e.inviteUserItem}),Ge.filter(Me=>Me.renderCondition)},[we,$e]),Le=Ge=>{B.c.sharingCategoryClicked({item:Ge.shareId,shareResource:(0,R.hD)(we?.getRef())}),Ge.onClick(Qe)};return(0,t.jsx)(f.W,{"data-testid":w.container,children:Te().map(Ge=>(0,t.jsxs)(n.Fragment,{children:[Ge.renderDividerAbove&&(0,t.jsx)(f.W.Divider,{}),(0,t.jsx)(f.W.Item,{testId:Ge.testId,label:Ge.label,icon:Ge.icon,description:Ge.description,component:Ge.component,className:Ge.className,onClick:()=>Le(Ge)})]},Ge.shareId))})}const _=Qe=>({inviteUserItem:(0,r.css)({display:"flex",justifyContent:"start",flexDirection:"row",alignItems:"center"}),inviteUserItemIcon:(0,r.css)({color:Qe.colors.text.link})});var ee=e(75661);const J=i.Tp.pages.Dashboard.DashNav.newShareButton;function Z({dashboard:Qe,panel:we}){const $e=(0,c.of)(te),[Fe,Te]=(0,n.useState)(!1),[Le,Ge]=(0,K.A)(async()=>(B.c.toolbarShareClick(),await(0,ee.Xe)(Qe,we)),[Qe]),Me=(0,n.useCallback)(Ke=>{Ke&&B.c.toolbarShareDropdownClick(),Te(Ke)},[]),De=()=>(0,t.jsx)(k,{dashboard:Qe});return(0,t.jsxs)(h.e,{"data-testid":J.container,className:$e.container,children:[(0,t.jsx)(p.$n,{"data-testid":J.shareLink,size:"sm",tooltip:(0,b.t)("share-dashboard.share-button-tooltip","Copy link"),onClick:Ge,children:(0,t.jsx)(b.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,t.jsx)(m.m,{overlay:De,placement:"bottom-end",onVisibleChange:Me,children:(0,t.jsx)(p.$n,{"aria-label":"share-dropdown-menu","data-testid":J.arrowMenu,size:"sm",icon:Fe?"angle-up":"angle-down"})})]})}function te(Qe){return{container:(0,r.css)({gap:1})}}var ae=e(80328),re=e(2044),ne=e(84099),ce=e(65164),le=e(22492),he=e(91830);function oe(Qe){return(0,t.jsx)(d.I,{"data-testid":"button-snapshot",tooltip:(0,b.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>de(Qe.originalURL)},"button-snapshot")}const de=Qe=>{const we=Qe??"",$e=ne.sQ.sanitizeUrl(we);try{const Fe=new URL($e,x.$.appUrl),Te=new URL(x.$.appUrl);Fe.host!==Te.host?le.A.publish(new he.S8({component:ce.u,props:{title:"Proceed to external site?",modalClass:(0,r.css)({width:"max-content",maxWidth:"80vw"}),body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:we})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=Fe.href}}})):s.Ny.push($e)}catch(Fe){console.error("Failed to open original dashboard",Fe)}},me=(0,n.memo)(({dashboard:Qe})=>{const we=(0,n.useId)(),$e=(0,t.jsx)(Pe,{dashboard:Qe},we);return(0,t.jsx)(l.H,{actions:$e})});me.displayName="NavToolbarActions";function Pe({dashboard:Qe}){const{isEditing:we,showHiddenElements:$e,viewPanelScene:Fe,isDirty:Te,uid:Le,meta:Ge,editview:Me,editPanel:De,editable:Ke}=Qe.useState(),{isPlaying:Ie}=M._o.useState(),[Ne,ie]=(0,n.useState)(!1),ve=P.TP.hasEditPermissionInFolders,fe=[],ge=[],xe=(0,c.of)(Xe),je=!!De,Ve=!!Fe,ke=Se(De),Oe=De&&(0,re.ME)(De.state.panelRef.resolve()),nt=!Le,Je=a.M.exists(y.tH),Be=!Me&&!Ve&&!je,Ze=we&&Be,tt=x.$.featureToggles.scopeFilters&&!we,Re=x.$.featureToggles.dashboardNewLayouts;je||be(fe,ae.C.left,"left-actions"),fe.push({group:"icon-actions",condition:Le&&!!Ge.canStar&&Be&&!we,render:()=>{let It=Ge.isStarred?(0,b.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,b.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,t.jsx)(d.I,{tooltip:It,icon:(0,t.jsx)(u.I,{name:Ge.isStarred?"favorite":"star",size:"lg",type:Ge.isStarred?"mono":"default"}),"data-testid":i.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{B.c.toolbarFavoritesClick(),Qe.onStarDashboard()}},"star-dashboard-button")}}),Ge.publicDashboardEnabled&&fe.push({group:"icon-actions",condition:Le&&!!Ge.canStar&&Be&&!we,render:()=>(0,t.jsx)(g.E,{color:"blue",text:(0,b.t)("dashboard.toolbar.public-dashboard","Public"),className:xe.publicBadge,"data-testid":i.Tp.pages.Dashboard.DashNav.publicDashboardTag},"public-dashboard-button-badge")});const at=x.$.buildInfo.env==="development";fe.push({group:"icon-actions",condition:at&&Le&&Be&&!we,render:()=>(0,t.jsx)(d.I,{tooltip:(0,b.t)("dashboard.toolbar.switch-old-dashboard","Switch to old dashboard page"),icon:"apps",onClick:()=>{s.Ny.partial({scenes:!1})}},"view-in-old-dashboard-button")}),fe.push({group:"icon-actions",condition:Ge.isSnapshot&&!we,render:()=>(0,t.jsx)(oe,{originalURL:Qe.getSnapshotUrl()??""},"go-to-snapshot-origin")}),!je&&!we&&be(fe,ae.C.right,"icon-actions"),Re?ge.push({group:"hidden-elements",condition:Ze,render:()=>(0,t.jsxs)(o.c,{transparent:!0,className:xe.hiddenElementsContainer,children:[(0,t.jsx)(E.d,{value:$e,onChange:It=>{It.stopPropagation(),Qe.onToggleHiddenElements()},"data-testid":i.Tp.components.PageToolbar.itemButton("toggle_hidden_elements")}),(0,t.jsx)("span",{children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.show-hidden-elements",children:"Show hidden"})})]},"toggle-hidden-elements")}):fe.push({group:"add-panel",condition:Ze,render:()=>(0,t.jsx)(m.m,{onVisibleChange:It=>{ie(It),B.c.toolbarAddClick()},overlay:()=>(0,t.jsxs)(f.W,{children:[(0,t.jsx)(f.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,b.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const It=Qe.onCreateNewPanel();B.c.toolbarAddButtonClicked({item:"add_visualization"}),Qe.setState({editPanel:(0,L.L)(It,!0)})}},"add-visualization"),(0,t.jsx)(f.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,b.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{Qe.onShowAddLibraryPanelDrawer(),B.c.toolbarAddButtonClicked({item:"add_library_panel"})}},"add-panel-lib"),(0,t.jsx)(f.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,b.t)("dashboard.add-menu.row","Row"),onClick:()=>{Qe.onCreateNewRow(),B.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,t.jsx)(f.W.Item,{disabled:!Je,testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,b.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{Qe.pastePanel(),B.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,t.jsxs)(p.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":i.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(u.I,{name:Ne?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),fe.push({group:"playlist-actions",condition:Ie&&Be&&!we,render:()=>(0,t.jsx)(d.I,{"data-testid":i.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,b.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>M._o.prev()},"play-list-prev")}),fe.push({group:"playlist-actions",condition:Ie&&Be&&!we,render:()=>(0,t.jsx)(d.I,{onClick:()=>M._o.stop(),"data-testid":i.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),fe.push({group:"playlist-actions",condition:Ie&&Be&&!we,render:()=>(0,t.jsx)(d.I,{"data-testid":i.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,b.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>M._o.next(),narrow:!0},"play-list-next")}),fe.push({group:"back-button",condition:(Ve||je)&&!Oe,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{s.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":i.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.back-to-dashboard",children:"Back to dashboard"})},"back")}),fe.push({group:"back-button",condition:!!Me,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{s.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":i.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.back-to-dashboard",children:"Back to dashboard"})},"back")});const yt=Le&&!we&&!Ge.isSnapshot&&!Ie;fe.push({group:"main-buttons",condition:!x.$.featureToggles.newDashboardSharingComponent&&yt,render:()=>(0,t.jsx)(p.$n,{tooltip:(0,b.t)("dashboard.toolbar.share.tooltip","Share dashboard"),size:"sm",className:xe.buttonWithExtraMargin,fill:"outline",onClick:()=>{B.c.toolbarShareClick(),s.Ny.partial({shareView:R.wr.link})},"data-testid":i.Tp.components.NavToolbar.shareDashboard,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.share.label",children:"Share"})},"share-dashboard-button")}),fe.push({group:"main-buttons",condition:!we&&Qe.canEditDashboard()&&!Ve&&!Ie&&Ke,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{Qe.onEnterEditMode()},tooltip:(0,b.t)("dashboard.toolbar.edit.tooltip","Enter edit mode"),className:xe.buttonWithExtraMargin,variant:x.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":i.Tp.components.NavToolbar.editDashboard.editButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.edit.label",children:"Edit"})},"edit")}),fe.push({group:"main-buttons",condition:!we&&Qe.canEditDashboard()&&!Ve&&!Ie&&!Ke,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{Qe.onEnterEditMode(),Qe.setState({editable:!0,meta:{...Ge,canEdit:!0}})},tooltip:(0,b.t)("dashboard.toolbar.enter-edit-mode.tooltip","This dashboard was marked as read only"),className:xe.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":i.Tp.components.NavToolbar.editDashboard.editButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.enter-edit-mode.label",children:"Make editable"})},"edit")}),fe.push({group:"new-share-dashboard-buttons",condition:x.$.featureToggles.newDashboardSharingComponent&&yt,render:()=>(0,t.jsx)(N,{dashboard:Qe},"new-export-dashboard-button")}),fe.push({group:"new-share-dashboard-buttons",condition:x.$.featureToggles.newDashboardSharingComponent&&yt,render:()=>(0,t.jsx)(Z,{dashboard:Qe},"new-share-dashboard-button")}),fe.push({group:"settings",condition:we&&Qe.canEditDashboard()&&Be,render:()=>(0,t.jsx)(p.$n,{onClick:()=>{Qe.onOpenSettings()},tooltip:(0,b.t)("dashboard.toolbar.dashboard-settings.tooltip","Dashboard settings"),fill:"text",size:"sm",variant:"secondary","data-testid":i.Tp.components.NavToolbar.editDashboard.settingsButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.dashboard-settings.label",children:"Settings"})},"settings")}),fe.push({group:"main-buttons",condition:we&&!nt&&Be,render:()=>(0,t.jsx)(p.$n,{onClick:()=>Qe.exitEditMode({skipConfirm:!1}),tooltip:(0,b.t)("dashboard.toolbar.exit-edit-mode.tooltip","Exits edit mode and discards unsaved changes"),size:"sm",fill:"text",variant:"primary","data-testid":i.Tp.components.NavToolbar.editDashboard.exitButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.exit-edit-mode.label",children:"Exit edit"})},"discard")}),fe.push({group:"main-buttons",condition:je&&!Oe&&!Me&&!Ve,render:()=>(0,t.jsx)(p.$n,{onClick:De?.onDiscard,tooltip:De?.state.isNewPanel?(0,b.t)("dashboard.toolbar.discard-panel-new","Discard panel"):(0,b.t)("dashboard.toolbar.discard-panel","Discard panel changes"),size:"sm",disabled:!ke,fill:"outline",variant:"destructive","data-testid":i.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:De?.state.isNewPanel?(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.discard-panel-new",children:"Discard panel"}):(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.discard-panel",children:"Discard panel changes"})},"discard")}),fe.push({group:"main-buttons",condition:je&&Oe&&!Me&&!Ve,render:()=>(0,t.jsx)(p.$n,{onClick:De?.onDiscard,tooltip:(0,b.t)("dashboard.toolbar.discard-library-panel-changes","Discard library panel changes"),size:"sm",fill:"outline",variant:"destructive","data-testid":i.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.discard-library-panel-changes",children:"Discard library panel changes"})},"discardLibraryPanel")}),fe.push({group:"main-buttons",condition:je&&Oe&&!Me&&!Ve,render:()=>(0,t.jsx)(p.$n,{onClick:De?.onUnlinkLibraryPanel,tooltip:(0,b.t)("dashboard.toolbar.unlink-library-panel","Unlink library panel"),size:"sm",fill:"outline",variant:"secondary","data-testid":i.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.unlink-library-panel",children:"Unlink library panel"})},"unlinkLibraryPanel")}),fe.push({group:"main-buttons",condition:je&&Oe&&!Me&&!Ve,render:()=>(0,t.jsx)(p.$n,{onClick:De?.onSaveLibraryPanel,tooltip:(0,b.t)("dashboard.toolbar.save-library-panel","Save library panel"),size:"sm",fill:"outline",variant:"primary","data-testid":i.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.save-library-panel",children:"Save library panel"})},"saveLibraryPanel")}),fe.push({group:"main-buttons",condition:we&&!Oe&&(Ge.canSave||ve),render:()=>{if(nt)return(0,t.jsx)(p.$n,{onClick:()=>{Qe.openSaveDrawer({})},className:xe.buttonWithExtraMargin,tooltip:(0,b.t)("dashboard.toolbar.save-dashboard.tooltip","Save changes"),size:"sm",variant:"primary","data-testid":i.Tp.components.NavToolbar.editDashboard.saveButton,children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.save-dashboard.label",children:"Save dashboard"})},"save");if(ve&&!Ge.canSave&&!Ge.canMakeEditable)return(0,t.jsx)(p.$n,{onClick:()=>{Qe.openSaveDrawer({saveAsCopy:!0})},className:xe.buttonWithExtraMargin,tooltip:(0,b.t)("dashboard.toolbar.save-dashboard-copy.tooltip","Save as copy"),size:"sm",variant:Te?"primary":"secondary",children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.save-dashboard-copy.label",children:"Save as copy"})},"save");const It=(0,t.jsxs)(f.W,{children:[(0,t.jsx)(f.W.Item,{label:(0,b.t)("dashboard.toolbar.save-dashboard-short","Save"),icon:"save",onClick:()=>{Qe.openSaveDrawer({})}}),(0,t.jsx)(f.W.Item,{label:(0,b.t)("dashboard.toolbar.save-dashboard-copy.label","Save as copy"),icon:"copy",onClick:()=>{Qe.openSaveDrawer({saveAsCopy:!0})}})]});return(0,t.jsxs)(h.e,{className:xe.buttonWithExtraMargin,children:[(0,t.jsx)(p.$n,{onClick:()=>{Qe.openSaveDrawer({})},tooltip:(0,b.t)("dashboard.toolbar.save-dashboard.tooltip","Save changes"),size:"sm","data-testid":i.Tp.components.NavToolbar.editDashboard.saveButton,variant:Te?"primary":"secondary",children:(0,t.jsx)(b.x6,{i18nKey:"dashboard.toolbar.save-dashboard.label",children:"Save dashboard"})}),(0,t.jsx)(m.m,{overlay:It,children:(0,t.jsx)(p.$n,{"aria-label":(0,b.t)("dashboard.toolbar.more-save-options","More save options"),icon:"angle-down",variant:Te?"primary":"secondary",size:"sm"})})]},"save")}}),fe.push({group:"main-buttons",condition:Le&&x.$.featureToggles.useV2DashboardsAPI,render:()=>(0,t.jsx)(d.I,{tooltip:(0,b.t)("dashboard.toolbar.edit-dashboard-v2-schema","Edit dashboard v2 schema"),icon:(0,t.jsx)(u.I,{name:"brackets-curly",size:"lg",type:"default"}),onClick:()=>{Qe.openV2SchemaEditor()}},"schema-v2-button")});const ze=Ee(fe),st=Ee(ge),ht=tt||st.length>0;return(0,t.jsxs)(D.B,{flex:1,minWidth:0,justifyContent:ht?"space-between":"flex-end",children:[tt&&(0,t.jsx)(O.Dh,{}),st.length>0&&(0,t.jsx)(C.U,{alignment:"left",children:st}),(0,t.jsx)(C.U,{alignment:"right",children:ze})]})}function Ee(Qe){const we=[];let $e="";for(const Fe of Qe)Fe.condition&&($e&&$e!==Fe.group&&$e&&we.push((0,t.jsx)(v.K,{},`${Fe.group}-separator`)),we.push(Fe.render()),$e=Fe.group);return we}function be(Qe,we,$e){if(we.length>0)for(const Fe of we){const Te={dashboard:(0,S.UA)().getCurrent()};if(Fe.show(Te)){const Le=Fe.component;Qe.push({group:$e,condition:!0,render:()=>(0,n.createElement)(Le,{...Te,key:Qe.length})})}}}function Se(Qe){const[we,$e]=(0,n.useState)();return(0,n.useEffect)(()=>{if(Qe){const Fe=Qe.subscribeToState(Te=>{Te.isDirty!==we&&$e(Te.isDirty)});return()=>Fe.unsubscribe()}},[Qe,we]),we}function Xe(Qe){return{hiddenElementsContainer:(0,r.css)({display:"flex",padding:0,gap:Qe.spacing(1),whiteSpace:"nowrap"}),buttonWithExtraMargin:(0,r.css)({margin:Qe.spacing(0,.5)}),publicBadge:(0,r.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},3987:(q,j,e)=>{"use strict";e.d(j,{$:()=>d,m:()=>g});var t=e(74848),n=e(61034),r=e(96325),a=e(79784),i=e(60232),x=e(52120),s=e(19224),c=e(66110);class d extends n.Bs{constructor(){super(...arguments),this._variableDependency=new n.Sh(this,{onAnyVariableChanged:()=>{this.state.rawLinks&&this.state.rawLinks.length>0&&this.forceRender()}})}static{this.Component=u}}function u({model:E}){const{menu:m,rawLinks:f}=E.useState();if(n.jh.getTimeRange(E).useState(),!(E.parent instanceof n.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!f||f.length===0)return null;if(f.length===1){const p=(0,c.eQ)(E.parent)[0];return(0,t.jsx)(r.NR.TitleItem,{href:p.href,onClick:p.onClick,target:p.target,title:p.title,children:(0,t.jsx)(a.I,{name:"external-link-alt",size:"md"})})}return(0,t.jsx)(i.m,{overlay:()=>(0,t.jsx)(m.Component,{model:m},m.state.key),children:(0,t.jsx)(x.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"})})}class g extends n.Bs{static{this.Component=o}}function o({model:E}){const{links:m}=E.useState();return m?(0,t.jsx)(s.W,{children:m?.map((f,p)=>(0,t.jsx)(s.W.Item,{label:f.title,url:f.href,target:f.target,onClick:f.onClick},p))}):null}},66110:(q,j,e)=>{"use strict";e.d(j,{eQ:()=>Qe,MI:()=>$e,oV:()=>Xe,_i:()=>Ee,vR:()=>Te});var t=e(93253),n=e(35023),r=e(93407),a=e(32370),i=e(58820),x=e(53027),s=e(61034),c=e(22492),d=e(17687),u=e(11817),g=e(80847),o=e(61351),E=e(44608),m=e(96621),f=e(82096),p=e(25309),h=e(76530),D=e(90143),C=e(32056),l=e(98437),v=e(2044),y=e(75637),P=e(73750),b=e(74848),S=e(55522);class M extends s.Bs{static{this.Component=O}constructor(De){super(De),this.trail=R(De)}}function O({model:Me}){return(0,b.jsx)(Me.trail.Component,{model:Me.trail})}function R({metric:Me,filters:De,dataSourceUid:Ke,timeRangeState:Ie}){return new S.b({$timeRange:new s.JZ(Ie),metric:Me,initialDS:Ke,initialFilters:De,embedded:!0})}var L=e(22803),B=e(29675),F=e(58528),I=e(91830);function U(Me){const{scene:De,title:Ke,onDismiss:Ie}=Me,Ne=(0,B.of)(N);return(0,b.jsx)(F._,{title:Ke,onClose:Ie,size:"lg",children:(0,b.jsx)("div",{className:Ne.drawerInnerWrapper,children:(0,b.jsx)(De.Component,{model:De})})})}class W extends s.Bs{constructor(De){super(De)}static Component({model:De}){const Ke=De.useState();return(0,b.jsx)(U,{...Ke})}}function A(Me){const De={component:U,props:Me};appEvents.publish(new ShowModalReactEvent(De))}function N(Me){return{drawerInnerWrapper:(0,L.css)({display:"flex",padding:Me.spacing(2),background:Me.isDark?Me.colors.background.canvas:Me.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var K=e(11222);function V(Me){return Me.op==="="}function T(Me){return Me.state.$timeRange.state}function z({metric:Me,labelFilters:De}){if(De.length===0)return Me;const Ke=`{${De.map(({label:Ie,op:Ne,value:ie})=>`${Ie}${Ne}"${ie}"`)}}`;return`${Me}${Ke}`}function w(Me){return Me?.map(De=>({key:De.label,value:De.value,operator:De.op}))}function H(Me){const De=[];return Me.forEach(Ke=>{const Ie=(0,K.u)(Ke);if(Ie.errors.length>0)return;const{metric:Ne,labels:ie}=Ie.query;De.push({metric:Ne,labelFilters:ie.filter(V),query:Ke}),Ie.query.binaryQueries?.forEach(({query:{metric:ve,labels:fe}})=>{De.push({metric:ve,labelFilters:fe.filter(V),query:Ke})})}),De}async function G(Me,De,Ke){if(De.state.pluginId!=="timeseries")return;const Ie=(0,v.un)(De);if(Ie==null)return;const{queries:Ne,datasource:ie,data:ve}=Ie.state;if(ie==null||ie.type!=="prometheus")return;let fe;try{fe=await(0,l.l)().get(ie)}catch{return}if(fe.interpolateVariablesInQueries==null)return;const ge=fe.interpolateVariablesInQueries(Ne,{__sceneObject:{value:De}},ve?.request?.filters).filter(J),je=H(ge.map(Ve=>Ve.expr)).map(Ve=>({text:z(Ve),onClick:ee(Ve,Me,fe)}));je.length>0&&Ke.push({text:"Metrics drilldown",iconClassName:"code-branch",subMenu:X(je)})}function X(Me){const De=new Set;function Ke({text:Ie}){const Ne=De.size;return De.add(Ie),De.size>Ne}return Me.filter(Ke)}function k({metric:Me,labelFilters:De,query:Ke},Ie,Ne){return{metric:Me,filters:w(De),dataSourceUid:Ne,timeRangeState:Ie}}function _(Me,De,Ke){const Ie=T(De),Ne=k(Me,Ie,Ke.uid),ie=new M(Ne);return ie.trail.addActivationHandler(()=>{ie.trail.state.topScene instanceof y.R&&ie.trail.state.topScene.setActionView("breakdown")}),{scene:ie,title:"Metrics drilldown"}}function ee(Me,De,Ke){return()=>{const Ie=_(Me,De,Ke),Ne=new W({...Ie,onDismiss:()=>De.closeModal()});(0,P.z)("exploration_started",{cause:"dashboard_panel"}),De.showModal(Ne)}}function J(Me){return"expr"in Me}var Z=e(83394),te=e(61491),ae=e(60712),re=e(19580),ne=e(9964),ce=e(83424),le=e(19892),he=e(11997),oe=e(3987),de=e(46888);class me extends s.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,v.YQ)(this).closeModal()},this.onConfirm=()=>{const De=(0,v.YQ)(this);De.unlinkLibraryPanel(this.state.panelRef.resolve()),De.closeModal()}}static{this.Component=Pe}}function Pe({model:Me}){return(0,b.jsx)(de.l,{isOpen:!0,onConfirm:()=>{Me.onConfirm(),Me.onDismiss()},onDismiss:Me.onDismiss})}function Ee(Me){(async()=>{const Ke=Me.parent,Ie=Ke.getPlugin(),Ne=[],ie=[],ve=(0,v.YQ)(Ke),{isEmbedded:fe}=ve.state.meta,ge=await be(Ke),xe=(0,ne.uc)(Ke.state.key);if(fe){ge&&Me.setState({items:[ge]});return}const je=!!ve.state.editPanel;if(je||Ne.push({text:(0,u.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,le.r7)(Ke)}),ve.canEditDashboard()&&ve.state.editable&&!xe&&!je&&Ne.push({text:(0,u.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,le.e0)((0,v.Cs)(Ke))}),a.$.featureToggles.newDashboardSharingComponent){const Oe=[];Oe.push({text:(0,u.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{ce.c.sharingCategoryClicked({item:p.wr.link,shareResource:(0,p.hD)(Ke?.getRef())});const nt=new ae.j({shareView:p.wr.link,panelRef:Ke.getRef()});ve.showModal(nt)}}),Oe.push({text:(0,u.t)("share-panel.menu.share-embed-title","Share embed"),iconClassName:"arrow",shortcut:"p e",onClick:()=>{ce.c.sharingCategoryClicked({item:p.wr.embed,shareResource:(0,p.hD)(Ke.getRef())});const nt=new ae.j({shareView:p.wr.embed,panelRef:Ke.getRef()});ve.showModal(nt)}}),o.TP.isSignedIn&&a.$.snapshotEnabled&&o.TP.hasPermission(te.AccessControlAction.SnapshotsCreate)&&Oe.push({text:(0,u.t)("share-panel.menu.share-snapshot-title","Share snapshot"),iconClassName:"camera",shortcut:"p s",onClick:()=>{ce.c.sharingCategoryClicked({item:p.wr.snapshot,shareResource:(0,p.hD)(Ke.getRef())});const nt=new ae.j({shareView:p.wr.snapshot,panelRef:Ke.getRef()});ve.showModal(nt)}}),Ne.push({type:"submenu",text:(0,u.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:Oe,onClick:nt=>{nt.preventDefault()}})}else Ne.push({text:(0,u.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{ve.showModal(new re.Z({panelRef:Ke.getRef()}))},shortcut:"p s"});ve.state.isEditing&&!xe&&!je&&ie.push({text:(0,u.t)("panel.header-menu.duplicate","Duplicate"),iconClassName:"file-copy-alt",onClick:()=>{ve.duplicatePanel(Ke)},shortcut:"p d"}),je||ie.push({text:(0,u.t)("panel.header-menu.copy","Copy"),iconClassName:"copy",onClick:()=>{ve.copyPanel(Ke)}}),ve.state.isEditing&&!xe&&!je&&((0,v.ME)(Ke)?(ie.push({text:(0,u.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),iconClassName:"link-broken",onClick:()=>{ve.showModal(new me({panelRef:Ke.getRef()}))}}),ie.push({text:(0,u.t)("panel.header-menu.replace-library-panel","Replace library panel"),iconClassName:"library-panel",onClick:()=>{ve.onShowAddLibraryPanelDrawer(Ke.getRef())}})):a.$.featureToggles.newDashboardSharingComponent?ie.push({text:(0,u.t)("share-panel.menu.new-library-panel-title","New library panel"),iconClassName:"plus-square",onClick:()=>{const Oe=new ae.j({shareView:p.wr.libraryPanel,panelRef:Ke.getRef()});ve.showModal(Oe)}}):ie.push({text:(0,u.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{ve.showModal(new re.Z({panelRef:Ke.getRef(),activeTab:p.wr.libraryPanel}))}})),(0,m.q0)()&&ie.push({text:(0,u.t)("panel.header-menu.new-alert-rule","New alert rule"),iconClassName:"bell",onClick:Oe=>Fe(Ke)}),Le(Ke.state.options)&&!je&&ie.push({text:Ke.state.options.legend.showLegend?(0,u.t)("panel.header-menu.hide-legend","Hide legend"):(0,u.t)("panel.header-menu.show-legend","Show legend"),iconClassName:Ke.state.options.legend.showLegend?"legend-hide":"legend-show",onClick:Oe=>{Oe.preventDefault(),Te(Ke)},shortcut:"p l"}),ve.canEditDashboard()&&Ie&&!Ie.meta.skipDataQuery&&!xe&&ie.push({text:(0,u.t)("panel.header-menu.get-help","Get help"),iconClassName:"question-circle",onClick:Oe=>{Oe.preventDefault(),Ge(Ke,h.q.Help)}}),a.$.featureToggles.exploreMetrics&&await G(ve,Ke,Ne),ge&&Ne.push(ge),Ne.push(Se(Ie,Ke,ve));const{extensions:ke}=(0,i.Kf)({extensionPointId:t.S.DashboardPanelMenu,context:we(Ke,ve),limitPerPlugin:3});ke.length>0&&!ve.state.isEditing&&Ne.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,C.N9)(ke)}),ie.length&&Ne.push({type:"submenu",text:(0,u.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:ie,onClick:Oe=>{Oe.preventDefault()}}),ve.state.isEditing&&!xe&&!je&&(Ne.push({text:"",type:"divider"}),Ne.push({text:(0,u.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{$e(ve,Ke)},shortcut:"p r"})),Me.setState({items:Ne})})()}async function be(Me){const De=await(0,le.Lp)(Me);if(De)return{text:(0,u.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:De}}function Se(Me,De,Ke){const Ie=[];return Me&&!Me.meta.skipDataQuery&&(Ie.push({text:(0,u.t)("panel.header-menu.inspect-data","Data"),href:(0,le.Uu)(De,h.q.Data),onClick:Ne=>{Ne.preventDefault(),x.Ny.partial({inspect:De.state.key,inspectTab:h.q.Data})}}),Ke instanceof he.H$&&Ke.state.meta.canEdit&&Ie.push({text:(0,u.t)("panel.header-menu.query","Query"),href:(0,le.Uu)(De,h.q.Query),onClick:Ne=>{Ne.preventDefault(),x.Ny.partial({inspect:De.state.key,inspectTab:h.q.Query})}})),Ie.push({text:(0,u.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,le.Uu)(De,h.q.JSON),onClick:Ne=>{Ne.preventDefault(),x.Ny.partial({inspect:De.state.key,inspectTab:h.q.JSON})}}),{text:(0,u.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,le.Uu)(De),onClick:Ne=>{Ne.isDefaultPrevented()||x.Ny.partial({inspect:De.state.key,inspectTab:h.q.Data})},subMenu:Ie.length>0?Ie:void 0}}function Xe(Me){if(!(Me.parent instanceof oe.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const De=Me.parent.parent;if(!(De instanceof s.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");Me.setState({links:Qe(De)})}function Qe(Me){const De=(Ne,ie)=>s.jh.interpolate(Me,Ne,ie),Ke=(0,D.CH)(Me,De);if(!Ke)return[];const Ie=Ke.getLinks(De);return Ie.map(Ne=>({...Ne,onClick:(ve,fe)=>{ce.c.panelLinkClicked({has_multiple_links:Ie.length>1}),Ne.onClick?.(ve,fe)}}))}function we(Me,De){const Ke=s.jh.getTimeRange(Me);let Ie=(0,v.un)(Me);const Ne=Ie?.state.queries,ie=(0,v.Cs)(Me);let ve={};if(Me.state.$variables&&Me.state.$variables.state.variables.forEach(fe=>{fe instanceof s.xc&&(ve={...ve,[fe.state.name]:{value:fe.getValue(),text:fe.getValueText()}})}),Me.parent?.parent instanceof s.tI){const fe=Me.parent.parent;fe.state.$variables&&fe.state.$variables.state.variables.forEach(ge=>{ge instanceof s.xc&&(ve={...ve,[ge.state.name]:{value:ge.getValue(),text:ge.getValueText()}})})}return{id:ie,pluginId:Me.state.pluginId,title:Me.state.title,timeRange:Ke.state.value.raw,timeZone:(0,n.O)({timeZone:Ke.getTimeZone()}),dashboard:{uid:De.state.uid,title:De.state.title,tags:De.state.tags||[]},targets:Ne,scopedVars:ve,data:Ie?.state.data}}function $e(Me,De){c.A.publish(new I.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>Me.removePanel(De)}))}const Fe=async Me=>{try{const De=await(0,f.J6)(Me),Ke=r.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(De),returnTo:location.pathname+location.search});x.Ny.push(Ke)}catch(De){const Ke=`Error getting rule values from the panel: ${(0,E.q6)(De)}`;(0,Z.JD)((0,g.dx)((0,d.gi)(Ke)));return}};function Te(Me){const De=Me.state.options;Le(De)&&typeof De.legend.showLegend=="boolean"&&Me.onOptionsChange({legend:{showLegend:!De.legend.showLegend}})}function Le(Me){return Me!=null&&typeof Me=="object"&&"legend"in Me}const Ge=(Me,De)=>{x.Ny.partial({inspect:Me.state.key,inspectTab:De})}},86359:(q,j,e)=>{"use strict";e.d(j,{W:()=>i});var t=e(74848),n=e(61034),r=e(31047),a=e(2044);class i extends n.Bs{constructor(){super({}),this.onActivate=()=>{const c=this.parent;if(!c||!(c instanceof n.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=x}getPanel(){const c=this.parent;return c&&c instanceof n.Eb?c:null}}function x({model:s}){const c=s.getPanel(),u=n.jh.getData(s).useState();if(!c)return null;const g=(0,a.Cs)(c);return u.data?.series?(0,t.jsx)(r.Z,{frames:u.data?.series,panelId:g}):null}},36054:(q,j,e)=>{"use strict";e.d(j,{v:()=>o});var t=e(74848),n=e(22803),r=e(55801),a=e(59577),i=e(30468),x=e(61034),s=e(29675),c=e(6736),d=e(78968),u=e(96325),g=e(79784);class o extends x.XQ{constructor(p={}){super({...p,from:"now-6h",to:"now",value:(0,r.E2)()}),this._variableDependency=new x.Sh(this,{statePaths:["timeFrom","timeShift"]}),this.addActivationHandler(()=>this._onActivate())}static{this.Component=E}_onActivate(){this._subs.add(this.subscribeToState(h=>{const{timeInfo:D,timeRange:C}=this.getTimeOverride(this.getAncestorTimeRange().state.value);h.timeInfo!==D&&this.setState({timeInfo:D,value:C})}));const{timeRange:p}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({value:p,from:p.raw.from.toString(),to:p.raw.to.toString()})}ancestorTimeRangeChanged(p){const h=this.getTimeOverride(p.value);this.setState({value:h.timeRange,timeInfo:h.timeInfo})}getTimeOverride(p){const{timeFrom:h,timeShift:D}=this.state,C={timeInfo:"",timeRange:p};if(h){const l=x.jh.interpolate(this,this.state.timeFrom),v=a.describeTextRange(l);if(v.invalid)return C.timeInfo="invalid time override",C;if(a.isRelativeTimeRange(p.raw)){const y=this.getTimeZone();C.timeInfo=v.display,C.timeRange={from:i.parse(v.from,void 0,y),to:i.parse(v.to,void 0,y),raw:{from:v.from,to:v.to}}}}if(D){const l=x.jh.interpolate(this,this.state.timeShift);if(a.describeTextRange(l).invalid)return C.timeInfo="invalid timeshift",C;const y="-"+l;C.timeInfo+=" timeshift "+y;const P=i.parseDateMath(y,C.timeRange.from,!1),b=i.parseDateMath(y,C.timeRange.to,!0);C.timeRange={from:P,to:b,raw:{from:P,to:b}}}return C}}function E({model:f}){const{timeInfo:p,hideTimeOverride:h}=f.useState(),D=(0,s.of)(m);return!p||h?null:(0,t.jsx)(c.m,{content:(0,t.jsx)(d.xS,{timeRange:f.state.value,timeZone:f.getTimeZone()}),children:(0,t.jsxs)(u.NR.TitleItem,{className:D.timeshift,children:[(0,t.jsx)(g.I,{name:"clock-nine",size:"sm"})," ",p]})})}const m=f=>({timeshift:(0,n.css)({color:f.colors.text.link,gap:f.spacing(.5),whiteSpace:"nowrap"})})},46888:(q,j,e)=>{"use strict";e.d(j,{l:()=>r});var t=e(74848),n=e(65164);const r=({isOpen:a,onConfirm:i,onDismiss:x})=>(0,t.jsx)(n.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{i(),x()},onDismiss:x,isOpen:a})},15407:(q,j,e)=>{"use strict";e.d(j,{$L:()=>o,Tr:()=>p,Wu:()=>f});var t=e(74848),n=e(22803),r=e(32370),a=e(61034),i=e(29675),x=e(6736),s=e(96325),c=e(79784),d=e(63845),u=e(54414),g=e(2044);class o extends a.Bs{constructor(){super({}),this.onActivate=()=>{const l=this.parent;if(!l||!(l instanceof a.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=E}getPanel(){const l=this.parent;return l&&l instanceof a.Eb?l:null}}function E({model:C}){const l=C.getPanel(),v=(0,i.of)(D);if(!l)return null;if(h(l)){const b=`This ${m(p(l),f(l))} requires Angular (deprecated).`;return(0,t.jsx)(x.m,{content:b,children:(0,t.jsx)(s.NR.TitleItem,{className:v.angularNotice,"data-testid":"angular-deprecation-icon",children:(0,t.jsx)(c.I,{name:"exclamation-triangle",size:"md"})})})}return null}function m(C,l){return l?"panel":C?"data source":"panel or data source"}function f(C){return(r.$.panels[C.state.pluginId]?.angular?.detected||d.vI.includes(C.state.pluginId))&&!r.$.panels[C.state.pluginId]?.angular?.hideDeprecation}function p(C){const v=(0,g.un)(C)?.state.datasource;return v?.uid?(0,u.Hv)(v?.uid):!1}function h(C){return(r.$.featureToggles.angularDeprecationUI??!1)&&(p(C)||f(C))}function D(C){return{angularNotice:(0,n.css)({color:C.colors.warning.text})}}},60101:(q,j,e)=>{"use strict";e.d(j,{U:()=>S});var t=e(2543),n=e(61034),r=e(40828),a=e(9964),i=e(2044),x=e(93300),s=e(74848),c=e(60641),d=e(44826),u=e(11817),g=e(12422),o=e(12600),E=e(66732);function m(M){const O=new g.C({title:(0,u.t)("dashboard.default-layout.item-options.repeat.title","Repeat options"),id:"Repeat options",isOpenDefault:!1});return O.addItem(new o.v({title:(0,u.t)("dashboard.default-layout.item-options.repeat.variable.title","Repeat by variable"),description:(0,u.t)("dashboard.default-layout.item-options.repeat.variable.description","Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard."),render:()=>(0,s.jsx)(h,{gridItem:M})})),O.addItem(new o.v({title:(0,u.t)("dashboard.default-layout.item-options.repeat.direction.title","Repeat direction"),useShowIf:()=>{const{variableName:R}=M.useState();return!!R},render:()=>(0,s.jsx)(f,{gridItem:M})})),O.addItem(new o.v({title:(0,u.t)("dashboard.default-layout.item-options.repeat.max","Max per row"),useShowIf:()=>{const{variableName:R,repeatDirection:L}=M.useState();return!!R&&L==="h"},render:()=>(0,s.jsx)(p,{gridItem:M})})),O}function f({gridItem:M}){const{repeatDirection:O}=M.useState(),R=[{label:(0,u.t)("dashboard.default-layout.item-options.repeat.direction.horizontal","Horizontal"),value:"h"},{label:(0,u.t)("dashboard.default-layout.item-options.repeat.direction.vertical","Vertical"),value:"v"}];return(0,s.jsx)(c.z,{options:R,value:O??"h",onChange:L=>M.setRepeatDirection(L)})}function p({gridItem:M}){const{maxPerRow:O}=M.useState(),R=[2,3,4,6,8,12].map(L=>({label:L.toString(),value:L}));return(0,s.jsx)(d.l6,{options:R,value:O??4,onChange:L=>M.setMaxPerRow(L.value)})}function h({gridItem:M}){const{variableName:O}=M.useState();return(0,s.jsx)(E.U,{id:"repeat-by-variable-select",sceneContext:M,repeat:O,onChange:R=>M.setRepeatByVariable(R)})}var D=e(22803),C=e(96540),l=e(32370);function v({model:M}){const{repeatedPanels:O,itemHeight:R,variableName:L,body:B}=M.useState(),F=O?.length??0,I=y(M.getRepeatDirection(),F,M.getMaxPerRow(),R??10);return!L&&B instanceof n.Eb?(0,s.jsx)(B.Component,{model:B},B.state.key):O?(0,s.jsx)("div",{className:I,children:O.map(U=>(0,s.jsx)("div",{className:P,children:(0,s.jsx)(U.Component,{model:U},U.state.key)},U.state.key))}):null}function y(M,O,R,L){return(0,C.useMemo)(()=>{const B=l.$.theme2,F=L*r.sD*O+(O-1)*r.dU;if(M==="h"){const I=Math.ceil(O/R),U=Math.min(O,R);return(0,D.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${U}, 1fr)`,gridTemplateRows:`repeat(${I}, 1fr)`,gridColumnGap:B.spacing(1),gridRowGap:B.spacing(1),[B.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:F}})}return(0,D.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:B.spacing(1),[B.breakpoints.down("md")]:{height:F}})},[M,O,R,L])}const P=(0,D.css)({display:"flex",flexGrow:1,position:"relative"});class b{constructor(O){this._gridItem=O}getNames(){return this._gridItem.state.variableName?new Set([this._gridItem.state.variableName]):new Set}hasDependencyOn(O){return this._gridItem.state.variableName===O}variableUpdateCompleted(O){this._gridItem.state.variableName===O.state.name&&this._gridItem.performRepeat()}}class S extends n.Bs{constructor(O){super(O),this._variableDependency=new b(this),this.isDashboardLayoutItem=!0,this.addActivationHandler(()=>this._activationHandler())}static{this.Component=v}_activationHandler(){this.state.variableName&&(this._subs.add(this.subscribeToState((O,R)=>this._handleGridResize(O,R))),this.performRepeat())}_handleGridResize(O,R){const L=this.state.repeatedPanels?.length??1,B={};if(O.height!==R.height){if(this.getRepeatDirection()==="v")B.itemHeight=Math.ceil(O.height/L);else{const F=Math.ceil(L/this.getMaxPerRow());B.itemHeight=Math.ceil(O.height/F)}B.itemHeight!==this.state.itemHeight&&this.setState(B)}}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}getOptions(){return m(this)}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??!1)&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(O){O&&(this._prevRepeatValues=void 0),this.state.variableName&&this.state.repeatDirection==="h"&&this.state.width!==r.cV&&this.setState({width:r.cV})}performRepeat(){if(!this.state.variableName||n.jh.hasVariableDependencyInLoadingState(this))return;const O=n.jh.lookupVariable(this.state.variableName,this)??new n.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(O instanceof n.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:R,texts:L}=(0,i.a7)(O);if((0,t.isEqual)(this._prevRepeatValues,R))return;const B=this.state.body,F=[],I={values:[""],texts:O.hasAllValue()?["All"]:["None"]},U=R.length?R:I.values,W=L.length?L:I.texts;for(let z=0;z<U.length;z++){const w={$variables:new n.Pj({variables:[new n.xc({name:O.state.name,value:U[z],text:String(W[z])})]}),key:(0,a.lv)(B.state.key,z)},H=B.clone(w);F.push(H)}const A=this.getRepeatDirection(),N={repeatedPanels:F},K=this.state.itemHeight??10,V=this.state.height,T=this.getMaxPerRow();if(A==="h"){const z=Math.ceil(F.length/T);N.height=z*K}else N.height=F.length*K;if(this.setState(N),V!==this.state.height){const z=n.jh.getLayout(this);z instanceof n.hy&&z.forceRender()}this._prevRepeatValues=R,this.publishEvent(new x.d({source:this}),!0)}setRepeatByVariable(O){const R={variableName:O};O&&!this.state.repeatDirection&&(R.repeatDirection="h"),this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this.setState(R)}getMaxPerRow(){return this.state.maxPerRow??4}setMaxPerRow(O){this.setState({maxPerRow:O})}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}setRepeatDirection(O){this.setState({repeatDirection:O})}isRepeated(){return this.state.variableName!==void 0}}},63831:(q,j,e)=>{"use strict";e.d(j,{D:()=>m});var t=e(74848),n=e(32370),r=e(61034),a=e(40828),i=e(11817),x=e(29998),s=e(9964),c=e(18745),d=e(2044),u=e(8822),g=e(60101),o=e(3865),E=e(68643);class m extends r.Bs{constructor(){super(...arguments),this.isDashboardLayoutManager=!0,this.descriptor=m.descriptor}static{this.Component=f}static{this.descriptor={get name(){return(0,i.t)("dashboard.default-layout.name","Default grid")},get description(){return(0,i.t)("dashboard.default-layout.description","The default grid layout")},id:"default-grid",createFromLayout:m.createFromLayout,kind:"GridLayout"}}addPanel(h){const D=c.b4.getNextPanelId(this);h.setState({key:(0,d.XA)(D)}),h.clearParent();const C=new g.U({height:d.sw,width:d.vm,x:0,y:0,body:h,key:(0,d.ty)(D)});this.state.grid.setState({children:[C,...this.state.grid.state.children]})}removePanel(h){const D=h.parent;if(!(D instanceof g.U))throw new Error("Trying to remove panel that is not inside a DashboardGridItem");const C=this.state.grid;let l;try{l=r.jh.getAncestor(D,r.tI)}catch{l=void 0}if(l){l.setState({children:l.state.children.filter(v=>v!==D)}),C.forceRender();return}this.state.grid.setState({children:C.state.children.filter(v=>v!==D)})}duplicatePanel(h){const D=h.parent;if(!(D instanceof g.U)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}let C,l,v;const y=c.b4.getNextPanelId(this),P=this.state.grid;if(D instanceof g.U?(C=r.Go.cloneSceneObjectState(D.state.body.state),l=r.jh.getData(D.state.body).clone()):(C=r.Go.cloneSceneObjectState(h.state),l=r.jh.getData(h).clone()),delete l.state.data?.alertState,v=new g.U({x:D.state.x,y:D.state.y,height:D.state.height,itemHeight:D.state.height,width:D.state.width,variableName:D.state.variableName,repeatDirection:D.state.repeatDirection,maxPerRow:D.state.maxPerRow,key:(0,d.ty)(y),body:new r.Eb({...C,$data:l,key:(0,d.XA)(y)})}),D.parent instanceof r.tI){const b=D.parent;b.setState({children:[...b.state.children,v]}),P.forceRender();return}P.setState({children:[...P.state.children,v]})}getVizPanels(){const h=[];return this.state.grid.forEachChild(D=>{if(!(D instanceof g.U)&&!(D instanceof r.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");D instanceof g.U&&D.state.body instanceof r.Eb?h.push(D.state.body):D instanceof r.tI&&D.forEachChild(C=>{C instanceof g.U&&C.state.body instanceof r.Eb&&h.push(C.state.body)})}),h}hasVizPanels(){for(const h of this.state.grid.state.children){if(h instanceof g.U)return!0;if(h instanceof r.tI){for(const D of h.state.children)if(D instanceof g.U)return!0}}return!1}addNewRow(){const h=c.b4.getNextPanelId(this),D=new r.tI({key:(0,d.XA)(h),title:"Row title",actions:new E.u({}),y:0}),C=this.state.grid,l=C.state.children.findIndex(y=>y instanceof r.tI),v=C.state.children.splice(0,l===-1?C.state.children.length:l).map(y=>y.clone());return v&&D.setState({children:v}),C.setState({children:[D,...C.state.children]}),D}addNewTab(){const h=this.hasVizPanels(),D=u.K.createFromLayout(this);h&&D.addNewTab(),(0,d.YQ)(this).switchLayout(D)}editModeChanged(h){const D=()=>{this.state.grid.setState({isDraggable:h,isResizable:h}),(0,d.X0)(this.state.grid,!0)};if(n.$.featureToggles.dashboardNewLayouts){setTimeout(D,10);return}D()}activateRepeaters(){this.isActive||this.activate(),this.state.grid.isActive||this.state.grid.activate(),this.state.grid.forEachChild(h=>{if(h instanceof g.U&&!h.isActive){h.activate();return}if(h instanceof r.tI&&h.state.$behaviors){for(const D of h.state.$behaviors)if(D instanceof o.L&&!h.isActive){h.activate();break}h.state.children.forEach(D=>{if(D instanceof g.U&&!D.isActive){D.activate();return}})}})}cloneLayout(h,D){return this.clone({grid:this.state.grid.clone({isResizable:D&&this.state.grid.state.isResizable,isDraggable:D&&this.state.grid.state.isDraggable,children:this.state.grid.state.children.reduce((C,l)=>{if(l instanceof g.U){const v=(0,s.ed)(h,(0,d.ty)(C.panelId)),y=l.clone({key:v,body:l.state.body.clone({key:(0,s.ed)(v,(0,d.XA)(C.panelId++))}),isDraggable:D&&l.state.isDraggable,isResizable:D&&l.state.isResizable});return C.children.push(y),C}if(l instanceof r.tI){const v=(0,s.ed)(h,(0,d.XA)(C.panelId++)),y=l.clone({key:v,children:l.state.children.reduce((P,b)=>{if((0,s.Ry)(b.state.key))return P;if(!(b instanceof g.U))return P.push(b.clone()),P;const S=(0,s.ed)(v,(0,d.ty)(C.panelId)),M=b.clone({key:S,isDraggable:D&&b.state.isDraggable,isResizable:D&&b.state.isResizable,body:b.state.body.clone({key:(0,s.ed)(S,(0,d.XA)(C.panelId++))})});return P.push(M),P},[]),isDraggable:D&&l.state.isDraggable,isResizable:D&&l.state.isResizable});return C.children.push(y),C}return C.children.push(l.clone()),C},{panelId:0,children:[]}).children})})}removeRow(h,D=!1){const C=this.state.grid,l=C.state.children.filter(v=>v.state.key!==h.state.key);if(!D){const v=h.state.children.map(P=>P.clone()),y=C.state.children.findIndex(P=>P.state.key===h.state.key);l.splice(y,0,...v)}C.setState({children:l})}collapseAllRows(){this.state.grid.state.children.forEach(h=>{h instanceof r.tI&&(h.state.isCollapsed||this.state.grid.toggleRow(h))})}expandAllRows(){this.state.grid.state.children.forEach(h=>{h instanceof r.tI&&h.state.isCollapsed&&this.state.grid.toggleRow(h)})}static createFromLayout(h){const D=h.getVizPanels();return m.fromVizPanels(D)}static fromVizPanels(h=[]){const D=[],l=a.cV/3;let v=0,y=0;for(let P of h)P.clearParent(),D.push(new g.U({key:(0,d.ty)((0,d.Cs)(P)),x:y,y:v,width:l,height:10,body:P})),y+=l,y+l>=a.cV&&(y=0,v+=10);return new m({grid:new r.hy({children:D,isDraggable:!0,isResizable:!0})})}static fromGridItems(h,D,C){const l=h.reduce((v,y)=>(y.clearParent(),v.push(y),v),[]);return new m({grid:new r.hy({children:l,isDraggable:D,isResizable:C})})}}function f({model:p}){const{children:h}=(0,r.gn)(p.state.grid,{shouldActivateOrKeepAlive:!0}),D=(0,d.YQ)(p);return p.parent===D&&h.length===0?(0,t.jsx)(x.A,{dashboard:D,canCreate:!!D.state.meta.canEdit},"dashboard-empty-state"):(0,t.jsx)(p.state.grid.Component,{model:p.state.grid})}},3865:(q,j,e)=>{"use strict";e.d(j,{L:()=>c});var t=e(2543),n=e.n(t),r=e(61034),a=e(9964),i=e(2044),x=e(93300),s=e(60101);class c extends r.Bs{constructor(m){super(m),this._variableDependency=new r.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat();const m=this._getLayout(),f=this._getRow(),p=f.state.children.filter(D=>!(0,a.Ry)(D.state.key)),h=m.subscribeToState(()=>{const D=m.state.children.filter(C=>(0,a.oX)(C.state.key,f.state.key));for(const C of D){if(!(C instanceof r.tI))continue;const l=C.state.children.filter(y=>!(0,a.Ry)(y.state.key));if(l.length===p.length)continue;const v=l.find(y=>!(0,a.ag)(y.state.key));if(v){const y=v.clone();if(C.setState({children:C.state.children.filter(P=>P!==v)}),f.state.children.find(P=>P.state.key===y.state.key))return;f.setState({children:[...f.state.children,y]}),this.performRepeat(!0)}}});return()=>{h.unsubscribe()}}_getRow(){if(!(this.parent instanceof r.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const m=r.jh.getLayout(this);if(!(m instanceof r.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return m}performRepeat(m=!1){if(this._variableDependency.hasDependencyInLoadingState())return;const f=r.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!f){console.error("RepeatedRowBehavior: Variable not found");return}if(!(f instanceof r.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const p=this._getRow(),h=this._getLayout(),{values:D,texts:C}=(0,i.a7)(f);if((0,t.isEqual)(this._prevRepeatValues,D)&&!m)return;this._prevRepeatValues=D,this._clonedRows=[];const l=p.state.children,v=d(l);let y=0;const P={values:[""],texts:f.hasAllValue()?["All"]:["None"]},b=D.length?D:P.values,S=C.length?C:P.texts;for(let M=0;M<b.length;M++){const O=M===0,R=O?p:p.clone({y:(p.state.y??0)+v*M+M,$behaviors:[],actions:void 0}),L=(0,a.lv)(p.state.key,M);R.setState({key:L,$variables:new r.Pj({variables:[new r.xc({name:this.state.variableName,value:b[M],text:String(S[M]),isMulti:f.state.isMulti,includeAll:f.state.includeAll})]}),children:[]});const B=[];for(const F of l){const I=F.state.y??0,U=(0,a.ed)(L,(0,a.Dq)(F.state.key)),W=I+(v+1)*M,A=F.clone({key:U,y:W,isDraggable:!O&&F instanceof s.U?!1:F.state.isDraggable,isResizable:!O&&F instanceof s.U?!1:F.state.isResizable});o(A,U),B.push(A),y<W+A.state.height&&(y=W+A.state.height)}R.setState({children:B}),this._clonedRows.push(R)}u(h,this._clonedRows,y,p.state.key),this.publishEvent(new x.d({source:this}),!0)}removeBehavior(){const m=this._getRow(),f=this._getLayout(),p=g(f,m.state.key);f.setState({children:p}),m.setState({$behaviors:m.state.$behaviors.filter(h=>h!==this),$variables:void 0})}}function d(E){let m=0,f=Number.MAX_VALUE;if(E.length===0)return 0;for(const p of E)p.state.y+p.state.height>m&&(m=p.state.y+p.state.height),p.state.y<f&&(f=p.state.y);return m-f}function u(E,m,f,p){const h=g(E,p),D=h.findIndex(l=>l instanceof r.tI&&(0,a.d9)(l.state.key)===(0,a.d9)(p));if(D===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const C=[...h.slice(0,D),...m,...h.slice(D+1)];if(h.length>D+1){const l=h.slice(D+1),v=l[0].state.y,y=f-v;for(const P of l)if(P.setState({y:P.state.y+y}),P instanceof r.tI)for(const b of P.state.children)b.setState({y:b.state.y+y})}E.setState({children:C})}function g(E,m){return E.state.children.filter(f=>!(f instanceof r.tI)||!(0,a.oX)((0,a.Dq)(f.state.key),m))}function o(E,m){E.forEachChild(f=>{const p=(0,a.ed)(m,f.state.key);f.setState({key:p}),o(f,p)})}},68643:(q,j,e)=>{"use strict";e.d(j,{u:()=>I});var t=e(61034),n=e(22492),r=e(11817),a=e(91830),i=e(63831),x=e(3865),s=e(74848),c=e(22803),d=e(96540),u=e(29675),g=e(79784),o=e(11747),E=e(5956),m=e(2044),f=e(60101),p=e(43908),h=e(25356),D=e(49785),C=e(58779),l=e(86489),v=e(34128),y=e(37e3),P=e(54731),b=e(54594),S=e(66732);const M=({repeat:U,title:W,sceneContext:A,isUsingDashboardDS:N,onUpdate:K,onCancel:V})=>{const[T,z]=(0,d.useState)(U),w=(0,d.useCallback)(k=>z(k),[z]),{handleSubmit:H,register:G}=(0,D.mN)({defaultValues:{title:W}}),X=k=>{K(k.title,T)};return(0,s.jsxs)("form",{onSubmit:H(X),children:[(0,s.jsx)(l.D,{label:(0,r.t)("dashboard.default-layout.row-options.form.title","Title"),children:(0,s.jsx)(v.p,{...G("title"),type:"text"})}),(0,s.jsx)(l.D,{label:(0,r.t)("dashboard.default-layout.row-options.form.repeat-for.label","Repeat for"),children:(0,s.jsx)(S.U,{sceneContext:A,repeat:T,onChange:w})}),N&&(0,s.jsx)(y.F,{"data-testid":C.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:(0,s.jsxs)(r.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.warning.text",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:o.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,s.jsx)(P.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,s.jsx)(r.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.learn-more",children:"Learn more"})})]})}),(0,s.jsxs)(h.a.ButtonRow,{children:[(0,s.jsx)(b.$n,{type:"button",variant:"secondary",onClick:V,fill:"outline",children:(0,s.jsx)(r.x6,{i18nKey:"dashboard.default-layout.row-options.form.cancel",children:"Cancel"})}),(0,s.jsx)(b.$n,{type:"submit",children:(0,s.jsx)(r.x6,{i18nKey:"dashboard.default-layout.row-options.form.update",children:"Update"})})]})]})},O=({repeat:U,title:W,parent:A,onDismiss:N,onUpdate:K,isUsingDashboardDS:V})=>{const T=(0,u.of)(R);return(0,s.jsx)(h.a,{isOpen:!0,title:(0,r.t)("dashboard.default-layout.row-options.modal.title","Row options"),onDismiss:N,className:T.modal,children:(0,s.jsx)(M,{sceneContext:A,repeat:U,title:W,onCancel:N,onUpdate:K,isUsingDashboardDS:V})})},R=()=>({modal:(0,c.css)({label:"RowOptionsModal",width:"500px"})}),L=({repeat:U,title:W,parent:A,onUpdate:N,isUsingDashboardDS:K})=>(0,s.jsx)(p.$s,{children:({showModal:V,hideModal:T})=>(0,s.jsx)("button",{type:"button",className:"pointer","aria-label":(0,r.t)("dashboard.default-layout.row-options.button.label","Row options"),onClick:()=>{V(O,{title:W,repeat:U,parent:A,onDismiss:T,onUpdate:(z,w)=>{N(z,w),T()},isUsingDashboardDS:K})},children:(0,s.jsx)(g.I,{name:"cog"})})});L.displayName="RowOptionsButton";function B({model:U}){const W=(0,m.YQ)(U),A=U.getParent(),{title:N,children:K}=A.useState(),{meta:V,isEditing:T}=W.useState(),z=(0,u.of)(F),w=(0,d.useMemo)(()=>K.some(G=>{if(!(G instanceof f.U))return!1;if(G.state.body instanceof t.Eb){const X=(0,m.un)(G.state.body);return X?.state.datasource?.uid===o.K||X?.state.datasource?.uid===E.uv&&X?.state.queries.some(k=>k.datasource?.uid===o.K)}return!1}),[K]),H=A.state.$behaviors?.find(G=>G instanceof x.L);return(0,s.jsx)(s.Fragment,{children:V.canEdit&&T&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:z.rowActions,children:[(0,s.jsx)(L,{title:N,repeat:H instanceof x.L?H.state.variableName:void 0,parent:W,onUpdate:(G,X)=>U.onUpdate(G,X),isUsingDashboardDS:w}),(0,s.jsx)("button",{type:"button",onClick:()=>U.onDelete(),"aria-label":(0,r.t)("dashboard.default-layout.row-actions.delete","Delete row"),children:(0,s.jsx)(g.I,{name:"trash-alt"})})]})})})}const F=U=>({rowActions:(0,c.css)({color:U.colors.text.secondary,lineHeight:"27px",button:{color:U.colors.text.secondary,paddingLeft:U.spacing(2),background:"transparent",border:"none","&:hover":{color:U.colors.text.maxContrast}}})});class I extends t.Bs{static{this.Component=B}getParent(){if(!(this.parent instanceof t.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}removeRow(W){t.jh.getAncestor(this,i.D).removeRow(this.getParent(),W)}onUpdate(W,A){const N=this.getParent();let K;if(N.state.$behaviors)for(let V of N.state.$behaviors)V instanceof x.L&&(K=V);W!==N.state.title&&N.setState({title:W}),A?(K&&K.removeBehavior(),K=new x.L({variableName:A}),N.setState({$behaviors:[...N.state.$behaviors??[],K]})):K?.removeBehavior()}onDelete(){n.A.publish(new a.bY({title:(0,r.t)("dashboard.default-layout.row-actions.modal.title","Delete row"),text:(0,r.t)("dashboard.default-layout.row-actions.modal.text","Are you sure you want to remove this row and all its panels?"),altActionText:(0,r.t)("dashboard.default-layout.row-actions.modal.alt-action","Delete row only"),icon:"trash-alt",onConfirm:()=>this.removeRow(!0),onAltAction:()=>this.removeRow()}))}}},69252:(q,j,e)=>{"use strict";e.d(j,{I:()=>E});var t=e(61034),n=e(74848),r=e(29010),a=e(11817),i=e(12422),x=e(12600);function s(m){const f=new i.C({title:(0,a.t)("dashboard.responsive-layout.item-options.title","Layout options"),id:"layout-options",isOpenDefault:!1});return f.addItem(new x.v({title:(0,a.t)("dashboard.responsive-layout.item-options.hide-no-data","Hide when no data"),render:()=>(0,n.jsx)(c,{item:m})})),f}function c({item:m}){const{hideWhenNoData:f}=m.useState();return(0,n.jsx)(r.d,{value:f,id:"hide-when-no-data",onChange:()=>m.toggleHideWhenNoData()})}var d=e(22803),u=e(29675);function g({model:m}){const{body:f}=m.useState(),p=(0,u.of)(o);return(0,n.jsx)("div",{className:(0,d.cx)(p.wrapper),children:(0,n.jsx)(f.Component,{model:f})})}function o(){return{wrapper:(0,d.css)({width:"100%",height:"100%",position:"relative"})}}class E extends t.Bs{constructor(){super(...arguments),this.isDashboardLayoutItem=!0}static{this.Component=g}getOptions(){return s(this)}toggleHideWhenNoData(){this.setState({hideWhenNoData:!this.state.hideWhenNoData})}}},66345:(q,j,e)=>{"use strict";e.d(j,{g:()=>p});var t=e(74848),n=e(61034),r=e(11817),a=e(9964),i=e(18745),x=e(2044),s=e(85582),c=e(8822),d=e(69252),u=e(44826),g=e(12600);const o=[100,150,200,250,300,350,400,450,500,550,650];function E(D){const C=[];return C.push(new g.v({title:(0,r.t)("dashboard.responsive-layout.options.columns","Columns"),render:()=>(0,t.jsx)(m,{layoutManager:D})})),C.push(new g.v({title:(0,r.t)("dashboard.responsive-layout.options.rows","Rows"),render:()=>(0,t.jsx)(f,{layoutManager:D})})),C}function m({layoutManager:D}){const{templateColumns:C}=D.state.layout.useState(),l=[{label:(0,r.t)("dashboard.responsive-layout.options.one-column","1 column"),value:"1fr"},{label:(0,r.t)("dashboard.responsive-layout.options.two-columns","2 columns"),value:"1fr 1fr"},{label:(0,r.t)("dashboard.responsive-layout.options.three-columns","3 columns"),value:"1fr 1fr 1fr"}];for(const v of o)l.push({label:(0,r.t)("dashboard.responsive-layout.options.min","Min: {{size}}px",{size:v}),value:`repeat(auto-fit, minmax(${v}px, auto))`});return(0,t.jsx)(u.l6,{options:l,value:String(C),onChange:({value:v})=>D.changeColumns(v),allowCustomValue:!0})}function f({layoutManager:D}){const{autoRows:C}=D.state.layout.useState(),l=[];for(const v of o)l.push({label:(0,r.t)("dashboard.responsive-layout.options.min","Min: {{size}}px",{size:v}),value:`minmax(${v}px, auto)`});for(const v of o)l.push({label:(0,r.t)("dashboard.responsive-layout.options.fixed","Fixed: {{size}}px",{size:v}),value:`${v}px`});return(0,t.jsx)(u.l6,{options:l,value:String(C),onChange:({value:v})=>D.changeRows(v),allowCustomValue:!0})}class p extends n.Bs{constructor(C){super(C),this.isDashboardLayoutManager=!0,this.descriptor=p.descriptor,this.state.layout.getDragClassCancel=()=>"drag-cancel"}static{this.Component=h}static{this.descriptor={get name(){return(0,r.t)("dashboard.responsive-layout.name","Responsive grid")},get description(){return(0,r.t)("dashboard.responsive-layout.description","CSS layout that adjusts to the available space")},id:"responsive-grid",createFromLayout:p.createFromLayout,kind:"ResponsiveGridLayout"}}static{this.defaultCSS={templateColumns:"repeat(auto-fit, minmax(400px, auto))",autoRows:"minmax(300px, auto)"}}addPanel(C){const l=i.b4.getNextPanelId(this);C.setState({key:(0,x.XA)(l)}),C.clearParent(),this.state.layout.setState({children:[new d.I({body:C}),...this.state.layout.state.children]})}removePanel(C){const l=C.parent;this.state.layout.setState({children:this.state.layout.state.children.filter(v=>v!==l)})}duplicatePanel(C){const l=C.parent;if(!(l instanceof d.I)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}const v=i.b4.getNextPanelId(this),y=this.state.layout,P=l.clone({key:(0,x.ty)(v),body:C.clone({key:(0,x.XA)(v)})}),b=y.state.children.indexOf(l),S=[...y.state.children];S.splice(b+1,0,P),y.setState({children:S})}getVizPanels(){const C=[];for(const l of this.state.layout.state.children)l instanceof d.I&&C.push(l.state.body);return C}hasVizPanels(){for(const C of this.state.layout.state.children)if(C instanceof d.I)return!0;return!1}cloneLayout(C,l){return this.clone({layout:this.state.layout.clone({children:this.state.layout.state.children.map(v=>{if(v instanceof d.I){const y=(0,x.Cs)(v.state.body),P=(0,a.ed)(C,(0,x.ty)(y));return v.clone({key:P,body:v.state.body.clone({key:(0,a.ed)(P,(0,x.XA)(y))})})}throw new Error("Unexpected child type")})})})}addNewRow(){const C=this.hasVizPanels(),l=s.V.createFromLayout(this);C&&l.addNewRow(),(0,x.YQ)(this).switchLayout(l)}addNewTab(){const C=this.hasVizPanels(),l=c.K.createFromLayout(this);C&&l.addNewTab(),(0,x.YQ)(this).switchLayout(l)}getOptions(){return E(this)}changeColumns(C){this.state.layout.setState({templateColumns:C})}changeRows(C){this.state.layout.setState({autoRows:C})}static createEmpty(){return new p({layout:new n.gF({children:[],templateColumns:p.defaultCSS.templateColumns,autoRows:p.defaultCSS.autoRows})})}static createFromLayout(C){const l=C.getVizPanels(),v=[];for(let P of l)v.push(new d.I({body:P.clone()}));const y=p.createEmpty();return y.state.layout.setState({children:v}),y}}function h({model:D}){return(0,t.jsx)(D.state.layout.Component,{model:D.state.layout})}},31763:(q,j,e)=>{"use strict";e.d(j,{o:()=>G});var t=e(61034),n=e(11817),r=e(66345),a=e(74848),i=e(96540),x=e(58779),s=e(54594),c=e(34128),d=e(29010),u=e(60641),g=e(37e3),o=e(54731),E=e(12422),m=e(12600),f=e(66732),p=e(11747),h=e(5956),D=e(2044),C=e(98933);function l(X){const k=(0,i.useMemo)(()=>new E.C({title:(0,n.t)("dashboard.rows-layout.row-options.title","Row options"),id:"row-options",isOpenDefault:!0}).addItem(new m.v({title:(0,n.t)("dashboard.rows-layout.row-options.title-option","Title"),render:()=>(0,a.jsx)(y,{row:X})})).addItem(new m.v({title:(0,n.t)("dashboard.rows-layout.row-options.height.title","Height"),render:()=>(0,a.jsx)(b,{row:X})})).addItem(new m.v({title:(0,n.t)("dashboard.rows-layout.row-options.height.hide-row-header","Hide row header"),render:()=>(0,a.jsx)(P,{row:X})})),[X]),_=(0,i.useMemo)(()=>{const Z=(0,D.YQ)(X);return new E.C({title:(0,n.t)("dashboard.rows-layout.row-options.repeat.title","Repeat options"),id:"row-repeat-options",isOpenDefault:!0}).addItem(new m.v({title:(0,n.t)("dashboard.rows-layout.row-options.repeat.variable.title","Variable"),render:()=>(0,a.jsx)(S,{row:X,dashboard:Z})}))},[X]),{layout:ee}=X.useState(),J=(0,C.W)(ee);return[k,_,J]}function v(X){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,a.jsx)(s.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:()=>X.onDelete(),icon:"trash-alt"})]})}function y({row:X}){const{title:k}=X.useState();return(0,a.jsx)(c.p,{value:k,onChange:_=>X.onChangeTitle(_.currentTarget.value)})}function P({row:X}){const{isHeaderHidden:k=!1}=X.useState();return(0,a.jsx)(d.d,{value:k,onChange:()=>X.onHeaderHiddenToggle()})}function b({row:X}){const{height:k="expand"}=X.useState(),_=[{label:(0,n.t)("dashboard.rows-layout.row-options.height.expand","Expand"),value:"expand"},{label:(0,n.t)("dashboard.rows-layout.row-options.height.min","Min"),value:"min"}];return(0,a.jsx)(u.z,{options:_,value:k,onChange:ee=>X.onChangeHeight(ee)})}function S({row:X,dashboard:k}){const{layout:_}=X.useState(),ee=_.getVizPanels().some(J=>{const Z=(0,D.un)(J);return Z?.state.datasource?.uid===p.K||Z?.state.datasource?.uid===h.uv&&Z?.state.queries.some(te=>te.datasource?.uid===p.K)});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.U,{sceneContext:k,repeat:X.getRepeatVariable(),onChange:J=>X.onChangeRepeat(J)}),ee?(0,a.jsxs)(g.F,{"data-testid":x.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,a.jsx)("p",{children:(0,a.jsxs)(n.x6,{i18nKey:"dashboard.rows-layout.row.repeat.warning",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:p.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,a.jsx)(o.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,a.jsx)(n.x6,{i18nKey:"dashboard.rows-layout.row.repeat.learn-more",children:"Learn more"})})]}):void 0]})}var M=e(22803),O=e(29675),R=e(79592),L=e(79784),B=e(9964);function F({model:X}){const{layout:k,title:_,isCollapsed:ee,height:J="expand",isHeaderHidden:Z,key:te}=X.useState(),ae=(0,i.useMemo)(()=>(0,B.Ry)(te),[te]),re=(0,D.YQ)(X),{isEditing:ne,showHiddenElements:ce}=re.useState(),le=(0,O.of)(I),he=t.jh.interpolate(X,_,void 0,"text"),oe=(0,i.useRef)(null),de=!ee&&J==="expand",{isSelected:me,onSelect:Pe}=(0,R.y)(te);return(0,a.jsxs)("div",{className:(0,M.cx)(le.wrapper,ee&&le.wrapperCollapsed,de&&le.wrapperGrow,!ae&&me&&"dashboard-selected-element"),ref:oe,children:[(!Z||ne&&ce)&&(0,a.jsxs)("div",{className:le.rowHeader,children:[(0,a.jsxs)("button",{onClick:()=>X.onCollapseToggle(),className:le.rowTitleButton,"aria-label":ee?(0,n.t)("dashboard.rows-layout.row.expand","Expand row"):(0,n.t)("dashboard.rows-layout.row.collapse","Collapse row"),"data-testid":x.Tp.components.DashboardRow.title(he),children:[(0,a.jsx)(L.I,{name:ee?"angle-right":"angle-down"}),(0,a.jsx)("span",{className:le.rowTitle,role:"heading",children:he})]}),!ae&&ne&&(0,a.jsx)(s.$n,{icon:"pen",variant:"secondary",size:"sm",fill:"text",onPointerDown:Ee=>Pe?.(Ee)})]}),!ee&&(0,a.jsx)(k.Component,{model:k})]})}function I(X){return{rowHeader:(0,M.css)({width:"100%",display:"flex",gap:X.spacing(1),padding:X.spacing(0,0,.5,0),margin:X.spacing(0,0,1,0),alignItems:"center","&:hover, &:focus-within":{"& > div":{opacity:1}},"& > div":{marginBottom:0,marginRight:X.spacing(1)}}),rowTitleButton:(0,M.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",minWidth:0,gap:X.spacing(1)}),rowTitle:(0,M.css)({fontSize:X.typography.h5.fontSize,fontWeight:X.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flexGrow:1,minWidth:0}),wrapper:(0,M.css)({display:"flex",flexDirection:"column",width:"100%",minHeight:"100px"}),wrapperGrow:(0,M.css)({flexGrow:1}),wrapperCollapsed:(0,M.css)({flexGrow:0,borderBottom:`1px solid ${X.colors.border.weak}`,minHeight:"unset"}),rowActions:(0,M.css)({display:"flex",opacity:0})}}var U=e(18474),W=e(24726),A=e(48583),N=e(45565),K=e(81942);function V(X){return[new E.C({title:(0,n.t)("dashboard.edit-pane.row.multi-select.options-header","Multi-selected Row options"),id:`ms-row-options-${X.key}`,isOpenDefault:!0}).addItem(new m.v({title:(0,n.t)("dashboard.edit-pane.row.header.title","Row header"),render:()=>(0,a.jsx)(z,{model:X})}))]}function T(X){const k=X.getRows();return(0,a.jsxs)(A.B,{direction:"column",children:[(0,a.jsx)(N.E,{children:(0,a.jsxs)(n.x6,{i18nKey:"dashboard.edit-pane.row.multi-select.selection-number",values:{length:k.length},children:["No. of rows selected: ",{length}]})}),(0,a.jsxs)(A.B,{direction:"row",children:[(0,a.jsx)(s.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,a.jsx)(s.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:()=>X.onDelete(),icon:"trash-alt"})]})]})}function z({model:X}){const k=X.getRows();let _=!1,ee=!1;for(let J=0;J<k.length;J++){const{isHeaderHidden:Z}=k[J].useState(),te=k[J-1];ee=ee||te&&!!te.state.isHeaderHidden!=!!Z,_=_||!!Z}return(0,a.jsx)(K.S,{label:(0,n.t)("dashboard.edit-pane.row.header.hide","Hide"),value:_,indeterminate:ee,onChange:()=>X.onHeaderHiddenToggle(_,ee)})}class w{constructor(k){this._rows=k,this.isMultiSelectedEditableDashboardElement=!0,this.typeName="Rows",this.key=(0,W.A)()}useEditPaneOptions(){return V(this)}renderActions(){return T(this)}getRows(){return this._rows}onDelete(){this._rows.forEach(k=>k.onDelete())}onHeaderHiddenToggle(k,_){this._rows.forEach(ee=>ee.onHeaderHiddenToggle(_?!0:!k))}}var H=e(85582);class G extends t.Bs{constructor(k){super({...k,title:k?.title??(0,n.t)("dashboard.rows-layout.row.new","New row"),layout:k?.layout??r.g.createEmpty()}),this._variableDependency=new t.Sh(this,{statePaths:["title"]}),this.isEditableDashboardElement=!0,this.typeName="Row"}static{this.Component=F}getLayout(){return this.state.layout}switchLayout(k){this.setState({layout:k})}useEditPaneOptions(){return l(this)}renderActions(){return v(this)}onDelete(){t.jh.getAncestor(this,H.V).removeRow(this)}createMultiSelectedElement(k){return new w(k.filter(_=>_ instanceof G))}getRepeatVariable(){return this._getRepeatBehavior()?.state.variableName}onChangeTitle(k){this.setState({title:k})}onHeaderHiddenToggle(k=!this.state.isHeaderHidden){this.setState({isHeaderHidden:k})}onChangeHeight(k){this.setState({height:k})}onChangeRepeat(k){let _=this._getRepeatBehavior();k?(_&&_.removeBehavior(),_=new U.y({variableName:k}),this.setState({$behaviors:[...this.state.$behaviors??[],_]}),_.activate()):_?.removeBehavior()}onCollapseToggle(){this.setState({isCollapsed:!this.state.isCollapsed})}_getRepeatBehavior(){return this.state.$behaviors?.find(k=>k instanceof U.y)}}},18474:(q,j,e)=>{"use strict";e.d(j,{y:()=>d});var t=e(2543),n=e.n(t),r=e(61034),a=e(9964),i=e(2044),x=e(93300),s=e(31763),c=e(85582);class d extends r.Bs{constructor(E){super(E),this._variableDependency=new r.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getRow(){if(!(this.parent instanceof s.o))throw new Error("RepeatedRowItemBehavior: Parent is not a RowItem");return this.parent}_getLayout(){const E=this._getRow().parent;if(!(E instanceof c.V))throw new Error("RepeatedRowItemBehavior: Layout is not a RowsLayoutManager");return E}performRepeat(E=!1){if(this._variableDependency.hasDependencyInLoadingState())return;const m=r.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!m){console.error("RepeatedRowItemBehavior: Variable not found");return}if(!(m instanceof r.n8)){console.error("RepeatedRowItemBehavior: Variable is not a MultiValueVariable");return}const f=this._getRow(),p=this._getLayout(),{values:h,texts:D}=(0,i.a7)(m);if((0,t.isEqual)(this._prevRepeatValues,h)&&!E)return;this._prevRepeatValues=h,this._clonedRows=[];const C=f.getLayout(),l={values:[""],texts:m.hasAllValue()?["All"]:["None"]},v=h.length?h:l.values,y=D.length?D:l.texts;for(let P=0;P<v.length;P++){const b=P===0,S=b?f:f.clone({$behaviors:[]}),M=(0,a.lv)(f.state.key,P);S.setState({key:M,$variables:new r.Pj({variables:[new r.xc({name:this.state.variableName,value:v[P],text:String(y[P]),isMulti:m.state.isMulti,includeAll:m.state.includeAll})]}),layout:C.cloneLayout?.(M,b)}),this._clonedRows.push(S)}u(p,this._clonedRows,f.state.key),this.publishEvent(new x.d({source:this}),!0)}removeBehavior(){const E=this._getRow(),m=this._getLayout(),f=g(m,E.state.key);m.setState({rows:f}),E.setState({$behaviors:E.state.$behaviors.filter(p=>p!==this),$variables:void 0})}}function u(o,E,m){const f=g(o,m),p=f.findIndex(h=>h.state.key.includes(m));if(p===-1)throw new Error("RowItemRepeaterBehavior: Row not found in layout");o.setState({rows:[...f.slice(0,p),...E,...f.slice(p+1)]})}function g(o,E){return o.state.rows.filter(m=>!(0,a.oX)(m.state.key,E))}},85582:(q,j,e)=>{"use strict";e.d(j,{V:()=>h});var t=e(61034),n=e(11817),r=e(9964),a=e(18745),i=e(2044),x=e(60101),s=e(63831),c=e(3865),d=e(8822),u=e(31763),g=e(18474),o=e(74848),E=e(22803),m=e(29675);function f({model:D}){const{rows:C}=D.useState(),l=(0,m.of)(p);return(0,o.jsx)("div",{className:l.wrapper,children:C.map(v=>(0,o.jsx)(v.Component,{model:v},v.state.key))})}function p(D){return{wrapper:(0,E.css)({display:"flex",flexDirection:"column",gap:D.spacing(1),flexGrow:1,width:"100%"})}}class h extends t.Bs{constructor(){super(...arguments),this.isDashboardLayoutManager=!0,this.descriptor=h.descriptor}static{this.Component=f}static{this.descriptor={get name(){return(0,n.t)("dashboard.rows-layout.name","Rows")},get description(){return(0,n.t)("dashboard.rows-layout.description","Rows layout")},id:"rows-layout",createFromLayout:h.createFromLayout,kind:"RowsLayout"}}addPanel(C){const l=a.b4.getAllSelectedObjects(this).filter(v=>v instanceof u.o);if(l.length>0)return l.forEach(v=>v.getLayout().addPanel(C));if(this.state.rows.length>0)return this.state.rows[0].getLayout().addPanel(C);this.addNewRow(),this.state.rows[this.state.rows.length-1].getLayout().addPanel(C)}getVizPanels(){const C=[];for(const l of this.state.rows){const v=l.getLayout().getVizPanels();C.push(...v)}return C}hasVizPanels(){for(const C of this.state.rows)if(C.getLayout().hasVizPanels())return!0;return!1}cloneLayout(C,l){throw new Error("Method not implemented.")}addNewRow(){this.setState({rows:[...this.state.rows,new u.o]})}addNewTab(){const C=this.hasVizPanels(),l=d.K.createFromLayout(this);C&&l.addNewTab(),(0,i.YQ)(this).switchLayout(l)}editModeChanged(C){this.state.rows.forEach(l=>l.getLayout().editModeChanged?.(C))}activateRepeaters(){this.state.rows.forEach(C=>{C.isActive||C.activate();const l=(C.state.$behaviors??[]).find(v=>v instanceof g.y);l?.isActive||l?.activate(),C.getLayout().activateRepeaters?.()})}removeRow(C){const l=this.state.rows.filter(v=>v!==C);this.setState({rows:l.length===0?[new u.o]:l})}static createEmpty(){return new h({rows:[new u.o]})}static createFromLayout(C){let l;if(C instanceof s.D){const v=[];let y;C.state.grid.forEachChild(P=>{if(!(P instanceof x.U)&&!(P instanceof t.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");if(P instanceof t.tI){if(!(0,r.Ry)(P.state.key)){const b=P.state.$behaviors?.find(S=>S instanceof c.L);v.push({title:P.state.title,isCollapsed:!!P.state.isCollapsed,isDraggable:P.state.isDraggable??C.state.grid.state.isDraggable,isResizable:P.state.isResizable??C.state.grid.state.isResizable,children:P.state.children,repeat:b?.state.variableName}),y=void 0}}else y||(y=[],v.push({children:y})),y.push(P)}),l=v.map(P=>new u.o({title:P.title,isCollapsed:!!P.isCollapsed,layout:s.D.fromGridItems(P.children,P.isDraggable,P.isResizable),$behaviors:P.repeat?[new g.y({variableName:P.repeat})]:[]}))}else l=[new u.o({layout:C.clone()})];return l.length===0&&(l=[new u.o]),new h({rows:l})}}},71811:(q,j,e)=>{"use strict";e.d(j,{V:()=>R});var t=e(61034),n=e(11817),r=e(66345),a=e(74848),i=e(96540),x=e(54594),s=e(34128),c=e(12422),d=e(12600),u=e(98933);function g(L){const B=(0,i.useMemo)(()=>new c.C({title:(0,n.t)("dashboard.tabs-layout.tab-options.title","Tab options"),id:"tab-options",isOpenDefault:!0}).addItem(new d.v({title:(0,n.t)("dashboard.tabs-layout.tab-options.title-option","Title"),render:()=>(0,a.jsx)(E,{tab:L})})),[L]),{layout:F}=L.useState(),I=(0,u.W)(F);return[B,I]}function o(L){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,a.jsx)(x.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:()=>L.onDelete(),icon:"trash-alt"})]})}function E({tab:L}){const{title:B}=L.useState();return(0,a.jsx)(s.p,{value:B,onChange:F=>L.onChangeTitle(F.currentTarget.value)})}var m=e(61574),f=e(2567),p=e(79592),h=e(88849),D=e(9964),C=e(2044);function l({model:L}){const{title:B,key:F}=L.useState(),I=(0,i.useMemo)(()=>(0,D.Ry)(F),[F]),U=L.getParentLayout(),{tabs:W,currentTabIndex:A}=U.useState(),N=(0,C.YQ)(L),{isEditing:K}=N.useState(),V=t.jh.interpolate(L,B,void 0,"text"),{isSelected:T,onSelect:z}=(0,p.y)(F),w=W.findIndex(k=>k===L),H=w===A,G=(0,m.zy)(),X=f.I.getUrlForPartial(G,{tab:w});return(0,a.jsx)(h.o,{className:!I&&T?"dashboard-selected-element":void 0,label:V,active:H,href:X,onPointerDown:k=>{K&&H&&!I&&(k.stopPropagation(),z?.(k))}})}var v=e(24726),y=e(48583),P=e(45565);function b(L){return[(0,i.useMemo)(()=>new c.C({title:(0,n.t)("dashboard.edit-pane.tab.multi-select.options-header","Multi-selected Tab options"),id:"ms-tab-options",isOpenDefault:!0}),[])]}function S(L){const B=L.getTabs();return(0,a.jsxs)(y.B,{direction:"column",children:[(0,a.jsxs)(P.E,{children:[(0,a.jsx)(n.x6,{i18nKey:"dashboard.edit-pane.tab.multi-select.selection-number",children:"No. of tabs selected: "}),B.length]}),(0,a.jsxs)(y.B,{direction:"row",children:[(0,a.jsx)(x.$n,{size:"sm",variant:"secondary",icon:"copy"}),(0,a.jsx)(x.$n,{size:"sm",variant:"destructive",fill:"outline",onClick:()=>L.onDelete(),icon:"trash-alt"})]})]})}class M{constructor(B){this._tabs=B,this.isMultiSelectedEditableDashboardElement=!0,this.typeName="Tabs",this.key=(0,v.A)()}useEditPaneOptions(){return b(this)}renderActions(){return S(this)}getTabs(){return this._tabs}onDelete(){this._tabs.forEach(B=>B.onDelete())}}var O=e(8822);class R extends t.Bs{constructor(B){super({...B,title:B?.title??(0,n.t)("dashboard.tabs-layout.tab.new","New tab"),layout:B?.layout??r.g.createEmpty()}),this._variableDependency=new t.Sh(this,{statePaths:["title"]}),this.isEditableDashboardElement=!0,this.typeName="Tab"}static{this.Component=l}getLayout(){return this.state.layout}switchLayout(B){this.setState({layout:B})}useEditPaneOptions(){return g(this)}renderActions(){return o(this)}getParentLayout(){return t.jh.getAncestor(this,O.K)}onDelete(){t.jh.getAncestor(this,O.K).removeTab(this)}createMultiSelectedElement(B){return new M(B.filter(F=>F instanceof R))}onChangeTitle(B){this.setState({title:B})}}},8822:(q,j,e)=>{"use strict";e.d(j,{K:()=>g});var t=e(61034),n=e(11817),r=e(71811),a=e(74848),i=e(22803),x=e(29675),s=e(10247),c=e(11238);function d({model:o}){const E=(0,x.of)(u),{tabs:m,currentTabIndex:f}=o.useState(),p=m[f],{layout:h}=p.useState();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.U,{className:E.tabsContainer,children:m.map(D=>(0,a.jsx)(D.Component,{model:D},D.state.key))}),(0,a.jsx)(c.J,{className:E.tabContentContainer,children:p&&(0,a.jsx)(h.Component,{model:h})})]})}const u=o=>({tabsContainer:(0,i.css)({flexShrink:1,padding:"2px 2px 0 2px",marginBottom:o.spacing(1)}),tabContentContainer:(0,i.css)({backgroundColor:"transparent",display:"flex",flex:1,height:"100%",overflow:"auto",scrollbarWidth:"thin",padding:"2px 2px 0 2px"})});class g extends t.Bs{constructor(E){super({...E,tabs:E.tabs??[new r.V],currentTabIndex:E.currentTabIndex??0}),this.isDashboardLayoutManager=!0,this.descriptor=g.descriptor,this._urlSync=new t.So(this,{keys:["tab"]})}static{this.Component=d}static{this.descriptor={get name(){return(0,n.t)("dashboard.tabs-layout.name","Tabs")},get description(){return(0,n.t)("dashboard.tabs-layout.description","Tabs layout")},id:"tabs-layout",createFromLayout:g.createFromLayout,kind:"TabsLayout"}}getUrlState(){return{tab:this.state.currentTabIndex.toString()}}updateFromUrl(E){E.tab&&typeof E.tab=="string"&&this.setState({currentTabIndex:parseInt(E.tab,10)})}getCurrentTab(){return this.state.tabs.length>this.state.currentTabIndex?this.state.tabs[this.state.currentTabIndex]:this.state.tabs[0]}addPanel(E){this.getCurrentTab().getLayout().addPanel(E)}getVizPanels(){const E=[];for(const m of this.state.tabs){const f=m.getLayout().getVizPanels();E.push(...f)}return E}cloneLayout(E,m){throw new Error("Method not implemented.")}hasVizPanels(){for(const E of this.state.tabs)if(E.getLayout().hasVizPanels())return!0;return!1}addNewRow(){this.getCurrentTab().getLayout().addNewRow()}addNewTab(){const E=new r.V;this.setState({tabs:[...this.state.tabs,E],currentTabIndex:this.state.tabs.length})}editModeChanged(E){this.state.tabs.forEach(m=>m.getLayout().editModeChanged?.(E))}activateRepeaters(){this.state.tabs.forEach(E=>E.getLayout().activateRepeaters?.())}removeTab(E){if(this.state.tabs.length===1)return;if(this.getCurrentTab()===E){const h=this.state.currentTabIndex>0?this.state.currentTabIndex-1:0;this.setState({tabs:this.state.tabs.filter(D=>D!==E),currentTabIndex:h});return}const f=this.state.tabs.filter(h=>h!==E),p=f.length===0?[new r.V]:f;this.setState({tabs:p,currentTabIndex:0})}static createEmpty(){const E=new r.V;return new g({tabs:[E]})}static createFromLayout(E){const m=new r.V({layout:E.clone()});return new g({tabs:[m]})}}},98933:(q,j,e)=>{"use strict";e.d(j,{W:()=>p});var t=e(74848),n=e(96540),r=e(44826),a=e(12422),i=e(12600);function x(D){return"switchLayout"in D}var s=e(64015),c=e(63831),d=e(66345),u=e(85582),g=e(8822);const o=new s.O(()=>[c.D.descriptor,d.g.descriptor,u.V.descriptor,g.K.descriptor]);var E=e(16045);function m(D){let C=D.parent;for(;C;){if((0,E.e)(C))return C;C=C.parent}return null}function f({layoutManager:D}){const C=(0,n.useMemo)(()=>{const P=m(D)?.descriptor.id;return o.list().filter(b=>b.id!==P).map(b=>({label:b.name,value:b}))},[D]),l=D.descriptor.id,v=C.find(y=>y.value.id===l);return(0,t.jsx)(r.l6,{options:C,value:v,onChange:y=>{y.value?.id!==v?.value.id&&h(D,y.value)}})}function p(D){return(0,n.useMemo)(()=>{const C=new a.C({title:"Layout",id:"layout-options",isOpenDefault:!0});if(C.addItem(new i.v({title:"Type",render:function(){return(0,t.jsx)(f,{layoutManager:D})}})),D.getOptions)for(const l of D.getOptions())C.addItem(l);return C},[D])}function h(D,C){const l=D.parent;l&&x(l)&&l.switchLayout(C.createFromLayout(D))}},83971:(q,j,e)=>{"use strict";e.d(j,{C:()=>d});var t=e(16753),n=e(35383),r=e(32370),a=e(98437),i=e(61034),x=e(65596),s=e(18745),c=e(2044);function d(m,f){f.app=t.Jk.Dashboard,f.canAddAnnotations=()=>{const p=(0,c.YQ)(m);return!u(p)||!r.$.featureToggles.annotationPermissionUpdate&&!p.canEditDashboard()?!1:!!p.state.meta.annotationsPermissions?.dashboard.canAdd},f.canEditAnnotations=p=>{const h=(0,c.YQ)(m);return!r.$.featureToggles.annotationPermissionUpdate&&!h.canEditDashboard()?!1:p?!!h.state.meta.annotationsPermissions?.dashboard.canEdit:!!h.state.meta.annotationsPermissions?.organization.canEdit},f.canDeleteAnnotations=p=>{const h=(0,c.YQ)(m);return!r.$.featureToggles.annotationPermissionUpdate&&!h.canEditDashboard()?!1:p?!!h.state.meta.annotationsPermissions?.dashboard.canDelete:!!h.state.meta.annotationsPermissions?.organization.canDelete},f.onAnnotationCreate=async p=>{const h=(0,c.YQ)(m),D=p.from!==p.to,C={dashboardUID:h.state.uid,panelId:(0,c.Cs)(m),isRegion:D,time:p.from,timeEnd:D?p.to:0,tags:p.tags,text:p.description};await(0,x.vJ)(C),g(h),f.eventBus.publish(new n.We(C))},f.onAnnotationUpdate=async p=>{const h=(0,c.YQ)(m),D=p.from!==p.to,C={id:p.id,dashboardUID:h.state.uid,panelId:(0,c.Cs)(m),isRegion:D,time:p.from,timeEnd:D?p.to:0,tags:p.tags,text:p.description};await(0,x.rJ)(C),g(h),f.eventBus.publish(new n.We(C))},f.onAnnotationDelete=async p=>{await(0,x.Xm)({id:p}),g((0,c.YQ)(m)),f.eventBus.publish(new n.We({id:p}))},f.onAddAdHocFilter=p=>{const h=(0,c.YQ)(m),D=(0,c.un)(m);if(!D)return;const C=o(h,D.state.datasource);E(C,p)},f.onUpdateData=p=>Promise.resolve(!0)}function u(m){const f=s.b4.getDataLayers(m);for(const p of f.state.annotationLayers)if(p instanceof i.tV.g&&p.state.isEnabled&&p.state.query.builtIn)return p}function g(m){const f=u(m);f&&f.runLayer()}function o(m,f){const p=i.jh.getVariables(m);for(const D of p.state.variables)if(i.Go.isAdHocVariable(D)){const C=D.state.datasource;if(C===f||C?.uid===f?.uid)return D}const h=new i.H9({name:"Filters",datasource:f,supportsMultiValueOperators:!!(0,a.l)().getInstanceSettings(f)?.meta.multiValueFilterOperators,useQueriesAsFilterForOptions:!0,layout:r.$.featureToggles.newFiltersUI?"combobox":void 0});return p.setState({variables:[...p.state.variables,h]}),h}function E(m,f){const p=m.state.filters.findIndex(h=>h.key===f.key&&h.value===f.value&&h.operator!==f.operator);if(p>=0){const h=m.state.filters.slice();h.splice(p,1,f),m.updateFilters(h);return}m.updateFilters([...m.state.filters,f])}},29679:(q,j,e)=>{"use strict";e.d(j,{y:()=>t});function t(n){return"isDashboardLayoutItem"in n}},16045:(q,j,e)=>{"use strict";e.d(j,{e:()=>t});function t(n){return"isDashboardLayoutManager"in n}},93300:(q,j,e)=>{"use strict";e.d(j,{d:()=>n});var t=e(91733);class n extends t.x{static{this.type="dashboard-repeats-processed"}}},25202:(q,j,e)=>{"use strict";e.d(j,{V:()=>s,X:()=>x});var t=e(32370),n=e(39344),r=e(46004),a=e(20708),i=e(10059);async function x(c){let d=n.Ye.templating?.list;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const g=await(0,i.tR)().get();if(g.getTagKeys){const o={type:g.meta.id,uid:g.uid},E={datasource:o,filters:[],name:"Filter",type:"adhoc"},m={datasource:o,name:"Group by",type:"groupby"};d=(d||[]).concat([E,m])}}const u={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...n.Ye,uid:"",title:"New dashboard",panels:[],timezone:t.$.bootData.user?.timezone||n.Ye.timezone}};return d&&(u.dashboard.templating={list:d}),c&&(u.meta.folderUid=c),u}async function s(c){let d=(0,r.hM)().variables;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const g=await(0,i.tR)().get();if(g.getTagKeys){const o={type:g.meta.id,uid:g.uid},E={kind:"AdhocVariable",spec:{...(0,r.IP)(),name:"Filter",datasource:o}},m={kind:"GroupByVariable",spec:{...(0,r.Bj)(),datasource:o,name:"Group by"}};d=(d||[]).concat([E,m])}}const u={apiVersion:"v2alpha0",kind:"DashboardWithAccessInfo",spec:{...(0,r.hM)(),title:"New dashboard",timeSettings:{...(0,r.ft)(),timezone:t.$.bootData.user?.timezone||(0,r.ft)().timezone}},access:{canStar:!1,canShare:!1,canDelete:!1},metadata:{name:"",resourceVersion:"0",creationTimestamp:"0",annotations:{[a.ew]:""}}};return d&&(u.spec.variables=d),c&&u.metadata.annotations&&(u.metadata.annotations[a.ew]=c),u}},83487:(q,j,e)=>{"use strict";e.d(j,{o:()=>n,x:()=>t});const t={name:"grafana",uid:"grafana"},n=1},85388:(q,j,e)=>{"use strict";e.d(j,{B:()=>a});var t=e(62467),n=e(81160),r=e(61034);class a extends r.n8{constructor(x){super({name:"",type:"snapshot",isReadOnly:!0,query:"",value:"",text:"",options:[],...x}),this._variableDependency=new r.Sh(this,{statePaths:[]})}getValueOptions(x){const d=(r.jh.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g)??[]).map(u=>{u=u.replace(/\\,/g,",");const g=/^(.+)\s:\s(.+)$/g.exec(u)??[];if(g.length===3){const[,o,E]=g;return{label:o.trim(),value:E.trim()}}else return{label:u.trim(),value:u.trim()}});return(0,t.of)(d)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,n.T)(x=>(this.state.options!==x&&this._updateValueGivenNewOptions(x),{})))}static{this.Component=({model:x})=>(0,r.yC)(x)}_updateValueGivenNewOptions(x){const{value:s,text:c}=this.state,d={options:x,loading:!1,value:s??[],text:c??[]};this.setState(d)}}},34263:(q,j,e)=>{"use strict";e.d(j,{O:()=>n});var t=e(61034);function n(r){const a=[];for(const i of r){if(!(i instanceof t.tV.g))continue;const x={...i.state.query,enable:!!i.state.isEnabled,hide:!!i.state.isHidden};a.push(x)}return a}},60543:(q,j,e)=>{"use strict";e.d(j,{O:()=>K});var t=e(64015),n=e(32370),r=e(61034),a=e(87638),i=e(72929),x=e(3987),s=e(66110),c=e(86359),d=e(15407),u=e(60101),g=e(63831),o=e(3865),E=e(68643),m=e(83971),f=e(9964),p=e(2044),h=e(83487),D=e(99625);class C{serialize(T,z){return{kind:"GridLayout",spec:{items:l(T,z)}}}deserialize(T,z,w){if(T.kind!=="GridLayout")throw new Error("Invalid layout kind");return new g.D({grid:new r.hy({isLazy:!(w||a.TP.user.authenticatedBy==="render"),children:S(T,z)})})}}function l(V,T){let z=[];for(const w of V.state.grid.state.children)if(w instanceof u.U)w.state.variableName?z=z.concat(b(w,T)):z.push(P(w));else if(w instanceof r.tI){if((0,f.Ry)(w.state.key)&&!T)continue;z.push(y(w,T))}return z}function v(V){if(V.state.$behaviors){for(const T of V.state.$behaviors)if(T instanceof o.L)return{value:T.state.variableName,mode:"variable"}}}function y(V,T=!1){const z=V.state.children.map(w=>{if(!(w instanceof u.U))throw new Error("Unsupported row child type");const H=(w.state.y??0)-(V.state.y??0)-h.o;return P(w,H)});return{kind:"GridLayoutRow",spec:{title:V.state.title,y:V.state.y??0,collapsed:!!V.state.isCollapsed,elements:z,repeat:v(V)}}}function P(V,T){let z,w=0,H=0,G=0,X=0,k=V;if(!(k.state.body instanceof r.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");X=(k.state.variableName?k.state.itemHeight:k.state.height)??0,w=k.state.x??0,H=k.state.y??0,G=k.state.width??0;const _=k.state.variableName,ee=k.state.body.state.key??"DefaultName";if(z={kind:"GridLayoutItem",spec:{x:w,y:T??H,width:G,height:X,element:{kind:"ElementReference",name:ee}}},_){const J={mode:"variable",value:_};k.state.maxPerRow&&(J.maxPerRow=k.getMaxPerRow()),k.state.repeatDirection&&(J.direction=k.getRepeatDirection()),z.spec.repeat=J}if(!z)throw new Error("Unsupported grid item type");return z}function b(V,T=!1){if(T){if(V.state.body instanceof r.Eb&&(0,p.ME)(V.state.body))return[];if(V.state.repeatedPanels){const{h:z,w,columnCount:H}=(0,p.bR)(V);return V.state.repeatedPanels.map((X,k)=>{let _=0,ee=0;V.state.repeatDirection==="v"?(_=V.state.x,ee=k*z):(_=k%H*w,ee=V.state.y+Math.floor(k/H)*z);const J={x:_,y:ee,w,h:z};return{kind:"GridLayoutItem",spec:{x:J.x,y:J.y,width:J.w,height:J.h,repeat:{mode:"variable",value:V.state.variableName,maxPerRow:V.getMaxPerRow(),direction:V.state.repeatDirection},element:{kind:"ElementReference",name:X.state.key}}}})}return[]}else return[P(V)]}function S(V,T){return V.spec.items.map(w=>{if(w.kind==="GridLayoutItem"){const H=T[w.spec.element.name];if(!H)throw new Error(`Panel with uid ${w.spec.element.name} not found in the dashboard elements`);if(H.kind==="Panel")return M(w.spec,H);if(H.kind==="LibraryPanel"){const G=O(H);return new u.U({key:`grid-item-${H.spec.id}`,x:w.spec.x,y:w.spec.y,width:w.spec.width,height:w.spec.height,itemHeight:w.spec.height,body:G})}else throw new Error(`Unknown element kind: ${w.kind}`)}else if(w.kind==="GridLayoutRow"){const H=w.spec.elements.map(X=>{const k=T[X.spec.element.name];if(k.kind==="Panel")return M(X.spec,k,w.spec.y+h.o+X.spec.y);throw new Error(`Unknown element kind: ${X.kind}`)});let G;return w.spec.repeat&&(G=[new o.L({variableName:w.spec.repeat.value})]),new r.tI({y:w.spec.y,isCollapsed:w.spec.collapsed,title:w.spec.title,$behaviors:G,actions:new E.u({}),children:H})}else throw new Error(`Unknown layout element kind: ${w.kind}`)})}function M(V,T,z){const w=(0,D.Gl)(T);return new u.U({key:`grid-item-${T.spec.id}`,x:V.x,y:z??V.y,width:V.repeat?.direction==="h"?24:V.width,height:V.height,itemHeight:V.height,body:w,variableName:V.repeat?.value,repeatDirection:V.repeat?.direction,maxPerRow:V.repeat?.maxPerRow})}function O(V){const T=[];n.$.featureToggles.angularDeprecationUI&&T.push(new d.$L),T.push(new x.$({rawLinks:[],menu:new x.m({$behaviors:[s.oV]})})),T.push(new c.W);const z={key:(0,p.XA)(V.spec.id),titleItems:T,$behaviors:[new i.u({uid:V.spec.libraryPanel.uid,name:V.spec.libraryPanel.name})],extendPanelContext:m.C,pluginId:i.u.LOADING_VIZ_PANEL_PLUGIN_ID,title:V.spec.title,options:{},fieldConfig:{defaults:{},overrides:[]}};return n.$.publicDashboardAccessToken||(z.menu=new r.Lw({$behaviors:[s._i]})),new r.Eb(z)}var R=e(69252),L=e(66345);class B{serialize(T){return{kind:"ResponsiveGridLayout",spec:{col:T.state.layout.state.templateColumns?.toString()??L.g.defaultCSS.templateColumns,row:T.state.layout.state.autoRows?.toString()??L.g.defaultCSS.autoRows,items:T.state.layout.state.children.map(z=>{if(!(z instanceof R.I))throw new Error("Expected ResponsiveGridItem");return{kind:"ResponsiveGridLayoutItem",spec:{element:{kind:"ElementReference",name:z.state?.body?.state.key??"DefaultName"}}}})}}}deserialize(T,z){if(T.kind!=="ResponsiveGridLayout")throw new Error("Invalid layout kind");const w=T.spec.items.map(H=>{const G=z[H.spec.element.name];if(!G)throw new Error(`Panel with uid ${H.spec.element.name} not found in the dashboard elements`);if(G.kind!=="Panel")throw new Error(`Unsupported element kind: ${G.kind}`);return new R.I({key:(0,p.ty)(G.spec.id),body:(0,D.Gl)(G)})});return new L.g({layout:new r.gF({templateColumns:T.spec.col,autoRows:T.spec.row,children:w})})}}var F=e(31763),I=e(85582);class U{serialize(T){return{kind:"RowsLayout",spec:{rows:T.state.rows.map(z=>{const w=(0,D.bP)(z.state.layout);if(w.kind==="RowsLayout")throw new Error("Nested RowsLayout is not supported");return{kind:"RowsLayoutRow",spec:{title:z.state.title,collapsed:z.state.isCollapsed??!1,layout:w}}})}}}deserialize(T,z,w){if(T.kind!=="RowsLayout")throw new Error("Invalid layout kind");const H=T.spec.rows.map(G=>{const X=G.spec.layout;return new F.o({title:G.spec.title,isCollapsed:G.spec.collapsed,layout:K.get(X.kind).serializer.deserialize(X,z,w)})});return new I.V({rows:H})}}var W=e(71811),A=e(8822);class N{serialize(T){return{kind:"TabsLayout",spec:{tabs:T.state.tabs.map(z=>{const w=(0,D.bP)(z.state.layout);if(w.kind==="TabsLayout")throw new Error("Nested TabsLayout is not supported");return{kind:"TabsLayoutTab",spec:{title:z.state.title,layout:w}}})}}}deserialize(T,z,w){if(T.kind!=="TabsLayout")throw new Error("Invalid layout kind");const H=T.spec.tabs.map(G=>{const X=G.spec.layout;return new W.V({title:G.spec.title,layout:K.get(X.kind).serializer.deserialize(X,z,w)})});return new A.K({tabs:H})}}const K=new t.O(()=>[{id:"GridLayout",name:"Grid Layout",serializer:new C},{id:"ResponsiveGridLayout",name:"Responsive Grid Layout",serializer:new B},{id:"RowsLayout",name:"Rows Layout",serializer:new U},{id:"TabsLayout",name:"Tabs Layout",serializer:new N}])},99625:(q,j,e)=>{"use strict";e.d(j,{Gl:()=>m,bP:()=>D});var t=e(32370),n=e(61034),r=e(5956),a=e(79938),i=e(3987),x=e(66110),s=e(86359),c=e(36054),d=e(15407),u=e(83971),g=e(2044),o=e(97910),E=e(60543);function m(C){const l=[];t.$.featureToggles.angularDeprecationUI&&l.push(new d.$L),l.push(new i.$({rawLinks:C.spec.links,menu:new i.m({$behaviors:[x.oV]})})),l.push(new s.W);const v=C.spec.data.spec.queryOptions,y=(v.timeFrom||v.timeShift)&&!v.hideTimeOverride,P={key:(0,g.XA)(C.spec.id),title:C.spec.title,description:C.spec.description,pluginId:C.spec.vizConfig.kind,options:C.spec.vizConfig.spec.options,fieldConfig:(0,o.So)(C.spec.vizConfig.spec.fieldConfig),pluginVersion:C.spec.vizConfig.spec.pluginVersion,displayMode:C.spec.transparent?"transparent":"default",hoverHeader:!C.spec.title&&!y,hoverHeaderOffset:0,$data:f(C),titleItems:l,$behaviors:[],extendPanelContext:u.C};return t.$.publicDashboardAccessToken||(P.menu=new n.Lw({$behaviors:[x._i]})),(v.timeFrom||v.timeShift)&&(P.$timeRange=new c.v({timeFrom:v.timeFrom,timeShift:v.timeShift,hideTimeOverride:v.hideTimeOverride})),new n.Eb(P)}function f(C){const l=C.spec,v=l.data?.spec.queries??[];if(!v?.length||t.$.panels[l.vizConfig.kind]?.skipDataQuery)return;let y;const P=p(C);return y=new n.dt({datasource:P,queries:v.map(h),maxDataPoints:l.data.spec.queryOptions.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:l.data.spec.queryOptions.cacheTimeout,queryCachingTTL:l.data.spec.queryOptions.queryCachingTTL,minInterval:l.data.spec.queryOptions.interval??void 0,dataLayerFilter:{panelId:l.id},$behaviors:[new a.L({})]}),new n.Es({$data:y,transformations:l.data.spec.transformations.map(b=>b.spec)})}function p(C){if(!C.spec.data?.spec.queries?.length)return;let l,v=!1;return C.spec.data.spec.queries.forEach(y=>{l?(l.uid!==y.spec.datasource?.uid||l.type!==y.spec.datasource?.type)&&(v=!0):l=y.spec.datasource}),v?{type:"mixed",uid:r.uv}:void 0}function h(C){return{refId:C.spec.refId,datasource:C.spec.datasource,hide:C.spec.hidden,...C.spec.query.spec}}function D(C){const l=E.O.get(C.descriptor.kind??"");if(!l)throw new Error(`Layout serializer not found for kind: ${C.descriptor.kind}`);return l.serializer.serialize(C)}},33845:(q,j,e)=>{"use strict";e.d(j,{$:()=>g,C:()=>d});var t=e(32370),n=e(61034),r=e(39344),a=e(13076),i=e(46004),x=e(2044),s=e(11686),c=e(32815);function d(o,E){const m=[];for(const f of o.state.variables){const p={name:f.state.name,label:f.state.label,description:f.state.description??void 0,skipUrlSync:!!f.state.skipUrlSync,hide:f.state.hide||r.zL.dontHide,type:f.state.type};if(n.Go.isQueryVariable(f)){let h=[];((0,c.qJ)(f.state.refresh)==="never"||E)&&(h=u(f.state)),m.push({...p,current:{value:f.state.value,text:f.state.text},options:h,query:f.state.query,definition:f.state.definition,datasource:f.state.datasource,sort:f.state.sort,refresh:f.state.refresh,regex:f.state.regex,allValue:f.state.allValue,includeAll:f.state.includeAll,multi:f.state.isMulti,allowCustomValue:f.state.allowCustomValue,skipUrlSync:f.state.skipUrlSync})}else if(n.Go.isCustomVariable(f))m.push({...p,current:{text:f.state.value,value:f.state.value},options:u(f.state),query:f.state.query,multi:f.state.isMulti,allValue:f.state.allValue,includeAll:f.state.includeAll,allowCustomValue:f.state.allowCustomValue});else if(n.Go.isDataSourceVariable(f))m.push({...p,current:{value:f.state.value,text:f.state.text},options:[],regex:f.state.regex,refresh:a.CO.onDashboardLoad,query:f.state.pluginId,multi:f.state.isMulti,allValue:f.state.allValue,includeAll:f.state.includeAll,allowCustomValue:f.state.allowCustomValue});else if(n.Go.isConstantVariable(f))m.push({...p,current:{value:f.state.value,text:f.state.value},query:f.state.value,hide:r.zL.hideVariable});else if(n.Go.isIntervalVariable(f)){const h=(0,x.bx)(f.state.intervals);m.push({...p,current:{text:f.state.value,value:f.state.value},query:h,refresh:f.state.refresh,options:f.state.intervals.map(D=>({value:D,text:D,selected:D===f.state.value})),auto:f.state.autoEnabled,auto_min:f.state.autoMinInterval,auto_count:f.state.autoStepCount})}else if(n.Go.isTextBoxVariable(f)){const h={text:f.state.value,value:f.state.value};m.push({...p,current:h,options:[{...h,selected:!0}],query:f.state.value})}else if(n.Go.isGroupByVariable(f)&&t.$.featureToggles.groupByVariable)m.push({...p,datasource:f.state.datasource,options:f.state.defaultOptions?.map(h=>({text:h.text,value:String(h.value)})),current:{text:f.state.text,value:f.state.value},allowCustomValue:f.state.allowCustomValue});else if(n.Go.isAdHocVariable(f))m.push({...p,datasource:f.state.datasource,allowCustomValue:f.state.allowCustomValue,baseFilters:f.state.baseFilters,filters:f.state.filters,defaultKeys:f.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const f of m)f.hide===r.zL.dontHide&&delete f.hide,f.skipUrlSync||delete f.skipUrlSync,f.label===""&&delete f.label,f.multi||delete f.multi,f.sort===a.ZG.disabled&&delete f.sort;return m}function u(o){return o.options.map(E=>({value:String(E.value),text:E.label,selected:Array.isArray(o.value)?o.value.includes(E.value):o.value===E.value}))}function g(o,E){let m=[];for(const f of o.state.variables){const p={name:f.state.name,label:f.state.label,description:f.state.description??void 0,skipUrlSync:!!f.state.skipUrlSync,hide:(0,c.NB)(f.state.hide)||(0,i.SR)()},h={value:f.state.value,text:f.state.text};let D=[];if(n.Go.isQueryVariable(f)){((0,c.qJ)(f.state.refresh)==="never"||E)&&(D=u(f.state));const C=f.state.query;let l;typeof C!="string"?l={kind:f.state.datasource?.type??(0,s.lD)(C),spec:(0,s.c8)(C)}:l={kind:f.state.datasource?.type??(0,s.lD)(C),spec:{[c.sB]:C}};const v={kind:"QueryVariable",spec:{...p,current:h,options:D,query:l,definition:f.state.definition,datasource:f.state.datasource||{},sort:(0,c.LY)(f.state.sort),refresh:(0,c.qJ)(f.state.refresh),regex:f.state.regex,allValue:f.state.allValue,includeAll:f.state.includeAll||!1,multi:f.state.isMulti||!1,skipUrlSync:f.state.skipUrlSync||!1}};m.push(v)}else if(n.Go.isCustomVariable(f)){D=u(f.state);const C={kind:"CustomVariable",spec:{...p,current:h,options:D,query:f.state.query,multi:f.state.isMulti||!1,allValue:f.state.allValue,includeAll:f.state.includeAll??!1}};m.push(C)}else if(n.Go.isDataSourceVariable(f)){const C={kind:"DatasourceVariable",spec:{...p,current:h,options:[],regex:f.state.regex,refresh:"onDashboardLoad",pluginId:f.state.pluginId,multi:f.state.isMulti||!1,includeAll:f.state.includeAll||!1}};f.state.allValue!==void 0&&(C.spec.allValue=f.state.allValue),m.push(C)}else if(n.Go.isConstantVariable(f)){const C={kind:"ConstantVariable",spec:{...p,current:{...h,text:String(f.state.value)},query:f.state.value}};m.push(C)}else if(n.Go.isIntervalVariable(f)){const C=(0,x.bx)(f.state.intervals),l={kind:"IntervalVariable",spec:{...p,current:{...h,text:f.state.value},query:C,refresh:"onTimeRangeChanged",options:f.state.intervals.map(v=>({value:v,text:v,selected:v===f.state.value})),auto:f.state.autoEnabled,auto_min:f.state.autoMinInterval,auto_count:f.state.autoStepCount}};m.push(l)}else if(n.Go.isTextBoxVariable(f)){const C={text:f.state.value,value:f.state.value},l={kind:"TextVariable",spec:{...p,current:C,query:f.state.value}};m.push(l)}else if(n.Go.isGroupByVariable(f)&&t.$.featureToggles.groupByVariable){D=u(f.state);const C={kind:"GroupByVariable",spec:{...p,datasource:f.state.datasource||{},options:f.state.defaultOptions?.map(l=>({text:l.text,value:String(l.value)}))||[],current:h,multi:f.state.isMulti||!1}};m.push(C)}else if(n.Go.isAdHocVariable(f)){const C={kind:"AdhocVariable",spec:{...p,name:f.state.name,datasource:f.state.datasource||{},baseFilters:f.state.baseFilters||[],filters:f.state.filters,defaultKeys:f.state.defaultKeys||[]}};m.push(C)}else throw new Error("Unsupported variable type: "+f.state.type)}return m}},47506:(q,j,e)=>{"use strict";e.d(j,{tt:()=>_,EH:()=>k,A2:()=>ee,wM:()=>H});var t=e(2543),n=e(32370),r=e(56276),a=e(18729),i=e(61034),x=e(87638),s=e(36503),c=e(63845),d=e(4981),u=e(82991),g=e(62652),o=e(51085),E=e(7001),m=e(65302),f=e(12035),p=e(11997),h=e(60887),D=e(72929),C=e(3987),l=e(66110),v=e(86359),y=e(36054),P=e(15407),b=e(60101),S=e(63831),M=e(3865),O=e(68643),R=e(83971),L=e(78974),B=e(79556),F=e(83424),I=e(2044),U=e(98437),W=e(85388);const A="default";function N(ae){const re=ae.templating.list.map(ne=>{try{return T(ne)}catch(ce){return console.error(ce),null}}).filter(ne=>!!ne);return new i.Pj({variables:re})}function K(ae){const re=ae.templating.list.map(ne=>{try{return ne.type==="adhoc"?new i.H9({name:ne.name,label:ne.label,readOnly:!0,description:ne.description,skipUrlSync:ne.skipUrlSync,hide:ne.hide,datasource:ne.datasource,applyMode:"auto",filters:ne.filters??[],baseFilters:ne.baseFilters??[],defaultKeys:ne.defaultKeys,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,U.l)().getInstanceSettings(ne.datasource)?.meta.multiValueFilterOperators}):V(ne)}catch(ce){return console.error(ce),null}}).filter(ne=>!!ne);return new i.Pj({variables:re})}function V(ae){let re,ne;if(ae.type==="interval"){const ce=(0,I.Sm)(ae.query),le=(0,I.pk)(ae,ce);return re=new W.B({name:ae.name,label:ae.label,description:ae.description,value:le,text:le,hide:ae.hide}),re}return ae.type==="system"||ae.type==="constant"||ae.type==="adhoc"?ne={value:"",text:""}:ne={value:ae.current?.value??"",text:ae.current?.text??""},re=new W.B({name:ae.name,label:ae.label,description:ae.description,value:ne?.value??"",text:ne?.text??"",hide:ae.hide}),re}function T(ae){const re={name:ae.name,label:ae.label,description:ae.description};if(ae.type==="adhoc")return new i.H9({...re,description:ae.description,skipUrlSync:ae.skipUrlSync,hide:ae.hide,datasource:ae.datasource,applyMode:"auto",filters:ae.filters??[],baseFilters:ae.baseFilters??[],defaultKeys:ae.defaultKeys,allowCustomValue:ae.allowCustomValue,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,U.l)().getInstanceSettings(ae.datasource)?.meta.multiValueFilterOperators});if(ae.type==="custom")return new i.yP({...re,value:ae.current?.value??"",text:ae.current?.text??"",query:ae.query,isMulti:ae.multi,allValue:ae.allValue||void 0,includeAll:ae.includeAll,defaultToAll:!!ae.includeAll,skipUrlSync:ae.skipUrlSync,hide:ae.hide,allowCustomValue:ae.allowCustomValue});if(ae.type==="query")return new i.fS({...re,value:ae.current?.value??"",text:ae.current?.text??"",query:ae.query,datasource:ae.datasource,sort:ae.sort,refresh:ae.refresh,regex:ae.regex,allValue:ae.allValue||void 0,includeAll:ae.includeAll,defaultToAll:!!ae.includeAll,isMulti:ae.multi,skipUrlSync:ae.skipUrlSync,hide:ae.hide,definition:ae.definition,allowCustomValue:ae.allowCustomValue});if(ae.type==="datasource")return new i.mI({...re,value:ae.current?.value??"",text:ae.current?.text??"",regex:ae.regex,pluginId:ae.query,allValue:ae.allValue||void 0,includeAll:ae.includeAll,defaultToAll:!!ae.includeAll,skipUrlSync:ae.skipUrlSync,isMulti:ae.multi,hide:ae.hide,defaultOptionEnabled:ae.current?.value===A&&ae.current?.text==="default",allowCustomValue:ae.allowCustomValue});if(ae.type==="interval"){const ne=(0,I.Sm)(ae.query),ce=(0,I.pk)(ae,ne);return new i.Yj({...re,value:ce,intervals:ne,autoEnabled:ae.auto,autoStepCount:ae.auto_count,autoMinInterval:ae.auto_min,refresh:ae.refresh,skipUrlSync:ae.skipUrlSync,hide:ae.hide})}else{if(ae.type==="constant")return new i.x0({...re,value:ae.query,skipUrlSync:ae.skipUrlSync,hide:ae.hide});if(ae.type==="textbox"){let ne;return ae?.current?.value?typeof ae.current.value=="string"?ne=ae.current.value:ne=ae.current.value[0]:ne=ae.query,new i.TS({...re,value:ne,skipUrlSync:ae.skipUrlSync,hide:ae.hide})}else{if(n.$.featureToggles.groupByVariable&&ae.type==="groupby")return new i.ZG({...re,datasource:ae.datasource,value:ae.current?.value||[],text:ae.current?.text||[],skipUrlSync:ae.skipUrlSync,hide:ae.hide,defaultOptions:ae.options,allowCustomValue:ae.allowCustomValue});throw new Error(`Scenes: Unsupported variable type ${ae.type}`)}}}function z(ae){return function(ne,ce){if(ce.angularPanelCtrl){ne.options={angularOptions:ae.getOptionsToRemember()};return}if(!ae.options||Object.keys(ae.options).length===0){(0,t.defaults)(ne,ae.getOptionsToRemember());const le=(0,t.cloneDeep)(ae.targets);Object.defineProperty(ne,"targets",{get:function(){return console.warn("Accessing the targets property when migrating a panel plugin is deprecated. Changes to this property will be ignored."),le}})}if(ae.autoMigrateFrom){const le=c.NB[ae.autoMigrateFrom]!=null,he=ae.getOptionsToRemember(),oe=ae.autoMigrateFrom;if(ce.onPanelTypeChanged){const de=le?{angular:he}:he.options;Object.assign(ne.options,ce.onPanelTypeChanged(ne,oe,de,ne.fieldConfig))}}}}var w=e(83487);function H(ae){const re=new s.G(ae.dashboard,ae.meta),ne=k(re,ae.dashboard);return ne.setInitialSaveModel(ae.dashboard),ne}function G(ae){const re=[];let ne=null,ce=[];for(const le of ae)if(le.type==="row")ne?ne.id!==le.id&&(re.push(X(ne,ce)),le.collapsed?(re.push(X(le,[])),ne=null):ne=le,ce=[]):le.collapsed?re.push(X(le,[])):ne=le;else{le.snapshotData&&Z(le);const he=_(le);ne?ce.push(he):re.push(he)}return ne&&re.push(X(ne,ce)),re}function X(ae,re){ae.collapsed&&ae.panels&&(re=ae.panels.map(le=>(le instanceof c.a9||(le=new c.a9(le)),_(le))));let ne,ce=re;return ae.repeat&&(ne=[new M.L({variableName:ae.repeat})]),new i.tI({key:(0,I.XA)(ae.id),title:ae.title,y:ae.gridPos.y,isCollapsed:ae.collapsed,children:ce,$behaviors:ne,actions:new O.u({})})}function k(ae,re){let ne,ce=[],le;const he=re.uid;ae.templating?.list?.length?ae.meta.isSnapshot?ne=K(ae):ne=N(ae):ne=new i.Pj({variables:[]}),ae.annotations?.list?.length&&!ae.isSnapshot()&&(ce=ae.annotations?.list.map(Ee=>new g.g({key:(0,t.uniqueId)("annotations-"),query:Ee,name:Ee.name,isEnabled:!!Ee.enable,isHidden:!!Ee.hide})));let oe=n.$.unifiedAlertingEnabled;oe||ae.panels.find(Ee=>!!Ee.alert)&&(oe=!0),oe&&(le=new u.C({key:"alert-states",name:"Alert States"}));const de=n.$.featureToggles.scopeFilters&&ae.scopeMeta?{trait:ae.scopeMeta.trait,groups:ae.scopeMeta.groups}:void 0,me=[new i.Gg.K2({sync:ae.graphTooltip}),new i.Gg.Hf({enableProfiling:n.$.dashboardPerformanceMetrics.findIndex(Ee=>Ee==="*"||Ee===ae.uid)!==-1,onProfileComplete:te(ae.uid,ae.title)}),m.M,ee,new i.Gg.en({enabled:ae.liveNow}),B.zf,d.U,new h.m({reloadOnParamsChange:n.$.featureToggles.reloadDashboardsOnParamsChange&&ae.meta.reloadOnParamsChange,uid:he}),new f.s({reloadOnParamsChange:n.$.featureToggles.reloadDashboardsOnParamsChange&&ae.meta.reloadOnParamsChange,uid:he,version:ae.version})];return new p.H$({uid:he,description:ae.description,editable:ae.editable,preload:re.preload??!1,id:ae.id,isDirty:!1,links:ae.links||[],meta:ae.meta,tags:ae.tags||[],title:ae.title,version:ae.version,scopeMeta:de,body:new S.D({grid:new i.hy({isLazy:!(re.preload||x.TP.user.authenticatedBy==="render"),children:G(ae.panels)})}),$timeRange:new i.JZ({from:ae.time.from,to:ae.time.to,fiscalYearStartMonth:ae.fiscalYearStartMonth,timeZone:ae.timezone,weekStart:ae.weekStart,UNSAFE_nowDelay:ae.timepicker?.nowDelay}),$variables:ne,$behaviors:me,$data:new E.s({annotationLayers:ce,alertStatesLayer:le}),controls:new o.x({variableControls:[new i.K8({}),new i.i7],timePicker:new i.KE({}),refreshPicker:new i.WM({refresh:ae.refresh,intervals:ae.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ae.timepicker.hidden})})}function _(ae){const re=ae.repeat?{variableName:ae.repeat,repeatDirection:ae.repeatDirection==="v"?"v":"h"}:{},ne=[];n.$.featureToggles.angularDeprecationUI&&ne.push(new P.$L),ne.push(new C.$({rawLinks:ae.links,menu:new C.m({$behaviors:[l.oV]})})),ne.push(new v.W);const ce=(ae.timeFrom||ae.timeShift)&&!ae.hideTimeOverride,le={key:(0,I.XA)(ae.id),title:ae.title,description:ae.description,pluginId:ae.type??"timeseries",options:ae.options??{},fieldConfig:ae.fieldConfig,pluginVersion:ae.pluginVersion,displayMode:ae.transparent?"transparent":void 0,hoverHeader:!ae.title&&!ce,hoverHeaderOffset:0,$data:(0,L.w)(ae),titleItems:ne,$behaviors:[],extendPanelContext:R.C,_UNSAFE_customMigrationHandler:z(ae)};ae.libraryPanel&&(le.$behaviors.push(new D.u({uid:ae.libraryPanel.uid,name:ae.libraryPanel.name})),le.pluginId=D.u.LOADING_VIZ_PANEL_PLUGIN_ID,le.$data=void 0),n.$.publicDashboardAccessToken||(le.menu=new i.Lw({$behaviors:[l._i]})),(ae.timeFrom||ae.timeShift)&&(le.$timeRange=new y.v({timeFrom:ae.timeFrom,timeShift:ae.timeShift,hideTimeOverride:ae.hideTimeOverride}));const he=new i.Eb(le);return new b.U({key:`grid-item-${ae.id}`,x:ae.gridPos.x,y:ae.gridPos.y,width:re.repeatDirection==="h"?24:ae.gridPos.w,height:ae.gridPos.h,itemHeight:ae.gridPos.h,body:he,maxPerRow:ae.maxPerRow,...re})}function ee(ae){ae.subscribeToEvent(i.Kw,re=>{const{interaction:ne}=re.payload;switch(ne){case"panel-status-message-clicked":F.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":F.c.panelCancelQueryClicked();break}})}const J=ae=>ae.map(re=>({data:{values:re.fields.map(ne=>ne.values).filter(ne=>ne!==void 0)},schema:{fields:re.fields.map(ne=>({name:ne.name,type:ne.type,config:ne.config}))}})),Z=ae=>{ae.snapshotData&&(ae.datasource=w.x,ae.targets=[{refId:ae.snapshotData[0]?.refId??"",datasource:ae.datasource,queryType:"snapshot",snapshot:J(ae.snapshotData)}],ae.snapshotData=[])};function te(ae,re){return ne=>{let ce="";ne.origin==="SceneTimeRange"?ce="time-range-change":ne.origin==="SceneRefreshPicker"?ce="refresh":ne.origin==="DashboardScene"?ce="view":ne.origin.indexOf("Variable")>-1&&(ce="variable-change"),(0,r.rR)("dashboard-render",{interactionType:ce,duration:ne.duration,networkDuration:ne.networkDuration,totalJSHeapSize:ne.totalJSHeapSize,usedJSHeapSize:ne.usedJSHeapSize,jsHeapSizeLimit:ne.jsHeapSizeLimit}),(0,a.l$)(`dashboard.${ce}`,{duration:ne.duration,networkDuration:ne.networkDuration,totalJSHeapSize:ne.totalJSHeapSize,usedJSHeapSize:ne.usedJSHeapSize,jsHeapSizeLimit:ne.jsHeapSizeLimit,timeSinceBoot:performance.measure("time_since_boot","frontend_boot_js_done_time_seconds").duration},{dashboard:ae,title:re})}}},10817:(q,j,e)=>{"use strict";e.d(j,{Uy:()=>y,Z6:()=>b,ZB:()=>P,c:()=>R});var t=e(2543),n=e.n(t),r=e(34923),a=e(61034),i=e(39344),x=e(13076),s=e(31788),c=e(5573),d=e(5597),u=e(92980),g=e(7001),o=e(36054),E=e(60101),m=e(63831),f=e(3865),p=e(9964),h=e(18745),D=e(2044),C=e(83487),l=e(34263),v=e(33845);function y(B,F=!1){const I=B.state,U=I.$timeRange.state,W=I.$data,A=I.$variables,N=I.body;let K=[],V=[];if(N instanceof m.D){for(const _ of N.state.grid.state.children)if(_ instanceof E.U&&(_.state.variableName?K=K.concat(M(_,F)):K.push(P(_,F))),_ instanceof a.tI){if((0,p.Ry)(_.state.key)&&!F)continue;O(_,K,F)}}let T=[];W instanceof g.s&&(T=(0,l.O)(W.state.annotationLayers)),A instanceof a.Pj&&(V=(0,v.C)(A));const z=I.controls?.state,w=z?.refreshPicker,H=L({refresh_intervals:w?.state.intervals,hidden:z?.hideTimeControls,nowDelay:U.UNSAFE_nowDelay},i.lt),G=I.$behaviors?.find(_=>_ instanceof a.Gg.K2)?.state.sync??i.Ye.graphTooltip,X=I.$behaviors?.find(_=>_ instanceof a.Gg.en)?.isEnabled||void 0,k={...i.Ye,title:I.title,description:I.description||void 0,uid:I.uid,id:I.id,editable:I.editable,preload:I.preload,time:{from:U.from,to:U.to},timepicker:H,panels:K,annotations:{list:T},templating:{list:V},version:I.version,timezone:U.timeZone,fiscalYearStartMonth:U.fiscalYearStartMonth,weekStart:U.weekStart,tags:I.tags,links:I.links,graphTooltip:G,liveNow:X,schemaVersion:d.O2,refresh:w?.state.refresh,scopeMeta:I.scopeMeta};return(0,s.v)(k)}function P(B,F=!1){let I,U=0,W=0,A=0,N=0,K=B;if(!(K.state.body instanceof a.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(I=K.state.body,U=K.state.x??0,W=K.state.y??0,A=K.state.width??0,N=(K.state.variableName?K.state.itemHeight:K.state.height)??0,!I)throw new Error("Unsupported grid item type");return b(I,{x:U,y:W,h:N,w:A},F,K)}function b(B,F,I=!1,U){let W;if((0,D.ME)(B)){const K=(0,D.iL)(B);return W={id:(0,D.Cs)(B),title:B.state.title,gridPos:F,libraryPanel:{name:K.state.name,uid:K.state.uid},type:"library-panel-ref"},W}else W={id:(0,D.Cs)(B),type:B.state.pluginId,title:B.state.title,description:B.state.description??void 0,gridPos:F,fieldConfig:B.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:B.state.displayMode==="transparent",pluginVersion:B.state.pluginVersion,...S(B,I)};if(B.state.options){const{angularOptions:K,...V}=B.state.options;W.options=V,K&&(0,t.defaults)(W,K)}const A=B.state.$timeRange;A instanceof o.v&&(W.timeFrom=A.state.timeFrom,W.timeShift=A.state.timeShift,W.hideTimeOverride=A.state.hideTimeOverride),U instanceof E.U&&(U.state.variableName&&(W.repeat=U.state.variableName),U.state.maxPerRow&&(W.maxPerRow=U.state.maxPerRow),U.state.repeatDirection&&(W.repeatDirection=U.getRepeatDirection()));const N=h.b4.getPanelLinks(B);return W.links=N?.state.rawLinks??[],W.links.length===0&&delete W.links,W.transformations?.length===0&&delete W.transformations,W.transparent||delete W.transparent,W}function S(B,F=!1){const I=B.state.$data,U={},W=(0,D.un)(B);if(W&&(U.targets=W.state.queries,U.maxDataPoints=W.state.maxDataPoints,U.datasource=W.state.datasource,W.state.cacheTimeout&&(U.cacheTimeout=W.state.cacheTimeout),W.state.queryCachingTTL&&(U.queryCachingTTL=W.state.queryCachingTTL),W.state.minInterval&&(U.interval=W.state.minInterval)),I instanceof a.Es&&(U.transformations=I.state.transformations),I&&F){U.datasource=C.x;let A=(0,c.B6)(I.state.data);I instanceof a.Es&&(A=(0,c.B6)(I.state.$data.state.data)),U.targets=[{refId:"A",datasource:U.datasource,queryType:u.nj.Snapshot,snapshot:A}]}return U}function M(B,F=!1){if(F){if(B.state.body instanceof a.Eb&&(0,D.ME)(B.state.body)){const{x:I=0,y:U=0,width:W=0,height:A=0}=B.state;return[b(B.state.body,{x:I,y:U,w:W,h:A},F)]}if(B.state.repeatedPanels){const{h:I,w:U,columnCount:W}=(0,D.bR)(B);return B.state.repeatedPanels.map((N,K)=>{let V=0,T=0;B.state.repeatDirection==="v"?(V=B.state.x,T=K*I):(V=K%W*U,T=B.state.y+Math.floor(K/W)*I);const z={x:V,y:T,w:U,h:I},w=N.state.$variables.getByName(B.state.variableName);return{id:(0,D.Cs)(N),type:N.state.pluginId,title:N.state.title,gridPos:z,options:N.state.options,fieldConfig:N.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:N.state.displayMode==="transparent",scopedVars:{[B.state.variableName]:{text:w?.state.text,value:w?.state.value}},...S(N,F)}})}return[]}else return[P(B)]}function O(B,F,I=!1){const U=!!B.state.isCollapsed,W={type:"row",id:(0,D.Cs)(B),title:B.state.title,gridPos:{x:B.state.x??0,y:B.state.y??0,w:B.state.width??24,h:B.state.height??1},collapsed:U,panels:[]};if(B.state.$behaviors?.length){const N=B.state.$behaviors[0];N instanceof f.L&&(W.repeat=N.state.variableName)}if(I&&B.state.$variables){const K=B.state.$variables.state.variables.reduce((V,T)=>({...V,[T.state.name]:{text:T.state.text,value:T.state.value}}),{});W.scopedVars=K}F.push(W);let A=[];I?B.state.children.forEach(N=>{N instanceof E.U&&(N.state.variableName?A=A.concat(M(N,!U)):A.push(P(N,!U)))}):A=B.state.children.map(N=>{if(!(N instanceof E.U))throw new Error("Row child expected to be DashboardGridItem");return P(N)}),B.state.isCollapsed?W.panels=A:F.push(...A)}function R(B,F,I,U){let W={...I,title:B,time:{from:F.from.toISOString(),to:F.to.toISOString()},links:[]};if(U){const A=I.panels?.find(N=>N.id===(0,D.Cs)(U));A&&(A.gridPos={w:24,x:0,y:0,h:20},W={...W,panels:[A]})}if(W.panels?.forEach(A=>{"links"in A&&(A.links=[])}),W.annotations){const N=(W.annotations.list?.filter(K=>K.enable)||[]).map(K=>({name:K.name,enable:K.enable,iconColor:K.iconColor,type:K.type,builtIn:K.builtIn,hide:K.hide,snapshotData:[]}));W.annotations.list=N}return W.templating&&W.templating.list?.forEach(A=>{"query"in A&&(A.query=""),"options"in A&&(A.options=A.current&&!(0,r.R)(A.current)?[A.current]:[]),"refresh"in A&&(A.refresh=x.CO.never)}),W}function L(B,F){const I={...B};for(const U in F)(0,t.isEqual)(I[U],F[U])&&delete I[U];return I}},11686:(q,j,e)=>{"use strict";e.d(j,{Ic:()=>R,Xl:()=>m,c8:()=>v,lD:()=>l});var t=e(2543),n=e.n(t),r=e(32370),a=e(61034),i=e(31788),x=e(46004),s=e(7001),c=e(36054),d=e(18745),u=e(2044),g=e(99625),o=e(33845),E=e(32815);function m(I,U=!1){const W=I.state,A=W.$timeRange.state,N=W.controls?.state,K=N?.refreshPicker,V={title:W.title,description:W.description,cursorSync:f(W),liveNow:p(W),preload:W.preload,editable:W.editable,links:W.links,tags:W.tags,timeSettings:{timezone:A.timeZone,from:A.from,to:A.to,autoRefresh:K?.state.refresh||"",autoRefreshIntervals:K?.state.intervals,hideTimepicker:N?.hideTimeControls??!1,weekStart:A.weekStart,fiscalYearStartMonth:A.fiscalYearStartMonth,nowDelay:A.UNSAFE_nowDelay},variables:S(W),elements:h(W),annotations:M(W),layout:(0,g.bP)(W.body)};try{if(L(V))return(0,i.v)(V);throw new Error("Error we could transform the dashboard to schema v2: "+V)}catch(T){throw console.error("Error transforming dashboard to schema v2: "+T,V),new Error("Error transforming dashboard to schema v2: "+T)}}function f(I){const U=I.$behaviors?.find(W=>W instanceof a.Gg.K2)?.state.sync;return(0,E.k6)(U)}function p(I){const U=I.$behaviors?.find(W=>W instanceof a.Gg.en)?.isEnabled||void 0;return U===void 0?!!(0,x.hM)().liveNow:!!U}function h(I){const W=(I.body.getVizPanels()??[]).map(A=>{if((0,u.ME)(A)){const N=(0,u.iL)(A);return{kind:"LibraryPanel",spec:{id:(0,u.Cs)(A),title:A.state.title,libraryPanel:{uid:N.state.uid,name:N.state.name}}}}else{const N=A.state.fieldConfig.defaults.color;let K;if(N){const X=(0,E.Jc)(N.mode);X&&(K={...N,mode:X})}const V=A.state.fieldConfig.defaults.decimals??void 0,T=A.state.fieldConfig.defaults.min??void 0,z=A.state.fieldConfig.defaults.max??void 0,w=Object.fromEntries(Object.entries({...A.state.fieldConfig.defaults,decimals:V,min:T,max:z,color:K}).filter(([X,k])=>k!==void 0)),H={...A.state.fieldConfig,defaults:w};return{kind:"Panel",spec:{id:(0,u.Cs)(A),title:A.state.title,description:A.state.description??"",links:D(A),data:{kind:"QueryGroup",spec:{queries:C(A),transformations:y(A),queryOptions:P(A)}},vizConfig:{kind:A.state.pluginId,spec:{pluginVersion:A.state.pluginVersion??"",options:A.state.options,fieldConfig:H??(0,x.bt)()}}}}}});return b(W)}function D(I){const U=d.b4.getPanelLinks(I);return U?U.state.rawLinks??[]:[]}function C(I){const U=[],W=(0,u.un)(I),A=W?.state.queries,N=W?.state.datasource??R();return A&&A.forEach(K=>{const V={kind:l(K),spec:(0,t.omit)(K,"datasource","refId","hide")},T={datasource:K.datasource??N,query:V,refId:K.refId,hidden:!!K.hide};U.push({kind:"PanelQuery",spec:T})}),U}function l(I){return typeof I=="string"?R()?.type??"":I.datasource?.type??R()?.type??""}function v(I){return I}function y(I){let U=[];const W=I.state.$data;if(W instanceof a.Es){const A=W.state.transformations;if(A.length===0)return[];for(const N of A){const K=N;if("id"in K){const V={id:K.id,disabled:K.disabled,filter:{id:K.filter?.id??"",options:K.filter?.options??{}},...K.topic&&{topic:K.topic},options:K.options};U.push({kind:K.id,spec:V})}else throw new Error("Unsupported transformation type")}}return U}function P(I){let U={};const W=(0,u.un)(I);W&&(U.maxDataPoints=W.state.maxDataPoints,W.state.cacheTimeout&&(U.cacheTimeout=W.state.cacheTimeout),W.state.queryCachingTTL&&(U.queryCachingTTL=W.state.queryCachingTTL),W.state.minInterval&&(U.interval=W.state.minInterval));const A=I.state.$timeRange;return A instanceof c.v&&(U.timeFrom=A.state.timeFrom,U.timeShift=A.state.timeShift,U.hideTimeOverride=A.state.hideTimeOverride),U}function b(I){return I.reduce((U,W)=>(U[(0,u.XA)(W.spec.id)]=W,U),{})}function S(I){const U=I.$variables;let W=[];return U instanceof a.Pj&&(W=(0,o.$)(U)),W}function M(I){const U=I.$data;if(!(U instanceof s.s))return[];const W=[];for(const A of U.state.annotationLayers){if(!(A instanceof a.tV.g))continue;const N={kind:"AnnotationQuery",spec:{builtIn:!!A.state.query.builtIn,name:A.state.query.name,datasource:A.state.query.datasource||R(),enable:!!A.state.isEnabled,hide:!!A.state.isHidden,iconColor:A.state.query.iconColor}},K=O(A.state.query);A.state.query.query?.kind===K&&(N.spec.query={kind:K,spec:A.state.query.query.spec}),A.state.query.filter?.ids?.length&&(N.spec.filter=A.state.query.filter),W.push(N)}return W}function O(I){if(I.datasource?.type)return I.datasource.type;{const U=R();return U?U.type:"grafana"}}function R(){const I=r.$.bootData.settings.defaultDatasource,W=r.$.bootData.settings.datasources[I];return{type:W.meta.id,uid:W.name}}function L(I){if(typeof I!="object"||I===null)throw new Error("Dashboard is not an object or is null");if("title"in I&&typeof I.title!="string")throw new Error("Title is not a string");if("description"in I&&I.description!==void 0&&typeof I.description!="string")throw new Error("Description is not a string");if("cursorSync"in I&&typeof I.cursorSync!="string"){const U=["Off","Crosshair","Tooltip"];if("cursorSync"in I&&(typeof I.cursorSync!="string"||!U.includes(I.cursorSync)))throw new Error("CursorSync is not a string")}if("liveNow"in I&&typeof I.liveNow!="boolean")throw new Error("LiveNow is not a boolean");if("preload"in I&&typeof I.preload!="boolean")throw new Error("Preload is not a boolean");if("editable"in I&&typeof I.editable!="boolean")throw new Error("Editable is not a boolean");if("links"in I&&!Array.isArray(I.links))throw new Error("Links is not an array");if("tags"in I&&!Array.isArray(I.tags))throw new Error("Tags is not an array");if("id"in I&&I.id!==void 0&&typeof I.id!="number")throw new Error("ID is not a number");if(!("timeSettings"in I)||typeof I.timeSettings!="object"||I.timeSettings===null)throw new Error("TimeSettings is not an object or is null");if(!("timezone"in I.timeSettings)||typeof I.timeSettings.timezone!="string")throw new Error("Timezone is not a string");if(!("from"in I.timeSettings)||typeof I.timeSettings.from!="string")throw new Error("From is not a string");if(!("to"in I.timeSettings)||typeof I.timeSettings.to!="string")throw new Error("To is not a string");if(!("autoRefresh"in I.timeSettings)||typeof I.timeSettings.autoRefresh!="string")throw new Error("AutoRefresh is not a string");if(!("autoRefreshIntervals"in I.timeSettings)||!Array.isArray(I.timeSettings.autoRefreshIntervals))throw new Error("AutoRefreshIntervals is not an array");if("quickRanges"in I.timeSettings&&I.timeSettings.quickRanges&&!Array.isArray(I.timeSettings.quickRanges))throw new Error("QuickRanges is not an array");if(!("hideTimepicker"in I.timeSettings)||typeof I.timeSettings.hideTimepicker!="boolean")throw new Error("HideTimepicker is not a boolean");if("weekStart"in I.timeSettings&&typeof I.timeSettings.weekStart=="string"&&!["saturday","sunday","monday"].includes(I.timeSettings.weekStart))throw new Error('WeekStart should be one of "saturday", "sunday" or "monday"');if(!("fiscalYearStartMonth"in I.timeSettings)||typeof I.timeSettings.fiscalYearStartMonth!="number")throw new Error("FiscalYearStartMonth is not a number");if("nowDelay"in I.timeSettings&&I.timeSettings.nowDelay!==void 0&&typeof I.timeSettings.nowDelay!="string")throw new Error("NowDelay is not a string");if(!("variables"in I)||!Array.isArray(I.variables))throw new Error("Variables is not an array");if(!("elements"in I)||typeof I.elements!="object"||I.elements===null)throw new Error("Elements is not an object or is null");if(!("annotations"in I)||!Array.isArray(I.annotations))throw new Error("Annotations is not an array");if(!("layout"in I)||typeof I.layout!="object"||I.layout===null)throw new Error("Layout is not an object or is null");return(!("kind"in I.layout)||I.layout.kind==="GridLayout")&&B(I.layout),(!("kind"in I.layout)||I.layout.kind==="RowsLayout")&&F(I.layout),!0}function B(I){if(typeof I!="object"||I===null)throw new Error("Layout is not an object or is null");if(!("kind"in I)||I.kind!=="GridLayout")throw new Error("Layout kind is not GridLayout");if(!("spec"in I)||typeof I.spec!="object"||I.spec===null)throw new Error("Layout spec is not an object or is null");if(!("items"in I.spec)||!Array.isArray(I.spec.items))throw new Error("Layout spec items is not an array")}function F(I){if(typeof I!="object"||I===null)throw new Error("Layout is not an object or is null");if(!("kind"in I)||I.kind!=="RowsLayout")throw new Error("Layout kind is not RowsLayout");if(!("spec"in I)||typeof I.spec!="object"||I.spec===null)throw new Error("Layout spec is not an object or is null");if(!("rows"in I.spec)||!Array.isArray(I.spec.rows))throw new Error("Layout spec items is not an array")}},97910:(q,j,e)=>{"use strict";e.d(j,{ES:()=>x,So:()=>d,Y_:()=>s,cc:()=>i,tH:()=>a});var t=e(65329),n=e(13076),r=e(39344);function a(u){switch(u){case"never":return n.CO.never;case"onDashboardLoad":return n.CO.onDashboardLoad;case"onTimeRangeChanged":return n.CO.onTimeRangeChanged;default:return n.CO.never}}function i(u){switch(u){case"dontHide":return r.zL.dontHide;case"hideLabel":return r.zL.hideLabel;case"hideVariable":return r.zL.hideVariable;default:return r.zL.dontHide}}function x(u){switch(u){case"disabled":return n.ZG.disabled;case"numericalAsc":return n.ZG.numericalAsc;case"alphabeticalCaseInsensitiveAsc":return n.ZG.alphabeticalCaseInsensitiveAsc;case"alphabeticalCaseInsensitiveDesc":return n.ZG.alphabeticalCaseInsensitiveDesc;case"numericalDesc":return n.ZG.numericalDesc;case"naturalAsc":return n.ZG.naturalAsc;case"naturalDesc":return n.ZG.naturalDesc;case"alphabeticalAsc":return n.ZG.alphabeticalAsc;case"alphabeticalDesc":return n.ZG.alphabeticalDesc;default:return n.ZG.disabled}}function s(u){switch(u){case"Crosshair":return n.yV.Crosshair;case"Tooltip":return n.yV.Tooltip;case"Off":return n.yV.Off;default:return n.$C}}function c(u){switch(u){case"true":return t.W.True;case"false":return t.W.False;case"null":return t.W.Null;case"nan":return t.W.NaN;case"null+nan":return t.W.NullAndNaN;case"empty":return t.W.Empty;default:throw new Error(`Unknown match type: ${u}`)}}function d(u){const g=E=>{switch(E){case"absolute":return n.Ol.Absolute;case"percentage":return n.Ol.Percentage;default:return n.Ol.Absolute}},o={...u.defaults};return u.defaults.mappings&&(o.mappings=u.defaults.mappings.map(E=>{switch(E.type){case"value":return{...E,type:n.dM.ValueToText};case"range":return{...E,type:n.dM.RangeToText};case"regex":return{...E,type:n.dM.RegexToText};case"special":return{...E,options:{...E.options,match:c(E.options.match)},type:n.dM.SpecialValue};default:return E}})),u.defaults.thresholds&&(o.thresholds={...u.defaults.thresholds,mode:g(u.defaults.thresholds.mode)}),{...u,defaults:o}}},32815:(q,j,e)=>{"use strict";e.d(j,{Jc:()=>u,LY:()=>c,MM:()=>d,NB:()=>s,k6:()=>i,qJ:()=>x,sB:()=>a});var t=e(7500),n=e(13076),r=e(46004);const a="__legacyStringValue";function i(g){switch(g){case 0:return"Off";case 1:return"Crosshair";case 2:return"Tooltip";default:return(0,r.hM)().cursorSync}}function x(g){switch(g){case 0:return"never";case 1:return"onDashboardLoad";case 2:return"onTimeRangeChanged";default:return(0,r.FM)()}}function s(g){switch(g){case 0:return"dontHide";case 1:return"hideLabel";case 2:return"hideVariable";default:return(0,r.SR)()}}function c(g){switch(g){case 0:return"disabled";case 1:return"alphabeticalAsc";case 2:return"alphabeticalDesc";case 3:return"numericalAsc";case 4:return"numericalDesc";default:return(0,r.G9)()}}function d(g){switch(g){case"annotations":return t.QR.Annotations;case"alertStates":return t.QR.AlertStates;case"series":return t.QR.Series;default:return}}function u(g){switch(g){case n.Yb.Thresholds:return"thresholds";case n.Yb.PaletteClassic:return"palette-classic";case n.Yb.PaletteClassicByName:return"palette-classic-by-name";case n.Yb.ContinuousGrYlRd:return"continuous-GrYlRd";case n.Yb.ContinuousRdYlGr:return"continuous-RdYlGr";case n.Yb.ContinuousBlYlRd:return"continuous-BlYlRd";case n.Yb.ContinuousYlRd:return"continuous-YlRd";case n.Yb.ContinuousBlPu:return"continuous-BlPu";case n.Yb.ContinuousYlBl:return"continuous-YlBl";case n.Yb.ContinuousBlues:return"continuous-blues";case n.Yb.ContinuousReds:return"continuous-reds";case n.Yb.ContinuousGreens:return"continuous-greens";case n.Yb.ContinuousPurples:return"continuous-purples";case n.Yb.Fixed:return"fixed";case n.Yb.Shades:return"shades";default:return}}},4432:(q,j,e)=>{"use strict";e.d(j,{c:()=>m,h:()=>f});var t=e(74848),n=e(42941),r=e(41053),a=e(58779),i=e(56276),x=e(32370),s=e(54594),c=e(65164),d=e(45565),u=e(9968),g=e(25356),o=e(11817),E=e(15664);function m({dashboard:h}){const[D,C]=(0,n.A)(!1),[l]=(0,E.uz)(),[,v]=(0,r.A)(async()=>{(0,i.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:!!x.$.featureToggles.dashboardRestore}),C(),h.state.uid&&await l({selectedItems:{dashboard:{[h.state.uid]:!0},folder:{}}}),await h.onDashboardDelete()},[h,C]);return h.state.meta.provisioned&&D?(0,t.jsx)(p,{dashboardId:h.state.meta.provisionedExternalId,onClose:C}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.$n,{variant:"destructive",onClick:C,"data-testid":a.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),D&&(0,t.jsx)(f,{dashboardTitle:h.state.title,onConfirm:v,onClose:C})]})}function f({dashboardTitle:h,onConfirm:D,onClose:C}){return(0,t.jsx)(c.u,{isOpen:!0,body:(0,t.jsxs)(t.Fragment,{children:[x.$.featureToggles.dashboardRestore&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.E,{element:"p",children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-settings.delete-modal-restore-dashboards-text",children:"This action will mark the dashboard for deletion in 30 days. Your organization administrator can restore it anytime before the 30 days expire."})}),(0,t.jsx)(u.$,{v:1})]}),(0,t.jsx)(d.E,{element:"p",children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-settings.delete-modal-text",children:"Do you want to delete this dashboard?"})}),(0,t.jsx)(d.E,{element:"p",children:h}),(0,t.jsx)(u.$,{v:2})]}),onConfirm:D,onDismiss:C,title:(0,o.t)("dashboard-settings.delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,o.t)("dashboard-settings.delete-modal.delete-button","Delete"),confirmationText:(0,o.t)("dashboard-settings.delete-modal.confirmation-text","Delete")})}function p({dashboardId:h,onClose:D}){return(0,t.jsxs)(g.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:D,children:[(0,t.jsx)("p",{children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."}),(0,t.jsxs)("p",{children:[(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{}),"File path: ",h]}),(0,t.jsx)(g.a.ButtonRow,{children:(0,t.jsx)(s.$n,{variant:"primary",onClick:D,children:"OK"})})]})}},81208:(q,j,e)=>{"use strict";e.d(j,{F:()=>i});var t=e(74848),n=e(96540),r=e(32370),a=e(4050);class i extends n.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){const s=r.$.angularSupportEnabled;this.ref&&s&&this.loadAngular()}componentDidUpdate(s){s.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const s=(0,a.E)(),c='<plugin-component type="annotations-query-ctrl"> </plugin-component>',d={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=s.load(this.ref,d,c),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(d.ctrl.ignoreNextWatcherFiring){d.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(d.ctrl.currentAnnotation)}),this.scopeProps=d}render(){return(0,t.jsx)("div",{ref:s=>this.ref=s})}}},575:(q,j,e)=>{"use strict";e.d(j,{d:()=>o});var t=e(74848),n=e(86489),r=e(34128),a=e(44826),i=e(32319),x=e(91036),s=e(81942),c=e(54594),d=e(80342);const u=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],g=Object.keys(d.G).map(E=>({label:E,value:E}));function o({link:E,onUpdate:m,onGoBack:f}){const p=v=>{m({...E,tags:v})},h=v=>{const y={...E,type:v.value};y.type==="dashboards"?(y.url="",y.tooltip=""):y.tags=[],m(y)},D=v=>{m({...E,icon:v.value})},C=v=>{const y=v.currentTarget;m({...E,[y.name]:y.type==="checkbox"?y.checked:y.value})},l=E.title===d.q.title;return(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsx)(n.D,{label:"Title",children:(0,t.jsx)(r.p,{name:"title",id:"title",value:E.title,onChange:C,autoFocus:l})}),(0,t.jsx)(n.D,{label:"Type",children:(0,t.jsx)(a.l6,{inputId:"link-type-input",value:E.type,options:u,onChange:h})}),E.type==="dashboards"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.D,{label:"With tags",children:(0,t.jsx)(i.u,{tags:E.tags,onChange:p})})}),E.type==="link"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.D,{label:"URL",children:(0,t.jsx)(r.p,{name:"url",value:E.url,onChange:C})}),(0,t.jsx)(n.D,{label:"Tooltip",children:(0,t.jsx)(r.p,{name:"tooltip",value:E.tooltip,onChange:C,placeholder:"Open dashboard"})}),(0,t.jsx)(n.D,{label:"Icon",children:(0,t.jsx)(a.l6,{value:E.icon,options:g,onChange:D})})]}),(0,t.jsxs)(x.M,{label:"Options",isOpen:!0,children:[E.type==="dashboards"&&(0,t.jsx)(n.D,{children:(0,t.jsx)(s.S,{label:"Show as dropdown",name:"asDropdown",value:E.asDropdown,onChange:C})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(s.S,{label:"Include current time range",name:"keepTime",value:E.keepTime,onChange:C})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(s.S,{label:"Include current template variable values",name:"includeVars",value:E.includeVars,onChange:C})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(s.S,{label:"Open link in new tab",name:"targetBlank",value:E.targetBlank,onChange:C})})]}),(0,t.jsx)(c.$n,{variant:"secondary",onClick:f,children:"Back to list"})]})}},69253:(q,j,e)=>{"use strict";e.d(j,{X:()=>E});var t=e(74848),n=e(22803),r=e(29675),a=e(48583),i=e(59830),x=e(54594),s=e(54731),c=e(79784),d=e(95015),u=e(99764),g=e(87731),o=e(11817);function E({links:f,onNew:p,onOrderChange:h,onEdit:D,onDuplicate:C,onDelete:l}){const v=(0,r.of)(m);return f.length===0?(0,t.jsx)(a.B,{direction:"column",children:(0,t.jsx)(i.p,{variant:"call-to-action",button:(0,t.jsx)(x.$n,{onClick:p,size:"lg",children:(0,t.jsx)(o.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,o.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,t.jsxs)(o.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,t.jsx)(s.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Type"}),(0,t.jsx)("th",{children:"Info"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:f.map((P,b)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>D(b),children:[(0,t.jsx)(c.I,{name:"external-link-alt"})," \xA0 ",P.type]}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>D(b),children:(0,t.jsxs)(a.B,{children:[P.title&&(0,t.jsx)("span",{className:v.titleWrapper,children:P.title}),P.type==="link"&&(0,t.jsx)("span",{className:v.urlWrapper,children:P.url}),P.type==="dashboards"&&(0,t.jsx)(d.L,{tags:P.tags??[]})]})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:b!==0&&(0,t.jsx)(u.K,{name:"arrow-up",onClick:()=>h(b,-1),tooltip:"Move link up"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:f.length>1&&b!==f.length-1?(0,t.jsx)(u.K,{name:"arrow-down",onClick:()=>h(b,1),tooltip:"Move link down"}):null}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(u.K,{name:"copy",onClick:()=>C(P),tooltip:"Copy link"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(g.e,{"aria-label":`Delete link with title "${P.title}"`,size:"sm",onConfirm:()=>l(b)})})]},`${P.title}-${b}`))})]}),(0,t.jsx)(x.$n,{className:v.newLinkButton,icon:"plus",onClick:p,children:"New link"})]})}const m=f=>({titleWrapper:(0,n.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,n.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,n.css)({marginTop:f.spacing(3)})})},80342:(q,j,e)=>{"use strict";e.d(j,{G:()=>n,q:()=>t});const t={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},n={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},79961:(q,j,e)=>{"use strict";e.d(j,{Q:()=>o});var t=e(74848),n=e(96540),r=e(60590),a=e(58779),i=e(86489),x=e(37e3),s=e(29010),c=e(3886),d=e(15773),u=e(93257),g=e(17077);function o({datasource:E,infoText:m,allowCustomValue:f,onDataSourceChange:p,onDefaultKeysChange:h,onAllowCustomValueChange:D,defaultKeys:C}){const l=(0,n.useCallback)(v=>{const y=(0,r.Jh)(`key,value
`+v)[0],P=[];for(let b=0;b<y.length;b++)P.push({text:y.fields[0].values[b],value:y.fields[1].values[b]});h?.(P)},[h]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Y,{children:"Ad-hoc options"}),(0,t.jsx)(i.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(d.s,{current:E,onChange:p,width:30,variables:!0,noDefault:!0})}),m?(0,t.jsx)(x.F,{title:m,severity:"info","data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,t.jsx)(s.d,{"data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:C!==void 0,onChange:v=>{h(C===void 0?[]:void 0)}})}),C!==void 0&&(0,t.jsx)(c.B,{height:300,language:"csv",value:C.map(v=>`${v.text},${v.value}`).join(`
`),onBlur:l,onSave:l,showMiniMap:!1,showLineNumbers:!0})]}),D&&(0,t.jsx)(u.c,{value:f??!0,name:"Allow custom values",description:"Enables users to add custom values to the list",onChange:D,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch})]})}},53504:(q,j,e)=>{"use strict";e.d(j,{d:()=>i});var t=e(74848),n=e(58779),r=e(17077),a=e(7807);function i({onChange:x,constantValue:s}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Y,{children:"Constant options"}),(0,t.jsx)(a._,{defaultValue:s,name:"Value",placeholder:"your metric prefix",onBlur:x,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},3661:(q,j,e)=>{"use strict";e.d(j,{w:()=>x});var t=e(74848),n=e(58779),r=e(17077),a=e(36390),i=e(27723);function x({query:s,multi:c,allValue:d,includeAll:u,allowCustomValue:g,onQueryChange:o,onMultiChange:E,onIncludeAllChange:m,onAllValueChange:f,onAllowCustomValueChange:p}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Y,{children:"Custom options"}),(0,t.jsx)(a.Z,{name:"Values separated by comma",defaultValue:s,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:o,required:!0,width:52,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,t.jsx)(r.Y,{children:"Selection options"}),(0,t.jsx)(i.B,{multi:c,includeAll:u,allValue:d,allowCustomValue:g,onMultiChange:E,onIncludeAllChange:m,onAllValueChange:f,onAllowCustomValueChange:p})]})}},29815:(q,j,e)=>{"use strict";e.d(j,{y:()=>s});var t=e(74848),n=e(58779),r=e(27723),a=e(17077),i=e(99384),x=e(7807);function s({query:c,regex:d,optionTypes:u,allowCustomValue:g,onChange:o,onRegExBlur:E,multi:m,includeAll:f,allValue:p,onMultiChange:h,onIncludeAllChange:D,onAllValueChange:C,onAllowCustomValueChange:l}){const v=u.find(y=>y.value===c)??u[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Y,{children:"Data source options"}),(0,t.jsx)(i.v,{name:"Type",value:v,options:u,onChange:o,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,t.jsx)(x._,{defaultValue:d,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:E,description:(0,t.jsxs)("div",{children:["Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"/^prod/"})]})}),(0,t.jsx)(a.Y,{children:"Selection options"}),(0,t.jsx)(r.B,{multi:m,includeAll:f,allValue:p,allowCustomValue:g,onMultiChange:h,onIncludeAllChange:D,onAllValueChange:C,onAllowCustomValueChange:l})]})}},12619:(q,j,e)=>{"use strict";e.d(j,{s:()=>d});var t=e(74848),n=e(22803),r=e(58779),a=e(29675),i=e(93257),x=e(17077),s=e(99384),c=e(7807);function d({intervals:g,onIntervalsChange:o,onAutoEnabledChange:E,onAutoMinIntervalChanged:m,onAutoCountChanged:f,autoEnabled:p,autoMinInterval:h,autoStepCount:D}){const C=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(y=>({label:`${y}`,value:y})),l=(0,a.of)(u),v=C.find(y=>y.value===D)??C[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Y,{children:"Interval options"}),(0,t.jsx)(c._,{defaultValue:g,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:o,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,t.jsx)(i.c,{value:p,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:E,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),p&&(0,t.jsxs)("div",{className:l.autoFields,children:[(0,t.jsx)(s.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:v,options:C,onChange:f,width:9,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,t.jsx)(c._,{value:h,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:m,width:11,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const u=g=>({autoFields:(0,n.css)({marginTop:g.spacing(2),display:"flex",flexDirection:"column"})})},92467:(q,j,e)=>{"use strict";e.d(j,{u:()=>O});var t=e(74848),n=e(16817),r=e(58779),a=e(98437),i=e(86489),x=e(8392),s=e(39736),c=e(90231),d=e(45565),u=e(21658);function g({query:R,datasource:L,VariableQueryEditor:B,onLegacyQueryChange:F,onQueryChange:I,timeRange:U}){let W;return typeof R=="string"?W=R||(L.variables?.getDefaultQuery?.()??""):W={...L.variables?.getDefaultQuery?.(),...R},B&&(0,u.VN)(B,L)?(0,t.jsxs)(c.a,{marginBottom:2,children:[(0,t.jsx)(d.E,{element:"h4",children:"Query"}),(0,t.jsx)(c.a,{marginTop:1,children:(0,t.jsx)(B,{datasource:L,query:W,templateSrv:(0,s.w)(),onChange:F},L.uid)})]}):B&&(0,u.CH)(B,L)?(0,t.jsxs)(c.a,{marginBottom:2,children:[(0,t.jsx)(d.E,{element:"h4",children:"Query"}),(0,t.jsx)(c.a,{marginTop:1,children:(0,t.jsx)(B,{datasource:L,query:W,onChange:I,onRunQuery:()=>{},data:{series:[],state:x.Gu.Done,timeRange:U},range:U,onBlur:()=>{},history:[]},L.uid)})]}):null}var o=e(27723),E=e(15773),m=e(5596),f=e(96540),p=e(14964),h=e(29675),D=e(60641),C=e(59041);const l=[{label:"On dashboard load",value:p.CO.onDashboardLoad},{label:"On time range change",value:p.CO.onTimeRangeChanged}];function v({onChange:R,refresh:L,testId:B}){const F=(0,h.$j)(),[I,U]=(0,f.useState)(!1);(0,C.Y)({breakpoint:F.breakpoints.values.sm,onChange:A=>{U(!A.matches)}});const W=(0,f.useMemo)(()=>l.find(A=>A.value===L)?.value??l[0].value,[L]);return(0,t.jsx)(i.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":B,children:(0,t.jsx)(D.z,{options:l,onChange:R,value:W,size:I?"sm":"md"})})}var y=e(99384);const P=[{label:"Disabled",value:p.ZG.disabled},{label:"Alphabetical (asc)",value:p.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:p.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:p.ZG.numericalAsc},{label:"Numerical (desc)",value:p.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:p.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:p.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:p.ZG.naturalAsc},{label:"Natural (desc)",value:p.ZG.naturalDesc}];function b({onChange:R,sort:L,testId:B}){const F=(0,f.useMemo)(()=>P.find(I=>I.value===L)??P[0],[L]);return(0,t.jsx)(y.v,{name:"Sort",description:"How to sort the values of this variable",value:F,options:P,onChange:R,testId:B,width:25})}var S=e(17077),M=e(36390);function O({datasource:R,onDataSourceChange:L,query:B,onQueryChange:F,onLegacyQueryChange:I,timeRange:U,regex:W,onRegExChange:A,sort:N,onSortChange:K,refresh:V,onRefreshChange:T,isMulti:z,onMultiChange:w,allowCustomValue:H,onAllowCustomValueChange:G,includeAll:X,onIncludeAllChange:k,allValue:_,onAllValueChange:ee}){const{value:J}=(0,n.A)(async()=>{const ae=await(0,a.l)().get(R??""),re=await(0,m.y)(ae),ne=ae?.variables?.getDefaultQuery?.();if(!B&&ne){const ce=typeof ne=="string"?ne:{...ne,refId:ne.refId??"A"};F(ce)}return{datasource:ae,VariableQueryEditor:re}},[R]),{datasource:Z,VariableQueryEditor:te}=J??{};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Y,{children:"Query options"}),(0,t.jsx)(i.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(E.s,{current:R,onChange:L,variables:!0,width:30})}),Z&&te&&(0,t.jsx)(g,{onQueryChange:F,onLegacyQueryChange:I,datasource:Z,query:B,VariableQueryEditor:te,timeRange:U}),(0,t.jsx)(M.Z,{defaultValue:W??"",name:"Regex",description:(0,t.jsxs)("div",{children:["Optional, if you want to extract part of a series name or metric node segment.",(0,t.jsx)("br",{}),"Named capture groups can be used to separate the display text and value (",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank",children:"see examples"}),")."]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:A,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,t.jsx)(b,{testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:K,sort:N}),(0,t.jsx)(v,{testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:T,refresh:V}),(0,t.jsx)(S.Y,{children:"Selection options"}),(0,t.jsx)(o.B,{multi:!!z,includeAll:!!X,allowCustomValue:H,allValue:_,onMultiChange:w,onIncludeAllChange:k,onAllValueChange:ee,onAllowCustomValueChange:G})]})}},27723:(q,j,e)=>{"use strict";e.d(j,{B:()=>x});var t=e(74848),n=e(58779),r=e(48583),a=e(93257),i=e(7807);function x({multi:s,allowCustomValue:c,includeAll:d,allValue:u,onMultiChange:g,onAllowCustomValueChange:o,onIncludeAllChange:E,onAllValueChange:m}){return(0,t.jsxs)(r.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,t.jsx)(a.c,{value:s,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:g,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),o&&(0,t.jsx)(a.c,{value:c??!0,name:"Allow custom values",description:"Enables users to add custom values to the list",onChange:o,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch}),(0,t.jsx)(a.c,{value:d,name:"Include All option",description:"Enables an option to include all variables",onChange:E,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),d&&(0,t.jsx)(i._,{defaultValue:u??"",onBlur:m,name:"Custom all value",placeholder:"blank = auto",testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},93257:(q,j,e)=>{"use strict";e.d(j,{c:()=>a});var t=e(74848),n=e(92145),r=e(81942);function a({value:i,name:x,description:s,onChange:c,ariaLabel:d,testId:u}){const g=(0,n.Bi)();return(0,t.jsx)(r.S,{id:g,label:x,description:s,value:i,onChange:c,"aria-label":d,"data-testid":u})}},92226:(q,j,e)=>{"use strict";e.d(j,{D:()=>s});var t=e(74848),n=e(96540),r=e(14964),a=e(86489),i=e(60641);const x=[{label:"Label and value",value:r.zL.dontHide},{label:"Value",value:r.zL.hideLabel},{label:"Nothing",value:r.zL.hideVariable}];function s({onChange:c,hide:d,type:u}){const g=(0,n.useMemo)(()=>x.find(o=>o.value===d)?.value??x[0].value,[d]);return u==="constant"?null:(0,t.jsx)(a.D,{label:"Show on dashboard",children:(0,t.jsx)(i.z,{options:x,onChange:c,value:g})})}},17077:(q,j,e)=>{"use strict";e.d(j,{Y:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(99178);function i({className:s,...c}){const d=(0,r.of)(x);return(0,t.jsx)(a.s,{...c,className:(0,n.cx)(d.legend,s)})}function x(s){return{legend:(0,n.css)({marginTop:s.spacing(3),marginBottom:s.spacing(1)})}}},99384:(q,j,e)=>{"use strict";e.d(j,{v:()=>s});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(86489),x=e(44826);function s({name:d,description:u,value:g,options:o,onChange:E,testId:m,width:f}){const p=(0,a.of)(c),h=(0,r.useId)(),D=`variable-select-input-${d}-${h}`;return(0,t.jsx)(i.D,{label:d,description:u,htmlFor:D,children:(0,t.jsx)(x.l6,{"data-testid":m,inputId:D,onChange:E,value:g,width:f??30,options:o,className:p.selectContainer})})}function c(d){return{selectContainer:(0,n.css)({marginRight:d.spacing(.5)})}}},36390:(q,j,e)=>{"use strict";e.d(j,{$:()=>c,Z:()=>s});var t=e(74848),n=e(22803),r=e(92145),a=e(29675),i=e(86489),x=e(50926);function s({value:d,defaultValue:u,name:g,description:o,placeholder:E,onChange:m,onBlur:f,ariaLabel:p,required:h,width:D,testId:C}){const l=(0,a.of)(c),v=(0,r.Bi)();return(0,t.jsx)(i.D,{label:g,description:o,htmlFor:v,children:(0,t.jsx)(x.f,{id:v,rows:2,value:d,defaultValue:u,onChange:m,onBlur:f,placeholder:E,required:h,"aria-label":p,cols:D,className:l.textarea,"data-testid":C})})}function c(d){return{textarea:(0,n.css)({whiteSpace:"pre-wrap",minHeight:d.spacing(4),height:"auto",overflow:"auto",padding:`${d.spacing(.75)} ${d.spacing(1)}`,width:"inherit",[d.breakpoints.down("sm")]:{width:"100%"}})}}},7807:(q,j,e)=>{"use strict";e.d(j,{_:()=>i});var t=e(74848),n=e(92145),r=e(86489),a=e(34128);function i({value:x,defaultValue:s,name:c,placeholder:d="",onChange:u,testId:g,width:o,required:E,onBlur:m,grow:f,description:p,invalid:h,error:D,maxLength:C}){const l=(0,n.Bi)(c);return(0,t.jsx)(r.D,{label:c,description:p,invalid:h,error:D,htmlFor:l,children:(0,t.jsx)(a.p,{type:"text",id:l,placeholder:d,value:x,defaultValue:s,onChange:u,onBlur:m,width:f?void 0:o??30,"data-testid":g,maxLength:C,required:E})})}},10666:(q,j,e)=>{"use strict";e.d(j,{j:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(29675),x=e(77222),s=e(76302),c=e(54594);const d=({options:g})=>{const[o,E]=(0,r.useState)(20),[m,f]=(0,r.useState)([]),p=(0,r.useCallback)(D=>{D.preventDefault(),E(o+20)},[o,E]),h=(0,i.of)(u);return(0,r.useEffect)(()=>f(g.slice(0,o)),[o,g]),m.length?(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,t.jsx)("h5",{children:"Preview of values"}),(0,t.jsx)(x.C,{children:m.map((D,C)=>(0,t.jsx)(x.C,{className:h.optionContainer,children:(0,t.jsx)(s.c,{"data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,t.jsx)("div",{className:h.label,children:D.label})})},`${D.value}-${C}`))}),g.length>o&&(0,t.jsx)(x.C,{className:h.optionContainer,children:(0,t.jsx)(c.$n,{onClick:p,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link",children:"Show more"})})]}):null};d.displayName="VariableValuesPreview";function u(g){return{wrapper:(0,n.css)({display:"flex",flexDirection:"column",marginTop:g.spacing(2)}),optionContainer:(0,n.css)({marginLeft:g.spacing(.5),marginBottom:g.spacing(.5)}),label:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},23672:(q,j,e)=>{"use strict";e.d(j,{cH:()=>te,mJ:()=>ae,Ao:()=>_,e4:()=>ee,kh:()=>G,CD:()=>w,No:()=>H,B$:()=>z,n_:()=>k,bZ:()=>K,c7:()=>Z});var t=e(2543),n=e(32370),r=e(98437),a=e(61034),i=e(39344),x=e(2044),s=e(74848),c=e(16817),d=e(61809),u=e(79961);function g(re){const{variable:ne}=re,{datasource:ce,defaultKeys:le,allowCustomValue:he}=ne.useState(),{value:oe}=(0,c.A)(async()=>await(0,r.l)().get(ce),[ce]),de=oe?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",me=be=>{const Se=(0,d.p$)(be);ne.setState({datasource:Se,supportsMultiValueOperators:be.meta.multiValueFilterOperators})},Pe=be=>{ne.setState({defaultKeys:be})},Ee=be=>{ne.setState({allowCustomValue:be.currentTarget.checked})};return(0,s.jsx)(u.Q,{datasource:ce??void 0,infoText:de,allowCustomValue:he,onDataSourceChange:me,defaultKeys:le,onDefaultKeysChange:Pe,onAllowCustomValueChange:Ee})}var o=e(53504);function E({variable:re}){const{value:ne}=re.useState(),ce=le=>{re.setState({value:le.currentTarget.value})};return(0,s.jsx)(o.d,{constantValue:String(ne),onChange:ce})}var m=e(3661);function f({variable:re,onRunQuery:ne}){const{query:ce,isMulti:le,allValue:he,includeAll:oe,allowCustomValue:de}=re.useState(),me=Xe=>{re.setState({isMulti:Xe.currentTarget.checked})},Pe=Xe=>{re.setState({includeAll:Xe.currentTarget.checked})},Ee=Xe=>{re.setState({query:Xe.currentTarget.value}),ne()},be=Xe=>{re.setState({allValue:Xe.currentTarget.value})},Se=Xe=>{re.setState({allowCustomValue:Xe.currentTarget.checked})};return(0,s.jsx)(m.w,{query:ce??"",multi:!!le,allValue:he??"",includeAll:!!oe,allowCustomValue:de,onMultiChange:me,onIncludeAllChange:Pe,onQueryChange:Ee,onAllValueChange:be,onAllowCustomValueChange:Se})}var p=e(29815);function h({variable:re,onRunQuery:ne}){const{pluginId:ce,regex:le,isMulti:he,allValue:oe,includeAll:de,allowCustomValue:me}=re.useState(),Pe=ee(),Ee=$e=>{re.setState({pluginId:$e.value}),ne()},be=$e=>{re.setState({regex:$e.currentTarget.value}),ne()},Se=$e=>{re.setState({isMulti:$e.currentTarget.checked})},Xe=$e=>{re.setState({includeAll:$e.currentTarget.checked})},Qe=$e=>{re.setState({allValue:$e.currentTarget.value})},we=$e=>{re.setState({allowCustomValue:$e.currentTarget.checked})};return(0,s.jsx)(p.y,{query:ce,regex:le,multi:he||!1,allValue:oe,includeAll:de||!1,optionTypes:Pe,allowCustomValue:me,onChange:Ee,onRegExBlur:be,onMultiChange:Se,onIncludeAllChange:Xe,onAllValueChange:Qe,onAllowCustomValueChange:we})}var D=e(96540),C=e(60590),l=e(58779),v=e(86489),y=e(37e3),P=e(29010),b=e(3886),S=e(15773),M=e(93257),O=e(17077);function R({datasource:re,defaultOptions:ne,infoText:ce,onDataSourceChange:le,onDefaultOptionsChange:he,allowCustomValue:oe,onAllowCustomValueChange:de}){const me=(0,D.useCallback)(Pe=>{const Ee=(0,C.Jh)(`key,value
`+Pe)[0],be=[];for(let Se=0;Se<Ee.length;Se++)be.push({text:Ee.fields[0].values[Se],value:Ee.fields[1].values[Se]});he(be)},[he]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.Y,{children:"Group by options"}),(0,s.jsx)(v.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,s.jsx)(S.s,{current:re,onChange:le,width:30,variables:!0,noDefault:!0})}),ce?(0,s.jsx)(y.F,{title:ce,severity:"info","data-testid":l.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,(0,s.jsx)(v.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,s.jsx)(P.d,{"data-testid":l.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:ne!==void 0,onChange:Pe=>{he(ne===void 0?[]:void 0)}})}),ne!==void 0&&(0,s.jsx)(b.B,{height:300,language:"csv",value:ne.map(Pe=>`${Pe.text},${Pe.value}`).join(`
`),onBlur:me,onSave:me,showMiniMap:!1,showLineNumbers:!0}),(0,s.jsx)(M.c,{value:oe,name:"Allow custom values",description:"Enables users to add custom values to the list",onChange:de,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch})]})}function L(re){const{variable:ne,onRunQuery:ce}=re,{datasource:le,defaultOptions:he,allowCustomValue:oe=!0}=ne.useState(),{value:de}=(0,c.A)(async()=>await(0,r.l)().get(le),[ne.state]),me=de?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",Pe=async Se=>{const Xe=(0,d.p$)(Se);ne.setState({datasource:Xe}),ce()},Ee=async Se=>{ne.setState({defaultOptions:Se}),ce()},be=Se=>{ne.setState({allowCustomValue:Se.currentTarget.checked})};return(0,s.jsx)(R,{defaultOptions:he,datasource:le??void 0,infoText:le?me:void 0,onDataSourceChange:Pe,onDefaultOptionsChange:Ee,allowCustomValue:oe,onAllowCustomValueChange:be})}var B=e(12619);function F({variable:re,onRunQuery:ne}){const{intervals:ce,autoStepCount:le,autoEnabled:he,autoMinInterval:oe,value:de}=re.useState(),me=(0,x.bx)(ce),Pe=Xe=>{const Qe=(0,x.Sm)(Xe.currentTarget.value),we=Qe.includes(de)?de:Qe[0];re.setState({intervals:Qe,value:we}),ne()},Ee=Xe=>{re.setState({autoStepCount:Xe.value})},be=Xe=>{re.setState({autoEnabled:Xe.target.checked})},Se=Xe=>{re.setState({autoMinInterval:Xe.currentTarget.value})};return(0,s.jsx)(B.s,{intervals:me,autoStepCount:le,autoEnabled:he,onAutoCountChanged:Ee,onIntervalsChange:Pe,onAutoEnabledChange:be,onAutoMinIntervalChanged:Se,autoMinInterval:oe})}var I=e(92467);function U({variable:re,onRunQuery:ne}){const{datasource:ce,regex:le,sort:he,refresh:oe,isMulti:de,includeAll:me,allValue:Pe,query:Ee,allowCustomValue:be}=re.useState(),{value:Se}=a.jh.getTimeRange(re).useState(),Xe=De=>{re.setState({regex:De.currentTarget.value})},Qe=De=>{re.setState({sort:De.value})},we=De=>{re.setState({refresh:De})},$e=De=>{re.setState({isMulti:De.currentTarget.checked})},Fe=De=>{re.setState({includeAll:De.currentTarget.checked})},Te=De=>{re.setState({allValue:De.currentTarget.value})},Le=De=>{re.setState({allowCustomValue:De.currentTarget.checked})},Ge=De=>{const Ke=(0,d.p$)(De);if((re.state.datasource?.type||"")!==Ke.type){re.setState({datasource:Ke,query:"",definition:""});return}re.setState({datasource:Ke})},Me=De=>{let Ke;typeof De=="string"?Ke=De:De.hasOwnProperty("query")&&typeof De.query=="string"?Ke=De.query:Ke="",re.setState({query:De,definition:Ke}),ne()};return(0,s.jsx)(I.u,{datasource:ce??void 0,onDataSourceChange:Ge,query:Ee,onQueryChange:Me,onLegacyQueryChange:Me,timeRange:Se,regex:le,onRegExChange:Xe,sort:he,onSortChange:Qe,refresh:oe,onRefreshChange:we,isMulti:!!de,onMultiChange:$e,includeAll:!!me,onIncludeAllChange:Fe,allValue:Pe??"",onAllValueChange:Te,allowCustomValue:be,onAllowCustomValueChange:Le})}var W=e(7807);function A({defaultValue:re,value:ne,onChange:ce,onBlur:le}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.Y,{children:"Text options"}),(0,s.jsx)(W._,{value:ne,defaultValue:re,name:"Default value",placeholder:"default value, if any",onChange:ce,onBlur:le,width:30,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function N({variable:re}){const{value:ne}=re.useState(),ce=le=>{re.setState({value:le.currentTarget.value})};return(0,s.jsx)(A,{defaultValue:ne,onBlur:ce})}function K(re){return re!=="system"}const V={custom:{name:"Custom",description:"Define variable values manually",editor:f},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:U},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:E},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:F},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:h},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:g},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:L},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:N}},T=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function z(){const re=T.map(ne=>({label:V[ne].name,value:ne,description:V[ne].description}));return n.$.featureToggles.groupByVariable?re:re.filter(ne=>ne.value!=="groupby")}function w(re){return V[re].editor}function H(re,ne){switch(re){case"custom":return new a.yP(ne);case"query":return new a.fS(ne);case"constant":return new a.x0({...ne,hide:i.zL.hideVariable});case"interval":return new a.Yj(ne);case"datasource":return new a.mI(ne);case"adhoc":return new a.H9({...ne,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0});case"groupby":return new a.ZG(ne);case"textbox":return new a.TS(ne)}}function G(re){const ce=X("query",re);return new a.fS({name:ce})}function X(re,ne){let ce=0,le=`${re}${ce}`;for(;ne.find(he=>he.state.name===le);)le=`${re}${++ce}`;return le}function k(re){return"options"in re.state||"intervals"in re.state}function _(re){let ne="";return re instanceof a.fS?ne=re.state.definition||(typeof re.state.query=="string"?re.state.query:""):re instanceof a.mI?ne=String(re.state.pluginId):re instanceof a.yP?ne=re.state.query:re instanceof a.Yj?ne=(0,x.bx)(re.state.intervals):(re instanceof a.TS||re instanceof a.x0)&&(ne=String(re.state.value)),ne}function ee(){const re=(0,r.l)().getList({metrics:!0,variables:!0}),ne=(0,t.chain)(re).uniqBy("meta.id").map(ce=>({label:ce.meta.name,value:ce.meta.id})).value();return ne.unshift({label:"",value:""}),ne}function J(re){return"type"in re.state&&"getValue"in re}function Z(re){return J(re)?a.Go.isAdHocVariable(re)||a.Go.isConstantVariable(re)||a.Go.isCustomVariable(re)||a.Go.isDataSourceVariable(re)||a.Go.isIntervalVariable(re)||a.Go.isQueryVariable(re)||a.Go.isTextBoxVariable(re)||a.Go.isGroupByVariable(re):!1}const te=/^(?!__).*$/,ae=/^\w+$/},6253:(q,j,e)=>{"use strict";e.d(j,{D:()=>o});var t=e(74848),n=e(22803),r=e(2543),a=e(29675),i=e(79784);const x=({diff:m})=>{const f=(0,a.of)(s),p=!(0,r.isUndefined)(m.originalValue)&&!(0,r.isArray)(m.originalValue)&&!(0,r.isObject)(m.originalValue),h=!(0,r.isUndefined)(m.value)&&!(0,r.isArray)(m.value)&&!(0,r.isObject)(m.value);return(0,t.jsxs)(t.Fragment,{children:[p&&(0,t.jsx)("span",{className:f,children:String(m.originalValue)}),p&&h?(0,t.jsx)(i.I,{name:"arrow-right"}):null,h&&(0,t.jsx)("span",{className:f,children:String(m.value)})]})},s=m=>(0,n.css)({backgroundColor:m.colors.action.hover,borderRadius:m.shape.radius.default,color:m.colors.text.primary,fontSize:m.typography.body.fontSize,margin:m.spacing(0,.5),padding:m.spacing(.25,.5)});var c=e(91354);const d={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},u=({diff:m,title:f})=>{const p=(0,a.of)(g);return m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.I,{type:"mono",name:"circle",className:p[m.op],size:"xs"})," ",(0,t.jsx)("span",{className:p.embolden,children:f})," ",(0,t.jsx)("span",{children:(0,c.Fl)(m,m.path?.length>1)})," ",(0,t.jsx)(x,{diff:m})]}):(0,t.jsxs)("div",{className:p.withoutDiff,children:[(0,t.jsx)(i.I,{type:"mono",name:"circle",className:p.replace,size:"xs"})," ",(0,t.jsx)("span",{className:p.embolden,children:f})," ",(0,t.jsx)("span",{children:(0,c.Fl)(d,!1)})]})},g=m=>({embolden:(0,n.css)({fontWeight:m.typography.fontWeightBold}),add:(0,n.css)({color:m.colors.success.main}),replace:(0,n.css)({color:m.colors.warning.main}),move:(0,n.css)({color:m.colors.warning.main}),copy:(0,n.css)({color:m.colors.success.main}),_get:(0,n.css)({color:m.colors.success.main}),test:(0,n.css)({color:m.colors.success.main}),remove:(0,n.css)({color:m.colors.error.main}),withoutDiff:(0,n.css)({marginBottom:m.spacing(1)})}),o=({diffs:m,title:f})=>{const p=(0,a.of)(E);return m.length===1?(0,t.jsx)("div",{className:p.container,"data-testid":"diffGroup",children:(0,t.jsx)(u,{title:f,diff:m[0]})}):(0,t.jsxs)("div",{className:p.container,"data-testid":"diffGroup",children:[(0,t.jsx)(u,{title:f}),(0,t.jsx)("ul",{className:p.list,children:m.map((h,D)=>(0,t.jsxs)("li",{className:p.listItem,children:[(0,t.jsx)("span",{children:(0,c.Fl)(h)})," ",(0,t.jsx)(x,{diff:h})]},`${(0,r.last)(h.path)}__${D}`))})]})},E=m=>({container:(0,n.css)({}),list:(0,n.css)({marginLeft:m.spacing(4)}),listItem:(0,n.css)({marginBottom:m.spacing(1),"&:last-child":{marginBottom:0}})})},51738:(q,j,e)=>{"use strict";e.d(j,{M:()=>s});var t=e(74848),n=e(22803),r=e(82514),a=e.n(r),i=e(84140),x=e(29675);const s=({oldValue:c,newValue:d,...u})=>{const g=(0,x.$j)(),o={variables:{dark:{diffViewerBackground:g.colors.background.canvas,diffViewerColor:g.colors.text.primary,addedBackground:(0,i.A)(g.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,i.A)(g.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,i.A)(g.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,i.A)(g.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,i.A)(g.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,i.A)(g.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:g.colors.background.primary,gutterBackgroundDark:g.colors.background.primary,highlightBackground:(0,i.A)(g.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,i.A)(g.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:g.colors.background.secondary,codeFoldBackground:g.colors.background.secondary,emptyLineBackground:g.colors.background.secondary,gutterColor:g.colors.text.disabled,addedGutterColor:g.colors.text.primary,removedGutterColor:g.colors.text.primary,codeFoldContentColor:g.colors.text.disabled,diffViewerTitleBackground:g.colors.background.secondary,diffViewerTitleColor:g.colors.text.disabled,diffViewerTitleBorderColor:g.colors.border.strong}},codeFold:{fontSize:g.typography.bodySmall.fontSize},gutter:{pre:{color:(0,i.A)(g.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,t.jsx)("div",{className:(0,n.css)({fontSize:g.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,t.jsx)(a(),{styles:o,oldValue:c,newValue:d,splitView:!1,compareMethod:r.DiffMethod.CSS,useDarkTheme:g.isDark,...u})})}},71857:(q,j,e)=>{"use strict";e.d(j,{Cc:()=>B,me:()=>l,bS:()=>f,rJ:()=>b,wL:()=>r});var t=e(28082);class n{getHistoryList(U,W){return typeof U!="string"?Promise.resolve([]):(0,t.AI)().get(`api/dashboards/uid/${U}/versions`,W)}getDashboardVersion(U,W){return typeof U!="string"?Promise.resolve({}):(0,t.AI)().get(`api/dashboards/uid/${U}/versions/${W}`)}restoreDashboard(U,W){if(typeof U!="string")return Promise.resolve({});const A=`api/dashboards/uid/${U}/restore`;return(0,t.AI)().post(A,{version:W})}}const r=new n;var a=e(74848),i=e(22803),x=e(29675),s=e(81942),c=e(73903),d=e(43908),u=e(54594),g=e(83424),o=e(65164),E=e(17687);const m=({hideModal:I,onRestore:U,version:W})=>{const A=(0,E._2)(),N=async()=>{await U(W)?(A.success("Dashboard restored",`Restored from version ${W.version}`),g.c.versionRestoreClicked({version:W.version,confirm:!0})):A.error("Dashboard restore failed",`Failed to restore from version ${W.version}`),I()};return(0,a.jsx)(o.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:I,onConfirm:N,body:(0,a.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",W.version,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${W.version}`})},f=({versions:I,canCompare:U,onCheck:W,onRestore:A})=>{const N=(0,x.of)(p);return(0,a.jsx)("div",{className:N.margin,children:(0,a.jsxs)("table",{className:"filter-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"width-4"}),(0,a.jsx)("th",{className:"width-4",children:"Version"}),(0,a.jsx)("th",{className:"width-14",children:"Date"}),(0,a.jsx)("th",{className:"width-10",children:"Updated by"}),(0,a.jsx)("th",{children:"Notes"}),(0,a.jsx)("th",{})]})}),(0,a.jsx)("tbody",{children:I.map((K,V)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)(s.S,{"aria-label":`Toggle selection of version ${K.version}`,className:(0,i.css)({display:"inline"}),checked:K.checked,onChange:T=>W(T,K.id),disabled:!K.checked&&U})}),(0,a.jsx)("td",{children:K.version}),(0,a.jsx)("td",{children:K.createdDateString}),(0,a.jsx)("td",{children:K.createdBy}),(0,a.jsx)("td",{children:K.message}),(0,a.jsx)("td",{className:"text-right",children:V===0?(0,a.jsx)(c.v,{name:"Latest",colorIndex:17}):(0,a.jsx)(d.$s,{children:({showModal:T,hideModal:z})=>(0,a.jsx)(u.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{T(m,{version:K,hideModal:z,onRestore:A}),g.c.versionRestoreClicked({version:K.version,index:V,confirm:!1,timestamp:K.created})},children:"Restore"})})})]},K.id))})]})})};function p(I){return{margin:(0,i.css)({marginBottom:I.spacing(4)})}}var h=e(2543),D=e(99764),C=e(79784);const l=({onClick:I=h.noop,baseVersion:U=0,newVersion:W=0,isNewLatest:A=!1})=>{const N=(0,x.of)(v);return(0,a.jsxs)("h3",{className:N.header,children:[(0,a.jsx)(D.K,{name:"arrow-left",size:"xl",onClick:I,tooltip:"Reset version"}),(0,a.jsxs)("span",{children:["Comparing ",U," ",(0,a.jsx)(C.I,{name:"arrows-h"})," ",W," ",A&&(0,a.jsx)("cite",{className:"muted",children:"(Latest)"})]})]})},v=I=>({header:(0,i.css)({fontSize:I.typography.h3.fontSize,display:"flex",gap:I.spacing(2),marginBottom:I.spacing(2)})});var y=e(48583),P=e(6736);const b=({hasMore:I,canCompare:U,getVersions:W,getDiff:A,isLastPage:N})=>(0,a.jsxs)(y.B,{children:[I&&(0,a.jsx)(u.$n,{type:"button",onClick:()=>{W(!0),g.c.showMoreVersionsClicked()},variant:"secondary",disabled:N,children:"Show more versions"}),(0,a.jsx)(P.m,{content:"Select two versions to start comparing",placement:"bottom",children:(0,a.jsx)(u.$n,{type:"button",disabled:!U,onClick:A,icon:"code-branch",children:"Compare versions"})})]});var S=e(90231),M=e(91036),O=e(6253),R=e(51738),L=e(91354);const B=({baseInfo:I,newInfo:U,diffData:W,isNewLatest:A,onRestore:N})=>{const K=(0,L.G4)(W.lhs,W.rhs),V=(0,x.of)(F);return(0,a.jsxs)(y.B,{direction:"column",gap:1,children:[(0,a.jsxs)(y.B,{justifyContent:"space-between",alignItems:"center",children:[(0,a.jsxs)(y.B,{alignItems:"center",children:[(0,a.jsxs)("span",{className:(0,i.cx)(V.versionInfo,V.noMarginBottom),children:[(0,a.jsxs)("strong",{children:["Version ",I.version]})," updated by ",I.createdBy," ",I.ageString,I.message]}),(0,a.jsx)(C.I,{name:"arrow-right",size:"sm"}),(0,a.jsxs)("span",{className:V.versionInfo,children:[(0,a.jsxs)("strong",{children:["Version ",U.version]})," updated by ",U.createdBy," ",U.ageString,U.message]})]}),A&&(0,a.jsx)(d.$s,{children:({showModal:T,hideModal:z})=>(0,a.jsxs)(u.$n,{variant:"destructive",icon:"history",onClick:()=>{T(m,{version:I,onRestore:N,hideModal:z})},children:["Restore to version ",I.version]})})]}),Object.entries(K).map(([T,z])=>(0,a.jsx)(O.D,{diffs:z,title:T},T)),(0,a.jsx)(S.a,{paddingTop:2,children:(0,a.jsx)(M.M,{isOpen:!1,label:"View JSON Diff",children:(0,a.jsx)(R.M,{oldValue:JSON.stringify(W.lhs,null,2),newValue:JSON.stringify(W.rhs,null,2)})})})]})},F=I=>({versionInfo:(0,i.css)({color:I.colors.text.secondary,fontSize:I.typography.bodySmall.fontSize}),noMarginBottom:(0,i.css)({marginBottom:0})})},91354:(q,j,e)=>{"use strict";e.d(j,{Fl:()=>x,G4:()=>i});var t=e(16111),n=e(25504),r=e(2543),a=e.n(r);const i=(d,u)=>{const g=(0,t.UD)(d,u),o=n.stringify(d,null,2),E=n.stringify(u,null,2),m=h=>h.map(D=>{let C,l,v=0,y=0;const P=(0,r.tail)(D.path.split("/"));return D.op==="replace"&&E.pointers[D.path]&&(C=(0,r.get)(d,P),l=D.value,v=E.pointers[D.path].value.line,y=E.pointers[D.path].valueEnd.line),D.op==="add"&&E.pointers[D.path]&&(l=D.value,v=E.pointers[D.path].value.line,y=E.pointers[D.path].valueEnd.line),D.op==="remove"&&o.pointers[D.path]&&(C=(0,r.get)(d,P),v=o.pointers[D.path].value.line,y=o.pointers[D.path].valueEnd.line),{op:D.op,value:l,path:P,originalValue:C,startLineNumber:v,endLineNumber:y}}),f=h=>(0,r.sortBy)(h,"startLineNumber"),p=h=>h.reduce((D,C)=>{const l=C.path[0];return D[l]||(D[l]=[]),D[l].push(C),D},{});return(0,r.flow)([m,f,p])(g)},x=(d,u=!0)=>{const g=(0,r.last)(d.path),o=s(g),E=d.op==="remove"?d.originalValue:d.value;let m=c(d.op);return u&&(o?m+=` item ${g}`:(0,r.isArray)(E)&&!(0,r.isEmpty)(E)?m+=` ${E.length} ${g}`:m+=` ${g}`),m},s=d=>!(0,r.isNaN)((0,r.toNumber)(d)),c=d=>d==="add"?"added":d==="remove"?"deleted":"changed"},75661:(q,j,e)=>{"use strict";e.d(j,{F7:()=>d,Xe:()=>x,yk:()=>c});var t=e(65552),n=e(25309),r=e(82856),a=e(83424);const i={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},x=async(u,g)=>{const{useAbsoluteTimeRange:o,useShortUrl:E,theme:m}=c();return a.c.shareLinkCopied({currentTimeRange:o,theme:m,shortenURL:E,shareResource:(0,n.hD)(g?.getRef())}),await(0,t.Sp)(u,{useAbsoluteTimeRange:o,theme:m,useShortUrl:E})},s="grafana.dashboard.link.shareConfiguration";function c(){return r.A.exists(s)&&r.A.getObject(s)||i}function d(u){r.A.setObject(s,u)}},60712:(q,j,e)=>{"use strict";e.d(j,{j:()=>ut});var t=e(74848),n=e(53027),r=e(61034),a=e(58528),i=e(25309),x=e(2044),s=e(22803),c=e(16817),d=e(70713),u=e(58779),g=e(29675),o=e(48583),E=e(29010),m=e(40271),f=e(3886),p=e(20968),h=e(54594),D=e(93604),C=e(23737),l=e(17687),v=e(11817),y=e(83394),P=e(83424),b=e(24470);const S=u.Tp.pages.ExportDashboardDrawer.ExportAsJson;class M extends b.N{static{this.Component=O}getTabLabel(){return(0,v.t)("export.json.title","Export dashboard JSON")}}function O({model:gt}){const Vt=(0,g.of)(R),{isSharingExternally:Ft}=gt.useState(),dn=(0,c.A)(async()=>{const ts=await gt.getExportableDashboardJson();return JSON.stringify(ts,null,2)},[Ft]),Cn=async()=>{await gt.onSaveAsFile();const ts=(0,v.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,y.JD)((0,C.dx)((0,l.tZ)(ts)))},Un=(0,v.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,t.jsxs)("div",{"data-testid":S.container,className:Vt.container,children:[(0,t.jsx)("p",{children:(0,t.jsx)(v.x6,{i18nKey:"export.json.info-text",children:"Copy or download a JSON file containing the JSON of your dashboard"})}),(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(E.d,{label:Un,"data-testid":S.exportExternallyToggle,id:"export-externally-toggle",value:Ft,onChange:gt.onShareExternallyChange}),(0,t.jsx)(m.J,{children:Un})]}),(0,t.jsx)("div",{className:Vt.codeEditorBox,children:(0,t.jsx)(d.default,{"data-testid":S.codeEditor,children:({width:ts,height:ms})=>dn.value?(0,t.jsx)(f.B,{value:dn.value,language:"json",showMiniMap:!1,height:ms,width:ts,readOnly:!0}):dn.loading&&(0,t.jsx)(p.y,{})})}),(0,t.jsx)("div",{className:Vt.buttonsContainer,children:(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(h.$n,{"data-testid":S.saveToFileButton,variant:"primary",icon:"download-alt",onClick:Cn,children:(0,t.jsx)(v.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,t.jsx)(D.b,{"data-testid":S.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:dn.loading,getText:()=>dn.value??"",onClipboardCopy:()=>{P.c.exportCopyJsonClicked()},children:(0,t.jsx)(v.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,t.jsx)(h.$n,{"data-testid":S.cancelButton,variant:"secondary",onClick:gt.useState().onDismiss,fill:"outline",children:(0,t.jsx)(v.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function R(gt){return{container:(0,s.css)({height:"100%"}),codeEditorBox:(0,s.css)({margin:`${gt.spacing(2,0)}`,height:"75%"}),buttonsContainer:(0,s.css)({paddingBottom:gt.spacing(2)})}}var L=e(96540),B=e(76080),F=e(87638),I=e(65728),U=e(2175),W=e(71488),A=e(61491),N=e(45565),K=e(99764),V=e(57472);function T({onConfirm:gt,onDismiss:Vt,description:Ft,confirmButtonLabel:dn,title:Cn,isActionLoading:Un}){const ts=(0,g.of)(z),ms=()=>(0,t.jsx)("div",{className:ts.bodyContainer,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(K.K,{size:"xl",name:"angle-left","aria-label":(0,v.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:Vt}),(0,t.jsx)(N.E,{variant:"h4",children:Cn})]}),Un&&(0,t.jsx)(p.y,{})]})});return(0,t.jsx)(V.k,{body:(0,t.jsx)(ms,{}),description:Ft,confirmButtonLabel:dn,confirmButtonVariant:"destructive",dismissButtonLabel:(0,v.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:gt,onDismiss:Vt})}const z=gt=>({bodyContainer:(0,s.css)({marginBottom:gt.spacing(2)})}),w=(0,L.createContext)(void 0),H=()=>{const gt=(0,L.useContext)(w);if(gt===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return gt};var G=e(49785),X=e(44617),k=e(86489),_=e(6736),ee=e(79784),J=e(34128),Z=e(64229);const te=u.Tp.pages.ShareDashboardDrawer.ShareExternally.Configuration;function ae(){const gt=(0,g.of)(re),{dashboard:Vt}=H(),[Ft,{isLoading:dn}]=(0,I.T2)(),{data:Cn}=I.Sm.endpoints?.getPublicDashboard.useQueryState(Vt.state.uid),Un=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite),ts=dn||!Un,us=r.jh.getTimeRange(Vt).useState(),{handleSubmit:Yt,setValue:ot,control:ct}=(0,G.mN)({defaultValues:{isAnnotationsEnabled:Cn?.annotationsEnabled,isTimeSelectionEnabled:Cn?.timeSelectionEnabled}}),ft=async(Kt,Zt)=>{ot(Kt,Zt),await Yt(tn=>vt({...tn,[Kt]:Zt}))()},vt=Kt=>{const{isAnnotationsEnabled:Zt,isTimeSelectionEnabled:tn}=Kt;Ft({dashboard:Vt,payload:{...Cn,annotationsEnabled:Zt,timeSelectionEnabled:tn}})};return(0,t.jsxs)(o.B,{direction:"column",gap:2,children:[(0,t.jsx)(N.E,{element:"p",children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)("form",{onSubmit:Yt(vt),children:(0,t.jsx)(X.n,{disabled:ts,children:(0,t.jsxs)(o.B,{direction:"column",gap:2,children:[(0,t.jsxs)(o.B,{gap:1,children:[(0,t.jsx)(G.xI,{render:({field:{ref:Kt,...Zt}})=>(0,t.jsx)(E.d,{...Zt,"data-testid":te.enableTimeRangeSwitch,onChange:tn=>{P.c.publicDashboardTimeSelectionChanged({enabled:tn.currentTarget.checked}),ft("isTimeSelectionEnabled",tn.currentTarget.checked)},label:(0,v.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:ct,name:"isTimeSelectionEnabled"}),(0,t.jsx)(m.J,{description:(0,v.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,t.jsxs)(o.B,{gap:1,children:[(0,t.jsx)(G.xI,{render:({field:{ref:Kt,...Zt}})=>(0,t.jsx)(E.d,{...Zt,"data-testid":te.enableAnnotationsSwitch,onChange:tn=>{P.c.publicDashboardAnnotationsSelectionChanged({enabled:tn.currentTarget.checked}),ft("isAnnotationsEnabled",tn.currentTarget.checked)},label:(0,v.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:ct,name:"isAnnotationsEnabled"}),(0,t.jsx)(m.J,{style:{flex:1},description:(0,v.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this dashboard"),children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,t.jsxs)(o.B,{gap:1,alignItems:"flex-start",children:[(0,t.jsx)("div",{className:gt.timeRange,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.configuration.time-range-label",children:"Time range"})}),(0,t.jsx)("div",{className:(0,s.cx)(gt.timeRange,gt.timeRangeValue),children:(0,t.jsx)(Z.f,{value:us.value})}),(0,t.jsx)(_.m,{placement:"right",content:(0,v.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(ee.I,{name:"info-circle",size:"md"})})]})]})})}),dn&&(0,t.jsx)(p.y,{})]})]})}const re=gt=>({timeRange:(0,s.css)({fontSize:gt.typography.bodySmall.fontSize,fontWeight:gt.typography.bodySmall.fontWeight}),timeRangeValue:(0,s.css)({color:gt.colors.text.secondary})});var ne=e(19224),ce=e(60232);const le=u.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,he=({onDelete:gt,onReshare:Vt})=>(0,t.jsxs)(ne.W,{children:[(0,t.jsx)(ne.W.Item,{label:(0,v.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:Vt}),(0,t.jsx)(ne.W.Item,{label:(0,v.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:gt})]}),oe=({recipients:gt,dashboardUid:Vt,publicDashboard:Ft})=>{const dn=(0,g.of)(me),[Cn,{isLoading:Un}]=(0,I.$L)(),[ts,{isLoading:ms}]=(0,I.NA)(),us=Un||ms,Yt=(ct,ft)=>{P.c.revokePublicDashboardEmailClicked(),Cn({recipientUid:ct,recipientEmail:ft,dashboardUid:Vt,uid:Ft.uid})},ot=ct=>{P.c.resendPublicDashboardEmailClicked(),ts({recipientUid:ct,uid:Ft.uid})};return(0,t.jsx)("table",{"data-testid":le.EmailSharingList,className:dn.table,children:(0,t.jsx)("tbody",{children:gt.map((ct,ft)=>(0,t.jsxs)("tr",{className:dn.listItem,children:[(0,t.jsx)("td",{className:dn.user,children:(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)("div",{className:dn.icon,children:(0,t.jsx)(ee.I,{name:"user"})}),(0,t.jsx)(N.E,{children:ct.recipient})]})}),(0,t.jsx)("td",{children:us&&(0,t.jsx)(p.y,{})}),(0,t.jsx)("td",{children:(0,t.jsx)(ce.m,{overlay:(0,t.jsx)(he,{onDelete:()=>Yt(ct.uid,ct.recipient),onReshare:()=>ot(ct.uid)}),children:(0,t.jsx)(K.K,{name:"ellipsis-v","aria-label":"email-menu",variant:"secondary",size:"lg"})})})]},ct.uid))})})},de=({dashboard:gt})=>{const Vt=(0,g.of)(me),{data:Ft}=I.Sm.endpoints?.getPublicDashboard.useQueryState(gt.state.uid);return(0,t.jsx)(k.D,{label:(0,v.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,v.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:Vt.listField,children:Ft?.recipients?.length?(0,t.jsx)("div",{className:Vt.listContainer,children:(0,t.jsx)(oe,{recipients:Ft.recipients,dashboardUid:gt.state.uid,publicDashboard:Ft})}):(0,t.jsx)(t.Fragment,{})})},me=gt=>({listField:(0,s.css)({marginBottom:0}),listContainer:(0,s.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,s.css)({width:"100%"}),listItem:(0,s.css)({display:"flex",alignItems:"center",gap:gt.spacing(.5),padding:gt.spacing(.75,1),color:gt.colors.text.secondary}),user:(0,s.css)({flex:1}),icon:(0,s.css)({border:`${gt.spacing(.25)} solid ${gt.colors.text.secondary}`,padding:gt.spacing(.125,.5),borderRadius:gt.shape.radius.circle,color:gt.colors.text.secondary})}),Pe=u.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Ee=()=>{const{dashboard:gt}=H(),{data:Vt,isError:Ft}=I.Sm.endpoints?.getPublicDashboard.useQueryState(gt.state.uid),[dn,{isLoading:Cn}]=(0,I.NY)(),Un=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite),{register:ts,handleSubmit:ms,formState:{errors:us,isValid:Yt},reset:ot}=(0,G.mN)({defaultValues:{email:""},mode:"onSubmit"}),ct=async ft=>{P.c.publicDashboardEmailInviteClicked(),await dn({recipient:ft.email,uid:Vt.uid,dashboardUid:gt.state.uid}).unwrap(),ot({email:""})};return(0,t.jsxs)("div",{children:[(0,t.jsx)("form",{onSubmit:ms(ct),children:(0,t.jsx)(X.n,{disabled:!Un||Ft,children:(0,t.jsx)(k.D,{label:(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,t.jsx)(_.m,{placement:"right",content:(0,v.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,t.jsx)(ee.I,{name:"info-circle",size:"sm"})})]}),description:(0,v.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:us.email?.message,invalid:!!us.email?.message,children:(0,t.jsxs)(o.B,{direction:"row",children:[(0,t.jsx)(J.p,{placeholder:(0,v.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:Cn,...ts("email",{required:(0,v.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:W._l,message:(0,v.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":Pe.EmailSharingInput}),(0,t.jsx)(h.$n,{type:"submit",variant:"primary",disabled:Cn||!Yt,"data-testid":Pe.EmailSharingInviteButton,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,t.jsx)(de,{dashboard:gt}),(0,t.jsx)(B.c,{}),(0,t.jsx)(ae,{})]})};var be=e(81942),Se=e(37e3);const Xe="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#share-externally-with-specific-people",Qe=u.Tp.pages.ShareDashboardDrawer.ShareExternally;function we(){return(0,t.jsx)(Se.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Qe.emailSharingAlert,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,t.jsx)(h.$n,{variant:"secondary",onClick:()=>window.open(Xe,"_blank"),type:"button",children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const $e=u.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation,Fe=({hasError:gt})=>{const{dashboard:Vt,onDismiss:Ft}=H(),dn=(0,g.of)(Te),[Cn,{isLoading:Un,isError:ts}]=(0,I.U9)(),ms=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite),us=!ms||Un||ts||gt,{handleSubmit:Yt,register:ot,formState:{isValid:ct}}=(0,G.mN)({mode:"onChange"}),ft=()=>{P.c.generatePublicDashboardUrlClicked({share:W.Xo.EMAIL}),Cn({dashboard:Vt,payload:{share:W.Xo.EMAIL,isEnabled:!0}})};return(0,t.jsxs)(t.Fragment,{children:[ms&&(0,t.jsx)(we,{}),(0,t.jsx)("form",{onSubmit:Yt(ft),children:(0,t.jsxs)(X.n,{disabled:us,children:[(0,t.jsx)("div",{className:dn.checkbox,children:(0,t.jsx)(be.S,{...ot("billAcknowledgment",{required:!0}),label:(0,v.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(h.$n,{type:"submit",disabled:!ct,"data-testid":$e.EmailShare.createButton,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(h.$n,{variant:"secondary",onClick:Ft,"data-testid":$e.EmailShare.cancelButton,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),Un&&(0,t.jsx)(p.y,{})]})]})})]})},Te=gt=>({checkbox:(0,s.css)({marginBottom:gt.spacing(2)})}),Le=()=>{const{dashboard:gt}=H(),{data:Vt,isError:Ft}=I.Sm.endpoints?.getPublicDashboard.useQueryState(gt.state.uid);return(0,t.jsx)(t.Fragment,{children:Vt?(0,t.jsx)(Ee,{}):(0,t.jsx)(Fe,{hasError:Ft})})},Ge="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards",Me=u.Tp.pages.ShareDashboardDrawer.ShareExternally,De=()=>(0,t.jsx)(Se.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Me.publicAlert,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,t.jsx)(h.$n,{variant:"secondary",onClick:()=>window.open(Ge,"_blank"),type:"button",children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})}),Ke=u.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation;function Ie({hasError:gt}){const{dashboard:Vt,onDismiss:Ft}=H(),dn=(0,g.of)(Ne),Cn=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite),{handleSubmit:Un,register:ts,formState:{isValid:ms}}=(0,G.mN)({mode:"onChange"}),[us,{isLoading:Yt,isError:ot}]=(0,I.U9)(),ct=()=>{P.c.generatePublicDashboardUrlClicked({share:W.Xo.PUBLIC}),us({dashboard:Vt,payload:{share:W.Xo.PUBLIC,isEnabled:!0}})},ft=!Cn||Yt||ot||gt;return(0,t.jsxs)(t.Fragment,{children:[Cn&&(0,t.jsx)(De,{}),(0,t.jsx)("form",{onSubmit:Un(ct),children:(0,t.jsxs)(X.n,{disabled:ft,children:[(0,t.jsx)("div",{className:dn.checkbox,children:(0,t.jsx)(be.S,{...ts("publicAcknowledgment",{required:!0}),label:(0,v.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*"),"data-testid":Ke.willBePublicCheckbox})}),(0,t.jsxs)(o.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(h.$n,{type:"submit",disabled:!ms,"data-testid":Ke.PublicShare.createButton,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(h.$n,{variant:"secondary",onClick:Ft,"data-testid":Ke.PublicShare.cancelButton,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),Yt&&(0,t.jsx)(p.y,{})]})]})})]})}const Ne=gt=>({checkbox:(0,s.css)({marginBottom:gt.spacing(2)})});function ie(){const{dashboard:gt}=H(),{data:Vt,isError:Ft}=I.Sm.endpoints?.getPublicDashboard.useQueryState(gt.state.uid);return(0,t.jsx)(t.Fragment,{children:Vt?(0,t.jsx)(ae,{}):(0,t.jsx)(Ie,{hasError:Ft})})}var ve=e(25763),fe=e(48174),ge=e(75386),xe=e(84036);function je({publicDashboard:gt}){const{dashboard:Vt}=H(),Ft=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite),dn=(0,xe.b)(Vt),Cn=(Vt.state.$variables?.state.variables.length??0)>0;return(0,t.jsxs)(t.Fragment,{children:[Ft&&Cn&&(0,t.jsx)(fe.D,{showDescription:!1}),!Ft&&(0,t.jsx)(ge.t,{mode:gt?"edit":"create"}),Ft&&!!dn?.length&&(0,t.jsx)(ve.s,{unsupportedDataSources:dn.join(", ")}),gt?.share===W.Xo.EMAIL&&(0,W.AY)()&&(0,t.jsx)(we,{}),gt?.share===W.Xo.PUBLIC&&(0,t.jsx)(De,{})]})}var Ve=e(5005),ke=e(44826);const Oe=()=>({label:(0,v.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,v.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:W.Xo.PUBLIC,icon:"globe"}),nt=()=>({label:(0,v.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,v.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:W.Xo.EMAIL,icon:"users-alt"}),Je=u.Tp.pages.ShareDashboardDrawer.ShareExternally;function Be({setShareType:gt,options:Vt,value:Ft}){const{dashboard:dn}=H(),Cn=(0,g.of)(Ze),{data:Un}=I.Sm.endpoints?.getPublicDashboard.useQueryState(dn.state.uid),[ts,{isLoading:ms}]=(0,I.ft)(),us=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite),Yt=Oe(),ot=ct=>{if(!Un)return;P.c.publicDashboardShareTypeChange({shareType:ct===W.Xo.EMAIL?"email":"public"});const ft={dashboard:dn,payload:{...Un,share:ct}};ts(ft)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)(m.J,{description:Ft.description,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),ms&&(0,t.jsx)(p.y,{})]}),(0,W.AY)()?(0,t.jsx)(ke.l6,{"data-testid":Je.shareTypeSelect,options:Vt,value:Ft,disabled:!us,onChange:ct=>{gt(ct),ot(ct.value)},className:Cn.select}):(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,Ve.Uo)(Yt.icon)&&(0,t.jsx)(ee.I,{name:(0,Ve.Uo)(Yt.icon)}),(0,t.jsx)(N.E,{children:Yt.label})]})]})}const Ze=()=>({select:(0,s.css)({flex:1})}),tt=u.Tp.pages.ShareDashboardDrawer.ShareExternally,Re=()=>(0,W.AY)()?[nt(),Oe()]:[Oe()];class at extends r.Bs{static{this.Component=yt}getTabLabel(){return(0,v.t)("share-dashboard.menu.share-externally-title","Share externally")}}function yt({model:gt}){const[Vt,Ft]=(0,L.useState)(!1),dn=(0,g.of)(ht),Cn=(0,x.YQ)(gt),{data:Un,isLoading:ts}=(0,I.Bs)(Cn.state.uid),[ms,{isLoading:us}]=(0,I.bN)(),Yt=()=>{Ft(!0)},ot=async()=>{P.c.revokePublicDashboardClicked(),await ms({dashboard:Cn,uid:Un.uid,dashboardUid:Cn.state.uid}).unwrap(),Ft(!1)};return ts?(0,t.jsx)(U.a,{}):Vt?(0,t.jsx)(T,{title:(0,v.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,v.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:ot,onDismiss:()=>Ft(!1),description:(0,v.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:us}):(0,t.jsx)("div",{className:dn.container,children:(0,t.jsx)(ze,{publicDashboard:Un,onRevokeClick:Yt})})}function ze({publicDashboard:gt,onRevokeClick:Vt}){const Ft=Re(),dn=(0,L.useMemo)(()=>gt&&(0,W.AY)()?Ft.find(us=>us.value===gt?.share)??Ft[0]:Ft[0],[gt,Ft]),[Cn,Un]=(0,L.useState)(dn),ts=(0,L.useMemo)(()=>Cn.value===W.Xo.EMAIL&&(0,W.AY)()?(0,t.jsx)(Le,{}):(0,t.jsx)(ie,{}),[Cn]);return(0,t.jsxs)(o.B,{direction:"column",gap:2,"data-testid":tt.container,children:[(0,t.jsx)(je,{publicDashboard:gt}),(0,t.jsx)(Be,{setShareType:Un,value:Cn,options:Ft}),ts,gt&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.c,{spacing:0}),(0,t.jsx)(st,{publicDashboard:gt,onRevokeClick:Vt})]})]})}function st({publicDashboard:gt,onRevokeClick:Vt}){const{dashboard:Ft}=H(),[dn,{isLoading:Cn}]=(0,I.eq)(),Un=(0,g.of)(ht),ts=F.TP.hasPermission(A.AccessControlAction.DashboardsPublicWrite);function ms(){P.c.publicDashboardUrlCopied()}const us=async()=>{P.c.publicDashboardPauseSharingClicked({paused:!gt.isEnabled}),dn({dashboard:Ft,payload:{...gt,isEnabled:!gt.isEnabled}})};return(0,t.jsxs)(o.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,t.jsx)("div",{className:Un.actionsContainer,children:(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(D.b,{"data-testid":tt.Configuration.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,W.mL)(gt.accessToken),onClipboardCopy:ms,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,t.jsx)(h.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:Cn||!ts,onClick:Vt,"data-testid":tt.Configuration.revokeAccessButton,children:(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,t.jsx)(h.$n,{icon:gt.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:gt.isEnabled?(0,v.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:us,disabled:Cn||!ts,"data-testid":tt.Configuration.toggleAccessButton,children:gt.isEnabled?(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,t.jsx)(v.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),Cn&&(0,t.jsx)(p.y,{})]})}const ht=gt=>({container:(0,s.css)({paddingBottom:gt.spacing(2)}),actionsContainer:(0,s.css)({width:"100%"})});var It=e(43317);const Gt=u.Tp.pages.ShareDashboardDrawer.ShareInternally;function un({useLockedTime:gt,onToggleLockedTime:Vt,useShortUrl:Ft,onUrlShorten:dn,onChangeTheme:Cn,selectedTheme:Un,isLoading:ts}){return(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsxs)(o.B,{gap:2,direction:"column",children:[(0,t.jsxs)(o.B,{gap:1,direction:"column",children:[(0,t.jsxs)(o.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(E.d,{label:(0,v.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:gt,onChange:Vt,"data-testid":Gt.lockTimeRangeSwitch}),(0,t.jsx)(m.J,{description:(0,v.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(v.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,t.jsxs)(o.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(E.d,{id:"share-short-url",value:Ft,label:(0,v.t)("link.share.short-url-label","Shorten link"),onChange:dn,"data-testid":Gt.shortenUrlSwitch}),(0,t.jsx)(m.J,{children:(0,t.jsx)(v.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,t.jsx)(It.w,{selectedTheme:Un,onChange:Cn})]}),ts&&(0,t.jsx)(p.y,{})]})}var vn=e(41580),pn=e(75661);const xn=u.Tp.pages.ShareDashboardDrawer.ShareInternally;class cn extends vn.R{static{this.Component=jn}constructor(Vt){const{useAbsoluteTimeRange:Ft,useShortUrl:dn,theme:Cn}=(0,pn.yk)();super({...Vt,useLockedTime:Ft,useShortUrl:dn,selectedTheme:Cn}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}getTabLabel(){return(0,v.t)("share-dashboard.menu.share-internally-title","Share internally")}async onToggleLockedTime(){const Vt=!this.state.useLockedTime;(0,pn.F7)({useAbsoluteTimeRange:Vt,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const Vt=!this.state.useShortUrl;(0,pn.F7)({useShortUrl:Vt,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(Vt){(0,pn.F7)({theme:Vt,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(Vt)}}function jn({model:gt}){const Vt=(0,g.of)(_n),{useLockedTime:Ft,useShortUrl:dn,selectedTheme:Cn,isBuildUrlLoading:Un}=gt.useState();return(0,t.jsxs)("div",{className:xn.container,children:[(0,t.jsx)(Se.F,{severity:"info",title:(0,v.t)("link.share.config-alert-title","Link settings"),children:(0,t.jsx)(v.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes. Please note that these settings are saved within your current browser scope."})}),(0,t.jsx)("div",{className:Vt.configDescription,children:(0,t.jsx)(N.E,{variant:"body",children:(0,t.jsx)(v.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,t.jsx)(un,{useLockedTime:Ft,onToggleLockedTime:gt.onToggleLockedTime,useShortUrl:dn,onUrlShorten:gt.onUrlShorten,selectedTheme:Cn,onChangeTheme:gt.onThemeChange,isLoading:Un}),(0,t.jsx)(B.c,{spacing:1}),(0,t.jsx)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:(0,t.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",disabled:Un,getText:gt.getShareUrl,onClipboardCopy:gt.onCopy,className:Vt.copyButtonContainer,"data-testid":xn.copyUrlButton,children:(0,t.jsx)(v.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})})]})}const _n=gt=>({configDescription:(0,s.css)({marginBottom:gt.spacing(2)}),copyButtonContainer:(0,s.css)({marginTop:gt.spacing(2)})});var Ot=e(5805),Rt=e(54731),Ye=e(61351),dt=e(59936),lt=e(60641);const Pt="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#share-a-snapshot",Bt="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#panel-snapshot";function Jt({name:gt,onNameChange:Vt,onExpireChange:Ft,selectedExpireOption:dn,panelRef:Cn,disableInputs:Un,children:ts}){const ms=(0,g.of)(qt);return(0,t.jsxs)("div",{className:ms.container,children:[(0,t.jsx)(Se.F,{severity:"info",title:"",children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(N.E,{children:Cn?(0,t.jsx)(v.x6,{i18nKey:"snapshot.share-panel.info-alert",children:"A Grafana panel snapshot publicly shares a panel while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."}):(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,t.jsx)(h.$n,{variant:"secondary",onClick:()=>window.open(Cn?Bt:Pt,"_blank"),type:"button",children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,t.jsxs)("fieldset",{disabled:Un,children:[(0,t.jsx)(k.D,{label:(0,v.t)("snapshot.share.name-label","Snapshot name"),children:(0,t.jsx)(J.p,{id:"snapshot-name-input",value:gt,onChange:us=>Vt(us.currentTarget.value)})}),(0,t.jsx)(k.D,{label:(0,v.t)("snapshot.share.expiration-label","Expires in"),children:(0,t.jsx)(lt.z,{id:"expire-select-input",options:(0,dt.u)(),value:dn?.value,onChange:Ft})})]}),(0,t.jsx)(B.c,{}),ts]})}const qt=gt=>({container:(0,s.css)({paddingBottom:gt.spacing(2)})}),gn=u.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class On extends dt.l{static{this.Component=Tn}getTabLabel(){return(0,v.t)("share-dashboard.menu.share-snapshot-title","Share snapshot")}}function Tn({model:gt}){const[Vt,Ft]=(0,L.useState)(!1),[dn,Cn]=(0,L.useState)(!1),[Un,ts]=(0,L.useState)(1),{snapshotName:ms,snapshotSharingOptions:us,selectedExpireOption:Yt,panelRef:ot,onDismiss:ct,dashboardRef:ft}=gt.useState(),[vt,Kt]=(0,Ot.default)(async(Hn=!1)=>{const Qn=await gt.onSnapshotCreate(Hn);return ts(2),Qn}),[Zt,tn]=(0,Ot.default)(async Hn=>{const Qn=await gt.onSnapshotDelete(Hn);return ts(1),Ft(!1),Cn(!0),Qn}),En=()=>{ct?.()},Ln=()=>{gt.onSnasphotNameChange(ft.resolve().state.title),ts(1)},Gn=async()=>{await tn(vt.value?.deleteUrl),Ln()};return Vt?(0,t.jsx)(T,{title:(0,v.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,v.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:Gn,onDismiss:()=>Ft(!1),description:(0,v.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:Zt.loading}):(0,t.jsx)("div",{"data-testid":gn.container,children:(0,t.jsxs)(t.Fragment,{children:[Un===1&&dn&&(0,t.jsx)(Se.F,{severity:"info",title:"",onRemove:()=>Cn(!1),children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Snapshot deleted. It could take an hour to be cleared from CDN caches."})}),(0,t.jsx)(Jt,{name:ms??"",selectedExpireOption:Yt,onNameChange:gt.onSnasphotNameChange,onExpireChange:gt.onExpireChange,disableInputs:Un===2,panelRef:ot,children:(0,t.jsxs)(o.B,{justifyContent:"space-between",gap:{xs:2},direction:{xs:"column",xl:"row"},children:[Un===1?(0,t.jsx)(wn,{onCreateClick:Kt,isLoading:vt.loading,onCancelClick:En,sharingOptions:us}):Un===2&&vt.value&&(0,t.jsx)(ps,{url:vt.value.url,onDeleteClick:()=>Ft(!0),onNewSnapshotClick:Ln}),(0,t.jsx)(Rt.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",external:!0,children:(0,v.t)("snapshot.share.view-all-button","View all snapshots")})]})})]})})}const wn=({isLoading:gt,onCreateClick:Vt,onCancelClick:Ft,sharingOptions:dn})=>(0,t.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(h.$n,{variant:"primary",disabled:gt,onClick:()=>Vt(),"data-testid":gn.publishSnapshot,children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),dn?.externalEnabled&&(0,t.jsx)(h.$n,{variant:"secondary",disabled:gt,onClick:()=>Vt(!0),children:dn?.externalSnapshotName}),(0,t.jsx)(h.$n,{variant:"secondary",fill:"outline",onClick:Ft,children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),gt&&(0,t.jsx)(p.y,{})]}),ps=({url:gt,onDeleteClick:Vt,onNewSnapshotClick:Ft})=>{const dn=Ye.TP.hasPermission(A.AccessControlAction.SnapshotsDelete),Cn=dn?"":(0,v.t)("snapshot.share.delete-permission-tooltip","You don't have permission to delete snapshots");return(0,t.jsxs)(o.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>gt,"data-testid":gn.copyUrlButton,children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(h.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:Vt,disabled:!dn,tooltip:Cn,children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,t.jsx)(h.$n,{variant:"secondary",fill:"solid",onClick:Ft,children:(0,t.jsx)(v.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]})};var es=e(10627),ls=e(11395),Lt=e(32370),$t=e(4213),nn=e.n($t),on=e(41053),bn=e(75505),In=e(28082),Yn=e(37008);const zn=u.Tp.pages.ShareDashboardDrawer.ShareInternally.SharePanel;function St({title:gt,imageUrl:Vt,buildUrl:Ft,disabled:dn,theme:Cn}){const Un=(0,g.of)(zt),{handleSubmit:ts,register:ms,watch:us,formState:{errors:Yt,isValid:ot}}=(0,G.mN)({mode:"onChange",defaultValues:{width:1e3,height:500,scaleFactor:1}});(0,L.useEffect)(()=>{Ft({width:us("width"),height:us("height"),scale:us("scaleFactor")})},[Ft,us]);const[{loading:ct,value:ft,error:vt},Kt]=(0,on.A)(async Ln=>{const Gn=await(0,bn.s)((0,In.AI)().fetch({url:Ln,responseType:"blob"}));return new Blob([Gn.data],{type:"image/png"})},[]),Zt=async Ln=>{const{width:Gn,height:Hn,scaleFactor:Qn}=Ln;P.c.generatePanelImageClicked({width:Gn,height:Hn,scaleFactor:Qn,theme:Cn,shareResource:"panel"}),await Kt(Vt)},tn=()=>{P.c.downloadPanelImageClicked({shareResource:"panel"}),nn()(ft,`${gt}.png`)},En=()=>{Ft({width:us("width"),height:us("height"),scale:us("scaleFactor")})};return(0,t.jsx)("div",{"data-testid":zn.preview,children:(0,t.jsxs)(o.B,{gap:2,direction:"column",children:[(0,t.jsx)(N.E,{element:"h4",children:(0,t.jsx)(v.x6,{i18nKey:"share-panel-image.preview.title",children:"Panel preview"})}),(0,t.jsx)("form",{onSubmit:ts(Zt),children:(0,t.jsxs)(X.n,{disabled:!Lt.$.rendererAvailable,label:(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(N.E,{element:"h5",children:(0,t.jsx)(v.x6,{i18nKey:"share-panel-image.settings.title",children:"Image settings"})}),(0,t.jsx)(_.m,{content:(0,v.t)("share-panel-image.settings.max-warning","Setting maximums are limited by the image renderer service"),children:(0,t.jsx)(ee.I,{name:"info-circle",size:"sm"})})]}),children:[(0,t.jsxs)(o.B,{gap:1,justifyContent:"space-between",direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(k.D,{label:(0,v.t)("share-panel-image.settings.width-label","Width"),className:Un.imageConfigurationField,required:!0,invalid:!!Yt.width,error:Yt.width?.message,children:(0,t.jsx)(J.p,{...ms("width",{required:(0,v.t)("share-panel-image.settings.width-required","Width is required"),min:{value:1,message:(0,v.t)("share-panel-image.settings.width-min","Width must be equal or greater than 1")},valueAsNumber:!0,onChange:En}),placeholder:(0,v.t)("share-panel-image.settings.width-placeholder","1000"),type:"number",suffix:"px","data-testid":zn.widthInput})}),(0,t.jsx)(k.D,{label:(0,v.t)("share-panel-image.settings.height-label","Height"),className:Un.imageConfigurationField,required:!0,invalid:!!Yt.height,error:Yt.height?.message,children:(0,t.jsx)(J.p,{...ms("height",{required:(0,v.t)("share-panel-image.settings.height-required","Height is required"),min:{value:1,message:(0,v.t)("share-panel-image.settings.height-min","Height must be equal or greater than 1")},valueAsNumber:!0,onChange:En}),placeholder:(0,v.t)("share-panel-image.settings.height-placeholder","500"),type:"number",suffix:"px","data-testid":zn.heightInput})}),(0,t.jsx)(k.D,{label:(0,v.t)("share-panel-image.settings.scale-factor-label","Scale factor"),className:Un.imageConfigurationField,required:!0,invalid:!!Yt.scaleFactor,error:Yt.scaleFactor?.message,children:(0,t.jsx)(J.p,{...ms("scaleFactor",{required:(0,v.t)("share-panel-image.settings.scale-factor-required","Scale factor is required"),min:{value:1,message:(0,v.t)("share-panel-image.settings.scale-factor-min","Scale factor must be equal or greater than 1")},valueAsNumber:!0,onChange:En}),placeholder:(0,v.t)("share-panel-image.settings.scale-factor-placeholder","1"),type:"number","data-testid":zn.scaleFactorInput})})]}),(0,t.jsxs)(o.B,{gap:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(h.$n,{icon:"gf-layout-simple",variant:"secondary",fill:"solid",type:"submit",disabled:dn||ct||!ot,"data-testid":zn.generateImageButton,children:(0,t.jsx)(v.x6,{i18nKey:"link.share-panel.render-image",children:"Generate image"})}),(0,t.jsx)(h.$n,{onClick:tn,icon:"download-alt",variant:"secondary",disabled:!ft||ct||dn,"data-testid":zn.downloadImageButton,children:(0,t.jsx)(v.x6,{i18nKey:"link.share-panel.download-image",children:"Download image"})})]})]})}),ct&&(0,t.jsxs)("div",{children:[(0,t.jsx)(Yn.G,{width:128}),(0,t.jsx)("div",{className:Un.imageLoadingContainer,children:(0,t.jsx)(N.E,{variant:"body",children:gt||""})})]}),ft&&!ct&&(0,t.jsx)("img",{src:URL.createObjectURL(ft),alt:"panel-preview-img",className:Un.image}),vt&&!ct&&(0,t.jsx)(Se.F,{severity:"error",title:(0,v.t)("link.share-panel.render-image-error","Failed to render panel image"),children:(0,In.NF)(vt)?vt.statusText:(0,v.t)("link.share-panel.render-image-error-description","An error occurred when generating the image")})]})})}const zt=gt=>({imageConfigurationField:(0,s.css)({flex:1}),image:(0,s.css)({maxWidth:"100%",width:"max-content"}),imageLoadingContainer:(0,s.css)({maxWidth:"100%",height:362,border:`1px solid ${gt.components.input.borderColor}`,padding:gt.spacing(1)})});class Qt extends vn.R{static{this.Component=an}constructor(Vt){super(Vt)}getTabLabel(){return(0,v.t)("share-panel.drawer.share-link-title","Link settings")}}function an({model:gt}){const Vt=(0,g.of)(mn),{useLockedTime:Ft,useShortUrl:dn,selectedTheme:Cn,isBuildUrlLoading:Un,imageUrl:ts,panelRef:ms}=gt.useState(),us=ms?.resolve().state.title,ot=!!(0,x.YQ)(gt).state.uid;return(0,t.jsxs)("div",{children:[(0,t.jsx)(N.E,{variant:"body",children:(0,t.jsx)(v.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})}),(0,t.jsxs)("div",{className:Vt.configurationContainer,children:[(0,t.jsx)(un,{useLockedTime:Ft,onToggleLockedTime:gt.onToggleLockedTime,useShortUrl:dn,onUrlShorten:gt.onUrlShorten,selectedTheme:Cn,onChangeTheme:gt.onThemeChange,isLoading:Un}),(0,t.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",disabled:Un,getText:gt.getShareUrl,onClipboardCopy:gt.onCopy,children:(0,t.jsx)(v.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})]}),(0,t.jsx)(B.c,{spacing:2}),(0,t.jsxs)(o.B,{gap:2,direction:"column",children:[!ot&&(0,t.jsx)(Se.F,{severity:"info",title:(0,v.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(v.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!Lt.$.rendererAvailable&&(0,t.jsx)(Se.F,{severity:"info",title:(0,v.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(v.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})}),(0,t.jsx)(St,{title:us||"",buildUrl:gt.buildUrl,imageUrl:ts,disabled:!ot,theme:Cn})]})]})}const mn=gt=>({configurationContainer:(0,s.css)({marginTop:gt.spacing(2)})}),yn=[];function Ct(gt){yn.push(gt)}class ut extends r.Bs{constructor(Vt){super({...Vt}),this.onDismiss=()=>{this.state.panelRef?(0,x.YQ)(this).closeModal():n.Ny.partial({shareView:null})},this.addActivationHandler(()=>this.buildActiveShare(Vt.shareView))}static{this.Component=Et}buildActiveShare(Vt){const{panelRef:Ft}=this.state,dn=(0,x.YQ)(this),Cn=Ft?Wt(Vt,this.onDismiss,dn.getRef(),Ft):Ut(Vt,this.onDismiss,dn.getRef(),Ft);this.setState({activeShare:Cn})}}function Et({model:gt}){const{activeShare:Vt}=gt.useState(),Ft=(0,x.YQ)(gt);return(0,t.jsx)(a._,{title:Vt?.getTabLabel(),onClose:gt.onDismiss,size:"md",children:(0,t.jsx)(w.Provider,{value:{dashboard:Ft,onDismiss:gt.onDismiss},children:Vt&&(0,t.jsx)(Vt.Component,{model:Vt})})})}function Ut(gt,Vt,Ft,dn){const Cn=yn.find(Un=>Un.id===gt);if(Cn)return new Cn.shareOption({onDismiss:Vt});switch(gt){case i.wr.link:return new cn({onDismiss:Vt});case i.wr.publicDashboard:return new at({onDismiss:Vt});case i.wr.snapshot:return new On({dashboardRef:Ft,panelRef:dn,onDismiss:Vt});case i.wr.export:return new M({onDismiss:Vt});default:return new cn({onDismiss:Vt})}}function Wt(gt,Vt,Ft,dn){switch(gt){case i.wr.link:return new Qt({panelRef:dn,onDismiss:Vt});case i.wr.snapshot:return new On({dashboardRef:Ft,panelRef:dn,onDismiss:Vt});case i.wr.embed:return new ls.c({panelRef:dn,onDismiss:Vt});case i.wr.libraryPanel:return new es.S({panelRef:dn,onDismiss:Vt});default:return new Qt({panelRef:dn,onDismiss:Vt})}}},24470:(q,j,e)=>{"use strict";e.d(j,{N:()=>y});var t=e(74848),n=e(4213),r=e.n(n),a=e(16817),i=e(70713),x=e(61034),s=e(48583),c=e(86489),d=e(29010),u=e(25356),g=e(54594),o=e(3886),E=e(93604),m=e(11817),f=e(86872),p=e(25309),h=e(36503),D=e(10817),C=e(17738),l=e(83424),v=e(2044);class y extends x.Bs{constructor(S){super({isSharingExternally:!1,isViewingJSON:!1,...S}),this.tabId=p.wr.export,this._exporter=new f.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:M}=this.state,O=(0,D.Uy)((0,v.YQ)(this));return M?await this._exporter.makeExportable(new h.G(O,void 0,{getVariablesFromState:()=>(0,C.E)(window.__grafanaSceneContext)})):O},this.onSaveAsFile=async()=>{const M=await this.getExportableDashboardJson(),O=JSON.stringify(M,null,2),{isSharingExternally:R}=this.state,L=new Blob([O],{type:"application/json;charset=utf-8"}),B=new Date().getTime();let F="dashboard";"title"in M&&M.title&&(F=M.title),r()(L,`${F}-${B}.json`),l.c.exportDownloadJsonClicked({externally:R})}}static{this.Component=P}getTabLabel(){return(0,m.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function P({model:b}){const{isSharingExternally:S,isViewingJSON:M,modalRef:O}=b.useState(),R=(0,a.A)(async()=>{if(M){const B=await b.getExportableDashboardJson();return JSON.stringify(B,null,2)}return""},[M]),L=(0,m.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[!M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(s.B,{gap:2,direction:"column",children:(0,t.jsx)(c.D,{label:L,children:(0,t.jsx)(d.d,{id:"share-externally-toggle",value:S,onChange:b.onShareExternallyChange})})}),(0,t.jsxs)(u.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{variant:"secondary",onClick:()=>{O?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(g.$n,{variant:"secondary",icon:"brackets-curly",onClick:b.onViewJSON,children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(g.$n,{variant:"primary",icon:"save",onClick:()=>b.onSaveAsFile(),children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.default,{disableHeight:!0,children:({width:B})=>R.value?(0,t.jsx)(o.B,{value:R.value??"",language:"json",showMiniMap:!1,height:"500px",width:B}):R.loading?(0,t.jsxs)("div",{children:[" ",(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.loading",children:"Loading..."})]}):null}),(0,t.jsxs)(u.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{variant:"secondary",fill:"outline",onClick:b.onViewJSON,icon:"arrow-left",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,t.jsx)(E.b,{variant:"secondary",icon:"copy",disabled:R.loading,getText:()=>R.value??"",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,t.jsx)(g.$n,{variant:"primary",icon:"save",disabled:R.loading,onClick:()=>b.onSaveAsFile(),children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},10627:(q,j,e)=>{"use strict";e.d(j,{S:()=>o});var t=e(74848),n=e(32370),r=e(61034),a=e(11817),i=e(38644),x=e(25309),s=e(36503),c=e(63845),d=e(60101),u=e(10817),g=e(2044);class o extends r.Bs{constructor(){super(...arguments),this.tabId=x.wr.libraryPanel}static{this.Component=E}getTabLabel(){return n.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.new-library-panel-title","New library panel"):(0,a.t)("share-modal.tab-title.library-panel","Library panel")}}function E({model:m}){const{panelRef:f,modalRef:p}=m.useState();if(!f)return null;const h=f.resolve(),D=h.parent;if(D instanceof d.U){const C=(0,g.YQ)(m),l=(0,u.ZB)(D),v=new c.a9(l),y=(0,u.Uy)(C),P=new s.G(y);return(0,t.jsx)(i.j,{initialFolderUid:C.state.meta.folderUid,dashboard:P,panel:v,onDismiss:()=>{p?p.resolve().onDismiss():C.closeModal()},onCreateLibraryPanel:b=>C.createLibraryPanel(h,b)})}return null}},41580:(q,j,e)=>{"use strict";e.d(j,{R:()=>l});var t=e(74848),n=e(3202),r=e(58779),a=e(32370),i=e(61034),x=e(44617),s=e(86489),c=e(29010),d=e(34128),u=e(93604),g=e(79784),o=e(37e3),E=e(11817),m=e(65552),f=e(43317),p=e(25309),h=e(32480),D=e(83424),C=e(2044);class l extends i.Bs{constructor(b){super({...b,useLockedTime:b.useLockedTime??!0,useShortUrl:b.useShortUrl??!1,selectedTheme:b.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=p.wr.link,this.buildUrl=async S=>{this.setState({isBuildUrlLoading:!0});const{panelRef:M,useLockedTime:O,useShortUrl:R,selectedTheme:L}=this.state,B=(0,C.YQ)(this),F=M?.resolve(),I={useAbsoluteTimeRange:O,theme:L,useShortUrl:R};let U=(0,m.VN)(B,I,F);R&&(U=await(0,m.fn)(U));const W=i.jh.getTimeRange(F??B),A=(0,m.$l)(I,W,F);let N=A;F&&(delete N.viewPanel,N.panelId=F.state.key,N["__feature.dashboardSceneSolo"]=!0);const K=(0,h.u)({uid:B.state.uid,currentQueryParams:location.search,updateQuery:{...A,...S,panelId:F?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:y(W.getTimeZone())});this.setState({shareUrl:U,imageUrl:K,isBuildUrlLoading:!1})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{D.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,p.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=v}getTabLabel(){return(0,E.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const b=!this.state.useLockedTime;this.setState({useLockedTime:b}),await this.buildUrl()}async onUrlShorten(){const b=!this.state.useShortUrl;this.setState({useShortUrl:b}),await this.buildUrl()}async onThemeChange(b){this.setState({selectedTheme:b}),await this.buildUrl()}}function v({model:P}){const b=P.useState(),{panelRef:S}=b,M=(0,C.YQ)(P),O=S?.resolve(),L=i.jh.getTimeRange(O??M).state.to==="now",{useLockedTime:B,useShortUrl:F,selectedTheme:I,shareUrl:U,imageUrl:W}=b,A=r.Tp.pages.SharePanelModal,N=!!M.state.uid,K=(0,E.t)("share-modal.link.time-range-label","Lock time range"),V=(0,E.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),T=(0,E.t)("share-modal.link.shorten-url","Shorten URL"),z=(0,E.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(E.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(x.n,{children:[(0,t.jsx)(s.D,{label:K,description:L?V:"",children:(0,t.jsx)(c.d,{id:"share-current-time-range",value:B,onChange:P.onToggleLockedTime})}),(0,t.jsx)(f.w,{selectedTheme:I,onChange:P.onThemeChange}),(0,t.jsx)(s.D,{label:T,children:(0,t.jsx)(c.d,{id:"share-shorten-url",value:F,onChange:P.onUrlShorten})}),(0,t.jsx)(s.D,{label:z,children:(0,t.jsx)(d.p,{id:"link-url-input",value:U,readOnly:!0,addonAfter:(0,t.jsx)(u.b,{icon:"copy",variant:"primary",getText:P.getShareUrl,onClipboardCopy:P.onCopy,children:(0,t.jsx)(E.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),O&&a.$.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[N&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("a",{href:W,target:"_blank",rel:"noreferrer","aria-label":A.linkToRenderedImage,children:[(0,t.jsx)(g.I,{name:"camera"}),"\xA0",(0,t.jsx)(E.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!N&&(0,t.jsx)(o.F,{severity:"info",title:(0,E.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(E.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),O&&!a.$.rendererAvailable&&(0,t.jsx)(o.F,{severity:"info",title:(0,E.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(E.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function y(P){const b="UTC"+encodeURIComponent((0,n.KQ)().format("Z"));if(P==="utc")return"UTC";if(P==="browser"){if(!window.Intl)return b;const M=window.Intl.DateTimeFormat().resolvedOptions();return M.timeZone?M.timeZone:b}return P}},19580:(q,j,e)=>{"use strict";e.d(j,{Z:()=>K});var t=e(74848),n=e(53027),r=e(32370),a=e(61034),i=e(37443),x=e(25356),s=e(11238),c=e(87638),d=e(11817),u=e(71488),g=e(61491),o=e(25309),E=e(83424),m=e(2044),f=e(24470),p=e(10627),h=e(41580),D=e(11395),C=e(59936),l=e(65728),v=e(2175),y=e(22803),P=e(29675),b=e(74031),S=e(65164);class M extends a.Bs{static{this.Component=O}constructor(z){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...z})}onDismiss(){}}function O({model:T}){const z=T.useState();return(0,t.jsx)(S.u,{...z})}var R=e(84036);function L({model:T,publicDashboard:z,isGetLoading:w}){const H=(0,P.of)(B),G=c.TP.hasPermission(g.AccessControlAction.DashboardsPublicWrite),X=(0,m.YQ)(T),{isDirty:k}=X.useState(),[_]=(0,l.bN)(),ee=(X.state.$variables?.state.variables.length??0)>0,J=(0,R.b)(X),te=a.jh.getTimeRange(T).useState();return(0,t.jsx)(b.b,{dashboard:X,publicDashboard:z,unsupportedDatasources:J,onRevoke:()=>{X.showModal(new M({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:(0,t.jsx)("p",{className:H.description,children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."}),onDismiss:()=>{X.showModal(new K({activeTab:o.wr.publicDashboard}))},onConfirm:()=>{_({dashboard:X,dashboardUid:X.state.uid,uid:z.uid}),X.closeModal()}}))},timeRange:te.value,showSaveChangesAlert:G&&k,hasTemplateVariables:ee})}const B=T=>({description:(0,y.css)({fontSize:T.typography.body.fontSize})});var F=e(18546);function I({model:T}){const z=(0,m.YQ)(T),w=(0,R.b)(z),H=(z.state.$variables?.state.variables.length??0)>0;return(0,t.jsx)(F.D,{dashboard:z,unsupportedDatasources:w,unsupportedTemplateVariables:H})}class U extends a.Bs{constructor(){super(...arguments),this.tabId=o.wr.publicDashboard}static{this.Component=W}getTabLabel(){return(0,d.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function W({model:T}){const{data:z,isLoading:w}=(0,l.Bs)((0,m.YQ)(T).state.uid);return(0,t.jsx)(t.Fragment,{children:w?(0,t.jsx)(v.a,{}):(0,u.lI)(z)?(0,t.jsx)(L,{model:T,publicDashboard:z,isGetLoading:w}):(0,t.jsx)(I,{model:T})})}const A=[];function N(T){A.push(T)}class K extends a.Bs{constructor(z){super({activeTab:"link",...z}),this.onDismiss=()=>{this.state.panelRef?(0,m.YQ)(this).closeModal():n.Ny.partial({shareView:null})},this.onChangeTab=w=>{E.c.sharingCategoryClicked({item:w.value,shareResource:(0,o.hD)(this.state.panelRef)}),this.setState({activeTab:w.value})},this.addActivationHandler(()=>this.buildTabs(z.activeTab))}static{this.Component=V}buildTabs(z){const{panelRef:w}=this.state,H=this.getRef(),G=[new h.R({panelRef:w,modalRef:H})],X=(0,m.YQ)(this);if(w||G.push(new f.N({modalRef:H})),c.TP.isSignedIn&&r.$.snapshotEnabled&&c.TP.hasPermission(g.AccessControlAction.SnapshotsCreate)&&G.push(new C.l({panelRef:w,dashboardRef:X.getRef(),modalRef:H})),w){G.push(new D.c({panelRef:w}));const _=w.resolve();_ instanceof a.Eb&&((0,m.ME)(_)||G.push(new p.S({panelRef:w,modalRef:H})))}w||(G.push(...A.map(_=>new _({modalRef:H}))),(0,u.iR)()&&G.push(new U({modalRef:H})));const k=G.find(_=>_.tabId===z);this.setState({activeTab:k?.tabId??G[0].tabId,tabs:G})}}function V({model:T}){const{panelRef:z,tabs:w,activeTab:H}=T.useState(),G=z?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share");if(!w)return;const X=w?.map(ee=>({label:ee.getTabLabel(),value:ee.tabId})),k=(0,t.jsx)(i.J,{title:G,icon:"share-alt",tabs:X,activeTab:H,onChangeTab:T.onChangeTab}),_=w.find(ee=>ee.tabId===H);return(0,t.jsx)(x.a,{isOpen:!0,title:k,onDismiss:T.onDismiss,children:(0,t.jsx)(s.J,{children:_&&(0,t.jsx)(_.Component,{model:_})})})}},11395:(q,j,e)=>{"use strict";e.d(j,{c:()=>u});var t=e(74848),n=e(32370),r=e(61034),a=e(11817),i=e(19346),x=e(25309),s=e(36054),c=e(32480),d=e(2044);class u extends r.Bs{constructor(m){super(m),this.tabId=x.wr.embed}static{this.Component=g}getTabLabel(){return n.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.share-embed-title","Share embed"):(0,a.t)("share-modal.tab-title.panel-embed","Embed")}}function g({model:E}){const{panelRef:m}=E.useState(),f=m.resolve(),p=(0,d.YQ)(E),{uid:h}=p.useState(),D=(0,d.Cs)(f),C=r.jh.getTimeRange(f),l=C instanceof s.v?C.state.timeFrom:void 0;return(0,t.jsx)(i.D,{panel:{id:D,timeFrom:l},range:C.state.value,dashboard:{uid:h??"",time:C.state.value},buildIframe:o(p),onCancelClick:()=>p.closeModal()})}const o=E=>(m,f,p,h,D)=>{const C=(0,x.XV)({useCurrentTimeRange:m,selectedTheme:p,panel:h,range:D}),l=C.get("editPanel")??C.get("viewPanel")??"";return C.set("panelId",l),C.delete("editPanel"),C.delete("viewPanel"),C.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,c.u)({absolute:!0,soloRoute:!0,uid:E.state.uid,slug:E.state.meta.slug,currentQueryParams:C.toString()})}" width="450" height="200" frameborder="0"></iframe>`}},59936:(q,j,e)=>{"use strict";e.d(j,{l:()=>b,u:()=>y});var t=e(74848),n=e(5805),r=e(58779),a=e(28082),i=e(61034),x=e(86489),s=e(34128),c=e(60641),d=e(25356),u=e(54594),g=e(48583),o=e(93604),E=e(23737),m=e(17687),f=e(11817),p=e(25309),h=e(77274),D=e(83394),C=e(10817),l=e(83424);const v=r.Tp.pages.ShareDashboardModal.SnapshotScene,y=()=>{const M={label:(0,f.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,f.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,f.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},M,{label:(0,f.t)("share-modal.snapshot.expire-never","Never"),value:0}]},P=()=>y()[2];class b extends i.Bs{constructor(O){super({...O,snapshotName:O.dashboardRef.resolve().state.title,selectedExpireOption:P()}),this.tabId=p.wr.snapshot,this.onSnasphotNameChange=R=>{this.setState({snapshotName:R})},this.onExpireChange=R=>{this.setState({selectedExpireOption:y().find(L=>L.value===R)})},this.onSnapshotCreate=async(R=!1)=>{const{selectedExpireOption:L}=this.state,B=this.prepareSnapshot(),F={dashboard:B,name:B.title,expires:L?.value,external:R};try{const I=await(0,h.s)().create(F);return(0,D.JD)((0,E.dx)((0,m.tZ)((0,f.t)("snapshot.share.success-creation","Your snapshot has been created")))),I}finally{R?l.c.publishSnapshotClicked({expires:F.expires,shareResource:(0,p.hD)(this.state.panelRef)}):l.c.publishSnapshotLocalClicked({expires:F.expires,shareResource:(0,p.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async R=>{const L=await(0,a.AI)().get(R);return(0,D.JD)((0,E.dx)((0,m.tZ)((0,f.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),L},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=S}_onActivate(){(0,h.s)().getSharingOptions().then(O=>{this.isActive&&this.setState({snapshotSharingOptions:O})})}getTabLabel(){return(0,f.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const O=i.jh.getTimeRange(this),{dashboardRef:R,panelRef:L}=this.state,B=(0,C.Uy)(R.resolve(),!0);return(0,C.c)(this.state.snapshotName.trim()||"",O.state.value,B,L?.resolve())}}function S({model:M}){const{snapshotName:O,selectedExpireOption:R,modalRef:L,snapshotSharingOptions:B}=M.useState(),[F,I]=(0,n.default)(async(A=!1)=>M.onSnapshotCreate(A)),[U,W]=(0,n.default)(async A=>await(0,a.AI)().get(A));return U.value?(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,t.jsxs)(t.Fragment,{children:[!F.value&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{children:(0,t.jsxs)(f.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(x.D,{label:(0,f.t)("share-modal.snapshot.name","Snapshot name"),children:(0,t.jsx)(s.p,{id:"snapshot-name-input",width:30,defaultValue:O,onBlur:A=>M.onSnasphotNameChange(A.target.value)})}),(0,t.jsx)(x.D,{label:(0,f.t)("share-modal.snapshot.expire","Expire"),children:(0,t.jsx)(c.z,{id:"expire-select-input",options:y(),value:R?.value,onChange:M.onExpireChange})}),(0,t.jsxs)(d.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:()=>{L?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),B?.externalEnabled&&(0,t.jsx)(u.$n,{variant:"secondary",disabled:F.loading,onClick:()=>I(!0),children:B?.externalSnapshotName}),(0,t.jsx)(u.$n,{variant:"primary",disabled:F.loading,onClick:()=>I(),"data-testid":v.PublishSnapshot,children:(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),F.value&&(0,t.jsxs)(g.B,{direction:"column",gap:0,children:[(0,t.jsx)(x.D,{label:(0,f.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(s.p,{"data-testid":v.CopyUrlInput,id:"snapshot-url-input",value:F.value.url,readOnly:!0,addonAfter:(0,t.jsx)(o.b,{"data-testid":v.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>F.value.url,children:(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(u.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{W(F.value.deleteUrl)},children:(0,t.jsx)(f.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},84036:(q,j,e)=>{"use strict";e.d(j,{b:()=>d});var t=e(16817),n=e(65502),r=e(4826),a=e(10059),i=e(2044);const x=async u=>{let g=new Set;for(const o of u)r.z.has(o)&&await(0,a.tR)().get(o)instanceof n.iy||g.add(o);return Array.from(g)};function s(u){const g=new Set,o=u.state.body.getVizPanels();for(const E of o){const m=c(E);for(const f of m)g.add(f)}return Array.from(g).sort()}function c(u){const g=new Set,o=(0,i.un)(u);if(o)for(const E of o.state.queries)g.add(E.datasource?.type??"");return Array.from(g)}function d(u){const{value:g}=(0,t.A)(async()=>{const o=s(u);return x(o)},[]);return g}},95761:(q,j,e)=>{"use strict";e.d(j,{R:()=>r});var t=e(61034),n=e(2044);class r{constructor(i){this._vizPanel=i}get id(){const i=(0,n.Cs)(this._vizPanel);return isNaN(i)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):i}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof t.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const i=(0,n.un)(this._vizPanel);return i?i.state.queries:[]}get datasource(){return(0,n.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},9964:(q,j,e)=>{"use strict";e.d(j,{Dq:()=>u,Ry:()=>s,ag:()=>o,d9:()=>x,ed:()=>g,lv:()=>i,oX:()=>c,uc:()=>d});const t="-clone-",n="/",r=new RegExp(`${t}[1-9][0-9]*$`),a=new RegExp(`${t}\\d+$`);function i(E,m){const f=E.split(n).slice(0,-1),p=x(u(E));return[...f,`${p}${t}${m}`].join(n)}function x(E){return u(E).replace(a,"")}function s(E){return r.test(u(E))}function c(E,m){return s(E)&&x(E)===x(m)}function d(E){return E.split(n).some(s)}function u(E){return E.split(n).pop()??""}function g(...E){return E.filter(Boolean).join(n)}function o(E){return E.includes(t)}},78974:(q,j,e)=>{"use strict";e.d(j,{w:()=>a});var t=e(32370),n=e(61034),r=e(79938);function a(i){if(!i.targets?.length||t.$.panels[i.type]?.skipDataQuery)return;let x;return x=new n.dt({datasource:i.datasource??void 0,queries:i.targets,maxDataPoints:i.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:i.cacheTimeout,queryCachingTTL:i.queryCachingTTL,minInterval:i.interval??void 0,dataLayerFilter:{panelId:i.id},$behaviors:[new r.L({})]}),new n.Es({$data:x,transformations:i.transformations||[]})}},18745:(q,j,e)=>{"use strict";e.d(j,{b4:()=>m});var t=e(61034),n=e(7001),r=e(3987),a=e(9964),i=e(2044);function x(f){return f.state.controls?.state.timePicker}function s(f){return f.state.controls?.state.refreshPicker}function c(f){return f.state.titleItems&&Array.isArray(f.state.titleItems)?f.state.titleItems.find(h=>h instanceof r.$)??null:null}function d(f){return f.state.body.getVizPanels()}function u(f){let p=0;return t.jh.findAllObjects(f.getRoot(),h=>h instanceof t.Eb||h instanceof t.tI).forEach(h=>{if((0,a.Ry)(h.state.key))return;const D=(0,i.Cs)(h);D>p&&(p=D)}),p+1}function g(f){const p=t.jh.getData(f);if(!(p instanceof n.s))throw new Error("DashboardDataLayerSet not found");return p}function o(f){return(0,i.YQ)(f).state.editPane.state.selection?.getSelectionEntries().map(([,p])=>p.resolve())??[]}function E(f){const p=f.state.$behaviors?.find(h=>h instanceof t.Gg.K2);if(p instanceof t.Gg.K2)return p}const m={getTimePicker:x,getRefreshPicker:s,getPanelLinks:c,getVizPanels:d,getDataLayers:g,getAllSelectedObjects:o,getCursorSync:E,getLayoutManagerFor:i.h$,getNextPanelId:u}},79556:(q,j,e)=>{"use strict";e.d(j,{Gq:()=>x,zf:()=>s});var t=e(93407),n=e(53027),r=e(32370),a=e(61034);const i="grafana.dashboard.preservedUrlFiltersState";function x(c){const d=window.sessionStorage.getItem(i);if(d){const u=new URLSearchParams(d),g=n.Ny.getSearch();u.forEach((E,m)=>{g.has(m)||g.append(m,E)});for(const E of Array.from(g.keys()))E.startsWith("var-")&&(c.state.$variables?.getByName(E.replace("var-",""))||g.delete(E));const o=g.toString();o&&n.Ny.replace({search:o})}}function s(c){if(r.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!c.state.uid)return;const d=Object.fromEntries(Object.entries(new a.g5().getUrlState(c)).filter(([g])=>g.startsWith("var-")||g==="from"||g==="to"||g==="timezone")),u=Object.fromEntries(Object.entries(d).filter(([g,o])=>!(Array.isArray(o)&&o.length===0)));Object.keys(u).length>0?window.sessionStorage.setItem(i,t.kM.renderUrl("",u)):window.sessionStorage.removeItem(i)}}},32480:(q,j,e)=>{"use strict";e.d(j,{u:()=>a});var t=e(93407),n=e(53027),r=e(32370);function a(i){let x=`/d/${i.uid}`;i.uid||(x="/dashboard/new"),i.isSnapshot&&(x=`/dashboard/snapshot/${i.uid}`),i.soloRoute&&(x=`/d-solo/${i.uid}`),i.slug&&(x+=`/${i.slug}`),i.subPath&&(x+=i.subPath),i.render&&(x="/render"+x,i.updateQuery={...i.updateQuery,width:i.updateQuery?.width||1e3,height:i.updateQuery?.height||500,tz:i.timeZone}),i.isHomeDashboard&&(x="/");const s=i.currentQueryParams?(0,n.SE)(i.currentQueryParams):{};if(delete s.shareView,i.updateQuery)for(const d in i.updateQuery)i.updateQuery[d]===null||i.updateQuery[d]===void 0?delete s[d]:s[d]=i.updateQuery[d];const c=t.kM.renderUrl(x,s);return i.absolute?r.$.appUrl+c.slice(1):c}},17738:(q,j,e)=>{"use strict";e.d(j,{E:()=>r});var t=e(61034),n=e(33845);function r(a){const i=t.jh.getVariables(a);return(0,n.C)(i,!0)}},83424:(q,j,e)=>{"use strict";e.d(j,{c:()=>r});var t=e(56276);let n=!1;const r={dashboardInitialized:i=>{a("init_dashboard_completed",{...i})},panelLinkClicked:i=>{a("panelheader_datalink_clicked",i)},panelStatusMessageClicked:i=>{a("panelheader_statusmessage_clicked",i)},panelCancelQueryClicked:i=>{a("panelheader_cancelquery_clicked",i)},toolbarFavoritesClick:()=>{a("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{a("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{a("toolbar_actions_clicked",{item:"share"})},toolbarShareDropdownClick:()=>{a("toolbar_actions_clicked",{item:"share_dropdown"})},toolbarAddClick:()=>{a("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:i=>{a("sharing_category_clicked",i)},shareLinkCopied:i=>{a("sharing_link_copy_clicked",i)},embedSnippetCopy:i=>{a("sharing_embed_copy_clicked",i)},generatePanelImageClicked:i=>{a("sharing_link_generate_image_clicked",i)},downloadPanelImageClicked:i=>{a("sharing_link_download_image_clicked",i)},publishSnapshotClicked:i=>{a("sharing_snapshot_publish_clicked",i)},publishSnapshotLocalClicked:i=>{a("sharing_snapshot_local_clicked",i)},exportDownloadJsonClicked:i=>{a("sharing_export_download_json_clicked",i)},exportCopyJsonClicked:i=>{a("sharing_export_copy_json_clicked",i)},exportSaveJsonClicked:i=>{a("sharing_export_save_json_clicked",i)},exportViewJsonClicked:i=>{a("sharing_export_view_json_clicked",i)},generatePublicDashboardUrlClicked:i=>{a("sharing_public_generate_url_clicked",i)},revokePublicDashboardEmailClicked:i=>{a("sharing_public_email_revoke_clicked",i)},resendPublicDashboardEmailClicked:i=>{a("sharing_public_email_resend_clicked",i)},publicDashboardEmailInviteClicked:i=>{a("sharing_public_email_invite_clicked",i)},publicDashboardShareTypeChange:i=>{a("sharing_public_can_view_clicked",i)},publicDashboardTimeSelectionChanged:i=>{a("sharing_public_time_picker_clicked",i)},publicDashboardAnnotationsSelectionChanged:i=>{a("sharing_public_annotations_clicked",i)},publicDashboardUrlCopied:i=>{a("sharing_public_copy_url_clicked",i)},publicDashboardPauseSharingClicked:i=>{a("sharing_public_pause_clicked",i)},revokePublicDashboardClicked:i=>{a("sharing_public_revoke_clicked",i)},emptyDashboardButtonClicked:i=>{a("emptydashboard_clicked",i)},toolbarAddButtonClicked:i=>{a("toolbar_add_clicked",i)},setScenesContext:()=>(n=!0,()=>{n=!1}),versionRestoreClicked:i=>{a("version_restore_clicked",i)},showMoreVersionsClicked:()=>{a("show_more_versions_clicked")}},a=(i,x)=>{const s=n?{scenesView:!0}:{};x?(0,t.rR)(`dashboards_${i}`,{...x,...s}):(0,t.rR)(`dashboards_${i}`)}},80328:(q,j,e)=>{"use strict";e.d(j,{C:()=>t,Y:()=>n});const t={left:[],right:[]};function n(r,a){t[r].push(a)}},19892:(q,j,e)=>{"use strict";e.d(j,{Lp:()=>u,Uu:()=>d,e0:()=>c,r7:()=>s});var t=e(2567),n=e(53027),r=e(61034),a=e(87638),i=e(95536),x=e(2044);function s(g){return t.I.getUrlForPartial(n.Ny.getLocation(),{viewPanel:g.state.key,editPanel:void 0})}function c(g){return t.I.getUrlForPartial(n.Ny.getLocation(),{editPanel:g,viewPanel:void 0})}function d(g,o){const E=g.state.key?.replace("-view","");return t.I.getUrlForPartial(n.Ny.getLocation(),{inspect:E,inspectTab:o})}function u(g){const o=g.getPlugin(),E=(0,x.un)(g);if(!a.TP.hasAccessToExplore()||o?.meta.skipDataQuery||!E)return Promise.resolve(void 0);const m=r.jh.getTimeRange(g);return(0,i.Xe)({queries:E.state.queries,dsRef:E.state.datasource,timeRange:m.state.value,scopedVars:{__sceneObject:{value:g}},adhocFilters:E.state.data?.request?.filters})}},2044:(q,j,e)=>{"use strict";e.d(j,{Cs:()=>f,EX:()=>D,ME:()=>B,O8:()=>L,Sm:()=>P,Uv:()=>l,X0:()=>v,XA:()=>m,YQ:()=>O,a7:()=>y,bR:()=>I,bx:()=>b,h$:()=>N,iL:()=>F,pk:()=>S,sf:()=>U,sw:()=>o,ty:()=>K,un:()=>M,vL:()=>p,vm:()=>E,xz:()=>R,zo:()=>W});var t=e(61809),n=e(98437),r=e(61034),a=e(26197),i=e(79938),x=e(11997),s=e(72929),c=e(3987),d=e(66110),u=e(16045),g=e(9964);const o=8,E=12;function m(V){return`panel-${V}`}function f(V){return parseInt((0,g.d9)(V.state.key).replace("panel-",""),10)}function p(V,T){if(!T)return null;const z=h(V,T);if(z)return z;const w=parseInt(T,10);return isNaN(w)?null:h(V,m(w))}function h(V,T){if(!T)return null;const z=r.jh.findObject(V,w=>w.state.key===T?!0:(w instanceof r.Eb,!1));if(z){if(z instanceof r.Eb)return z;throw new Error(`Found panel with key ${T} but it was not a VizPanel`)}return null}function D(V,T){if(!T)return null;let z=C(V,T);if(z)return z;const w=parseInt(T,10);if(isNaN(w))return null;const H=m(w);return z=h(V,H),z||(z=C(V,H),z)}function C(V,T){if(!T)return null;const z=r.jh.findObject(V,w=>{const H=w.state.key;return H===T||!(0,g.uc)(H)&&(0,g.d9)(H)===(0,g.d9)(T)?!0:(w instanceof r.Eb,!1)});if(z){if(z instanceof r.Eb)return z;throw new Error(`Found panel with key ${T} but it was not a VizPanel`)}return null}function l(V,T){if(!T)return null;let z=D(V,T);if(!z||!z.state.key)return null;const w=(0,g.Dq)(z.state.key);if((0,g.ag)(w)){const H=(0,g.d9)(w);z=r.jh.findObject(z.parent??V,G=>{if(!G.state.key||(0,g.uc)(G.state.key))return!1;const X=(0,g.Dq)(G.state.key);return(0,g.ag)(X)?!1:(0,g.d9)(X)===H})}return z instanceof r.Eb?z:null}function v(V,T){V.forEachChild(z=>{z.isActive&&(z.forceRender(),v(z,T))})}function y(V){const{value:T,text:z,options:w}=V.state;return V.hasAllValue()?{values:w.map(H=>H.value),texts:w.map(H=>H.label)}:{values:Array.isArray(T)?T:[T],texts:Array.isArray(z)?z:[z]}}function P(V){const T=V.match(/(["'])(.*?)\1|\w+/g);if(!T)return a.Ez.query?.split(",")??[];const z=new Set,w=T.reduce((H,G)=>{const X=G.replace(/["']+/g,"");return X.startsWith("$__auto_interval_")||H.add(X),H},z);return Array.from(w)}function b(V){return Array.isArray(V)?V.join(","):""}function S(V,T){const z=Array.isArray(V.current.value)?V.current.value[0]:V.current.value;return z.startsWith("$__auto_interval_")?"$__auto":T.includes(z)?z:T[0]}function M(V){if(!V)return;const T=V.state.$data??V.parent?.state.$data;if(T instanceof r.dt)return T;if(T instanceof r.Es)return M(T)}function O(V){const T=V.getRoot();if(T instanceof x.H$)return T;throw new Error("SceneObject root is not a DashboardScene")}function R(V){return V instanceof r.Eb?V:V.parent?R(V.parent):null}function L(){return new r.Eb({title:"Panel Title",pluginId:"timeseries",titleItems:[new c.$({menu:new c.m({})})],hoverHeaderOffset:0,$behaviors:[],menu:new r.Lw({$behaviors:[d._i]}),$data:new r.Es({$data:new r.dt({queries:[{refId:"A"}],datasource:(0,t.p$)((0,n.l)().getInstanceSettings(null)),$behaviors:[new i.L({})]}),transformations:[]})})}function B(V){return F(V)!==void 0}function F(V){const T=V.state.$behaviors?.find(z=>z instanceof s.u);if(T)return T}function I(V){const T=Math.ceil(V.state.repeatedPanels.length/V.getMaxPerRow()),z=Math.ceil(V.state.repeatedPanels.length/T),w=24/z;return{h:V.state.itemHeight??10,w,columnCount:z}}function U(V){let T,z;return V.isActive?T:(V.parent&&(z=U(V.parent)),T=V.activate(),()=>{z?.(),T()})}function W(V){let T,z;return V.parent&&(z=W(V.parent)),V.isActive?()=>{z?.(),T?.()}:(T=V.activate(),()=>{z?.(),T?.()})}const A=null;function N(V){let T=V.parent;for(;T;){if((0,u.e)(T))return T;T=T.parent}throw new Error("Could not find layout manager for scene object")}function K(V){return`grid-item-${V}`}},5174:(q,j,e)=>{"use strict";e.d(j,{Op:()=>o});var t=e(32370),n=e(13076),r=e(46004),a=e(20708),i=e(83487),x=e(11686),s=e(97910),c=e(32815),d=e(66952);function u(U){if((0,d.HG)(U))return U;let W;(0,d.b_)(U)?W=U.spec:W=U.dashboard;const A=(0,r.ft)(),N=(0,r.hM)(),[K,V]=E(W.panels||[]),T=P(W.templating?.list||[]),z=b(W.annotations?.list||[]);let w,H,G,X;(0,d.b_)(U)?(w=U.access,H={...U.metadata.annotations,[a.hm]:W.gnetId??void 0},X=U.metadata.creationTimestamp,G={[a.Y5]:U.metadata.labels?.[a.Y5]}):(w={url:U.meta.url,slug:U.meta.slug,canSave:U.meta.canSave,canEdit:U.meta.canEdit,canDelete:U.meta.canDelete,canShare:U.meta.canShare,canStar:U.meta.canStar,canAdmin:U.meta.canAdmin,annotationsPermissions:U.meta.annotationsPermissions},H={[a.hc]:U.meta.createdBy,[a.Qu]:U.meta.updatedBy,[a.xU]:U.meta.updated,[a.ew]:U.meta.folderUid,[a.hX]:U.meta.slug,[a.hm]:W.gnetId??void 0,[a.qw]:U.meta.isSnapshot},X=U.meta.created,G={[a.Y5]:W.id?.toString()??void 0}),H?.[a.qw]&&(H[a.UL]=W.snapshot?.originalUrl);const k={title:W.title,description:W.description,tags:W.tags??[],cursorSync:(0,c.k6)(W.graphTooltip),preload:W.preload||N.preload,liveNow:W.liveNow,editable:W.editable,revision:W.revision,timeSettings:{from:W.time?.from||A.from,to:W.time?.to||A.to,timezone:W.timezone||A.timezone,autoRefresh:W.refresh||A.autoRefresh,autoRefreshIntervals:W.timepicker?.refresh_intervals||A.autoRefreshIntervals,fiscalYearStartMonth:W.fiscalYearStartMonth||A.fiscalYearStartMonth,hideTimepicker:W.timepicker?.hidden||A.hideTimepicker,quickRanges:W.timepicker?.quick_ranges,weekStart:W.weekStart||A.weekStart,nowDelay:W.timepicker?.nowDelay||A.nowDelay},links:W.links||[],annotations:z,variables:T,elements:K,layout:V};return{apiVersion:"v2alpha1",kind:"DashboardWithAccessInfo",metadata:{creationTimestamp:X||"",name:W.uid,resourceVersion:W.version?.toString()||"0",annotations:H,labels:G},spec:k,access:w}}function g(U){if(!(0,d.b_)(U))return U;const W=U.spec;if((0,d._5)(W))return{meta:{...U.access,isNew:!1,isFolder:!1,uid:U.metadata.name,k8s:U.metadata,version:parseInt(U.metadata.resourceVersion,10)},dashboard:W};{const A=M(W.annotations),N=S(W.variables),K=O(W.elements,W.layout);return{meta:{created:U.metadata.creationTimestamp,createdBy:U.metadata.annotations?.[a.hc]??"",updated:U.metadata.annotations?.[a.xU],updatedBy:U.metadata.annotations?.[a.Qu],folderUid:U.metadata.annotations?.[a.ew],slug:U.metadata.annotations?.[a.hX],url:U.access.url,canAdmin:U.access.canAdmin,canDelete:U.access.canDelete,canEdit:U.access.canEdit,canSave:U.access.canSave,canShare:U.access.canShare,canStar:U.access.canStar,annotationsPermissions:U.access.annotationsPermissions},dashboard:{uid:U.metadata.name,title:W.title,description:W.description,tags:W.tags,schemaVersion:40,graphTooltip:(0,s.Y_)(W.cursorSync),preload:W.preload,liveNow:W.liveNow,editable:W.editable,gnetId:U.metadata.annotations?.[a.hm],revision:W.revision,time:{from:W.timeSettings.from,to:W.timeSettings.to},timezone:W.timeSettings.timezone,refresh:W.timeSettings.autoRefresh,timepicker:{refresh_intervals:W.timeSettings.autoRefreshIntervals,hidden:W.timeSettings.hideTimepicker,quick_ranges:W.timeSettings.quickRanges,nowDelay:W.timeSettings.nowDelay},fiscalYearStartMonth:W.timeSettings.fiscalYearStartMonth,weekStart:W.timeSettings.weekStart,version:parseInt(U.metadata.resourceVersion,10),links:W.links,annotations:{list:A},panels:K,templating:{list:N}}}}}const o={ensureV2Response:u,ensureV1Response:g};function E(U){const W={},A={kind:"GridLayout",spec:{items:[]}};if(!U)return[W,A];let N=null;for(const K of U)if(m(K)){N&&A.spec.items.push(N);const V=[];for(const T of K.panels){const[z,w]=D(T);W[w]=z,V.push(p(T,w,h(T,K.gridPos.y)))}N=f(K,V)}else{const[V,T]=D(K);W[T]=V,N?N.spec.elements.push(p(K,T,h(K,N.spec.y))):A.spec.items.push(p(K,T))}return N&&A.spec.items.push(N),[W,A]}function m(U){return U.type==="row"}function f(U,W){return{kind:"GridLayoutRow",spec:{collapsed:U.collapsed,title:U.title??"",repeat:U.repeat?{value:U.repeat,mode:"variable"}:void 0,y:U.gridPos?.y??0,elements:W}}}function p(U,W,A){return{kind:"GridLayoutItem",spec:{x:U.gridPos.x,y:A??U.gridPos.y,width:U.gridPos.w,height:U.gridPos.h,repeat:U.repeat?{value:U.repeat,mode:"variable",direction:U.repeatDirection,maxPerRow:U.maxPerRow}:void 0,element:{kind:"ElementReference",name:W}}}}function h(U,W){return U.gridPos.y-W-i.o}function D(U){if(U.libraryPanel)return[{kind:"LibraryPanel",spec:{libraryPanel:{uid:U.libraryPanel.uid,name:U.libraryPanel.name},id:U.id,title:U.title??""}},`panel-${U.id}`];{const W=v(U.targets||[],U.datasource||l()),A=y(U.transformations||[]);return[{kind:"Panel",spec:{title:U.title||"",description:U.description||"",vizConfig:{kind:U.type,spec:{fieldConfig:U.fieldConfig||(0,r.bt)(),options:U.options,pluginVersion:U.pluginVersion}},links:U.links?.map(K=>({title:K.title,url:K.url||"",targetBlank:K.targetBlank}))||[],id:U.id,data:{kind:"QueryGroup",spec:{queries:W,transformations:A,queryOptions:{cacheTimeout:U.cacheTimeout,maxDataPoints:U.maxDataPoints,interval:U.interval,hideTimeOverride:U.hideTimeOverride,queryCachingTTL:U.queryCachingTTL,timeFrom:U.timeFrom,timeShift:U.timeShift}}}}},`panel-${U.id}`]}}function C(){return(0,x.Ic)()?.type??"grafana"}function l(){const U=(0,x.Ic)()??{type:"grafana",uid:"-- Grafana --"};if(U.uid&&!U.apiVersion){const W=t.$.bootData.settings.datasources[U.uid];U.apiVersion=W.apiVersion??void 0}return{apiVersion:U.apiVersion,type:U.type,uid:U.uid}}function v(U,W){return U.map(A=>{const{refId:N,hide:K,datasource:V,...T}=A;return{kind:"PanelQuery",spec:{refId:A.refId,hidden:A.hide??!1,datasource:A.datasource?A.datasource:W,query:{kind:A.datasource?.type||W.type,spec:{...T}}}}})}function y(U){return U.map(W=>({kind:W.id,spec:{...W,topic:(0,c.MM)(W.topic)}}))}function P(U){const W=[];for(const A of U){const N={name:A.name,label:A.label,...A.description&&{description:A.description},skipUrlSync:!!A.skipUrlSync,hide:(0,c.NB)(A.hide)};switch(A.type){case"query":let K=A.query||{};typeof K=="string"&&(console.warn("Query variable query is a string which is deprecated in the schema v2. It should extend DataQuery"),K={[c.sB]:K});const V={kind:"QueryVariable",spec:{...N,multi:!!A.multi,includeAll:!!A.includeAll,...A.allValue&&{allValue:A.allValue},current:{value:A.current.value,text:A.current.text},options:A.options||[],refresh:(0,c.qJ)(A.refresh),...A.datasource&&{datasource:A.datasource},regex:A.regex||"",sort:(0,c.LY)(A.sort),query:{kind:A.datasource?.type||C(),spec:K}}};W.push(V);break;case"datasource":let T=C();A.query&&typeof A.query=="string"&&(T=A.query);const z={kind:"DatasourceVariable",spec:{...N,multi:!!A.multi,includeAll:!!A.includeAll,...A.allValue&&{allValue:A.allValue},current:{value:A.current.value,text:A.current.text},options:A.options||[],refresh:(0,c.qJ)(A.refresh),pluginId:T,regex:A.regex||""}};W.push(z);break;case"custom":const w={kind:"CustomVariable",spec:{...N,query:A.query,current:{value:A.current.value,text:A.current.text},options:A.options,multi:A.multi,includeAll:A.includeAll,...A.allValue&&{allValue:A.allValue}}};W.push(w);break;case"adhoc":const H={kind:"AdhocVariable",spec:{...N,datasource:A.datasource||l(),baseFilters:A.baseFilters||[],filters:A.filters||[],defaultKeys:A.defaultKeys||[]}};W.push(H);break;case"constant":const G={kind:"ConstantVariable",spec:{...N,current:{value:A.current.value,text:A.current.value},query:A.query}};W.push(G);break;case"interval":const X={kind:"IntervalVariable",spec:{...N,current:{value:A.current.value,text:A.current.value},query:A.query,refresh:"onTimeRangeChanged",options:A.options,auto:A.auto,auto_min:A.auto_min,auto_count:A.auto_count}};W.push(X);break;case"textbox":const k={kind:"TextVariable",spec:{...N,current:{value:A.current.value,text:A.current.value},query:A.query}};W.push(k);break;case"groupby":const _={kind:"GroupByVariable",spec:{...N,datasource:A.datasource||l(),options:A.options,current:{value:A.current.value,text:A.current.text},multi:A.multi}};W.push(_);break;default:console.error(`Variable transformation not implemented: ${A.type}`)}}return W}function b(U){return U.map(W=>({kind:"AnnotationQuery",spec:{name:W.name,...W.datasource&&{datasource:W.datasource},enable:W.enable,hide:!!W.hide,iconColor:W.iconColor,builtIn:!!W.builtIn,query:{kind:W.datasource?.type||C(),spec:{...W.target}},filter:W.filter}}))}function S(U){const W=[];for(const A of U){const N={name:A.spec.name,label:A.spec.label,...A.spec.description&&{description:A.spec.description},skipUrlSync:A.spec.skipUrlSync,hide:(0,s.cc)(A.spec.hide),type:I(A)};switch(A.kind){case"QueryVariable":const K={...N,current:A.spec.current,options:A.spec.options,query:c.sB in A.spec.query.spec?A.spec.query.spec[c.sB]:A.spec.query.spec,datasource:A.spec.datasource,sort:(0,s.ES)(A.spec.sort),refresh:(0,s.tH)(A.spec.refresh),regex:A.spec.regex,allValue:A.spec.allValue,includeAll:A.spec.includeAll,multi:A.spec.multi,definition:A.spec.definition};W.push(K);break;case"DatasourceVariable":const V={...N,current:A.spec.current,options:[],regex:A.spec.regex,refresh:(0,s.tH)(A.spec.refresh),query:A.spec.pluginId,multi:A.spec.multi,allValue:A.spec.allValue,includeAll:A.spec.includeAll};W.push(V);break;case"CustomVariable":const T={...N,current:{text:A.spec.current.value,value:A.spec.current.value},options:A.spec.options,query:A.spec.query,multi:A.spec.multi,allValue:A.spec.allValue,includeAll:A.spec.includeAll};W.push(T);break;case"ConstantVariable":const z={...N,current:{text:A.spec.current.value,value:A.spec.current.value},hide:(0,s.cc)(A.spec.hide),query:A.spec.current.value};W.push(z);break;case"IntervalVariable":const w={...N,current:{text:A.spec.current.value,value:A.spec.current.value},hide:(0,s.cc)(A.spec.hide),query:A.spec.query,refresh:(0,s.tH)(A.spec.refresh),options:A.spec.options,auto:A.spec.auto,auto_min:A.spec.auto_min,auto_count:A.spec.auto_count};W.push(w);break;case"TextVariable":const H={text:A.spec.current.value,value:A.spec.current.value},G={...N,current:{text:A.spec.current.value,value:A.spec.current.value},options:[{...H,selected:!0}],query:A.spec.query};W.push(G);break;case"GroupByVariable":const X={...N,datasource:A.spec.datasource,current:A.spec.current,options:A.spec.options};W.push(X);break;case"AdhocVariable":const k={...N,datasource:A.spec.datasource,baseFilters:A.spec.baseFilters,filters:A.spec.filters,defaultKeys:A.spec.defaultKeys};W.push(k);break;default:console.error(`Variable transformation not implemented: ${A}`)}}return W}function M(U){return U.map(W=>({name:W.spec.name,datasource:W.spec.datasource,enable:W.spec.enable,hide:W.spec.hide,iconColor:W.spec.iconColor,builtIn:W.spec.builtIn?1:0,target:W.spec.query?.spec,filter:W.spec.filter}))}function O(U,W){const A=[];let N=0;if(W.kind!=="GridLayout")throw new Error("Cannot convert non-GridLayout layout to v1");for(const K of W.spec.items)if(K.kind==="GridLayoutItem"){const V=U[K.spec.element.name],T=R(V,K);A.push(T),(T.id??0>N)&&(N=T.id??0)}else if(K.kind==="GridLayoutRow"){const V={id:-1,type:"row",title:K.spec.title,collapsed:K.spec.collapsed,repeat:K.spec.repeat?K.spec.repeat.value:void 0,gridPos:{x:0,y:K.spec.y,w:24,h:i.o},panels:[]},T=[];for(const z of K.spec.elements){const w=U[z.spec.element.name],H=R(w,z,K.spec.y+i.o+z.spec.y);T.push(H),(H.id??0>N)&&(N=H.id??0)}K.spec.collapsed?(V.panels=T,A.push(V)):(A.push(V),A.push(...T))}for(const K of A)K.type==="row"&&K.id===-1&&(K.id=++N);return A}function R(U,W,A){const{x:N,y:K,width:V,height:T,repeat:z}=W?.spec||{x:0,y:0,width:0,height:0},w={x:N,y:A??K,w:V,h:T};if(U.kind==="Panel"){const H=U.spec;return{id:H.id,type:H.vizConfig.kind,title:H.title,description:H.description,fieldConfig:L(H.vizConfig.spec.fieldConfig),options:H.vizConfig.spec.options,pluginVersion:H.vizConfig.spec.pluginVersion,links:H.links?.map(G=>({title:G.title,url:G.url,...G.targetBlank&&{targetBlank:G.targetBlank}}))||[],targets:H.data.spec.queries.map(G=>({refId:G.spec.refId,hide:G.spec.hidden,datasource:G.spec.datasource,...G.spec.query.spec})),transformations:H.data.spec.transformations.map(G=>G.spec),gridPos:w,cacheTimeout:H.data.spec.queryOptions.cacheTimeout,maxDataPoints:H.data.spec.queryOptions.maxDataPoints,interval:H.data.spec.queryOptions.interval,hideTimeOverride:H.data.spec.queryOptions.hideTimeOverride,queryCachingTTL:H.data.spec.queryOptions.queryCachingTTL,timeFrom:H.data.spec.queryOptions.timeFrom,timeShift:H.data.spec.queryOptions.timeShift,transparent:H.transparent,...z?.value&&{repeat:z.value},...z?.direction&&{repeatDirection:z.direction},...z?.maxPerRow&&{maxPerRow:z.maxPerRow}}}else if(U.kind==="LibraryPanel"){const H=U.spec;return{id:H.id,title:H.title,gridPos:w,libraryPanel:{uid:H.libraryPanel.uid,name:H.libraryPanel.name},type:"library-panel-ref"}}else throw new Error(`Unknown element kind: ${U}`)}function L(U){const W=N=>{switch(N){case"absolute":return n.Ol.Absolute;case"percentage":return n.Ol.Percentage;default:return n.Ol.Absolute}},A={...U.defaults};return U.defaults.mappings&&(A.mappings=U.defaults.mappings.map(N=>{switch(N.type){case"value":return{...N,type:n.dM.ValueToText};case"range":return{...N,type:n.dM.RangeToText};case"regex":return{...N,type:n.dM.RegexToText};case"special":return{...N,options:{...N.options,match:F(N.options.match)},type:n.dM.SpecialValue};default:return N}})),U.defaults.thresholds&&(A.thresholds={...U.defaults.thresholds,mode:W(U.defaults.thresholds.mode)}),U.defaults.color?.mode&&(A.color={...U.defaults.color,mode:B(U.defaults.color.mode)}),{...U,defaults:A}}function B(U){switch(U){case"thresholds":return n.Yb.Thresholds;case"palette-classic":return n.Yb.PaletteClassic;case"palette-classic-by-name":return n.Yb.PaletteClassicByName;case"continuous-GrYlRd":return n.Yb.ContinuousGrYlRd;case"continuous-RdYlGr":return n.Yb.ContinuousRdYlGr;case"continuous-BlYlRd":return n.Yb.ContinuousBlYlRd;case"continuous-YlRd":return n.Yb.ContinuousYlRd;case"continuous-BlPu":return n.Yb.ContinuousBlPu;case"continuous-YlBl":return n.Yb.ContinuousYlBl;case"continuous-blues":return n.Yb.ContinuousBlues;case"continuous-reds":return n.Yb.ContinuousReds;case"continuous-greens":return n.Yb.ContinuousGreens;case"continuous-purples":return n.Yb.ContinuousPurples;case"fixed":return n.Yb.Fixed;case"shades":return n.Yb.Shades;default:return n.Yb.Thresholds}}function F(U){switch(U){case"true":return n.WL.True;case"false":return n.WL.False;case"null":return n.WL.Null;case"nan":return n.WL.NaN;case"null+nan":return n.WL.NullAndNan;case"empty":return n.WL.Empty;default:throw new Error(`Unknown match type: ${U}`)}}function I(U){switch(U.kind){case"QueryVariable":return"query";case"DatasourceVariable":return"datasource";case"CustomVariable":return"custom";case"ConstantVariable":return"constant";case"IntervalVariable":return"interval";case"TextVariable":return"textbox";case"GroupByVariable":return"groupby";case"AdhocVariable":return"adhoc";default:throw new Error(`Unknown variable type: ${U}`)}}},15543:(q,j,e)=>{"use strict";e.d(j,{n:()=>C});var t=e(52718),n=e(28082),r=e(22492),a=e(10474);class i{constructor(){}saveDashboard(v){return a.t.ignoreNextSave(),(0,n.AI)().post("/api/dashboards/db/",{dashboard:v.dashboard,message:v.message??"",overwrite:v.overwrite??!1,folderUid:v.folderUid})}deleteDashboard(v,y){return(0,n.AI)().delete(`/api/dashboards/uid/${v}`,void 0,{showSuccessAlert:y})}async getDashboardDTO(v,y){const P=await(0,n.AI)().get(`/api/dashboards/uid/${v}`,y);if(P.meta.isFolder)throw r.A.emit(t.r1.alertError,["Dashboard not found"]),{status:404,config:{url:`/api/dashboards/uid/${v}`},data:{message:"Dashboard not found"}};return P}}var x=e(66952),s=e(2567),c=e(75911),d=e(44608),u=e(58410),g=e(72458),o=e(20708),E=e(32480);class m{constructor(){this.client=new g.ws({group:"dashboard.grafana.app",version:"v1alpha1",resource:"dashboards"})}saveDashboard(v){const y=v.dashboard,P={metadata:{...v?.k8s},spec:{...y}};return v.message?P.metadata.annotations={...P.metadata.annotations,[o.fY]:v.message}:P.metadata.annotations&&delete P.metadata.annotations[o.fY],v.folderUid&&(P.metadata.annotations={...P.metadata.annotations,[o.ew]:v.folderUid}),y.uid?(P.metadata.name=y.uid,this.client.update(P).then(b=>this.asSaveDashboardResponseDTO(b))):this.client.create(P).then(b=>this.asSaveDashboardResponseDTO(b))}asSaveDashboardResponseDTO(v){const y=s.I.assureBaseUrl((0,E.u)({uid:v.metadata.name,currentQueryParams:"",slug:u.A.slugifyForUrl(v.spec.title)}));return{uid:v.metadata.name,version:v.spec.version??0,id:v.spec.id??0,status:"success",url:y,slug:""}}deleteDashboard(v,y){return this.client.delete(v,y).then(P=>({id:0,message:P.message,title:"deleted"}))}async getDashboardDTO(v){try{const y=await this.client.subresource(v,"dto"),P={meta:{...y.access,isNew:!1,isFolder:!1,uid:y.metadata.name,k8s:y.metadata,version:parseInt(y.metadata.resourceVersion,10)},dashboard:y.spec};if(y.metadata.labels?.[o.Y5]&&(P.dashboard.id=parseInt(y.metadata.labels[o.Y5],10)),y.metadata.annotations?.[o.ew])try{const b=await c.IB.getFolderByUid(y.metadata.annotations[o.ew]);P.meta.folderTitle=b.title,P.meta.folderUrl=b.url,P.meta.folderUid=b.uid,P.meta.folderId=b.id}catch{throw new Error("Failed to load folder")}return P}catch(y){const P=(0,d.do)(y);throw(0,d.q6)(y).includes("not found")&&P!==404&&(y.status=404,y.data.message="Dashboard not found"),y}}}var f=e(5174);class p{constructor(v){this.convertToV1=v,this.client=new g.ws({group:"dashboard.grafana.app",version:"v2alpha1",resource:"dashboards"})}async getDashboardDTO(v,y){try{const P=await this.client.subresource(v,"dto");let b;if(b=f.Op.ensureV2Response(P),b.metadata.annotations&&b.metadata.annotations[o.ew])try{const S=await c.IB.getFolderByUid(b.metadata.annotations[o.ew]);b.metadata.annotations[o.w2]=S.title,b.metadata.annotations[o.D1]=S.url,b.metadata.annotations[o.nB]=S.id}catch{throw new Error("Failed to load folder")}else b.metadata.annotations&&!b.metadata.annotations[o.ew]&&(b.metadata.annotations[o.ew]="");return this.convertToV1&&(b=f.Op.ensureV1Response(b)),b}catch(P){const b=(0,d.do)(P);throw(0,d.q6)(P).includes("not found")&&b!==404&&(P.status=404,P.data.message="Dashboard not found"),P}}deleteDashboard(v,y){return this.client.delete(v,y).then(P=>({id:0,message:P.message,title:"deleted"}))}async saveDashboard(v){const y=v.dashboard,P={metadata:{...v?.k8s},spec:{...y}};return v.message?P.metadata.annotations={...P.metadata.annotations,[o.fY]:v.message}:P.metadata.annotations&&delete P.metadata.annotations[o.fY],v.folderUid&&(delete P.metadata.annotations?.[o.w2],delete P.metadata.annotations?.[o.D1],delete P.metadata.annotations?.[o.nB],P.metadata.annotations={...P.metadata.annotations,[o.ew]:v.folderUid}),P.metadata.name?(delete P.metadata.resourceVersion,this.client.update(P).then(b=>this.asSaveDashboardResponseDTO(b))):await this.client.create(P).then(b=>this.asSaveDashboardResponseDTO(b))}asSaveDashboardResponseDTO(v){const y=s.I.assureBaseUrl((0,E.u)({uid:v.metadata.name,currentQueryParams:"",slug:u.A.slugifyForUrl(v.spec.title)}));let P=0;return v.metadata.labels?.[o.Y5]&&(P=parseInt(v.metadata.labels[o.Y5],10)),{uid:v.metadata.name,version:parseInt(v.metadata.resourceVersion,10)??0,id:P,status:"success",url:y,slug:""}}}let h;function D(l){throw new Error("dashboardAPI can be only overridden in test environment")}function C(l){const v=(0,x.GV)(),y=!l;if(h||(h={legacy:new i,v1:new m,v2:new p(y)}),v==="v2"&&l==="v2")return new p(!1);if(!h[v])throw new Error(`Unknown Dashboard API version: ${v}`);return h[v]}},65728:(q,j,e)=>{"use strict";e.d(j,{$L:()=>C,AK:()=>v,Bs:()=>E,NA:()=>l,NY:()=>D,Sm:()=>o,T2:()=>f,U9:()=>m,_e:()=>h,bN:()=>p,eq:()=>b,ft:()=>S,g9:()=>P,kd:()=>y});var t=e(75816),n=e(28082),r=e(32370),a=e(31226),i=e(23737),x=e(17687),s=e(11817),c=e(71488),d=e(11997);function u(M){return typeof M=="object"&&M!=null&&"error"in M}const g=M=>({error:(0,n.NF)(M)&&M.data.messageId!=="publicdashboards.notFound"?M:null}),o=(0,t.xP)({reducerPath:"publicDashboardApi",baseQuery:(0,a.W)({baseURL:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:M=>({getPublicDashboard:M.query({query:O=>({url:`/dashboards/uid/${O}/public-dashboards`,manageError:g,showErrorAlert:!1}),async onQueryStarted(O,{dispatch:R,queryFulfilled:L}){try{await L}catch(B){u(B)&&(0,n.NF)(B.error)&&R((0,i.dx)((0,x.gi)(B.error.data.message)))}},providesTags:(O,R,L)=>[{type:"PublicDashboard",id:L}]}),createPublicDashboard:M.mutation({query:O=>({url:`/dashboards/uid/${O.dashboard instanceof d.H$?O.dashboard.state.uid:O.dashboard.uid}/public-dashboards`,method:"POST",body:O.payload}),async onQueryStarted({dashboard:O,payload:{share:R}},{dispatch:L,queryFulfilled:B}){const{data:F}=await B;let I=(0,s.t)("public-dashboard.sharing.success-creation","Dashboard is public!");r.$.featureToggles.newDashboardSharingComponent&&(I=R===c.Xo.PUBLIC?(0,s.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,s.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),L((0,i.dx)((0,x.tZ)(I))),O instanceof d.H$?O.setState({meta:{...O.state.meta,publicDashboardEnabled:F.isEnabled}}):O.updateMeta({publicDashboardEnabled:F.isEnabled})},invalidatesTags:(O,R,{dashboard:L})=>[{type:"PublicDashboard",id:L instanceof d.H$?L.state.uid:L.uid}]}),updatePublicDashboard:M.mutation({query:({payload:O,dashboard:R})=>({url:`/dashboards/uid/${R instanceof d.H$?R.state.uid:R.uid}/public-dashboards/${O.uid}`,method:"PATCH",body:O}),async onQueryStarted({dashboard:O},{dispatch:R,queryFulfilled:L}){await L,R((0,i.dx)((0,x.tZ)(r.$.featureToggles.newDashboardSharingComponent?(0,s.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,s.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(O,R,{payload:L})=>[{type:"PublicDashboard",id:L.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:M.mutation({query:({payload:O,dashboard:R})=>({url:`/dashboards/uid/${R instanceof d.H$?R.state.uid:R.uid}/public-dashboards/${O.uid}`,method:"PATCH",body:O}),async onQueryStarted({dashboard:O,payload:{isEnabled:R}},{dispatch:L,queryFulfilled:B}){const{data:F}=await B;let I=(0,s.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");r.$.featureToggles.newDashboardSharingComponent&&(I=R?(0,s.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,s.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),L((0,i.dx)((0,x.tZ)(I))),O instanceof d.H$?O.setState({meta:{...O.state.meta,publicDashboardEnabled:F.isEnabled}}):O.updateMeta?.({publicDashboardEnabled:F.isEnabled})},invalidatesTags:(O,R,{payload:L})=>[{type:"PublicDashboard",id:L.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:M.mutation({query:({payload:O,dashboard:R})=>({url:`/dashboards/uid/${R instanceof d.H$?R.state.uid:R.uid}/public-dashboards/${O.uid}`,method:"PATCH",body:O}),async onQueryStarted({dashboard:O,payload:{share:R}},{dispatch:L,queryFulfilled:B}){await B;let F=(0,s.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");r.$.featureToggles.newDashboardSharingComponent&&(F=R===c.Xo.PUBLIC?(0,s.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,s.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access updated: Only specific people can now access with the link")),L((0,i.dx)((0,x.tZ)(F)))},invalidatesTags:(O,R,{payload:L})=>[{type:"PublicDashboard",id:L.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:M.mutation({query:()=>({url:""})}),deleteRecipient:M.mutation({query:()=>({url:""})}),reshareAccessToRecipient:M.mutation({query:()=>({url:""})}),getActiveUsers:M.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:M.query({query:()=>({url:""}),providesTags:(O,R,L)=>[{type:"ActiveUserDashboards",id:L}]}),listPublicDashboards:M.query({query:(O=1)=>({url:`/dashboards/public-dashboards?page=${O}&perpage=8`}),transformResponse:O=>({...O,totalPages:Math.ceil(O.totalCount/O.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:M.mutation({query:O=>({url:`/dashboards/uid/${O.dashboardUid}/public-dashboards/${O.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:O},{dispatch:R,queryFulfilled:L}){await L,R((0,i.dx)((0,x.tZ)(r.$.featureToggles.newDashboardSharingComponent?(0,s.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,s.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),R(o.util?.resetApiState()),O instanceof d.H$?O.setState({meta:{...O.state.meta,publicDashboardEnabled:!1}}):O?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(O,R,{dashboardUid:L})=>[{type:"PublicDashboard",id:L},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:M.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:E,useCreatePublicDashboardMutation:m,useUpdatePublicDashboardMutation:f,useDeletePublicDashboardMutation:p,useListPublicDashboardsQuery:h,useAddRecipientMutation:D,useDeleteRecipientMutation:C,useReshareAccessToRecipientMutation:l,useGetActiveUsersQuery:v,useGetActiveUserDashboardsQuery:y,useRevokeAllAccessMutation:P,usePauseOrResumePublicDashboardMutation:b,useUpdatePublicDashboardAccessMutation:S}=o},66952:(q,j,e)=>{"use strict";e.d(j,{GV:()=>a,HG:()=>c,_5:()=>s,aK:()=>x,b_:()=>i,mi:()=>u,rL:()=>d});var t=e(53027),n=e(32370);const r=1;function a(){const g=t.Ny.getSearch().get("scenes")==="false";return!n.$.featureToggles.dashboardScene||g?n.$.featureToggles.kubernetesDashboards?"v1":"legacy":n.$.featureToggles.useV2DashboardsAPI?"v2":n.$.featureToggles.kubernetesDashboards?"v1":"legacy"}function i(g){return g?"kind"in g&&g.kind==="DashboardWithAccessInfo":!1}function x(g){return"elements"in g}function s(g){return!x(g)}function c(g){return i(g)&&x(g.spec)}function d(g){return!x(g.dashboard)}function u(g){return x(g.dashboard)}},86872:(q,j,e)=>{"use strict";e.d(j,{M:()=>g});var t=e(2543),n=e(14964),r=e(98437),a=e(88023),i=e(81569),x=e(2510),s=e(54506),c=e(67858),d=e(21658);function u(o){return!!(o.libraryPanel?.name&&o.libraryPanel?.uid)}class g{async makeExportable(E){E.cleanUpRepeats();const m=E.getSaveModelCloneOld();m.id=null,E.processRepeats();const f=[],p={},h={},D={},C=new Map;for(const P of m.getVariables())D[P.name]=P;const l=(P,b)=>{if(P.datasource===void 0){P.datasource=b;return}let S=P.datasource,M=null;const O=S?.uid,R=O&&x.SY.exec(O);if(R){const L=R[1]||R[2]||R[4];M=D[L],M&&M.current&&(S=M.current.value)}return(0,r.l)().get(S).then(L=>{if(L.meta?.builtIn||(p["datasource"+L.meta?.id]={type:"datasource",id:L.meta.id,name:L.meta.name,version:L.meta.info.version||"1.0.0"},M))return;const B=P.libraryPanel,F=B?"-for-library-panel":"";let I="DS_"+L.name.replace(" ","_").toUpperCase()+F.toUpperCase();if(h[I]={name:I,label:L.name,description:"",type:"datasource",pluginId:L.meta?.id,pluginName:L.meta?.name,usage:h[I]?.usage},B){const U=h[I]?.usage?.libraryPanels||[];U.push({name:B.name,uid:B.uid}),h[I].usage={libraryPanels:U}}P.datasource={type:L.meta.id,uid:"${"+I+"}"}})},v=async P=>{if(P.type!=="row"){if(await l(P),P.targets)for(const S of P.targets)await l(S,P.datasource);const b=a.Ay.panels[P.type];b&&(p["panel"+b.id]={type:"panel",id:b.id,name:b.name,version:b.info.version})}},y=async P=>{if((0,s.X)(P)){const{name:b,uid:S}=P.libraryPanel;let M=P.libraryPanel.model;M||(M=(await(0,i.Yr)(S,!0)).model),await l(M);const{gridPos:O,id:R,...L}=M;C.has(S)||C.set(S,{name:b,uid:S,kind:c.i.Panel,model:L})}};try{for(const S of m.panels)if(await v(S),S.collapsed!==void 0&&S.collapsed===!0&&S.panels)for(const M of S.panels)await v(M);for(const S of m.getVariables())S.type==="query"?(await l(S),S.options=[],S.current={},S.refresh=S.refresh!==n.CO.never?S.refresh:n.CO.onDashboardLoad):S.type==="datasource"&&(S.current={});for(const S of m.annotations.list)await l(S);p.grafana={type:"grafana",id:"grafana",name:"Grafana",version:a.Ay.buildInfo.version};for(const S of m.panels)if(await y(S),S.collapsed!==void 0&&S.collapsed===!0&&S.panels)for(const M of S.panels)await y(M);(0,t.each)(h,S=>{f.push(S)});for(const S of m.getVariables())if((0,d.VO)(S)){const M="VAR_"+S.name.replace(" ","_").toUpperCase();f.push({name:M,type:"constant",label:S.label||S.name,value:S.query,description:""}),S.query="${"+M+"}",S.current={value:S.query,text:S.query,selected:!1},S.options=[S.current]}const P=[...C.entries()].reduce((S,[M,O])=>(S[M]=O,S),{}),b=(0,t.defaults)({__inputs:f,__elements:P,__requires:(0,t.sortBy)(p,["id"])},m);for(let S=0;S<b.panels.length;S++){const M=b.panels[S];u(M)&&(b.panels[S]={gridPos:M.gridPos,id:M.id,libraryPanel:{uid:M.libraryPanel.uid,name:M.libraryPanel.name}})}return b}catch(P){return console.error("Export failed:",P),{error:P}}}}},70973:(q,j,e)=>{"use strict";e.d(j,{fP:()=>ne,Ay:()=>le});var t=e(74848),n=e(96540),r=e(22803),a=e(71468),i=e(54148),x=e(84099),s=e(58779),c=e(53027),d=e(34798),u=e(65164),g=e(66384),o=e(90333),E=e(52120),m=e(43908),f=e(48194),p=e(23737),h=e(91536),D=e(23838),C=e(88023),l=e(17687),v=e(87638),y=e(7435),P=e(11817),b=e(19606),S=e(76829),M=e(60232),O=e(54594),R=e(79784),L=e(19224),B=e(61976),F=e(83424),I=e(61491),U=e(86983);const A=({dashboard:de})=>{const me=(0,n.useMemo)(()=>(0,B._u)(),[]),Pe=(0,I.useDispatch)(),Ee=(0,I.useSelector)(be=>be.dashboard.initialDatasource);return(0,t.jsxs)(L.W,{children:[(0,t.jsx)(L.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,P.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const be=(0,B.OK)(de,Ee);F.c.toolbarAddButtonClicked({item:"add_visualization"}),c.Ny.partial({editPanel:be}),Pe((0,U.Ub)(void 0))}},"add-visualisation"),(0,t.jsx)(L.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,P.t)("dashboard.add-menu.row","Row"),onClick:()=>{F.c.toolbarAddButtonClicked({item:"add_row"}),(0,B.SD)(de)}},"add-row"),(0,t.jsx)(L.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,P.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{F.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,B.s3)(de)}},"add-panel-lib"),(0,t.jsx)(L.W.Item,{testId:s.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,P.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{F.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,B.no)(de,me)},disabled:!me},"add-panel-clipboard")]})},K=({dashboard:de,onToolbarAddMenuOpen:me})=>{const[Pe,Ee]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{Pe&&me&&me()},[Pe,me]),(0,t.jsx)(M.m,{overlay:()=>(0,t.jsx)(A,{dashboard:de}),placement:"bottom",offset:[0,6],onVisibleChange:Ee,children:(0,t.jsxs)(O.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":s.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(P.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(R.I,{name:Pe?"angle-up":"angle-down",size:"lg"})]})})};var V=e(23040),T=e(16910),z=e(40819),w=e(89880),H=e(91830),G=e(80328),X=e(81196),k=e(39601),_=e(25309);const ee=({dashboard:de})=>(0,t.jsx)(O.$n,{"data-testid":s.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{F.c.toolbarShareClick(),c.Ny.partial({shareView:_.wr.link})},children:(0,t.jsx)(P.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),J={removeNavIndex:S.Im,setStarred:b.ci,updateTimeZoneForSession:w.Cj,updateNavIndex:p.Vz},Z=de=>({navIndex:de.navIndex}),te=(0,a.connect)(Z,J),ae=s.Tp.pages.Dashboard.DashNav;function re(de){registerDynamicDashNavAction("left",de)}function ne(de){(0,G.Y)("right",de)}const ce=(0,n.memo)(de=>{(0,i.zy)();const me=(0,d.C)();(0,y.u)(de.dashboard.events,H.Cf);const Pe=de.dashboard.snapshot?.originalUrl??"",Ee=()=>{window.location.href=x.sQ.sanitizeUrl(de.dashboard.snapshot.originalUrl)},be=(0,l._2)(),Se=()=>{try{const Ie=new URL(x.sQ.sanitizeUrl(Pe),C.Ay.appUrl),Ne=new URL(C.Ay.appUrl);Ie.host!==Ne.host?v.lE.publish(new H.S8({component:u.u,props:{title:"Proceed to external site?",modalClass:he,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:Pe})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:Ee}})):Ee()}catch(Ie){be.error("Invalid URL",Ie instanceof Error?Ie.message:void 0)}},Xe=()=>{F.c.toolbarFavoritesClick();const Ie=(0,T.UA)(),{dashboard:Ne,navIndex:ie,removeNavIndex:ve,setStarred:fe,updateNavIndex:ge}=de;Ie.starDashboard(Ne.uid,!!Ne.meta.isStarred).then(xe=>{fe({id:Ne.uid,title:Ne.title,url:Ne.meta.url??"",isStarred:xe});const je=ie.starred;if(xe)je.children?.push({id:b.L1+Ne.uid,text:Ne.title,url:Ne.meta.url??"",parentItem:je});else{ve(b.L1+Ne.uid);const Ve=je.children?.findIndex(ke=>ke.id===b.L1+Ne.uid);Ve&&je.children?.splice(Ve,1)}ge(je),Ne.meta.isStarred=xe,me()})},Qe=()=>{F.c.toolbarSettingsClick(),c.Ny.partial({editview:"settings"})},we=()=>{z._o.prev()},$e=()=>{z._o.next()},Fe=()=>{z._o.stop(),me()},Te=(Ie,Ne)=>{Ie.map((ie,ve)=>{const fe=ie.component,ge=(0,n.createElement)(fe,{...de,key:`button-custom-${ve}`});typeof ie.index=="number"?Ne.splice(ie.index,0,ge):Ne.push(ge)})},Le=()=>z._o.state.isPlaying,Ge=()=>{const Ie=C.Ay.buildInfo.env==="development",{dashboard:Ne,kioskMode:ie}=de,{canStar:ve,isStarred:fe}=Ne.meta,ge=[];if(ie||Le())return[];if(ve){let xe=fe?(0,P.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,P.t)("dashboard.toolbar.mark-favorite","Mark as favorite");ge.push((0,t.jsx)(X._,{tooltip:xe,icon:fe?"favorite":"star",iconType:fe?"mono":"default",iconSize:"lg",onClick:Xe},"button-star"))}return Ne.meta.publicDashboardEnabled&&ge.push((0,t.jsx)(g.E,{color:"blue",text:"Public",className:oe,"data-testid":ae.publicDashboardTag},"public-dashboard-button-badge")),Ie&&C.Ay.featureToggles.dashboardScene&&ge.push((0,t.jsx)(X._,{tooltip:"View as Scene",icon:"apps",onClick:()=>{c.Ny.partial({scenes:!0})}},"button-scenes")),Te(G.C.left,ge),ge},Me=()=>(0,t.jsxs)(o.e,{children:[(0,t.jsx)(E.I,{tooltip:(0,P.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:we,narrow:!0}),(0,t.jsx)(E.I,{onClick:Fe,children:(0,t.jsx)(P.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,t.jsx)(E.I,{tooltip:(0,P.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:$e,narrow:!0})]},"playlist-buttons"),De=()=>{const{dashboard:Ie,updateTimeZoneForSession:Ne,hideTimePicker:ie}=de;return ie?null:(0,t.jsx)(k.$,{dashboard:Ie,onChangeTimeZone:Ne},"time-controls")},Ke=()=>{const{dashboard:Ie,isFullscreen:Ne,hideTimePicker:ie}=de,{canSave:ve,canEdit:fe,showSettings:ge,canShare:xe}=Ie.meta,{snapshot:je}=Ie,Ve=je&&je.originalUrl,ke=[];return Le()?[Me(),De()]:(Ve&&ke.push((0,t.jsx)(E.I,{tooltip:(0,P.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Se,icon:"link"},"button-snapshot")),ve&&!Ne&&ke.push((0,t.jsx)(m.$s,{children:({showModal:Oe,hideModal:nt})=>(0,t.jsx)(E.I,{tooltip:(0,P.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{Oe(V.$,{dashboard:Ie,onDismiss:nt})}})},"button-save")),Te(G.C.right,ke),ge&&ke.push((0,t.jsx)(E.I,{tooltip:(0,P.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Qe},"button-settings")),fe&&!Ne&&ke.push((0,t.jsx)(K,{onToolbarAddMenuOpen:F.c.toolbarAddClick,dashboard:Ie},"panel-add-dropdown")),xe&&ke.push((0,t.jsx)(ee,{dashboard:Ie},"button-share")),ie||ke.push((0,t.jsx)(D.K,{},"toolbar-separator")),ke.push(De()),ke)};return(0,t.jsx)(h.H,{actions:(0,t.jsxs)(t.Fragment,{children:[Ge(),(0,t.jsx)(D.K,{leftActionsSeparator:!0}),(0,t.jsx)(f.U,{alignment:"right",children:Ke()})]})})});ce.displayName="DashNav";const le=te(ce),he=(0,r.css)({width:"max-content",maxWidth:"80vw"}),oe=(0,r.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},81196:(q,j,e)=>{"use strict";e.d(j,{_:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(99764);const i=({icon:s,iconType:c,iconSize:d,tooltip:u,onClick:g,children:o})=>{const E=(0,r.of)(x);return(0,t.jsxs)("div",{className:E.noBorderContainer,children:[s&&(0,t.jsx)(a.K,{name:s,size:d,iconType:c,tooltip:u,tooltipPlacement:"bottom",onClick:g}),o]})},x=s=>({noBorderContainer:(0,n.css)({padding:`0 ${s.spacing(.5)}`,display:"flex"})})},39601:(q,j,e)=>{"use strict";e.d(j,{$:()=>o});var t=e(74848),n=e(96540),r=e(30468),a=e(86833),i=e(98140),x=e(85935),s=e(87638),c=e(11817),d=e(61351),u=e(80757),g=e(91830);class o extends n.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=m=>{(0,u.jG)().setAutoRefresh(m),this.forceUpdate()},this.onRefresh=()=>((0,u.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{s.lE.publish(new g.Io({direction:g.xL.Left}))},this.onMoveForward=()=>{s.lE.publish(new g.Io({direction:g.xL.Right}))},this.onChangeTimePicker=m=>{const{dashboard:f}=this.props,p=f.timepicker,h=p.nowDelay&&m.raw.to==="now",D=r.isMathString(m.raw.from)?m.raw.from:m.from,C=r.isMathString(m.raw.to)?m.raw.to:m.to,l={from:D,to:h?"now-"+p.nowDelay:C};(0,u.jG)().setTime(l)},this.onChangeTimeZone=m=>{this.props.dashboard.timezone=m,this.props.onChangeTimeZone(m),this.onRefresh()},this.onChangeFiscalYearStartMonth=m=>{this.props.dashboard.fiscalYearStartMonth=m,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),s.lE.publish(new g.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(a.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:m,isOnCanvas:f}=this.props,{quick_ranges:p,refresh_intervals:h}=m.timepicker,D=(0,u.jG)().getValidIntervals(h||i.cb),C=(0,u.jG)().timeRange(),l=m.getTimezone(),v=m.fiscalYearStartMonth,y=m.panelInEdit?.isEditing,P=m.weekStart;let b;return m.refresh===d.SM&&(b=(0,u.jG)().getAutoRefreshInteval().interval),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.m,{value:C,onChange:this.onChangeTimePicker,timeZone:l,fiscalYearStartMonth:v,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:f,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:P,quickRanges:p}),(0,t.jsx)(i.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:m.refresh,intervals:D,isOnCanvas:f,tooltip:(0,c.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:y,showAutoInterval:!0,text:b})]})}}},64625:(q,j,e)=>{"use strict";e.d(j,{d:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(54594);const i=({children:s,...c})=>{const d=(0,r.of)(x);return(0,t.jsx)("div",{className:d.buttonWrapper,children:(0,t.jsx)(a.$n,{icon:"plus",...c,children:s})})},x=s=>({buttonWrapper:(0,n.css)({padding:`${s.spacing(3)} 0`})})},15832:(q,j,e)=>{"use strict";e.d(j,{p:()=>D});var t=e(74848),n=e(2543),r=e(96540),a=e(59577),i=e(58779),x=e(91036),s=e(86489),c=e(14749),d=e(45282),u=e(34128),g=e(29010),o=e(11817),E=e(98140),m=e(80757);const f=({refreshIntervals:C,onRefreshIntervalChange:l,getIntervalsFunc:v=h,validateIntervalsFunc:y=p})=>{const[P,b]=(0,r.useState)(v(C??E.cb)),[S,M]=(0,r.useState)(null);(0,r.useEffect)(()=>{const B=v(C??E.cb);b(B)},[v,C]);const O=(0,r.useMemo)(()=>Array.isArray(P)?P.join(","):"",[P]),R=(0,r.useCallback)(B=>{const F=B.currentTarget.value?B.currentTarget.value.split(","):[];b(F)},[b]),L=(0,r.useCallback)(B=>{const F=y(P);F===null&&l(v(P)),M(F)},[v,P,l,y]);return(0,t.jsx)(s.D,{label:(0,o.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,o.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:S,invalid:!!S,children:(0,t.jsx)(u.p,{id:"auto-refresh-input",invalid:!!S,value:O,onChange:R,onBlur:L})})},p=(C,l={getTimeSrv:m.jG})=>{try{return h(C,l),null}catch(v){return v instanceof Error?v.message:"Invalid intervals"}},h=(C,l={getTimeSrv:m.jG})=>{const v=C.filter(y=>y.trim()!=="").map(y=>y.replace(/\s+/g,""));return[...new Set(l.getTimeSrv().getValidIntervals(v))]};class D extends r.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=l=>{const v=l.currentTarget.value;if((0,n.isEmpty)(v))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(v);if(a.isValidTimeSpan(v))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(v);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=l=>{typeof l=="string"&&this.props.onTimeZoneChange(l)},this.onWeekStartChange=l=>{this.props.onWeekStartChange(l)}}render(){return(0,t.jsxs)(x.M,{label:(0,o.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,t.jsx)(s.D,{label:(0,o.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":i.Tp.components.TimeZonePicker.containerV2,children:(0,t.jsx)(c.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,t.jsx)(s.D,{label:(0,o.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":i.Tp.components.WeekStartPicker.containerV2,children:(0,t.jsx)(d.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,t.jsx)(f,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,t.jsx)(s.D,{label:(0,o.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,o.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,t.jsx)(u.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,t.jsx)(s.D,{label:(0,o.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,t.jsx)(g.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,t.jsx)(s.D,{label:(0,o.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,o.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'"),children:(0,t.jsx)(g.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},57413:(q,j,e)=>{"use strict";e.d(j,{n:()=>V,C:()=>K});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(54594),x=e(45565),s=e(26676),c=e(20968),d=e(6736),u=e(37e3),g=e(48583),o=e(34128),E=e(79784),m=e(54731),f=e(11817),p=e(99764);const h=({currentPage:z,numberOfPages:w,onNavigate:H,hideWhenSinglePage:G,className:X})=>{const k=(0,a.of)(D);return G&&w<=1?null:(0,t.jsxs)("div",{className:(0,n.cx)(k.wrapper,X),children:[(0,t.jsx)(p.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>H(z-1),disabled:z===1}),z," of ",w,(0,t.jsx)(p.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>H(z+1),disabled:z===w})]})},D=z=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})}),C=({history:z,index:w,onNavigate:H})=>{const G=(0,a.of)(l),X=z.length;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:G.contentWrapper,children:(0,t.jsx)(x.E,{element:"p",color:"secondary",children:z[w-1]})}),(0,t.jsx)(h,{currentPage:w,numberOfPages:X,onNavigate:H,hideWhenSinglePage:!1,className:G.paginationWrapper})]})},l=z=>({paginationWrapper:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,n.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:z.colors.background.secondary,border:`1px solid ${z.colors.border.weak}`,padding:z.spacing(1),minHeight:60})});var v=e(52723);const y=({onSuggestionClick:z,isGenerating:w})=>{const H=(0,a.of)(P);return(0,t.jsxs)("div",{className:H.quickSuggestionsWrapper,children:[(0,t.jsx)(i.$n,{onClick:()=>z(v.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:w,children:v.HG.Shorter}),(0,t.jsx)(i.$n,{onClick:()=>z(v.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:w,children:v.HG.MoreDescriptive}),(0,t.jsx)(i.$n,{onClick:()=>z(v.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:w,children:"Regenerate"})]})},P=z=>({quickSuggestionsWrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:8})});var b=e(16817),S=e(55711),M=e(18729),O=e(17687);const R=(0,M.DW)("features.dashboards.genai");var L=(z=>(z.IDLE="idle",z.GENERATING="generating",z.COMPLETED="completed",z))(L||{});const B=1e4,F={model:v.C4,temperature:1};function I({model:z,temperature:w,onResponse:H}=F){const[G,X]=(0,r.useState)([]),[k,_]=(0,r.useState)(""),[ee,J]=(0,r.useState)("idle"),[Z,te]=(0,r.useState)(),{error:ae}=(0,O._2)();let re="";const ne=(0,r.useCallback)(me=>{J("idle"),X([]),te(me),ae("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(me),R.logError(me,{messages:JSON.stringify(G),model:z,temperature:String(w)})},[G,z,w,ae]);(0,r.useEffect)(()=>{G.length>0&&_("")},[G]);const{error:ce,value:le}=(0,b.A)(async()=>await(0,v.QX)(),[v.QX]),{error:he,value:oe}=(0,b.A)(async()=>{if(!le||!G.length)return{enabled:le};J("generating"),te(void 0);const me=S.qH({model:z,temperature:w,messages:G}).pipe(S.qA());return{enabled:le,stream:me.subscribe({next:Pe=>{re=Pe},error:ne,complete:()=>{_(re),J("completed"),H?.(re),X([]),te(void 0)}})}},[G,le]);(0,r.useEffect)(()=>()=>{oe?.stream?.unsubscribe()},[oe]);const de=(0,r.useCallback)(()=>{oe?.stream?.unsubscribe(),J("idle"),te(void 0),X([])},[oe]);return(0,r.useEffect)(()=>{let me;return ee==="generating"&&k===""&&(me=setTimeout(()=>{ne(new Error(`OpenAI stream timed out after ${B}ms`))},B)),()=>{clearTimeout(me)}},[ee,k,ne]),(he||ce)&&te(he||ce),{setMessages:X,stopGeneration:de,messages:G,reply:k,streamStatus:ee,error:Z,value:oe}}var U=e(34619);const W=.5,A=({eventTrackingSrc:z,history:w,messages:H,onApplySuggestion:G,updateHistory:X})=>{const k=(0,a.of)(N),[_,ee]=(0,r.useState)(1),[J,Z]=(0,r.useState)(""),te=(0,r.useCallback)(Fe=>{X((0,v.Kb)(Fe))},[X]),{setMessages:ae,stopGeneration:re,reply:ne,streamStatus:ce,error:le}=I({model:v.C4,temperature:W,onResponse:te}),he=(Fe,Te)=>(0,U.XX)(z,Fe,Te),oe=Fe=>{Ee(Fe),he(U.KR.customFeedback,{customFeedback:Fe})},de=()=>{re(),ne&&te(ne)},me=()=>{G(w[_-1])},Pe=Fe=>{ee(Fe),he(Fe>_?U.KR.backHistoryItem:U.KR.forwardHistoryItem)},Ee=Fe=>{ae(Te=>[...Te,...(0,v.To)(w[_-1],Fe)]),Fe in v.HG&&he(U.KR.quickFeedback,{quickFeedbackItem:Fe})},be=Fe=>Fe.key==="Enter"&&oe(J),Se=Fe=>Z(Fe.currentTarget.value),Xe=()=>oe(J),Qe=()=>he(U.KR.linkToDocs),we=ce===L.GENERATING,$e=le&&!we;return(0,t.jsxs)("div",{className:k.container,children:[$e&&(0,t.jsx)(u.F,{title:"",children:(0,t.jsx)(g.B,{direction:"column",children:(0,t.jsx)("p",{children:(0,t.jsx)(f.x6,{i18nKey:"gen-ai.incomplete-request-error",children:"Sorry, I was unable to complete your request. Please try again."})})})}),(0,t.jsx)(C,{history:w,index:_,onNavigate:Pe}),(0,t.jsx)("div",{className:k.actionButtons,children:(0,t.jsx)(y,{onSuggestionClick:Ee,isGenerating:we})}),(0,t.jsx)(o.p,{placeholder:"Tell AI what to do next...",suffix:(0,t.jsx)(i.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:Xe,disabled:!J,children:(0,t.jsx)(f.x6,{i18nKey:"gen-ai.send-custom-feedback",children:"Send"})}),value:J,onChange:Se,onKeyDown:be}),(0,t.jsx)("div",{className:k.applySuggestion,children:(0,t.jsx)(g.B,{justifyContent:"flex-end",direction:"row",children:we?(0,t.jsx)(i.$n,{icon:"fa fa-spinner",onClick:de,children:K}):(0,t.jsx)(i.$n,{icon:"check",onClick:me,children:(0,t.jsx)(f.x6,{i18nKey:"gen-ai.apply-suggestion",children:"Apply"})})})}),(0,t.jsxs)("div",{className:k.footer,children:[(0,t.jsx)(E.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:k.infoColor}),(0,t.jsxs)(x.E,{variant:"bodySmall",color:"secondary",children:["This content is AI-generated using the"," ",(0,t.jsx)(m.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Qe,children:"Grafana LLM plugin"})]})]})]})},N=z=>({container:(0,n.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,n.css)({paddingTop:z.spacing(2)}),actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,n.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:z.spacing(1),paddingLeft:z.spacing(2),alignItems:"center",gap:z.spacing(1),borderTop:`1px solid ${z.colors.border.weak}`,marginTop:z.spacing(2)}),infoColor:(0,n.css)({color:z.colors.info.main}),actionButtons:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),K="Stop generating",V=({text:z="Auto-generate",toggleTipTitle:w="",onClick:H,model:G=v.C4,messages:X,onGenerate:k,temperature:_=1,eventTrackingSrc:ee,disabled:J,tooltip:Z})=>{const te=(0,a.of)(T),[ae,re]=(0,r.useState)([]),ne=(0,r.useCallback)(Ne=>{re(ie=>[Ne,...ie])},[]),ce=(0,r.useCallback)(Ne=>{const ie=(0,v.Kb)(Ne);k(ie),ne(ie)},[k,ne]),{setMessages:le,stopGeneration:he,value:oe,error:de,streamStatus:me}=I({model:G,temperature:_,onResponse:ce}),[Pe,Ee]=(0,r.useState)(!1),be=ae.length>0,Se=!be,Xe=me===L.GENERATING,Qe=J||oe&&!oe.enabled&&!de,we=(0,r.useCallback)(Ne=>(0,U.XX)(ee,Ne),[ee]),$e=de||Z?void 0:!1,Fe=de?"Failed to generate content using OpenAI. Please try again or if the problem persists, contact your organization admin.":Z||"",Te=Ne=>{me===L.GENERATING?he():be?Ee(!0):(H?.(Ne),le(Ke()));const ie=de?U.KR.erroredRetryButton:Xe?U.KR.stopGenerationButton:Se?U.KR.autoGenerateButton:U.KR.improveButton;we(ie)};if(!oe?.enabled)return null;const Le=Ne=>{we(U.KR.applySuggestion),k(Ne),Ee(!1)},Ge=()=>{if(!Xe)return de||oe&&!oe.enabled?"exclamation-circle":"ai"},Me=()=>{let Ne=z;return de&&(Ne="Retry"),Xe&&(Ne=K),be&&(Ne="Improve"),Ne},De=(0,t.jsx)(i.$n,{icon:Ge(),onClick:Te,fill:"text",size:"sm",disabled:Qe,variant:de?"destructive":"primary",children:Me()}),Ke=()=>typeof X=="function"?X():X,Ie=()=>{if(be){const Ne=(0,t.jsx)(x.E,{element:"p",children:w});return(0,t.jsx)(s.G,{title:Ne,content:(0,t.jsx)(A,{history:ae,messages:Ke(),onApplySuggestion:Le,updateHistory:ne,eventTrackingSrc:ee}),placement:"left-start",fitContent:!0,show:Pe,onClose:()=>Ee(!1),onOpen:()=>Ee(!0),children:De})}return De};return(0,t.jsxs)("div",{className:te.wrapper,children:[Xe&&(0,t.jsx)(c.y,{size:"sm",className:te.spinner}),Se?(0,t.jsx)(d.m,{show:$e,interactive:!0,content:Fe,children:De}):Ie()]})},T=z=>({wrapper:(0,n.css)({display:"flex"}),spinner:(0,n.css)({color:z.colors.text.link})})},87156:(q,j,e)=>{"use strict";e.d(j,{V:()=>c});var t=e(74848),n=e(16910),r=e(57413),a=e(34619),i=e(52723);const s=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,c=({onGenerate:u})=>{const g=(0,n.UA)().getCurrent(),o=(0,i.N3)(g);return(0,t.jsx)(r.n,{messages:d(g),onGenerate:u,eventTrackingSrc:a.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:o.length===0,tooltip:o.length===0?i.ZN:void 0})};function d(u){return[{content:s,role:i.Xh.system},{content:`The title of the dashboard is "${u.title}"
${(0,i.BB)(u)}`,role:i.Xh.user}]}},36180:(q,j,e)=>{"use strict";e.d(j,{Z:()=>c});var t=e(74848),n=e(16910),r=e(57413),a=e(34619),i=e(52723);const s=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,c=({onGenerate:u})=>{const g=(0,n.UA)().getCurrent(),o=(0,i.N3)(g);return(0,t.jsx)(r.n,{messages:d(g),onGenerate:u,eventTrackingSrc:a.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:o.length===0,tooltip:o.length===0?i.ZN:void 0})};function d(u){return[{content:s,role:i.Xh.system},{content:`The panels in the dashboard are: ${(0,i.BB)(u)}`,role:i.Xh.user}]}},65988:(q,j,e)=>{"use strict";e.d(j,{t:()=>c});var t=e(74848),n=e(16910),r=e(57413),a=e(34619),i=e(52723);const s=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,c=({onGenerate:u,panel:g})=>(0,t.jsx)(r.n,{messages:()=>d(g),onGenerate:u,eventTrackingSrc:a.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function d(u){const g=(0,n.UA)().getCurrent(),o=(0,i.hn)(u);return[{content:s,role:i.Xh.system},{content:`The panel is part of a dashboard with the title: ${g.title}
The panel is part of a dashboard with the description: ${g.description}
This is the JSON which defines the panel: ${o}`,role:i.Xh.user}]}},36292:(q,j,e)=>{"use strict";e.d(j,{h:()=>s});var t=e(74848),n=e(57413),r=e(34619),a=e(52723);const x="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",s=({onGenerate:d,panel:u,dashboard:g})=>(0,t.jsx)(n.n,{messages:()=>c(u,g),onGenerate:d,eventTrackingSrc:r.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function c(d,u){const g=(0,a.hn)(d);return[{content:x,role:a.Xh.system},{content:`The panel is part of a dashboard with the title: ${u.title}
The panel is part of a dashboard with the description: ${u.description}
Use this JSON object which defines the panel: ${g}`,role:a.Xh.user}]}},34619:(q,j,e)=>{"use strict";e.d(j,{KR:()=>a,XX:()=>i,ec:()=>r});var t=e(56276);const n="dashboards_autogenerate_clicked";var r=(x=>(x.panelDescription="panel-description",x.panelTitle="panel-title",x.dashboardChanges="dashboard-changes",x.dashboardTitle="dashboard-title",x.dashboardDescription="dashboard-description",x.unknown="unknown",x))(r||{}),a=(x=>(x.autoGenerateButton="auto-generate-button",x.erroredRetryButton="errored-retry-button",x.stopGenerationButton="stop-generating-button",x.improveButton="improve-button",x.backHistoryItem="back-history-item",x.forwardHistoryItem="forward-history-item",x.quickFeedback="quick-feedback",x.linkToDocs="link-to-docs",x.customFeedback="custom-feedback",x.applySuggestion="apply-suggestion",x))(a||{});function i(x,s,c){(0,t.rR)(n,{src:x,item:s,...c})}},52723:(q,j,e)=>{"use strict";e.d(j,{ZN:()=>M,C4:()=>D,HG:()=>h,Xh:()=>p,Yy:()=>l,BB:()=>b,To:()=>P,hn:()=>S,N3:()=>O,QX:()=>y,Kb:()=>C});var t=e(2543),n=e(55711),r=e(32370),a=e(61976),i=e(90254),x=e(36503);function s(L,B){return L===B?B:Array.isArray(L)&&Array.isArray(B)?u(L,B):c(L)&&c(B)?d(L,B):B}function c(L){return typeof L=="object"&&!Array.isArray(L)&&L!==null}function d(L,B){const F=Object.keys(L),I={};for(const U of F)B.hasOwnProperty(U)&&(Array.isArray(L[U])&&Array.isArray(B[U])||typeof L[U]=="object"&&typeof B[U]=="object"?I[U]=s(L[U],B[U]):I[U]=B[U]);return I}function u(L,B){const F=new Array(L.length).fill(void 0),I=new Set([...Array(L.length).keys()]),U=new Set([...Array(B.length).keys()]);for(let W=0;W<L.length&&U.size!==0;W++){let A=L[W];for(let N=0;N<B.length;N++){if(!U.has(N))continue;let K=B[N];K=s(A,K),JSON.stringify(A)===JSON.stringify(K)&&(I.delete(W),U.delete(N),F[W]=K)}}return g(L,B,F,I,U),F.filter(W=>W!==void 0)}function g(L,B,F,I,U){let W={};U.forEach(N=>{let K=B[N];if(typeof K!="object"||Array.isArray(K)){F.push(K),U.delete(N);return}I.forEach(V=>{let T=L[V];if(typeof T!="object"||Array.isArray(T)){I.delete(V);return}let z=0;for(const w in T){let H=T[w];if(!K.hasOwnProperty(w))continue;let G=K[w];typeof H!="string"&&typeof H!="number"||typeof H!=typeof G||H===G&&(w==="id"&&(z+=1e3),z++)}z!==0&&(W[z]===void 0&&(W[z]=[]),W[z].push([V,N]))})});const A=Object.keys(W).map(Number);A.sort((N,K)=>K-N);for(const N of A){let K=W[N];for(const V of K){const[T,z]=V;I.has(T)&&U.has(z)&&(F[T]=B[z],I.delete(T),U.delete(z))}}for(const N of U)F.push(B[N])}function o(L){const B=L.split(`
`);let F=L[0].startsWith("Index")?4:3,I=B.slice(0,F);const U=/("title"|Title|\{|\}|\[|\])/i;for(let W=F;W<B.length;W++){let A=B[W];(U.test(A)||A.startsWith("+")||A.startsWith("-"))&&I.push(A)}return I.join(`
`)+`
`}function E(L){if(L===null||L==="")return null;if(Array.isArray(L)){const F=L.map(I=>E(I)).filter(I=>I!==null);return F.length>0?F:null}if(typeof L!="object")return L;const B={};for(const F in L){const I=E(L[F]);if(I!==null){if(Array.isArray(I)&&I.length===0||typeof I=="object"&&Object.keys(I).length===0)continue;B[F]=I}}return Object.keys(B).length>0?B:null}function m(L){return JSON.parse(JSON.stringify(L,null,2))}function f(L){let B=m(L.getOriginalDashboard()),F=m(new x.G(B).getSaveModelClone()),I=m(L.getSaveModelClone());F=E(s(B,F)),I=E(s(F,I)),B=E(B);let U=(0,i.ss)("Before migration changes","After migration changes",JSON.stringify(B,null,2),JSON.stringify(F,null,2),"","",{context:20}),W=(0,i.ss)("Before user changes","After user changes",JSON.stringify(F,null,2),JSON.stringify(I,null,2),"","",{context:20});return U=o(U),W=o(W),{migrationDiff:U,userDiff:W}}var p=(L=>(L.system="system",L.user="user",L))(p||{}),h=(L=>(L.Shorter="Even shorter",L.MoreDescriptive="More descriptive",L.Regenerate="Please, regenerate",L))(h||{});const D="gpt-4",C=L=>L.replace(/^"|"$/g,"");function l(L){const{migrationDiff:B,userDiff:F}=f(L);return{userChanges:F,migrationChanges:B}}let v;async function y(){return r.$.apps["grafana-llm-app"]?v||(v=new Promise(L=>{n.vK().then(B=>{B.ok||(v=void 0),L(B.ok)})}),v):!1}const P=(L,B)=>[{role:"system",content:`Your previous response was: ${L}. The user has provided the following feedback: ${B}. Re-generate your response according to the provided feedback.`}];function b(L){const B=O(L);let F;if(B.length<=10)F=`The panels in the dashboard are:
${B.join(`
`)}`;else{const I=L.panels.filter(A=>A.description),U=L.panels.filter(A=>!A.description);let W;I.length>=10?W=I.slice(10).map(R).join(`
`):(W=I.map(R).join(`
`),W+=`
`,W+=U.slice(10-I.length).map(R).join("n")),F=`There are ${B.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${W}`}return F}function S(L){const B=["datasource","title","description","targets","type"],F={...(0,t.pick)(L,B),options:(0,t.pick)(L.options,["content"])};return JSON.stringify(F,null,2)}const M="To generate this content your dashboard must contain at least one panel with a valid title or description.";function O(L){return L.panels.filter(F=>F.title.length>0&&F.title!==a.LH||F.description&&F.description.length>0).map(R)}const R=(L,B)=>`- Panel ${B}
- Title: ${L.title}${L.description?`
- Description: ${L.description}`:""}`},5573:(q,j,e)=>{"use strict";e.d(j,{B6:()=>g,E_:()=>E,jD:()=>o});var t=e(2543),n=e.n(t),r=e(72985),a=e(26701),i=e(7500),x=e(88090),s=e(8392),c=e(32370),d=e(48806),u=e(92980);function g(D){const C=[];if(D?.series)for(const l of D.series)C.push((0,a.Nw)(l));if(D?.annotations)for(const l of D.annotations){const v=(0,a.Nw)(l);v.schema?.meta||(v.schema.meta={}),v.schema.meta.dataTopic=i.QR.Annotations,C.push(v)}return C}function o(D,C){const l=D.getSaveModel(),v={panelType:l.type,datasource:"??"},y=c.$.buildInfo.versionString;let P=`| Key | Value |
|--|--|
| Panel | ${v.panelType} @ ${l.pluginVersion??y} |
| Grafana | ${y} // ${c.$.buildInfo.edition} |
`;return C&&(P+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+C+"\n```\n</details>"),P}async function E(D,C,l){const v=D.getSaveModel(),y=(0,t.cloneDeep)(h),P={panelType:v.type,datasource:"??"},b=await(0,r._)(D.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),S=D.datasource,M=(0,d.W)(g(b),C),O=c.$.buildInfo.versionString,R=v?.targets??[],L=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${P.panelType} @ ${v.pluginVersion??O}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${R.map(B=>{const F=B.datasource??S;return`${B.refId}[${F?.type}]`}).join(", ")}</td>
    </tr>
    ${m(v)}
    ${f(b,M)}
    ${p(b)}
    <tr>
      <th>Grafana</th>
      <td>${O} // ${c.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(y.panels[0]={...v,...y.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:u.nj.Snapshot,snapshot:M}]},v.transformations?.length){const B=y.panels[y.panels.length-1];B.title=B.title+" (after transformations)";const F=(0,t.cloneDeep)(B);F.id=100,F.title="Data (before transformations)",F.gridPos.w=24,F.targets[0].withTransforms=!1,y.panels.push(F)}return b.annotations?.length&&y.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:i.QR.Annotations,refId:"A"}]}),y.panels[1].options.content=L,y.panels[2].options.content=JSON.stringify(v,null,2),y.title=`Debug: ${v.title} // ${(0,x.LE)(new Date)}`,y.tags=["debug",`debug-${P.panelType}`],y.time={from:l.from.toISOString(),to:l.to.toISOString()},y}function m(D){return D.transformations?`<tr>
      <th>Transform</th>
      <td>${D.transformations.map(C=>C.id).join(", ")}</td>
  </tr>`:""}function f(D,C){let l=D.series.length??0,v=0,y=0;for(const P of D.series)v+=P.fields.length,y+=P.length;return`<tr><th>Data</th><td>${D.state!==s.Gu.Done?D.state:""} ${l} frames, ${v} fields, ${y} rows </td></tr>`}function p(D){return D.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${D.annotations.map((C,l)=>`<span>${C.length}</span>`)}</td>
</tr>`:""}const h={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},52933:(q,j,e)=>{"use strict";e.d(j,{BN:()=>c,kx:()=>d,sd:()=>s});var t=e(96540),n=e(24705),r=e(98437),a=e(11817),i=e(76530),x=e(14770);const s=u=>(0,n.A)(async()=>c(u),[u]).value;async function c(u){const g=u?.request?.targets||[];if(u&&u.series&&g.length){for(const o of u.series)if(o.meta&&o.meta.custom){const E=await(0,r.l)().get(g[0].datasource);if(E&&E.components?.MetadataInspector)return E}}}const d=(u,g,o,E,m)=>(0,t.useMemo)(()=>{const f=[];return(0,x.$)(o)&&(f.push({label:(0,a.t)("dashboard.inspect.data-tab","Data"),value:i.q.Data}),f.push({label:(0,a.t)("dashboard.inspect.stats-tab","Stats"),value:i.q.Stats})),m&&f.push({label:(0,a.t)("dashboard.inspect.meta-tab","Meta data"),value:i.q.Meta}),f.push({label:(0,a.t)("dashboard.inspect.json-tab","JSON"),value:i.q.JSON}),E&&f.push({label:(0,a.t)("dashboard.inspect.error-tab","Error"),value:i.q.Error}),g.meta.canEdit&&(0,x.$)(o)&&f.push({label:(0,a.t)("dashboard.inspect.query-tab","Query"),value:i.q.Query}),f},[o,m,g,E])},20621:(q,j,e)=>{"use strict";e.d(j,{D:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(78685),i=e(58779),x=e(13676),s=e(29675),c=e(54594),d=e(65539),u=e(36608);const g="showCategory",o=r.memo(({id:f,title:p,children:h,forceOpen:D,isOpenDefault:C=!0,renderTitle:l,className:v,itemsCount:y,isNested:P=!1,sandboxId:b})=>{const[S,M]=(0,a.A)(m(f),{isExpanded:C}),[O,R]=(0,r.useState)(S?.isExpanded??C),L=(0,r.useRef)(0),B=(0,r.useRef)(null),[F,I]=(0,d.s)(),U=F[g]===f;(0,r.useEffect)(()=>{L.current&&Date.now()-L.current<200||(U||D)&&(O||R(!0),U&&B.current?.scrollIntoView())},[D,O,U]);const W=(0,r.useCallback)(()=>{L.current=Date.now(),I({[g]:O?void 0:f},!0),M({isExpanded:!O}),R(!O)},[M,R,I,O,f]);l||(l=function(z){return z||y===void 0||y===0?p:(0,t.jsxs)("span",{children:[p," ",(0,t.jsx)(x.p,{value:y})]})});const A=(0,s.of)(E),N=(0,n.cx)({[A.box]:!0,[A.boxNestedExpanded]:P&&O},v),K=(0,n.cx)(A.header,{[A.headerExpanded]:O,[A.headerNested]:P}),V=(0,n.cx)(A.body,{[A.bodyNested]:P});return(0,t.jsxs)("div",{className:N,"data-plugin-sandbox":b,"data-testid":i.Tp.components.OptionsGroup.group(f),ref:B,children:[(0,t.jsxs)("div",{className:K,onClick:W,children:[(0,t.jsx)("h6",{id:`button-${f}`,className:A.title,children:l(O)}),(0,t.jsx)(c.$n,{"data-testid":i.Tp.components.OptionsGroup.toggle(f),type:"button",fill:"text",size:"md",variant:"secondary","aria-expanded":O,className:A.toggleButton,icon:O?"angle-up":"angle-down",onClick:W})]}),O&&(0,t.jsx)("div",{className:V,id:f,"aria-labelledby":`button-${f}`,children:h})]})});o.displayName="OptionsPaneCategory";const E=f=>({box:(0,n.css)({borderTop:`1px solid ${f.colors.border.weak}`}),boxNestedExpanded:(0,n.css)({marginBottom:f.spacing(2)}),title:(0,n.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",fontWeight:f.typography.fontWeightMedium,margin:0}),header:(0,n.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:f.spacing(.5,1.5),color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,"&:hover":{background:f.colors.emphasize(f.colors.background.primary,.03)}}),toggleButton:(0,n.css)({alignSelf:"baseline"}),headerExpanded:(0,n.css)({color:f.colors.text.primary}),headerNested:(0,n.css)({padding:f.spacing(.5,0,.5,0)}),body:(0,n.css)({padding:f.spacing(1,2,1,2)}),bodyNested:(0,n.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"1px",width:"1px",height:"100%",background:f.colors.border.weak}})}),m=f=>`${u.wi}.optionGroup[${f}]`},12422:(q,j,e)=>{"use strict";e.d(j,{C:()=>a});var t=e(74848),n=e(90231),r=e(20621);class a{constructor(x){this.props=x,this.items=[],this.categories=[]}addItem(x){return x.parent=this,this.items.push(x),this}addCategory(x){return x.props.isNested=!0,x.parent=this,this.categories.push(x),this}getCategory(x){let s=this.categories.find(c=>c.props.id===x);return s||(s=new a({title:x,id:x}),this.addCategory(s)),s}render(x){return this.props.customRender?this.props.customRender():this.props.id===""?(0,t.jsx)(n.a,{padding:2,children:this.items.map(s=>s.render(x))}):(0,t.jsxs)(r.D,{...this.props,children:[this.items.map(s=>s.render(x)),this.categories.map(s=>s.render(x))]},this.props.title)}}},12600:(q,j,e)=>{"use strict";e.d(j,{v:()=>o});var t=e(74848),n=e(22803),r=e(23257),a=e.n(r),i=e(58779),x=e(86489),s=e(40271),c=e(29675),d=e(6736);function u({overrides:D}){const C=(0,c.of)(g);return(0,t.jsx)("div",{className:C.wrapper,children:D.map((l,v)=>(0,t.jsx)(d.m,{content:l.tooltip,placement:"top",children:(0,t.jsx)("div",{"aria-label":l.description,className:C[l.type]})},v.toString()))})}const g=D=>{const C={width:8,height:8,borderRadius:D.shape.radius.circle,marginLeft:D.spacing(1),top:"-1px"};return{wrapper:(0,n.css)({display:"flex"}),rule:(0,n.css)({...C,position:"relative",backgroundColor:D.colors.primary.main}),data:(0,n.css)({...C,position:"relative",backgroundColor:D.colors.warning.main})}};class o{constructor(C){this.props=C}render(C){return(0,t.jsx)(E,{itemDescriptor:this,searchQuery:C},this.props.title)}useShowIf(){return this.props.useShowIf?this.props.useShowIf():this.props.showIf?this.props.showIf():!0}}function E({itemDescriptor:D,searchQuery:C}){const{title:l,description:v,render:y,skipField:P}=D.props,b=`${D.parent.props.id} ${l}`;return D.useShowIf()?P?y():(0,t.jsx)(x.D,{label:m(D,C),description:v,"aria-label":i.Tp.components.PanelEditor.OptionsPane.fieldLabel(b),children:y()},b):null}function m(D,C){const{title:l,description:v,overrides:y,addon:P}=D.props;if(!C)return D.parent.props.title===l&&!y?.length?null:(0,t.jsx)(p,{title:l,description:v,overrides:y,addon:P});const b=[];return D.parent.parent&&b.push(f(D.parent.parent.props.title,C)),D.parent.props.title!==l&&b.push(f(D.parent.props.title,C)),(0,t.jsxs)(s.J,{description:v&&f(v,C),category:b,children:[f(l,C),y&&y.length>0&&(0,t.jsx)(u,{overrides:y})]})}function f(D,C){return(0,t.jsx)(a(),{textToHighlight:D,searchWords:[C],highlightClassName:"search-fragment-highlight"})}function p({title:D,description:C,overrides:l,addon:v}){const y=(0,c.of)(h);return(0,t.jsxs)("div",{className:y.container,children:[(0,t.jsxs)(s.J,{description:C,children:[D,l&&l.length>0&&(0,t.jsx)(u,{overrides:l})]}),v]})}function h(D){return{container:(0,n.css)({display:"flex",justifyContent:"space-between"})}}},91098:(q,j,e)=>{"use strict";e.d(j,{gs:()=>ee,Ff:()=>k,Po:()=>J});var t=e(74848),n=e(22803),r=e(96540),a=e(32370),i=e(29675),x=e(22560),s=e(60641),c=e(99134),d=e(93420),u=e(54506),g=e(71468),o=e(4050),E=e(65305),m=e(56152),f=e(82856);function p(te,ae){f.A.set(`panel-edit-section-${te}`,ae?"true":"false")}function h(te,ae){return f.A.getBool(`panel-edit-section-${te}`,ae)}const D=(te,ae)=>({angularPanelComponent:(0,m.U)(te,ae.panel)?.angularComponent}),C={changePanelPlugin:E.gW},l=(0,g.connect)(D,C);class v extends r.PureComponent{constructor(ae){super(ae)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(ae){(this.props.plugin!==ae.plugin||this.props.angularPanelComponent!==ae.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:ae,angularPanelComponent:re,changePanelPlugin:ne}=this.props;if(!this.element||!re||this.angularOptions)return;const ce=re.getScope();if(!ce.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const le=ce.$$childHead.ctrl;le.initEditMode(),le.onPluginTypeChange=me=>{ne({panel:ae,pluginId:me.id})};let he="";for(let me=0;me<le.editorTabs.length;me++){const Pe=le.editorTabs[me];Pe.isOpen=h(Pe.title,me===0),he+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${me})" aria-label="${Pe.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${me}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${Pe.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${me}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${me}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const oe=(0,o.E)(),de={ctrl:le,toggleOptionGroup:me=>{const Pe=le.editorTabs[me];Pe.isOpen=!Pe.isOpen,p(Pe.title,!!Pe.isOpen)}};this.angularOptions=oe.load(this.element,de,he),this.angularOptions.digest()}render(){return(0,t.jsx)("div",{ref:ae=>this.element=ae})}}const y=(0,g.connect)(D,C)(v);var P=e(20621),b=e(81003),S=e(34128);const M=({panel:te,formatDate:ae})=>{const re=(0,i.of)(O),ne=te.libraryPanel?.meta;return ne?(0,t.jsxs)("div",{className:re.info,children:[(0,t.jsxs)("div",{className:re.libraryPanelInfo,children:[`Used on ${ne.connectedDashboards} `,ne.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:re.libraryPanelInfo,children:["Last edited on ",ae?.(ne.updated,"L")??ne.updated," by",ne.updatedBy.avatarUrl&&(0,t.jsx)("img",{width:"22",height:"22",className:re.userAvatar,src:ne.updatedBy.avatarUrl,alt:`Avatar for ${ne.updatedBy.name}`}),ne.updatedBy.name]})]}):null},O=te=>({info:(0,n.css)({lineHeight:1}),libraryPanelInfo:(0,n.css)({color:te.colors.text.secondary,fontSize:te.typography.bodySmall.fontSize}),userAvatar:(0,n.css)({borderRadius:te.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:te.spacing(1),paddingRight:te.spacing(1)})});var R=e(12422),L=e(12600);function B(te){const{panel:ae,onPanelConfigChange:re,dashboard:ne}=te,ce=new R.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,u.X)(ae)&&ce.addItem(new L.v({title:"Name",value:ae.libraryPanel.name,popularRank:1,render:function(){return(0,t.jsx)(S.p,{id:"LibraryPanelFrameName",defaultValue:ae.libraryPanel.name,onBlur:he=>re("libraryPanel",{...ae.libraryPanel,name:he.currentTarget.value})})}})).addItem(new L.v({title:"Information",render:function(){return(0,t.jsx)(M,{panel:ae,formatDate:ne.formatDate})}})),ce}var F=e(58779),I=e(50926),U=e(29010),W=e(99153),A=e(44826),N=e(89146),K=e(65988),V=e(36292),T=e(66732);function z(te){const{dashboard:ae,panel:re,onPanelConfigChange:ne}=te,ce=new R.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),le=oe=>{const de=document.getElementById("PanelFrameTitle");de instanceof HTMLInputElement&&(de.value=oe,ne("title",oe))},he=oe=>{const de=document.getElementById("description-text-area");de instanceof HTMLTextAreaElement&&(de.value=oe,ne("description",oe))};return ce.addItem(new L.v({title:"Title",value:re.title,popularRank:1,render:function(){return(0,t.jsx)(S.p,{"data-testid":F.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:re.title,onBlur:de=>ne("title",de.currentTarget.value)})},addon:a.$.featureToggles.dashgpt&&(0,t.jsx)(V.h,{onGenerate:le,panel:re.getSaveModel(),dashboard:ae.getSaveModelClone()})})).addItem(new L.v({title:"Description",description:re.description,value:re.description,render:function(){return(0,t.jsx)(I.f,{"data-testid":F.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:re.description,onBlur:de=>ne("description",de.currentTarget.value)})},addon:a.$.featureToggles.dashgpt&&(0,t.jsx)(K.t,{onGenerate:he,panel:re.getSaveModel()})})).addItem(new L.v({title:"Transparent background",render:function(){return(0,t.jsx)(U.d,{"data-testid":F.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:re.transparent,id:"transparent-background",onChange:de=>ne("transparent",de.currentTarget.checked)})}})).addCategory(new R.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:re.links?.length}).addItem(new L.v({title:"Panel links",render:function(){return(0,t.jsx)(W.e,{links:re.links,onChange:de=>ne("links",de),getSuggestions:N.Fq,data:[]})}}))).addCategory(new R.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new L.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,t.jsx)(T.G,{id:"repeat-by-variable-select",repeat:re.repeat,onChange:de=>{ne("repeat",de)}})}})).addItem(new L.v({title:"Repeat direction",showIf:()=>!!re.repeat,render:function(){const de=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,t.jsx)(s.z,{options:de,value:re.repeatDirection||"h",onChange:me=>ne("repeatDirection",me)})}})).addItem(new L.v({title:"Max per row",showIf:()=>!!(re.repeat&&re.repeatDirection==="h"),render:function(){const de=[2,3,4,6,8,12].map(me=>({label:me.toString(),value:me}));return(0,t.jsx)(A.l6,{options:de,value:re.maxPerRow,onChange:me=>ne("maxPerRow",me.value)})}})))}var w=e(4527);class H{constructor(ae,re){this.categories=ae,this.overrides=re}search(ae){const re=new RegExp(ae,"i"),ce=this.collectHits(this.categories,re,[]).sort(G).map(oe=>oe.item),he=this.collectHits(this.overrides,re,[]).sort(G).map(oe=>oe.item);return{optionHits:ce,overrideHits:this.buildOverrideHitCategories(he),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(ae,re,ne){for(const ce of ae){const le=re.test(ce.props.title);for(const he of ce.items){if(re.test(he.props.title)){ne.push({item:he,rank:1});continue}if(he.props.description&&re.test(he.props.description)){ne.push({item:he,rank:2});continue}le&&ne.push({item:he,rank:3})}ce.categories.length>0&&this.collectHits(ce.categories,re,ne)}return ne}getAllOptionsCount(ae){let re=0;for(const ne of ae)re+=ne.items.length,ne.categories.length>0&&(re+=this.getAllOptionsCount(ne.categories));return re}buildOverrideHitCategories(ae){const re={};for(const ne of ae){let ce=re[ne.parent.props.title];ce||(ce=re[ne.parent.props.title]=new R.C(ne.parent.props),ce.addItem(ne.parent.items[0])),ce.items[0].props.title!==ne.props.title&&ce.addItem(ne)}return Object.values(re)}}function G(te,ae){return te.rank-ae.rank}function X(te){const ae=[];for(const re of te)for(const ne of re.items)ne.props.title==="Unit"&&(ne.props.popularRank=2),ne.props.title==="Min"&&(ne.props.popularRank=3),ne.props.title==="Max"&&(ne.props.popularRank=4),ne.props.title==="Display name"&&(ne.props.popularRank=5),ne.props.popularRank&&ae.push(ne);return ae.sort((re,ne)=>re.props.popularRank-ne.props.popularRank)}const k=te=>{const{plugin:ae,dashboard:re,panel:ne}=te,[ce,le]=(0,r.useState)(""),[he,oe]=(0,r.useState)("All"),de=(0,i.of)(Z),[me,Pe,Ee]=(0,r.useMemo)(()=>[z(te),(0,w.Zm)(te),B(te)],[ne.configRev,te.data,te.instanceState,ce]),be=(0,r.useMemo)(()=>(0,b.v)(te.panel.fieldConfig,te.plugin.fieldConfigRegistry,te.data?.series??[],ce,te.onFieldConfigsChange),[ne.configRev,te.data,te.instanceState,ce]),Se=[],Xe=ce.length>0,Qe=(0,r.useMemo)(_,[]),we=(0,u.X)(ne)?[Ee,me,...Pe]:[me,...Pe];if(Xe)Se.push(J(we,be,ce)),te.plugin.angularPanelCtrl&&Se.push((0,t.jsx)("div",{className:de.searchNotice,children:"This is an old visualization type that does not support searching all options."},"Search notice"));else switch(he){case"All":(0,u.X)(ne)&&Se.push(Ee.render()),Se.push(me.render()),te.plugin.angularPanelCtrl&&Se.push((0,t.jsx)(y,{plugin:ae,dashboard:re,panel:ne},"AngularOptions"));for(const Fe of Pe)Se.push(Fe.render());for(const Fe of be)Se.push(Fe.render());break;case"Overrides":for(const Fe of be)Se.push(Fe.render());break;case"Recent":Se.push((0,t.jsx)(P.D,{id:"Recent options",title:"Recent options",forceOpen:1,children:X(we).map(Fe=>Fe.render())},"Recent options"));break}const $e=!Xe&&!ae.fieldConfigRegistry.isEmpty();return(0,t.jsxs)("div",{className:de.wrapper,children:[(0,t.jsxs)("div",{className:de.formBox,children:[ne.isAngularPlugin()&&!ae.meta.angular?.hideDeprecation&&(0,t.jsx)(d.c,{className:de.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:ae.meta.id,pluginType:ae.meta.type,angularSupportEnabled:a.$?.angularSupportEnabled,interactionElementId:"panel-options"}),(0,t.jsx)("div",{className:de.formRow,children:(0,t.jsx)(x.Z,{width:0,value:ce,onChange:le,placeholder:"Search options"})}),$e&&(0,t.jsx)("div",{className:de.formRow,children:(0,t.jsx)(s.z,{options:Qe,value:he,fullWidth:!0,onChange:oe})})]}),(0,t.jsx)(c.P,{children:(0,t.jsx)("div",{className:de.mainBox,children:Se})})]})};function _(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ee=(te=>(te.All="All",te.Overrides="Overrides",te.Recent="Recent",te))(ee||{});function J(te,ae,re){const ne=new H(te,ae),{optionHits:ce,totalCount:le,overrideHits:he}=ne.search(re);return(0,t.jsxs)("div",{children:[(0,t.jsx)(P.D,{id:"Found options",title:`Matched ${ce.length}/${le} options`,forceOpen:1,children:ce.map(oe=>oe.render(re))},"Normal options"),he.map(oe=>oe.render(re))]},"search results")}const Z=te=>({wrapper:(0,n.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:te.colors.warning.text,background:"transparent"}}),searchBox:(0,n.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,n.css)({marginBottom:te.spacing(1)}),formBox:(0,n.css)({padding:te.spacing(1),background:te.colors.background.primary,border:`1px solid ${te.components.panel.borderColor}`,borderTopLeftRadius:te.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,n.css)({marginLeft:te.spacing(1)}),searchHits:(0,n.css)({padding:te.spacing(1,1,0,1)}),searchNotice:(0,n.css)({fontSize:te.typography.size.sm,color:te.colors.text.secondary,padding:te.spacing(1),textAlign:"center"}),mainBox:(0,n.css)({background:te.colors.background.primary,border:`1px solid ${te.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,n.css)({padding:te.spacing(1)})})},81003:(q,j,e)=>{"use strict";e.d(j,{v:()=>O});var t=e(74848),n=e(22803),r=e(2543),a=e(40462),i=e(62321),x=e(13286),s=e(31952),c=e(29675),d=e(89146),u=e(96540),g=e(23257),o=e.n(g),E=e(19550),m=e(40271),f=e(13676),p=e(99764),h=e(86489),D=e(20621);const C=({property:F,context:I,registry:U,onChange:W,onRemove:A,isSystemOverride:N,searchQuery:K})=>{const V=(0,c.of)(l),T=U?.getIfExists(F.id),z=(0,u.useId)();if(!T)return null;const w=Array.isArray(F.value)||F.id===i.uo.Thresholds||F.id===i.uo.Links||F.id===i.uo.Mappings,H=T.category?.filter(k=>k!==T.name);let G;const X=(k=!0,_=!1)=>(ee=!1)=>(0,t.jsxs)(E.Gy,{justify:"space-between",children:[(0,t.jsxs)(m.J,{category:H,description:k?T.description:void 0,htmlFor:z,children:[(0,t.jsx)(o(),{textToHighlight:T.name,searchWords:[K],highlightClassName:"search-fragment-highlight"}),!ee&&_&&T.getItemsCount&&(0,t.jsx)(f.p,{value:T.getItemsCount(F.value)})]}),!N&&(0,t.jsx)("div",{children:(0,t.jsx)(p.K,{name:"times",onClick:A,tooltip:"Remove property"})})]});return w?G=(0,t.jsx)(D.D,{id:T.name,renderTitle:X(!1,!0),className:(0,n.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:F.value!==void 0,children:(0,t.jsx)(T.override,{value:F.value,onChange:k=>{W(k)},item:T,context:I})}):G=(0,t.jsx)("div",{children:(0,t.jsx)(h.D,{label:X()(),description:T.description,children:(0,t.jsx)(T.override,{value:F.value,onChange:k=>{W(k)},item:T,context:I,id:z})})}),(0,t.jsx)("div",{className:(0,n.cx)(w&&V.collapsibleOverrideEditor,!w&&"dynamicConfigValueEditor--nonCollapsible"),children:G})},l=F=>({collapsibleOverrideEditor:(0,n.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:F.spacing(1)}})});var v=e(12422),y=e(12600),P=e(54594),b=e(79784);const S=({isExpanded:F,registry:I,matcherUi:U,overrideName:W,override:A,onOverrideRemove:N})=>{const K=(0,c.of)(M),T=A.properties.map(w=>I.getIfExists(w.id)).filter(w=>!!w).map(w=>w?.name).join(", "),z=U.optionsToLabel(A.matcher.options);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(E.Gy,{justify:"space-between",children:[(0,t.jsx)("div",{children:W}),(0,t.jsx)(P.$n,{variant:"secondary",fill:"text",icon:"trash-alt",onClick:N,tooltip:"Remove override","aria-label":"Remove override"})]}),!F&&(0,t.jsx)("div",{className:K.overrideDetails,children:(0,t.jsxs)("div",{className:K.options,title:z,children:[z," ",(0,t.jsx)(b.I,{name:"angle-right"})," ",T]})})]})};S.displayName="OverrideTitle";const M=F=>({matcherUi:(0,n.css)({padding:F.spacing(1)}),propertyPickerWrapper:(0,n.css)({marginTop:F.spacing(2)}),overrideDetails:(0,n.css)({fontSize:F.typography.bodySmall.fontSize,color:F.colors.text.secondary,fontWeight:F.typography.fontWeightRegular}),options:(0,n.css)({overflow:"hidden",paddingRight:F.spacing(4)}),unknownLabel:(0,n.css)({marginBottom:0})});function O(F,I,U,W,A){const N=[],K=F;if(!I||I.isEmpty())return[];const V=(H,G)=>{let X=(0,r.cloneDeep)(K.overrides);X[H]=G,A({...K,overrides:X})},T=H=>{let G=(0,r.cloneDeep)(K.overrides);G.splice(H,1),A({...K,overrides:G})},z=H=>{const G=a.sJ.get(H.value);G&&A({...K,overrides:[...K.overrides,{matcher:{id:G.id,options:G.defaultOptions},properties:[]}]})},w={data:U,getSuggestions:H=>(0,d.Hf)(U,H),isOverride:!0};for(let H=0;H<K.overrides.length;H++){const G=K.overrides[H],X=`Override ${H+1}`,k=x.g.get(G.matcher.id),_=R(I),ee=(0,i.Ow)(G),J=G.properties.length===0?1:0,Z=new v.C({title:X,id:X,forceOpen:J,renderTitle:function(ne){return(0,t.jsx)(S,{override:G,isExpanded:ne,registry:I,overrideName:X,matcherUi:k,onOverrideRemove:()=>T(H)})}}),te=re=>{V(H,{...G,matcher:{...G.matcher,options:re}})},ae=(re,ne)=>{const ce=I.get(ne.value),le={id:ce.id,value:ce.defaultValue},he=re.properties??[];he.push(le),V(H,{...re,properties:he})};Z.addItem(new y.v({title:k.name,render:function(){return(0,t.jsx)(k.component,{id:`${k.matcher.id}-${H}`,matcher:k.matcher,data:U??[],options:G.matcher.options,onChange:te})}}));for(let re=0;re<G.properties.length;re++){const ne=G.properties[re],ce=I.getIfExists(ne.id);if(!ce)continue;const le=oe=>{V(H,{...G,properties:G.properties.map((de,me)=>me===re?{...de,value:oe}:de)})},he=()=>{V(H,{...G,properties:G.properties.filter((oe,de)=>de!==re)})};Z.addItem(new y.v({title:ce.name,skipField:!0,render:function(){return(0,t.jsx)(C,{isSystemOverride:ee,onChange:le,onRemove:he,property:ne,registry:I,context:w,searchQuery:W},`${ne.id}/${re}`)}}))}!ee&&G.matcher.options&&Z.addItem(new y.v({title:"----------",skipField:!0,render:function(){return(0,t.jsx)(s.i,{label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:_,onChange:ne=>ae(G,ne)},"Add override property")}})),N.push(Z)}return N.push(new v.C({title:"add button",id:"add button",customRender:function(){return(0,t.jsx)(L,{children:(0,t.jsx)(s.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:x.g.list().filter(G=>!G.excludeFromPicker).map(G=>({label:G.name,value:G.id,description:G.description})),onChange:G=>z(G)})},"Add override")}})),N}function R(F){return F.list().filter(I=>!I.hideFromOverrides).map(I=>{let U=I.name;return I.category&&(U=[...I.category,I.name].join(" > ")),{label:U,value:I.id,description:I.description}})}function L({children:F}){const I=(0,c.of)(B);return(0,t.jsx)("div",{className:I,children:F})}function B(F){return(0,n.css)({borderTop:`1px solid ${F.colors.border.weak}`,padding:`${F.spacing(2)}`,display:"flex"})}},4527:(q,j,e)=>{"use strict";e.d(j,{g5:()=>v,tN:()=>C,Zm:()=>D,Z4:()=>l});var t=e(74848),n=e(2543),r=e(14781),a=e(34128),i=e(22803),x=e(88090),s=e(29675);const c=({libraryPanel:y})=>{const P=(0,s.of)(d),b=y.useState(),S=b.$timeRange?.getTimeZone(),M=b._loadedPanel?.meta;return M?(0,t.jsxs)("div",{className:P.info,children:[(0,t.jsxs)("div",{className:P.libraryPanelInfo,children:[`Used on ${M.connectedDashboards} `,M.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:P.libraryPanelInfo,children:[(0,x.LE)(M.updated,{format:"L",timeZone:S})," by",M.updatedBy.avatarUrl&&(0,t.jsx)("img",{className:P.userAvatar,src:M.updatedBy.avatarUrl,alt:`Avatar for ${M.updatedBy.name}`}),M.updatedBy.name]})]}):null},d=y=>({info:(0,i.css)({lineHeight:1}),libraryPanelInfo:(0,i.css)({color:y.colors.text.secondary,fontSize:y.typography.bodySmall.fontSize}),userAvatar:(0,i.css)({borderRadius:y.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:y.spacing(1),paddingRight:y.spacing(1)})});var u=e(89146),g=e(12422),o=e(12600);const E="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",m="An override rule exists for this property";function f(y,P,b){const S=[];if(b){for(const O of b)for(const R of O.fields)if((0,n.get)(R.config,y.path)!=null){S.push({type:"data",description:E,tooltip:E});break}}return P.overrides.some(O=>O.properties.some(R=>R.id===y.id))&&S.push({type:"rule",description:m,tooltip:m}),S}var p=e(14770);function h({data:y,replaceVariables:P,options:b,eventBus:S,instanceState:M}){const O=y?.series??[];return{data:O,replaceVariables:P,options:b,eventBus:S,getSuggestions:L=>(0,u.Hf)(O,L),instanceState:M}}function D(y){const{plugin:P,panel:b,onPanelOptionsChanged:S,onFieldConfigsChange:M,data:O,dashboard:R,instanceState:L}=y,B=b.getOptions(),F=b.fieldConfig,I={},U=h({data:O,replaceVariables:b.replaceVariables,options:B,eventBus:R.events,instanceState:L}),W=N=>{const K=(N&&N[0])??`${P.meta.name}`,V=I[K];return V||(I[K]=new g.C({title:K,id:K,sandboxId:P.meta.id}))},A={getValue:N=>(0,n.get)(B,N),onChange:(N,K)=>{const V=(0,p.Sf)(B,N,K);S(V)}};v(P.getPanelOptionsSupplier(),A,W,U);for(const N of P.fieldConfigRegistry.list()){if(N.isCustom){if(N.showIf&&!N.showIf(F.defaults.custom,O?.series))continue}else if(N.showIf&&!N.showIf(F.defaults,O?.series))continue;if(N.hideFromDefaults)continue;const K=W(N.category),V=N.editor,T=F.defaults,z=N.isCustom?T.custom?(0,n.get)(T.custom,N.path):void 0:(0,n.get)(T,N.path);N.getItemsCount&&(K.props.itemsCount=N.getItemsCount(z)),K.addItem(new o.v({title:N.name,description:N.description,overrides:f(N,F,O?.series),render:function(){const H=G=>{M((0,p.EQ)(F,N.path,G,N.isCustom))};return(0,t.jsx)(V,{value:z,onChange:H,item:N,context:U,id:N.id})}}))}return Object.values(I)}function C(y){const P=new g.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return P.addItem(new o.v({title:"Name",value:y,popularRank:1,render:function(){return(0,t.jsx)(a.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:y.state.name,onBlur:S=>y.setState({name:S.currentTarget.value})})}})).addItem(new o.v({title:"Information",render:function(){return(0,t.jsx)(c,{libraryPanel:y})}})),P}function l(y){const{plugin:P,panel:b,data:S,eventBus:M,instanceState:O}=y,R={},L=W=>{const A=W?.[0]??P.meta.name,N=R[A];return N||(R[A]=new g.C({title:A,id:A,sandboxId:P.meta.id}))},B=b.state.options,F={getValue:W=>(0,n.get)(B,W),onChange:(W,A)=>{const N=(0,p.Sf)(B,W,A);b.onOptionsChange(N)}},I=h({data:S,replaceVariables:b.interpolate,options:B,eventBus:M,instanceState:O});v(P.getPanelOptionsSupplier(),F,L,I);const U=b.state.fieldConfig;for(const W of P.fieldConfigRegistry.list()){const A=W.showIf&&(W.isCustom?!W.showIf(U.defaults.custom,S?.series):!W.showIf(U.defaults,S?.series));if(W.hideFromDefaults||A)continue;const N=L(W.category),K=W.editor,V=U.defaults,T=W.isCustom?V.custom?(0,n.get)(V.custom,W.path):void 0:(0,n.get)(V,W.path);W.getItemsCount&&(N.props.itemsCount=W.getItemsCount(T)),N.addItem(new o.v({title:W.name,description:W.description,overrides:f(W,U,S?.series),render:function(){const w=H=>{b.onFieldConfigChange((0,p.EQ)(U,W.path,H,W.isCustom),!0)};return(0,t.jsx)(K,{value:T,onChange:w,item:W,context:I,id:W.id})}}))}return Object.values(R)}function v(y,P,b,S,M){const O=new r.pv;y(O,S);for(const R of O.getItems()){if(R.showIf&&!R.showIf(S.options,S.data))continue;let L=M;if(L?R.category?.[0]?.length&&(L=L.getCategory(R.category[0])):L=b(R.category),(0,r.iF)(R)){const F=R.getNestedValueAccess(P),I=F.getContext?F.getContext(S):{...S,options:P.getValue(R.path)};v(R.getBuilder(),F,b,I,L);continue}const B=R.editor;L.addItem(new o.v({title:R.name,description:R.description,render:function(){return(0,t.jsx)(B,{value:P.getValue(R.path),onChange:I=>{P.onChange(R.path,I)},item:R,context:S,id:R.id})}}))}}},36608:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>C,GU:()=>g,MJ:()=>E,Ox:()=>m,eK:()=>p,fR:()=>f,kw:()=>h,wi:()=>s});var t=e(65307),n=e(8392),r=e(55801),a=e(82856),i=e(63845),x=e(75342);const s="grafana.dashboard.editor.ui",c={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:x.q5.Fill},d=()=>{const l=a.A.getObject(s,c);let v={...l};return typeof l.topPaneSize=="string"&&(v={...l,topPaneSize:parseFloat(l.topPaneSize)/100}),{getPanel:()=>new i.a9({}),getSourcePanel:()=>new i.a9({}),getData:()=>({state:n.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...c,...v}}},u=(0,t.Z0)({name:"panelEditor",initialState:d(),reducers:{updateEditorInitState:(l,v)=>{l.getPanel=()=>v.payload.panel,l.getSourcePanel=()=>v.payload.sourcePanel,l.initDone=!0,l.isOpen=!0,l.shouldDiscardChanges=!1},setEditorPanelData:(l,v)=>{l.getData=()=>v.payload},setDiscardChanges:(l,v)=>{l.shouldDiscardChanges=v.payload},setPanelEditorUIState:(l,v)=>{l.ui={...l.ui,...v.payload},!l.ui.isPanelOptionsVisible&&l.isVizPickerOpen&&(l.isVizPickerOpen=!1)},toggleVizPicker:(l,v)=>{l.isVizPickerOpen=v.payload,l.isVizPickerOpen&&(l.ui.isPanelOptionsVisible=!0)},toggleTableView(l){l.tableViewEnabled=!l.tableViewEnabled},closeEditor:l=>{l.getPanel=()=>new i.a9({}),l.getSourcePanel=()=>new i.a9({}),l.isOpen=!1,l.initDone=!1,l.isVizPickerOpen=!1,l.tableViewEnabled=!1}}}),{updateEditorInitState:g,setEditorPanelData:o,setDiscardChanges:E,closeEditor:m,setPanelEditorUIState:f,toggleVizPicker:p,toggleTableView:h}=u.actions,C={panelEditor:u.reducer}},75342:(q,j,e)=>{"use strict";e.d(j,{M8:()=>t,Nt:()=>a,__:()=>x,q5:()=>n});var t=(s=>(s.Query="query",s.Transform="transform",s.Visualize="visualize",s.Alert="alert",s))(t||{}),n=(s=>(s[s.Fill=0]="Fill",s[s.Fit=1]="Fit",s[s.Exact=2]="Exact",s))(n||{}),r=(s=>(s[s.Off=0]="Off",s[s.Table=1]="Table",s))(r||{});const a=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],i=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var x=(s=>(s[s.Visualizations=0]="Visualizations",s[s.LibraryPanels=1]="LibraryPanels",s[s.Suggestions=2]="Suggestions",s))(x||{})},14770:(q,j,e)=>{"use strict";e.d(j,{$:()=>x,A:()=>i,EQ:()=>s,Sf:()=>c});var t=e(2543),n=e.n(t),r=e(40828),a=e(75342);function i(d,u,g,o){if(d===a.q5.Fill)return{width:u,height:g};const E=8*6,p=(window.innerWidth-60-r.dU*4)/r.cV*o.gridPos.w,h=r.sD*o.gridPos.h+E,D=Math.min(u/p,g/h);return p<=u&&h<=g?{width:p,height:h}:{width:p*D,height:h*D}}function x(d){return d?.meta.skipDataQuery===!1}const s=(d,u,g,o)=>{let E={...d.defaults};const m=g==null||g==="";return o?E.custom?m?E.custom=(0,t.omit)(E.custom,u):E.custom=c(E.custom,u,g):m||(E.custom=c(E.custom,u,g)):m?E=(0,t.omit)(E,u):E=c(E,u,g),{...d,defaults:E}};function c(d,u,g){const o=Array.isArray(u)?u:u.split("."),E=o.shift();if(E.endsWith("]")){const f=E.lastIndexOf("["),p=+E.substring(f+1,E.length-1),h=E.substring(0,f);let D=d[h];const C=Array.isArray(D)?[...D]:[];return o.length&&(D=C[p],(D==null||typeof D!="object")&&(D={}),g=c(D,o,g)),C[p]=g,{...d,[h]:C}}if(!o.length)return{...d,[E]:g};let m=d[E];return(m==null||typeof m!="object")&&(m={}),{...d,[E]:c(m,o,g)}}},66732:(q,j,e)=>{"use strict";e.d(j,{G:()=>s,U:()=>c});var t=e(74848),n=e(96540),r=e(61034),a=e(44826),i=e(61491),x=e(58843);const s=({repeat:d,onChange:u,id:g})=>{const o=(0,i.useSelector)(f=>(0,x.SS)((0,x.y7)(f),f)),E=(0,n.useMemo)(()=>{const f=o.map(p=>({label:p.name,value:p.name}));return f.length===0&&f.unshift({label:"No template variables found",value:null}),f.unshift({label:"Disable repeating",value:null}),f},[o]),m=(0,n.useCallback)(f=>u(f.value),[u]);return(0,t.jsx)(a.l6,{inputId:g,value:d,onChange:m,options:E})},c=({sceneContext:d,repeat:u,id:g,onChange:o})=>{const m=(0,n.useMemo)(()=>r.jh.getVariables(d.getRoot()),[d]).useState().variables,f=(0,n.useMemo)(()=>{const h=m.map(D=>({label:D.state.name,value:D.state.name}));return h.length===0&&h.unshift({label:"No template variables found",value:null}),h.unshift({label:"Disable repeating",value:null}),h},[m]),p=(0,n.useCallback)(h=>o(h.value),[o]);return(0,t.jsx)(a.l6,{inputId:g,value:u,onChange:p,options:f})}},43347:(q,j,e)=>{"use strict";e.d(j,{C:()=>s,m:()=>c});var t=e(74848),n=e(58779),r=e(56276),a=e(43908),i=e(54594),x=e(23040);const s=({dashboard:d,onSaveSuccess:u,size:g})=>(0,t.jsx)(a.$s,{children:({showModal:o,hideModal:E})=>(0,t.jsx)(i.$n,{size:g,onClick:()=>{o(x.$,{dashboard:d,onSaveSuccess:u,onDismiss:E})},"aria-label":n.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:"Save dashboard"})}),c=({dashboard:d,onClick:u,onSaveSuccess:g,variant:o,size:E})=>(0,t.jsx)(a.$s,{children:({showModal:m,hideModal:f})=>(0,t.jsx)(i.$n,{size:E,onClick:()=>{(0,r.rR)("grafana_dashboard_save_as_clicked"),u?.(),m(x.$,{dashboard:d,onSaveSuccess:g,onDismiss:f,isCopy:!0})},variant:o,"aria-label":n.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:"Save as"})})},56721:(q,j,e)=>{"use strict";e.d(j,{l:()=>c});var t=e(74848),n=e(16817),r=e(48583),a=e(20968),i=e(90231),x=e(6253),s=e(51738);const c=({diff:d,oldValue:u,newValue:g,hasFolderChanges:o,oldFolder:E,newFolder:m})=>{const f=(0,n.A)(async()=>{const h=JSON.stringify(u??{},null,2),D=JSON.stringify(g??{},null,2);let C;const l=[];let v=0;if(d)for(const[y,P]of Object.entries(d)){const b=(0,t.jsx)(x.D,{diffs:P,title:y},y);y==="schemaVersion"?C=b:l.push(b),v+=P.length}return{schemaChange:C,diffs:l,count:v,showDiffs:v<15,jsonView:(0,t.jsx)(s.M,{oldValue:h,newValue:D})}},[d,u,g]),{value:p}=f;return(0,t.jsxs)(r.B,{direction:"column",gap:1,children:[o&&(0,t.jsx)(x.D,{diffs:[{op:"replace",value:m,originalValue:E,path:[],startLineNumber:0,endLineNumber:0}],title:"folder"},"folder"),(!p||!u)&&(0,t.jsx)(a.y,{}),p&&p.count>=1?(0,t.jsxs)(t.Fragment,{children:[p&&p.schemaChange&&p.schemaChange,p&&p.showDiffs&&p.diffs,(0,t.jsxs)(i.a,{paddingTop:1,children:[(0,t.jsx)("h4",{children:"Full JSON diff"}),p.jsonView]})]}):(0,t.jsx)(i.a,{paddingTop:1,children:"No changes in the dashboard JSON"})]})}},23040:(q,j,e)=>{"use strict";e.d(j,{$:()=>Ge});var t=e(74848),n=e(96540),r=e(28082),a=e(32370),i=e(58528),x=e(10247),s=e(88849),c=e(91354),d=e(22803),u=e(16817),g=e(29675),o=e(37e3),E=e(75911);function m({dashboard:Me}){const De=(0,g.of)(f),{loading:Ke,value:Ie,error:Ne}=(0,u.A)(async()=>{const ve=Me.getSaveModelCloneOld();return E.IB.validateDashboard(ve).catch(ge=>{if(ge.status>=500)throw ge;return ge.data})},[Me]);let ie;if(Ke)ie=(0,t.jsx)(o.F,{severity:"info",title:"Checking dashboard validity"});else if(Ie)Ie.isValid||(ie=(0,t.jsxs)(o.F,{severity:"warning",title:"Dashboard failed schema validation",children:[(0,t.jsx)("p",{children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"}),(0,t.jsx)("div",{className:De.error,children:Ie.message})]}));else{const ve=Ne?.message??"Unknown error";ie=(0,t.jsx)(o.F,{severity:"info",title:"Error checking dashboard validity",children:(0,t.jsx)("p",{className:De.error,children:ve})})}return ie?(0,t.jsx)("div",{className:De.root,children:ie}):null}const f=Me=>({root:(0,d.css)({marginTop:Me.spacing(1)}),error:(0,d.css)({fontFamily:Me.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),p=m;var h=e(56721),D=e(65164),C=e(25356),l=e(54594),v=e(11817),y=e(43347),P=e(2543),b=e(41053),S=e(2567),M=e(56276),O=e(53027),R=e(22492),L=e(17687),B=e(19606),F=e(15664),I=e(61491),U=e(91830),W=e(61976);const A=async(Me,De,Ke,Ie)=>{const Ne=await Ie({dashboard:Me,folderUid:De.folderUid??Ke.meta.folderUid??Me.meta?.folderUid,message:De.message,overwrite:De.overwrite,k8s:Ke.meta.k8s});if("error"in Ne)throw Ne.error;return Ne.data},N=(Me=!1)=>{const De=(0,I.useDispatch)(),Ke=(0,L._2)(),[Ie]=(0,F.e8)(),[Ne,ie]=(0,b.A)(async(ve,fe,ge)=>{try{const xe=await A(ve,fe,ge,Ie);ge.version=xe.version,ve=(0,P.cloneDeep)(ve),ve.version=xe.version,ge.clearUnsavedChanges(ve,fe),R.A.publish(new U.Eu),Ke.success("Dashboard saved"),(0,W.ko)(xe.uid),Me?(0,M.rR)("grafana_dashboard_copied",{name:ge.title,url:xe.url}):(0,M.rR)(`grafana_dashboard_${ge.id?"saved":"created"}`,{name:ge.title,url:xe.url});const je=O.Ny.getLocation().pathname,Ve=S.I.stripBaseFromUrl(xe.url);return Ve!==je&&xe.url&&setTimeout(()=>O.Ny.replace(Ve)),ge.meta.isStarred&&De((0,B.TU)({id:ge.uid,title:ge.title,url:Ve})),xe}catch(xe){throw xe instanceof Error&&Ke.error(xe.message??"Error saving dashboard"),xe}},[De,Ke]);return{state:Ne,onDashboardSave:ie}},K=({dashboard:Me,dashboardSaveModel:De,error:Ke,onDismiss:Ie,setErrorIsHandled:Ne})=>{const{onDashboardSave:ie}=N(),ve=a.$.featureToggles.dashboardRestore;return(0,t.jsxs)(t.Fragment,{children:[Ke.data&&Ke.data.status==="version-mismatch"&&(0,t.jsx)(D.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["Someone else has updated this dashboard ",(0,t.jsx)("br",{})," ",(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await ie(De,{overwrite:!0},Me),Ie()},onDismiss:Ie}),Ke.data&&Ke.data.status==="name-exists"&&(0,t.jsx)(t.Fragment,{children:ve?(0,t.jsxs)(C.a,{isOpen:!0,title:(0,v.t)("save-dashboards.name-exists.title","Dashboard name already exists"),onDismiss:Ie,children:[(0,t.jsx)("p",{children:(0,t.jsx)(v.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,t.jsx)("p",{children:(0,t.jsx)(v.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,t.jsx)(D.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["A dashboard with the same name in selected folder already exists. ",(0,t.jsx)("br",{}),(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await ie(De,{overwrite:!0},Me),Ie()},onDismiss:Ie})}),Ke.data&&Ke.data.status==="plugin-dashboard"&&(0,t.jsx)(V,{dashboard:Me,onDismiss:()=>{Ne(!0),Ie()}})]})},V=({onDismiss:Me,dashboard:De})=>{const{onDashboardSave:Ke}=N(),Ie=(0,g.of)(z);return(0,t.jsxs)(C.a,{className:Ie.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:Me,children:[(0,t.jsxs)("div",{className:Ie.modalText,children:["Your changes will be lost when you update the plugin.",(0,t.jsx)("br",{}),(0,t.jsxs)("small",{children:["Use ",(0,t.jsx)("strong",{children:"Save As"})," to create custom version."]})]}),(0,t.jsxs)(C.a.ButtonRow,{children:[(0,t.jsx)(l.$n,{variant:"secondary",onClick:Me,fill:"outline",children:"Cancel"}),(0,t.jsx)(y.m,{onClick:Me,dashboard:De,onSaveSuccess:Me}),(0,t.jsx)(l.$n,{variant:"destructive",onClick:async()=>{await Ke(De.getSaveModelClone(),{overwrite:!0},De),Me()},children:"Overwrite"})]})]})},T=Me=>{switch(Me){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},z=Me=>({modal:(0,d.css)({width:"500px"}),modalText:(0,d.css)({fontSize:Me.typography.h4.fontSize,color:Me.colors.text.primary,marginBottom:Me.spacing(4),paddingTop:Me.spacing(2)}),modalButtonRow:(0,d.css)({marginBottom:"14px","a, button":{marginRight:Me.spacing(2)}})});var w=e(80619),H=e(23302),G=e(86489),X=e(48583),k=e(40271),_=e(34128),ee=e(50926),J=e(29010),Z=e(62851),te=e(3142),ae=e(87156),re=e(36180);const ne=Me=>{const De=Me.getSaveModelClone();return De.id=null,De.uid="",De.title+=" Copy",De.editable=!0,Me.id>0&&De.panels&&De.panels.forEach(Ke=>{Ke.type==="graph"&&Ke.alert&&delete Ke.thresholds,delete Ke.alert}),De},ce=({dashboard:Me,isLoading:De,isNew:Ke,onSubmit:Ie,onCancel:Ne,onSuccess:ie})=>{const ve={title:Ke?Me.title:`${Me.title} Copy`,description:Me.description,$folder:{uid:Me.meta.folderUid,title:Me.meta.folderTitle},copyTags:!1},fe=ge=>async xe=>{if(xe&&xe===ge().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await te.P.validateNewDashboardName(ge().$folder.uid??"general",xe),!0}catch(je){return je instanceof Error?je.message:"Dashboard name is invalid"}};return(0,t.jsx)(w.l,{defaultValues:ve,onSubmit:async ge=>{if(!Ie)return;const xe=ne(Me);xe.title=ge.title,xe.description=ge.description,!Ke&&!ge.copyTags&&(xe.tags=[]),(await Ie(xe,{folderUid:ge.$folder.uid},Me)).status==="success"&&ie()},children:({register:ge,control:xe,errors:je,getValues:Ve})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.e,{render:({field:{ref:ke,...Oe}})=>(0,t.jsx)(G.D,{label:(0,t.jsxs)(X.B,{justifyContent:"space-between",children:[(0,t.jsx)(k.J,{htmlFor:"title",children:"Title"}),a.$.featureToggles.dashgpt&&Ke&&(0,t.jsx)(re.Z,{onGenerate:nt=>Oe.onChange(nt)})]}),invalid:!!je.title,error:je.title?.message,children:(0,t.jsx)(_.p,{...Oe,onChange:nt=>Oe.onChange(nt.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})}),control:xe,name:"title",rules:{validate:fe(Ve)}}),(0,t.jsx)(H.e,{render:({field:{ref:ke,...Oe}})=>(0,t.jsx)(G.D,{label:(0,t.jsxs)(X.B,{justifyContent:"space-between",children:[(0,t.jsx)(k.J,{htmlFor:"description",children:"Description"}),a.$.featureToggles.dashgpt&&Ke&&(0,t.jsx)(ae.V,{onGenerate:nt=>Oe.onChange(nt)})]}),invalid:!!je.description,error:je.description?.message,children:(0,t.jsx)(ee.f,{...Oe,onChange:nt=>Oe.onChange(nt.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})}),control:xe,name:"description"}),(0,t.jsx)(G.D,{label:"Folder",children:(0,t.jsx)(H.e,{render:({field:{ref:ke,...Oe}})=>(0,t.jsx)(Z.d,{...Oe,onChange:(nt,Je)=>Oe.onChange({uid:nt,title:Je}),value:Oe.value?.uid,initialTitle:Me.meta.folderTitle,dashboardId:Me.id,enableCreateNew:!0}),control:xe,name:"$folder"})}),!Ke&&(0,t.jsx)(G.D,{label:"Copy tags",children:(0,t.jsx)(J.d,{...ge("copyTags")})}),(0,t.jsxs)(X.B,{children:[(0,t.jsx)(l.$n,{type:"button",variant:"secondary",onClick:Ne,fill:"outline",children:"Cancel"}),(0,t.jsx)(l.$n,{disabled:De,type:"submit","aria-label":"Save dashboard button",children:De?"Saving...":"Save"})]})]})})};var le=e(58779),he=e(81942),oe=e(57413),de=e(34619),me=e(52723);const Pe=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),Ee=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),be=({dashboard:Me,onGenerate:De,disabled:Ke})=>{const Ie=(0,n.useCallback)(()=>Se(Me),[Me]);return(0,t.jsx)(oe.n,{messages:Ie,onGenerate:De,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:de.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:Ke})};function Se(Me){let{userChanges:De,migrationChanges:Ke}=(0,me.Yy)(Me);return De.length>8e3&&(De="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),Ke.split(`
`).length<10?Ke="No significant migration changes":Ke.length>8e3&&(Ke="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:Pe,role:me.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${De}`,role:me.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:me.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${Ke}`,role:me.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:me.Xh.system},{content:Ee,role:me.Xh.system}]}const Xe=({dashboard:Me,isLoading:De,saveModel:Ke,options:Ie,onSubmit:Ne,onCancel:ie,onSuccess:ve,onOptionsChange:fe})=>{const ge=(0,n.useMemo)(()=>Me.hasTimeChanged(),[Me]),xe=(0,n.useMemo)(()=>Me.hasVariablesChanged(),[Me]),[je,Ve]=(0,n.useState)(!1),[ke,Oe]=(0,n.useState)(Ie.message),nt=(0,g.of)(Qe);return(0,t.jsx)("form",{onSubmit:async Je=>{if(Je.preventDefault(),!Ne)return;Ve(!0),Ie={...Ie,message:ke},(await Ne(Ke.clone,Ie,Me)).status==="success"?ve():Ve(!1)},style:{maxWidth:600},children:(0,t.jsxs)(X.B,{gap:2,direction:"column",alignItems:"flex-start",children:[ge&&(0,t.jsx)(he.S,{checked:!!Ie.saveTimerange,onChange:()=>fe({...Ie,saveTimerange:!Ie.saveTimerange}),label:"Save current time range as dashboard default","aria-label":le.Tp.pages.SaveDashboardModal.saveTimerange}),xe&&(0,t.jsx)(he.S,{checked:!!Ie.saveVariables,onChange:()=>fe({...Ie,saveVariables:!Ie.saveVariables}),label:"Save current variable values as dashboard default","aria-label":le.Tp.pages.SaveDashboardModal.saveVariables}),(0,t.jsxs)("div",{className:nt.message,children:[a.$.featureToggles.aiGeneratedDashboardChanges&&(0,t.jsx)(be,{dashboard:Me,onGenerate:Je=>{fe({...Ie,message:Je}),Oe(Je)},disabled:!Ke.hasChanges}),(0,t.jsx)(ee.f,{"aria-label":"message",value:ke,onChange:Je=>{fe({...Ie,message:Je.currentTarget.value}),Oe(Je.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})]}),(0,t.jsxs)(X.B,{alignItems:"center",children:[(0,t.jsx)(l.$n,{variant:"secondary",onClick:ie,fill:"outline",children:"Cancel"}),(0,t.jsx)(l.$n,{type:"submit",disabled:!Ke.hasChanges||De,icon:je?"spinner":void 0,"aria-label":le.Tp.pages.SaveDashboardModal.save,children:De?"Saving...":"Save"}),!Ke.hasChanges&&(0,t.jsx)("div",{children:"No changes to save"})]})]})})};function Qe(Me){return{message:(0,d.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var we=e(4213),$e=e(19550),Fe=e(93604);const Te=({dashboard:Me,onCancel:De})=>{const[Ke,Ie]=(0,n.useState)(()=>{const ie=Me.getSaveModelClone();return delete ie.id,JSON.stringify(ie,null,2)}),Ne=(0,n.useCallback)(()=>{const ie=new Blob([Ke],{type:"application/json;charset=utf-8"});(0,we.saveAs)(ie,Me.title+"-"+new Date().getTime()+".json")},[Me.title,Ke]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(X.B,{direction:"column",gap:2,children:[(0,t.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,t.jsx)("br",{}),(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{})," ",(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"File path: "})," ",Me.meta.provisionedExternalId]}),(0,t.jsx)(ee.f,{spellCheck:!1,value:Ke,onChange:ie=>{Ie(ie.currentTarget.value)},className:Le.json}),(0,t.jsxs)($e.Gy,{children:[(0,t.jsx)(l.$n,{variant:"secondary",onClick:De,fill:"outline",children:"Cancel"}),(0,t.jsx)(Fe.b,{icon:"copy",getText:()=>Ke,children:"Copy JSON to clipboard"}),(0,t.jsx)(l.$n,{type:"submit",onClick:Ne,children:"Save JSON to file"})]})]})})},Le={json:(0,d.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},Ge=({dashboard:Me,onDismiss:De,onSaveSuccess:Ke,isCopy:Ie})=>{const[Ne,ie]=(0,n.useState)({}),ve=Me.getOriginalDashboard(),fe=Me.meta.provisioned,ge=Me.version===0,xe=!!Me.meta.hasUnsavedFolderChange,[je,Ve]=(0,n.useState)(!1),ke=(0,n.useMemo)(()=>{const at=Me.getSaveModelClone({saveTimerange:!!Ne.saveTimerange,saveVariables:!!Ne.saveVariables});if(!ve)return{clone:at,diff:{},diffCount:0,hasChanges:!1};const yt=(0,c.G4)(ve,at);let ze=0;for(const st of Object.values(yt))ze+=st.length;return{clone:at,diff:yt,diffCount:ze,hasChanges:(ze>0||xe)&&!ge}},[Me,ve,Ne,ge,xe]),[Oe,nt]=(0,n.useState)(!1),{state:Je,onDashboardSave:Be}=N(Ie),Ze=Ke?()=>{De(),Ke()}:De,tt=()=>Oe?(0,t.jsx)(h.l,{diff:ke.diff,oldValue:ve,newValue:ke.clone}):ge||Ie?(0,t.jsx)(ce,{dashboard:Me,isLoading:Je.loading,onCancel:De,onSuccess:Ze,onSubmit:Be,isNew:ge}):fe?(0,t.jsx)(Te,{dashboard:Me,onCancel:De,onSuccess:Ze}):(0,t.jsx)(Xe,{dashboard:Me,isLoading:Je.loading,saveModel:ke,onCancel:De,onSuccess:Ze,onSubmit:Be,options:Ne,onOptionsChange:ie});if(Je.error&&!je&&(0,r.NF)(Je.error)&&T(Je.error.data.status))return(0,t.jsx)(K,{error:Je.error,dashboard:Me,dashboardSaveModel:ke.clone,onDismiss:De,setErrorIsHandled:Ve});let Re="Save dashboard";return Ie?Re="Save dashboard copy":fe&&(Re="Provisioned dashboard"),(0,t.jsxs)(i._,{title:Re,onClose:De,subtitle:Me.title,tabs:(0,t.jsxs)(x.U,{children:[(0,t.jsx)(s.o,{label:"Details",active:!Oe,onChangeTab:()=>nt(!1)}),ke.hasChanges&&(0,t.jsx)(s.o,{label:"Changes",active:Oe,onChangeTab:()=>nt(!0),counter:ke.diffCount})]}),children:[tt(),a.$.featureToggles.showDashboardValidationWarnings&&(0,t.jsx)(p,{dashboard:Me})]})}},19346:(q,j,e)=>{"use strict";e.d(j,{D:()=>p});var t=e(74848),n=e(96540),r=e(32370),a=e(93604),i=e(86489),x=e(48583),s=e(29010),c=e(40271),d=e(50926),u=e(54594),g=e(25356),o=e(11817),E=e(83424),m=e(43317),f=e(25309);function p({panel:h,dashboard:D,range:C,onCancelClick:l,buildIframe:v=f.CF}){const[y,P]=(0,n.useState)(!0),[b,S]=(0,n.useState)("current"),[M,O]=(0,n.useState)("");(0,n.useEffect)(()=>{const I=v(y,D.uid,b,h,C);O(I)},[b,y,D,h,C,v]);const R=I=>{O(I.currentTarget.value)},L=()=>{P(I=>!I)},B=I=>{S(I)},F=(0,t.jsx)(a.b,{icon:"copy",variant:"primary",getText:()=>M,onClipboardCopy:()=>{E.c.embedSnippetCopy({currentTimeRange:y,theme:b,shareResource:(0,f.hD)(h)})},children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel"})}),(0,t.jsx)(i.D,{children:(0,t.jsxs)(x.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(s.d,{label:(0,o.t)("share-modal.embed.time-range","Lock time range"),id:"share-current-time-range",value:y,onChange:L}),(0,t.jsx)(c.J,{description:(0,o.t)("embed.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(o.x6,{i18nKey:"embed.share.time-range-label",children:"Lock time range"})})]})}),(0,t.jsx)(m.w,{selectedTheme:b,onChange:B}),(0,t.jsx)(i.D,{label:(0,o.t)("share-modal.embed.html","Embed HTML"),description:(0,o.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the users viewing that page need to be signed into Grafana for the graph to load."),children:(0,t.jsx)(d.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:M,onChange:R})}),r.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(x.B,{gap:1,justifyContent:"start",children:[F,(0,t.jsx)(u.$n,{variant:"secondary",fill:"outline",onClick:l,children:(0,t.jsx)(o.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})})]}):(0,t.jsx)(g.a.ButtonRow,{children:F})]})}},38644:(q,j,e)=>{"use strict";e.d(j,{j:()=>s});var t=e(74848),n=e(96540),r=e(56276),a=e(11817),i=e(34741),x=e(25309);const s=({panel:c,initialFolderUid:d,onCreateLibraryPanel:u,onDismiss:g})=>((0,n.useEffect)(()=>{(0,r.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,x.hD)(c)})},[c]),c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(a.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,t.jsx)(i.b,{panel:c,initialFolderUid:d,onCreateLibraryPanel:u,onDismiss:g})]}):null)},96464:(q,j,e)=>{"use strict";e.d(j,{Zy:()=>re});var t=e(74848),n=e(96540),r=e(37443),a=e(25356),i=e(11238),x=e(29675),s=e(88023),c=e(87638),d=e(11817),u=e(2175),g=e(71488),o=e(83424),E=e(54506),m=e(61491),f=e(19346),p=e(4213),h=e(86489),D=e(29010),C=e(54594),l=e(86872),v=e(91830),y=e(70713),P=e(3886),b=e(93604);function S({json:ne,onDismiss:ce}){const le=(0,n.useCallback)(()=>ne,[ne]);return(0,t.jsxs)(a.a,{title:"JSON",onDismiss:ce,onClickBackdrop:ce,isOpen:!0,children:[(0,t.jsx)(y.default,{disableHeight:!0,children:({width:he})=>(0,t.jsx)(P.B,{value:ne,language:"json",showMiniMap:!1,height:"500px",width:he})}),(0,t.jsx)(a.a.ButtonRow,{children:(0,t.jsx)(b.b,{icon:"copy",getText:le,onClipboardCopy:()=>{o.c.exportCopyJsonClicked()},children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var M=e(25309);class O extends n.PureComponent{constructor(ce){super(ce),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:le}=this.props,{shareExternally:he}=this.state;o.c.exportSaveJsonClicked({externally:he,shareResource:(0,M.hD)(this.props.panel)}),he?this.exporter.makeExportable(le).then(oe=>{this.openSaveAsDialog(oe)}):this.openSaveAsDialog(le.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:le}=this.props,{shareExternally:he}=this.state;o.c.exportViewJsonClicked({externally:he,shareResource:(0,M.hD)(this.props.panel)}),he?this.exporter.makeExportable(le).then(oe=>{this.openJsonModal(oe)}):this.openJsonModal(le.getSaveModelClone())},this.openSaveAsDialog=le=>{const he=JSON.stringify(le,null,2),oe=new Blob([he],{type:"application/json;charset=utf-8"}),de=new Date().getTime();(0,p.saveAs)(oe,`${le.title}-${de}.json`)},this.openJsonModal=le=>{c.lE.publish(new v.S8({props:{json:JSON.stringify(le,null,2)},component:S})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new l.M}render(){const{onDismiss:ce}=this.props,{shareExternally:le}=this.state,he=(0,d.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(h.D,{label:he,children:(0,t.jsx)(D.d,{id:"share-externally-toggle",value:le,onChange:this.onShareExternallyChange})}),(0,t.jsxs)(a.a.ButtonRow,{children:[(0,t.jsx)(C.$n,{variant:"secondary",onClick:ce,fill:"outline",children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(C.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(C.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var R=e(38644),L=e(58779),B=e(44617),F=e(34128),I=e(54731),U=e(37e3),W=e(43317);class A extends n.PureComponent{constructor(ce){super(ce),this.buildUrl=async()=>{const{panel:le,dashboard:he}=this.props,{useCurrentTimeRange:oe,useShortUrl:de,selectedTheme:me}=this.state,Pe=await(0,M.Xe)(oe,me,le,de),Ee=(0,M.Lb)(oe,he.uid,me,le);this.setState({shareUrl:Pe,imageUrl:Ee})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=le=>{this.setState({selectedTheme:le})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{o.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,M.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(ce,le){const{useCurrentTimeRange:he,useShortUrl:oe,selectedTheme:de}=this.state;(le.useCurrentTimeRange!==he||le.selectedTheme!==de||le.useShortUrl!==oe)&&this.buildUrl()}render(){const{panel:ce,dashboard:le}=this.props,he=le?le.time.to==="now":!1,{useCurrentTimeRange:oe,useShortUrl:de,selectedTheme:me,shareUrl:Pe,imageUrl:Ee}=this.state,be=L.Tp.pages.SharePanelModal,Se=!!le.id,Xe=(0,d.t)("share-modal.link.time-range-label","Lock time range"),Qe=(0,d.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),we=(0,d.t)("share-modal.link.shorten-url","Shorten URL"),$e=(0,d.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(B.n,{children:[(0,t.jsx)(h.D,{label:Xe,description:he?Qe:"",children:(0,t.jsx)(D.d,{id:"share-current-time-range",value:oe,onChange:this.onUseCurrentTimeRangeChange})}),(0,t.jsx)(W.w,{selectedTheme:me,onChange:this.onThemeChange}),(0,t.jsx)(h.D,{label:we,children:(0,t.jsx)(D.d,{id:"share-shorten-url",value:de,onChange:this.onUrlShorten})}),(0,t.jsx)(h.D,{label:$e,children:(0,t.jsx)(F.p,{id:"link-url-input",value:Pe,readOnly:!0,addonAfter:(0,t.jsx)(b.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),ce&&s.Ay.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[Se&&(0,t.jsx)(I.Y,{href:Ee,external:!0,icon:"camera","aria-label":be.linkToRenderedImage,children:(0,d.t)("share-modal.link.rendered-image","Direct link rendered image")}),!Se&&(0,t.jsx)(U.F,{severity:"info",title:(0,d.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),ce&&!s.Ay.rendererAvailable&&(0,t.jsx)(U.F,{severity:"info",title:(0,d.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(d.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)(I.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var N=e(34923),K=e(14964),V=e(28082),T=e(44826),z=e(48583),w=e(20968),H=e(80757),G=e(77274);class X extends n.PureComponent{constructor(ce){super(ce),this.createSnapshot=le=>()=>{const{timeoutSeconds:he}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,le)},he*1e3)},this.saveSnapshot=async(le,he)=>{const{snapshotExpires:oe,timeoutSeconds:de}=this.state,me=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(me);const Pe={dashboard:me,name:me.title,expires:oe,external:he};try{const Ee=await(0,G.s)().create(Pe);this.setState({deleteUrl:Ee.deleteUrl,snapshotUrl:Ee.url,step:2})}finally{he?o.c.publishSnapshotClicked({expires:oe,timeout:de,shareResource:(0,M.hD)(this.props.panel)}):o.c.publishSnapshotLocalClicked({expires:oe,timeout:de,shareResource:(0,M.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=le=>{const{panel:he}=this.props,{snapshotName:oe}=this.state;le.title=oe,le.time=(0,H.jG)().timeRange(),le.links=[],le.panels.forEach(me=>{me.targets=[],me.links=[],me.datasource=null});const de=le.annotations.list.filter(me=>me.enable);if(le.annotations.list=de.map(me=>({name:me.name,enable:me.enable,iconColor:me.iconColor,snapshotData:me.snapshotData,type:me.type,builtIn:me.builtIn,hide:me.hide})),le.getVariables().forEach(me=>{"query"in me&&(me.query=""),"options"in me&&(me.options=me.current&&!(0,N.R)(me.current)?[me.current]:[]),"refresh"in me&&(me.refresh=K.CO.never)}),he){const me=he.getSaveModel();me.gridPos.w=24,me.gridPos.x=0,me.gridPos.y=0,me.gridPos.h=20,le.panels=[me]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(me=>{delete me.snapshotData}),this.dashboard.annotations.list.forEach(me=>{delete me.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:le}=this.state;await(0,V.AI)().get(le),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=le=>{this.setState({snapshotName:le.target.value})},this.onTimeoutChange=le=>{this.setState({timeoutSeconds:Number(le.target.value)})},this.onExpireChange=le=>{this.setState({selectedExpireOption:le,snapshotExpires:le.value})},this.dashboard=ce.dashboard,this.expireOptions=[{label:(0,d.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,d.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,d.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,d.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:ce.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const ce=await(0,G.s)().getSharingOptions();this.setState({sharingButtonText:ce.externalSnapshotName,externalEnabled:ce.externalEnabled})}renderStep1(){const{onDismiss:ce}=this.props,{snapshotName:le,selectedExpireOption:he,timeoutSeconds:oe,isLoading:de,sharingButtonText:me,externalEnabled:Pe}=this.state,Ee=(0,d.t)("share-modal.snapshot.name","Snapshot name"),be=(0,d.t)("share-modal.snapshot.expire","Expire"),Se=(0,d.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Xe=(0,d.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{children:(0,t.jsxs)(d.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(h.D,{label:Ee,children:(0,t.jsx)(F.p,{id:"snapshot-name-input",width:30,value:le,onChange:this.onSnapshotNameChange})}),(0,t.jsx)(h.D,{label:be,children:(0,t.jsx)(T.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:he,onChange:this.onExpireChange})}),(0,t.jsx)(h.D,{label:Se,description:Xe,children:(0,t.jsx)(F.p,{id:"timeout-input",type:"number",width:21,value:oe,onChange:this.onTimeoutChange})}),(0,t.jsxs)(a.a.ButtonRow,{children:[(0,t.jsx)(C.$n,{variant:"secondary",onClick:ce,fill:"outline",children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),Pe&&(0,t.jsx)(C.$n,{variant:"secondary",disabled:de,onClick:this.createSnapshot(!0),children:me}),(0,t.jsx)(C.$n,{variant:"primary",disabled:de,onClick:this.createSnapshot(),children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:ce}=this.state;return(0,t.jsxs)(z.B,{direction:"column",gap:0,children:[(0,t.jsx)(h.D,{label:(0,d.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(F.p,{id:"snapshot-url-input",value:ce,readOnly:!0,addonAfter:(0,t.jsx)(b.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(C.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})}render(){const{isLoading:ce,step:le}=this.state;return(0,t.jsxs)(t.Fragment,{children:[le===1&&this.renderStep1(),le===2&&this.renderStep2(),le===3&&this.renderStep3(),ce&&(0,t.jsx)(w.y,{inline:!0})]})}}const k=[],_=[];function ee(ne){k.push(ne)}function J(ne){_.push(ne)}function Z(ne,ce,le){const oe=[{label:(0,d.t)("share-modal.tab-title.link","Link"),value:M.wr.link,component:A}];if(c.TP.isSignedIn&&s.$W.snapshotEnabled&&c.TP.hasPermission(m.AccessControlAction.SnapshotsCreate)){const me=(0,d.t)("share-modal.tab-title.snapshot","Snapshot");oe.push({label:me,value:M.wr.snapshot,component:X})}if(ce){const me=(0,d.t)("share-modal.tab-title.embed","Embed");if(oe.push({label:me,value:M.wr.embed,component:f.D}),!(0,E.X)(ce)){const Pe=(0,d.t)("share-modal.tab-title.library-panel","Library panel");oe.push({label:Pe,value:M.wr.libraryPanel,component:R.j})}oe.push(..._)}else{const me=(0,d.t)("share-modal.tab-title.export","Export");oe.push({label:me,value:M.wr.export,component:O}),oe.push(...k),(0,g.iR)()&&oe.push({label:(0,d.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:M.wr.publicDashboard,component:u.b})}const de=oe.find(me=>me.value===le);return{tabs:oe,activeTab:de?.value??oe[0].value}}function te(ne){const{tabs:ce,activeTab:le}=Z(ne.dashboard.canEditDashboard(),ne.panel,ne.activeTab);return{tabs:ce,activeTab:le}}class ae extends n.Component{constructor(ce){super(ce),this.onSelectTab=le=>{this.setState(he=>({...he,activeTab:le.value})),o.c.sharingCategoryClicked({item:le.value,shareResource:(0,M.hD)(this.props.panel)})},this.state=te(ce)}getActiveTab(){const{tabs:ce,activeTab:le}=this.state;return ce.find(he=>he.value===le)}renderTitle(){const{panel:ce}=this.props,{activeTab:le}=this.state,he=ce?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share"),oe=this.props.dashboard.canEditDashboard(),de=Z(oe,this.props.panel,this.state.activeTab).tabs;return(0,t.jsx)(r.J,{title:he,icon:"share-alt",tabs:de,activeTab:le,onChangeTab:this.onSelectTab})}render(){const{dashboard:ce,panel:le}=this.props,oe=this.getActiveTab().component;return(0,t.jsx)(a.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,t.jsx)(i.J,{children:(0,t.jsx)(oe,{dashboard:ce,panel:le,onDismiss:this.props.onDismiss})})})}}const re=(0,x.cV)(ae)},74031:(q,j,e)=>{"use strict";e.d(j,{K:()=>le,b:()=>ce});var t=e(74848),n=e(22803),r=e(49785),a=e(58779),i=e(29675),x=e(86489),s=e(34128),c=e(93604),d=e(29010),u=e(40271),g=e(19550),o=e(54594),E=e(43908),m=e(11817),f=e(65728),p=e(77818),h=e(83424),D=e(33593),C=e(61351),l=e(61491),v=e(52908);const y=()=>{const{width:oe}=(0,v.A)();return oe>1024};var P=e(96464),b=e(25309),S=e(75386),M=e(37e3);const O=()=>(0,t.jsx)(M.F,{title:(0,m.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var R=e(25763),L=e(48174),B=e(71488),F=e(44617),I=e(7224);const U=a.Tp.pages.ShareDashboardModal.PublicDashboard,W=({disabled:oe,onChange:de,register:me,timeRange:Pe})=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(F.n,{disabled:oe,children:(0,t.jsxs)(g.gW,{spacing:"md",children:[(0,t.jsxs)(g.PE,{orientation:1,spacing:"xs",justify:"space-between",children:[(0,t.jsx)(u.J,{description:(0,m.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,t.jsx)(I.b,{value:Pe,disabled:!0,onChange:()=>{}})]}),(0,t.jsxs)(g.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(d.d,{...me("isTimeSelectionEnabled"),"data-testid":U.EnableTimeRangeSwitch,onChange:Ee=>{de("isTimeSelectionEnabled",Ee.currentTarget.checked),h.c.publicDashboardTimeSelectionChanged({enabled:Ee.currentTarget.checked})}}),(0,t.jsx)(u.J,{description:(0,m.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,t.jsxs)(g.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(d.d,{...me("isAnnotationsEnabled"),onChange:Ee=>{de("isAnnotationsEnabled",Ee.currentTarget.checked),h.c.publicDashboardAnnotationsSelectionChanged({enabled:Ee.currentTarget.checked})},"data-testid":U.EnableAnnotationsSwitch}),(0,t.jsx)(u.J,{description:(0,m.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var A=e(90333),N=e(60641),K=e(20968),V=e(11997);const T=a.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,z=({recipients:oe,dashboardUid:de,publicDashboardUid:me})=>{const Pe=(0,i.of)(H),[Ee,{isLoading:be}]=(0,f.$L)(),[Se,{isLoading:Xe}]=(0,f.NA)(),Qe=be||Xe,we=(Fe,Te)=>{h.c.revokePublicDashboardEmailClicked(),Ee({recipientUid:Fe,recipientEmail:Te,dashboardUid:de,uid:me})},$e=Fe=>{h.c.resendPublicDashboardEmailClicked(),Se({recipientUid:Fe,uid:me})};return(0,t.jsx)("table",{className:Pe.table,"data-testid":T.EmailSharingList,children:(0,t.jsx)("tbody",{children:oe.map((Fe,Te)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:Fe.recipient}),(0,t.jsx)("td",{children:(0,t.jsxs)(A.e,{className:Pe.tableButtonsContainer,children:[(0,t.jsx)(o.$n,{type:"button",variant:"destructive",fill:"text",title:(0,m.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Qe,onClick:()=>we(Fe.uid,Fe.recipient),"data-testid":`${T.DeleteEmail}-${Te}`,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,t.jsx)(o.$n,{type:"button",variant:"primary",fill:"text",title:(0,m.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Qe,onClick:()=>$e(Fe.uid),"data-testid":`${T.ReshareLink}-${Te}`,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},Fe.uid))})})},w=({dashboard:oe})=>{const{width:de}=(0,v.A)(),me=(0,i.of)(H),Pe=oe instanceof V.H$?oe.state.uid:oe.uid,{data:Ee}=(0,f.Bs)(Pe),[be]=(0,f.ft)(),[Se,{isLoading:Xe}]=(0,f.NY)(),Qe=C.TP.hasPermission(l.AccessControlAction.DashboardsPublicWrite),{register:we,setValue:$e,control:Fe,watch:Te,handleSubmit:Le,formState:{errors:Ge},reset:Me}=(0,r.mN)({defaultValues:{shareType:Ee?.share||B.Xo.PUBLIC,email:""},mode:"onSubmit"}),De=Ie=>{const Ne={dashboard:oe,payload:{...Ee,share:Ie}};be(Ne)},Ke=async Ie=>{h.c.publicDashboardEmailInviteClicked(),await Se({recipient:Ie.email,uid:Ee.uid,dashboardUid:Pe}).unwrap(),Me({email:"",shareType:B.Xo.EMAIL})};return(0,t.jsx)("form",{onSubmit:Le(Ke),children:(0,t.jsxs)(F.n,{disabled:!Qe,"data-testid":T.Container,className:me.container,children:[(0,t.jsx)(x.D,{label:(0,m.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:me.field,children:(0,t.jsx)(r.xI,{name:"shareType",control:Fe,render:({field:Ie})=>{const{ref:Ne,...ie}=Ie,ve=[{label:(0,m.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:B.Xo.PUBLIC},{label:(0,m.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:B.Xo.EMAIL}];return(0,t.jsx)(N.z,{...ie,size:de<480?"sm":"md",options:ve,onChange:fe=>{h.c.publicDashboardShareTypeChange({shareType:fe===B.Xo.EMAIL?"email":"public"}),$e("shareType",fe),De(fe)}})}})}),Te("shareType")===B.Xo.EMAIL&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.D,{label:(0,m.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,m.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:Ge.email?.message,invalid:!!Ge.email?.message||void 0,className:me.field,children:(0,t.jsxs)("div",{className:me.emailContainer,children:[(0,t.jsx)(s.p,{className:me.emailInput,placeholder:"email",autoCapitalize:"none",...we("email",{required:(0,m.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:B._l,message:(0,m.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":T.EmailSharingInput}),(0,t.jsxs)(o.$n,{type:"submit",variant:"primary",disabled:Xe,"data-testid":T.EmailSharingInviteButton,children:[(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),Xe&&(0,t.jsx)(K.y,{})]})]})}),!!Ee?.recipients?.length&&(0,t.jsx)(z,{recipients:Ee.recipients,dashboardUid:Pe,publicDashboardUid:Ee.uid})]})]})})},H=oe=>({container:(0,n.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:oe.spacing(3)}),field:(0,n.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,n.css)({label:"emailContainer",display:"flex",gap:oe.spacing(1)}),emailInput:(0,n.css)({label:"emailInput",flexGrow:1}),table:(0,n.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:oe.spacing(.5,1),":nth-child(odd)":{background:oe.colors.background.secondary}}}),tableButtonsContainer:(0,n.css)({display:"flex",justifyContent:"end"})});var G=e(96540),X=e(98842),k=e(99764);function _({headerElement:oe,isContentVisible:de=!1,onRowToggle:me,title:Pe,...Ee}){const be=(0,i.of)(ee),Se=oe&&X.renderOrCallToRender(oe,{className:be.summaryWrapper});return(0,t.jsx)("div",{className:be.wrapper,children:(0,t.jsxs)("div",{className:be.header,children:[(0,t.jsx)(k.K,{name:de?"angle-down":"angle-right",tooltip:de?(0,m.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,m.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:be.collapseIcon,onClick:me,"aria-expanded":de,...Ee}),Pe&&(0,t.jsx)("div",{className:be.titleWrapper,onClick:me,children:(0,t.jsx)("span",{className:be.title,children:Pe})}),Se]})})}_.displayName="SettingsBarHeader";function ee(oe){return{wrapper:(0,n.css)({label:"header",padding:oe.spacing(.5,.5),borderRadius:oe.shape.radius.default,background:oe.colors.background.secondary,minHeight:oe.spacing(4),"&:focus":{outline:"none"}}),header:(0,n.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,n.css)({marginLeft:oe.spacing(.5),color:oe.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${oe.spacing(.5)}`,[oe.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,n.css)({fontWeight:oe.typography.fontWeightBold,marginLeft:oe.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",[oe.breakpoints.down("sm")]:{flex:"2 2"}})}}function J({children:oe,title:de,headerElement:me,...Pe}){const Ee=(0,i.of)(Z),[be,Se]=(0,G.useState)(!1);function Xe(){Se(Qe=>!Qe)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_,{onRowToggle:Xe,isContentVisible:be,title:de,headerElement:me,...Pe}),be&&(0,t.jsx)("div",{className:Ee.content,children:oe})]})}J.displayName="SettingsBar";const Z=oe=>({content:(0,n.css)({marginTop:oe.spacing(1),marginLeft:oe.spacing(4)})});var te=e(64229);function ae({className:oe,isDataLoading:de=!1,timeRange:me,timeSelectionEnabled:Pe,annotationsEnabled:Ee}){const be=(0,i.of)(re),Se=(0,m.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),Xe=(0,m.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Qe=(0,m.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),we=(0,m.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return de?(0,t.jsx)("div",{className:(0,n.cx)(be.summaryWrapper,oe),children:(0,t.jsx)(K.y,{className:be.summary,inline:!0,size:"sm"})}):(0,t.jsxs)("div",{className:(0,n.cx)(be.summaryWrapper,oe),children:[(0,t.jsxs)("span",{className:be.summary,children:[(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,t.jsx)(te.f,{className:be.timeRange,value:me})]}),(0,t.jsx)("span",{className:be.summary,children:Pe?Se:Xe}),(0,t.jsx)("span",{className:be.summary,children:Ee?Qe:we})]})}ae.displayName="SettingsSummary";const re=oe=>({summaryWrapper:(0,n.css)({display:"flex"}),summary:(0,n.css)({label:"collapsedText",marginLeft:`${oe.spacing.gridSize*2}px`,fontSize:oe.typography.bodySmall.fontSize,color:oe.colors.text.secondary}),timeRange:(0,n.css)({display:"inline-block"})}),ne=a.Tp.pages.ShareDashboardModal.PublicDashboard;function ce({onRevoke:oe,timeRange:de,hasTemplateVariables:me=!1,showSaveChangesAlert:Pe=!1,unsupportedDatasources:Ee=[],publicDashboard:be,dashboard:Se}){const Xe=(0,i.of)(he),Qe=y(),[we,{isLoading:$e}]=(0,f.T2)(),[Fe,{isLoading:Te}]=(0,f.eq)(),Le=C.TP.hasPermission(l.AccessControlAction.DashboardsPublicWrite),Ge=!Le||$e||Te,{handleSubmit:Me,setValue:De,register:Ke}=(0,r.mN)({defaultValues:{isAnnotationsEnabled:be?.annotationsEnabled,isTimeSelectionEnabled:be?.timeSelectionEnabled,isPaused:!be?.isEnabled}}),Ie=async ge=>{const{isAnnotationsEnabled:xe,isTimeSelectionEnabled:je,isPaused:Ve}=ge;we({dashboard:Se,payload:{...be,annotationsEnabled:xe,timeSelectionEnabled:je,isEnabled:!Ve}})},Ne=async ge=>{const{isAnnotationsEnabled:xe,isTimeSelectionEnabled:je,isPaused:Ve}=ge;Fe({dashboard:Se,payload:{...be,annotationsEnabled:xe,timeSelectionEnabled:je,isEnabled:!Ve}})},ie=async(ge,xe)=>{De(ge,xe),await Me(je=>Ie(je))()},ve=async ge=>{De("isPaused",ge),await Me(xe=>Ne(xe))()};function fe(){h.c.publicDashboardUrlCopied()}return(0,t.jsxs)("div",{className:Xe.configContainer,children:[Pe&&(0,t.jsx)(O,{}),!Le&&(0,t.jsx)(S.t,{mode:"edit"}),me&&(0,t.jsx)(L.D,{}),Ee.length>0&&(0,t.jsx)(R.s,{unsupportedDataSources:Ee.join(", ")}),(0,B.AY)()&&(0,t.jsx)(w,{dashboard:Se}),(0,t.jsx)(x.D,{label:(0,m.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:Xe.fieldSpace,children:(0,t.jsx)(s.p,{value:(0,B.mL)(be.accessToken),readOnly:!0,disabled:!be?.isEnabled,"data-testid":ne.CopyUrlInput,addonAfter:(0,t.jsx)(c.b,{"data-testid":ne.CopyUrlButton,variant:"primary",disabled:!be?.isEnabled,getText:()=>(0,B.mL)(be.accessToken),onClipboardCopy:fe,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,t.jsx)(x.D,{className:Xe.fieldSpace,children:(0,t.jsxs)(g.PE,{children:[(0,t.jsx)(d.d,{...Ke("isPaused"),disabled:Ge,onChange:ge=>{h.c.publicDashboardPauseSharingClicked({paused:ge.currentTarget.checked}),ve(ge.currentTarget.checked)},"data-testid":ne.PauseSwitch}),(0,t.jsx)(u.J,{className:(0,n.css)({marginBottom:0}),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,t.jsx)(x.D,{className:Xe.fieldSpace,children:(0,t.jsx)(J,{title:(0,m.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:ge})=>(0,t.jsx)(ae,{className:ge,isDataLoading:$e,timeRange:de,timeSelectionEnabled:be?.timeSelectionEnabled,annotationsEnabled:be?.annotationsEnabled}),"data-testid":ne.SettingsDropdown,children:(0,t.jsx)(W,{disabled:Ge,onChange:ie,register:Ke,timeRange:de})})}),(0,t.jsx)(g.PE,{orientation:Qe?0:1,justify:Qe?"flex-end":"flex-start",align:Qe?"center":"normal",children:(0,t.jsx)(g.Gy,{justify:"flex-end",children:(0,t.jsx)(o.$n,{title:(0,m.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:oe,type:"button",disabled:Ge,"data-testid":ne.DeleteButton,variant:"destructive",fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function le({publicDashboard:oe,unsupportedDatasources:de}){const Pe=(0,l.useSelector)(we=>we.dashboard).getModel(),Ee=(0,p.z)(Pe.getDefaultTime(),Pe),be=C.TP.hasPermission(l.AccessControlAction.DashboardsPublicWrite),Se=(0,B.kD)(Pe.getVariables()),[Xe]=(0,f.bN)(),Qe=we=>{Xe({dashboard:Pe,uid:oe.uid,dashboardUid:Pe.uid}),we()};return(0,t.jsx)(E.$s,{children:({showModal:we,hideModal:$e})=>(0,t.jsx)(ce,{publicDashboard:oe,dashboard:Pe,unsupportedDatasources:de,timeRange:Ee,showSaveChangesAlert:be&&Pe.hasUnsavedChanges(),hasTemplateVariables:Se,onRevoke:()=>{h.c.revokePublicDashboardClicked(),we(D.m,{onConfirm:()=>Qe($e),onDismiss:()=>{we(P.Zy,{dashboard:Pe,onDismiss:$e,activeTab:b.wr.publicDashboard})}})}})})}const he=oe=>({configContainer:(0,n.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:oe.spacing(3)}),fieldSpace:(0,n.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,n.css)({display:"inline-block"})})},18546:(q,j,e)=>{"use strict";e.d(j,{M:()=>M,D:()=>S});var t=e(74848),n=e(22803),r=e(49785),a=e(58779),i=e(29675),x=e(54594),s=e(20968),c=e(11817),d=e(61351),u=e(65728),g=e(83424),o=e(61491),E=e(75386),m=e(25763),f=e(48174),p=e(71488),h=e(96093),D=e(44617),C=e(19550),l=e(81942);const v=a.Tp.pages.ShareDashboardModal.PublicDashboard,y=({disabled:R,register:L})=>{const B=(0,i.of)(P),F=[{type:"publicAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:v.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:v.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:v.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:B.title,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,t.jsx)(D.n,{disabled:R,children:(0,t.jsx)(C.gW,{spacing:"md",children:F.map(I=>(0,t.jsxs)(C.Gy,{spacing:"none",align:"center",children:[(0,t.jsx)(l.S,{...L(I.type,{required:!0}),label:I.description,"data-testid":I.testId}),(0,t.jsx)(x.z9,{variant:"primary",href:I.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:I.info.tooltip})]},I.type))})})]})},P=R=>({title:(0,n.css)({fontWeight:R.typography.fontWeightBold})}),b=a.Tp.pages.ShareDashboardModal.PublicDashboard,S=({unsupportedDatasources:R=[],unsupportedTemplateVariables:L=!1,dashboard:B,hasError:F=!1})=>{const I=(0,i.of)(O),U=d.TP.hasPermission(o.AccessControlAction.DashboardsPublicWrite),[W,{isLoading:A,isError:N}]=(0,u.U9)(),K=()=>{W({dashboard:B,payload:{isEnabled:!0}}),g.c.generatePublicDashboardUrlClicked({})},{handleSubmit:V,register:T,formState:{isValid:z}}=(0,r.mN)({mode:"onChange"}),w=!U||A||N||F;return(0,t.jsxs)("div",{className:I.container,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:I.title,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,t.jsx)("p",{className:I.description,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!U&&(0,t.jsx)(E.t,{mode:"create"}),L&&(0,t.jsx)(f.D,{}),R.length>0&&(0,t.jsx)(m.s,{unsupportedDataSources:R.join(", ")}),(0,t.jsxs)("form",{onSubmit:V(K),children:[(0,t.jsx)("div",{className:I.checkboxes,children:(0,t.jsx)(y,{disabled:w,register:T})}),(0,t.jsx)("div",{className:I.buttonContainer,children:(0,t.jsxs)(x.$n,{type:"submit",disabled:w||!z,"data-testid":b.CreateButton,children:[(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),A&&(0,t.jsx)(s.y,{className:I.loadingSpinner})]})})]})]})};function M({hasError:R}){const B=(0,o.useSelector)(U=>U.dashboard).getModel(),{unsupportedDataSources:F}=(0,h.Z)(B),I=(0,p.kD)(B.getVariables());return(0,t.jsx)(S,{dashboard:B,unsupportedDatasources:F,unsupportedTemplateVariables:I,hasError:R})}const O=R=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:R.spacing(4)}),title:(0,n.css)({fontSize:R.typography.h4.fontSize,margin:R.spacing(0,0,2)}),description:(0,n.css)({color:R.colors.text.secondary,marginBottom:R.spacing(0)}),checkboxes:(0,n.css)({margin:R.spacing(0,0,4)}),buttonContainer:(0,n.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,n.css)({marginLeft:R.spacing(1)})})},75386:(q,j,e)=>{"use strict";e.d(j,{t:()=>s});var t=e(74848),n=e(58779),r=e(32370),a=e(37e3),i=e(11817);const x=n.Tp.pages.ShareDashboardModal.PublicDashboard,s=({mode:c})=>{const d=r.$.featureToggles.newDashboardSharingComponent?(0,i.t)("public-dashboard.share-externally.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a shared dashboard",{mode:c}):(0,i.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:c});return(0,t.jsx)(a.F,{severity:"warning",title:d,"data-testid":x.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:r.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(i.x6,{i18nKey:"public-dashboard.share-externally.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:c}," shared dashboards"]}):(0,t.jsxs)(i.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:c}," public dashboards"]})})}},25763:(q,j,e)=>{"use strict";e.d(j,{s:()=>g});var t=e(74848),n=e(22803),r=e(46942),a=e.n(r),i=e(58779),x=e(32370),s=e(29675),c=e(37e3),d=e(11817);const u=i.Tp.pages.ShareDashboardModal.PublicDashboard,g=({unsupportedDataSources:E})=>{const m=(0,s.of)(o);return(0,t.jsxs)(c.F,{severity:"warning",title:(0,d.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":u.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,t.jsx)("p",{className:m.unsupportedDataSourceDescription,children:x.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(d.x6,{i18nKey:"public-dashboard.share-externally.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for shared dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:E},"."]}):(0,t.jsxs)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:E},"."]})}),(0,t.jsx)("a",{href:x.$.featureToggles.newDashboardSharingComponent?"https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#supported-data-sources":"https://grafana.com/docs/grafana/v11.2/dashboards/dashboard-public/#supported-data-sources",target:"blank",className:a()("text-link",m.unsupportedDataSourceDescription),children:(0,t.jsx)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},o=E=>({unsupportedDataSourceDescription:(0,n.css)({color:E.colors.text.secondary,marginBottom:E.spacing(1)})})},48174:(q,j,e)=>{"use strict";e.d(j,{D:()=>x});var t=e(74848),n=e(58779),r=e(37e3),a=e(11817);const i=n.Tp.pages.ShareDashboardModal.PublicDashboard,x=({showDescription:s=!0})=>(0,t.jsx)(r.F,{severity:"warning",title:(0,a.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":i.TemplateVariablesWarningAlert,bottomSpacing:0,children:s&&(0,t.jsx)(a.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},2175:(q,j,e)=>{"use strict";e.d(j,{a:()=>o,b:()=>E});var t=e(74848),n=e(22803),r=e(29675),a=e(20968),i=e(65728),x=e(71488),s=e(61491),c=e(83524),d=e(74031),u=e(18546),g=e(96093);const o=()=>{const f=(0,r.of)(m);return(0,t.jsx)(c.G,{className:f.loadingContainer,children:(0,t.jsxs)(t.Fragment,{children:["Loading configuration",(0,t.jsx)(a.y,{size:"lg",className:f.spinner})]})})},E=f=>{const{data:p,isLoading:h,isError:D}=(0,i.Bs)(f.dashboard.uid),l=(0,s.useSelector)(y=>y.dashboard).getModel(),{unsupportedDataSources:v}=(0,g.Z)(l);return(0,t.jsx)(t.Fragment,{children:h?(0,t.jsx)(o,{}):(0,x.lI)(p)?(0,t.jsx)(d.K,{publicDashboard:p,unsupportedDatasources:v}):(0,t.jsx)(u.M,{hasError:D})})},m=f=>({loadingContainer:(0,n.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:f.spacing(1)}),spinner:(0,n.css)({marginBottom:f.spacing(0)})})},71488:(q,j,e)=>{"use strict";e.d(j,{AY:()=>p,Xo:()=>c,_A:()=>g,_l:()=>m,gN:()=>E,iR:()=>f,kD:()=>d,lI:()=>u,mL:()=>o});var t=e(65502),n=e(32370),r=e(32864),a=e(88023),i=e(10059),x=e(25309),s=e(4826),c=(h=>(h.PUBLIC="public",h.EMAIL="email",h))(c||{});const d=h=>h.length>0,u=h=>h?.uid!==""&&h?.uid!==void 0,g=async h=>{let D=new Set;for(const C of h)for(const l of C.targets){const v=l?.datasource?.type;v&&(s.z.has(v)&&await(0,i.tR)().get(l.datasource)instanceof t.iy||D.add(v))}return Array.from(D).sort()},o=h=>`${(0,a.zj)().appUrl}public-dashboards/${h}`,E=(h,D)=>`/d/${h}/${D}?shareView=${x.wr.publicDashboard}`,m=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,f=()=>n.$.publicDashboardsEnabled,p=()=>f()&&!!n.$.featureToggles.publicDashboardsEmailSharing&&(0,r.a)("publicDashboardsEmailSharing")},4826:(q,j,e)=>{"use strict";e.d(j,{z:()=>t});const t=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-pagerduty-datasource","grafana-postgresql-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","highlightinc-highlight-datasource","ibm-aql-datasource","ibm-kql-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","postgres","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","timeplus-proton-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},96093:(q,j,e)=>{"use strict";e.d(j,{Z:()=>r});var t=e(96540),n=e(71488);const r=a=>{const[i,x]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>await(0,n._A)(a.panels))().then(c=>{x(c)})},[a.panels]),{unsupportedDataSources:i}}},43317:(q,j,e)=>{"use strict";e.d(j,{w:()=>i});var t=e(74848),n=e(86489),r=e(60641),a=e(11817);const i=({selectedTheme:x="current",onChange:s,description:c})=>{const d=[{label:(0,a.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,a.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,a.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,t.jsx)(n.D,{label:(0,a.t)("share-modal.theme-picker.field-name","Theme"),description:c,children:(0,t.jsx)(r.z,{options:d,value:x,onChange:s})})}},25309:(q,j,e)=>{"use strict";e.d(j,{CF:()=>E,Lb:()=>o,P_:()=>d,XV:()=>c,Xe:()=>u,hD:()=>f,wr:()=>p});var t=e(59577),n=e(93407),r=e(2567),a=e(3202),i=e(32370),x=e(65552),s=e(80757);function c({useCurrentTimeRange:h,selectedTheme:D,panel:C,search:l=window.location.search,range:v=(0,s.jG)().timeRange(),orgId:y=i.$.bootData.user.orgId}){const P=new URLSearchParams(l),b=C?.timeFrom;if(b){const{from:S,to:M}=t.describeTextRange(b);P.set("from",S),P.set("to",M)}else P.set("from",String(v.from.valueOf())),P.set("to",String(v.to.valueOf()));return P.set("orgId",String(y)),h||(P.delete("from"),P.delete("to")),D!=="current"&&P.set("theme",D),C&&!P.has("editPanel")&&P.set("viewPanel",String(C.id)),P.delete("auth_token"),P.delete("shareView"),P}function d(){let h=window.location.href;const D=h.indexOf("?");return D!==-1&&(h=h.substring(0,D)),h}async function u(h,D,C,l){const v=d(),y=c({useCurrentTimeRange:h,selectedTheme:D,panel:C}),P=n.kM.appendQueryToUrl(v,y.toString());return l?await(0,x.fn)(P):P}function g(h,D,C,l,v){const y=d(),P=c({useCurrentTimeRange:h,selectedTheme:C,panel:l,range:v});let b=y.replace(i.$.appSubUrl+"/dashboard/",i.$.appSubUrl+"/dashboard-solo/");b=b.replace(i.$.appSubUrl+"/d/",i.$.appSubUrl+"/d-solo/"),r.I.stripBaseFromUrl(y)==="/"&&(b=`${i.$.appUrl}d-solo/${D}`);const M=P.get("editPanel")??P.get("viewPanel")??"";return P.set("panelId",M),P.delete("editPanel"),P.delete("viewPanel"),n.kM.appendQueryToUrl(b,P.toString())}function o(h,D,C,l){let y=g(h,D,C,l).replace(i.$.appSubUrl+"/dashboard-solo/",i.$.appSubUrl+"/render/dashboard-solo/");return y=y.replace(i.$.appSubUrl+"/d-solo/",i.$.appSubUrl+"/render/d-solo/"),y+=`&width=${i.$.rendererDefaultImageWidth}&height=${i.$.rendererDefaultImageHeight}&scale=${i.$.rendererDefaultImageScale}`+m(),y}function E(h,D,C,l,v){return`<iframe src="${g(h,D,C,l,v)}" width="450" height="200" frameborder="0"></iframe>`}function m(){const h="&tz=UTC"+encodeURIComponent((0,a.KQ)().format("Z"));if(!window.Intl)return h;const D=window.Intl.DateTimeFormat();if(!D.resolvedOptions)return h;const C=D.resolvedOptions();return C.timeZone?"&tz="+encodeURIComponent(C.timeZone):h}const f=h=>h?"panel":"dashboard",p={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard",inviteUser:"invite_user"}},92498:(q,j,e)=>{"use strict";e.d(j,{Zx:()=>v,aK:()=>p});var t=e(74848),n=e(22803),r=e(96540),a=e(16817),i=e(84099),x=e(58779),s=e(29675),c=e(19224),d=e(99134),u=e(60232),g=e(79784),o=e(54594),E=e(75911),m=e(89146);function f({dashboardUID:y,link:P}){const b=(0,s.of)(l),S=h({dashboardUID:y,link:P});return!S||C.length===0?null:(0,t.jsx)(c.W,{children:(0,t.jsx)("div",{className:b.dropdown,children:(0,t.jsx)(d.P,{maxHeight:"inherit",children:S.map((M,O)=>(0,t.jsx)(c.W.Item,{url:M.url,target:P.targetBlank?"_blank":void 0,label:M.title,testId:x.Tp.components.DashboardLinks.link,"aria-label":`${M.title} dashboard`},`dashlinks-dropdown-item-${M.uid}-${O}`))})})})}const p=y=>{const{link:P,linkInfo:b,dashboardUID:S}=y,M=h(y),O=(0,s.of)(l);return P.asDropdown?(0,t.jsx)(u.m,{overlay:(0,t.jsx)(f,{link:P,dashboardUID:S}),children:(0,t.jsxs)(v,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":x.Tp.components.DashboardLinks.dropDown,children:[(0,t.jsx)(g.I,{"aria-hidden":!0,name:"bars",className:O.iconMargin}),(0,t.jsx)("span",{children:b.title})]})}):(0,t.jsx)(t.Fragment,{children:M.length>0&&M.map((R,L)=>(0,t.jsx)(v,{icon:"apps",variant:"secondary",fill:"outline",href:R.url,target:P.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":x.Tp.components.DashboardLinks.link,children:R.title},`dashlinks-list-item-${R.uid}-${L}`))})},h=({link:y,dashboardUID:P})=>{const{tags:b}=y,S=(0,a.A)(()=>D(b),[b]);return S.value?C(P,y,S.value):[]};async function D(y,P={getBackendSrv:E.AI}){return await P.getBackendSrv().search({tag:y,limit:100})}function C(y,P,b,S={getLinkSrv:m.mQ,sanitize:i.aj,sanitizeUrl:i.Jf}){return b.filter(M=>M.uid!==y).map(M=>{const O=M.uid,R=S.sanitize(M.title),L=S.getLinkSrv().getLinkUrl({...P,url:M.url}),B=S.sanitizeUrl(L);return{uid:O,title:R,url:B}})}function l(y){return{iconMargin:(0,n.css)({marginRight:y.spacing(.5)}),dropdown:(0,n.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh"}),button:(0,n.css)({color:y.colors.text.primary}),dashButton:(0,n.css)({fontSize:y.typography.bodySmall.fontSize,paddingLeft:y.spacing(1),paddingRight:y.spacing(1)})}}const v=(0,r.forwardRef)(({className:y,...P},b)=>{const S=(0,s.of)(l),M=P.href?o.z9:o.$n;return(0,t.jsx)(M,{...P,variant:"secondary",fill:"outline",className:(0,n.cx)(y,S.dashButton),ref:b})});v.displayName="DashboardLinkButton"},40577:(q,j,e)=>{"use strict";e.d(j,{A:()=>W});var t=e(74848),n=e(48279),r=e(96540),a=e(42941),i=e(69862),x=e(38075),s=e(40462),c=e(54092),d=e(58779),u=e(56276),g=e(39736),o=e(65164),E=e(33833),m=e(56180),f=e(88023),p=e(62637),h=e(22803),D=e(29675),C=e(58528),l=e(67676),v=e(79784);const y=({input:A,output:N,debugMode:K,index:V,uiConfig:T,configs:z,onChange:w,toggleShowDebug:H})=>{const G=(0,D.of)(P),X=(0,r.useMemo)(()=>z[V],[z,V]),k=(0,r.useMemo)(()=>(0,r.createElement)(T.editor,{options:{...T.transformation.defaultOptions,...X.transformation.options},input:A,onChange:_=>{w(V,{...X.transformation,options:_})}}),[T.editor,T.transformation.defaultOptions,X.transformation,A,w,V]);return(0,t.jsxs)("div",{"data-testid":d.Tp.components.TransformTab.transformationEditor(T.name),children:[k,K&&(0,t.jsx)(C._,{title:"Debug transformation",subtitle:T.name,onClose:H,children:(0,t.jsxs)("div",{className:G.debugWrapper,"data-testid":d.Tp.components.TransformTab.transformationEditorDebugger(T.name),children:[(0,t.jsxs)("div",{className:G.debug,children:[(0,t.jsx)("div",{className:G.debugTitle,children:"Input data"}),(0,t.jsx)("div",{className:G.debugJson,children:(0,t.jsx)(l.B,{json:A})})]}),(0,t.jsx)("div",{className:G.debugSeparator,children:(0,t.jsx)(v.I,{name:"arrow-right"})}),(0,t.jsxs)("div",{className:G.debug,children:[(0,t.jsx)("div",{className:G.debugTitle,children:"Output data"}),(0,t.jsx)("div",{className:G.debugJson,children:N&&(0,t.jsx)(l.B,{json:N})})]})]})})]})},P=A=>({title:(0,h.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,h.css)({fontWeight:A.typography.fontWeightMedium,color:A.colors.primary.text}),iconRow:(0,h.css)({display:"flex"}),icon:(0,h.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:A.colors.text.secondary,marginLeft:A.spacing(1),"&:hover":{color:A.colors.text.primary}}),debugWrapper:(0,h.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,h.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${A.spacing(.5)}`,color:A.colors.primary.text}),debugTitle:(0,h.css)({padding:`${A.spacing(1)} ${A.spacing(.25)}`,fontFamily:A.typography.fontFamilyMonospace,fontSize:A.typography.bodySmall.fontSize,color:A.colors.text.primary,borderBottom:`1px solid ${A.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,h.css)({marginTop:A.spacing(1),padding:`0 ${A.spacing(1,1,1)}`,border:`1px solid ${A.colors.border.weak}`,background:`${A.isLight?A.v1.palette.white:A.v1.palette.gray05}`,borderRadius:A.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,h.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:A.spacing(.5)})});var b=e(8716),S=e(15817);const M=({isOpen:A,onCloseClick:N,transformer:K})=>{const{transformation:{name:V},help:T}=K,z=T||(0,S.$n)(),w=(0,t.jsx)(C._,{title:V,subtitle:"Transformation help",onClose:()=>N(!1),children:(0,t.jsx)(b.j,{markdown:z,styleOverrides:{borderTop:"2px solid"}})});return A?w:null};var O=e(7500),R=e(86489),L=e(44826),B=e(1561);const F=({index:A,annotations:N,config:K,onChange:V,data:T})=>{const z=(0,D.of)(I),w=(0,r.useMemo)(()=>({context:{data:T},showTopic:!0,showFilter:K.topic!==O.QR.Annotations,source:[{value:O.QR.Series,label:"Query and Transformation results"},{value:O.QR.Annotations,label:"Annotation data"}]}),[T,N?.length,K.topic]);return(0,t.jsx)("div",{className:z.wrapper,children:(0,t.jsx)(R.D,{label:"Apply transformation to",children:(0,t.jsxs)(t.Fragment,{children:[w.showTopic&&(0,t.jsx)(L.l6,{isClearable:!0,options:w.source,value:w.source.find(H=>H.value===K.topic),placeholder:w.source[0].label,className:z.padded,onChange:H=>{V(A,{...K,topic:H?.value})}}),w.showFilter&&(0,t.jsx)(B.M,{value:K.filter,context:w.context,onChange:H=>V(A,{...K,filter:H})})]})})})},I=A=>{const N=A.shape.radius.default;return{wrapper:(0,h.css)({padding:A.spacing(2),border:`2px solid ${A.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${N} ${N}`,position:"relative",top:"-4px"}),padded:(0,h.css)({marginBottom:A.spacing(1)})}},U=({onRemove:A,index:N,id:K,data:V,configs:T,uiConfig:z,onChange:w})=>{const[H,G]=(0,a.A)(!1),[X,k]=(0,a.A)(!1),[_,ee]=(0,a.A)(!1),J=!!T[N].transformation.disabled,Z=T[N].transformation.topic,te=T[N].transformation.filter!=null||Z!=null,ae=te||V.series.length>0||(V.annotations?.length??0)>0,[re,ne]=(0,r.useState)([]),[ce,le]=(0,r.useState)([]),[he,oe]=(0,r.useState)([]),de=(0,r.useCallback)(be=>{const Se=T[be].transformation;w(be,{...Se,disabled:Se.disabled?void 0:!0})},[w,T]),me=(0,r.useCallback)(()=>{let be={...T[N].transformation};be.filter?delete be.filter:be.filter={id:x.jR.byRefId,options:""},w(N,be)},[w,N,T]),Pe=(0,r.useCallback)((be,Se,Xe)=>Qe=>{let we="panel_editor_tabs_transformations_toggle";f.Ay.featureToggles.transformationsRedesign&&(we="transformations_redesign_"+we),(0,u.rR)(we,{action:Xe?"off":"on",toggleId:Se,transformationId:T[N].transformation.id}),be(Qe)},[T,N]);(0,r.useEffect)(()=>{const be=T[N].transformation,Se=be.filter?.options?(0,s.Dq)(be.filter):void 0,Xe=N-1;let Qe=[],we=[];Xe>=0&&(Qe=T.slice(0,Xe).map(De=>De.transformation),we=T.slice(Xe,N).map(De=>De.transformation));const $e=T.slice(0,N).map(De=>De.transformation),Fe=T.slice(N,N+1).map(De=>De.transformation),Te={interpolate:De=>(0,g.w)().replace(De)},Le=(0,c.m)($e,V.series,Te).subscribe(De=>{Se&&(De=De.filter(Ke=>Se(Ke))),ne(De)}),Ge=(0,c.m)($e,V.series,Te).pipe((0,i.Z)(De=>(0,c.m)(Fe,De,Te))).subscribe(le),Me=(0,c.m)(Qe,V.series,Te).pipe((0,i.Z)(De=>(0,c.m)(we,De,Te))).subscribe(oe);return function(){Le.unsubscribe(),Ge.unsubscribe(),Me.unsubscribe()}},[N,V,T]);const Ee=()=>(0,t.jsxs)(t.Fragment,{children:[z.state&&(0,t.jsx)(p.p,{state:z.state}),(0,t.jsx)(E.A,{title:"Show transform help",icon:"info-circle",onClick:Pe(ee,"help",_),active:_}),ae&&(0,t.jsx)(E.A,{title:"Filter",icon:"filter",onClick:Pe(me,"filter",te),active:te}),(0,t.jsx)(E.A,{title:"Debug",icon:"bug",onClick:Pe(k,"debug",X),active:X}),(0,t.jsx)(E.A,{title:"Disable transformation",icon:J?"eye-slash":"eye",onClick:Pe(()=>de(N),"disabled",J),active:J,dataTestId:d.Tp.components.Transforms.disableTransformationButton}),(0,t.jsx)(E.q,{title:"Remove",icon:"trash-alt",onClick:()=>f.Ay.featureToggles.transformationsRedesign?G(!0):A(N)}),f.Ay.featureToggles.transformationsRedesign&&(0,t.jsx)(o.u,{isOpen:H,title:`Delete ${z.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{G(!1),A(N)},onDismiss:()=>G(!1)})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.u,{id:K,index:N,title:`${N+1} - ${z.name}`,draggable:!0,actions:Ee,disabled:J,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[te&&(0,t.jsx)(F,{data:he,index:N,config:T[N].transformation,annotations:V.annotations,onChange:w}),(0,t.jsx)(y,{input:re,output:ce,debugMode:X,index:N,configs:T,uiConfig:z,onChange:w,toggleShowDebug:k})]}),(0,t.jsx)(M,{transformer:z,isOpen:_,onCloseClick:ee})]})},W=({data:A,onChange:N,onRemove:K,configs:V})=>(0,t.jsx)(t.Fragment,{children:V.map((T,z)=>{const w=n.h.getIfExists(T.transformation.id);return w?(0,t.jsx)(U,{index:z,id:`${T.id}`,data:A,configs:V,uiConfig:w,onRemove:K,onChange:N},`${T.id}`):null})})},24929:(q,j,e)=>{"use strict";e.d(j,{R:()=>v});var t=e(74848),n=e(22803),r=e(96540),a=e(19844),i=e(66564),x=e(48279),s=e(58779),c=e(29675),d=e(58528),u=e(34128),g=e(29010),o=e(99076),E=e(6210),m=e(99764),f=e(88023),p=e(62637),h=e(24847);const l=[["viewAll","View all"],...Object.entries(h.eJ)];function v(R){const L=(0,c.of)(y),{suffix:B,xforms:F,search:I,onSearchChange:U,onSearchKeyDown:W,showIllustrations:A,onTransformationAdd:N,selectedFilter:K,data:V,onClose:T,onShowIllustrationsChange:z,onSelectedFilterChange:w}=R,H=(0,r.useCallback)(G=>{G?.click()},[]);return(0,t.jsxs)(d._,{size:"md",onClose:()=>{T&&T()},title:"Add another transformation",children:[(0,t.jsxs)("div",{className:L.searchWrapper,children:[(0,t.jsx)(u.p,{"data-testid":s.Tp.components.Transforms.searchInput,className:L.searchInput,value:I??"",placeholder:"Search for transformation",onChange:U,onKeyDown:W,suffix:B,ref:H,autoFocus:!0}),(0,t.jsxs)("div",{className:L.showImages,children:[(0,t.jsx)("span",{className:L.illustationSwitchLabel,children:"Show images"})," ",(0,t.jsx)(g.d,{value:A,onChange:()=>z&&z(!A)})]})]}),(0,t.jsx)("div",{className:L.filterWrapper,children:l.map(([G,X])=>(0,t.jsx)(o.m,{onClick:()=>w&&w(G),label:X,selected:K===G},G))}),(0,t.jsx)(P,{showIllustrations:A,transformations:F,data:V,onClick:G=>{N({value:G})}})]})}function y(R){return{showImages:(0,n.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,n.css)({fontSize:"16px",marginBottom:`${R.spacing(2)}`}),pickerInformationLineHighlight:(0,n.css)({verticalAlign:"middle"}),searchWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,n.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,n.css)({whiteSpace:"nowrap"}),filterWrapper:(0,n.css)({padding:`${R.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${R.spacing(1)}`,columnGap:`${R.spacing(.5)}`})}}function P({showIllustrations:R,transformations:L,onClick:B,data:F}){const I=(0,c.of)(b);return(0,t.jsx)("div",{className:I.grid,children:L.map(U=>{let W=a.M.Applicable;U.transformation.isApplicable!==void 0&&(W=U.transformation.isApplicable(F));const A=W>0;let N=null;U.transformation.isApplicableDescription!==void 0&&(typeof U.transformation.isApplicableDescription=="function"?N=U.transformation.isApplicableDescription(F):N=U.transformation.isApplicableDescription);let K=I.newCard;return A||(K=(0,n.cx)(I.newCard,I.cardDisabled)),(0,t.jsxs)(E.Z,{className:K,"data-testid":s.Tp.components.TransformTab.newTransform(U.name),onClick:()=>B(U.id),children:[(0,t.jsxs)(E.Z.Heading,{className:I.heading,children:[(0,t.jsx)("span",{children:U.name}),(0,t.jsx)("span",{className:I.pluginStateInfoWrapper,children:(0,t.jsx)(p.p,{state:U.state})})]}),(0,t.jsxs)(E.Z.Description,{className:I.description,children:[(0,t.jsx)("span",{children:O(U.id)}),R&&(0,t.jsx)("span",{children:(0,t.jsx)("img",{className:I.image,src:S(U.id,!A),alt:U.name})}),!A&&N!==null&&(0,t.jsx)(m.K,{className:I.cardApplicableInfo,name:"info-circle",tooltip:N})]})]},U.id)})})}function b(R){return{heading:(0,n.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,n.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,n.css)({display:"block",maxEidth:"100%`",marginTop:`${R.spacing(2)}`}),grid:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${R.spacing(2)} ${R.spacing(1)}`,width:"100%"}),cardDisabled:(0,n.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${R.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,n.css)({position:"absolute",bottom:`${R.spacing(1)}`,right:`${R.spacing(1)}`}),newCard:(0,n.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,n.css)({marginLeft:"5px"})}}const S=(R,L)=>`public/img/transformations/${f.Ay.theme2.isDark?"dark":"light"}/${R}.svg`,M={[i.F.concatenate]:"Combine all fields into a single frame.",[i.F.configFromData]:"Set unit, min, max and more.",[i.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[i.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[i.F.filterByRefId]:"Remove rows from the data based on origin query",[i.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[i.F.groupBy]:"Group data by a field value and create aggregate data.",[i.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[i.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[i.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[i.F.merge]:"Merge multiple series. Values will be combined into one row.",[i.F.organize]:"Re-order, hide, or rename fields.",[i.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[i.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[i.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[i.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[i.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},O=R=>M[R]||x.h.getIfExists(R)?.description||""},45177:(q,j,e)=>{"use strict";e.d(j,{o:()=>N,e:()=>W});var t=e(74848),n=e(57095),r=e(96540),a=e(48279),i=e(58779),x=e(56276),s=e(99764),c=e(54594),d=e(65164),u=e(90333),g=e(99134),o=e(19550),E=e(29675),m=e(88023),f=e(42090),p=e(53027),h=e(75342);function D({message:K}){const V=(0,r.useCallback)(()=>{p.Ny.partial({tab:h.M8.Query})},[]);return(0,t.jsx)(o.PE,{justify:"center",style:{marginTop:"100px"},children:(0,t.jsxs)(o.gW,{spacing:"md",children:[(0,t.jsx)("h2",{children:K}),(0,t.jsx)("div",{children:(0,t.jsx)(c.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:V,children:"Go back to Queries"})})]})})}var C=e(40577),l=e(22803),v=e(14211),y=e(37e3),P=e(34128),b=e(6210),S=e(23657);const M={[v.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[v.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[v.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},O=K=>M[K];var R=e(62637);const L="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function B(K){const{noTransforms:V,search:T,xforms:z,onSearchChange:w,onSearchKeyDown:H,onTransformationAdd:G,suffix:X}=K;return(0,t.jsxs)(o.gW,{children:[V&&(0,t.jsx)(o.mc,{grow:1,children:(0,t.jsx)(S.b,{storageKey:L,defaultValue:!1,children:(k,_)=>k?null:(0,t.jsxs)(y.F,{title:"Transformations",severity:"info",onRemove:()=>{_(!0)},children:[(0,t.jsxs)("p",{children:["Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",(0,t.jsx)("br",{}),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",(0,t.jsx)("br",{}),"It can help to switch to the Table visualization to understand what a transformation is doing."," "]}),(0,t.jsx)("a",{href:O(v.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:"Read more"})]})})}),(0,t.jsx)(P.p,{"data-testid":i.Tp.components.Transforms.searchInput,value:T??"",autoFocus:!V,placeholder:"Search for transformation",onChange:w,onKeyDown:H,suffix:X}),z.map(k=>(0,t.jsx)(F,{transform:k,onClick:()=>{G({value:k.id})}},k.name))]})}function F({transform:K,onClick:V}){const T=(0,E.of)(I);return(0,t.jsxs)(b.Z,{className:T.card,"data-testid":i.Tp.components.TransformTab.newTransform(K.name),onClick:V,children:[(0,t.jsx)(b.Z.Heading,{children:K.name}),(0,t.jsx)(b.Z.Description,{children:K.description}),K.state&&(0,t.jsx)(b.Z.Tags,{children:(0,t.jsx)(R.p,{state:K.state})})]})}function I(K){return{card:(0,l.css)({margin:"0",padding:`${K.spacing(1)}`})}}var U=e(24929);const W="viewAll";class A extends r.PureComponent{constructor(V){super(V),this.onSearchChange=w=>{this.setState({search:w.target.value})},this.onSearchKeyDown=w=>{if(w.key==="Enter"){const{search:H}=this.state;if(H){const G=H.toLowerCase(),X=a.h.list().filter(k=>(k.name+k.description).toLowerCase().indexOf(G)>=0);X.length>0&&this.onTransformationAdd({value:X[0].id})}}else w.keyCode===27&&(this.setState({search:"",showPicker:!1}),w.stopPropagation())},this.getTransformationNextId=w=>{const{transformations:H}=this.state;let G=0;const X=H.filter(k=>k.id.startsWith(w)).map(k=>k.id);return X.length!==0&&(G=Math.max(...X.map(k=>parseInt(k.match(/\d+/)[0],10)))+1),`${w}-${G}`},this.onTransformationAdd=w=>{let H="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(H="transformations_redesign_"+H),(0,x.rR)(H,{action:"add",transformationId:w.value});const{transformations:G}=this.state,X=this.getTransformationNextId(w.value);this.setState({search:"",showPicker:!1}),this.onChange([...G,{id:X,transformation:{id:w.value,options:{}}}])},this.onTransformationChange=(w,H)=>{const{transformations:G}=this.state,X=Array.from(G);let k="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(k="transformations_redesign_"+k),(0,x.rR)(k,{action:"change",transformationId:X[w].transformation.id}),X[w].transformation=H,this.onChange(X)},this.onTransformationRemove=w=>{const{transformations:H}=this.state,G=Array.from(H);let X="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(X="transformations_redesign_"+X),(0,x.rR)(X,{action:"remove",transformationId:G[w].transformation.id}),G.splice(w,1),this.onChange(G)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=w=>{const{transformations:H}=this.state;if(!w||!w.destination)return;const G=w.source.index,X=w.destination.index;if(G===X)return;const k=Array.from(H),[_]=k.splice(G,1);k.splice(X,0,_),this.onChange(k)},this.renderEmptyMessage=()=>(0,t.jsx)(f.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:w,transformations:H}=this.state;return(0,t.jsx)(n.DragDropContext,{onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.Droppable,{droppableId:"transformations-list",direction:"vertical",children:G=>(0,t.jsxs)("div",{ref:G.innerRef,...G.droppableProps,children:[(0,t.jsx)(C.A,{configs:H,data:w,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),G.placeholder]})})})};const T=V.panel.transformations||[],z=this.buildTransformationIds(T);this.state={transformations:T.map((w,H)=>({transformation:w,id:z[H]})),data:{series:[]},search:"",selectedFilter:W,showIllustrations:!0},this.ref=(0,r.createRef)()}buildTransformationIds(V){const T={},z=[];for(let w=0;w<V.length;w++){const H=V[w];T[H.id]===void 0?T[H.id]=0:T[H.id]+=1,z.push(`${V[w].id}-${T[V[w].id]}`)}return z}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:V=>this.setState({data:V})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(V,T){if(m.Ay.featureToggles.transformationsRedesign){const w=!(T.transformations.length>0)||T.showPicker,G=!(this.state.transformations.length>0)||this.state.showPicker;if(w!==G){const X=Math.random()/2;this.setState({scrollTop:G?X:Number.MAX_SAFE_INTEGER})}}T.scrollTop!==this.state.scrollTop&&this.ref.current?.scrollTo({top:this.state.scrollTop})}onChange(V){this.setState({transformations:V}),this.props.panel.setTransformations(V.map(T=>T.transformation))}renderTransformsPicker(){let{showPicker:V}=this.state;const{transformations:T,search:z}=this.state,{transformationsRedesign:w}=m.Ay.featureToggles,H=!T?.length,G=T.length>0;let X=null,k=a.h.list().sort((Z,te)=>Z.name>te.name?1:te.name>Z.name?-1:0);if(!w&&H&&(V=!0),this.state.selectedFilter!==W&&(k=k.filter(Z=>Z.categories&&this.state.selectedFilter&&Z.categories.has(this.state.selectedFilter))),z){const Z=z.toLowerCase(),te=k.filter(ae=>(ae.name+ae.description).toLowerCase().indexOf(Z)>=0);X=(0,t.jsxs)(t.Fragment,{children:[te.length," / ",k.length," \xA0\xA0",(0,t.jsx)(s.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})]}),k=te}!X&&V&&!H&&(X=(0,t.jsx)(s.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let _=null,ee=null;w?(_=(0,t.jsx)(U.R,{noTransforms:H,search:z,suffix:X,xforms:k,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:Z=>this.setState({selectedFilter:Z}),onShowIllustrationsChange:Z=>this.setState({showIllustrations:Z}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ee=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:"Delete all transformations"}),(0,t.jsx)(d.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):_=(0,t.jsx)(B,{noTransforms:H,search:z,suffix:X,xforms:k,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const J=(0,t.jsxs)(u.e,{children:[(0,t.jsx)(c.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":i.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),ee]});return(0,t.jsxs)(t.Fragment,{children:[V&&_,w&&G&&J||!w&&!V&&G&&J]})}render(){const{panel:{alert:V}}=this.props,{transformations:T}=this.state,z=T.length>0;if(V){const w=z?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,t.jsx)(D,{message:w})}return(0,t.jsx)(g.P,{ref:this.ref,minHeight:"100%",children:(0,t.jsx)(o.mc,{padding:"lg",children:(0,t.jsxs)("div",{"data-testid":i.Tp.components.TransformTab.content,children:[!z&&m.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),z&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const N=(0,E.SL)(A)},29998:(q,j,e)=>{"use strict";e.d(j,{A:()=>D});var t=e(74848),n=e(22803),r=e(58779),a=e(53027),i=e(29675),x=e(48583),s=e(90231),c=e(45565),d=e(54594),u=e(11817),g=e(61976),o=e(97805),E=e(11997),m=e(83424),f=e(61491),p=e(86983);const D=({dashboard:l,canCreate:v})=>{const y=(0,i.of)(C),P=(0,f.useDispatch)(),b=(0,f.useSelector)(O=>O.dashboard.initialDatasource),S=()=>{let O;if(l instanceof E.H$){const R=l.onCreateNewPanel();l.setState({editPanel:(0,o.L)(R,!0)}),a.Ny.partial({firstPanel:!0})}else O=(0,g.OK)(l,b),P((0,p.Ub)(void 0)),a.Ny.partial({editPanel:O,firstPanel:!0});m.c.emptyDashboardButtonClicked({item:"add_visualization"})},M=()=>{m.c.emptyDashboardButtonClicked({item:"import_from_library"}),l instanceof E.H$?l.onShowAddLibraryPanelDrawer():(0,g.s3)(l)};return(0,t.jsx)(x.B,{alignItems:"center",justifyContent:"center",children:(0,t.jsx)("div",{className:y.wrapper,children:(0,t.jsxs)(x.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,t.jsx)(s.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,t.jsxs)(x.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(c.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,t.jsx)(s.a,{marginBottom:2,paddingX:4,children:(0,t.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,t.jsx)(d.$n,{size:"lg",icon:"plus","data-testid":r.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:S,disabled:!v,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,t.jsxs)(x.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[(0,t.jsx)(s.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(x.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(c.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,t.jsx)(s.a,{marginBottom:2,children:(0,t.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,t.jsx)(d.$n,{icon:"plus",fill:"outline","data-testid":r.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:M,disabled:!v,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,t.jsx)(s.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(x.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(c.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,t.jsx)(s.a,{marginBottom:2,children:(0,t.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsxs)(u.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,t.jsx)(d.$n,{icon:"upload",fill:"outline","data-testid":r.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{m.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,g.VF)()},disabled:!v,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function C(l){return{wrapper:(0,n.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:l.spacing.gridSize*4,paddingTop:l.spacing(2),[l.breakpoints.up("sm")]:{paddingTop:l.spacing(12)}})}}},31047:(q,j,e)=>{"use strict";e.d(j,{Z:()=>o});var t=e(74848),n=e(96540),r=e(53027),a=e(22803),i=e(29675),x=e(52120),s=e(79784),c=e(6736),d=e(94963);const u=({notice:E,onClick:m})=>{const f=(0,i.of)(g),p=E.severity==="error"||E.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return E.inspect&&m?(0,t.jsx)(x.I,{className:f.notice,icon:p,iconSize:"md",tooltip:E.text,onClick:h=>m(h,E.inspect)},E.severity):E.link?(0,t.jsx)("a",{className:f.notice,"aria-label":E.text,href:E.link,target:"_blank",rel:"noreferrer",children:(0,t.jsx)(s.I,{name:p,style:{marginRight:"8px"},size:"md"})}):(0,t.jsx)(c.m,{content:E.text,children:(0,t.jsx)("span",{className:f.iconTooltip,children:(0,t.jsx)(s.I,{name:p,size:"md"})})},E.severity)},g=E=>({notice:(0,a.css)({background:"inherit",border:"none",borderRadius:E.shape.radius.default}),iconTooltip:(0,a.css)({color:`${E.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${E.shape.radius.default}`,padding:`${E.spacing(0,1)}`,height:` ${E.spacing(E.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,d.getFocusStyles)(E),zIndex:1},"&: focus:not(:focus-visible)":(0,d.getMouseFocusStyles)(E),"&:hover ":{boxShadow:`${E.shadows.z1}`,color:`${E.colors.text.primary}`,background:`${E.colors.background.secondary}`}})}),o=({frames:E,panelId:m})=>{const f=(0,n.useCallback)((h,D)=>{h.stopPropagation(),r.Ny.partial({inspect:m,inspectTab:D})},[m]),p={};for(const h of E)if(!(!h.meta||!h.meta.notices))for(const D of h.meta.notices)p[D.severity]=D;return(0,t.jsx)(t.Fragment,{children:Object.values(p).map(h=>(0,t.jsx)(u,{notice:h,onClick:f},h.severity))})}},90968:(q,j,e)=>{"use strict";e.d(j,{M:()=>u});var t=e(62321),n=e(93682),r=e(38075),a=e(63739),i=e(23570),x=e(40462),s=e(25205);const c="hideSeriesFrom",d=(0,t.ZW)(c);function u(h,D,C,l){const{overrides:v}=C,y=h,P=v.findIndex(d);if(P<0){if(D===s.B.ToggleSelection){const L=g([y,...p(v,l)]);return{...C,overrides:[...C.overrides,L]}}const O=f(l,y),R=g(O);return{...C,overrides:[...C.overrides,R]}}const b=Array.from(v),[S]=b.splice(P,1);if(D===s.B.ToggleSelection){let O=E(S);const R=p(b,l);if(R.length>0&&(O=O.filter(B=>R.indexOf(B)<0)),O[0]===y&&O.length===1)return{...C,overrides:b};const L=g([y,...R]);return{...C,overrides:[...b,L]}}const M=o(S,y);return m(M,l)?{...C,overrides:b}:{...C,overrides:[...b,M]}}function g(h,D=n.PP.exclude,C){return C=C??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:c,matcher:{id:r.Ct.byNames,options:{mode:D,names:h,prefix:D===n.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...C,value:{viz:!0,legend:!1,tooltip:!1}}]}}const o=(h,D,C=n.PP.exclude)=>{const l=h.properties.find(P=>P.id==="custom.hideFrom"),v=E(h),y=v.findIndex(P=>P===D);return y<0?v.push(D):v.splice(y,1),g(v,C,l)},E=h=>{const D=h.matcher.options?.names;return Array.isArray(D)?[...D]:[]},m=(h,D)=>E(h).length===f(D).length,f=(h,D)=>{const C=new Set;for(const l of h)for(const v of l.fields){if(v.type!==a.PU.number)continue;const y=(0,i.Ct)(v,l,h);y!==D&&C.add(y)}return Array.from(C)},p=(h,D)=>{let C=[];for(const l of h){const v=l.properties.find(y=>y.id==="custom.hideFrom");if(v!==void 0&&v.value?.legend===!0){const P=x.sJ.get(l.matcher.id).get(l.matcher.options);for(const b of D)for(const S of b.fields){if(S.type!==a.PU.number)continue;const M=(0,i.Ct)(S,b,D);P(S,b,D)&&C.push(M)}}}return C}},5468:(q,j,e)=>{"use strict";e.d(j,{a:()=>c});var t=e(49426),n=e(3202),r=e(30468);const a=100;class i{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new t.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const u=Date.now();this.budget=(u-this.lastUpdate)/a;const g=this.ok.getValue(),o=this.budget<=this.threshold;if(g!==o&&this.ok.next(o),this.lastUpdate=u,this.isLive&&this.ok.getValue()&&this.timeRange){let E;for(const m of this.listeners){if(!m.panel.props.isInView)continue;if(u-m.last>=m.intervalMs){if(!E){const{raw:p}=this.timeRange;E={raw:p,from:(0,n.KQ)(u-this.liveTimeOffset),to:(0,n.KQ)(u)}}m.panel.liveTimeChanged(E),m.last=u}}}}}setLiveTimeRange(u){if(this.timeRange=u,this.isLive=u?.raw?.to==="now",this.isLive){const g=r.parse(u.raw.from,!1)?.valueOf(),o=r.parse(u.raw.to,!0)?.valueOf();this.liveTimeOffset=o-g;for(const E of this.listeners)E.intervalMs=s(this.liveTimeOffset,E.panel.props.width)}}listen(u){this.listeners.push({last:this.lastUpdate,panel:u,intervalMs:s(6e4,u.props.width)})}remove(u){this.listeners=this.listeners.filter(g=>g.panel!==u)}updateInterval(u){if(!(!this.timeRange||!this.isLive)){for(const g of this.listeners)if(g.panel===u){g.intervalMs=s(this.liveTimeOffset,g.panel.props.width);return}}}}const x=5*60*1e3;function s(d,u){const g=Math.ceil(d/u/100)*100;return g>x?x:g}const c=new i;setInterval(c.measure,a)},55227:(q,j,e)=>{"use strict";e.d(j,{Fu:()=>y,np:()=>b,t0:()=>P});var t=e(34796),n=e.n(t),r=e(2543),a=e.n(r),i=e(95093),x=e.n(i),s=e(52718),c=e(30468),d=e(28082),u=e(53027),g=e(75911),o=e(36167),E=e(58410),m=e(44172),f=e(10059),p=e(87638),h=e(5174),D=e(15543),C=e(16910),l=e(77274);class v{loadScriptedDashboard(O){const R="public/dashboards/"+O.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,d.AI)().get(R).then(this.executeScript.bind(this)).then(L=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:L.data}),L=>{throw console.error("Script dashboard error "+L),p.lE.emit(s.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),L})}executeScript(O){const R={dashboardSrv:(0,C.UA)(),datasourceSrv:(0,f.tR)()},B=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",O)(u.Ny.getSearchObject(),E.A,c,a(),x(),window,document,n(),n(),R);return(0,r.isFunction)(B)?new Promise(F=>{B(I=>{F({data:I})})}):{data:B}}}class y extends v{loadDashboard(O,R,L,B){const F=(0,m.sP)();let I;if(O==="script"&&R)I=this.loadScriptedDashboard(R);else if(O==="snapshot"&&R)I=(0,l.s)().getSnapshot(R);else if(O==="public"&&L)I=g.IB.getPublicDashboardByUid(L).then(U=>U);else if(L){if(!B){const U=F.getDashboardFromCache(L);if(U)return Promise.resolve(U)}I=(0,D.n)().getDashboardDTO(L,B).catch(U=>{throw console.error("Failed to load dashboard",U),(0,d.NF)(U)&&(U.isHandled=!0,U.status===404&&p.lE.emit(s.r1.alertError,["Dashboard not found"])),U})}else throw new Error("Dashboard uid or slug required");return I.then(U=>(o.A.addDashboardImpression(U.dashboard.uid),U)),I}loadSnapshot(O){const R=(0,l.s)().getSnapshot(O);return R.then(L=>(o.A.addDashboardImpression(L.dashboard.uid),L)),R}}class P extends v{loadDashboard(O,R,L,B){const F=(0,m.sP)("v2");let I;if(O==="script"&&R)I=this.loadScriptedDashboard(R).then(U=>h.Op.ensureV2Response(U));else if(O==="public"&&L)I=g.IB.getPublicDashboardByUid(L).then(U=>h.Op.ensureV2Response(U));else if(L){if(!B){const U=F.getDashboardFromCache(L);if(U)return Promise.resolve(U)}I=(0,D.n)("v2").getDashboardDTO(L,B).catch(U=>{throw console.error("Failed to load dashboard",U),(0,d.NF)(U)&&(U.isHandled=!0,U.status===404&&p.lE.emit(s.r1.alertError,["Dashboard not found"])),U})}else throw new Error("Dashboard uid or slug required");return I.then(U=>(o.A.addDashboardImpression(U.metadata.name),U)),I}loadSnapshot(O){const R=(0,l.s)().getSnapshot(O).then(L=>h.Op.ensureV2Response(L));return R.then(L=>(o.A.addDashboardImpression(L.metadata.name),L)),R}}let b=new y;const S=M=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},16910:(q,j,e)=>{"use strict";e.d(j,{UA:()=>o});var t=e(52718),n=e(22492),r=e(11817),a=e(75911),i=e(15543),x=e(91830),s=e(36503),c=e(57398);class d{constructor(){this.onRemovePanel=m=>{const f=this.getCurrent();f&&(0,c.FC)(f,f.getPanelById(m),!0)},n.l.subscribe(x.Vz,m=>this.onRemovePanel(m.payload))}create(m,f){return new s.G(m,f)}setCurrent(m){this.dashboard=m}getCurrent(){return this.dashboard}saveJSONDashboard(m){const f=JSON.parse(m);return(0,i.n)().saveDashboard({dashboard:f,folderUid:this.dashboard?.meta.folderUid||f.folderUid})}saveDashboard(m,f){return(0,i.n)().saveDashboard({message:m.message,folderUid:m.folderUid,dashboard:m.dashboard.getSaveModelClone(),showErrorAlert:f?.showErrorAlert})}starDashboard(m,f){const p=(0,a.AI)(),h={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+m,method:f?"DELETE":"POST"};return p.request(h).then(()=>{const D=!f;this.dashboard?.uid===m&&(this.dashboard.meta.isStarred=D);const C=D?(0,r.t)("notifications.starred-dashboard","Dashboard starred"):(0,r.t)("notifications.unstarred-dashboard","Dashboard unstarred");return n.l.emit(t.r1.alertSuccess,[C]),D})}}let u;function g(E){u=E}function o(){return u||(u=new d),u}},77274:(q,j,e)=>{"use strict";e.d(j,{s:()=>d});var t=e(75505),n=e(81160),r=e(28082),a=e(32370),i=e(87638),x=e(77855);const s={create:u=>(0,r.AI)().post("/api/snapshots",u),getSnapshots:()=>(0,r.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,r.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:u=>(0,r.AI)().delete("/api/snapshots/"+u),getSnapshot:async u=>{try{const g=await(0,r.AI)().get("/api/snapshots/"+u);return g.meta.canShare=!1,g}catch(g){throw g}}};class c{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${(0,x.G)()}/dashboardsnapshots`}async create(g){return(0,r.AI)().post(this.url+"/create",g)}async getSnapshots(){return(await(0,r.AI)().get(this.url)).items.map(o=>({key:o.metadata.name,name:o.spec.title,external:o.spec.externalUrl!=null,externalUrl:o.spec.externalUrl}))}deleteSnapshot(g){return(0,r.AI)().delete(this.url+"/"+g)}async getSharingOptions(){return(0,r.AI)().get("/api/snapshot/shared-options")}async getSnapshot(g){const o={};if(!i.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const E=`??? TODO, get anon token for snapshots (${i.TP.user?.name}) ???`;o.Authorization=`Bearer ${E}`}return(0,t.s)((0,r.AI)().fetch({url:this.url+"/"+g+"/body",method:"GET",headers:o}).pipe((0,n.T)(E=>({dashboard:E.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function d(){return a.$.featureToggles.kubernetesSnapshots?new c:s}},80757:(q,j,e)=>{"use strict";e.d(j,{jG:()=>v});var t=e(2543),n=e(3202),r=e(55801),a=e(59577),i=e(52718),x=e(30468),s=e(53027),c=e(61034),d=e(22492),u=e(88023),g=e(11817),o=e(61351),E=e(46924),m=e(77818),f=e(91830),p=e(98140);function h({urlRefresh:y,currentRefresh:P,isAllowedIntervalFn:b,minRefreshInterval:S,refreshIntervals:M=p.cb}){if(!y)return P;const O=b(y),R=M.find(L=>L===y);if(!O||!R){const L=S?M.find(F=>F===S):void 0,B=M?.length?M[0]:void 0;return L??B??P}return y||P}class D{constructor(P){this.contextSrv=P,this.timeRangeForUrl=()=>{const b=this.timeRange().raw;return(0,n.Ar)(b.from)&&(b.from=b.from.valueOf().toString()),(0,n.Ar)(b.to)&&(b.to=b.to.valueOf().toString()),b},this.time=(0,r.E2)().raw,this.timeAtLoad=(0,r.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),d.A.subscribe(f.U0,b=>{this.zoomOut(b.payload.scale,b.payload.updateUrl)}),d.A.subscribe(f.Io,b=>{this.shiftTime(b.payload.direction,b.payload.updateUrl)}),d.A.subscribe(f.Rh,b=>{this.makeAbsoluteTime(b.payload.updateUrl)}),d.A.subscribe(f.Bt,()=>{this.copyTimeRangeToClipboard()}),d.A.subscribe(f.VZ,b=>{this.pasteTimeRangeFromClipboard(b.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(P){this.timeModel=P,this.time=P.time,this.refresh=P.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,t.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(P){return this.contextSrv.getValidIntervals(P)}parseTime(){(0,t.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,n.KQ)(this.time.from).utc()),(0,t.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,n.KQ)(this.time.to).utc())}parseUrlParam(P,b){if(P.indexOf("now")!==-1)return P;if(P.length===8){const S=(0,n.yT)(P,"YYYYMMDD");if(S.isValid())return S}else if(P.length===15){const S=(0,n.yT)(P,"YYYYMMDDTHHmmss");if(S.isValid())return S}if(!isNaN(Number(P))){const S=parseInt(P,10);return b?(0,n.oZ)(b,S):(0,n.yT)(S)}return null}getTimeWindow(P,b){const S=parseInt(P,10);let M;return b.match(/^\d+$/)&&parseInt(b,10)?M=parseInt(b,10):M=a.intervalToMs(b),{from:(0,n.yT)(S-M/2),to:(0,n.yT)(S+M/2)}}initTimeFromUrl(){if(u.$W.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const P=s.Ny.getSearch();P.get("time")&&P.get("time.window")&&(this.time=this.getTimeWindow(P.get("time"),P.get("time.window")));const b=this.timeModel?.getTimezone();P.get("from")&&(this.time.from=this.parseUrlParam(P.get("from"),b)||this.time.from),P.get("to")&&(this.time.to=this.parseUrlParam(P.get("to"),b)||this.time.to),P.get("to")&&P.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=h({urlRefresh:P.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:u.$W.minRefreshInterval})}updateTimeRangeFromUrl(){const P=s.Ny.getSearch();if(P.get("left"))return;const b=this.timeRangeForUrl(),S=P.get("from"),M=P.get("to");S&&M?(S!==b.from||M!==b.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(P){this.timeModel&&(this.timeModel.refresh=P),this.stopAutoRefresh();const b=s.Ny.getSearchObject();if(!P){b.refresh&&s.Ny.partial({refresh:null},!0);return}let S=P,M=60*1e3;P===o.SM?M=this.getAutoRefreshInteval().intervalMs:(S=this.contextSrv.getValidInterval(P),M=a.intervalToMs(S)),this.refreshMS=M,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(M),this.refreshTimeModel()},M),b.refresh!==S&&s.Ny.partial({refresh:S},!0)}getAutoRefreshInteval(){const P=window?.innerWidth??2e3;return a.calculateInterval(this.timeRange(),P,u.$W.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(P){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(P),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},P)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(P,b=!0){if((0,t.extend)(this.time,P),(0,n.Ar)(P.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),b===!0){const S=this.timeRangeForUrl(),M=s.Ny.getSearchObject();if(M.from===S.from.toString()&&M.to===S.to.toString())return;M.from=S.from.toString(),M.to=S.to.toString(),s.Ny.partial(M)}this.timeModel?.refresh===o.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(o.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?c.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,m.z)(this.time,this.timeModel)}zoomOut(P,b=!0){const S=this.timeRange(),{from:M,to:O}=(0,E.Zk)(S,P);this.setTime({from:(0,n.yT)(M),to:(0,n.yT)(O)},b)}shiftTime(P,b=!0){const S=this.timeRange(),{from:M,to:O}=(0,E.Wb)(P,S);this.setTime({from:(0,n.yT)(M),to:(0,n.yT)(O)},b)}makeAbsoluteTime(P){const{from:b,to:S}=this.timeRange();this.setTime({from:b,to:S},P)}copyTimeRangeToClipboard(){const{raw:P}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:P.from,to:P.to})),d.A.emit(i.r1.alertSuccess,[(0,g.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(P=!0){const{range:b,isError:S}=await(0,E.zG)();if(S===!0){d.A.emit(i.r1.alertError,[(0,g.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,g.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:b})]);return}const{from:M,to:O}=b;this.setTime({from:M,to:O},P)}isRefreshOutsideThreshold(P,b=.05){const S=this.timeRange();if(x.isMathString(S.raw.from)){const M=S.to.diff(S.from),O=Date.now()-P,R=M*b;return O>=R}return!1}}let C;function l(y){C=y}function v(){return C||(C=new D(o.TP)),C}},5597:(q,j,e)=>{"use strict";e.d(j,{O2:()=>W,SW:()=>A,og:()=>w});var t=e(2543),n=e(79488),r=e(34923),a=e(14964),i=e(61809),x=e(93407),s=e(46399),c=e(65329),d=e(42483),u=e(38075),g=e(63739),o=e(55883),E=e(63738),m=e(98437),f=e(7500),p=e(95547),h=e(71536),D=e(88023),C=e(40828);function l(Z){return Array.from(new Array(Z+1),(te,ae)=>ae).filter(te=>Z%te===0)}var v=e(58410),y=e(10059),P=e(21658),b=e(12332),S=e(5956),M=e(87714),O=e(3917),R=e(44099),L=e(87854);function B(Z,te){const ae=[];if(Z?.statistics&&Z?.statistics.length){Z.statistic=Z.statistics[0];for(const re of Z.statistics.splice(1))ae.push({...Z,statistic:re})}for(const re of ae)re.refId=(0,R.M)(te),delete re.statistics,te.push(re);return delete Z.statistics,ae}function F(Z){const te=[];if(Z&&"statistics"in Z&&Z?.statistics?.length){for(const ae of Z.statistics.splice(1)){const{statistics:re,name:ne,...ce}=Z;te.push({...ce,statistic:ae,name:`${ne} - ${ae}`})}Z.statistic=Z.statistics[0],te.length!==0&&(Z.name=`${Z.name} - ${Z.statistic}`),delete Z.statistics}return te}function I(Z){Z.hasOwnProperty("metricQueryType")||(Z.metricQueryType=L.d$.Search),Z.hasOwnProperty("metricEditorMode")||(Z.metricQueryType===L.d$.Insights?Z.metricEditorMode=L.Rx.Code:Z.metricEditorMode=Z.expression?L.Rx.Code:L.Rx.Builder)}var U=e(63845);n.D.setInit(h.H),n.G.setInit(h.u);const W=41;class A{constructor(te){this.dashboard=te,(0,m.l)()||(0,m.h)(new y.xq)}updateSchema(te){let ae,re,ne,ce;const le=this.dashboard.schemaVersion,he=[];if(this.dashboard.schemaVersion=W,le!==this.dashboard.schemaVersion){if(le<2&&(te.services&&te.services.filter&&(this.dashboard.time=te.services.filter.time,this.dashboard.templating.list=te.services.filter.list||[]),he.push(oe=>(oe.type==="graphite"&&(oe.type="graph"),oe.type!=="graph"||((0,t.isBoolean)(oe.legend)&&(oe.legend={show:oe.legend}),oe.grid&&(oe.grid.min&&(oe.grid.leftMin=oe.grid.min,delete oe.grid.min),oe.grid.max&&(oe.grid.leftMax=oe.grid.max,delete oe.grid.max)),oe.y_format&&(oe.y_formats||(oe.y_formats=[]),oe.y_formats[0]=oe.y_format,delete oe.y_format),oe.y2_format&&(oe.y_formats||(oe.y_formats=[]),oe.y_formats[1]=oe.y2_format,delete oe.y2_format)),oe))),le<3){let oe=this.dashboard.getNextPanelId();he.push(de=>(de.id||(de.id=oe,oe+=1),de))}if(le<4&&he.push(oe=>(oe.type!=="graph"||((0,t.each)(oe.aliasYAxis,(de,me)=>{oe.seriesOverrides=[{alias:me,yaxis:de}]}),delete oe.aliasYAxis),oe)),le<6){const oe=(0,t.find)(te.pulldowns,{type:"annotations"});for(oe&&(this.dashboard.annotations={list:oe.annotations||[]}),ae=0;ae<this.dashboard.templating.list.length;ae++){const de=this.dashboard.templating.list[ae];de.datasource===void 0&&(de.datasource=null),de.type==="filter"&&(de.type="query"),de.type===void 0&&(de.type="query"),de.allFormat===void 0&&delete de.allFormat}}if(le<7&&(te.nav&&te.nav.length&&(this.dashboard.timepicker=te.nav[0]),he.push(oe=>((0,t.each)(oe.targets,de=>{de.refId||(de.refId=oe.getNextQueryLetter&&oe.getNextQueryLetter())}),oe))),le<8&&he.push(oe=>((0,t.each)(oe.targets,de=>{de.fields&&de.tags&&de.groupBy&&(de.rawQuery?(delete de.fields,delete de.fill):(de.select=(0,t.map)(de.fields,me=>{const Pe=[];return Pe.push({type:"field",params:[me.name]}),Pe.push({type:me.func,params:[]}),me.mathExpr&&Pe.push({type:"math",params:[me.mathExpr]}),me.asExpr&&Pe.push({type:"alias",params:[me.asExpr]}),Pe}),delete de.fields,(0,t.each)(de.groupBy,me=>{me.type==="time"&&me.interval&&(me.params=[me.interval],delete me.interval),me.type==="tag"&&me.key&&(me.params=[me.key],delete me.key)}),de.fill&&(de.groupBy.push({type:"fill",params:[de.fill]}),delete de.fill)))}),oe)),le<9&&he.push(oe=>{if(oe.type!=="singlestat"&&oe.thresholds!=="")return oe;if(oe.thresholds){const de=oe.thresholds.split(",");de.length>=3&&(de.shift(),oe.thresholds=de.join(","))}return oe}),le<10&&he.push(oe=>(oe.type!=="table"||(0,t.each)(oe.styles,de=>{if(de.thresholds&&de.thresholds.length>=3){const me=de.thresholds;me.shift(),de.thresholds=me}}),oe)),le<12&&(0,t.each)(this.dashboard.getVariables(),oe=>{"refresh"in oe&&(oe.refresh&&(oe.refresh=1),oe.refresh||(oe.refresh=0)),"hideVariable"in oe&&oe.hideVariable?oe.hide=2:"hideLabel"in oe&&oe.hideLabel&&(oe.hide=1)}),le<12&&he.push(oe=>(oe.type!=="graph"||!oe.grid||oe.yaxes||(oe.yaxes=[{show:oe["y-axis"],min:oe.grid.leftMin,max:oe.grid.leftMax,logBase:oe.grid.leftLogBase,format:oe.y_formats[0],label:oe.leftYAxisLabel},{show:oe["y-axis"],min:oe.grid.rightMin,max:oe.grid.rightMax,logBase:oe.grid.rightLogBase,format:oe.y_formats[1],label:oe.rightYAxisLabel}],oe.xaxis={show:oe["x-axis"]},delete oe.grid.leftMin,delete oe.grid.leftMax,delete oe.grid.leftLogBase,delete oe.grid.rightMin,delete oe.grid.rightMax,delete oe.grid.rightLogBase,delete oe.y_formats,delete oe.leftYAxisLabel,delete oe.rightYAxisLabel,delete oe["y-axis"],delete oe["x-axis"]),oe)),le<13&&he.push(oe=>{if(oe.type!=="graph"||!oe.grid)return oe;oe.thresholds||(oe.thresholds=[]);const de={},me={};return oe.grid.threshold1!==null&&(de.value=oe.grid.threshold1,oe.grid.thresholdLine?(de.line=!0,de.lineColor=oe.grid.threshold1Color,de.colorMode="custom"):(de.fill=!0,de.fillColor=oe.grid.threshold1Color,de.colorMode="custom")),oe.grid.threshold2!==null&&(me.value=oe.grid.threshold2,oe.grid.thresholdLine?(me.line=!0,me.lineColor=oe.grid.threshold2Color,me.colorMode="custom"):(me.fill=!0,me.fillColor=oe.grid.threshold2Color,me.colorMode="custom")),(0,t.isNumber)(de.value)&&((0,t.isNumber)(me.value)?de.value>me.value?(de.op=me.op="lt",oe.thresholds.push(de),oe.thresholds.push(me)):(de.op=me.op="gt",oe.thresholds.push(de),oe.thresholds.push(me)):(de.op="gt",oe.thresholds.push(de))),delete oe.grid.threshold1,delete oe.grid.threshold1Color,delete oe.grid.threshold2,delete oe.grid.threshold2Color,delete oe.grid.thresholdLine,oe}),le<14&&(this.dashboard.graphTooltip=te.sharedCrosshair?1:0),le<16&&this.upgradeToGridLayout(te),le<17&&he.push(oe=>{if(oe.minSpan){const de=C.cV/oe.minSpan,me=l(C.cV);oe.maxPerRow=me[(0,t.findIndex)(me,Pe=>Pe>de)-1]}return delete oe.minSpan,oe}),le<18&&he.push(oe=>(oe["options-gauge"]&&(oe.options=oe["options-gauge"],oe.options.valueOptions={unit:oe.options.unit,stat:oe.options.stat,decimals:oe.options.decimals,prefix:oe.options.prefix,suffix:oe.options.suffix},oe.options.thresholds&&oe.options.thresholds.reverse(),delete oe.options.options,delete oe.options.unit,delete oe.options.stat,delete oe.options.decimals,delete oe.options.prefix,delete oe.options.suffix,delete oe["options-gauge"]),oe)),le<19&&he.push(oe=>(oe.links&&(0,t.isArray)(oe.links)&&(oe.links=oe.links.map(V)),oe)),le<20){const oe=de=>({...de,url:T(de.url)});he.push(de=>(de.options&&de.options.dataLinks&&(0,t.isArray)(de.options.dataLinks)&&(de.options.dataLinks=de.options.dataLinks.map(oe)),de.options&&de.options.fieldOptions&&de.options.fieldOptions.defaults&&(de.options.fieldOptions.defaults.links&&(0,t.isArray)(de.options.fieldOptions.defaults.links)&&(de.options.fieldOptions.defaults.links=de.options.fieldOptions.defaults.links.map(oe)),de.options.fieldOptions.defaults.title&&(de.options.fieldOptions.defaults.title=T(de.options.fieldOptions.defaults.title))),de))}if(le<21){const oe=de=>({...de,url:de.url.replace(/__series.labels/g,"__field.labels")});he.push(de=>(de.options&&de.options.dataLinks&&(0,t.isArray)(de.options.dataLinks)&&(de.options.dataLinks=de.options.dataLinks.map(oe)),de.options&&de.options.fieldOptions&&de.options.fieldOptions.defaults&&de.options.fieldOptions.defaults.links&&(0,t.isArray)(de.options.fieldOptions.defaults.links)&&(de.options.fieldOptions.defaults.links=de.options.fieldOptions.defaults.links.map(oe)),de))}if(le<22&&he.push(oe=>(oe.type!=="table"||(0,t.each)(oe.styles,de=>{de.align="auto"}),oe)),le<23)for(const oe of this.dashboard.templating.list){if(!(0,P.iv)(oe))continue;const{multi:de,current:me}=oe;(0,r.R)(me)||(oe.current=(0,b.C)(me,de))}if(le<24&&he.push(oe=>{const de=oe.type==="table";if(de&&!oe.styles)return oe;const me=oe.table==="table2";return!de||me||(oe.type=de?"table-old":"table"),oe}),le<25,le<26&&he.push(oe=>(oe.type==="text2"&&(oe.type="text",delete oe.options.angular),oe)),le<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(oe=>{if(!(0,P.VO)(oe))return oe;const de={...oe};return de.current={selected:!0,text:de.query??"",value:de.query??""},de.options=[de.current],de.hide===a.zL.dontHide||de.hide===a.zL.hideLabel?{...de,type:"textbox"}:de})),le<28){he.push(oe=>oe.type==="singlestat"?z(oe):oe);for(const oe of this.dashboard.templating.list)oe.tags&&delete oe.tags,oe.tagsQuery&&delete oe.tagsQuery,oe.tagValuesQuery&&delete oe.tagValuesQuery,oe.useTags&&delete oe.useTags}if(le<29)for(const oe of this.dashboard.templating.list)oe.type==="query"&&(oe.refresh!==1&&oe.refresh!==2&&(oe.refresh=1),oe.options?.length&&(oe.options=[]));if(le<30&&(he.push(G),he.push(ee)),le<31&&he.push(oe=>{if(oe.transformations){for(const de of oe.transformations)if(de.id===o.V.id)return H(oe,o.V.id,{id:E.o.id,options:{}})}return oe}),le<32,le<33&&he.push(oe=>{if(oe.datasource=w(oe.datasource,{returnDefaultAsNull:!0}),!oe.targets)return oe;for(const de of oe.targets){const me=w(de.datasource,{returnDefaultAsNull:!0});me!=null&&(de.datasource=me)}return oe}),le<34&&(he.push(oe=>(this.migrateCloudWatchQueries(oe),oe)),this.migrateCloudWatchAnnotationQuery()),le<35&&he.push(J),le<36){for(const de of this.dashboard.annotations.list)de.datasource=w(de.datasource,{returnDefaultAsNull:!1});const oe=(0,m.l)().getInstanceSettings(null);if(oe){for(const de of this.dashboard.templating.list)de.type==="query"&&de.datasource===null&&(de.datasource=(0,i.p$)(oe));he.push(de=>{if(de.targets){let me=!1;de.datasource==null&&de.targets.length>0&&(de.datasource=(0,i.p$)(oe),me=!0);for(const Pe of de.targets)(Pe.datasource==null||Pe.datasource.uid==null)&&(de.datasource?.uid!==S.uv?Pe.datasource={...de.datasource}:Pe.datasource=w(Pe.datasource,{returnDefaultAsNull:!1})),me&&Pe.datasource?.uid!=="__expr__"&&(de.datasource=Pe.datasource)}return de})}}if(le<37&&he.push(oe=>(oe.options?.legend&&(oe.options.legend.displayMode==="hidden"||oe.options.legend.showLegend===!1)?(oe.options.legend.displayMode="list",oe.options.legend.showLegend=!1):oe.options?.legend&&(oe.options.legend={...oe.options?.legend,showLegend:!0}),oe)),le<38&&he.push(oe=>{if(oe.type==="table"&&oe.fieldConfig!==void 0){const de=oe.fieldConfig.defaults?.custom?.displayMode;if(de!==void 0&&(oe.fieldConfig.defaults.custom.cellOptions=(0,p.o7)(de),delete oe.fieldConfig.defaults.custom.displayMode),oe.fieldConfig?.overrides)for(const me of oe.fieldConfig.overrides)for(let Pe=0;Pe<(me.properties?.length||0);Pe++){let Ee=me.properties[Pe].value;me.properties[Pe].id==="custom.displayMode"&&(me.properties[Pe].id="custom.cellOptions",me.properties[Pe].value=(0,p.o7)(Ee))}}return oe}),le<39&&he.push(oe=>(oe.transformations?.forEach(de=>{if(de.id==="timeSeriesTable"&&de.options!==void 0&&de.options.refIdToStat!==void 0){let me={};for(const[Pe,Ee]of Object.entries(de.options.refIdToStat)){let be={};be.stat=Ee,me[Pe]=be}de.options=me}}),oe)),le<40&&typeof this.dashboard.refresh!="string"&&(this.dashboard.refresh=""),le<41&&"time_options"in this.dashboard.timepicker&&delete this.dashboard.timepicker.time_options,he.length!==0)for(re=0;re<this.dashboard.panels.length;re++)for(ne=0;ne<he.length;ne++){this.dashboard.panels[re]=he[ne].call(this,this.dashboard.panels[re]);const oe=this.dashboard.panels[re].panels;if(oe)for(ce=0;ce<oe.length;ce++)oe[ce]=he[ne].call(this,oe[ce])}}}removeRepeatedPanels(){const te=[];for(const ae of this.dashboard.panels)ae.repeatPanelId||ae.repeatByRow||(ae.type==="row"&&Array.isArray(ae.panels)&&(ae.panels=ae.panels.filter(re=>!re.repeatPanelId)),te.push(ae));this.dashboard.panels=te}migrateCloudWatchQueries(te){for(const ae of te.targets||[])if(X(ae)&&(I(ae),ae.hasOwnProperty("statistics"))){const re=B(ae,[...te.targets]);for(const ne of re)te.targets.push(ne)}}migrateCloudWatchAnnotationQuery(){for(const te of this.dashboard.annotations.list)if(k(te)){const ae=F(te);for(const re of ae)this.dashboard.annotations.list.push(re)}}upgradeToGridLayout(te){let ae=0;const re=C.cV/12;let ce=(0,t.max)((0,t.flattenDeep)((0,t.map)(te.rows,he=>(0,t.map)(he.panels,"id"))))+1;if(!te.rows)return;const le=(0,t.some)(te.rows,he=>he.collapse||he.showTitle||he.repeat);for(const he of te.rows){if(he.repeatIteration)continue;const oe=he.height||C.bJ,de=N(oe),me={};let Pe;le&&(me.id=ce,me.type="row",me.title=he.title,me.collapsed=he.collapse,me.repeat=he.repeat,me.panels=[],me.gridPos={x:0,y:ae,w:C.cV,h:de},Pe=new U.a9(me),ce++,ae++);const Ee=new K(de,C.cV,ae);for(const be of he.panels){be.span=be.span||C.o9,be.minSpan&&(be.minSpan=Math.min(C.cV,C.cV/12*be.minSpan));const Se=Math.floor(be.span)*re,Xe=be.height?N(be.height):de,Qe=Ee.getPanelPosition(Xe,Se);ae=Ee.yPos,be.gridPos={x:Qe.x,y:ae+Qe.y,w:Se,h:Xe},Ee.addPanel(be.gridPos),delete be.span,Pe&&me.collapsed?Pe.panels?.push(be):this.dashboard.panels.push(new U.a9(be))}Pe&&this.dashboard.panels.push(Pe),Pe&&me.collapsed||(ae+=de)}}}function N(Z){return(0,t.isString)(Z)&&(Z=parseInt(Z.replace("px",""),10)),Z<C.cx&&(Z=C.cx),Math.ceil(Z/(C.sD+C.dU))}class K{constructor(te,ae=C.cV,re=0){this.area=new Array(ae).fill(0),this.yPos=re,this.height=te}reset(){this.area.fill(0)}addPanel(te){for(let ae=te.x;ae<te.x+te.w;ae++)(!this.area[ae]||te.y+te.h-this.yPos>this.area[ae])&&(this.area[ae]=te.y+te.h-this.yPos);return this.area}getPanelPosition(te,ae,re=!1){let ne,ce,le;for(let he=this.area.length-1;he>=0&&this.height-this.area[he]>0;he--)if(ce===void 0)ce=he;else if(he<this.area.length-1&&this.area[he]<=this.area[he+1])ne=he;else break;if(ne!==void 0&&ce!==void 0&&ce-ne>=ae-1){const he=(0,t.max)(this.area.slice(ne));le={x:ne,y:he}}else return re?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(te,ae,!0));return le}}function V(Z){let te=Z.url;return!te&&Z.dashboard&&(te=`dashboard/db/${v.A.slugifyForUrl(Z.dashboard)}`),!te&&Z.dashUri&&(te=`dashboard/${Z.dashUri}`),te||(te="/"),Z.keepTime&&(te=x.kM.appendQueryToUrl(te,`$${s.c.keepTime}`)),Z.includeVars&&(te=x.kM.appendQueryToUrl(te,`$${s.c.includeVars}`)),Z.params&&(te=x.kM.appendQueryToUrl(te,Z.params)),{url:te,title:Z.title,targetBlank:Z.targetBlank}}function T(Z){const te=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return Z.replace(te,(ae,re,ne,ce,le,he)=>re?"__series.name":ne?"${__series.name}":ce?"__value.time":le?"__field.name":he?"${__field.name}":ae)}function z(Z){if(D.$W.panels["grafana-singlestat-panel"])return Z.type="grafana-singlestat-panel",Z;let te=!1;return Z.changePlugin||(te=!0,Z=new U.a9(Z)),Z.plugin={angularPanelCtrl:{}},Z.gauge?.show?(M.plugin.meta=D.$W.panels.gauge,Z.changePlugin(M.plugin)):(O.plugin.meta=D.$W.panels.stat,Z.changePlugin(O.plugin)),te?Z.getSaveModel():Z}function w(Z,te){if(te.returnDefaultAsNull&&(Z==null||Z==="default"))return null;if((0,i.fN)(Z))return Z;const ae=(0,m.l)().getInstanceSettings(Z);return ae?(0,i.p$)(ae):{uid:Z||void 0}}function H(Z,te,ae){if(Z.transformations){const re=[];for(const ne of Z.transformations)re.push(ne),ne.id===te&&re.push({...ae});Z.transformations=re}return Z}function G(Z){const te=Z.fieldConfig;if(!te)return Z;if(te.defaults&&te.defaults.mappings&&(te.defaults.mappings=_(te.defaults.mappings,te.defaults.thresholds)),Array.isArray(te.overrides))for(const ae of te.overrides)for(const re of ae.properties)re.id==="mappings"&&(re.value=_(re.value));return Z}function X(Z){return Z.hasOwnProperty("dimensions")&&Z.hasOwnProperty("namespace")&&Z.hasOwnProperty("region")&&Z.hasOwnProperty("metricName")}function k(Z){return Z.hasOwnProperty("dimensions")&&Z.hasOwnProperty("namespace")&&Z.hasOwnProperty("region")&&Z.hasOwnProperty("prefixMatching")&&Z.hasOwnProperty("statistics")}function _(Z,te){if(!Z)return;const ae={type:c.d.ValueToText,options:{}},re=[];for(const ne of Z){if(ne.type&&ne.options){ne.type===c.d.ValueToText?ae.options={...ae.options,...ne.options}:re.push(ne);continue}let ce;const le=parseFloat(ne.text);if(te&&!isNaN(le)){const he=(0,d.yQ)(le,te.steps);he&&he.color&&(ce=he.color)}switch(ne.type){case 1:ne.value!=null&&(ne.value==="null"?re.push({type:c.d.SpecialValue,options:{match:c.W.Null,result:{text:ne.text,color:ce}}}):ae.options[String(ne.value)]={text:ne.text,color:ce});break;case 2:re.push({type:c.d.RangeToText,options:{from:+ne.from,to:+ne.to,result:{text:ne.text,color:ce}}});break}}return Object.keys(ae.options).length>0&&re.unshift(ae),re}function ee(Z){return(Z.type==="timeseries"||Z.type==="xychart"||Z.type==="xychart2")&&Z.options.tooltipOptions&&(Z.options={...Z.options,tooltip:Z.options.tooltipOptions},delete Z.options.tooltipOptions),Z}function J(Z){return Z.type==="timeseries"&&Z.fieldConfig?.defaults.custom?.axisPlacement===f.vM.Hidden&&(Z.fieldConfig={...Z.fieldConfig,overrides:[...Z.fieldConfig.overrides,{matcher:{id:u.Ct.byType,options:g.PU.time},properties:[{id:"custom.axisPlacement",value:f.vM.Auto}]}]}),Z}},36503:(q,j,e)=>{"use strict";e.d(j,{G:()=>F});var t=e(2543),n=e(64423),r=e(10112),a=e(88090),i=e(3202),x=e(86833),s=e(32370),c=e(41090),d=e(40828),u=e(61351),g=e(31788),o=e(54414),E=e(19639),m=e(20138),f=e(58843),p=e(61491),h=e(91830),D=e(87638),C=e(83394),l=e(76802),v=e(2510),y=e(80757),P=e(63845);const b=new Set(["gridPos","title","description","transparent"]);function S(W,A){const N=[],K={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:N};let V=0;const T=new Map;for(let z of A){let{id:w}=z;w||(V||(V=O([W,A])),w=V++,z={...z,id:w}),T.set(w,z)}for(const z of W){const w=T.get(z.id);if(!w){K.changed=!0,K.actions.remove.push(z.id),z.destroy();continue}if(T.delete(z.id),w===z){N.push(z),K.actions.noop.push(z.id);continue}if(z.type===w.type){const G=z.getSaveModel();let X=!0,k=!1;for(const[_,ee]of Object.entries(w))if(!(0,t.isEqualWith)(ee,G[_],M))if(K.changed=!0,X=!1,b.has(_))z[_]=ee,k=!0;else{k=!1;break}if(X){N.push(z),K.actions.noop.push(z.id);continue}if(k){N.push(z),K.actions.update.push(z.id);continue}}z.destroy();const H=new P.a9(w);H.key=`${H.id}-update-${Date.now()}`,N.push(H),K.changed=!0,K.actions.replace.push(z.id)}for(const z of T.values())N.push(new P.a9(z)),K.changed=!0,K.actions.add.push(z.id);return K}function M(W,A){if(W==null&&(A===1/0||A===-1/0||A==null)||A==null&&(W===1/0||W===-1/0||W==null))return!0}function O(W){let A=0;for(const N of W)for(const K of N)K.id>A&&(A=K.id);return A+1}var R=e(5597);function L(W,A){return W.repeatDirection===d.HG?!1:A.gridPos.x>=W.gridPos.x+W.gridPos.w&&A.gridPos.y===W.gridPos.y}function B(W){for(const A of W)if(delete A.scopedVars,A.panels?.length)for(const N of A.panels)delete N.scopedVars}class F{constructor(A,N,K){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=K?.getVariablesFromState??f.SS,this.events=new r.o,this.id=A.id||null,this.uid=A.uid||null,this.revision=A.revision??void 0,this.title=A.title??"No Title",this.description=A.description,this.tags=A.tags??[],this.timezone=A.timezone??"",this.weekStart=A.weekStart??"",this.editable=A.editable!==!1,this.graphTooltip=A.graphTooltip||0,this.time=A.time??{from:"now-6h",to:"now"},this.timepicker=A.timepicker??{},this.liveNow=A.liveNow,this.templating=this.removeNullValuesFromVariables(this.ensureListExist(A.templating)),this.annotations=this.ensureListExist(A.annotations),this.refresh=A.refresh,this.snapshot=A.snapshot,this.schemaVersion=A.schemaVersion??0,this.fiscalYearStartMonth=A.fiscalYearStartMonth??0,this.version=A.version??0,this.links=A.links??[],this.gnetId=A.gnetId||null,this.panels=(0,t.map)(A.panels??[],V=>new P.a9(V)),this.scopeMeta=A.scopeMeta,this.originalDashboard=(0,t.cloneDeep)(A),this.originalTemplating=(0,t.cloneDeep)(this.templating),this.originalTime=(0,t.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(N),this.updateSchema(A),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new n.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(D.lE.subscribe(l.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(D.lE.subscribe(l.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(D.lE.subscribe(l.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(N=>N.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:c.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(A){A=A||{},A.canShare=A.canShare!==!1,A.canSave=A.canSave!==!1,A.canStar=A.canStar!==!1,A.canEdit=A.canEdit!==!1,A.canDelete=A.canDelete!==!1,A.showSettings=A.canEdit,A.canMakeEditable=A.canSave&&!this.editable,A.hasUnsavedFolderChange=!1,this.editable||(A.canEdit=!1,A.canDelete=!1,A.canSave=!1),this.meta=A}getSaveModelCloneOld(A){const N=(0,t.defaults)(A||{},{saveVariables:!0,saveTimerange:!0});let K={};for(const V in this)F.nonPersistedProperties[V]||!this.hasOwnProperty(V)||(K[V]=(0,t.cloneDeep)(this[V]));return K.templating=this.getTemplatingSaveModel(N),N.saveTimerange||(K.time=this.originalTime),K.panels=this.getPanelSaveModels(),K=(0,g.v)(K),K.getVariables=()=>K.templating.list,K}getSaveModelClone(A){const N=this.getSaveModelCloneOld(A),K=JSON.stringify(N);return JSON.parse(K)}updatePanels(A){const N=S(this.panels,A??[]);return N.changed&&(this.panels=N.panels??[],this.sortPanelsByGridPos(),this.events.publish(new h.Q$)),N}getPanelSaveModels(){return this.panels.filter(A=>this.isSnapshotTruthy()||!(A.repeatPanelId||A.repeatedByRow)).map(A=>{if(A.libraryPanel){const{id:N,title:K,libraryPanel:V,gridPos:T}=A;return{id:N,title:K,gridPos:T,libraryPanel:{uid:V.uid,name:V.name}}}return this.panelInEdit&&this.panelInEdit.id===A.id?this.panelInEdit.getSaveModel():A.getSaveModel()}).map(A=>(this.isSnapshotTruthy()||(delete A.scopedVars,A.type==="row"&&A.panels&&A.panels.length>0&&(A.panels=A.panels.filter(N=>!N.repeatPanelId).map(N=>(delete N.scopedVars,N)))),A))}getTemplatingSaveModel(A){const N=this.originalTemplating?.list??[],V=this.getVariablesFromState(this.uid).map(z=>{const w=E.B.get(z.type).getSaveModel(z,A.saveVariables);if(!A.saveVariables){const H=N.find(({name:G,type:X})=>G===z.name&&X===z.type);if(!H)return w;z.type==="adhoc"?w.filters=H.filters:(w.current=H.current,w.options=H.options)}return w});return{list:(0,g.v)(V)}}timeRangeUpdated(A){this.events.publish(new x.sR(A)),(0,C.JD)((0,m.RK)(this.uid,A)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(A={refreshAll:!0,panelIds:[]}){if(this.events.publish(new x._),this.lastRefresh=Date.now(),this.panelInEdit&&(A.refreshAll||A.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const N=this.panels.filter(K=>!this.otherPanelInFullscreen(K)&&(A.refreshAll||A.panelIds.includes(K.id)));if(!this.isSnapshot())for(const K of N)K.refreshWhenInView=!0;for(const K of N)K.refresh()}render(){this.events.publish(new h.XM);for(const A of this.panels)A.render()}panelInitialized(A){const N=A.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(A)&&!N&&A.refresh()}otherPanelInFullscreen(A){return(this.panelInEdit||this.panelInView)&&!(A.isViewing||A.isEditing)}initEditPanel(A){return(0,y.jG)().stopAutoRefresh(),this.panelInEdit=A.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,y.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(A){this.panelInView=A,this.timeRangeUpdatedDuringEditOrView=!1,A.setIsViewing(!0)}exitViewPanel(A){this.panelInView=void 0,A.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const A=new Set;let N=this.getNextPanelId();for(const K of this.panelIterator())(!K.id||A.has(K.id))&&(K.id=N++),A.add(K.id)}removeNullValuesFromVariables(A){if(!A.list.length)return A;for(const N of A.list)N.current&&(N.current.value===null||Array.isArray(N.current.value)&&N.current.value.includes(null))&&(N.current=void 0);return A}ensureListExist(A={}){return A.list??=[],A}getNextPanelId(){let A=0;for(const N of this.panelIterator())N.id>A&&(A=N.id);return A+1}*panelIterator(){for(const A of this.panels){yield A;const N=A.panels??[];for(const K of N)yield K}}forEachPanel(A){for(let N=0;N<this.panels.length;N++)A(this.panels[N],N)}getPanelById(A,N=!1){if(this.panelInEdit&&this.panelInEdit.id===A)return this.panelInEdit;if(N){for(const K of this.panelIterator())if(K.id===A)return K;return null}else return this.panels.find(K=>K.id===A)??null}canEditPanel(A){return!!(this.meta.canEdit&&A&&!A.repeatPanelId&&A.type!=="row")}canEditPanelById(A){return this.canEditPanel(this.getPanelById(A))}addPanel(A){A.id=this.getNextPanelId(),this.panels.unshift(new P.a9(A)),this.sortPanelsByGridPos(),this.events.publish(new h.Q$)}updateMeta(A){this.meta={...this.meta,...A},this.events.publish(new h.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((A,N)=>A.gridPos.y===N.gridPos.y?A.gridPos.x-N.gridPos.x:A.gridPos.y-N.gridPos.y)}clearUnsavedChanges(A,N){for(const K of this.panels)K.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=A,this.originalTemplating=A.templating,N.saveTimerange&&(this.originalTime=A.time)}hasUnsavedChanges(){return!!this.panels.find(N=>N.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;B(this.panels);const A=this.panels.filter(N=>(!N.repeat||N.repeatedByRow)&&N.repeatPanelId);(0,t.pull)(this.panels,...A),A.map(N=>N.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let A=0;A<this.panels.length;A++){const N=this.panels[A];N.repeat&&this.repeatPanel(N,A)}this.sortPanelsByGridPos(),this.events.publish(new h.Q$)}}cleanUpRowRepeats(A){const N=A.map(V=>V.id),K=A.filter(V=>!V.repeat&&V.repeatPanelId&&N.includes(V.repeatPanelId));(0,t.pull)(A,...K),(0,t.pull)(this.panels,...K)}processRowRepeats(A){if(this.isSnapshotTruthy()||!this.hasVariables())return;let N=A.panels??[];if(!A.collapsed){const K=this.panels.findIndex(V=>V.id===A.id);N=this.getRowPanels(K)}this.cleanUpRowRepeats(N);for(const K of N)if(K.repeat){const V=this.panels.findIndex(T=>T.id===K.id);this.repeatPanel(K,V)}}getPanelRepeatClone(A,N,K){if(N===0)return A;const V=A.getSaveModel();V.id=this.getNextPanelId();const T=new P.a9(V);return this.panels.splice(K+N,0,T),T.repeatPanelId=A.id,T.repeat=void 0,this.panelInView?.id===T.id&&(T.setIsViewing(!0),this.panelInView=T),T}getRowRepeatClone(A,N,K){if(N===0){if(!A.collapsed){const w=this.getRowPanels(K);A.panels=w}return A}const V=new P.a9(A.getSaveModel());let T,z;return A.collapsed?(T=(0,t.cloneDeep)(A.panels)??[],V.panels=T,z=K+N):(T=this.getRowPanels(K),V.panels=T.map(w=>w.getSaveModel()),z=K+(T.length+1)*N),this.panels.splice(z,0,V),this.updateRepeatedPanelIds(V),V}repeatPanel(A,N){const K=this.getPanelRepeatVariable(A);if(!K)return;if(A.type==="row"){this.repeatRow(A,N,K);return}const V=this.getSelectedVariableOptions(K),T=A.maxPerRow||4;let z=0,w=A.gridPos.y;for(let G=0;G<V.length;G++){const X=V[G];let k;k=this.getPanelRepeatClone(A,G,N),k.scopedVars??={},k.scopedVars[K.name]=X,A.repeatDirection===d.Pz?(G>0&&(w+=k.gridPos.h),k.gridPos.y=w):(k.gridPos.w=Math.max(d.cV/V.length,d.cV/T),k.gridPos.x=z,k.gridPos.y=w,z+=k.gridPos.w,z+k.gridPos.w>d.cV&&(z=0,w+=k.gridPos.h))}const H=w-A.gridPos.y;if(H>0){const G=N+V.length;for(const X of this.panels.slice(G))L(A,X)||(X.gridPos.y+=H)}}repeatRow(A,N,K){const V=this.getSelectedVariableOptions(K);for(let T=0;T<V.length;T++){const z=V[T],w=this.getRowRepeatClone(A,T,N);U(w,K,z);const H=this.getRowHeight(w),G=w.panels||[];let X;if(A.collapsed){for(const k of G)U(k,K,z),T>0&&this.updateRepeatedPanelIds(k,!0);w.gridPos.y+=T,X=N+T+1}else{const k=N+(G.length+1)*T+1;G.forEach((_,ee)=>{if(U(_,K,z),T>0){const J=new P.a9(_);this.updateRepeatedPanelIds(J,!0),J.gridPos.y+=H*T,this.panels.splice(k+ee,0,J)}}),w.panels=[],w.gridPos.y+=H*T,X=k+G.length}if(V.length>1)for(const k of this.panels.slice(X))k.gridPos.y+=H}}updateRepeatedPanelIds(A,N){return A.repeatPanelId=A.id,A.id=this.getNextPanelId(),N?A.repeatedByRow=!0:A.repeat=void 0,A}getSelectedVariableOptions(A){let N;return(0,v.ML)(A)?N=A.options.slice(1,A.options.length):N=(0,t.filter)(A.options,{selected:!0}),N}getRowHeight(A){if(!A.panels||A.panels.length===0)return 0;if(A.collapsed)return 1;const N=(0,t.maxBy)(A.panels,({gridPos:K})=>K.y+K.h).gridPos;return N.y+N.h-A.gridPos.y}removePanel(A){this.panels=this.panels.filter(N=>N!==A),A.destroy(),this.events.publish(new h.Q$)}removeRow(A,N){(!N&&A.collapsed||N&&!A.collapsed)&&this.toggleRow(A),this.removePanel(A)}expandRows(){const A=this.panels.filter(N=>N.type==="row"&&N.collapsed);for(const N of A)this.toggleRow(N)}collapseRows(){const A=this.panels.filter(N=>N.type==="row"&&!N.collapsed);for(const N of A)this.toggleRow(N)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(A=>A.hide!==2)||this.annotations.list.some(A=>!A.hide)}getPanelInfoById(A){const N=this.panels.findIndex(K=>K.id===A);return N>=0?{panel:this.panels[N],index:N}:null}duplicatePanel(A){const N=A.getSaveModel();return N.id=this.getNextPanelId(),delete N.repeat,delete N.repeatIteration,delete N.repeatPanelId,delete N.scopedVars,N.alert&&delete N.thresholds,delete N.alert,A.gridPos.x+A.gridPos.w*2<=d.cV?N.gridPos.x+=A.gridPos.w:N.gridPos.y+=A.gridPos.h,this.addPanel(N),N}formatDate(A,N){return(0,a.LE)(A,{format:N,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const A of this.panels)A.destroy()}toggleRow(A){const N=(0,t.indexOf)(this.panels,A);if(!A.collapsed){const z=this.getRowPanels(N);(0,t.pull)(this.panels,...z),A.panels=z.map(w=>w.getSaveModel()),A.collapsed=!0,z.some(w=>w.hasChanged)&&A.configRev++,this.events.publish(new h.Q$);return}A.collapsed=!1;const K=A.panels??[],V=K.some(z=>z.repeat),T=A.repeat;if(K.length>0){const w=(K[0].gridPos.y??A.gridPos.y)-(A.gridPos.y+A.gridPos.h);let H=N+1,G=A.gridPos.y;for(const k of K){if(T){const _=this.getPanelRepeatVariable(A);if(k.scopedVars??={},_){const ee=this.getSelectedVariableOptions(_);k.scopedVars={...k.scopedVars,[_.name]:ee[0]}}}k.gridPos.y??(k.gridPos.y=A.gridPos.y),k.gridPos.y-=w,this.panels.splice(H,0,new P.a9(k)),H+=1,G=Math.max(G,k.gridPos.y+k.gridPos.h)}const X=G-A.gridPos.y-1;for(const k of this.panels.slice(H))k.gridPos.y+=X;A.panels=[],V&&this.processRowRepeats(A)}this.sortPanelsByGridPos(),this.events.publish(new h.Q$)}getRowPanels(A){const N=this.panels.slice(A+1),K=N.findIndex(T=>T.type==="row");return N.slice(0,K>=0?K:this.panels.length)}on(A,N){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(A,N)}off(A,N){console.log("DashboardModel.off is deprecated"),this.events.off(A,N)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(A){return(0,a.fq)(A,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:u.TP?.user?.timezone}updateSchema(A){new R.SW(this).updateSchema(A)}hasTimeChanged(){const{time:A,originalTime:N}=this;return!((0,t.isEqual)(A,N)||(0,t.isEqual)((0,i.KQ)(A?.from),(0,i.KQ)(N?.from))&&(0,t.isEqual)((0,i.KQ)(A?.to),(0,i.KQ)(N?.to)))}autoFitPanels(A,N){const K=Math.max(...this.panels.map(G=>G.gridPos.h+G.gridPos.y)),V=55;let z=A-V-20;N&&(z+=V);const w=Math.floor(z/(d.sD+d.dU)),H=K/w;for(const G of this.panels)G.gridPos.y=Math.round(G.gridPos.y/H)||1,G.gridPos.h=Math.round(G.gridPos.h/H)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(p.CoreEvents.bG)}getPanelByUrlId(A){const N=parseInt(A??"0",10),K=this.panels.filter(V=>V.collapsed);for(const V of K)V.panels?.some(z=>z.id===N)&&this.toggleRow(V);return this.getPanelById(N)}toggleLegendsForAll(){const A=this.panels.filter(I),N=A.filter(T=>T.legend.show).length,K=A.length-N,V=N>=K;for(const T of A)T.legend.show=!V,T.render()}toggleExemplarsForAll(){for(const A of this.panels)for(const N of A.targets){if(!(N.datasource&&N.datasource.type==="prometheus"))continue;const K=N;K.exemplar=!K.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(A){let N=!0;return A?N=!!this.meta.annotationsPermissions?.dashboard.canEdit:N=!!this.meta.annotationsPermissions?.organization.canEdit,(s.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&N}canDeleteAnnotations(A){let N=!0;return A?N=!!this.meta.annotationsPermissions?.dashboard.canDelete:N=!!this.meta.annotationsPermissions?.organization.canDelete,s.$.featureToggles.annotationPermissionUpdate?N:N&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(N=>N.builtIn===1)?.enable===!1?!1:s.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(A,N){!(0,t.isEqual)(A?.gridPos,N?.gridPos)&&this.events.publish(new h.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(A){return this.getVariablesFromState(this.uid).find(N=>N.name===A.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const A=this.originalTemplating?.list??[],N=this.getTemplatingSaveModel({saveVariables:!0}).list;return A.length!==N.length?!1:!(0,t.isEqual)(N,A)}variablesTimeRangeProcessDoneHandler(A){const N=A.payload.variableIds.length>0;this.variablesChangedHandler(new l.og({panelIds:[],refreshAll:!0}),N)}variablesChangedHandler(A,N=!0){if(N&&this.processRepeats(),A.payload.refreshAll||(0,y.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=A.payload.panelIds.filter(K=>K!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(A.payload)}variablesChangedInUrlHandler(A){this.templateVariableValueUpdated(),this.startRefresh(A.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(A=>{const N=(s.$.panels[A.type]?.angular?.detected||P.vI.includes(A.type))&&!s.$.panels[A.type]?.angular?.hideDeprecation;let K=!1;return A.datasource?.uid&&(K=(0,o.Hv)(A.datasource?.uid)),N||K})}}function I(W){return!!W.legend}function U(W,A,N){W.scopedVars??={},W.scopedVars[A.name]=N}},63845:(q,j,e)=>{"use strict";e.d(j,{NB:()=>C,a9:()=>v,tD:()=>l,tw:()=>P,vI:()=>D});var t=e(2543),n=e.n(t),r=e(24726),a=e(10112),i=e(44099),x=e(16753),s=e(27999),c=e(86833),d=e(39736),u=e(88023),g=e(95536),o=e(91830),E=e(16442),m=e(5176);const f={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},p={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},h={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},D=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],C={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},l={"heatmap-new":"heatmap"};class v{constructor(S){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new a.o,this.restoreModel(S),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,r.A)()}restoreModel(S){for(const O in this)f[O]||!this.hasOwnProperty(O)||S[O]||typeof this[O]!="function"&&typeof this[O]!="symbol"&&delete this[O];for(const O in S)this[O]=S[O];const M=(0,m.p)(this);M&&(this.autoMigrateFrom=this.type,this.type=M),(0,t.defaultsDeep)(this,(0,t.cloneDeep)(h)),this.ensureQueryIds()}generateNewKey(){this.key=(0,r.A)()}ensureQueryIds(){if(this.targets&&(0,t.isArray)(this.targets))for(const S of this.targets)S.refId||(S.refId=(0,i.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(S){this.options=S,this.configRev++,this.events.publish(new o.PR),this.render()}updateFieldConfig(S){this.fieldConfig=S,this.configRev++,this.events.publish(new o.PR),this.resendLastResult(),this.render()}getSaveModel(){const S={};for(const M in this)f[M]||!this.hasOwnProperty(M)||(0,t.isEqual)(this[M],h[M])||(S[M]=(0,t.cloneDeep)(this[M]));return this.type==="row"&&this.panels&&this.panels.length>0&&(S.panels=this.panels.map(M=>{if(M.libraryPanel){const{id:O,title:R,libraryPanel:L,gridPos:B}=M;return{id:O,title:R,gridPos:B,libraryPanel:{uid:L.uid,name:L.name}}}return M})),S}setIsViewing(S){this.isViewing=S}updateGridPos(S,M=!0){S.x===this.gridPos.x&&S.y===this.gridPos.y&&S.h===this.gridPos.h&&S.w===this.gridPos.w||(this.gridPos.x=S.x,this.gridPos.y=S.y,this.gridPos.w=S.w,this.gridPos.h=S.h,M&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:S,dashboardTimezone:M,timeData:O,width:R}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelName:this.title,panelPluginId:this.type,dashboardUID:S,timezone:M,timeRange:O.timeRange,timeInfo:O.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(R),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?x.Jk.PanelEditor:this.isViewing?x.Jk.PanelViewer:x.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new c._)}render(){this.hasRefreshed?this.events.publish(new o.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((S,M)=>f[M]||p[M]?S:{...S,[M]:this[M]},{})}restorePanelOptions(S){const M=this.cachedPluginOptions[S];M&&(Object.keys(M.properties).map(O=>{this[O]=M.properties[O]}),this.fieldConfig=(0,s.H9)(this.fieldConfig,M.fieldConfig))}applyPluginOptionDefaults(S,M){const O=(0,s.F)({plugin:S,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:M});this.fieldConfig=O.fieldConfig,this.options=O.options}async pluginLoaded(S){this.plugin=S;const M=y(S);if(this.autoMigrateFrom){const O=C[this.autoMigrateFrom]!=null,R=this.getOptionsToRemember(),L=this.autoMigrateFrom,B=this.type;this.clearPropertiesBeforePluginChange(),this.type=B,this.plugin=S,this.callPanelTypeChangeHandler(S,L,R,O)}if(S.onPanelMigration&&M!==this.pluginVersion){const O=S.onPanelMigration(this);this.options=await O,this.pluginVersion=M}this.applyPluginOptionDefaults(S,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const S in this)p[S]||delete this[S];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,s.aW)(this.fieldConfig.overrides,s.nx)}}callPanelTypeChangeHandler(S,M,O,R){if(S.onPanelTypeChanged){const L=R?{angular:O}:O.options;Object.assign(this.options,S.onPanelTypeChanged(this,M,L,this.fieldConfig))}}changePlugin(S){const M=S.meta.id,O=this.getOptionsToRemember(),R=this.fieldConfig,L=this.type,B=this.isAngularPlugin()||!!C[L];this.cachedPluginOptions[L]={properties:O,fieldConfig:R},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(M),this.callPanelTypeChangeHandler(S,L,O,B),this.type=M,this.plugin=S,this.configRev++,this.applyPluginOptionDefaults(S,!0),S.onPanelMigration&&(this.pluginVersion=y(S))}updateQueries(S){const{dataSource:M}=S;this.datasource=M,this.cacheTimeout=S.cacheTimeout,this.queryCachingTTL=S.queryCachingTTL,this.timeFrom=S.timeRange?.from,this.timeShift=S.timeRange?.shift,this.hideTimeOverride=S.timeRange?.hide,this.interval=S.minInterval,this.maxDataPoints=S.maxDataPoints,this.targets=S.queries,this.configRev++,this.events.publish(new o.zq)}addQuery(S){S=S||{refId:"A"},S.refId=(0,i.M)(this.targets),this.targets.push(S),this.configRev++}changeQuery(S,M){S.refId=this.targets[M].refId,this.configRev++,this.targets=this.targets.map((O,R)=>R===M?S:O)}getEditClone(){const S=this.getSaveModel(),M=new v(S);M.isEditing=!0,M.plugin=this.plugin;const O=this.getQueryRunner();return M.getQueryRunner().useLastResultFrom(O),M}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:u.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new E.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(S){this.transformations=S,this.resendLastResult(),this.configRev++,this.events.publish(new o.JI)}setProperty(S,M){this[S]=M,this.configRev++,S==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(S,M,O){const R=this.getQueryRunner().getLastRequest(),L=Object.assign({},this.scopedVars,R?.scopedVars,M);return(0,d.w)().replace(S,L,O)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(S){for(const[M,O]of Object.entries(S.model)){switch(M){case"id":case"gridPos":case"libraryPanel":continue}this[M]=O}this.libraryPanel=S}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function y(b){return b&&b.meta.info.version?b.meta.info.version:u.Ay.buildInfo.version}function P(b){const S={};return Object.entries(b).filter(([M,O])=>!f[M]&&b.hasOwnProperty(M)&&!(0,t.isEqual)(O,h[M])).forEach(([M,O])=>{S[M]=O}),(0,g.MA)(S)}},94038:(q,j,e)=>{"use strict";e.d(j,{B:()=>r});var t=e(22136),n=e(56276);function r(a){const i={dashboardId:a.id,dashboardName:a.title,dashboardUid:a.uid,folderName:a.meta.folderTitle,eventName:t.n_.DashboardView};(0,n.G$)(i)}},5176:(q,j,e)=>{"use strict";e.d(j,{p:()=>r});var t=e(88023),n=e(63845);function r(a,i){if(n.tD[a.type])return n.tD[a.type];const x=c=>{const d="__feature."+c,g=new URLSearchParams(window.location.search).get(d);return g==="true"||g===""},s=i||!t.Ay.angularSupportEnabled||t.Ay.featureToggles.autoMigrateOldPanels||x("autoMigrateOldPanels")||x("disableAngular");if(a.type==="graph"&&(s||t.Ay.featureToggles.autoMigrateGraphPanel||x("autoMigrateGraphPanel")))return a.xaxis?.mode==="series"?a.legend?.values?"bargauge":"barchart":a.xaxis?.mode==="histogram"?"histogram":"timeseries";if(s)return n.NB[a.type];if(a.type==="table-old"&&(t.Ay.featureToggles.autoMigrateTablePanel||x("autoMigrateTablePanel")))return"table";if(a.type==="grafana-piechart-panel"&&(t.Ay.featureToggles.autoMigratePiechartPanel||x("autoMigratePiechartPanel")))return"piechart";if(a.type==="grafana-worldmap-panel"&&(t.Ay.featureToggles.autoMigrateWorldmapPanel||x("autoMigrateWorldmapPanel")))return"geomap";if((a.type==="singlestat"||a.type==="grafana-singlestat-panel")&&t.Ay.featureToggles.autoMigrateStatPanel||x("autoMigrateStatPanel"))return"stat"}},86983:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>f,O9:()=>d,Ub:()=>E,X1:()=>u,ig:()=>c,p0:()=>g,xS:()=>s});var t=e(65307),n=e(39344),r=e(61491),a=e(36503);const i={initPhase:r.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},x=(0,t.Z0)({name:"dashboard",initialState:i,reducers:{dashboardInitFetching:p=>{p.initPhase=r.DashboardInitPhase.Fetching},dashboardInitServices:p=>{p.initPhase=r.DashboardInitPhase.Services},dashboardInitCompleted:(p,h)=>{p.getModel=()=>h.payload,p.initPhase=r.DashboardInitPhase.Completed},dashboardInitFailed:(p,h)=>{p.initPhase=r.DashboardInitPhase.Failed,p.initError=h.payload,p.getModel=()=>new a.G({...n.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:p=>{p.initPhase=r.DashboardInitPhase.NotStarted,p.initError=null,p.getModel=()=>null},addPanel:(p,h)=>{},setInitialDatasource:(p,h)=>{p.initialDatasource=h.payload}}}),{dashboardInitFetching:s,dashboardInitFailed:c,dashboardInitCompleted:d,dashboardInitServices:u,cleanUpDashboard:g,addPanel:o,setInitialDatasource:E}=x.actions,f={dashboard:x.reducer}},61976:(q,j,e)=>{"use strict";e.d(j,{B1:()=>C,CW:()=>h,LH:()=>c,OK:()=>d,SD:()=>g,VF:()=>o,_u:()=>f,dH:()=>l,ko:()=>D,no:()=>m,s3:()=>E});var t=e(2543),n=e.n(t),r=e(53027),a=e(88023),i=e(40828),x=e(82856),s=e(57398);const c="Panel Title";function d(y,P){const b={type:"timeseries",title:c,gridPos:(0,s.Ft)(y),datasource:P?{uid:P}:null,isNew:!0};return y.addPanel(b),b.id}function u(y,P){const b={type:P,title:"Widget title",gridPos:calculateNewPanelGridPos(y),datasource:null,isNew:!0};return y.addPanel(b),b.id}function g(y){const P={type:"row",title:"Row title",gridPos:{x:0,y:0}};y.addPanel(P)}function o(){r.Ny.push("/dashboard/import")}function E(y){const P={type:"add-library-panel",gridPos:(0,s.Ft)(y)};y.addPanel(P)}function m(y,P){if(!P)return;const b=(0,s.Ft)(y),S={type:P.id,title:c,gridPos:{x:b.x,y:b.y,w:P.defaults.gridPos.w,h:P.defaults.gridPos.h}};P.defaults&&((0,t.defaults)(S,P.defaults),S.title=P.defaults.title,x.A.delete(i.tH)),y.addPanel(S)}function f(){const y=(0,t.chain)(a.Ay.panels).filter({hideFromList:!1}).map(b=>b).value(),P=x.A.get(i.tH);if(P){const b=JSON.parse(P),S=(0,t.find)(y,{id:b.type});if(S){const M=(0,t.cloneDeep)(S);return M.name=b.title,M.sort=-1,{...M,defaults:{...b}}}}}const p="grafana.dashboards.panelEdit.lastUsedDatasource";function h(y){if(x.A.exists(p)){const P=x.A.getObject(p);if(P?.dashboardUid===y)return P}}function D(y){if(!x.A.exists(p))return;const b=x.A.getObject(p)?.datasourceUid??"";v(y,b)}function C(y){x.A.setObject(p,{dashboardUid:y,datasourceUid:""})}function l(y,P){const b=h(y);if(!b)v(y,P);else{const S=b?.dashboardUid??"";v(S,P)}}function v(y,P){x.A.setObject(p,{dashboardUid:y,datasourceUid:P})}},57398:(q,j,e)=>{"use strict";e.d(j,{ET:()=>M,FC:()=>C,Ft:()=>B,KJ:()=>v,Mc:()=>y,ZY:()=>b,d7:()=>P,iU:()=>l,nk:()=>O});var t=e(2543),n=e.n(t),r=e(52718),a=e(59577),i=e(3202),x=e(30468),s=e(39736),c=e(22492),d=e(88023),u=e(40828),g=e(82856),o=e(96464),E=e(63845),m=e(46888),f=e(34741),p=e(65305),h=e(83394),D=e(91830);const C=(F,I,U)=>{if(U!==!1){const W=I.alert?"YES":void 0;c.A.publish(new D.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:W,yesText:"Remove",onConfirm:()=>C(F,I,!1)}));return}F.removePanel(I),(0,h.JD)((0,p.O6)(I.key))},l=(F,I)=>{F.duplicatePanel(I)},v=F=>{let I=F;F instanceof E.a9&&(I=F.getSaveModel()),g.A.set(u.tH,JSON.stringify(I)),c.A.emit(r.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},y=(F,I)=>{c.A.publish(new D.S8({component:o.Zy,props:{dashboard:F,panel:I}}))},P=(F,I)=>{c.A.publish(new D.S8({component:f.o,props:{panel:I,initialFolderUid:F.meta.folderUid,isOpen:!0}}))},b=F=>{c.A.publish(new D.S8({component:m.l,props:{onConfirm:()=>F.unlinkLibraryPanel(),isOpen:!0}}))},S=F=>{F.refresh()},M=F=>{const I={...F.options};I.legend.showLegend===!0?I.legend.showLegend=!1:I.legend.showLegend=!0,F.updateOptions(I)};function O(F,I){const U={timeInfo:"",timeRange:I};if(F.timeFrom){const W=(0,s.w)().replace(F.timeFrom,F.scopedVars),A=a.describeTextRange(W);if(A.invalid)return U.timeInfo="invalid time override",U;if((0,t.isString)(I.raw.from)){const N=(0,i.AN)(I.from).tz(),K=(0,i.AN)(I.to).tz(),V=x.parse(A.from,void 0,N);U.timeInfo=A.display,U.timeRange={from:V,to:x.parse(A.to,void 0,K),raw:{from:A.from,to:A.to}}}}if(F.timeShift){const W=(0,s.w)().replace(F.timeShift,F.scopedVars);if(a.describeTextRange(W).invalid)return U.timeInfo="invalid timeshift",U;const N="-"+W;U.timeInfo+=" timeshift "+N;const K=x.parseDateMath(N,U.timeRange.from,!1),V=x.parseDateMath(N,U.timeRange.to,!0);U.timeRange={from:K,to:V,raw:{from:K,to:V}}}return F.hideTimeOverride&&(U.timeInfo=""),U}function R(F){const U=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return F.maxDataPoints?F.maxDataPoints:Math.ceil(U*(F.gridPos.w/24))}function L(F,I){const U=F.plugin&&F.plugin.noPadding?0:config.theme.panelPadding*2,W=F.hasTitle()?config.theme.panelHeaderHeight:0;return I-W-U-PANEL_BORDER}function B(F){for(const U of F.panelIterator())U.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},77818:(q,j,e)=>{"use strict";e.d(j,{z:()=>r});var t=e(3202),n=e(30468);const r=(a,i)=>{const x={from:(0,t.Ar)(a.from)?(0,t.KQ)(a.from):a.from,to:(0,t.Ar)(a.to)?(0,t.KQ)(a.to):a.to},s=i?i.getTimezone():void 0;return{from:n.parse(x.from,!1,s,i?.fiscalYearStartMonth),to:n.parse(x.to,!0,s,i?.fiscalYearStartMonth),raw:x}}},68131:(q,j,e)=>{"use strict";e.d(j,{Dd:()=>r,GC:()=>a,dM:()=>n,wM:()=>i,z9:()=>s});var t=e(83424);function n(u,g,o){const E=i(u.templating.list),m=a(u.panels.map(f=>f.type));t.c.dashboardInitialized({uid:u.uid,title:u.title,theme:u.style,schemaVersion:u.schemaVersion,version_before_migration:o,panels_count:u.panels.length,...m,...E,settings_nowdelay:u.timepicker.nowDelay,settings_livenow:!!u.liveNow,duration:g,isScene:!1})}function r(u,g){const o=u.getTrackingInformation();t.c.dashboardInitialized({theme:void 0,duration:g,isScene:!0,...o})}function a(u){return u.reduce((g,o)=>(g[d(o)]=1+g[d(o)]||1,g),{})}function i(u){return u.map(g=>g.type).reduce((g,o)=>(g[c(o)]=1+g[c(o)]||1,g),{})}function x(u){switch(u){case"AdhocVariable":return"adhoc";case"CustomVariable":return"custom";case"QueryVariable":return"query";case"IntervalVariable":return"interval";case"ConstantVariable":return"constant";case"DatasourceVariable":return"datasource";case"TextVariable":return"textbox";case"GroupByVariable":return"groupby";default:return}}function s(u){return u.map(g=>x(g.kind)).filter(g=>g!==void 0).reduce((g,o)=>(g[c(o)]=1+g[c(o)]||1,g),{})}const c=u=>`variable_type_${u}_count`,d=u=>`panel_type_${u}_count`},62709:(q,j,e)=>{"use strict";e.d(j,{ZF:()=>i,vI:()=>a,o2:()=>x});var t=e(88483),n=e(4038),r=e(60590);function a(s){return new t.c(c=>{let d=0;s.forEach(u=>{const g=new FileReader;g.readAsArrayBuffer(u),g.onload=()=>{const o=g.result;if(o&&o instanceof ArrayBuffer){const m=new TextDecoder("utf-8").decode(o);if(u.type==="application/json"){const f=JSON.parse(m);c.next({dataFrames:[(0,n.Vc)(f)],file:u})}else c.next({dataFrames:(0,r.Jh)(m),file:u});++d>=s.length&&c.complete()}}})})}const i={"text/plain":[".csv",".txt"],"application/json":[".json"]},x=5e5},84648:(q,j,e)=>{"use strict";e.d(j,{r:()=>c});var t=e(74848),n=e(2567),r=e(54594),a=e(87638),i=e(11817),x=e(61674),s=e(61491);function c({variant:d,onClick:u}){const g=a.TP.hasPermission(s.AccessControlAction.DataSourcesCreate),o=n.I.assureBaseUrl(x.b.DataSourcesNew);return(0,t.jsx)(r.z9,{variant:d||"primary",href:o,disabled:!g,tooltip:g?void 0:"You do not have permission to configure new data sources",onClick:u,target:"_blank",children:(0,t.jsx)(i.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},36479:(q,j,e)=>{"use strict";e.d(j,{A:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(6210),i=e(95015);function x({ds:c,onClick:d,selected:u,description:g,...o}){const E=(0,r.$j)(),m=s(E,c.meta.builtIn);return(0,t.jsxs)(a.Z,{onClick:d,className:(0,n.cx)(m.card,u?m.selected:void 0),...o,children:[(0,t.jsx)(a.Z.Heading,{className:m.heading,children:(0,t.jsxs)("div",{className:m.headingContent,children:[(0,t.jsxs)("span",{className:m.name,children:[c.name," ",c.isDefault?(0,t.jsx)(i.L,{tags:["default"]}):null]}),(0,t.jsx)("small",{className:m.type,children:g||c.meta.name})]})}),(0,t.jsx)(a.Z.Figure,{className:m.logo,children:(0,t.jsx)("img",{src:c.meta.info.logos.small,alt:`${c.meta.name} Logo`})})]},c.uid)}function s(c,d=!1){return{card:(0,n.css)({cursor:"pointer",backgroundColor:"transparent",marginBottom:0,padding:c.spacing(1),"&:hover":{backgroundColor:c.colors.action.hover}}),heading:(0,n.css)({width:"100%",overflow:"hidden","> button":{width:"100%"}}),headingContent:(0,n.css)({color:c.colors.text.secondary,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"}),logo:(0,n.css)({width:"32px",height:"32px",padding:c.spacing(0,1),display:"flex",alignItems:"center","> img":{maxHeight:"100%",minWidth:"24px",filter:`invert(${d&&c.isLight?1:0})`}}),name:(0,n.css)({color:c.colors.text.primary,display:"flex",gap:c.spacing(2)}),type:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",alignItems:"center"}),separator:(0,n.css)({margin:c.spacing(0,1),color:c.colors.border.weak}),selected:(0,n.css)({background:c.colors.action.selected,"&::before":{backgroundImage:c.colors.gradients.brandVertical,borderRadius:c.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:c.spacing(.5),left:0}}),meta:(0,n.css)({display:"block",overflowWrap:"unset",whiteSpace:"nowrap",width:"100%",overflow:"hidden",textOverflow:"ellipsis"})}}},37857:(q,j,e)=>{"use strict";e.d(j,{S:()=>o});var t=e(74848),n=e(22803),r=e(96540),a=e(58779),i=e(39736),x=e(29675),s=e(11817),c=e(4096),d=e(84648),u=e(36479),g=e(37485);function o(h){const D=(0,r.useRef)(null),[C,l]=(0,c.dR)({keyboardEvents:h.keyboardEvents,containerRef:D}),v=(0,x.$j)(),y=p(v,l),{className:P,current:b,onChange:S,enableKeyboardNavigation:M,onClickEmptyStateCTA:O}=h,R=(0,c.Kr)({alerting:h.alerting,annotations:h.annotations,dashboard:h.dashboard,logs:h.logs,metrics:h.metrics,mixed:h.mixed,pluginId:h.pluginId,tracing:h.tracing,type:h.type,variables:h.variables}),[L,B]=(0,c.TX)(),F=h.filter?R.filter(h.filter):R;return(0,t.jsxs)("div",{ref:D,className:(0,n.cx)(P,y.container),"data-testid":a.Tp.components.DataSourcePicker.dataSourceList,children:[F.length===0&&(0,t.jsx)(E,{className:y.emptyState,onClickCTA:O}),F.sort((0,g.Tj)(b,L,f())).map(I=>(0,t.jsx)(u.A,{"data-testid":"data-source-card",ds:I,onClick:()=>{B(I),S(I)},selected:(0,g.Df)(I,b),...M?C:{}},I.uid))]})}function E({className:h,onClickCTA:D}){const C=(0,x.of)(m);return(0,t.jsxs)("div",{className:(0,n.cx)(h,C.container),children:[(0,t.jsx)("p",{className:C.message,children:(0,t.jsx)(s.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,t.jsx)(d.r,{onClick:D})]})}function m(h){return{container:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),message:(0,n.css)({marginBottom:h.spacing(3)})}}function f(){return(0,i.w)().getVariables().filter(D=>D.type==="datasource").map(D=>`\${${D.id}}`)}function p(h,D){return{container:(0,n.css)({display:"flex",flexDirection:"column",padding:h.spacing(.5),[`${D}`]:{backgroundColor:h.colors.background.secondary}}),emptyState:(0,n.css)({height:"100%",flex:1})}}},83678:(q,j,e)=>{"use strict";e.d(j,{p:()=>M});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(56276),x=e(32370),s=e(29675),c=e(25356),d=e(34128),u=e(79784),g=e(99134),o=e(50876),E=e(11817),m=e(62709),f=e(45288),p=e(4096),h=e(84648),D=e(58779),C=e(36479),l=e(37485);function v(R){switch(R){case"grafana":return(0,E.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,E.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,E.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function y({className:R,current:L,onChange:B,tracing:F,dashboard:I,mixed:U,metrics:W,type:A,annotations:N,variables:K,alerting:V,pluginId:T,logs:z,filter:w}){const G=(0,p.Kr)({tracing:F,dashboard:I,mixed:U,metrics:W,type:A,annotations:N,variables:K,alerting:V,pluginId:T,logs:z}).filter(X=>(w?w?.(X):!0)&&!!X.meta.builtIn);return(0,t.jsx)("div",{className:R,"data-testid":D.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:G.map(X=>(0,t.jsx)(C.A,{ds:X,description:v(X.uid),selected:(0,l.Df)(X,L),onClick:()=>B(X)},X.uid))})}var P=e(37857);const b="dashboards_dspickermodal_clicked",S={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function M({tracing:R,dashboard:L,mixed:B,metrics:F,type:I,annotations:U,variables:W,alerting:A,pluginId:N,logs:K,uploadFile:V,filter:T,onChange:z,current:w,onDismiss:H,reportedInteractionFrom:G}){const X=(0,s.of)(O),[k,_]=(0,a.useState)(""),ee=G||"modal",J=()=>{H(),(0,i.rR)(b,{item:S.DISMISS,src:ee})},Z=ce=>{z(ce),(0,i.rR)(b,{item:S.SELECT_DS,ds_type:ce.type,src:ee})},te=(0,a.useMemo)(()=>(0,r.once)(()=>{(0,i.rR)(b,{item:"search",src:ee})}),[ee]),ae=(0,p.ps)("-- Grafana --"),re=(0,f.j)((ce,le)=>{ae&&(z(ae,[ce]),(0,i.rR)(b,{item:S.UPLOAD_FILE,src:ee}),le.length<1&&H())}),ne=({className:ce})=>(0,t.jsx)(y,{className:ce,onChange:Z,current:w,filter:T,variables:W,tracing:R,metrics:F,type:I,annotations:U,alerting:A,pluginId:N,logs:K,dashboard:L,mixed:B});return(0,t.jsxs)(c.a,{title:(0,E.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:X.modal,contentClassName:X.modalContent,onClickBackdrop:J,onDismiss:J,children:[(0,t.jsxs)("div",{className:X.leftColumn,children:[(0,t.jsx)(d.p,{type:"search",autoFocus:!0,className:X.searchInput,value:k,prefix:(0,t.jsx)(u.I,{name:"search"}),placeholder:(0,E.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:ce=>{_(ce.currentTarget.value),te()}}),(0,t.jsxs)(g.P,{children:[(0,t.jsx)(P.S,{onChange:Z,current:w,onClickEmptyStateCTA:()=>(0,i.rR)(b,{item:S.CONFIG_NEW_DS_EMPTY_STATE,src:ee}),filter:ce=>(T?T?.(ce):!0)&&(0,l.Zn)(ce,k)&&!ce.meta.builtIn,variables:W,tracing:R,metrics:F,type:I,annotations:U,alerting:A,pluginId:N,logs:K,dashboard:L,mixed:B}),(0,t.jsx)(ne,{className:X.appendBuiltInDataSourcesList})]})]}),(0,t.jsxs)("div",{className:X.rightColumn,children:[(0,t.jsxs)("div",{className:X.builtInDataSources,children:[(0,t.jsx)("div",{className:X.builtInDataSourcesList,children:(0,t.jsx)(g.P,{children:(0,t.jsx)(ne,{})})}),V&&x.$.featureToggles.editPanelCSVDragAndDrop&&(0,t.jsx)(o.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:m.o2,multiple:!1,accept:m.ZF,onDrop:re},children:(0,t.jsx)(o.wI,{})})]}),(0,t.jsxs)("div",{className:X.newDSSection,children:[(0,t.jsx)("span",{className:X.newDSDescription,children:(0,t.jsx)(E.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,t.jsx)(h.r,{variant:"secondary",onClick:()=>{(0,i.rR)(b,{item:S.CONFIG_NEW_DS,src:ee}),H()}})]})]})]})}function O(R){return{modal:(0,n.css)({width:"80%",height:"80%",maxWidth:"1200px",maxHeight:"900px",[R.breakpoints.down("md")]:{width:"100%"}}),modalContent:(0,n.css)({display:"flex",flexDirection:"row",height:"100%",[R.breakpoints.down("md")]:{flexDirection:"column"}}),leftColumn:(0,n.css)({display:"flex",flexDirection:"column",width:"50%",height:"100%",paddingRight:R.spacing(4),borderRight:`1px solid ${R.colors.border.weak}`,[R.breakpoints.down("md")]:{width:"100%",borderRight:0,paddingRight:0,flex:1,overflowY:"auto"}}),rightColumn:(0,n.css)({display:"flex",flexDirection:"column",width:"50%",height:"100%",justifyItems:"space-evenly",alignItems:"stretch",paddingLeft:R.spacing(4),[R.breakpoints.down("md")]:{width:"100%",paddingLeft:0,flex:0}}),builtInDataSources:(0,n.css)({flex:"1 1",marginBottom:R.spacing(4),[R.breakpoints.down("md")]:{flex:0}}),builtInDataSourcesList:(0,n.css)({[R.breakpoints.down("md")]:{display:"none",marginBottom:0},marginBottom:R.spacing(4)}),appendBuiltInDataSourcesList:(0,n.css)({[R.breakpoints.up("md")]:{display:"none"}}),newDSSection:(0,n.css)({display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",alignItems:"center"}),newDSDescription:(0,n.css)({flex:"1 0",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:R.colors.text.secondary}),searchInput:(0,n.css)({width:"100%",minHeight:"32px",marginBottom:R.spacing(1)})}}},15773:(q,j,e)=>{"use strict";e.d(j,{s:()=>U});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(18828),s=e(85690),c=e(93225),d=e(2543),u=e(96540),g=e(58779),o=e(56276),E=e(29675),m=e(34128),f=e(79784),p=e(75606),h=e(99134),D=e(43908),C=e(54594),l=e(88023),v=e(11817),y=e(51253),P=e(92980),b=e(4096),S=e(37857);function M(T){const{dataSource:z}=T,w=(0,E.$j)(),H=R(w,z?.meta.builtIn);return z?(0,t.jsx)("img",{className:H.pickerDSLogo,alt:`${z.meta.name} logo`,src:z.meta.info.logos.small}):O()}function O(){const T=(0,E.of)(R);return(0,t.jsx)("div",{className:T.pickerDSLogo})}function R(T,z=!1){return{pickerDSLogo:(0,n.css)({height:"20px",width:"20px",filter:`invert(${z&&T.isLight?1:0})`})}}var L=e(83678),B=e(37485);const F="dashboards_dspicker_clicked",I={SEARCH:"search",OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function U(T){const{current:z,onChange:w,hideTextValue:H=!1,width:G,inputId:X,noDefault:k=!1,disabled:_=!1,placeholder:ee="Select data source",...J}=T,Z=(0,E.of)(W,T),[te,ae]=(0,u.useState)(!1),[re,ne]=(0,u.useState)(!1),[ce,le]=(0,u.useState)(""),{onKeyDown:he,keyboardEvents:oe}=(0,y.d)(),de=(0,u.useRef)(null),me=(0,u.useMemo)(()=>(0,d.debounce)(ge=>{(0,o.rR)(F,{item:I.SEARCH,query:ge,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),[]),[Pe,Ee]=(0,u.useState)(),[be,Se]=(0,u.useState)(),Xe=(0,b.ps)(z),Qe=(0,b.ps)("-- Grafana --"),we=!z&&k?void 0:Xe,$e=ce&&te?(0,t.jsx)(O,{}):(0,t.jsx)(M,{dataSource:we}),Fe=[(0,r.cY)(4),(0,r.Ej)({apply({availableHeight:ge,elements:xe}){xe.floating.style.maxHeight=`${Math.max(200,ge-20)}px`,xe.floating.style.minHeight="200px"}}),(0,r.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:Te,floatingStyles:Le}=(0,a.we)({open:te,placement:"bottom-start",onOpenChange:ae,middleware:Fe,whileElementsMounted:i.ll,strategy:"fixed"}),Ge=(0,u.useCallback)(ge=>{Te.setReference(ge),Ee(ge)},[Te]),Me=(0,u.useCallback)(()=>{le(""),ae(!1),Pe?.focus()},[ae,Pe]),{overlayProps:De,underlayProps:Ke}=(0,c.e)({onClose:Me,isDismissable:!0,isOpen:te,shouldCloseOnInteractOutside:ge=>Pe?!Pe.isSameNode(ge):!1},de),{dialogProps:Ie}=(0,x.s)({"aria-label":"Opened data source picker list"},de);function Ne(){ae(!0),Pe?.focus()}function ie(){Qe&&w(Qe,[P.dx])}function ve(ge){ge.key==="Tab"&&!ge.shiftKey&&te&&(ge.preventDefault(),be?.focus()),ge.key==="Tab"&&ge.shiftKey&&te&&Me(),he(ge)}function fe(ge){ge.shiftKey?(ge.preventDefault(),Pe?.focus()):Me()}return(0,u.useEffect)(()=>{const ge=oe.subscribe({next:xe=>{switch(xe?.code){case"ArrowDown":Ne(),xe.preventDefault();break;case"ArrowUp":Ne(),xe.preventDefault();break;case"Escape":Me(),xe.preventDefault();break}}});return()=>ge.unsubscribe()}),(0,t.jsxs)("div",{className:Z.container,"data-testid":g.Tp.components.DataSourcePicker.container,children:[(0,t.jsx)("div",{className:Z.trigger,onClick:()=>{Ne(),(0,o.rR)(F,{item:I.OPEN_DROPDOWN,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},children:(0,t.jsx)(m.p,{id:X||"data-source-picker",className:re?void 0:Z.input,"data-testid":g.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:we?$e:void 0,suffix:(0,t.jsx)(f.I,{name:te?"search":"angle-down"}),placeholder:H?"":(0,B.q7)(we)||ee,onFocus:()=>{ne(!0)},onBlur:()=>{ne(!1)},onKeyDown:ve,value:ce,onChange:ge=>{Ne(),le(ge.currentTarget.value),ge.currentTarget.value&&me(ge.currentTarget.value)},ref:Ge,disabled:_})}),te?(0,t.jsxs)(p.ZL,{children:[(0,t.jsx)("div",{...Ke}),(0,t.jsx)("div",{ref:de,...De,...Ie,children:(0,t.jsx)(A,{...J,style:Le,ref:Te.setFloating,footerRef:Se,current:we,filterTerm:ce,keyboardEvents:oe,onChange:(ge,xe)=>{Me(),ge.uid!==we?.uid&&(w(ge,xe),(0,o.rR)(F,{item:I.SELECT_DS,ds_type:ge.type}))},onClose:Me,onClickAddCSV:ie,onDismiss:Me,onNavigateOutsiteFooter:fe})})]}):null]})}function W(T,z){return{container:(0,n.css)({position:"relative",cursor:z.disabled?"not-allowed":"pointer",width:T.spacing(z.width||"auto")}),trigger:(0,n.css)({cursor:"pointer",pointerEvents:z.disabled?"none":"auto"}),input:(0,n.css)({"input::placeholder":{color:z.disabled?T.colors.action.disabledText:T.colors.text.primary}})}}const A=u.forwardRef((T,z)=>{const{filterTerm:w,onChange:H,onClose:G,onClickAddCSV:X,current:k,filter:_}=T,ee=(0,u.useCallback)(te=>{H(te)},[H]),J=(0,u.useCallback)(()=>{X?.(),G(),(0,o.rR)(F,{item:I.ADD_FILE})},[X,G]),Z=(0,E.of)(N);return(0,t.jsxs)("div",{style:T.style,ref:z,className:Z.container,children:[(0,t.jsx)(h.P,{showScrollIndicators:!0,children:(0,t.jsx)(S.S,{...T,enableKeyboardNavigation:!0,className:Z.dataSourceList,current:k,onChange:ee,filter:te=>(_?_?.(te):!0)&&(0,B.Zn)(te,w),onClickEmptyStateCTA:()=>(0,o.rR)(F,{item:I.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,t.jsx)(s.n1,{children:(0,t.jsx)(K,{...T,onClickAddCSV:J,onChange:ee,onNavigateOutsiteFooter:T.onNavigateOutsiteFooter})})]})});A.displayName="PickerContent";function N(T){return{container:(0,n.css)({display:"flex",flexDirection:"column",background:T.colors.background.elevated,borderRadius:T.shape.radius.default,boxShadow:T.shadows.z3,overflow:"hidden"}),picker:(0,n.css)({background:T.colors.background.secondary}),dataSourceList:(0,n.css)({flex:1}),footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:T.spacing(1.5),borderTop:`1px solid ${T.colors.border.weak}`,backgroundColor:T.colors.background.secondary})}}function K({onClose:T,onChange:z,onClickAddCSV:w,...H}){const G=(0,E.of)(V),X=H.uploadFile&&l.Ay.featureToggles.editPanelCSVDragAndDrop,k=ee=>{ee.key==="Tab"&&H.onNavigateOutsiteFooter(ee)},_=ee=>{ee.key==="Tab"&&ee.shiftKey&&H.onNavigateOutsiteFooter(ee)};return(0,t.jsxs)("div",{className:G.footer,children:[(0,t.jsx)(D.$s,{children:({showModal:ee,hideModal:J})=>(0,t.jsxs)(C.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{T(),ee(L.p,{reportedInteractionFrom:"ds_picker",tracing:H.tracing,dashboard:H.dashboard,mixed:H.mixed,metrics:H.metrics,type:H.type,annotations:H.annotations,variables:H.variables,alerting:H.alerting,pluginId:H.pluginId,logs:H.logs,filter:H.filter,uploadFile:H.uploadFile,current:H.current,onDismiss:J,onChange:(Z,te)=>{z(Z,te),J()}}),(0,o.rR)(F,{item:I.OPEN_ADVANCED_DS_PICKER})},ref:H.footerRef,onKeyDown:X?_:k,children:[(0,t.jsx)(v.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,t.jsx)(f.I,{name:"arrow-right"})]})}),X&&(0,t.jsx)(C.$n,{variant:"secondary",size:"sm",onClick:w,onKeyDown:k,children:"Add csv or spreadsheet"})]})}function V(T){return{footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:T.spacing(1.5),borderTop:`1px solid ${T.colors.border.weak}`,backgroundColor:T.colors.background.secondary})}}},37485:(q,j,e)=>{"use strict";e.d(j,{Df:()=>a,Tj:()=>x,Zn:()=>s,q7:()=>i,tw:()=>c});var t=e(16910),n=e(61976),r=e(5956);function a(d,u){return!d||!u?!1:typeof u=="string"?d.uid===u:d.uid===u.uid}function i(d){if(d){if(typeof d=="string")return`${d} - not found`;if("name"in d)return d.name;if(d.uid)return`${d.uid} - not found`}}function x(d,u,g){return(E,m)=>{const f=E.name.toUpperCase(),p=m.name.toUpperCase();if(d&&a(E,d))return-1;if(d&&a(m,d))return 1;const h=u.indexOf(E.uid),D=u.indexOf(m.uid);if(h>-1&&h>D)return-1;if(D>-1&&D>h)return 1;const C=g.includes(E.uid),l=g.includes(m.uid);return C&&!l?-1:l&&!C||E.meta.builtIn&&!m.meta.builtIn?1:m.meta.builtIn&&!E.meta.builtIn||f<p?-1:1}}function s(d,u=""){return d.name.toLowerCase().includes(u.toLowerCase())}function c(d){if(!d.uid)return;const u=(0,t.UA)().getCurrent()?.uid??"";if(d.uid===r.uv)return(0,n.B1)(u);(0,n.dH)(u,d.uid)}},84641:(q,j,e)=>{"use strict";e.d(j,{I:()=>t});const t={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},4096:(q,j,e)=>{"use strict";e.d(j,{Kr:()=>x,TX:()=>i,dR:()=>c,ps:()=>s});var t=e(96540),n=e(78685),r=e(98437);const a="grafana.features.datasources.components.picker.DataSourceDropDown.history";function i(){const[d=[],u]=(0,n.A)(a,[]),g=(0,t.useCallback)(o=>{o.meta.builtIn||(d.includes(o.uid)?(d.splice(d.findIndex(E=>o.uid===E),1),u([...d,o.uid])):u([...d,o.uid].slice(1,6)))},[d,u]);return[d,g]}function x(d){return(0,r.l)().getList(d)}function s(d){const u=(0,r.l)();return u.getInstanceSettings(d)}function c(d){const{keyboardEvents:u,containerRef:g}=d,o=(0,t.useRef)(0),E="data-role",m="keyboardSelectableItem",f={[E]:m},p=`[${E}="${m}"`,h="data-selectedItem",D=`[${h}="true"]`,C=(0,t.useCallback)(v=>{const y=g?.current?.querySelectorAll(p),P=y?.item(v%y?.length);y?.forEach(b=>b.setAttribute(h,"false")),P&&(P.scrollIntoView({block:"center"}),P.setAttribute(h,"true"))},[g,p]),l=(0,t.useCallback)(()=>{g?.current?.querySelector(D)?.querySelector("button")?.click()},[g,D]);return(0,t.useEffect)(()=>{if(!u)return;const v=u.subscribe({next:y=>{switch(y?.code){case"ArrowDown":{C(++o.current),y.preventDefault();break}case"ArrowUp":o.current=o.current>0?o.current-1:o.current,C(o.current),y.preventDefault();break;case"Enter":l();break}}});return()=>v.unsubscribe()},[u,C,l]),(0,t.useEffect)(()=>{const v=new MutationObserver(y=>{y.some(b=>b.addedNodes&&b.addedNodes.length>0||b.removedNodes&&b.removedNodes.length>0)&&C(0)});return g.current&&v.observe(g.current,{childList:!0}),()=>{v.disconnect()}},[g,p,C]),[f,D]}},26629:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>b,Bs:()=>u,C_:()=>m,E1:()=>x,Gc:()=>c,IJ:()=>h,Ks:()=>D,QZ:()=>l,TN:()=>i,Tk:()=>f,UP:()=>y,eB:()=>o,f$:()=>d,gZ:()=>s,jz:()=>a,lg:()=>v,qR:()=>C,rb:()=>E});var t=e(65307),n=e(39010);const r={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:n.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},a=(0,t.VP)("dataSources/dataSourceLoaded"),i=(0,t.VP)("dataSources/dataSourcesLoad"),x=(0,t.VP)("dataSources/dataSourcesLoaded"),s=(0,t.VP)("dataSources/dataSourceMetaLoaded"),c=(0,t.VP)("dataSources/dataSourcePluginsLoad"),d=(0,t.VP)("dataSources/dataSourcePluginsLoaded"),u=(0,t.VP)("dataSources/setDataSourcesSearchQuery"),g=(0,t.VP)("dataSources/setDataSourcesLayoutMode"),o=(0,t.VP)("dataSources/setDataSourceTypeSearchQuery"),E=(0,t.VP)("dataSources/setDataSourceName"),m=(0,t.VP)("dataSources/setIsDefault"),f=(0,t.VP)("dataSources/setIsSortAscending"),p=(S=r,M)=>i.match(M)?{...S,isLoadingDataSources:!0}:x.match(M)?{...S,isLoadingDataSources:!1,dataSources:M.payload,dataSourcesCount:M.payload.length}:a.match(M)?{...S,dataSource:M.payload}:u.match(M)?{...S,searchQuery:M.payload}:g.match(M)?{...S,layoutMode:M.payload}:c.match(M)?{...S,plugins:[],isLoadingDataSourcePlugins:!0}:d.match(M)?{...S,plugins:M.payload.plugins,categories:M.payload.categories,isLoadingDataSourcePlugins:!1}:o.match(M)?{...S,dataSourceTypeSearchQuery:M.payload}:s.match(M)?{...S,dataSourceMeta:M.payload}:E.match(M)?{...S,dataSource:{...S.dataSource,name:M.payload}}:m.match(M)?{...S,dataSource:{...S.dataSource,isDefault:M.payload}}:f.match(M)?{...S,isSortAscending:M.payload}:S,h={testingStatus:{},loadError:null,loading:!0,plugin:null},D=(0,t.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),C=(0,t.VP)("dataSourceSettings/initDataSourceSettingsFailed"),l=(0,t.VP)("dataSourceSettings/testDataSourceStarting"),v=(0,t.VP)("dataSourceSettings/testDataSourceSucceeded"),y=(0,t.VP)("dataSourceSettings/testDataSourceFailed"),b={dataSources:p,dataSourceSettings:(S=h,M)=>D.match(M)?{...S,plugin:M.payload,loadError:null,loading:!1}:C.match(M)?{...S,plugin:null,loadError:M.payload.message,loading:!1}:l.match(M)?{...S,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:v.match(M)?{...S,testingStatus:{status:M.payload?.status,message:M.payload?.message,details:M.payload?.details}}:y.match(M)?{...S,testingStatus:{status:"error",message:M.payload?.message,details:M.payload?.details}}:S}},74992:()=>{"use strict"},38390:(q,j,e)=>{"use strict";e.d(j,{n:()=>p});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(54594),x=e(77222),s=e(60484),c=e(34128),d=e(52706),u=e(95486),g=e(66631),o=e(24085),E=e(87407),m=e(86142),f=e(56026);const p=C=>{const{value:l,src:v,name:y,placeholder:P,onChange:b,onClear:S,mediaType:M,folderName:O,size:R,color:L,maxFiles:B}=C,F=(0,a.of)(D),I=(0,a.$j)(),U=(0,r.useRef)(null),W=T=>(0,t.jsx)(f.i,{onChange:b,value:l,mediaType:M,folderName:O,maxFiles:B,hidePopper:T.hidePopper});let A=v;!A&&l&&(A=(0,E.D)(l));const N=L&&{fill:I.visualization.getColorByName(L)},K=()=>l&&A?(0,t.jsx)(o.y,{src:A,className:F.icon,style:{...N}}):(0,t.jsx)(i.z9,{variant:"primary",fill:"text",size:"sm",children:"Set icon"}),V=()=>(0,t.jsx)(x.C,{children:(0,t.jsx)(s.I,{label:null,grow:!0,children:(0,t.jsx)(c.p,{value:h(v,y),placeholder:P,readOnly:!0,prefix:A&&(0,t.jsx)(o.y,{src:A,className:F.icon,style:{...N}}),suffix:(0,t.jsx)(i.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:S})})})});return(0,t.jsx)(d.I,{content:W,children:(T,z,w)=>(0,t.jsxs)(t.Fragment,{children:[U.current&&(0,t.jsx)(u.A,{...w,referenceElement:U.current,onMouseEnter:T,onKeyDown:H=>{(0,g.Q)(H,z)},hidePopper:z}),(0,t.jsxs)("div",{ref:U,className:F.pointer,onClick:T,onKeyDown:H=>{H.key==="Enter"&&T()},role:"button",tabIndex:0,children:[R===m.Iy.SMALL&&K(),R===m.Iy.NORMAL&&V()]})]})})};function h(C,l){if(C?.startsWith("public/img/icons")){const v=l?.lastIndexOf(".svg")??0;if(v>0)return l.substring(0,v)}return l}const D=C=>({pointer:(0,n.css)({cursor:"pointer","input[readonly]":{cursor:"pointer"}}),icon:(0,n.css)({verticalAlign:"middle",display:"inline-block",fill:"currentColor",width:"25px"})})},56026:(q,j,e)=>{"use strict";e.d(j,{i:()=>A});var t=e(74848),n=e(22803),r=e(18828),a=e(85690),i=e(93225),x=e(96540),s=e(28082),c=e(29675),d=e(54594),u=e(88023),g=e(86142),o=e(86489),E=e(50876),m=e(24085);function f({secondaryText:K="Drag and drop here or browse"}){const V=(0,c.of)(h);return(0,t.jsxs)("div",{className:V.iconWrapper,children:[(0,t.jsx)("small",{className:V.small,children:K}),(0,t.jsx)(d.$n,{type:"button",icon:"upload",children:"Upload"})]})}const p=({mediaType:K,setFormData:V,setUpload:T,error:z})=>{const w=(0,c.of)(h),[H,G]=(0,x.useState)(!1),[X,k]=(0,x.useState)(""),_=()=>(0,t.jsx)(o.D,{label:"Preview",children:(0,t.jsxs)("div",{className:w.iconPreview,children:[K===g.zu.Icon&&(0,t.jsx)(m.y,{src:X,className:w.img}),K===g.zu.Image&&(0,t.jsx)("img",{src:X,alt:"Preview of the uploaded file",className:w.img})]})}),ee=Z=>{fetch(`/api/storage/delete/upload/${Z.file.name}`,{method:"DELETE"}).catch(te=>console.error("cannot delete file",te))},J=K==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,t.jsx)(E.gH,{readAs:"readAsBinaryString",onFileRemove:ee,options:{accept:J,multiple:!1,onDrop:Z=>{let te=new FormData;te.append("file",Z[0]),k(URL.createObjectURL(Z[0])),G(!0),V(te),T(!0)}},children:z.message!==""&&H?(0,t.jsx)("p",{children:z.message}):H?(0,t.jsx)(_,{}):(0,t.jsx)(f,{})})};function h(K,V){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%"}),dropzone:(0,n.css)({display:"flex",flex:1,flexDirection:"column",alignItems:"center",padding:K.spacing(6),borderRadius:K.shape.radius.default,border:`2px dashed ${K.colors.border.medium}`,backgroundColor:V?K.colors.background.secondary:K.colors.background.primary,cursor:"pointer"}),iconWrapper:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center"}),acceptMargin:(0,n.css)({margin:K.spacing(2,0,1)}),small:(0,n.css)({color:K.colors.text.secondary,marginBottom:K.spacing(2)}),iconContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"80%",alignItems:"center",alignSelf:"center"}),iconPreview:(0,n.css)({width:"238px",height:"198px",border:`1px solid ${K.colors.border.medium}`,display:"flex",alignItems:"center",justifyContent:"center"}),img:(0,n.css)({width:"147px",height:"147px",fill:K.colors.text.primary})}}var D=e(44826),C=e(22560),l=e(10059),v=e(70713),y=e(91793);const P=(0,x.memo)(function(V){const{columnIndex:T,rowIndex:z,style:w,data:H}=V,{cards:G,columnCount:X,onChange:k,selected:_}=H,ee=T+z*X,J=G[ee],Z=(0,c.of)(S);return(0,t.jsx)("div",{style:w,children:J&&(0,t.jsxs)("div",{className:_===J.value?(0,n.cx)(Z.card,Z.selected):Z.card,onClick:()=>k(J.value),onKeyDown:te=>{te.key==="Enter"&&k(J.value)},role:"button",tabIndex:0,children:[J.imgUrl.endsWith(".svg")?(0,t.jsx)(m.y,{src:J.imgUrl,className:Z.img}):(0,t.jsx)("img",{src:J.imgUrl,alt:"",className:Z.img}),(0,t.jsx)("h6",{className:Z.text,children:J.label.slice(0,-4)})]},J.value)})},y.t7),b=K=>{const{onChange:V,cards:T,value:z}=K,w=(0,c.of)(S);return(0,t.jsx)(v.default,{defaultWidth:680,children:({width:H,height:G})=>{const _=Math.floor(H/90),ee=Math.ceil(T.length/_);return(0,t.jsx)(y.yi,{width:H,height:G,columnCount:_,columnWidth:90,rowCount:ee,rowHeight:90,itemData:{cards:T,columnCount:_,onChange:V,selected:z},className:w.grid,children:P})}})},S=K=>({card:(0,n.css)({display:"inline-block",width:"90px",height:"90px",margin:"0.75rem",marginLeft:"15px",textAlign:"center",cursor:"pointer",position:"relative",backgroundColor:"transparent",border:"1px solid transparent",borderRadius:K.shape.radius.default,paddingTop:"6px",":hover":{borderColor:K.colors.action.hover,boxShadow:K.shadows.z2}}),selected:(0,n.css)({border:`2px solid ${K.colors.primary.main}`,":hover":{borderColor:K.colors.primary.main}}),img:(0,n.css)({width:"40px",height:"40px",objectFit:"cover",verticalAlign:"middle",fill:K.colors.text.primary}),text:(0,n.css)({color:K.colors.text.primary,whiteSpace:"nowrap",fontSize:"12px",textOverflow:"ellipsis",display:"block",overflow:"hidden"}),grid:(0,n.css)({border:`1px solid ${K.colors.border.medium}`})}),M=K=>K===g.zu.Icon?[g.Iu.Icon,g.Iu.IOT,g.Iu.Marker]:[g.Iu.BG],O=(K,V)=>K.find(T=>V.startsWith(T.value))??K[0],R=K=>{const{value:V,mediaType:T,folderName:z,newValue:w,setNewValue:H,maxFiles:G}=K,X=(0,c.of)(L),k=M(T).map(le=>({label:le,value:le})),[_,ee]=(0,x.useState)(),[J,Z]=(0,x.useState)(O(k,V?.length?V:z)),[te,ae]=(0,x.useState)([]),[re,ne]=(0,x.useState)([]),ce=le=>{le?(le=le.toLowerCase(),ne(te.filter(he=>he.search.includes(le)))):ne(te)};return(0,x.useEffect)(()=>{const le=J?.value;if(le){const he=T===g.zu.Icon?oe=>oe.name.endsWith(".svg"):oe=>oe.name.endsWith(".png")||oe.name.endsWith(".gif");(0,l.tR)().get("-- Grafana --").then(oe=>{oe.listFiles(le,G).subscribe({next:de=>{const me=[];de.forEach(Pe=>{if(he(Pe)){const Ee=Pe.name.lastIndexOf(".");me.push({value:`${le}/${Pe.name}`,label:Pe.name,search:(Ee?Pe.name.substring(0,Ee):Pe.name).toLowerCase(),imgUrl:`public/${le}/${Pe.name}`})}}),ae(me),ne(me)}})})}},[T,J,G]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.D,{children:(0,t.jsx)(D.l6,{options:k,onChange:Z,value:J,menuShouldPortal:!1})}),(0,t.jsx)(o.D,{children:(0,t.jsx)(C.Z,{value:_??"",placeholder:"Search",onChange:le=>{ce(le),ee(le)}})}),re&&(0,t.jsx)("div",{className:X.cardsWrapper,children:(0,t.jsx)(b,{cards:re,onChange:le=>H(le),value:w})})]})},L=K=>({cardsWrapper:(0,n.css)({height:"30vh",minHeight:"50px",marginTop:"5px",maxWidth:"680px"})});var B=e(34128),F=e(40271),I=e(87407);const U=K=>{const{newValue:V,setNewValue:T,mediaType:z}=K,w=(0,c.of)(W),H=(0,I.D)(V);let G=V?.substring(V.lastIndexOf("/")+1,V.lastIndexOf("."));return G.length>20&&(G=G.substring(0,20)+"..."),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.D,{children:(0,t.jsx)(B.p,{onChange:X=>T(X.currentTarget.value),value:V})}),(0,t.jsxs)("div",{className:w.iconContainer,children:[(0,t.jsx)(o.D,{label:"Preview",children:(0,t.jsxs)("div",{className:w.iconPreview,children:[z===g.zu.Icon&&(0,t.jsx)(m.y,{src:H,className:w.img}),z===g.zu.Image&&V&&(0,t.jsx)("img",{src:H,alt:"Preview of the selected URL",className:w.img})]})}),(0,t.jsx)(F.J,{children:G})]})]})},W=K=>({iconContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"80%",alignItems:"center",alignSelf:"center"}),iconPreview:(0,n.css)({width:"238px",height:"198px",border:`1px solid ${K.colors.border.medium}`,display:"flex",alignItems:"center",justifyContent:"center"}),img:(0,n.css)({width:"147px",height:"147px",fill:K.colors.text.primary})}),A=K=>{const{value:V,onChange:T,mediaType:z,folderName:w,maxFiles:H,hidePopper:G}=K,X=(0,c.of)(N),k=()=>{T(V),G?.()},_=(0,x.useRef)(null),{dialogProps:ee}=(0,r.s)({},_),{overlayProps:J}=(0,i.e)({onClose:k,isDismissable:!0,isOpen:!0},_),Z=V&&V.includes("://"),[te,ae]=(0,x.useState)(V??""),[re,ne]=(0,x.useState)(Z?g.QC.URL:g.QC.Folder),[ce,le]=(0,x.useState)(new FormData),[he,oe]=(0,x.useState)(!1),[de,me]=(0,x.useState)({message:""}),Pe=Qe=>`${X.resourcePickerPopoverTab} ${re===Qe&&X.resourcePickerPopoverActiveTab}`,Ee=()=>(0,t.jsx)(R,{value:V,mediaType:z,folderName:w,newValue:te,setNewValue:ae,maxFiles:H}),be=()=>(0,t.jsx)(U,{newValue:te,setNewValue:ae,mediaType:z}),Se=()=>(0,t.jsx)(p,{mediaType:z,setFormData:le,setUpload:oe,newValue:te,error:de}),Xe=()=>{switch(re){case g.QC.Folder:return Ee();case g.QC.URL:return be();case g.QC.Upload:return Se();default:return Ee()}};return(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{ref:_,...J,...ee,children:(0,t.jsxs)("div",{className:X.resourcePickerPopover,children:[(0,t.jsxs)("div",{className:X.resourcePickerPopoverTabs,children:[(0,t.jsx)("button",{className:Pe(g.QC.Folder),onClick:()=>ne(g.QC.Folder),children:"Folder"}),(0,t.jsx)("button",{className:Pe(g.QC.URL),onClick:()=>ne(g.QC.URL),children:"URL"})]}),(0,t.jsxs)("div",{className:X.resourcePickerPopoverContent,children:[Xe(),(0,t.jsxs)("div",{className:X.buttonRow,children:[(0,t.jsx)(d.$n,{variant:"secondary",onClick:()=>k(),fill:"outline",children:"Cancel"}),(0,t.jsx)(d.$n,{variant:te&&te!==V?"primary":"secondary",onClick:()=>{he?fetch("/api/storage/upload",{method:"POST",body:ce}).then(Qe=>{if(Qe.status>=400){Qe.json().then(we=>me(we));return}else return Qe.json()}).then(Qe=>{(0,s.AI)().get(`api/storage/read/${Qe.path}`).then(()=>ae(`${u.$W.appUrl}api/storage/read/${Qe.path}`)).then(()=>T(`${u.$W.appUrl}api/storage/read/${Qe.path}`)).then(()=>G?.())}).catch(Qe=>console.error(Qe)):(T(te),G?.())},children:"Select"})]})]})]})})})},N=K=>({resourcePickerPopover:(0,n.css)({borderRadius:K.shape.radius.default,boxShadow:K.shadows.z3,background:K.colors.background.primary,border:`1px solid ${K.colors.border.weak}`}),resourcePickerPopoverTab:(0,n.css)({width:"50%",textAlign:"center",padding:K.spacing(1,0),background:K.colors.background.secondary,color:K.colors.text.secondary,fontSize:K.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}}),resourcePickerPopoverActiveTab:(0,n.css)({color:K.colors.text.primary,fontWeight:K.typography.fontWeightMedium,background:K.colors.background.primary}),resourcePickerPopoverContent:(0,n.css)({width:"315px",fontSize:K.typography.bodySmall.fontSize,minHeight:"184px",padding:K.spacing(1),display:"flex",flexDirection:"column"}),resourcePickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${K.shape.radius.default} ${K.shape.radius.default} 0 0`}),buttonRow:(0,n.css)({display:"flex",justifyContent:"center",gap:K.spacing(2),padding:K.spacing(1)})})},73528:(q,j,e)=>{"use strict";e.d(j,{MediaType:()=>t.zu,ResourceFolderName:()=>t.Iu,findField:()=>i.UI,findFieldIndex:()=>i.gG,getColorDimension:()=>x,getPublicOrAbsoluteUrl:()=>m.D,getResourceDimension:()=>m.$,getScalarDimension:()=>p.H,getScaledDimension:()=>c.hX,getTextDimension:()=>o});var t=e(86142),n=e(18752),r=e(42825),a=e(16869),i=e(76066);function x(h,D,C){return s((0,i.UI)(h,D.field),D,C)}function s(h,D,C){if(!h){const y=C.visualization.getColorByName(D.fixed??"grey");return{isAssumed:!!D.field?.length||!D.fixed,fixed:y,value:()=>y,get:P=>y}}const l=(0,n.Qi)(h);if(l.isByValue||h.config.mappings?.length){const y=(0,r.xg)(h,!0);y!==h.config&&(h={...h,config:y},h.state=void 0);const P=(0,a.J)({field:h,theme:C}),b=S=>P(S).color??"#ccc";return{field:h,get:S=>b(h.values[S]),value:()=>b((0,i.sB)(h))}}const v=l.getCalculator(h,C)(0,0);return{fixed:v,value:()=>v,get:y=>v,field:h}}var c=e(509),d=e(63739),u=e(59141),g=e(7500);function o(h,D){const C=D.field?(0,i.UI)(h,D.field):h?.fields.find(l=>l.type===d.PU.string);return E(C,D)}function E(h,D){let C=D.fixed;const l=D.mode??g.RU.Fixed;if(l===g.RU.Fixed)return{isAssumed:!C,fixed:C,value:()=>C,get:y=>C};if(l===g.RU.Template){const y=P=>`TEMPLATE[${D.fixed} // ${P}]`;return h?{field:h,get:P=>y(h.values[P]),value:()=>y((0,i.sB)(h))}:(C=y(""),{isAssumed:!0,fixed:C,value:()=>C,get:P=>C})}if(!h)return{isAssumed:!0,fixed:C,value:()=>C,get:y=>C};let v=y=>(0,u.cN)(h.display(y));return{field:h,get:y=>v(h.values[y]),value:()=>v((0,i.sB)(h))}}var m=e(87407),f=e(74992),p=e(13103)},87407:(q,j,e)=>{"use strict";e.d(j,{$:()=>a,D:()=>r});var t=e(7500),n=e(76066);function r(i){return i?i.indexOf(":/")>0?i:window.__grafana_public_path__+i:""}function a(i,x){const s=x.mode??t.q_.Fixed;if(s===t.q_.Fixed){const u=r(x.fixed);return{isAssumed:!u,fixed:u,value:()=>u,get:g=>u}}const c=(0,n.UI)(i,x.field);if(!c){const u="";return{isAssumed:!0,fixed:u,value:()=>u,get:g=>u}}if(s===t.q_.Mapping){const u=g=>r(`${g}`);return{field:c,get:g=>u(c.values[g]),value:()=>u((0,n.sB)(c))}}const d=u=>{if(c&&c.display){const g=c.display(u).icon;return r(g??"")}return""};return{field:c,get:u=>d(c.values[u]),value:()=>d((0,n.sB)(c))}}},13103:(q,j,e)=>{"use strict";e.d(j,{H:()=>r});var t=e(7500),n=e(76066);function r(i,x){return a((0,n.UI)(i,x?.field),x)}function a(i,x){if(!i){const d=x.fixed??0;return{isAssumed:!!x.field?.length||!x.fixed,fixed:d,value:()=>d,get:()=>d}}let s=d=>d%x.max;return x.mode===t.WQ.Clamped&&(s=d=>d<x.min?x.min:d>x.max?x.max:d),{field:i,get:d=>{const u=i.values[d];return u===null||typeof u!="number"?0:s(u)},value:()=>(0,n.sB)(i)}}},509:(q,j,e)=>{"use strict";e.d(j,{Nn:()=>x,Ru:()=>s,hX:()=>a});var t=e(42825),n=e(7500),r=e(76066);function a(c,d){return i((0,r.UI)(c,d?.field),d)}function i(c,d,u){if(!c){const p=d.fixed??0;return{isAssumed:!!d.field?.length||!d.fixed,fixed:p,value:()=>p,get:()=>p}}const g=(0,t.AP)(c),o=d.max-d.min;if(c.values.length<1||o<=0||g.delta<=0)return{fixed:d.min,value:()=>d.min,get:()=>d.min};let m=p=>d.min+p*o;if(u===n.QH.Quad){const p=Math.PI*(d.max/2)**2,h=Math.PI*(d.min/2)**2,D=p-h;m=C=>{let l=h+D*C;return Math.sqrt(l/Math.PI)*2}}const f=p=>{const h=c.values[p];let D=0;return h!==-1/0&&(D=(h-g.min)/g.delta),D>1?D=1:D<0&&(D=0),m(D)};return{get:f,value:()=>f((0,r.sB)(c)),field:c}}function x(c){return c||(c={min:0,max:1}),c.min==null&&(c.min=0),c.max==null&&(c.max=1),c}function s(c,d){let{min:u,max:g}=x(d);if(c||(c={}),c.max==null&&(c.max=g),c.min==null&&(c.min=u),c.min>c.max){const o=c.max;c.max=c.min,c.min=o}return c.min<u&&(c.min=u),c.max>g&&(c.max=g),c.fixed==null&&(c.fixed=c.min+(c.max-c.min)/2),c.field||(c.fixed>g?c.fixed=g:c.fixed<u&&(c.fixed=u)),c}},86142:(q,j,e)=>{"use strict";e.d(j,{Iu:()=>r,Iy:()=>x,QC:()=>i,nG:()=>n,zu:()=>a});var t=e(7500);const n=Object.freeze({fixed:"",mode:t.RU.Field,field:""});var r=(s=>(s.Icon="img/icons/unicons",s.IOT="img/icons/iot",s.Marker="img/icons/marker",s.BG="img/bg",s))(r||{}),a=(s=>(s.Icon="icon",s.Image="image",s))(a||{}),i=(s=>(s.Folder="folder",s.URL="url",s.Upload="upload",s))(i||{}),x=(s=>(s.SMALL="small",s.NORMAL="normal",s))(x||{})},76066:(q,j,e)=>{"use strict";e.d(j,{B_:()=>d,UI:()=>g,Wb:()=>x,XV:()=>s,b5:()=>c,gG:()=>o,sB:()=>E,wv:()=>u});var t=e(23570),n=e(91357),r=e(32370),a=e(73528),i=e(13103);function x(m,f){if(m?.series&&f.field)for(const p of m.series){const h=(0,a.getColorDimension)(p,f,r.$.theme2);if(!h.isAssumed||m.series.length===1)return h}return(0,a.getColorDimension)(void 0,f,r.$.theme2)}function s(m,f){if(m?.series&&f.field)for(const p of m.series){const h=(0,a.getScaledDimension)(p,f);if(!h.isAssumed||m.series.length===1)return h}return(0,a.getScaledDimension)(void 0,f)}function c(m,f){if(m?.series&&f.field)for(const p of m.series){const h=(0,i.H)(p,f);if(!h.isAssumed||m.series.length===1)return h}return(0,i.H)(void 0,f)}function d(m,f){if(m?.series&&f.field)for(const p of m.series){const h=(0,a.getResourceDimension)(p,f);if(!h.isAssumed||m.series.length===1)return h}return(0,a.getResourceDimension)(void 0,f)}function u(m,f){if(m?.series&&f.field)for(const p of m.series){const h=(0,a.getTextDimension)(p,f);if(!h.isAssumed||m.series.length===1)return h}return(0,a.getTextDimension)(void 0,f)}function g(m,f){const p=o(f,m);return p==null?void 0:m.fields[p]}function o(m,f,p){if(!(!f||!m?.length))for(let h=0;h<f.fields.length;h++){const D=f.fields[h];if(m===D.name)return h;const C=(0,t.Ct)(D,f,p);if(m===C)return h}}function E(m){const f=m.state?.calcs;if(f){const D=f[n.gy.lastNotNull];if(D!=null)return D}const p=m.values;let h=p.length-1;for(;h>=0;){const D=p[h--];if(D!=null)return D}}},75960:(q,j,e)=>{"use strict";e.d(j,{k:()=>P});var t=e(74848),n=e(2543),r=e(96540),a=e(76346),i=e(62931),x=e(47286),s=e(23570),c=e(74958),d=e(47454),u=e(7500),g=e(29675),o=e(90415),E=e(38928),m=e(90968),f=e(49990),p=e(1932);function h(b,S,M){return(0,p.jM)(b,O=>{O.defaults.custom===void 0&&(O.defaults.custom={}),O.defaults.max=M;const{custom:R}=O.defaults;switch(R.stacking===void 0&&(R.stacking={group:"A"}),S){case"lines":R.drawStyle=u.GR.Line,R.stacking.mode=u.gs.None,R.fillOpacity=0;break;case"bars":R.drawStyle=u.GR.Bars,R.stacking.mode=u.gs.None,R.fillOpacity=100;break;case"points":R.drawStyle=u.GR.Points,R.stacking.mode=u.gs.None,R.fillOpacity=0;break;case"stacked_lines":R.drawStyle=u.GR.Line,R.stacking.mode=u.gs.Normal,R.fillOpacity=100,R.axisSoftMin=0;break;case"stacked_bars":R.drawStyle=u.GR.Bars,R.stacking.mode=u.gs.Normal,R.fillOpacity=100,R.axisSoftMin=0;break;default:{const L=S;throw new Error(`Invalid graph-style: ${L}`)}}})}function D(b,S,M){return(0,p.jM)(b,O=>{O.defaults.thresholds=M,O.defaults.custom=O.defaults.custom??{},O.defaults.custom.thresholdsStyle=S})}var C=e(56737),l=e(84596),v=e(2049);function y(b){const[S,{inc:M}]=(0,C.A)(1),O=(0,l.A)(b);return(0,r.useMemo)(()=>{O&&!(0,v.J3)(b,O,v.bW)&&M()},[b,O,M]),S}function P({data:b,height:S,width:M,timeZone:O,timeRange:R,onChangeTime:L,loadingState:B,annotations:F,onHiddenSeriesChanged:I,splitOpenFn:U,graphStyle:W,tooltipDisplayMode:A=u.$N.Single,anchorToZero:N=!1,yAxisMaximum:K,thresholdsConfig:V,thresholdsStyle:T,eventBus:z,vizLegendOverrides:w,toggleLegendRef:H}){const G=(0,g.$j)(),X=(0,r.useMemo)(()=>(0,a.O)((0,E.V)(E.S),"Explore"),[]),[k,_]=(0,r.useState)({defaults:{min:N?0:void 0,max:K||void 0,unit:"short",color:{mode:i.Y.PaletteClassic},custom:{drawStyle:u.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ee=(0,r.useMemo)(()=>{const oe=h(k,W,K);return D(oe,T,V)},[k,W,K,V,T]),J=(0,f.h)(U,R),Z=(0,r.useMemo)(()=>(0,x.we)({fieldConfig:ee,data:b,timeZone:O,replaceVariables:oe=>oe,theme:G,fieldConfigRegistry:X,dataLinkPostProcessor:J}),[X,b,O,G,ee,J]),te=(0,r.useMemo)(()=>(0,x.we)({fieldConfig:{defaults:{},overrides:[]},data:F,timeZone:O,replaceVariables:oe=>oe,theme:G,dataLinkPostProcessor:J}),[F,O,G,J]),ae=y(Z),re=(0,r.useRef)(I),ne=(0,r.useRef)(void 0);(0,r.useEffect)(()=>{if(re.current){const oe=[];Z.forEach(de=>{de.fields.map(Pe=>Pe.config?.custom?.hideFrom?.viz).every(n.identity)&&oe.push((0,s.Ri)(de))}),(ne.current===void 0||!(0,n.isEqual)((0,n.sortBy)(oe),(0,n.sortBy)(ne.current)))&&(ne.current=oe,re.current(oe))}},[Z]);const ce={eventsScope:"explore",eventBus:z,sync:()=>c.y.Off,onToggleSeriesVisibility(oe,de){_((0,m.M)(oe,de,k,b))},dataLinkPostProcessor:J};function le(oe,de){_((0,m.M)(oe,de,k,b))}H&&(H.current=le);const he=(0,r.useMemo)(()=>({tooltip:{mode:A,sort:u.xB.None},legend:{displayMode:u.lm.List,showLegend:!0,placement:"bottom",calcs:[],...w}}),[A,w]);return(0,t.jsx)(o.XF,{value:ce,children:(0,t.jsx)(d.m,{data:{series:Z,timeRange:R,state:B,annotations:te,structureRev:ae},pluginId:"timeseries",title:"",width:M,height:S,onChangeTimeRange:L,timeZone:O,options:he})})}},8174:(q,j,e)=>{"use strict";e.d(j,{y:()=>l});var t=e(74848),n=e(96540),r=e(42941),a=e(96325),i=e(11817),x=e(13388),s=e(19658),c=e(75960),d=e(60641),u=e(61491);const g=u.EXPLORE_GRAPH_STYLES.map(v=>({value:v,label:v[0].toUpperCase()+v.slice(1).replace(/_/," ")}));function o(v){const{graphStyle:y,onChangeGraphStyle:P}=v;return(0,t.jsx)(d.z,{size:"sm",options:g,value:y,onChange:P})}var E=e(82856);const m="grafana.explore.style.graph",f=v=>{store.set(m,v)},p=()=>D(E.A.get(m)),h="lines",D=v=>u.EXPLORE_GRAPH_STYLES.find(P=>P===v)??h,C=20,l=({data:v,eventBus:y,height:P,width:b,timeRange:S,timeZone:M,annotations:O,onChangeTime:R,splitOpenFn:L,thresholdsConfig:B,thresholdsStyle:F,loadingState:I,statusMessage:U})=>{const[W,A]=(0,r.A)(!1),[N,K]=(0,n.useState)(p),V=(0,n.useCallback)(z=>{(0,s.ng)(z),K(z)},[]),T=(0,n.useMemo)(()=>W?v:v.slice(0,C),[v,W]);return(0,t.jsx)(a.NR,{title:(0,i.t)("graph.container.title","Graph"),titleItems:[!W&&C<v.length&&(0,t.jsx)(x.m,{toggleShowAllSeries:A,info:(0,t.jsxs)(i.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:C}," series"]}),buttonLabel:(0,t.jsxs)(i.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:v.length}]}),tooltip:(0,i.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},"disclaimer")].filter(Boolean),width:b,height:P,loadingState:I,statusMessage:U,actions:(0,t.jsx)(o,{graphStyle:N,onChangeGraphStyle:V}),children:(z,w)=>(0,t.jsx)(c.k,{graphStyle:N,data:T,height:w,width:z,timeRange:S,onChangeTime:R,timeZone:M,annotations:O,splitOpenFn:L,loadingState:I,thresholdsConfig:B,thresholdsStyle:F,eventBus:y})})}},13388:(q,j,e)=>{"use strict";e.d(j,{m:()=>s});var t=e(74848),n=e(22803),r=e(29675),a=e(79784),i=e(6736),x=e(54594);function s(d){const{toggleShowAllSeries:u,info:g,tooltip:o,buttonLabel:E}=d,m=(0,r.of)(c);return(0,t.jsxs)("div",{className:m.disclaimer,children:[(0,t.jsxs)("span",{className:m.warningMessage,children:[(0,t.jsx)(a.I,{name:"exclamation-triangle","aria-hidden":"true"}),g]}),(0,t.jsx)(i.m,{content:o,children:(0,t.jsx)(x.$n,{variant:"secondary",size:"sm",onClick:u,children:E})})]},"disclaimer")}const c=d=>({disclaimer:(0,n.css)({label:"series-disclaimer",display:"flex",alignItems:"center",gap:d.spacing(1)}),warningMessage:(0,n.css)({display:"flex",alignItems:"center",gap:d.spacing(.5),color:d.colors.warning.main,fontSize:d.typography.bodySmall.fontSize})})},83605:(q,j,e)=>{"use strict";e.d(j,{a:()=>s,d:()=>c});var t=e(74848),n=e(22803),r=e(15511),a=e(29675),i=e(84657);const x=(d,u)=>({valueNavigation:(0,n.css)({width:i.QH,fontWeight:"bold"}),valueNavigationWrapper:(0,n.css)({display:"flex",justifyContent:"flex-end"}),itemLabelsWrap:(0,n.css)({borderBottom:u?`1px solid ${d.colors.border.medium}`:""})}),s=d=>d.includes(r.gs)?d.replace(r.gs,""):d,c=({valueLabels:d,expanded:u})=>{const g=(0,a.of)(x,u);return(0,t.jsx)("div",{className:g.itemLabelsWrap,children:(0,t.jsx)("div",{className:g.valueNavigationWrapper,children:d.map((o,E)=>(0,t.jsx)("span",{className:g.valueNavigation,children:s(o.name)},o.name))})})}},84657:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>v,QH:()=>p,Jd:()=>h});var t=e(74848),n=e(22803),r=e(73287),a=e(23401),i=e(56276),x=e(29675),s=e(99764),c=e(83605),d=e(15938);const u=(y,P)=>({rowWrapper:(0,n.css)({position:"relative",minWidth:p,paddingRight:"5px"}),rowValue:(0,n.css)({whiteSpace:"nowrap",overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",display:"block",paddingRight:"10px","&::-webkit-scrollbar":{display:"none"},"&:before":{pointerEvents:"none",content:"''",width:"100%",height:"100%",position:"absolute",left:0,top:0,background:`linear-gradient(to right, transparent calc(100% - 25px), ${y.colors.background.primary})`}}),rowValuesWrap:(0,n.css)({paddingLeft:h,width:`calc(${P} * ${p})`,display:"flex"})}),g=({totalNumberOfValues:y,values:P,hideFieldsWithoutValues:b})=>{const S=(0,x.of)(u,y);return(0,t.jsx)("div",{role:"cell",className:S.rowValuesWrap,children:P?.map(M=>b&&(M.value===void 0||M.value===d.M)?null:(0,t.jsx)("span",{className:S.rowWrapper,children:(0,t.jsx)("span",{className:S.rowValue,children:M.value})},M.key))})},o=y=>{const P=y.isDark?"#ce9178":"#a31515",b=y.isDark?"#73bf69":"#56a64b";return{metricName:(0,n.css)({color:b}),metricValue:(0,n.css)({color:P}),expanded:(0,n.css)({display:"block",textIndent:"1em"})}},m=({value:y,index:P,length:b,isExpandedView:S})=>{const M=(0,x.of)(o),O=y.key,R=y.value;return(0,t.jsxs)("span",{className:S?M.expanded:"",children:[(0,t.jsx)("span",{className:M.metricName,children:O}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:M.metricValue,children:R}),(0,t.jsx)("span",{children:'"'}),P<b-1&&(0,t.jsx)("span",{children:", "})]},P)},f="20px",p="80px",h="25px",D=(y,P,b)=>({rowWrapper:(0,n.css)({borderBottom:`1px solid ${y.colors.border.medium}`,display:"flex",position:"relative",paddingLeft:"22px",alignItems:b?"":"center",height:b?"":"100%"}),copyToClipboardWrapper:(0,n.css)({position:"absolute",left:0,bottom:b?"":"0",top:b?"4px":"0",margin:"auto",zIndex:1,height:"16px",width:"16px"}),rowLabelWrapWrap:(0,n.css)({position:"relative",width:`calc(100% - (${P} * ${p}) - ${h})`}),rowLabelWrap:(0,n.css)({whiteSpace:"nowrap",overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",paddingRight:f,"&::-webkit-scrollbar":{display:"none"},"&:after":{pointerEvents:"none",content:"''",width:"100%",height:"100%",position:"absolute",left:0,top:0,background:`linear-gradient(to right, transparent calc(100% - ${f}), ${y.colors.background.primary})`}})});function C(y){let P=[],b=[];for(const S in y)S in y&&y[S]&&!S.includes("Value")?P.push({key:S,value:y[S]}):S in y&&y[S]&&S.includes("Value")&&b.push({key:S,value:y[S]});return{values:b,attributeValues:P}}const v=({listItemData:y,listKey:P,totalNumberOfValues:b,valueLabels:S,isExpandedView:M})=>{const{__name__:O,...R}=y,L=(0,a.Rq)(O),[B,F]=(0,r.A)(),I=S?.length??b,U=(0,x.of)(D,I,M),{values:W,attributeValues:A}=C(R),N=T=>T==="\u221E"||T==="Infinity"?"+Inf":T,K=`${L?O:""}{${L?"":`"${O}", `}${A.map(T=>`${(0,a.Nc)(T.key)}="${N(T.value)}"`)}}`,V=!!(S&&S?.length);return(0,t.jsxs)(t.Fragment,{children:[S!==void 0&&M&&(0,t.jsx)(c.d,{valueLabels:S,expanded:M}),(0,t.jsxs)("div",{className:U.rowWrapper,children:[(0,t.jsx)("span",{className:U.copyToClipboardWrapper,children:(0,t.jsx)(s.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,i.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),F(K)},name:"copy"})}),(0,t.jsx)("span",{role:"cell",className:U.rowLabelWrapWrap,children:(0,t.jsxs)("div",{className:U.rowLabelWrap,children:[L&&(0,t.jsx)("span",{children:O}),(0,t.jsx)("span",{children:"{"}),!L&&O!==""&&(0,t.jsxs)("span",{children:['"',O,'"',", "]}),(0,t.jsx)("span",{children:A.map((T,z)=>(0,t.jsx)(m,{isExpandedView:M,value:T,index:z,length:A.length},z))}),(0,t.jsx)("span",{children:"}"})]})}),(0,t.jsx)(g,{hideFieldsWithoutValues:V,totalNumberOfValues:I,values:W})]},P)]})}},15938:(q,j,e)=>{"use strict";e.d(j,{E:()=>r,M:()=>n});var t=e(59141);const n=" ",r=a=>{const i={},x=[],s=a.fields.filter(u=>!["Time"].includes(u.name));let c=s.find(u=>u.name==="__name__")?.values??[];!c.length&&s.length&&s[0].values.length&&(c=Array(s[0].values.length).fill(""));const d=a.fields.filter(u=>!["__name__"].includes(u.name));return c.forEach(function(u,g){i[u]={};const o=i[u][g]??{};for(const E of d){const m=E.name;if(m!=="Time")if(typeof E?.display=="function"){const f=E?.display(E.values[g]);if(!isNaN(f.numeric))o[m]=f.numeric.toString(10);else{const p=(0,t.cN)(f);p?o[m]=p:m.includes("Value #")&&(o[m]=n)}}else console.warn("Field display method is missing!")}x.push({...o,__name__:u})}),x}},12049:(q,j,e)=>{"use strict";e.d(j,{YZ:()=>c,sz:()=>s,tU:()=>i});var t=e(74848),n=e(96540),r=e(61491),a=e(60225),i=(d=>(d.RichHistory="Query history",d.Starred="Starred",d.Settings="Settings",d))(i||{});const x=(0,n.createContext)({selectedTab:"Query history",setSelectedTab:()=>{},drawerOpened:!1,setDrawerOpened:()=>{}});function s(){return(0,n.useContext)(x)}function c({children:d}){const[u,g]=(0,n.useState)("Query history"),[o,E]=(0,n.useState)(!1),m=(0,r.useSelector)(a.i6);return(0,n.useEffect)(()=>{m&&g(m.starredTabAsFirstTab?"Starred":"Query history")},[m,g]),(0,t.jsx)(x.Provider,{value:{selectedTab:u,setSelectedTab:g,drawerOpened:o,setDrawerOpened:E},children:d})}},59485:(q,j,e)=>{"use strict";e.d(j,{Y:()=>r});var t=e(96540);const n=(0,t.createContext)({openDrawer:()=>{},closeDrawer:()=>{},isDrawerOpen:!1,openAddQueryModal:()=>{},closeAddQueryModal:()=>{},renderSaveQueryButton:()=>null,queryLibraryEnabled:!1});function r(){return(0,t.useContext)(n)}},40816:(q,j,e)=>{"use strict";e.d(j,{g:()=>r});var t=e(74848),n=e(3202);const r=({timeInMs:i,className:x,humanize:s})=>(0,t.jsx)("span",{className:x,children:a(i,s)}),a=(i,x=!1)=>{const s=i/1e3;if(!x)return`${s.toFixed(1)}s`;const c=(0,n.Ah)(s,"seconds"),d=c.hours(),u=c.minutes(),g=c.seconds();return d?`${d}h ${u}m ${g}s`:u?`${u}m ${g}s`:`${g}s`}},56292:(q,j,e)=>{"use strict";e.d(j,{H:()=>I});var t=e(74848),n=e(2543),r=e(96540),a=e(49785),i=e(56276),x=e(86489),s=e(60641),c=e(37e3),d=e(25356),u=e(54594),g=e(93403),o=e(87638),E=e(61491),m=e(2567),f=e(32370),p=e(53027),h=e(82856),D=e(5597),C=(U=>(U.UNKNOWN="unknown-error",U.NAVIGATION="navigation-error",U))(C||{}),l=(U=>(U.FETCH_DASHBOARD="fetch-dashboard",U.SET_DASHBOARD_LS="set-dashboard-ls-error",U))(l||{});function v({panel:U,dashboardUid:W,openInNewTab:A,timeRange:N}){let K={meta:{},dashboard:{title:"",uid:"",panels:[U],schemaVersion:D.O2}};if(N){const T=N.raw;K.dashboard.time={from:typeof T.from=="string"?T.from:T.from.toISOString(),to:typeof T.to=="string"?T.to:T.to.toISOString()}}try{h.A.setObject(E.DASHBOARD_FROM_LS_KEY,K)}catch{return{error:"set-dashboard-ls-error",message:"Could not add panel to dashboard. Please try again."}}const V=y(W);if(A)return!e.g.open(f.$.appUrl+V,"_blank")?(h.A.delete(E.DASHBOARD_FROM_LS_KEY),{error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}):void 0;p.Ny.push(m.I.stripBaseFromUrl(V))}function y(U){return U?`d/${U}`:"dashboard/new"}var P=(U=>(U.NewDashboard="new-dashboard",U.ExistingDashboard="existing-dashboard",U))(P||{});function b({onClose:U,buildPanel:W,timeRange:A,options:N,children:K}){const[V,T]=(0,r.useState)(),{handleSubmit:z,control:w,formState:{errors:H},watch:G}=(0,a.mN)({defaultValues:{saveTarget:"new-dashboard"}}),X=o.TP.hasPermission(E.AccessControlAction.DashboardsCreate),k=o.TP.hasPermission(E.AccessControlAction.DashboardsWrite),_=[];X&&_.push({label:"New dashboard",value:"new-dashboard"}),k&&_.push({label:"Existing dashboard",value:"existing-dashboard"});const ee=_.length>1?G("saveTarget"):_[0].value,J=(Z,te)=>{T(void 0);const ae=te.saveTarget==="existing-dashboard"?te.dashboardUid:void 0,re=W(N);(0,i.rR)("e_2_d_submit",{newTab:Z,saveTarget:te.saveTarget,queries:re.targets});const ne=v({dashboardUid:ae,panel:re,openInNewTab:Z,timeRange:A});if(ne){T(ne);return}U()};return(0,r.useEffect)(()=>{(0,i.rR)("e_2_d_open")},[]),(0,t.jsxs)("form",{children:[K,_.length>1&&(0,t.jsx)(a.xI,{control:w,render:({field:{ref:Z,...te}})=>(0,t.jsx)(x.D,{label:"Target dashboard",description:"Choose where to add the panel.",children:(0,t.jsx)(s.z,{options:_,...te,id:"e2d-save-target"})}),name:"saveTarget"}),ee==="existing-dashboard"&&(0,t.jsx)(a.xI,{render:({field:{ref:Z,value:te,onChange:ae,...re}})=>(0,t.jsx)(x.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:H.dashboardUid?.message,invalid:!!H.dashboardUid,children:(0,t.jsx)(g.b,{...re,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:ne=>ae(ne?.uid)})}),control:w,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),V&&(0,t.jsx)(c.F,{severity:"error",title:"Error adding the panel",children:V.message}),(0,t.jsxs)(d.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{type:"reset",onClick:U,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(u.$n,{type:"submit",variant:"secondary",onClick:z((0,n.partial)(J,!0)),icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(u.$n,{type:"submit",variant:"primary",onClick:z((0,n.partial)(J,!1)),icon:"apps",children:"Open dashboard"})]})]})}function S(U){}var M=e(60225);function O(U,W){let A=[];return U==="table"&&W.panelState?.logs?.columns&&(W.panelState.logs?.labelFieldName&&A.push({id:"extractFields",options:{source:W.panelState.logs.labelFieldName}}),A.push({id:"organize",options:{indexByName:Object.values(W.panelState.logs.columns).reduce((N,K,V)=>({...N,[K]:V}),{}),includeByName:Object.values(W.panelState.logs.columns).reduce((N,K)=>({...N,[K]:!0}),{})}})),A}function R(U){const W=F(U.queries,U.queryResponse,U?.panelState);return{targets:U.queries,type:W,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:U.datasource,transformations:O(W,U)}}const L=U=>!U.hide,B=U=>W=>W.refId===U;function F(U,W,A){for(const{refId:N}of U.filter(L)){const K=B(N);if(W.flameGraphFrames.some(K))return"flamegraph";if(W.graphFrames.some(K))return"timeseries";if(W.logsFrames.some(K))return A?.logs?.visualisationType?A.logs.visualisationType:"logs";if(W.nodeGraphFrames.some(K))return"nodeGraph";if(W.traceFrames.some(K))return"traces";if(W.customFrames.some(K))return W.customFrames.find(K)?.meta?.preferredVisualisationPluginId??"table"}return"table"}function I(U){const{exploreId:W,onClose:A}=U,N=(0,E.useSelector)((0,M.qq)(W)),K=()=>R({datasource:N.datasourceInstance?.getRef(),queries:N.queries,queryResponse:N.queryResponse,panelState:N?.panelsState});return(0,t.jsx)(b,{onClose:A,buildPanel:K,timeRange:N.range,options:void 0})}},24103:(q,j,e)=>{"use strict";e.d(j,{t:()=>r});var t=e(61351),n=e(61491);function r(){const a=t.TP.hasPermission(n.AccessControlAction.DashboardsCreate),i=t.TP.hasPermission(n.AccessControlAction.DashboardsWrite);return a&&!i?"Add panel to new dashboard":i&&!a?"Add panel to existing dashboard":"Add panel to dashboard"}},22099:(q,j,e)=>{"use strict";e.d(j,{s:()=>s});var t=e(74848),n=e(2567),r=e(53027),a=e(25356),i=e(48583),x=e(54594);function s(c){const{onDismiss:d,path:u,title:g}=c,o=()=>{e.g.open(n.I.assureBaseUrl(u),"_blank"),d()},E=()=>r.Ny.push(u);return(0,t.jsxs)(a.a,{title:g,isOpen:!0,onDismiss:d,children:[(0,t.jsx)(i.B,{direction:"column",gap:1,children:(0,t.jsx)("p",{children:"Do you want to proceed in the current tab or open a new tab?"})}),(0,t.jsxs)(a.a.ButtonRow,{children:[(0,t.jsx)(x.$n,{onClick:d,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(x.$n,{type:"submit",variant:"secondary",onClick:o,icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(x.$n,{type:"submit",variant:"primary",onClick:E,icon:"apps",children:"Open"})]})]})}},69531:(q,j,e)=>{"use strict";e.d(j,{w:()=>i});var t=e(74848),n=e(96540),r=e(19224),a=e(32056);function i({extensions:c,onSelect:d}){const{categorised:u,uncategorised:g}=s(c),o=g.length>0&&Object.keys(u).length>0;return(0,t.jsx)(r.W,{children:(0,t.jsxs)(t.Fragment,{children:[Object.keys(u).map(E=>(0,t.jsx)(r.W.Group,{label:(0,a.pL)(E,25),children:x(u[E],d)},E)),o&&(0,t.jsx)(r.W.Divider,{},"divider"),x(g,d)]})})}function x(c,d){return c.map(u=>(0,t.jsx)(r.W.Item,{ariaLabel:u.title,icon:u?.icon||"plug",label:(0,a.pL)(u.title,25),onClick:g=>{if(u.path)return d(u);u.onClick?.(g)}},u.id))}function s(c){return(0,n.useMemo)(()=>{const d=[],u={};for(const g of c){if(!g.category){d.push(g);continue}Array.isArray(u[g.category])||(u[g.category]=[]),u[g.category].push(g)}return{uncategorised:d,categorised:u}},[c])}},49990:(q,j,e)=>{"use strict";e.d(j,{h:()=>r});var t=e(96540),n=e(97414);const r=(a,i)=>(0,t.useMemo)(()=>(0,n.YV)(a,i),[a,i])},9904:(q,j,e)=>{"use strict";e.d(j,{m:()=>k,s:()=>ee});var t=e(96540),n=e(95382),r=e(17687),a=e(61491),i=e(60225),x=e(69502);const s={parse:J=>{if(!J.left&&!J.right)return{to:{left:{datasource:null,queries:[],range:{from:x.k.from,to:x.k.to}},schemaVersion:0},error:!1};let Z,te,ae,re;return typeof J.left=="string"&&([Z,ae]=g(J.left)),typeof J.right=="string"?[te,re]=g(J.right):J.right&&(te=u,re=!0),Z||(Z=u),{to:{schemaVersion:0,left:Z,...te&&{right:te}},error:!!ae||!!re}}},c=(J,...Z)=>Z.some(te=>J.hasOwnProperty(te));var d=(J=>(J[J.RangeFrom=0]="RangeFrom",J[J.RangeTo=1]="RangeTo",J[J.Datasource=2]="Datasource",J[J.SegmentsStart=3]="SegmentsStart",J))(d||{});const u={datasource:null,queries:[],range:x.k};function g(J){let Z;try{Z=JSON.parse(J)}catch{return[u,!0]}if(!Array.isArray(Z))return[{queries:[],range:x.k,...Z},!1];if(Z.length<=3)return[u,!0];const te={from:Z[0],to:Z[1]},ae=Z[2],re=Z.slice(3),ne=re.filter(le=>!c(le,"ui","mode","__panelsState")),ce=re.find(le=>c(le,"__panelsState"))?.__panelsState;return[{datasource:ae,queries:ne,range:te,panelsState:ce},!1]}var o=e(95536),E=e(74171);const m={parse:J=>{if(!J||!J.panes||typeof J.panes!="string")return{to:{schemaVersion:1,panes:{[(0,o.o$)()]:f}},error:!1};let Z;try{Z=JSON.parse(J.panes)}catch{}if(Z==null||typeof Z!="object")return{to:{schemaVersion:1,panes:{[(0,o.o$)()]:f}},error:!0};const te=Object.entries(Z).map(([ae,re])=>[ae,p(re)]).reduce((ae,[re,ne])=>{let ce=re;return(ce.length!==3||/^\d+$/.test(ce)||ce.split("").some(le=>o.WP.indexOf(le)===-1))&&(ce=(0,o.o$)()),{...ae,[ce]:ne}},{});return Object.keys(te).length||(te[(0,o.o$)()]=f),{to:{schemaVersion:1,panes:te},error:!1}},migrate:J=>({schemaVersion:1,panes:{[(0,o.o$)()]:J.left,...J.right&&{[(0,o.o$)()]:J.right}}})},f={datasource:null,queries:[],range:x.k};function p(J){return!J||typeof J!="object"?f:{...f,...(0,E.C)("queries",J)&&Array.isArray(J.queries)&&{queries:J.queries},...(0,E.C)("datasource",J)&&typeof J.datasource=="string"&&{datasource:J.datasource},...(0,E.C)("panelsState",J)&&!!J.panelsState&&typeof J.panelsState=="object"&&{panelsState:J.panelsState},...(0,E.C)("range",J)&&!!J.range&&typeof J.range=="object"&&(0,E.C)("from",J.range)&&(0,E.C)("to",J.range)&&typeof J.range.from=="string"&&typeof J.range.to=="string"&&{range:{from:J.range.from,to:J.range.to}}}}const h=J=>C(J),D=[s,m],C=J=>{const Z=l(J),[te,...ae]=D.slice(Z),{error:re,to:ne}=te.parse(J);return[ae.reduce((le,he)=>he.migrate?he.migrate(le):le,ne),re]};function l(J){return!J||!("schemaVersion"in J)||!J.schemaVersion?0:typeof J.schemaVersion=="number"?J.schemaVersion:typeof J.schemaVersion=="string"?Number.parseInt(J.schemaVersion,10):0}var v=e(2543),y=e(10112),P=e(58450),b=e(3414),S=e(67078),M=e(4149),O=e(45526),R=e(19658),L=e(65627),B=e(8392),F=e(16753),I=e(10059),U=e(5956);const W=(J,Z)=>{const te=!(0,v.isEqual)(Z?.datasource,J?.datasource),ae=!(0,v.isEqual)(Z?.queries,J?.queries),re=!(0,v.isEqual)(Z?.range||x.k,J?.range||x.k),ne=!(0,v.isEqual)(Z?.panelsState,J?.panelsState);return{datasource:te,queries:ae,range:re,panelsState:ne}};async function A(J,Z,te){if(J)try{return await(0,I.tR)().get(J)}catch{}const ae=[...new Set(Z.map(re=>re.datasource).filter(B.zz).map(re=>typeof re=="string"?re:re.uid))];try{if(ae.length>=1){const re=(await Promise.allSettled(ae.map(ne=>(0,I.tR)().get(ne)))).filter(E.s);if(re.length>1)return await(0,I.tR)().get(U.uv);if(re.length===1)return await(0,I.tR)().get(ae[0])}}catch{}return(0,I.tR)().get((0,o.HQ)(te)).catch(()=>(0,I.tR)().get()).catch(()=>{})}function N(J){return{...J.getDefaultQuery?.(F.Jk.Explore),refId:"A",datasource:J.getRef()}}function K(J){return J.name===U.uv}function V(J){return J&&K(J)?Z=>!!Z.datasource:Z=>Z.datasource?typeof Z.datasource=="string"?Z.datasource===J?.uid||Z.datasource===J?.name:Z.datasource.uid===J?.uid:!0}async function T(J){return(await Promise.allSettled(J.map(te=>(0,I.tR)().get(te.datasource).then(ae=>({query:te,ds:ae}))))).filter(E.s).map(({value:te})=>te.query)}function z(J,Z,te){const ae=Object.values(J.panes);if(ae.length>1){const re=ae.some(({range:ne},ce,[{range:le}])=>!(0,v.isEqual)(ne,le));te((0,S.qz)({syncedTimes:!re}))}Object.entries(J.panes).forEach(async([re,ne],ce)=>{const{datasource:le,queries:he,range:oe,panelsState:de}=ne,me=Z[re];if(me!==void 0){const Pe=W(ne,k(me));Promise.resolve().then(async()=>{Pe.datasource&&le&&await te((0,P.wh)({exploreId:re,datasource:le}))}).then(async()=>{Pe.range&&te((0,O.JA)({exploreId:re,rawRange:(0,R.Z9)(oe)})),Pe.queries&&te((0,M.h9)({exploreId:re,queries:(0,L.v)(he)})),(Pe.queries||Pe.range)&&(await te((0,M.hS)(re)),te((0,M.Od)({exploreId:re}))),Pe.panelsState&&de&&te((0,b.fx)({exploreId:re,panelsState:de}))})}else te((0,b.Gd)({exploreId:re,datasource:le||"",queries:(0,L.v)(he),range:(0,R.Z9)(oe),panelsState:de,position:ce,eventBridge:new y.o}))}),Object.keys(Z).filter(re=>!Object.keys(J.panes).includes(re)).forEach(re=>te((0,S.J8)(re)))}function w(J,Z,te,ae,re){ae((0,S.Ve)()),Promise.all(Object.entries(J.panes).map(([ne,{datasource:ce,queries:le,range:he,panelsState:oe}])=>A(ce,le,te).then(de=>Promise.resolve(de?le.length?(0,L.v)(le).filter(V(de)).map(K(de)?v.identity:me=>({...me,datasource:de.getRef()})):(0,I.tR)().get(K(de)?void 0:de.getRef()).then(me=>[N(me)]):[]).then(async me=>{let Pe=await T(me);return!Pe.length&&de&&(Pe=[N(K(de)?await(0,I.tR)().get():de)]),{exploreId:ne,range:he,panelsState:oe,queries:Pe,datasource:de}})))).then(async ne=>{const ce=await Promise.all(ne.map(({exploreId:me,range:Pe,panelsState:Ee,queries:be,datasource:Se})=>ae((0,b.Gd)({exploreId:me,datasource:Se,queries:be,range:(0,R.Z9)(Pe),panelsState:Ee,eventBridge:new y.o})).unwrap()));if(ce.length>1){const me=ce.some(({state:Pe},Ee,[{state:be}])=>!(0,v.isEqual)(Pe.range.raw,be.range.raw));ae((0,S.qz)({syncedTimes:!me}))}const le=ce.reduce((me,{exploreId:Pe,state:Ee})=>({...me,[Pe]:k(Ee)}),{}),he=re.getSearchObject();let oe={};for(const[me,Pe]of Object.entries(he).filter(([Ee])=>!["schemaVersion","panes","orgId","left","right"].includes(Ee)))oe[me]=Pe;const de=new URLSearchParams({schemaVersion:`${J.schemaVersion}`,panes:JSON.stringify(le),orgId:`${te}`,...oe});re.replace({pathname:re.getLocation().pathname,search:de.toString()}),Z.current="done"})}function H(J,Z){return J.current=P.wh.pending.type===Z.type,[S.J8.type,S.ve.fulfilled.type,M.Od.pending.type,O.eM.type,b.fx.type,P.wh.fulfilled.type].includes(Z.type)&&!J.current}function G(J,Z,te,ae){const re=Object.entries(J.panes).reduce((ne,[ce,le])=>le?{...ne,[ce]:k(le)}:ne,{});if(!(0,v.isEqual)(Z.current.panes,JSON.stringify(re))){const ne=!!Z.current.panes&&Object.values(Z.current.panes).filter(Boolean).length===0||te.current==="pending";Z.current={panes:JSON.stringify(re)},ae.partial({panes:Z.current.panes},ne)}}var X=e(93407);function k(J){return{datasource:J.datasourceInstance?.uid||"",queries:J.queries.map(o.w4),range:(0,X.sQ)(J.range.raw),panelsState:_(J.panelsState)}}function _(J){let Z=(0,v.mapValues)(J,te=>(0,v.isObject)(te)?_(te):te);if(Z=(0,v.omitBy)(Z,v.isEmpty),!(0,v.isEmpty)(Z))return Z}function ee(J){const{location:Z}=(0,n.Il)(),te=(0,a.useDispatch)(),ae=(0,a.useSelector)(i.Qb),re=(0,t.useRef)(ae),ne=(0,a.useSelector)(de=>de.user.orgId),ce=(0,t.useRef)(J),le=(0,t.useRef)("notstarted"),he=(0,t.useRef)(!1),{warning:oe}=(0,r._2)();(0,t.useEffect)(()=>{J.panes||(le.current="notstarted",ce.current=J)},[J]),(0,t.useEffect)(()=>{const de=te((0,a.addListener)({predicate:me=>H(he,me),effect:async(me,{cancelActiveListeners:Pe,delay:Ee,getState:be})=>{Pe(),await Ee(200),G(be().explore,ce,le,Z)}}));return()=>de()},[te,Z]),(0,t.useEffect)(()=>{re.current=ae},[ae]),(0,t.useEffect)(()=>{const de=ce.current?.panes!==J.panes,[me,Pe]=h(J);Pe&&oe("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!de&&le.current==="notstarted"&&(le.current="pending",w(me,le,ne,te,Z)),ce.current=J,de&&le.current==="done"&&z(me,re.current,te)},[te,ne,Z,J,oe])}},74171:(q,j,e)=>{"use strict";e.d(j,{C:()=>n,s:()=>t});const t=r=>r.status==="fulfilled";function n(r,a){return r in a}},69502:(q,j,e)=>{"use strict";e.d(j,{k:()=>n});var t=e(32370);const n={from:`now-${t.$.exploreDefaultTimeOffset}`,to:"now"}},11550:(q,j,e)=>{"use strict";e.d(j,{M:()=>g,v:()=>E});var t=e(88483),n=e(98437),r=e(56276),a=e(23737),i=e(17687),x=e(3930),s=e(83394),c=e(3414),d=e(67078),u=e(4149);const g=m=>new t.c(f=>{const p=s.M_.getState().explore.panes[m]?.correlations;if(p)f.next(p),f.complete();else{const h=s.M_.subscribe(()=>{const D=s.M_.getState().explore.panes[m]?.correlations;D&&(h(),f.next(D),f.complete())})}});function o(m){return async(f,p)=>{const h=p().explore.panes[m];if(h.datasourceInstance?.uid!==void 0){let D=h.datasourceInstance.meta.mixed?h.queries.map(l=>l.datasource?.uid).filter(l=>l!==null):[h.datasourceInstance.uid];const C=await(0,x.J6)(D);f((0,c.Fb)({exploreId:m,correlations:C.correlations||[]}))}}}function E(m,f,p){return async(h,D)=>{const C=Object.keys(D().explore?.panes),l=D().explore?.panes[C[0]],v=D().explore?.panes[C[1]];if(!l||!v)return;const y=l.datasourceInstance?.meta.mixed?l.queries[0].datasource:l.datasourceInstance?.getRef(),P=v.datasourceInstance?.meta.mixed?v.queries[0].datasource:v.datasourceInstance?.getRef(),[b,S]=await Promise.all([(0,n.l)().get(y),(0,n.l)().get(P)]);if(b?.uid&&S?.uid&&v.correlationEditorHelperData?.resultField){const M={sourceUID:b.uid,targetUID:S.uid,label:m||await(0,x.tZ)(l,v),description:f,type:"query",config:{field:v.correlationEditorHelperData.resultField,target:v.queries[0],transformations:p}};await(0,x.$q)(b.uid,M).then(async()=>{h((0,d.J8)(C[1])),await h(o(C[0])),await h((0,u.Od)({exploreId:C[0]})),(0,r.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:b.type,targetDataSourceType:S.type})}).catch(O=>{h((0,a.dx)((0,i.gi)("Error creating correlation",O))),console.error(O)})}}}},58450:(q,j,e)=>{"use strict";e.d(j,{YR:()=>m,wh:()=>E});var t=e(65307),n=e(56276),r=e(98140),a=e(95536),i=e(3930),x=e(61491),s=e(56826),c=e(3414),d=e(4149),u=e(45526),g=e(19658);const o=(0,t.VP)("explore/updateDatasourceInstance"),E=(0,x.createAsyncThunk)("explore/changeDatasource",async({datasource:f,exploreId:p,options:h},{getState:D,dispatch:C})=>{const l=D().user.orgId,{history:v,instance:y}=await(0,g.BE)(l,f),P=D().explore.panes[p].datasourceInstance;(0,n.rR)("explore_change_ds",{from:(P?.meta?.mixed?"mixed":P?.type)||"unknown",to:y.meta.mixed?"mixed":y.type,exploreId:p}),C(o({exploreId:p,datasourceInstance:y,history:v}));const b=D().explore.panes[p].queries,S=(0,g.dq)(y.uid,b),M=await(0,i.J6)(S);C((0,c.Fb)({exploreId:p,correlations:M.correlations||[]})),h?.importQueries&&await C((0,d.y2)(p,b,P,y)),D().explore.panes[p].isLive&&C((0,u.hO)({exploreId:p,refreshInterval:r.cC.offOption.value})),h?.importQueries&&C((0,d.Od)({exploreId:p}))}),m=(f,p)=>{if(o.match(p)){const{datasourceInstance:h,history:D}=p.payload;return(0,a._u)(f.querySubscription),{...f,datasourceInstance:h,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,s.Ez)(),queryResponse:(0,g.RA)(),queryKeys:[],history:D}}return f}},3414:(q,j,e)=>{"use strict";e.d(j,{EA:()=>o,Fb:()=>p,Gd:()=>D,LJ:()=>C,QZ:()=>h,fx:()=>g,nE:()=>E});var t=e(65307),n=e(95536),r=e(3930),a=e(10743),i=e(61491),x=e(58450),s=e(4149),c=e(45526),d=e(19658);const u=(0,t.VP)("explore/changeSize"),g=(0,t.VP)("explore/changePanels");function o(l,v,y){return async(P,b)=>{const S=b().explore.panes[l];if(S===void 0)return;const{panelsState:M}=S;P(g({exploreId:l,panelsState:{...M,[v]:y}}))}}const E=(0,t.VP)("explore/changeCorrelationHelperData"),m=(0,t.VP)("explore/initializeExploreAction"),f=(0,t.VP)("explore/setUrlReplaced"),p=(0,t.VP)("explore/saveCorrelationsAction");function h(l,{width:v}){return u({exploreId:l,width:v})}const D=(0,i.createAsyncThunk)("explore/initializeExplore",async({exploreId:l,datasource:v,queries:y,range:P,panelsState:b,correlationHelperData:S,eventBridge:M},{dispatch:O,getState:R,fulfillWithValue:L})=>{let B,F=[];if(v){const I=R().user.orgId,U=await(0,d.BE)(I,v);B=U.instance,F=U.history}if(O(m({exploreId:l,queries:y,range:(0,d.eO)(P,(0,a.O)(R().user)),datasourceInstance:B,history:F,eventBridge:M})),b!==void 0&&O(g({exploreId:l,panelsState:b})),O((0,c.JA)({exploreId:l})),B){const I=(0,d.dq)(B.uid,y),U=await(0,r.J6)(I);O(p({exploreId:l,correlations:U.correlations||[]})),O((0,s.Od)({exploreId:l}))}return S!==void 0&&R().explore.correlationEditorDetails?.editorMode&&O(E({exploreId:l,correlationEditorHelperData:S})),L({exploreId:l,state:R().explore.panes[l]})}),C=(l=(0,d.HZ)(),v)=>{if(l=(0,s.JQ)(l,v),l=(0,x.YR)(l,v),l=(0,c.QP)(l,v),u.match(v)){const y=v.payload.width;return{...l,containerWidth:y}}if(g.match(v)){const{panelsState:y}=v.payload;return{...l,panelsState:y}}if(E.match(v)){const{correlationEditorHelperData:y}=v.payload;return{...l,correlationEditorHelperData:y}}if(p.match(v))return{...l,correlations:v.payload.correlations};if(m.match(v)){const{queries:y,range:P,datasourceInstance:b,history:S,eventBridge:M}=v.payload;return{...l,range:P,queries:y,initialized:!0,eventBridge:M,queryKeys:(0,n.dY)(y),datasourceInstance:b,history:S,queryResponse:(0,d.RA)(),cache:[],correlations:[]}}return l}},1895:(q,j,e)=>{"use strict";e.d(j,{Bj:()=>h,H9:()=>d,PA:()=>f,Uu:()=>E,VM:()=>u,fP:()=>p,jX:()=>o,ri:()=>s,s1:()=>g,sh:()=>c,wk:()=>m});var t=e(65307),n=e(14453),r=e(67548),a=e(67078);const i=(0,t.VP)("explore/historyUpdated"),x=({updatedQuery:D,deletedId:C})=>async(l,v)=>{const y=v().explore.richHistory,P=y.map(S=>S.id===D?.id?D:S).filter(S=>S.id!==C),b=y.length-P.length;l((0,a.U2)({richHistoryResults:{richHistory:P,total:v().explore.richHistoryTotal-b}}))},s=(D,C,l,v,y)=>async(P,b)=>{const S=y?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!b().explore.richHistoryStorageFull,limitExceededWarning:!b().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:M,limitExceeded:O}=await(0,n.l0)({localOverride:D,datasource:{uid:C,name:l},queries:v,starred:!1,showNotif:S});y||(M&&P((0,a.fj)()),O&&P((0,a.D)()))},c=(D,C)=>async(l,v)=>{const y=await(0,n.oU)(D,C);l(x({updatedQuery:y}))},d=(D,C)=>async l=>{const v=await(0,n.cX)(D,C);l(x({updatedQuery:v}))},u=D=>async C=>{const l=await(0,n.NC)(D);C(x({deletedId:l}))},g=()=>async D=>{await(0,n.X1)(),D((0,a.U2)({richHistoryResults:{richHistory:[],total:0}})),D((0,a.U2)({richHistoryResults:{richHistory:[],total:0}}))},o=()=>async(D,C)=>{const l=C().explore.richHistorySearchFilters;if(l){const v=await(0,n.DI)(l);D((0,a.U2)({richHistoryResults:v}))}},E=()=>async(D,C)=>{const l=C().explore.richHistorySearchFilters,v=C().explore.richHistory;if(l&&v){const y={...l,page:(l?.page||1)+1},P=await(0,n.DI)(y),b=[...v,...P.richHistory];D((0,a.Ju)({filters:y})),D((0,a.U2)({richHistoryResults:{richHistory:b,total:P.total}}))}},m=()=>async D=>{D((0,a.Ju)({filters:void 0})),D((0,a.U2)({richHistoryResults:{richHistory:[],total:0}}))},f=()=>async(D,C)=>{let l=C().explore.richHistorySettings;l||(l=await(0,n.Gx)(),D((0,a.bZ)(l)))},p=D=>async C=>{C((0,a.bZ)(D)),await(0,n.rs)(D)},h=D=>async(C,l)=>{await C((0,a.Ju)({filters:{...D}}));const v=l().explore.richHistorySettings;(0,r.gQ)().lastUsedDataSourcesAvailable&&await C(p({...v,lastUsedDatasourceFilters:D.datasourceFilters}))}},67078:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>I,D:()=>p,J8:()=>y,JA:()=>v,Ju:()=>D,U2:()=>m,Ve:()=>b,am:()=>O,bZ:()=>h,fj:()=>f,nD:()=>C,ow:()=>R,qz:()=>E,tP:()=>l,ve:()=>S});var t=e(65307),n=e(2543),r=e.n(n),a=e(10112),i=e(53027),x=e(95536),s=e(84395),c=e(61491),d=e(65627),u=e(69502),g=e(3414),o=e(19658);const E=(0,t.VP)("explore/syncTimes"),m=(0,t.VP)("explore/richHistoryUpdated"),f=(0,t.VP)("explore/richHistoryStorageFullAction"),p=(0,t.VP)("explore/richHistoryLimitExceededAction"),h=(0,t.VP)("explore/richHistorySettingsUpdated"),D=(0,t.VP)("explore/richHistorySearchFiltersUpdatedAction"),C=(0,t.VP)("explore/splitSizeUpdateAction"),l=(0,t.VP)("explore/maximizePaneAction"),v=(0,t.VP)("explore/evenPaneResizeAction"),y=(0,t.VP)("explore/splitClose"),P=(0,t.VP)("explore/setPaneState"),b=(0,t.VP)("explore/clearPanes"),S=(0,c.createAsyncThunk)("explore/splitOpen",async(U,{getState:W,dispatch:A})=>{const N=Object.values(W().explore.panes)[0],K=U?.queries??N?.queries??[];Object.keys(W().explore.panes).forEach((z,w)=>{w>=1&&A(y(z))});const V=U?.range||N?.range.raw||u.k;let T=(0,x.o$)();for(;W().explore.panes[T];)T=(0,x.o$)();await A(M({exploreId:T,datasource:U?.datasourceUid||N?.datasourceInstance?.getRef(),queries:(0,d.v)(K),range:V,panelsState:U?.panelsState||N?.panelsState,correlationHelperData:U?.correlationHelperData,eventBridge:new a.o})),N?.range&&await A(E({syncedTimes:(0,n.isEqual)(N.range.raw,V)}))}),M=(0,c.createAsyncThunk)("explore/createNewSplitOpen",async(U,{dispatch:W})=>{await W((0,g.Gd)(U))}),O=(0,t.VP)("explore/changeCorrelationEditorDetails"),R=(U,W)=>async A=>{const{timeRange:N,getExploreUrl:K,openInNewWindow:V}=W,T=await K({queries:U.targets,dsRef:U.datasource,scopedVars:U.scopedVars,timeRange:N,adhocFilters:(0,s.w)().getAdhocFilters(U.datasource?.uid??"",!0)});if(V&&T){V(T);return}i.Ny.push(T)},L=()=>(0,o.HZ)(),B={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},I={explore:(U=B,W)=>{if(y.match(W)){const{[W.payload]:N,...K}={...U.panes};return{...U,panes:K,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(C.match(W)){const{largerExploreId:N}=W.payload;return{...U,largerExploreId:N,maxedExploreId:void 0,evenSplitPanes:N===void 0}}if(l.match(W)){const{exploreId:N}=W.payload;return{...U,largerExploreId:N,maxedExploreId:N,evenSplitPanes:!1}}if(v.match(W))return{...U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(E.match(W))return{...U,syncedTimes:W.payload.syncedTimes};if(f.match(W))return{...U,richHistoryStorageFull:!0};if(p.match(W))return{...U,richHistoryLimitExceededWarningShown:!0};if(h.match(W)){const N=W.payload;return{...U,richHistorySettings:N}}if(m.match(W)){const{richHistory:N,total:K}=W.payload.richHistoryResults;return{...U,richHistory:N,richHistoryTotal:K}}if(D.match(W)){const N=W.payload.filters;return{...U,richHistorySearchFilters:N}}if(M.pending.match(W))return{...U,panes:{...U.panes,[W.meta.arg.exploreId]:L()}};if(g.Gd?.pending.match(W)){const N=Object.entries(U.panes),K=N.slice(0,W.meta.arg.position),V=N.slice(K.length),T=[...K,[W.meta.arg.exploreId,L()],...V].reduce((z,[w,H])=>({...z,[w]:H}),{});return{...U,panes:T}}if(b.match(W))return{...U,panes:{}};if(O.match(W)){const{editorMode:N,label:K,description:V,canSave:T,correlationDirty:z,queryEditorDirty:w,isExiting:H,postConfirmAction:G,transformations:X}=W.payload;return{...U,correlationEditorDetails:{editorMode:!!(N??U.correlationEditorDetails?.editorMode),canSave:!!(T??U.correlationEditorDetails?.canSave),label:K??U.correlationEditorDetails?.label,description:V??U.correlationEditorDetails?.description,transformations:X??U.correlationEditorDetails?.transformations,correlationDirty:!!(z??U.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(w??U.correlationEditorDetails?.queryEditorDirty),isExiting:!!(H??U.correlationEditorDetails?.isExiting),postConfirmAction:G}}}const A=W.payload?.exploreId;return typeof A=="string"?{...U,panes:Object.entries(U.panes).reduce((N,[K,V])=>({...N,[K]:K===A?(0,g.LJ)(V,W):V}),{})}:U}}},4149:(q,j,e)=>{"use strict";e.d(j,{_0:()=>nt,He:()=>xn,hS:()=>Je,bO:()=>tt,IL:()=>cn,rR:()=>xe,y2:()=>Re,Az:()=>jn,PD:()=>at,JQ:()=>Ot,S6:()=>ht,Od:()=>st,GI:()=>pn,q9:()=>Ve,h1:()=>Qe,qk:()=>ge,Rk:()=>vn,h9:()=>ve,TO:()=>_n});var t=e(65307),n=e(32017),r=e.n(n),a=e(2543),i=e(49510),x=e(62467),s=e(58307),c=e(69862),d=e(99165),u=e(8392),g=e(58462),o=e(3202),E=e(18163),m=e(29997),f=e(52718),p=e(4038),h=e(2049),D=e(47370),C=e(63739);function l(Ye,dt){const lt=v({data:Ye.series},{data:dt.series}).data;return{...Ye,series:lt}}function v(Ye,dt){if(!Ye)return M(dt);dt.data.forEach(Jt=>{const qt=Ye.data.find(gn=>R(gn,Jt));if(!qt){Ye.data.push(O(Jt));return}y(qt,Jt)});const lt=[...Ye.errors??[],...dt.errors??[]];lt.length>0&&(Ye.errors=lt);const Pt=Ye.error??dt.error;Pt!=null&&(Ye.error=Pt);const Bt=[...Ye.traceIds??[],...dt.traceIds??[]];return Bt.length>0&&(Ye.traceIds=Bt),Ye}function y(Ye,dt){const lt=Math.max(Ye.fields.length,dt.fields.length);for(let Pt=0;Pt<lt;Pt++){if(!Ye.fields[Pt])continue;const Bt=P(Ye.fields[Pt],dt.fields,Pt);if(Bt&&(Ye.fields[Pt].values=[].concat.apply(Bt.values,Ye.fields[Pt].values),Bt.nanos)){const Jt=Ye.fields[Pt].nanos?.slice()||[];Ye.fields[Pt].nanos=dt.fields[Pt].nanos?.concat(Jt)}}Ye.length+=dt.length,Ye.meta={...Ye.meta,stats:S(Ye.meta?.stats??[],dt.meta?.stats??[])}}function P(Ye,dt,lt){const Pt=dt.filter(Bt=>Bt.name===Ye.name);return Pt.length===1?Pt[0]:Ye.labels?Pt.find(Bt=>(0,h.ab)(Ye.labels??{},Bt.labels??{})):dt[lt]}const b="Summary: total bytes processed";function S(Ye,dt){const lt=Ye.find(Jt=>Jt.displayName===b),Pt=dt.find(Jt=>Jt.displayName===b);if(Pt!=null&&lt!=null)return[{value:Pt.value+lt.value,displayName:b,unit:lt.unit}];const Bt=Pt??lt;return Bt!=null?[Bt]:[]}function M(Ye){return{...Ye,data:Ye.data.map(O)}}function O(Ye){return{...Ye,fields:Ye.fields.map(dt=>({...dt,values:dt.values}))}}function R(Ye,dt){if(Ye.refId!==dt.refId||Ye.name!==dt.name)return!1;const lt=Ye.meta?.type,Pt=dt.meta?.type;if(lt!==Pt)return!1;if(lt===D.m.TimeSeriesMulti){const qt=Ye.fields.find(On=>On.type===C.PU.number),gn=dt.fields.find(On=>On.type===C.PU.number);return qt===void 0||gn===void 0?!1:(0,h.ab)(qt.labels??{},gn.labels??{})}const Bt=Ye.meta?.custom?.frameType,Jt=dt.meta?.custom?.frameType;return Bt==="LabeledTimeValues"&&Jt==="LabeledTimeValues"?!0:Bt===Jt}var L=e(98437),B=e(32370),F=e(95536),I=e(46924),U=e(3930),W=e(10059),A=e(10743),N=e(57903),K=e(5956),V=e(61491),T=e(23737),z=e(17687),w=e(23234),H=e(81160),G=e(16869),X=e(47180),k=e(36596),_=e(55909),ee=e(48224),J=e(43956);const Z=Ye=>{const dt=[],lt=[],Pt=[],Bt=[],Jt=[],qt=[],gn=[],On=[];for(const Tn of Ye.series){if(oe(Tn)){On.push(Tn);continue}switch(Tn.meta?.preferredVisualisationType){case"logs":Bt.push(Tn);break;case"graph":dt.push(Tn);break;case"trace":Jt.push(Tn);break;case"table":lt.push(Tn);break;case"rawPrometheus":Pt.push(Tn);break;case"nodeGraph":qt.push(Tn);break;case"flamegraph":gn.push(Tn);break;default:he(Tn)&&dt.push(Tn),lt.push(Tn)}}return{...Ye,graphFrames:dt,tableFrames:lt,logsFrames:Bt,traceFrames:Jt,nodeGraphFrames:qt,customFrames:On,flameGraphFrames:gn,rawPrometheusFrames:Pt,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},te=({showCorrelationEditorLinks:Ye,queries:dt,correlations:lt,defaultTargetDatasource:Pt})=>Bt=>{if(Ye&&Pt)for(const Jt of Bt.series)for(const qt of Jt.fields){qt.config.links=[],qt.display=qt.display||(0,G.H)();const gn={};Jt.fields.map(On=>{gn[`${On.name}`]=`\${__data.fields.['${On.name}']}`}),qt.config.links.push({url:"",origin:X.x0.ExploreCorrelationsEditor,title:`Correlate with ${qt.name}`,internal:{datasourceUid:Pt.uid,datasourceName:Pt.name,query:{datasource:{uid:Pt.uid}}},meta:{correlationData:{resultField:qt.name,vars:gn,origVars:gn}}})}else if(dt?.length&&lt?.length){const Jt=(0,a.mapValues)((0,a.groupBy)(dt,"refId"),"0.datasource.uid");(0,U.cA)(Bt.series,lt,Jt)}return Bt},ae=Ye=>Ye.graphFrames.length?{...Ye,graphResult:Ye.graphFrames}:{...Ye,graphResult:null},re=Ye=>{if(Ye.tableFrames.length===0)return(0,x.of)({...Ye,tableResult:null});Ye.tableFrames.sort((Bt,Jt)=>{const qt=Bt.refId,gn=Jt.refId;return qt>gn?1:qt<gn?-1:0});const dt=Ye.tableFrames.every(Bt=>he(Bt)),lt={interpolate:Bt=>Bt};return(dt?(0,x.of)(Ye.tableFrames).pipe(k.c.joinByFieldTransformer.operator({},lt)):(0,x.of)(Ye.tableFrames).pipe(k.c.mergeTransformer.operator({},lt))).pipe((0,H.T)(Bt=>{for(const Jt of Bt)for(const qt of Jt.fields)qt.display=qt.display??(0,G.J)({field:qt,theme:B.$.theme2,timeZone:Ye.request?.timezone??"browser"});return{...Ye,tableResult:Bt}}))},ne=Ye=>{const dt=Ye.rawPrometheusFrames;if(!dt||dt.length===0)return(0,x.of)({...Ye,tableResult:null});dt.sort((Jt,qt)=>{const gn=Jt.refId,On=qt.refId;return gn>On?1:gn<On?-1:0});const lt=dt.every(Jt=>he(Jt)),Pt={interpolate:Jt=>Jt};return(lt?(0,x.of)(dt).pipe(k.c.joinByFieldTransformer.operator({},Pt)):(0,x.of)(dt).pipe(k.c.mergeTransformer.operator({},Pt))).pipe((0,H.T)(Jt=>{const qt=Jt[0];for(const gn of qt.fields)gn.display=gn.display??(0,G.J)({field:gn,theme:B.$.theme2,timeZone:Ye.request?.timezone??"browser"});return{...Ye,rawPrometheusResult:qt}}))},ce=(Ye={})=>dt=>{if(dt.logsFrames.length===0)return{...dt,logsResult:null};const lt=dt.request?.intervalMs,Pt=(0,_.HT)(dt.logsFrames,lt,Ye.absoluteRange,Ye.queries,Ye.deduplicate),Bt=(0,F.uE)(Ye.refreshInterval),Jt=(0,ee.zy)(Pt,Bt),qt=Jt.rows,gn=Jt.series,On={...Jt,rows:qt,series:gn};return{...dt,logsResult:On}};function le(Ye,dt,lt,Pt,Bt,Jt,qt){return(0,x.of)(Ye).pipe((0,H.T)(gn=>(0,p.N$)(gn,dt)),(0,H.T)(te({defaultTargetDatasource:qt,showCorrelationEditorLinks:Jt,queries:Pt,correlations:Bt})),(0,H.T)(Z),(0,H.T)(ae),(0,H.T)(lt),(0,c.Z)(ne),(0,c.Z)(re))}function he(Ye){const dt=(0,a.groupBy)(Ye.fields,lt=>lt.type);return!!(Object.keys(dt).length===2&&dt[C.PU.time]?.length===1&&dt[C.PU.number])}function oe(Ye){return Ye.meta?.preferredVisualisationPluginId?(0,J.oZ)(Ye.meta?.preferredVisualisationPluginId):!1}var de=e(56826),me=e(11550),Pe=e(3414),Ee=e(1895),be=e(67078),Se=e(45526),Xe=e(19658);const Qe=Ye=>dt=>{const lt=dt.explore.panes[Ye];return lt&&lt.queryResponse?lt.queryResponse.state===u.Gu.Loading||lt.queryResponse.state===u.Gu.Streaming:!1},we=(0,t.VP)("explore/addQueryRow"),$e=(0,t.VP)("explore/changeQueries"),Fe=(0,t.VP)("explore/cancelQueries"),Te=(0,t.VP)("explore/queriesImported"),Le=(0,t.VP)("explore/queryStoreSubscription"),Ge=(0,t.VP)("explore/setSupplementaryQueryEnabledAction"),Me=(0,t.VP)("explore/storeSupplementaryQueryDataProviderAction"),De=(0,t.VP)("explore/cleanSupplementaryQueryDataProviderAction"),Ke=(0,t.VP)("explore/cleanSupplementaryQueryAction"),Ie=(0,t.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Ne=(0,t.VP)("explore/updateSupplementaryQueryDataAction"),ie=(0,t.VP)("explore/queryStreamUpdated"),ve=(0,t.VP)("explore/setQueries"),fe=(0,t.VP)("changeLoadingState"),ge=(0,t.VP)("explore/setPausedState"),xe=(0,t.VP)("explore/clearLogs"),je=(0,t.VP)("explore/scanStart"),Ve=(0,t.VP)("explore/scanStop"),ke=(0,t.VP)("explore/addResultsToCache"),Oe=(0,t.VP)("explore/clearCache");function nt(Ye,dt){return async(lt,Pt)=>{const Bt=Pt().explore.panes[Ye];let Jt;Bt.datasourceInstance?.meta.mixed?Jt=(0,a.findLast)(Bt.queries,gn=>!!gn.datasource)?.datasource||void 0:Jt=Bt.datasourceInstance?.getRef();const qt=await(0,F.Ll)(Bt.queries,dt,Jt);lt(we({exploreId:Ye,index:dt,query:qt}))}}function Je(Ye){return(dt,lt)=>{dt(Ve({exploreId:Ye})),dt(Fe({exploreId:Ye}));const Pt=lt().explore.panes[Ye].supplementaryQueries;for(const Bt of de.VW)dt(De({exploreId:Ye,type:Bt})),Pt[Bt]?.data?.state!==u.Gu.Done&&dt(Ke({exploreId:Ye,type:Bt}))}}const Be=(Ye,dt)=>{const lt=Ye.getRef();return dt.map(Pt=>({...Pt,datasource:lt}))},Ze=async(Ye,dt,lt)=>{let Pt=[];if(dt.meta?.id===Ye.meta?.id)Pt=lt;else if((0,g.Ee)(dt)&&(0,g.FL)(Ye)){const Bt=await dt.exportToAbstractQueries(lt);Pt=await Ye.importFromAbstractQueries(Bt)}else Ye.importQueries&&(Pt=await Ye.importQueries(lt,dt));return Be(Ye,Pt)},tt=(0,V.createAsyncThunk)("explore/changeQueries",async({queries:Ye,exploreId:dt},{getState:lt,dispatch:Pt})=>{let Bt=!1;const Jt=lt().explore.panes[dt].queries,qt=lt().explore.panes[dt].datasourceInstance?.uid,gn=lt().explore.correlationEditorDetails,On=gn?.editorMode||!1;!(Object.keys(lt().explore.panes)[0]===dt)&&On&&!gn?.queryEditorDirty&&Pt((0,be.am)({queryEditorDirty:!0}));for(const wn of Ye)for(const ps of Jt){if(wn.refId===ps.refId&&wn.datasource?.type!==ps.datasource?.type){const es=await(0,L.l)().get(ps.datasource),ls=await(0,L.l)().get({uid:wn.datasource?.uid});await Pt(Re(dt,Jt,es,ls,wn.refId)),Bt=!0}if(qt===K.uv&&wn.refId===ps.refId&&wn.datasource?.uid!==ps.datasource?.uid){const es=(0,Xe.dq)(K.uv,Ye),ls=await(0,U.J6)(es);Pt((0,Pe.Fb)({exploreId:dt,correlations:ls.correlations||[]}))}}Bt||Pt($e({queries:Ye,exploreId:dt})),Ye.length<Jt.length&&Pt(st({exploreId:dt}))}),Re=(Ye,dt,lt,Pt,Bt)=>async Jt=>{if(!lt){Jt(Te({exploreId:Ye,queries:dt}));return}let qt=dt;if(Pt.uid===K.uv)qt=dt.map(On=>({...On,datasource:lt.getRef()}));else if(lt.uid===K.uv){const On=(0,a.groupBy)(dt,wn=>wn.datasource?.uid),Tn=await Promise.all(Object.keys(On).map(async wn=>{const ps=await(0,L.l)().get({uid:wn});return await Ze(Pt,ps,On[wn])}));qt=(0,a.flatten)(Tn.filter(wn=>wn.length>0))}else{let On=dt;if(Bt!==void 0){const Tn=dt.find(wn=>wn.refId===Bt);Tn&&(On=[Tn])}qt=await Ze(Pt,lt,On)}let gn=await(0,F.di)(qt,Pt.getRef());if(Bt!==void 0){qt.length===0&&(qt=[await(0,F.Ll)([],void 0,Pt.getRef())]);const On=dt.findIndex(wn=>wn.refId===Bt),Tn={...gn[0],refId:dt[On].refId};gn=[...dt],gn[On]=Tn}return Jt(Te({exploreId:Ye,queries:gn})),gn};function at(Ye,dt,lt){return async(Pt,Bt)=>{const Jt=Bt().explore.panes[Ye],{queries:qt}=Jt,On=(await Promise.all(qt.map(Tn=>lt({...Tn},dt)))).map((Tn,wn)=>(0,F.eF)(Tn,qt,wn));Pt(ve({exploreId:Ye,queries:On})),dt.preventSubmit||Pt(st({exploreId:Ye}))}}function yt(Ye,dt){if(!(Ye.filterQuery&&!Ye.filterQuery(dt)))return dt}async function ze(Ye,dt,lt,Pt){const Jt=(await Promise.all(Pt.map(async qt=>{if(qt.datasource?.uid===lt.uid)return yt(lt,qt);{const gn=await(0,W.tR)().get(qt.datasource);return yt(gn,qt)}}))).filter(qt=>!!qt);Jt.length>0&&(Ye((0,Ee.ri)(!0,lt.uid,lt.name,Jt,B.$.queryHistoryEnabled)),B.$.queryHistoryEnabled&&Ye((0,Ee.ri)(!1,lt.uid,lt.name,Jt,!1)),await Ye((0,Ee.jX)()))}const st=(0,V.createAsyncThunk)("explore/runQueries",async({exploreId:Ye,preserveCache:dt},{dispatch:lt,getState:Pt})=>{Pt().explore?.panes[Ye]?.scanning||lt(Je(Ye));const{defaultCorrelationEditorDatasource:Bt,scopedVars:Jt,showCorrelationEditorLinks:qt}=await(0,Xe.aj)(Pt(),Ye),gn=(0,me.M)(Ye);lt((0,Se.JA)({exploreId:Ye})),dt!==!0&&lt(cn(Ye));const Tn=Pt().explore.panes[Ye],{datasourceInstance:wn,containerWidth:ps,isLive:es,range:ls,scanning:Lt,queryResponse:$t,querySubscription:nn,refreshInterval:on,absoluteRange:bn,cache:In,supplementaryQueries:Yn}=Tn;let zn,St;const zt=Tn.queries.map(an=>({...an,datasource:an.datasource||wn?.getRef()}));wn!=null&&ze(lt,Pt().explore,wn,zt);const Qt=(0,Xe.rk)(In,bn);if(Qt)zn=(0,i.z)([(0,x.of)(Qt),gn]).pipe((0,c.Z)(([an,mn])=>le(an,$t,ce({absoluteRange:bn,refreshInterval:on,queries:zt}),zt,mn,qt,Bt))),St=zn.subscribe(an=>{lt(ie({exploreId:Ye,response:an}))});else{if(!(0,F.zT)(zt)||!wn)return;const an=wn?.interval;(0,F._u)(nn);const mn={minInterval:an,maxDataPoints:ps,liveStreaming:es},yn=(0,A.O)(Pt().user),Ct=(0,F.bI)(Ye,zt,mn,ls,Lt,yn,Jt);if(lt(fe({exploreId:Ye,loadingState:u.Gu.Loading})),zn=(0,i.z)([(0,w.BN)(wn,Ct.request).pipe(es?(0,d.c)(500):s.D),gn]).pipe((0,c.Z)(([ut,Et])=>le(ut,$t,ce({absoluteRange:bn,refreshInterval:on,queries:zt}),zt,Et,qt,Bt))),St=zn.subscribe({next(ut){const Et=Pt().explore.panes[Ye];if(lt(ie({exploreId:Ye,response:ut})),Et.scanning)if(console.log(ut.series),ut.state===u.Gu.Done&&ut.series.length===0){const Ut=(0,I.Wb)(-1,Et.range);lt((0,Se.JA)({exploreId:Ye,absoluteRange:Ut})),lt(st({exploreId:Ye}))}else(ut.series[0]?.length>0||ut.state===u.Gu.Done)&&lt(Ve({exploreId:Ye}))},error(ut){lt((0,T.dx)((0,z.gi)("Query processing error",ut))),lt(fe({exploreId:Ye,loadingState:u.Gu.Error})),console.error(ut)},complete(){Pt().explore.panes[Ye].queryResponse.state===u.Gu.Loading&&lt(fe({exploreId:Ye,loadingState:u.Gu.Done}))}}),es)for(const ut of de.VW)lt(De({exploreId:Ye,type:ut})),lt(Ke({exploreId:Ye,type:ut}));else lt(Gt({exploreId:Ye,datasourceInstance:wn,transaction:Ct,newQuerySource:zn,supplementaryQueries:Yn,queries:zt,absoluteRange:bn}))}lt(Le({exploreId:Ye,querySubscription:St}))}),ht=(0,V.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:Ye,absoluteRange:dt},{dispatch:lt,getState:Pt})=>{lt(Je(Ye));const{datasourceInstance:Bt,containerWidth:Jt,queryResponse:qt}=Pt().explore.panes[Ye],{defaultCorrelationEditorDatasource:gn,scopedVars:On,showCorrelationEditorLinks:Tn}=await(0,Xe.aj)(Pt(),Ye),wn=(0,me.M)(Ye);let ps;const es=qt.logsResult?.queries||[],ls=qt.logsFrames.map(In=>In.refId),Lt=es.filter(In=>ls.includes(In.refId)).map(In=>({...In,datasource:In.datasource||Bt?.getRef(),refId:In.refId,supportingQueryType:N.Q$.InfiniteScroll}));if(!(0,F.zT)(Lt)||!Bt)return;const $t={minInterval:Bt?.interval,maxDataPoints:Jt},nn=(0,A.O)(Pt().user),on=(0,F.zq)(nn,{from:(0,o.oZ)(nn,dt.from),to:(0,o.oZ)(nn,dt.to)},(0,A.q)(Pt().user)),bn=(0,F.bI)(Ye,Lt,$t,on,!1,nn,On);lt(fe({exploreId:Ye,loadingState:u.Gu.Loading})),ps=(0,i.z)([(0,w.BN)(Bt,bn.request),wn]).pipe((0,c.Z)(([In,Yn])=>In.state!==u.Gu.Done?(0,x.of)({...qt,state:u.Gu.Loading}):le(l(qt,In),qt,ce({absoluteRange:dt,queries:es,deduplicate:!0}),Lt,Yn,Tn,gn))),ps.subscribe({next(In){lt(ie({exploreId:Ye,response:In}))},error(In){lt((0,T.dx)((0,z.gi)("Query processing error",In))),lt(fe({exploreId:Ye,loadingState:u.Gu.Error})),console.error(In)},complete(){lt(fe({exploreId:Ye,loadingState:u.Gu.Done}))}})}),It=async(Ye,dt)=>{const lt=Ye.filter(Bt=>Bt.datasource?.uid!==K.uv),Pt=(0,a.groupBy)(lt,"datasource.uid");return await Promise.all(Object.values(Pt).map(async Bt=>({datasource:await(0,L.l)().get(Bt[0].datasource,dt),targets:Bt})))},Gt=(0,V.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:Ye,exploreId:dt,transaction:lt,newQuerySource:Pt,supplementaryQueries:Bt,queries:Jt,absoluteRange:qt},{dispatch:gn})=>{let On;Ye.meta.mixed?On=await It(lt.request.targets,lt.request.scopedVars):On=[{datasource:Ye,targets:lt.request.targets}];for(const Tn of de.VW){const wn=(0,de.Pm)(On,Tn,{...lt.request,requestId:`${lt.request.requestId}_${(0,a.snakeCase)(Tn)}`},Pt);wn?(gn(Me({exploreId:dt,type:Tn,dataProvider:wn})),un(Bt[Tn].data,Jt,qt)||(gn(Ke({exploreId:dt,type:Tn})),Bt[Tn].enabled&&gn(jn(dt,Tn)))):gn(De({exploreId:dt,type:Tn}))}});function un(Ye,dt,lt){if(!Ye)return!1;const Pt=(0,a.zipObject)((0,a.map)(dt,"refId"),dt),Bt=(0,a.mapValues)((0,a.groupBy)(Ye.data.map(On=>On.meta?.custom?.sourceQuery),"refId"),a.head),Jt=Ye.data.every(On=>On.meta?.custom?.logsVolumeType===E.Aj.FullRange),qt=r()(Pt,Bt),gn=Ye.data.every(On=>{const Tn=On.meta?.custom?.absoluteRange;return Tn?Tn&&Tn.from<=lt.from&&lt.to<=Tn.to:!0});return Jt&&qt&&gn}function vn(Ye,dt){return(lt,Pt)=>{const Bt=Pt().explore.panes[Ye].queries,Jt=dt.map((qt,gn)=>(0,F.eF)(qt,Bt,gn));lt(ve({exploreId:Ye,queries:Jt})),lt(st({exploreId:Ye}))}}function pn(Ye){return(dt,lt)=>{dt(je({exploreId:Ye}));const Pt=(0,I.Wb)(-1,lt().explore.panes[Ye].range);dt((0,Se.JA)({exploreId:Ye,absoluteRange:Pt})),dt(st({exploreId:Ye}))}}function xn(Ye){return(dt,lt)=>{const Pt=lt().explore.panes[Ye].queryResponse,Bt=lt().explore.panes[Ye].absoluteRange,Jt=(0,Xe.O2)(Bt);Pt.state===u.Gu.Done&&dt(ke({exploreId:Ye,cacheKey:Jt,queryResponse:Pt}))}}function cn(Ye){return(dt,lt)=>{dt(Oe({exploreId:Ye}))}}function jn(Ye,dt){return(lt,Pt)=>{const{supplementaryQueries:Bt}=Pt().explore.panes[Ye],Jt=Bt[dt].dataProvider;if(Jt){const qt=Jt.subscribe({next:gn=>{lt(Ne({exploreId:Ye,type:dt,data:gn}))}});lt(Ie({exploreId:Ye,type:dt,dataSubscription:qt}))}}}function _n(Ye,dt,lt){return(Pt,Bt)=>{Pt(Ge({exploreId:Ye,enabled:dt,type:lt})),(0,de.Oi)(dt,lt),dt&&Pt(jn(Ye,lt))}}const Ot=(Ye,dt)=>{if(we.match(dt)){const{queries:lt}=Ye,{index:Pt,query:Bt}=dt.payload,Jt=[...lt.slice(0,Pt+1),{...Bt},...lt.slice(Pt+1)];return{...Ye,queries:Jt,queryKeys:(0,F.dY)(Jt)}}if($e.match(dt)){const{queries:lt}=dt.payload;return{...Ye,queries:lt}}if(Fe.match(dt))return(0,F._u)(Ye.querySubscription),{...Ye,...Ye.queryResponse?{queryResponse:{...Ye.queryResponse,state:u.Gu.Done}}:{}};if(ve.match(dt)){const{queries:lt}=dt.payload;return{...Ye,queries:lt.slice(),queryKeys:(0,F.dY)(lt)}}if(Le.match(dt)){const{querySubscription:lt}=dt.payload;return{...Ye,querySubscription:lt}}if(Ge.match(dt)){const{enabled:lt,type:Pt}=dt.payload,{supplementaryQueries:Bt}=Ye,Jt=Bt[Pt].dataSubscription;!lt&&Jt&&Jt.unsubscribe();const qt={...Bt,[Pt]:{...Bt[Pt],enabled:lt,data:void 0}};return{...Ye,supplementaryQueries:qt}}if(Me.match(dt)){const{dataProvider:lt,type:Pt}=dt.payload,{supplementaryQueries:Bt}=Ye,Jt=Bt[Pt];Jt?.dataSubscription&&Jt.dataSubscription.unsubscribe();const qt={...Bt,[Pt]:{...Jt,dataProvider:lt,dataSubscription:void 0}};return{...Ye,supplementaryQueries:qt}}if(De.match(dt)){const{type:lt}=dt.payload,{supplementaryQueries:Pt}=Ye,Bt=Pt[lt];Bt?.dataSubscription&&Bt.dataSubscription.unsubscribe();const Jt={...Pt,[lt]:{...Bt,dataProvider:void 0,dataSubscription:void 0}};return{...Ye,supplementaryQueries:Jt}}if(Ke.match(dt)){const{type:lt}=dt.payload,{supplementaryQueries:Pt}=Ye,Bt={...Pt,[lt]:{...Pt[lt],data:void 0}};return{...Ye,supplementaryQueries:Bt}}if(Ie.match(dt)){const{dataSubscription:lt,type:Pt}=dt.payload,{supplementaryQueries:Bt}=Ye,Jt={...Bt,[Pt]:{...Bt[Pt],dataSubscription:lt}};return{...Ye,supplementaryQueries:Jt}}if(Ne.match(dt)){let{data:lt,type:Pt}=dt.payload;const{supplementaryQueries:Bt}=Ye,Jt={...Bt,[Pt]:{...Bt[Pt],data:lt}};return{...Ye,supplementaryQueries:Jt}}if(ie.match(dt))return Rt(Ye,dt);if(Te.match(dt)){const{queries:lt}=dt.payload;return{...Ye,queries:lt,queryKeys:(0,F.dY)(lt)}}if(fe.match(dt)){const{loadingState:lt}=dt.payload;return{...Ye,queryResponse:{...Ye.queryResponse,state:lt}}}if(ge.match(dt)){const{isPaused:lt}=dt.payload;return{...Ye,isPaused:lt}}if(je.match(dt))return{...Ye,scanning:!0};if(Ve.match(dt))return{...Ye,scanning:!1,scanRange:void 0};if(ke.match(dt)){const{cache:Pt}=Ye,{queryResponse:Bt,cacheKey:Jt}=dt.payload;let qt=[...Pt];return qt.some(On=>On.key===Jt)||(qt=[{key:Jt,value:Bt},...qt].slice(0,5)),{...Ye,cache:qt}}if(Oe.match(dt))return{...Ye,cache:[]};if(xe.match(dt)){if(!Ye.logsResult)return{...Ye,clearedAtIndex:null};if(Ye.queryResponse.state===u.Gu.Loading)return{...Ye,clearedAtIndex:null,logsResult:{...Ye.logsResult,rows:[]}};const lt=Ye.clearedAtIndex?Ye.clearedAtIndex+Ye.logsResult.rows.length:Ye.logsResult.rows.length-1;return{...Ye,clearedAtIndex:lt,logsResult:{...Ye.logsResult,rows:[]}}}return Ye},Rt=(Ye,dt)=>{const{response:lt}=dt.payload,{request:Pt,series:Bt,error:Jt,graphResult:qt,logsResult:gn,tableResult:On,rawPrometheusResult:Tn,traceFrames:wn,nodeGraphFrames:ps,flameGraphFrames:es,rawPrometheusFrames:ls,customFrames:Lt}=lt;if(Jt){if(Jt.type===m.v2.Timeout||Jt.type===m.v2.Cancelled)return{...Ye};B.$.angularSupportEnabled&&Ye.datasourceInstance?.components?.QueryCtrl&&Ye.eventBridge.emit(f.ee.dataError,Jt)}if(!Pt)return{...Ye};if(B.$.angularSupportEnabled&&Ye.datasourceInstance?.components?.QueryCtrl){const $t=Bt.map(nn=>(0,p.w3)(nn));Ye.eventBridge.emit(f.ee.dataReceived,$t)}return{...Ye,queryResponse:lt,graphResult:qt,tableResult:On,rawPrometheusResult:Tn,logsResult:Ye.isLive&&gn?{...gn,rows:(0,Xe.pg)(Ye.clearedAtIndex,gn.rows)}:gn,showLogs:!!gn,showMetrics:!!qt,showTable:!!On?.length,showTrace:!!wn.length,showNodeGraph:!!ps.length,showRawPrometheus:!!ls.length,showFlameGraph:!!es.length,showCustom:!!Lt?.length,clearedAtIndex:Ye.isLive?Ye.clearedAtIndex:null}}},60225:(q,j,e)=>{"use strict";e.d(j,{Jr:()=>u,K6:()=>s,Kl:()=>E,Qb:()=>a,i6:()=>x,pF:()=>c,qq:()=>g,st:()=>d,vC:()=>o});var t=e(25508),n=e(2543),r=e.n(n);const a=m=>m.explore.panes,i=m=>m.explore,x=m=>m.explore.richHistorySettings,s=(0,t.Mz)(a,Object.entries),c=(0,t.Mz)(s,m=>m.length>1),d=(0,t.Mz)(s,m=>m.some(f=>f[1].correlationEditorHelperData!==void 0)),u=m=>(0,t.Mz)(a,f=>Object.keys(f)[0]===m),g=m=>(0,t.Mz)(a,f=>f[m]),o=(0,t.Mz)(i,m=>m.correlationEditorDetails),E=(0,t.Mz)(s,m=>{const f=m.map(([D,C])=>{const l=[C?.datasourceInstance?.getRef()],v=C?.queries.map(P=>P.datasource)||[],y=[...l,...v].filter(P=>!!P);if(!(y===void 0||y.length===0))return{exploreId:D,datasources:(0,n.uniqBy)(y,P=>P.uid)}}).filter(D=>!!D),h=(0,n.uniqBy)((0,n.flatten)(f.map(D=>D.datasources)),D=>D.uid).map(D=>{let C=[];return f.forEach(l=>{l.datasources.some(v=>v.uid===D.uid)&&C.push(l.exploreId)}),{datasource:D,exploreIds:C}});return{exploreToDS:f,dsToExplore:h}})},45526:(q,j,e)=>{"use strict";e.d(j,{$_:()=>P,GA:()=>O,GH:()=>D,Iy:()=>b,JA:()=>l,QP:()=>R,Xk:()=>M,eM:()=>p,hO:()=>h,iO:()=>v,ke:()=>S,zY:()=>C});var t=e(65307),n=e(3202),r=e(52718),a=e(8392),i=e(39736),x=e(98140),s=e(22492),c=e(11817),d=e(95536),u=e(46924),g=e(80757),o=e(48224),E=e(10743),m=e(67078),f=e(4149);const p=(0,t.VP)("explore/changeRange"),h=(0,t.VP)("explore/changeRefreshInterval"),D=L=>(B,F)=>{const{syncedTimes:I}=F().explore;I?Object.keys(F().explore.panes).forEach(U=>{B(l({...L,exploreId:U})),B((0,f.Od)({exploreId:U,preserveCache:!0}))}):(B(l({...L})),B((0,f.Od)({exploreId:L.exploreId,preserveCache:!0})))},C=L=>B=>{B((0,f.S6)({...L}))},l=L=>(B,F)=>{const{exploreId:I,absoluteRange:U,rawRange:W}=L,A=F().explore.panes[I],N=(0,E.O)(F().user),K=(0,E.q)(F().user),{range:V}=A;let T=V.raw;U&&(T={from:(0,n.oZ)(N,U.from),to:(0,n.oZ)(N,U.to)}),W&&(T=W);const z=(0,d.zq)(N,T,K),w={from:z.from.valueOf(),to:z.to.valueOf()};(0,g.jG)().init({timepicker:{},getTimezone:()=>N,timeRangeUpdated(H){},time:z.raw}),(0,i.w)().updateTimeRange(z),B(p({exploreId:I,range:z,absoluteRange:w}))};function v(L){return(B,F)=>{const I=F().explore.panes[L].range.raw;Object.keys(F().explore.panes).filter(W=>W!==L).forEach(W=>{B(D({exploreId:W,rawRange:I}))});const U=F().explore.syncedTimes;B((0,m.qz)({syncedTimes:!U}))}}function y(L){return(B,F)=>{const I=(0,E.O)(F().user),U=(0,E.q)(F().user);Object.entries(F().explore.panes).forEach(([W,A])=>{const N=(0,d.zq)(I,A.range.raw,U);L(W,A,N,B)})}}function P(){return y((L,B,F,I)=>{const U={from:F.from.valueOf(),to:F.to.valueOf()};I(D({exploreId:L,absoluteRange:U}))})}function b(L){return y((B,F,I,U)=>{const W=(0,u.Wb)(L,I);U(D({exploreId:B,absoluteRange:W}))})}function S(L){return y((B,F,I,U)=>{const W=(0,u.Zk)(I,L);U(D({exploreId:B,absoluteRange:W}))})}function M(){return(L,B)=>{const F=B().explore.panes[Object.keys(B().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(F)),s.A.emit(r.r1.alertSuccess,[(0,c.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function O(){return async(L,B)=>{const{range:F,isError:I}=await(0,u.zG)();if(I===!0){s.A.emit(r.r1.alertError,[(0,c.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,c.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:F})]);return}if(B().explore.syncedTimes){L(D({exploreId:Object.keys(B().explore.panes)[0],rawRange:F})),L(D({exploreId:Object.keys(B().explore.panes)[1],rawRange:F}));return}L(D({exploreId:Object.keys(B().explore.panes)[0],rawRange:F}))}}const R=(L,B)=>{if(h.match(B)){const{refreshInterval:F}=B.payload,I=x.cC.isLive(F),U=(0,d.uE)(F),W=(0,o.zy)(L.logsResult,U);return x.cC.isLive(L.refreshInterval)&&!I&&(0,d._u)(L.querySubscription),{...L,refreshInterval:F,queryResponse:{...L.queryResponse,state:I?a.Gu.Streaming:a.Gu.Done},isLive:I,isPaused:I?!1:L.isPaused,logsResult:W}}if(p.match(B)){const{range:F,absoluteRange:I}=B.payload;return{...L,range:F,absoluteRange:I}}return L}},19658:(q,j,e)=>{"use strict";e.d(j,{BE:()=>v,HZ:()=>C,O2:()=>y,RA:()=>l,Z9:()=>S,aj:()=>L,dq:()=>R,eO:()=>b,ng:()=>D,pg:()=>O,rk:()=>P});var t=e(2543),n=e.n(t),r=e(8392),a=e(55801),i=e(30468),x=e(3202),s=e(98437),c=e(67548),d=e(75748),u=e(5956),g=e(82856),o=e(95536),E=e(10059),m=e(56826),f=e(69502);const p=100,h="grafana.explore.style.graph",D=B=>{g.A.set(h,B)},C=B=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:f.k},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:l(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,m.Ez)(),panelsState:{},correlations:void 0,...B}),l=()=>({state:r.Gu.NotStarted,series:[],timeRange:(0,a.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function v(B,F){let I;try{I=await(0,E.tR)().get(F)}catch{I=await(0,E.tR)().get()}if(I.init)try{I.init()}catch(N){console.error(N)}let U=[];const W=(0,c.tU)(),A=await W.getRichHistory({search:"",sortOrder:d.x.Ascending,datasourceFilters:[I.name],starred:!1});if((A.total||0)>0&&A.richHistory.forEach(N=>{N.queries.forEach(K=>{U.push({ts:parseInt(N.id,10),query:K})})}),U.length<p){const N=await W.getRichHistory({search:"",sortOrder:d.x.Ascending,datasourceFilters:[u.uv],starred:!1});(N.total||0)>0&&N.richHistory.forEach(K=>{K.queries.forEach(V=>{V?.datasource?.uid===I.uid&&U.push({ts:parseInt(K.id,10),query:V})})})}if(U.length<p){const N=`grafana.explore.history.${I.meta?.id}`;U=[...U,...g.A.getObject(N,[])]}return U.length>p&&(U.length=p),(0,o.dr)(B,I.uid),{history:U,instance:I}}function y(B){const F={from:B.from,to:B.to};return Object.entries(F).map(([U,W])=>`${encodeURIComponent(U)}=${encodeURIComponent(W.toString())}`).join("&")}function P(B,F){const I=y(F),U=B.findIndex(A=>A.key===I);return U>=0?B[U].value:void 0}function b(B,F){return{from:i.parse(B.from,!1,F),to:i.parse(B.to,!0,F),raw:B}}function S(B){let F=f.k,I={from:M(B.from),to:M(B.to)};return I.from!==null&&I.to!==null&&(F={from:I.from,to:I.to}),F}function M(B){if(B===null)return null;if((0,x.Ar)(B))return B;if(typeof B!="string")return null;const F=B;if(F.indexOf("now")!==-1)return F;if(F.length===8)return(0,x.yT)(F,"YYYYMMDD");if(F.length===15)return(0,x.yT)(F,"YYYYMMDDTHHmmss");if(F.length===19)return(0,x.yT)(F,"YYYY-MM-DD HH:mm:ss");if(F.match(/^\d+$/)){const U=parseInt(F,10);return(0,x.yT)(U)}const I=(0,x.yT)(F);return I.isValid()?I:null}const O=(B,F)=>F?B?F.slice(B+1):F:[],R=(B,F)=>B===u.uv?(0,t.uniq)(F.map(I=>I.datasource?.uid).filter(I=>!!I)):[B];async function L(B,F){const I=B.explore.panes[F].correlationEditorHelperData,U=B.explore.correlationEditorDetails?.editorMode||!1,W=Object.keys(B.explore.panes)[0]===F,A=U&&W,N=A?await(0,s.l)().get():void 0,K=U&&!W&&I!==void 0;let V={};return K&&I!==void 0&&Object.entries(I?.vars).forEach(T=>{V[T[0]]={value:T[1]}}),{defaultCorrelationEditorDatasource:N,scopedVars:V,showCorrelationEditorLinks:A}}},97414:(q,j,e)=>{"use strict";e.d(j,{JQ:()=>P,O1:()=>S,QL:()=>v,YV:()=>l,_O:()=>R});var t=e(2543),n=e.n(t),r=e(96540),a=e(41931),i=e(47370),x=e(47180),s=e(16753),c=e(46399),d=e(93407),u=e(39736),g=e(56276),o=e(61351),E=e(44853),m=e(33504),f=e(89146),p=e(9904);const D=[L=>!L.internal||o.TP.hasAccessToExplore()],C="grafana_data_link_clicked",l=(L,B)=>I=>{const{field:U,dataLinkScopedVars:W,frame:A,link:N,linkModel:K}=I,{valueRowIndex:V}=I.config;if(V===void 0)return K;const T=v({field:U,rowIndex:V,splitOpenFn:L,range:B,vars:W,dataFrame:A,linksToProcess:[N]});return T.length?(0,t.first)(T):void 0},v=L=>{const{field:B,vars:F,splitOpenFn:I,range:U,rowIndex:W,dataFrame:A}=L,N={...F||{}};N.__value={value:{raw:B.values[W]},text:"Raw value"};let K;if(A){if(K=(0,a.F)({frame:A,rowIndex:W}),N.__data={value:{name:A.name,refId:A.refId,fields:K},text:"Data"},A.meta?.type===i.m.LogLines){const z=(0,m.ww)(A)?.getLogFrameLabels();z!=null&&Object.entries(z[W]).forEach(w=>{N[w[0]]={value:w[1]}})}A.fields.forEach(T=>{K&&K[T.name]&&(N[T.name]={value:K[T.name]})}),N.__targetField={value:K[B.name]}}const V=L.linksToProcess||B.config.links;return V?V.filter(w=>D.every(H=>H(w,N))).map(w=>{let H={};w.meta?.transformations&&w.meta?.transformations.forEach(_=>{let ee;_.field?ee=A?.fields.find(Z=>Z.name===_.field)?.values[W]:ee=B.values[W],H={...H,...(0,E.k)(_,ee,B.name)}});const G={...N,...H},X=S(w,G);let k=[];if(X.variables.length===0){const _=B.name.toString();k.push({variableName:_,value:"",match:""})}else k=X.variables;if(X.allVariablesDefined)if(w.internal){const _=J=>{(0,g.rR)(C,{origin:w.origin||x.x0.Datasource,app:s.Jk.Explore,internal:!0}),I?.(J)};return{...(0,c.u)({link:w,internalLink:w.internal,scopedVars:G,range:U,field:B,onClickFn:L.splitOpenFn?J=>_(J):void 0,replaceVariables:(0,u.w)().replace.bind((0,u.w)())}),variables:k}}else{const _=(J,Z)=>(0,u.w)().replace(J,{...Z,...G,...N}),ee=(0,f.mQ)().getDataLinkUIModel(w,_,B);return ee.title||(ee.title=y(ee.href)),ee.target=ee.target??"_blank",{...ee,variables:k}}else return}).filter(w=>!!w):[]};function y(L){L.indexOf("://")<0&&(L=`http://${L}`);let B;try{B=new URL(L).hostname}catch{B=L}return B}function P(L,B){return(0,r.useCallback)((F,I)=>F.fields.flatMap(U=>U.config?.links&&U.config?.links.length?v({field:U,rowIndex:I,range:L,dataFrame:F,splitOpenFn:B}):[]),[L,B])}const b=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function S(L,B){let F=[];return(0,u.w)().replace.bind((0,u.w)())(M(L),B,void 0,F),F=(0,t.uniqBy)(F,"variableName"),{variables:F,allVariablesDefined:F.filter(U=>!b.includes(U.variableName)).every(U=>U.found)}}function M(L){let B="",F;for(F in L)typeof L[F]=="string"?B+=" "+L[F]:typeof L[F]=="object"&&(B+=" "+M(L[F]));return B}const O=L=>L[1]!==void 0,R=L=>{const B=Object.entries(L).filter(O).map(([F,I])=>{const U=(0,p.m)(I);return U.range={to:I.range.to.valueOf().toString(),from:I.range.from.valueOf().toString()},[F,U]}).reduce((F,[I,U])=>({...F,[I]:U}),{});return d.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(B)})}},65627:(q,j,e)=>{"use strict";e.d(j,{v:()=>n});var t=e(44099);function n(r){const a=new Set(r.map(i=>i.refId).filter(Boolean));return a.size===r.length?r:(a.clear(),r.map(i=>{if(i.refId&&!a.has(i.refId))return a.add(i.refId),i;const x=(0,t.M)(r);return a.add(x),{...i,refId:x}}))}},56826:(q,j,e)=>{"use strict";e.d(j,{Ez:()=>m,Oi:()=>E,Pm:()=>h,VW:()=>g});var t=e(2543),n=e.n(t),r=e(88483),a=e(44240),i=e(6276),x=e(29405),s=e(18163),c=e(8392),d=e(82856),u=e(55909);const g=[s.cF.LogsVolume,s.cF.LogsSample],o=D=>`grafana.explore.logs.enable${D}`,E=(D,C)=>{d.A.set(o(C),D?"true":"false")},m=()=>{let D={[s.cF.LogsVolume]:{enabled:!0},[s.cF.LogsSample]:{enabled:!1}};for(const C of g){if(C===s.cF.LogsSample)continue;d.A.get(o(C))==="false"&&(D[C]={enabled:!1})}return D},f=(D,C,l)=>new r.c(v=>D.subscribe(y=>{if(y.logsResult&&y.logsResult.rows&&y.logsResult.visibleRange&&y.logsResult.bucketSize!==void 0&&y.state===c.Gu.Done){const P=y.logsResult.bucketSize,b=C.map(O=>O.refId),S=(0,t.groupBy)(y.logsResult.rows,"dataFrame.refId");let M=[];b.forEach(O=>{if(S[O]?.length){const R=(0,u.J9)(S[O],P);M=[...M,...R];const L={logsVolumeType:s.Aj.Limited,absoluteRange:y.logsResult?.visibleRange,datasourceName:l,sourceQuery:C.find(B=>B.refId===O)};v.next({data:M.map(B=>{const F=B.meta?.custom||{};return{...B,meta:{custom:{...F,...L}}}}),state:y.state})}}),v.complete()}})),p=(D,C,l,v)=>{if(D===s.cF.LogsVolume)return f(C,l,v)},h=(D,C,l,v)=>{const P=D.map(({datasource:b,targets:S},M)=>{const O=(0,t.cloneDeep)(l);if(O.requestId=`${O.requestId||""}_${M}`,O.targets=S,(0,s.Nc)(b,C)){if(b.getDataProvider)return b.getDataProvider(C,O);if(b.getSupplementaryRequest){const R=b.getSupplementaryRequest(C,O);return R?C===s.cF.LogsVolume?(0,u.sg)(b,R,{targets:O.targets}):(0,u.Wr)(b,R):void 0}else return}else return p(C,v,S,b.name)}).filter(c.zz);if(P.length!==0)return P.length===1?P[0]:(0,a.h)(...P).pipe((0,x.S)((b,S)=>b.errors&&b.errors.length||S.state===c.Gu.NotStarted?b:S.state===c.Gu.Loading&&b.state===c.Gu.NotStarted?{...b,state:c.Gu.Loading}:S.state&&S.state!==c.Gu.Done?b:{...b,data:[...b.data,...S.data],state:c.Gu.Done},{data:[],state:c.Gu.NotStarted}),(0,i.d)())}},21475:(q,j,e)=>{"use strict";e.d(j,{Ex:()=>b,$i:()=>P});var t=e(65474),n=e(69862),r=e(41007),a=e(65502),i=e(39736),x=e(98437),s=e(74848),c=e(96540),d=e(60484),u=e(44826),g=e(96080),o=e(53434),E=e(31810),m=e(22025),f=e(87919),p=e(30632),h=e(44684),D=e(66456);const C=15;function l(){const S=(0,c.useRef)({}),M=(0,c.useCallback)(R=>{switch(R){case h.Tz.math:case h.Tz.reduce:case h.Tz.resample:case h.Tz.threshold:case h.Tz.sql:return S.current[R];case h.Tz.classic:return}},[]),O=(0,c.useCallback)((R,L)=>{switch(R){case h.Tz.math:S.current.math=L;break;case h.Tz.reduce:case h.Tz.resample:case h.Tz.threshold:S.current.reduce=L,S.current.resample=L,S.current.threshold=L;break;case h.Tz.sql:S.current.sql=L}},[]);return{getCachedExpression:M,setCachedExpression:O}}function v(S){const{query:M,queries:O,onRunQuery:R,onChange:L,app:B}=S,{getCachedExpression:F,setCachedExpression:I}=l();(0,c.useEffect)(()=>{I(M.type,M.expression)},[M.expression,M.type,I]);const U=(0,c.useCallback)(N=>{const K=F(N.value),V=(0,D.rV)({...M,type:N.value});L({...V,expression:K??V.expression})},[M,L,F]),W=()=>{const N=O.filter(K=>M.refId!==K.refId).map(K=>({value:K.refId,label:K.refId}));switch(M.type){case h.Tz.math:return(0,s.jsx)(o.z,{onChange:L,query:M,labelWidth:C,onRunQuery:R});case h.Tz.reduce:return(0,s.jsx)(E.Z,{refIds:N,onChange:L,labelWidth:C,query:M,app:B});case h.Tz.resample:return(0,s.jsx)(m.C,{query:M,labelWidth:C,onChange:L,refIds:N});case h.Tz.classic:return(0,s.jsx)(g.z,{onChange:L,query:M,refIds:N});case h.Tz.threshold:return(0,s.jsx)(p.O,{onChange:L,query:M,labelWidth:C,refIds:N});case h.Tz.sql:return(0,s.jsx)(f.k,{onChange:L,query:M,refIds:N})}},A=h.uQ.find(N=>N.value===M.type);return(0,s.jsxs)("div",{children:[(0,s.jsx)(d.I,{label:"Operation",labelWidth:C,children:(0,s.jsx)(u.l6,{options:h.uQ,value:A,onChange:U,width:25})}),W()]})}class y extends a.iy{constructor(M){super(M),this.instanceSettings=M}applyTemplateVariables(M,O){const R=(0,i.w)();return{...M,expression:R.replace(M.expression,O),window:R.replace(M.window,O)}}getCollapsedText(M){return`Expression: ${M.type}`}query(M){let O=M.targets.map(async L=>{const B=await(0,x.l)().get(L.datasource);return B.interpolateVariablesInQueries?B?.interpolateVariablesInQueries([L],M.scopedVars,M.filters)[0]:L});return(0,t.H)(Promise.all(O)).pipe((0,n.Z)(L=>super.query({...M,targets:L})))}newQuery(M){return{refId:"--",datasource:a.dR,type:M?.type??h.Tz.math,...M}}}const P={id:-100,uid:h.Uj,name:a.dR.name,type:a.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:r.QE.datasource,name:a.dR.type,id:a.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},b=new y(P);b.meta={id:a.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},b.components={QueryEditor:v}},96080:(q,j,e)=>{"use strict";e.d(j,{z:()=>C});var t=e(74848),n=e(77222),r=e(60484),a=e(54594),i=e(79784),x=e(66456),s=e(22803),c=e(29675),d=e(48583),u=e(31035),g=e(44826),o=e(34128),E=e(71481);const m=E.A.reducerTypes.map(l=>({label:l.text,value:l.value})),f=E.A.evalOperators.map(l=>({label:l.text,value:l.value})),p=E.A.evalFunctions.map(l=>({label:l.text,value:l.value})),h=({condition:l,index:v,onChange:y,onRemoveCondition:P,refIds:b})=>{const S=(0,c.of)(D),M=U=>{y({...l,operator:{type:U.value}})},O=U=>{y({...l,reducer:{type:U.value,params:[]}})},R=U=>{y({...l,query:{params:[U.value]}})},L=U=>{y({...l,evaluator:{params:l.evaluator.params,type:U.value}})},B=(U,W)=>{const A=parseFloat(U.currentTarget.value),N=[...l.evaluator.params];N[W]=A,y({...l,evaluator:{...l.evaluator,params:N}})},F=(0,s.css)({width:"75px"}),I=l.evaluator.type===E.p.IsWithinRange||l.evaluator.type===E.p.IsOutsideRange||l.evaluator.type===E.p.IsOutsideRangeIncluded||l.evaluator.type===E.p.IsWithinRangeIncluded;return(0,t.jsxs)(d.B,{children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)(n.C,{children:[v===0?(0,t.jsx)("div",{className:(0,s.cx)(S.button,F),children:"WHEN"}):(0,t.jsx)(u.f,{className:(0,s.cx)(S.buttonSelectText,F),options:f,onChange:M,value:f.find(U=>U.value===l.operator.type)}),(0,t.jsx)(g.l6,{options:m,onChange:O,width:20,value:m.find(U=>U.value===l.reducer.type)}),(0,t.jsx)("div",{className:S.button,children:"OF"}),(0,t.jsx)(g.l6,{onChange:R,options:b,width:"auto",value:b.find(U=>U.value===l.query.params[0])})]}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(u.f,{className:S.buttonSelectText,options:p,onChange:L,value:p.find(U=>U.value===l.evaluator.type)}),I?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.p,{type:"number",width:10,onChange:U=>B(U,0),value:l.evaluator.params[0]}),(0,t.jsx)("div",{className:S.button,children:"TO"}),(0,t.jsx)(o.p,{type:"number",width:10,onChange:U=>B(U,1),value:l.evaluator.params[1]})]}):l.evaluator.type!==E.p.HasNoValue?(0,t.jsx)(o.p,{type:"number",width:10,onChange:U=>B(U,0),value:l.evaluator.params[0]}):null]})]}),(0,t.jsx)(a.$n,{variant:"secondary",type:"button",onClick:()=>P(v),children:(0,t.jsx)(i.I,{name:"trash-alt"})})]})},D=l=>{const v=(0,s.css)({color:l.colors.primary.text,fontSize:l.typography.bodySmall.fontSize});return{buttonSelectText:v,button:(0,s.cx)((0,s.css)({display:"flex",alignItems:"center",borderRadius:l.shape.radius.default,fontWeight:l.typography.fontWeightMedium,border:`1px solid ${l.colors.border.weak}`,whiteSpace:"nowrap",padding:`0 ${l.spacing(1)}`,backgroundColor:l.colors.background.canvas}),v)}},C=({onChange:l,query:v,refIds:y})=>{const P=(M,O)=>{v.conditions&&l({...v,conditions:[...v.conditions.slice(0,O),M,...v.conditions.slice(O+1)]})},b=()=>{if(v.conditions){const M=v.conditions.at(-1)?.query?.params??[],O={...x.P0,query:{params:M}};l({...v,conditions:v.conditions.length>0?[...v.conditions,O]:[O]})}},S=M=>{if(v.conditions){const O=v.conditions[M],R=v.conditions.filter(L=>L!==O).map((L,B)=>B===0?{...L,operator:{type:"when"}}:L);l({...v,conditions:R})}};return(0,t.jsxs)("div",{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(r.I,{label:"Conditions",labelWidth:14,children:(0,t.jsx)("div",{children:v.conditions?.map((M,O)=>{if(M)return(0,t.jsx)(h,{index:O,condition:M,onChange:R=>P(R,O),onRemoveCondition:S,refIds:y},O)})})})}),(0,t.jsx)(a.$n,{variant:"secondary",type:"button",onClick:b,children:(0,t.jsx)(i.I,{name:"plus-circle"})})]})}},53434:(q,j,e)=>{"use strict";e.d(j,{z:()=>g});var t=e(74848),n=e(22803),r=e(29675),a=e(48583),i=e(60484),x=e(76302),s=e(26676),c=e(79784),d=e(50926);const u="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",g=({labelWidth:f,onChange:p,query:h,onRunQuery:D})=>{const C=y=>{p({...h,expression:y.target.value})},l=(0,r.of)(E),v=()=>{h.expression&&D()};return(0,t.jsx)(a.B,{children:(0,t.jsx)(i.I,{label:(0,t.jsx)(x.c,{width:"auto",children:(0,t.jsx)(s.G,{fitContent:!0,content:(0,t.jsxs)("div",{className:l.documentationContainer,children:[(0,t.jsxs)("div",{children:["Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"$A + $B"})]}),(0,t.jsx)("header",{className:l.documentationHeader,children:"Available Math functions"}),(0,t.jsxs)("div",{className:l.documentationFunctions,children:[(0,t.jsx)(o,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),(0,t.jsx)(o,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),(0,t.jsx)(o,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),(0,t.jsx)(o,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),(0,t.jsx)(o,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(o,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(o,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."})]})]}),title:(0,t.jsxs)(a.B,{gap:1,direction:"row",children:[(0,t.jsx)(c.I,{name:"book-open"})," Math operator"]}),footer:(0,t.jsxs)("div",{children:["See our additional documentation on"," ",(0,t.jsxs)("a",{className:l.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer",children:[(0,t.jsx)(c.I,{size:"xs",name:"external-link-alt"})," Math expressions"]}),"."]}),closeButton:!0,placement:"bottom-start",children:(0,t.jsxs)("div",{className:l.info,children:["Expression ",(0,t.jsx)(c.I,{name:"info-circle"})]})})}),labelWidth:f,grow:!0,shrink:!0,children:(0,t.jsx)(d.f,{value:h.expression,onChange:C,rows:1,placeholder:u,onBlur:v,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},o=({name:f,description:p})=>{const h=(0,r.of)(m);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:h.name,children:f}),(0,t.jsx)("span",{className:h.description,children:p})]})},E=f=>({documentationHeader:(0,n.css)({fontSize:f.typography.h5.fontSize,fontWeight:f.typography.h5.fontWeight}),documentationLink:(0,n.css)({color:f.colors.text.link}),documentationContainer:(0,n.css)({display:"flex",flex:1,flexDirection:"column",gap:f.spacing(2),padding:f.spacing(1,2)}),documentationFunctions:(0,n.css)({display:"grid",gridTemplateColumns:"max-content auto",columnGap:f.spacing(2)}),info:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer",gap:f.spacing(1)})}),m=f=>({name:(0,n.css)({fontWeight:f.typography.fontWeightBold}),description:(0,n.css)({fontSize:f.typography.bodySmall.fontSize,color:f.colors.text.disabled})})},31810:(q,j,e)=>{"use strict";e.d(j,{Z:()=>g});var t=e(74848),n=e(16753),r=e(60484),a=e(34128),i=e(37e3),x=e(54731),s=e(77222),c=e(44826),d=e(11817),u=e(44684);const g=({labelWidth:o="auto",onChange:E,app:m,refIds:f,query:p})=>{const h=u.Cu.find(M=>M.value===p.reducer),D=M=>{E({...p,expression:M.value})},C=M=>{E({...p,reducer:M.value})},l=M=>{E({...p,settings:M})},v=M=>{let O;switch(M.value){case u.Mt.Strict:O={mode:u.Mt.Strict};break;case u.Mt.ReplaceNonNumbers:let R=0;p.settings?.mode===u.Mt.ReplaceNonNumbers&&(R=p.settings?.replaceWithValue??0),O={mode:u.Mt.ReplaceNonNumbers,replaceWithValue:R};break;default:O={mode:M.value}}l(O)},y=M=>{const O=M.currentTarget.valueAsNumber;l({mode:u.Mt.ReplaceNonNumbers,replaceWithValue:O??0})},P=p.settings?.mode??u.Mt.Strict,b=()=>{if(P===u.Mt.ReplaceNonNumbers)return(0,t.jsx)(r.I,{label:"Replace With",labelWidth:o,children:(0,t.jsx)(a.p,{type:"number",width:10,onChange:y,value:p.settings?.replaceWithValue??0})})},S=()=>{const M=m===n.Jk.UnifiedAlerting;return P!==u.Mt.Strict||M?null:(0,t.jsx)(i.F,{title:(0,d.t)("reduce.strictMode.title","Strict Mode Behaviour"),severity:"info",children:(0,t.jsxs)(d.x6,{i18nKey:"reduce.strictMode.description",children:["When ",(0,t.jsx)("code",{children:"Reduce Strict mode"})," is used, the ",(0,t.jsx)("code",{children:"fill(null)"})," function (InfluxQL) will result in"," ",(0,t.jsx)("code",{children:"NaN"}),"."," ",(0,t.jsx)(x.Y,{href:"https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/expression-queries/#reduction-modes",children:"See the documentation for more details."})]})})};return(0,t.jsxs)(t.Fragment,{children:[S(),(0,t.jsx)(s.C,{children:(0,t.jsx)(r.I,{label:"Input",labelWidth:o,children:(0,t.jsx)(c.l6,{onChange:D,options:f,value:p.expression,width:"auto"})})}),(0,t.jsxs)(s.C,{children:[(0,t.jsx)(r.I,{label:"Function",labelWidth:o,children:(0,t.jsx)(c.l6,{options:u.Cu,value:h,onChange:C,width:20})}),(0,t.jsx)(r.I,{label:"Mode",labelWidth:o,children:(0,t.jsx)(c.l6,{onChange:v,options:u.HZ,value:P,width:25})}),b()]})]})}},22025:(q,j,e)=>{"use strict";e.d(j,{C:()=>s});var t=e(74848),n=e(77222),r=e(60484),a=e(44826),i=e(34128),x=e(44684);const s=({labelWidth:c="auto",onChange:d,refIds:u,query:g})=>{const o=x.PN.find(D=>D.value===g.downsampler),E=x.iX.find(D=>D.value===g.upsampler),m=D=>{d({...g,window:D.target.value})},f=D=>{d({...g,expression:D.value})},p=D=>{d({...g,downsampler:D.value})},h=D=>{d({...g,upsampler:D.value})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(r.I,{label:"Input",labelWidth:c,children:(0,t.jsx)(a.l6,{onChange:f,options:u,value:g.expression,width:20})})}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(r.I,{label:"Resample to",labelWidth:c,tooltip:"10s, 1m, 30m, 1h",children:(0,t.jsx)(i.p,{onChange:m,value:g.window,width:15})}),(0,t.jsx)(r.I,{label:"Downsample",children:(0,t.jsx)(a.l6,{options:x.PN,value:o,onChange:p,width:25})}),(0,t.jsx)(r.I,{label:"Upsample",children:(0,t.jsx)(a.l6,{options:x.iX,value:E,onChange:h,width:25})})]})]})}},87919:(q,j,e)=>{"use strict";e.d(j,{k:()=>a});var t=e(74848),n=e(96540),r=e(84467);const a=({onChange:i,refIds:x,query:s})=>{const d=`select * from ${(0,n.useMemo)(()=>x.map(g=>g.value),[x])[0]} limit 1`,u=g=>{i({...s,expression:g})};return(0,t.jsx)(r.Y,{query:s.expression||d,onChange:u})}},30632:(q,j,e)=>{"use strict";e.d(j,{O:()=>L});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(29675),x=e(77222),s=e(60484),c=e(44826),d=e(34128),u=e(29010),g=e(48583),o=e(88023),E=e(11817),m=e(71481),f=e(44684),p=e(83819),h=e(24825),D=e(65307);const C=(0,D.VP)("thresold/updateRefId"),l=(0,D.VP)("thresold/updateThresholdType"),v=(0,D.VP)("thresold/updateThresholdParams"),y=(0,D.VP)("thresold/updateHysteresis"),P=(0,D.VP)("thresold/updateUnloadParams"),b=(0,D.vy)({type:f.Tz.threshold,refId:"",conditions:[]},I=>{I.addCase(C,(U,W)=>{U.expression=W.payload}),I.addCase(l,(U,W)=>{const A=W.payload.evalFunction,N=W.payload.onError;if(U.conditions[0].evaluator.type=A,!!U.conditions[0].unloadEvaluator){const V=S(U.conditions[0].evaluator.type);N&&N(void 0),U.conditions[0].evaluator.type=A;const T={type:V,params:U.conditions[0].evaluator?.params??[0,0]};U.conditions[0].unloadEvaluator=T}}),I.addCase(v,(U,W)=>{const{param:A,index:N}=W.payload;U.conditions[0].evaluator.params[N]=A}),I.addCase(y,(U,W)=>{const{hysteresisChecked:A,onError:N}=W.payload;A?U.conditions[0].unloadEvaluator={type:S(U.conditions[0].evaluator.type),params:U.conditions[0].evaluator?.params??[0,0]}:(U.conditions[0].unloadEvaluator=void 0,N&&N(void 0))}),I.addCase(P,(U,W)=>{const{param:A,index:N,onError:K}=W.payload;U.conditions[0].unloadEvaluator?U.conditions[0].unloadEvaluator.params[N]=A:U.conditions[0].unloadEvaluator={type:S(U.conditions[0].evaluator.type),params:U.conditions[0].evaluator?.params??[0,0]};const V=M(U.conditions[0]),{errorMsg:T,errorMsgFrom:z,errorMsgTo:w}=V??{};K&&K(T||z||w)})});function S(I){return I===m.p.IsAbove?m.p.IsBelow:I===m.p.IsBelow?m.p.IsAbove:I===m.p.IsEqual?m.p.IsNotEqual:I===m.p.IsNotEqual?m.p.IsEqual:I===m.p.IsGreaterThanEqual?m.p.IsLessThanEqual:I===m.p.IsLessThanEqual?m.p.IsGreaterThanEqual:I===m.p.IsWithinRange?m.p.IsOutsideRange:I===m.p.IsOutsideRange?m.p.IsWithinRange:I===m.p.IsWithinRangeIncluded?m.p.IsOutsideRangeIncluded:I===m.p.IsOutsideRangeIncluded?m.p.IsWithinRangeIncluded:m.p.IsBelow}function M(I){const{unloadEvaluator:U,evaluator:W}=I;if(!W)return;if(U?.params[0]===void 0||Number.isNaN(U?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:A,params:N}=W,{params:K}=U;if(A===m.p.IsWithinRange||A===m.p.IsOutsideRange||A===m.p.IsWithinRangeIncluded||A===m.p.IsOutsideRangeIncluded){if(K[0]===void 0||Number.isNaN(K[0]))return{errorMsgFrom:"This value cannot be empty"};if(K[1]===void 0||Number.isNaN(K[1]))return{errorMsgTo:"This value cannot be empty"}}const[V,T]=U.params,[z,w]=N;switch(A){case m.p.IsAbove:if(V>z)return{errorMsg:`Enter a number less than or equal to ${z}`};break;case m.p.IsBelow:if(V<z)return{errorMsg:`Enter a number more than or equal to ${z}`};break;case m.p.IsEqual:if(V===z)return{errorMsg:`Enter a different number than ${z}`};break;case m.p.IsNotEqual:if(V!==z)return{errorMsg:`Enter the same number as ${z}`};break;case m.p.IsGreaterThanEqual:if(V>=z)return{errorMsg:`Enter a number less than ${z}`};break;case m.p.IsLessThanEqual:if(V<=z)return{errorMsg:`Enter a number more than ${z}`};break;case m.p.IsOutsideRange:if(V<z)return{errorMsgFrom:`Enter a number more than or equal to ${z}`};if(T>w)return{errorMsgTo:`Enter a number less than or equal to ${w}`};break;case m.p.IsWithinRange:if(V>z)return{errorMsgFrom:`Enter a number less than or equal to ${z}`};if(T<w)return{errorMsgTo:`Enter a number be more than or equal to ${w}`};break;case m.p.IsOutsideRangeIncluded:if(V<=z)return{errorMsgFrom:`Enter a number more than ${z}`};if(T>=w)return{errorMsgTo:`Enter a number less than ${w}`};break;case m.p.IsWithinRangeIncluded:if(V>=z)return{errorMsgFrom:`Enter a number less than ${z}`};if(T<=w)return{errorMsgTo:`Enter a number be more than ${w}`};break;default:throw new Error(`evaluator function type ${A} not supported.`)}}const O=m.p.IsAbove,R={type:"query",evaluator:{type:O,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},L=({labelWidth:I,onChange:U,refIds:W,query:A,onError:N,useHysteresis:K=!1})=>{const V=(0,i.of)(F),T={...A,conditions:A.conditions?.length?A.conditions:[R]},[z,w]=(0,a.useReducer)(b,T),H=z.conditions[0],G=f.zd.find(ae=>ae.value===z.conditions[0].evaluator?.type),X=ae=>{w(C(ae.value))};(0,a.useEffect)(()=>{z&&U(z)},[z]);const k=ae=>{w(l({evalFunction:ae.value??O,onError:N}))},_=(ae,re)=>{w(v({param:parseFloat(ae.currentTarget.value),index:re}))},ee=H.evaluator.type===m.p.IsWithinRange||H.evaluator.type===m.p.IsOutsideRange||H.evaluator.type===m.p.IsOutsideRangeIncluded||H.evaluator.type===m.p.IsWithinRangeIncluded,J=!!o.$W.featureToggles?.recoveryThreshold&&K,Z=(0,r.uniqueId)("threshold-");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.C,{children:(0,t.jsx)(s.I,{label:"Input",labelWidth:I,htmlFor:Z,children:(0,t.jsx)(c.l6,{inputId:Z,onChange:X,options:W,value:A.expression,width:20})})}),(0,t.jsxs)(x.C,{children:[(0,t.jsx)(p.E,{onChange:k,value:G}),ee?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.p,{type:"number",width:10,onChange:ae=>_(ae,0),defaultValue:H.evaluator.params[0]}),(0,t.jsx)(h.Y,{}),(0,t.jsx)(d.p,{type:"number",width:10,onChange:ae=>_(ae,1),defaultValue:H.evaluator.params[1]})]}):(0,t.jsx)(d.p,{type:"number",width:10,onChange:ae=>_(ae,0),defaultValue:H.evaluator.params[0]||0})]}),J&&(0,t.jsx)(te,{isRange:ee,onError:N})]});function te({isRange:ae,onError:re}){const ne=!!H.unloadEvaluator,ce=oe=>{w(y({hysteresisChecked:oe.currentTarget.checked,onError:re})),le.current=!0},le=a.useRef(!0),he=()=>{le.current=!1};return(0,t.jsxs)("div",{className:V.hysteresis,children:[(0,t.jsx)("div",{onMouseDown:he,children:(0,t.jsx)(u.K,{showLabel:!0,label:(0,E.t)("alerting.rule-form.threshold.recovery.title","Custom recovery threshold"),value:ne,onChange:ce,className:V.switch})}),ne&&(0,t.jsx)(B,{isRange:ae,condition:H,onError:re,dispatch:w,allowOnblur:le})]})}};function B({isRange:I,condition:U,onError:W,dispatch:A,allowOnblur:N}){const K=(0,i.of)(F),V=(k,_)=>{const ee=parseFloat(k.currentTarget.value);A(P({param:ee,index:_,onError:W}))},T=M(U),{errorMsg:z,errorMsgFrom:w,errorMsgTo:H}=T??{};if(I)return(0,t.jsx)(G,{allowOnblur:N});return(0,t.jsx)(X,{allowOnblur:N});function G({allowOnblur:k}){switch(U.evaluator.type){case m.p.IsWithinRange:if(U.evaluator.type===m.p.IsWithinRange)return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-outside-range","Stop alerting when outside range"),labelWidth:"auto",children:(0,t.jsxs)(g.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!w,error:w,className:K.noMargin,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,0),defaultValue:U.unloadEvaluator?.params[0]})})}),(0,t.jsx)(h.Y,{}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!H,error:H,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,1),defaultValue:U.unloadEvaluator?.params[1]})})})]})})});case m.p.IsOutsideRange:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-inside-range","Stop alerting when inside range"),labelWidth:"auto",children:(0,t.jsxs)(g.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!w,error:w,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,0),defaultValue:U.unloadEvaluator?.params[0]})})}),(0,t.jsx)(h.Y,{}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!H,error:H,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,1),defaultValue:U.unloadEvaluator?.params[1]})})})]})})});case m.p.IsOutsideRangeIncluded:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-inside-range","Stop alerting when inside range"),labelWidth:"auto",children:(0,t.jsxs)(g.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!w,error:w,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,0),defaultValue:U.unloadEvaluator?.params[0]})})}),(0,t.jsx)(h.Y,{}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!H,error:H,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,1),defaultValue:U.unloadEvaluator?.params[1]})})})]})})});case m.p.IsWithinRangeIncluded:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-outside-range","Stop alerting when outside range"),labelWidth:"auto",children:(0,t.jsxs)(g.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!w,error:w,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,0),defaultValue:U.unloadEvaluator?.params[0]})})}),(0,t.jsx)(h.Y,{}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(s.I,{invalid:!!H,error:H,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>k.current&&V(_,1),defaultValue:U.unloadEvaluator?.params[1]})})})]})})});default:return null}}function X({allowOnblur:k}){switch(U.evaluator.type){case m.p.IsAbove:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-bellow","Stop alerting when below"),labelWidth:"auto",invalid:!!z,error:z,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>{k.current&&V(_,0)},defaultValue:U.unloadEvaluator?.params[0]})})});case m.p.IsBelow:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-above","Stop alerting when above"),labelWidth:"auto",invalid:!!z,error:z,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>{k.current&&V(_,0)},defaultValue:U.unloadEvaluator?.params[0]})})});case m.p.IsEqual:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-equal","Stop alerting when equal to"),labelWidth:"auto",invalid:!!z,error:z,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>{k.current&&V(_,0)},defaultValue:U.unloadEvaluator?.params[0]})})});case m.p.IsNotEqual:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-not-equal","Stop alerting when not equal to"),labelWidth:"auto",invalid:!!z,error:z,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>{k.current&&V(_,0)},defaultValue:U.unloadEvaluator?.params[0]})})});case m.p.IsGreaterThanEqual:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-less","Stop alerting when less than"),labelWidth:"auto",invalid:!!z,error:z,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>{k.current&&V(_,0)},defaultValue:U.unloadEvaluator?.params[0]})})});case m.p.IsLessThanEqual:return(0,t.jsx)(x.C,{className:K.hysteresis,children:(0,t.jsx)(s.I,{label:(0,E.t)("alerting.rule-form.threshold.recovery.stop-alerting-more","Stop alerting when more than"),labelWidth:"auto",invalid:!!z,error:z,children:(0,t.jsx)(d.p,{type:"number",width:10,onBlur:_=>{k.current&&V(_,0)},defaultValue:U.unloadEvaluator?.params[0]})})});default:return null}}}const F=I=>({range:(0,n.css)({width:"min-content"}),hysteresis:(0,n.css)({marginTop:I.spacing(2)}),switch:(0,n.css)({paddingLeft:I.spacing(1)}),noMargin:(0,n.css)({margin:0})})},83819:(q,j,e)=>{"use strict";e.d(j,{E:()=>x});var t=e(74848),n=e(22803),r=e(29675),a=e(31035),i=e(44684);function x({onChange:c,value:d}){const u=(0,r.of)(s);return(0,t.jsx)(a.f,{className:u.buttonSelectText,options:i.zd,onChange:c,value:d})}const s=c=>({buttonSelectText:(0,n.css)({color:c.colors.primary.text,fontSize:c.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${c.spacing(1)}`})})},24825:(q,j,e)=>{"use strict";e.d(j,{Y:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(11817);function i(){const s=(0,r.of)(x);return(0,t.jsx)("div",{className:s.button,children:(0,t.jsx)(a.x6,{i18nKey:"alerting.threshold.to",children:"TO"})})}const x=s=>({button:(0,n.css)({height:"32px",color:s.colors.primary.text,fontSize:s.typography.bodySmall.fontSize,display:"flex",alignItems:"center",fontWeight:s.typography.fontWeightBold,padding:`0 ${s.spacing(1)}`})})},12175:(q,j,e)=>{"use strict";e.d(j,{f:()=>r,z:()=>a});var t=e(65502),n=e(44684);const r=i=>{if(!i)return!1;if((0,t.s9)(i.datasource))return!0;const x=i;return typeof x.type!="string"?!1:Object.values(n.Tz).includes(x.type)};function a(i){return["avg","min","max","sum","count","last","median","diff","diff_abs","percent_diff","percent_diff_abs","count_non_null"].includes(i)}},44684:(q,j,e)=>{"use strict";e.d(j,{Cu:()=>c,HZ:()=>u,Mt:()=>d,NI:()=>x,PN:()=>g,Tz:()=>i,Uj:()=>a,iX:()=>o,uQ:()=>s,zd:()=>E});var t=e(91357),n=e(88023),r=e(71481);const a="__expr__";var i=(m=>(m.math="math",m.reduce="reduce",m.resample="resample",m.classic="classic_conditions",m.threshold="threshold",m.sql="sql",m))(i||{});const x=m=>{switch(m){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},s=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(m=>m.value==="sql"?n.$W.featureToggles?.sqlExpressions:!0),c=[{value:t.gy.min,label:"Min",description:"Get the minimum value"},{value:t.gy.max,label:"Max",description:"Get the maximum value"},{value:t.gy.mean,label:"Mean",description:"Get the average value"},{value:t.gy.median,label:"Median",description:"Get the median value"},{value:t.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:t.gy.count,label:"Count",description:"Get the number of values"},{value:t.gy.last,label:"Last",description:"Get the last value"}];var d=(m=>(m.Strict="",m.ReplaceNonNumbers="replaceNN",m.DropNonNumbers="dropNN",m))(d||{});const u=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],g=[{value:t.gy.last,label:"Last",description:"Fill with the last value"},{value:t.gy.min,label:"Min",description:"Fill with the minimum value"},{value:t.gy.max,label:"Max",description:"Fill with the maximum value"},{value:t.gy.mean,label:"Mean",description:"Fill with the average value"},{value:t.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],o=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],E=[{value:r.p.IsAbove,label:"Is above"},{value:r.p.IsBelow,label:"Is below"},{value:r.p.IsEqual,label:"Is equal to"},{value:r.p.IsNotEqual,label:"Is not equal to"},{value:r.p.IsGreaterThanEqual,label:"Is above or equal to"},{value:r.p.IsLessThanEqual,label:"Is below or equal to"},{value:r.p.IsWithinRange,label:"Is within range"},{value:r.p.IsOutsideRange,label:"Is outside range"},{value:r.p.IsWithinRangeIncluded,label:"Is within range included"},{value:r.p.IsOutsideRangeIncluded,label:"Is outside range included"}]},66456:(q,j,e)=>{"use strict";e.d(j,{H3:()=>s,P0:()=>x,rV:()=>i});var t=e(91357),n=e(71481),r=e(12175),a=e(44684);const i=c=>{switch(c.type){case a.Tz.reduce:c.reducer||(c.reducer=t.gy.mean);break;case a.Tz.resample:c.downsampler||(c.downsampler=t.gy.mean),c.upsampler||(c.upsampler="fillna"),c.reducer=void 0;break;case a.Tz.math:c.expression=void 0;break;case a.Tz.classic:c.conditions||(c.conditions=[x]);break;default:c.reducer=void 0}return c},x={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:n.p.IsAbove}};function s(c){if((0,r.z)(c))return c}},64199:(q,j,e)=>{"use strict";e.d(j,{Cg:()=>s,Fk:()=>d,R4:()=>o,Rj:()=>x,pq:()=>c});var t=e(32370),n=e(11817),r=e(61351),a=e(23375),i=e(61491);const x="manage-folder",s=m=>`folder-dashboards-${m}`,c=m=>`folder-library-panels-${m}`,d=m=>`folder-alerting-${m}`,u=m=>`folder-permissions-${m}`,g=m=>`folder-settings-${m}`;function o(m,f){const p=f??("parents"in m?m.parents:void 0),h={icon:"folder",id:x,subTitle:(0,a.o)("manage-folder"),url:m.url,text:m.title,children:[{active:!1,icon:"apps",id:s(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:m.url}]};if(p&&p.length>0){const D=p[p.length-1],C=p.slice(0,p.length-1);h.parentItem=o(D,C)}return h.children.push({active:!1,icon:"library-panel",id:c(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${m.url}/library-panels`}),r.TP.hasPermission(i.AccessControlAction.AlertingRuleRead)&&t.$.unifiedAlertingEnabled&&h.children.push({active:!1,icon:"bell",id:d(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${m.url}/alerting`}),h}function E(m){const f=o({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return f.children[m].active=!0,{main:f,node:f.children[m]}}},31512:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>d,jl:()=>x});var t=e(65307),n=e(15664);const r={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},a=(u,g)=>({...u,...g.payload,hasChanged:!1}),i=(0,t.Z0)({name:"folder",initialState:r,reducers:{loadFolder:a,setFolderTitle:(u,g)=>({...u,title:g.payload,hasChanged:g.payload.trim().length>0})},extraReducers:u=>{u.addMatcher(n.vZ.getFolder.matchFulfilled,a)}}),{loadFolder:x,setFolderTitle:s}=i.actions,d={folder:i.reducer}},53304:(q,j,e)=>{"use strict";e.d(j,{G:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(44826),x=e(37e3),s=e(93124);const c=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:s.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],d=({value:g,onChange:o,context:E,item:m})=>{const f=(0,a.of)(u),[p,h]=(0,r.useState)(),D=m.settings;(0,r.useEffect)(()=>{async function v(){const y=await(0,s.q3)(g);h(y)}v()},[g,h]);const{current:C,options:l}=(0,r.useMemo)(()=>{let v=D?.options?[...D.options]:[...c],y=v?.find(P=>P.value===p?.path);return!y&&p&&(y={label:p.path,value:p.path},v.push(y)),{options:v,current:y}},[p,D?.options]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.l6,{value:C,options:l,onChange:v=>o(v.value),allowCustomValue:!0,formatCreateLabel:v=>`Load from URL: ${v}`}),p&&(0,t.jsxs)(t.Fragment,{children:[p.error&&(0,t.jsx)(x.F,{title:p.error,severity:"warning"}),p.count&&(0,t.jsxs)("div",{className:f.keys,children:[(0,t.jsxs)("b",{children:["(",p.count,")"]}),p.examples(10).map(v=>(0,t.jsxs)("span",{children:[v,","]},v)),p.count>10&&" ..."]})]})]})},u=g=>({keys:(0,n.css)({marginTop:g.spacing(.5),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap","> span":{marginLeft:g.spacing(.5)}})})},68723:(q,j,e)=>{"use strict";e.d(j,{G:()=>D});var t=e(63739),n=e(7500),r=e(53304),a=e(74848),i=e(22803),x=e(96540),s=e(58779),c=e(29675),d=e(37e3),u=e(79784),g=e(44826),o=e(19550),E=e(47362);const m=[{value:n.aG.Auto,label:"Auto",ariaLabel:s.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:n.aG.Coords,label:"Coords",ariaLabel:s.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:n.aG.Geohash,label:"Geohash",ariaLabel:s.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:n.aG.Lookup,label:"Lookup",ariaLabel:s.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],f="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",p=({value:C,onChange:l,context:v,item:y})=>{const[P,b]=(0,x.useState)();(0,x.useEffect)(()=>{y.settings?.source&&y.settings?.data?.length&&y.settings.data[0]&&(0,E.nE)(y.settings.source).then(O=>{y.settings&&y.settings.data&&b((0,E.FM)(y.settings.data[0],O))})},[y.settings]);const S=(0,c.of)(h),M=()=>{if(P){if(P.warning)return(0,a.jsx)(d.F,{title:P.warning,severity:"warning",buttonContent:(0,a.jsx)(u.I,{name:"question-circle",size:"xl"}),className:S.alert,onRemove:()=>{const O=window.open(f,"_blank","noopener,noreferrer");O&&(O.opener=null)}});if(C===n.aG.Auto&&P.description)return(0,a.jsx)("span",{children:P.description})}return null};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.l6,{options:m,value:C,onChange:O=>{l(O.value)}}),(0,a.jsx)(o.Gy,{className:S.hGroup,children:M()})]})},h=C=>({alert:(0,i.css)({"& div":{padding:C.spacing(.5)},marginBottom:"0px",marginTop:"5px",padding:C.spacing(.25)}),hGroup:(0,i.css)({"& div":{width:"100%"}})});function D(C,l,v,y,P){switch(v.addCustomEditor({id:"modeEditor",path:`${l}mode`,name:"Location Mode",editor:p,settings:{data:P,source:y}}),y?.mode){case n.aG.Coords:v.addFieldNamePicker({path:`${l}latitude`,name:"Latitude field",settings:{filter:b=>b.type===t.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${l}longitude`,name:"Longitude field",settings:{filter:b=>b.type===t.PU.number,noFieldsMessage:"No numeric fields found"}});break;case n.aG.Geohash:v.addFieldNamePicker({path:`${l}geohash`,name:"Geohash field",settings:{filter:b=>b.type===t.PU.string,noFieldsMessage:"No strings fields found"}});break;case n.aG.Lookup:v.addFieldNamePicker({path:`${l}lookup`,name:"Lookup field",settings:{filter:b=>b.type===t.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${l}gazetteer`,name:"Gazetteer",editor:r.G})}}},7014:(q,j,e)=>{"use strict";e.d(j,{RA:()=>o,XR:()=>E,Dc:()=>g,qy:()=>d,Pz:()=>u});var t=e(44294),n=e(34338),r=e(11217),a=e(22796),i=e(63739),x=e(30352);function s(f){if(!f?.length)return;const p=[16,8,4,2,1],h="0123456789bcdefghjkmnpqrstuvwxyz";let D=!0;const C=[],l=[];C[0]=-90,C[1]=90,l[0]=-180,l[1]=180;let v;f.split("").forEach(b=>{v=h.indexOf(b),p.forEach(S=>{c(D?l:C,v,S),D=!D})});const y=(C[0]+C[1])/2;return[(l[0]+l[1])/2,y]}function c(f,p,h){p&h?f[0]=(f[0]+f[1])/2:f[1]=(f[0]+f[1])/2}function d(f){return{name:f.name??"Point",type:i.PU.geo,values:f.values.map(p=>{const h=s(p);if(h)return new t.A((0,a.Rb)(h))}),config:m}}function u(f,p){const h=new Array(f.values.length);for(let D=0;D<f.values.length;D++){const C=f.values[D],l=p.values[D];C===null||l===null||(h[D]=new t.A((0,a.Rb)([C,l])))}return{name:"Point",type:i.PU.geo,values:h,config:m}}function g(f,p){const h=p.values.length,D=new Array(h);for(let C=0;C<h;C++)D[C]=f.find(p.values[C])?.geometry();return{name:"Geometry",type:i.PU.geo,values:D,config:m}}function o(f,p){const h=f.values,D=p.values;if(!h||!D)throw"missing src/dest";if(h.length!==D.length)throw"Source and destination field lengths do not match";const C=f.values.length,l=new Array(C);for(let v=0;v<C;v++){const y=h[v],P=D[v];y&&P?l[v]=new n.A([y,P]):y?l[v]=y:P&&(l[v]=P)}return{name:"Geometry",type:i.PU.geo,values:l,config:m}}function E(f,p){const h=f.values,D=p.values;if(!h||!D)throw"missing src/dest";if(h.length!==D.length)throw"Source and destination field lengths do not match";const C=f.values.length,l=new Array(C);for(let v=0;v<C;v++){const y=h[v],P=D[v];y&&P&&(l[v]=new r.A([(0,x.EX)(y),(0,x.EX)(P)]))}return{name:"Geometry",type:i.PU.geo,values:l,config:m}}const m=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},93124:(q,j,e)=>{"use strict";e.d(j,{fx:()=>f,q3:()=>p});var t=e(70915),n=e(44294),r=e(4038),a=e(63739),i=e(28082),x=e(11365);function s(h){const D=new x.A().readFeatures(h,{featureProjection:"EPSG:3857"}),C=D.length,l=new Array(C).fill(null),v=[],y=new Map,P=O=>{let R=y.get(O);return R||(R={types:new Set,values:new Array(C).fill(null),count:0},v.push(O),y.set(O,R)),R},b=(...O)=>{for(const R of O)if(!y.has(R))return R;return"___"+O[0]},S={types:new Set,values:new Array(C).fill(null),count:0};for(let O=0;O<C;O++){const R=D[O];l[O]=R.getGeometry();const L=R.getId();L!=null&&(S.values[O]=L,S.types.add((0,r.oE)(L)),S.count++);for(const B of R.getKeys()){const F=R.get(B);if(F===l[O]||F==null)continue;const I=P(B);I.values[O]=F,I.types.add((0,r.oE)(F)),I.count++}}const M=[];if(S.count>0){const O=c(S);M.push({name:b("id","_id","__id"),type:O,values:S.values,config:{}})}M.push({name:b("geo","geometry"),type:a.PU.geo,values:l,config:{}});for(const O of v){const R=y.get(O);if(!R)continue;const L=c(R);M.push({name:O,type:L,values:R.values,config:{}})}return{fields:M,length:C}}function c(h){return h.count<1?a.PU.other:h.types.size>1?(h.values=h.values.map(D=>D!=null?`${D}`:D),a.PU.string):h.types.values().next().value??a.PU.other}var d=e(7014),u=e(22796);function g(h,D){let C=0;const l=new Map;for(const v of D){const y=new n.A((0,u.Rb)([v.longitude,v.latitude])),P={point:()=>y,geometry:()=>y};if(v.name&&(l.set(v.name,P),l.set(v.name.toUpperCase(),P)),v.key&&(l.set(v.key,P),l.set(v.key.toUpperCase(),P)),v.keys)for(const b of v.keys)l.set(b,P),l.set(b.toUpperCase(),P);C++}return{path:h,find:v=>{let y=l.get(v);return!y&&typeof v=="string"&&(y=l.get(v.toUpperCase())),y},count:C,examples:v=>{const y=[];if(l.size<1)y.push("no values found");else for(const P of l.keys())if(y.push(P),y.length>=v)break;return y}}}function o(h,D){let C;if(Array.isArray(D)){const l=D[0];if(l.latitude&&l.longitude&&(l.key||l.keys))return g(h,D)}else Array.isArray(D?.features)&&D?.type==="FeatureCollection"&&(C=s(D));if(!C)try{C=(0,r.Vc)(D)}catch(l){return{path:h,error:`${l}`,find:v=>{},examples:v=>[]}}return E(C,{path:h})}function E(h,D){const C=[];let l,v,y,P,b;for(const O of h.fields)if(O.type===a.PU.geo&&(l=O),!b&&O.type===a.PU.string&&(b=O),O.name){D.keys&&D.keys.includes(O.name)&&C.push(O);const R=O.name.toUpperCase();switch(R){case"LAT":case"LATITUTE":v=O;break;case"LON":case"LNG":case"LONG":case"LONGITUE":y=O;break;case"GEOHASH":P=O;break;case"ID":case"UID":case"KEY":case"CODE":D.keys||C.push(O);break;default:D.keys||(R.endsWith("_ID")||R.endsWith("_CODE"))&&C.push(O)}}!C.length&&b&&C.push(b);let S=!1;l?S=l.values[0]?.getType()==="Point":P?(l=(0,d.qy)(P),S=!0):v&&y&&(l=(0,d.Pz)(y,v),S=!0);const M=new Map;return C.forEach(O=>{O.values.forEach((R,L)=>{const B=`${R}`;M.set(B.toUpperCase(),L),M.set(B,L)})}),{path:D.path,find:O=>{const R=M.get(O);if(R!=null){const L=l?.values[R];return{frame:h,index:R,point:()=>!L||S?L:new n.A((0,t.q1)(L.getExtent())),geometry:()=>L}}},examples:O=>{const R=[];for(let L of M.keys())if(R.push(L),R.length>O)break;return R},frame:()=>h,count:h.length}}const m={},f="public/gazetteer/countries.json";async function p(h){h||(h=f);let D=m[h];if(!D){try{const C=await(0,i.AI)().get(h);D=o(h,C)}catch(C){console.warn("Error loading placename lookup",h,C),D={path:h,error:"Error loading URL",find:l=>{},examples:l=>[]}}m[h]=D}return D}},47362:(q,j,e)=>{"use strict";e.d(j,{FM:()=>E,nE:()=>g});var t=e(23570),n=e(63739),r=e(40462),a=e(38075),i=e(7500),x=e(7014),s=e(93124);function c(m){return f=>{for(const p of f.fields)if(m(p,f,[]))return p}}function d(m){return f=>{for(const p of f.fields){if(m.has(p.name.toLowerCase()))return p;const h=(0,t.Ct)(p,f);if(m.has(h))return p}}}const u={mode:i.aG.Auto,geohash:d(new Set(["geohash"])),latitude:d(new Set(["latitude","lat"])),longitude:d(new Set(["longitude","lon","lng"])),h3:d(new Set(["h3"])),wkt:d(new Set(["wkt"])),lookup:d(new Set(["lookup"])),geo:m=>m.fields.find(f=>f.type===n.PU.geo)};async function g(m){const f={...u,mode:m?.mode??i.aG.Auto};switch(f.gazetteer=await(0,s.q3)(m?.gazetteer),f.mode){case i.aG.Geohash:m?.geohash?f.geohash=c((0,r.NS)({id:a.Ct.byName,options:m.geohash})):f.geohash=()=>{};break;case i.aG.Lookup:const p=m?.lookup?.length?(0,r.NS)({id:a.Ct.byName,options:m.lookup}):(0,r.NS)({id:a.Ct.byType,options:n.PU.string});f.lookup=c(p);break;case i.aG.Coords:m?.latitude?f.latitude=c((0,r.NS)({id:a.Ct.byName,options:m.latitude})):f.latitude=()=>{},m?.longitude?f.longitude=c((0,r.NS)({id:a.Ct.byName,options:m.longitude})):f.longitude=()=>{};break}return f}function o(m,f){const p={mode:f.mode??i.aG.Auto};if(p.mode===i.aG.Auto){if(p.geo=f.geo(m),p.geo)return p;if(p.latitude=f.latitude(m),p.longitude=f.longitude(m),p.latitude&&p.longitude)return p.mode=i.aG.Coords,p;if(p.geohash=f.geohash(m),p.geohash)return p.mode=i.aG.Geohash,p;if(p.lookup=f.lookup(m),p.lookup)return p.mode=i.aG.Lookup,p}switch(p.mode){case i.aG.Coords:p.latitude=f.latitude(m),p.longitude=f.longitude(m);break;case i.aG.Geohash:p.geohash=f.geohash(m);break;case i.aG.Lookup:p.lookup=f.lookup(m);break}return p}function E(m,f){const p=o(m,f);switch(p.mode){case i.aG.Auto:return p.geo?{field:p.geo}:{warning:"Unable to find location fields"};case i.aG.Coords:return p.latitude&&p.longitude?{field:(0,x.Pz)(p.longitude,p.latitude),derived:!0,description:`${p.mode}: ${p.latitude.name}, ${p.longitude.name}`}:{warning:"Select latitude/longitude fields"};case i.aG.Geohash:return p.geohash?{field:(0,x.qy)(p.geohash),derived:!0,description:`${p.mode}`}:{warning:"Select geohash field"};case i.aG.Lookup:return p.lookup?f.gazetteer?{field:(0,x.Dc)(f.gazetteer,p.lookup),derived:!0,description:`${p.mode}: ${f.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},16568:(q,j,e)=>{"use strict";e.d(j,{q:()=>B});var t=e(74848),n=e(2543),r=e(96540),a=e(70713),i=e(66564),x=e(54092),s=e(47286),c=e(58779),d=e(56276),u=e(39736),g=e(54594),o=e(20968),E=e(32991),m=e(88023),f=e(11817),p=e(55909),h=e(23570),D=e(29675),C=e(19550),l=e(86489),v=e(44826),y=e(29010),P=e(56180),b=e(22803);const S=I=>(0,b.css)({padding:I.spacing(0,2),fontSize:I.typography.bodySmall.fontSize,color:I.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis"}),M=({children:I})=>{const U=(0,D.of)(S);return(0,t.jsx)("div",{className:U,children:I})};var O=e(18117);const R=({options:I,actions:U,formattedDataDescription:W,onOptionsChange:A,hasTransformations:N,data:K,dataFrames:V,transformationOptions:T,selectedDataFrame:z,onDataFrameChange:w,downloadForExcel:H,toggleDownloadForExcel:G})=>{const X=(0,D.of)(O.A);let k=V;z===i.F.joinByField&&(k=K);const _=k.map((Z,te)=>({value:te,label:`${(0,h.Ri)(Z)} (${te})`})),ee=[...T,..._];function J(){let Z="";if(!K)return Z;const te=[];return z===i.F.joinByField?te.push((0,f.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):K.length>1&&te.push((0,h.Ri)(K[z])),(I.withTransforms||I.withFieldConfig)&&(I.withTransforms&&te.push((0,f.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),I.withTransforms&&I.withFieldConfig,I.withFieldConfig&&te.push((0,f.t)("dashboard.inspect-data.formatted","Formatted data"))),H&&te.push((0,f.t)("dashboard.inspect-data.excel-header","Excel header")),te.join(", ")}return(0,t.jsx)("div",{className:X.dataDisplayOptions,children:(0,t.jsx)(P.u,{id:"Data options",index:0,title:(0,f.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,t.jsx)(M,{children:J()}),isOpen:!1,actions:U,children:(0,t.jsx)("div",{className:X.options,"data-testid":"dataOptions",children:(0,t.jsxs)(C.gW,{spacing:"none",children:[K.length>1&&(0,t.jsx)(l.D,{label:(0,f.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,t.jsx)(v.l6,{options:ee,value:z,onChange:w,width:30,"aria-label":(0,f.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,t.jsxs)(C.Gy,{children:[N&&A&&(0,t.jsx)(l.D,{label:(0,f.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,f.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,t.jsx)(y.d,{value:!!I.withTransforms,onChange:()=>A({...I,withTransforms:!I.withTransforms})})}),A&&(0,t.jsx)(l.D,{label:(0,f.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:W||(0,f.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,t.jsx)(y.d,{id:"formatted-data-toggle",value:!!I.withFieldConfig,onChange:()=>A({...I,withFieldConfig:!I.withFieldConfig})})}),(0,t.jsx)(l.D,{label:(0,f.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,f.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,t.jsx)(y.d,{id:"excel-toggle",value:H,onChange:G})})]})]})})})})};var L=e(53569);class B extends r.PureComponent{constructor(U){super(U),this.onExportLogsAsTxt=()=>{const{data:W,dataName:A,app:N}=this.props;(0,d.rR)("grafana_logs_download_logs_clicked",{app:N,format:"logs",area:"inspector"});const K=(0,p.HT)(W||[]);(0,L.Zy)(K,A)},this.onExportTracesAsJson=()=>{const{data:W,dataName:A,app:N}=this.props;if(W)for(const K of W){if(K.meta?.preferredVisualisationType!=="trace")continue;const V=(0,L.ek)(K,A+"-traces");(0,d.rR)("grafana_traces_download_traces_clicked",{app:N,grafana_version:m.$W.buildInfo.version,trace_format:V,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:W,dataName:A,app:N}=this.props;(0,d.rR)("grafana_traces_download_service_graph_clicked",{app:N,grafana_version:m.$W.buildInfo.version,location:"inspector"}),W&&(0,L.ny)(W,A)},this.onDataFrameChange=W=>{this.setState({transformId:W.value===i.F.joinByField?i.F.joinByField:i.F.noop,dataFrameIndex:typeof W.value=="number"?W.value:0,selectedDataFrame:W.value})},this.onToggleDownloadForExcel=()=>{this.setState(W=>({downloadForExcel:!W.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:i.F.noop,transformationOptions:F(),transformedData:U.data??[],downloadForExcel:!1}}componentDidUpdate(U,W){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(U.data!==this.props.data||W.transformId!==this.state.transformId){const A=this.state.transformationOptions.find(N=>N.value===this.state.transformId);if(A&&A.transformer.id!==i.F.noop){const N=this.state.selectedDataFrame,K=this.state.dataFrameIndex,V=(0,x.m)([A.transformer],this.props.data).subscribe(T=>{this.setState({transformedData:T,selectedDataFrame:N,dataFrameIndex:K},()=>V.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(U,W){const{dataName:A}=this.props,{transformId:N}=this.state,K=U[this.state.dataFrameIndex];W&&(0,d.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,L.EM)(K,A,{useExcelHeader:this.state.downloadForExcel},N)}getProcessedData(){const{options:U,panelPluginId:W,fieldConfig:A,timeZone:N}=this.props,K=this.state.transformedData;if(!U.withFieldConfig)return(0,s.K3)(K);let V=A??{defaults:{},overrides:[]};return W==="table"&&A&&(V=this.cleanTableConfigFromFieldConfig(A)),(0,s.we)({data:K,theme:m.$W.theme2,fieldConfig:V,timeZone:N,replaceVariables:(T,z,w)=>(0,u.w)().replace(T,z,w)})}cleanTableConfigFromFieldConfig(U){U=(0,n.cloneDeep)(U),U.defaults.custom={};for(const W of U.overrides)for(const A of W.properties)if(A.id.startsWith("custom.")){const N=W.properties.indexOf(A);W.properties.slice(N,1)}return U}renderActions(U,W,A,N){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.$n,{variant:"primary",onClick:()=>this.exportCsv(U,W),size:"sm",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),W&&!m.$W.exploreHideLogsDownload&&(0,t.jsx)(g.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),A&&(0,t.jsx)(g.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),N&&(0,t.jsx)(g.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,t.jsx)(f.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:U,options:W,data:A,formattedDataDescription:N,onOptionsChange:K,hasTransformations:V}=this.props,{dataFrameIndex:T,transformationOptions:z,selectedDataFrame:w,downloadForExcel:H}=this.state,G=(0,O.c)();if(U)return(0,t.jsxs)("div",{children:[(0,t.jsx)(o.y,{inline:!0})," Loading"]});const X=this.getProcessedData();if(!X||!X.length)return(0,t.jsx)("div",{children:"No Data"});const k=X[T]?T:0,_=X[k],ee=X.some(te=>te?.meta?.preferredVisualisationType==="logs"),J=X.some(te=>te?.meta?.preferredVisualisationType==="trace"),Z=X.some(te=>te?.meta?.preferredVisualisationType==="nodeGraph");return(0,t.jsxs)("div",{className:G.wrap,"aria-label":c.Tp.components.PanelInspector.Data.content,children:[(0,t.jsx)("div",{className:G.toolbar,children:(0,t.jsx)(R,{data:A,hasTransformations:V,options:W,dataFrames:X,transformationOptions:z,selectedDataFrame:w,downloadForExcel:H,formattedDataDescription:N,onOptionsChange:K,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(X,ee,J,Z)})}),(0,t.jsx)("div",{className:G.content,children:(0,t.jsx)(a.default,{children:({width:te,height:ae})=>te===0?null:(0,t.jsx)(E.X,{width:te,height:ae,data:_,showTypeIcons:!0})})})]})}}function F(){return[{value:i.F.joinByField,label:(0,f.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:i.F.joinByField,options:{byField:void 0}}}]}},94681:(q,j,e)=>{"use strict";e.d(j,{N:()=>m});var t=e(74848),n=e(22803),r=e(58779),a=e(11817),i=e(16869),x=e(63739),s=e(59141),c=e(29675);const d=({timeZone:p,name:h,stats:D})=>{const C=(0,c.$j)(),l=(0,c.of)(g);return!D||!D.length?null:(0,t.jsxs)("div",{className:l.wrapper,children:[(0,t.jsx)("div",{className:l.heading,children:h}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:D.map((v,y)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:v.displayName}),(0,t.jsx)("td",{className:l.cell,children:u(v,p,C)})]},`${v.displayName}-${y}`))})})]})};function u(p,h,D){const C=(0,i.J)({field:{type:x.PU.number,config:p},theme:D,timeZone:h});return(0,s.cN)(C(p.value))}const g=p=>({heading:(0,n.css)({fontSize:p.typography.body.fontSize,marginBottom:p.spacing(1)}),wrapper:(0,n.css)({paddingBottom:p.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),o=({name:p,traceIds:h})=>{const D=(0,c.of)(E);return h.length===0?null:(0,t.jsxs)("div",{className:D.wrapper,children:[(0,t.jsx)("div",{className:D.heading,children:p}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:h.map((C,l)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:C})},`${C}-${l}`))})})]})},E=p=>({heading:(0,n.css)({fontSize:p.typography.body.fontSize,marginBottom:p.spacing(1)}),wrapper:(0,n.css)({paddingBottom:p.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),m=({data:p,timeZone:h})=>{if(!p.request)return null;let D=[];const C=p.request.endTime?p.request.endTime-p.request.startTime:-1,l=p.timings?.dataProcessingTime||-1;let v=0;for(const M of p.series)v+=M.length;C>0&&D.push({displayName:(0,a.t)("dashboard.inspect-stats.request-time","Total request time"),value:C,unit:"ms"}),l>0&&D.push({displayName:(0,a.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:l,unit:"ms"}),D.push({displayName:(0,a.t)("dashboard.inspect-stats.queries","Number of queries"),value:p.request.targets?.length??0}),D.push({displayName:(0,a.t)("dashboard.inspect-stats.rows","Total number rows"),value:v});let y=[];for(const M of p.series)M.meta&&M.meta.stats&&(y=y.concat(M.meta.stats));const P=(0,a.t)("dashboard.inspect-stats.table-title","Stats"),b=(0,a.t)("dashboard.inspect-stats.data-title","Data source stats"),S=(0,a.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,t.jsxs)("div",{"aria-label":r.Tp.components.PanelInspector.Stats.content,className:f,children:[(0,t.jsx)(d,{timeZone:h,name:P,stats:D}),(0,t.jsx)(d,{timeZone:h,name:b,stats:y}),(0,t.jsx)(o,{name:S,traceIds:p.traceIds??[]})]})},f=(0,n.css)({height:"100%",overflowY:"scroll"})},64050:(q,j,e)=>{"use strict";e.d(j,{e:()=>p});var t=e(74848),n=e(22803),r=e(96540),a=e(64423),i=e(8392),x=e(58779),s=e(32370),c=e(48583),d=e(54594),u=e(93604),g=e(81876),o=e(67676),E=e(11817),m=e(75911),f=e(18117);class p extends r.PureComponent{constructor(D){super(D),this.subs=new a.yU,this.setFormattedJson=C=>{this.formattedJson=C},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(C=>({...C,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(C=>({...C,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(m.IB.getInspectorStream().subscribe({next:D=>{let C=!0;if(this.props.instanceId&&D?.requestId&&(C=D.requestId.startsWith(this.props.instanceId)),C)return this.onDataSourceResponse(D.response)}}))}componentDidUpdate(D){this.props.data!==D.data&&this.updateQueryList()}updateQueryList(){const{data:D}=this.props,C=D.series,l=[];if(C?.length){let v;C.forEach((y,P)=>{const b=y.meta?.executedQueryString;if(b){const S=y.refId||"?";v?.refId===S?(v.frames++,v.rows+=y.length):(v={refId:S,frames:0,rows:y.length,query:b},l.push(v))}})}this.setState({executedQueries:l})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(D){D.config?.hideFromInspector||(D={...D},D.headers&&delete D.headers,D.config&&(D.request=D.config,delete D.config,delete D.request.transformRequest,delete D.request.transformResponse,delete D.request.paramSerializer,delete D.request.jsonpCallbackParam,delete D.request.headers,delete D.request.requestId,delete D.request.inspect,delete D.request.retry,delete D.request.timeout),D.data&&(D.response=D.data,delete D.config,delete D.data,delete D.status,delete D.statusText,delete D.ok,delete D.url,delete D.redirected,delete D.type,delete D.$$config),this.setState({response:D}))}renderExecutedQueries(D){if(!D.length)return null;const C={refId:(0,n.css)({fontWeight:s.$.theme.typography.weight.semibold,color:s.$.theme.colors.textBlue,marginRight:"8px"})};return(0,t.jsx)("div",{children:D.map(l=>(0,t.jsxs)(c.B,{gap:1,direction:"column",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:C.refId,children:[l.refId,":"]}),l.frames>1&&(0,t.jsxs)("span",{children:[l.frames," frames, "]}),(0,t.jsxs)("span",{children:[l.rows," rows"]})]}),(0,t.jsx)("pre",{children:l.query})]},l.refId))})}render(){const{allNodesExpanded:D,executedQueries:C,response:l}=this.state,{onRefreshQuery:v,data:y}=this.props,P=this.getNrOfOpenNodes(),b=(0,f.A)(s.$.theme2),S=Object.keys(l).length>0,M=y.state===i.Gu.Loading;return(0,t.jsxs)("div",{className:b.wrap,children:[(0,t.jsxs)("div",{"aria-label":x.Tp.components.PanelInspector.Query.content,children:[(0,t.jsx)("h3",{className:b.heading,children:"Query inspector"}),(0,t.jsx)("p",{className:"small muted",children:(0,t.jsx)(E.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(C),(0,t.jsxs)("div",{className:b.toolbar,children:[(0,t.jsx)(d.$n,{icon:"sync",onClick:v,"aria-label":x.Tp.components.PanelInspector.Query.refreshButton,children:(0,t.jsx)(E.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),S&&D&&(0,t.jsx)(d.$n,{icon:"minus",variant:"secondary",className:b.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(E.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),S&&!D&&(0,t.jsx)(d.$n,{icon:"plus",variant:"secondary",className:b.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(E.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),S&&(0,t.jsx)(u.b,{getText:this.getTextForClipboard,className:b.toolbarItem,icon:"copy",variant:"secondary",children:(0,t.jsx)(E.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})}),(0,t.jsx)("div",{className:"flex-grow-1"})]}),(0,t.jsxs)("div",{className:b.content,children:[M&&(0,t.jsx)(g._,{text:"Loading query inspector..."}),!M&&S&&(0,t.jsx)(o.B,{json:l,open:P,onDidRender:this.setFormattedJson}),!M&&!S&&(0,t.jsx)("p",{className:"muted",children:(0,t.jsx)(E.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},18117:(q,j,e)=>{"use strict";e.d(j,{A:()=>i,c:()=>a});var t=e(22803),n=e(90617),r=e(88023);const a=(0,n.N)(()=>i(r.$W.theme2)),i=x=>({heading:(0,t.css)({fontSize:x.typography.body.fontSize,marginBottom:x.spacing(1)}),wrap:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,t.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:x.v1.spacing.sm}),toolbarItem:(0,t.css)({marginLeft:x.v1.spacing.md}),content:(0,t.css)({flexGrow:1,height:"100%"}),editor:(0,t.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,t.css)({overflow:"scroll"}),dataFrameSelect:(0,t.css)({flexGrow:2}),leftActions:(0,t.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,t.css)({paddingTop:x.v1.spacing.sm}),dataDisplayOptions:(0,t.css)({flexGrow:1,minWidth:"300px",marginRight:x.v1.spacing.sm}),selects:(0,t.css)({display:"flex","> *":{marginRight:x.v1.spacing.sm}})})},76530:(q,j,e)=>{"use strict";e.d(j,{q:()=>t});var t=(n=>(n.Data="data",n.Meta="meta",n.Error="error",n.Stats="stats",n.JSON="json",n.Query="query",n.Help="help",n))(t||{})},53569:(q,j,e)=>{"use strict";e.d(j,{ny:()=>I,EM:()=>F,Zy:()=>B,ek:()=>U});var t=e(4213),n=e.n(t),r=e(88090),a=e(66564),i=e(60590),x=e(36669),s=e(341),c=e(2543);const u=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function g(){return defaultConfig}function o(W){return _get(g(),W)}function E(W){let A;const N=new Set(W.map(({spanID:K})=>K));for(let K=0;K<W.length;K++){if(W[K].references&&W[K].references.some(({traceID:w,spanID:H})=>w===W[K].traceID&&N.has(H)))continue;if(!A){A=W[K];continue}const T=W[K].references&&W[K].references.length||0,z=A.references&&A.references.length||0;(T<z||T===z&&W[K].startTime<A.startTime)&&(A=W[K])}return A?`${A.process.serviceName}: ${A.operationName}`:""}const m=(0,c.memoize)(E,W=>W.length?W[0].traceID:0);function f(W){const A=new Map,N=W.reduce((V,T)=>(V.some(z=>z.key===T.key&&z.value===T.value)?A.set(`${T.key}:${T.value}`,`Duplicate tag "${T.key}:${T.value}"`):V.push(T),V),[]),K=Array.from(A.values());return{dedupedTags:N,warnings:K}}function p(W,A){const N=W?.slice()??[],K=(A||[]).map(V=>V.toLowerCase());return N.sort((V,T)=>{const z=V.key.toLowerCase(),w=T.key.toLowerCase();for(let H=0;H<K.length;H++){const G=K[H];if(z.startsWith(G)&&!w.startsWith(G))return-1;if(!z.startsWith(G)&&w.startsWith(G))return 1}return z>w?1:z<w?-1:0}),N}function h(W){if(!W?.traceID)return null;const A=W.traceID.toLowerCase();let N=0,K=Number.MAX_SAFE_INTEGER;const V=new Map,T=new Map;W.spans=W.spans.filter(_=>!!_.startTime),W.processes=Object.entries(W.processes).reduce((_,[ee,J])=>(_[ee]={...J,tags:p(J.tags)},_),{});const z=W.spans.length;for(let _=0;_<z;_++){const ee=W.spans[_],{startTime:J,duration:Z,processID:te}=ee;let ae=ee.spanID;J<K&&(K=J),J+Z>N&&(N=J+Z);const re=V.get(ae);re!=null?(console.warn(`Dupe spanID, ${re+1} x ${ae}`,ee,T.get(ae)),_isEqual(ee,T.get(ae))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),V.set(ae,re+1),ae=`${ae}_${re}`,ee.spanID=ae):V.set(ae,1),ee.process=W.processes[te],T.set(ae,ee)}const w=getTraceSpanIdsAsTree(W,T),H=[],G={};w.walk((_,ee,J=0)=>{if(_==="__root__"||typeof _!="string")return;const Z=T.get(_);if(!Z)return;const{serviceName:te}=Z.process;G[te]=(G[te]||0)+1,Z.relativeStartTime=Z.startTime-K,Z.depth=J-1,Z.hasChildren=ee.children.length>0,Z.childSpanCount=ee.children.length,Z.warnings=Z.warnings||[],Z.tags=Z.tags||[],Z.references=Z.references||[],Z.childSpanIds=ee.children.slice().sort((re,ne)=>{const ce=T.get(re.value),le=T.get(ne.value);return le.startTime+le.duration-(ce.startTime+ce.duration)}).map(re=>re.value);const ae=f(Z.tags);Z.tags=p(ae.dedupedTags,getConfigValue("topTagPrefixes")),Z.warnings=Z.warnings.concat(ae.warnings),Z.references.forEach((re,ne)=>{const ce=T.get(re.spanID);ce&&(re.span=ce,ne>0&&(ce.subsidiarilyReferencedBy=ce.subsidiarilyReferencedBy||[],ce.subsidiarilyReferencedBy.push({spanID:_,traceID:A,span:Z,refType:re.refType})))}),H.push(Z)});const X=getTraceName(H);return{services:Object.keys(G).map(_=>({name:_,numberOfSpans:G[_]})),spans:H,traceID:A,traceName:X,processes:W.processes,duration:N-K,startTime:K,endTime:N}}function D(W){const A=W.spans.map(K=>C(K,W.processes)),N=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const K of A)N.add(K);return N}function C(W,A){const N=W.references?.find(K=>K.refType==="CHILD_OF")?.spanID;return{spanID:W.spanID,traceID:W.traceID,parentSpanID:N,operationName:W.operationName,startTime:W.startTime/1e3,duration:W.duration/1e3,logs:W.logs.map(K=>({...K,timestamp:K.timestamp/1e3})),tags:W.tags,warnings:W.warnings??void 0,stackTraces:W.stackTraces,references:W.references?.filter(K=>K.spanID!==N)??[],serviceName:A[W.processID].serviceName,serviceTags:A[W.processID].tags}}function l(W,A){const N=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:A.uid,datasourceName:A.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),K=W.map(v).sort((V,T)=>T?.startTime-V?.startTime);for(const V of K)N.add(V);return N}function v(W){const A=transformTraceData(W);if(A)return{traceID:A.traceID,startTime:A.startTime/1e3,duration:A.duration,traceName:A.traceName}}function y(W){let A={traceID:"",spans:[],processes:{},warnings:null},N=[];for(let K=0;K<W.length;K++){const V=W.get(K);A.traceID||(A.traceID=V.traceID),N.find(T=>T===V.serviceName)||(N.push(V.serviceName),A.processes[`p${N.length}`]={serviceName:V.serviceName,tags:V.serviceTags}),A.spans.push({traceID:V.traceID,spanID:V.spanID,duration:V.duration*1e3,references:V.parentSpanID?[{refType:"CHILD_OF",spanID:V.parentSpanID,traceID:V.traceID}]:[],flags:0,logs:V.logs.map(T=>({...T,timestamp:T.timestamp*1e3})),operationName:V.operationName,processID:Object.keys(A.processes).find(T=>A.processes[T].serviceName===V.serviceName)||"",startTime:V.startTime*1e3,tags:V.tags,warnings:V.warnings?V.warnings:null})}return{data:[A],total:0,limit:0,offset:0,errors:null}}function P(W){const A=W.map(b),N=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const K of A)N.add(K);return N}function b(W){const A={traceID:W.traceId,spanID:W.id,parentSpanID:W.parentId,operationName:W.name,serviceName:W.localEndpoint?.serviceName||W.remoteEndpoint?.serviceName||"unknown",serviceTags:M(W),startTime:W.timestamp/1e3,duration:W.duration/1e3,logs:W.annotations?.map(S)??[],tags:Object.keys(W.tags||{}).reduce((N,K)=>K==="error"?(N.push({key:"error",value:!0}),N.push({key:"errorValue",value:W.tags.error}),N):(N.push({key:K,value:W.tags[K]}),N),[])};return W.kind&&(A.tags=[{key:"kind",value:W.kind},...A.tags??[]]),W.shared&&(A.tags=[{key:"shared",value:W.shared},...A.tags??[]]),A}function S(W){return{timestamp:W.timestamp,fields:[{key:"annotation",value:W.value}]}}function M(W){const A=W.localEndpoint||W.remoteEndpoint;return A?[O("ipv4",A.ipv4),O("ipv6",A.ipv6),O("port",A.port),O("endpointType",W.localEndpoint?"local":"remote")].filter(N=>!!N):[]}function O(W,A){if(A)return{key:W,value:A}}const R=W=>{let A=[];for(let N=0;N<W.length;N++){const K=W.get(N);A.push({traceId:K.traceID,parentId:K.parentSpanID,name:K.operationName,id:K.spanID,timestamp:K.startTime*1e3,duration:K.duration*1e3,...L(K),annotations:K.logs.length?K.logs.map(V=>({timestamp:V.timestamp,value:V.fields[0].value})):void 0,tags:K.tags.length?K.tags.filter(V=>V.key!=="kind"&&V.key!=="endpointType"&&V.key!=="shared").reduce((V,T)=>T.key==="error"?{...V,[T.key]:K.tags.find(z=>z.key==="errorValue").value||""}:{...V,[T.key]:T.value},{}):void 0,kind:K.tags.find(V=>V.key==="kind")?.value,shared:K.tags.find(V=>V.key==="shared")?.value})}return A},L=W=>{const A=W.serviceTags.find(N=>N.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return W.serviceName!=="unknown"?{[A]:{serviceName:W.serviceName,ipv4:W.serviceTags.find(N=>N.key==="ipv4")?.value,ipv6:W.serviceTags.find(N=>N.key==="ipv6")?.value,port:W.serviceTags.find(N=>N.key==="port")?.value}}:void 0};function B(W,A){let N="";W.meta?.forEach(T=>{const z=`${T.label}: ${JSON.stringify(T.value)}
`;N=N+z}),N=N+`

`,W.rows.forEach(T=>{const z=T.timeEpochMs+"	"+T.entry+`
`;N=N+z});const K=new Blob([N],{type:"text/plain;charset=utf-8"}),V=`${A}-logs-${(0,r.LE)(new Date)}.txt`;n()(K,V)}function F(W,A,N,K=a.F.noop){const V=(0,i._O)([W],N),T=N?.useExcelHeader?"\uFEFF":"",z=new Blob([T,V],{type:"text/csv;charset=utf-8"}),w=K!==a.F.noop?"-as-"+K.toLocaleLowerCase():"",H=`${A}-data${w}-${(0,r.LE)(new Date)}.csv`;n()(z,H)}function I(W,A){const N=new Blob([JSON.stringify(W)],{type:"application/json"}),K=`${A}-${(0,r.LE)(new Date)}.json`;n()(N,K)}function U(W,A){let N="otlp";switch(W.meta?.custom?.traceFormat){case"jaeger":{let K=y(new x.k(W));I(K,A),N="jaeger";break}case"zipkin":{let K=R(new x.k(W));I(K,A),N="zipkin";break}case"otlp":default:{let K=(0,s.xw)(new x.k(W));I(K,A);break}}return N}},13468:(q,j,e)=>{"use strict";e.d(j,{p:()=>r});var t=e(52718),n=e(22492);function r(i){let x="";try{x=JSON.stringify(i,a(),2)}catch(s){s instanceof Error&&(s.toString().includes("RangeError")||s.toString().includes("allocation size overflow"))?n.A.emit(t.r1.alertError,[s.toString(),"Cannot display JSON, the object is too big."]):n.A.emit(t.r1.alertError,[s instanceof Error?s.toString():s])}return x}function a(){const i=new WeakSet;return(x,s)=>{if(x==="__dataContext"||x==="__sceneObject")return"Filtered out in JSON serialization";if(typeof s=="object"&&s!==null){if(i.has(s))return;i.add(s)}return s}}},17097:(q,j,e)=>{"use strict";e.d(j,{G7:()=>a,KU:()=>i,eb:()=>x});var t=e(28082),n=e(87638),r=e(61491);const a=(0,r.createAsyncThunk)("users/fetchInvitees",async()=>n.TP.hasPermission(r.AccessControlAction.OrgUsersAdd)?await(0,t.AI)().get("/api/org/invites"):[]),i=(0,r.createAsyncThunk)("users/addInvitee",async(s,{dispatch:c})=>{await(0,t.AI)().post("/api/org/invites",s),await c(a())}),x=(0,r.createAsyncThunk)("users/revokeInvite",async s=>(await(0,t.AI)().patch(`/api/org/invites/${s}/revoke`,{}),s))},85545:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>c,Tp:()=>a});var t=e(65307),n=e(17097);const r=(0,t.pU)({selectId:d=>d.code}),a=r.getSelectors(),i=r.getInitialState({status:"idle"}),c={invites:(0,t.Z0)({name:"invites",initialState:i,reducers:{},extraReducers:d=>{d.addCase(n.G7.pending,u=>{u.status="loading"}).addCase(n.G7.fulfilled,(u,{payload:g})=>{r.setAll(u,g),u.status="succeeded"}).addCase(n.G7.rejected,u=>{u.status="failed"}).addCase(n.eb.fulfilled,(u,{payload:g})=>{r.removeOne(u,g),u.status="succeeded"})}}).reducer}},34741:(q,j,e)=>{"use strict";e.d(j,{b:()=>p,o:()=>h});var t=e(74848),n=e(96540),r=e(40996),a=e(16817),i=e(28082),x=e(32370),s=e(86489),c=e(34128),d=e(48583),u=e(54594),g=e(25356),o=e(62851),E=e(11817),m=e(81569),f=e(72504);const p=({panel:D,initialFolderUid:C,onCreateLibraryPanel:l,onDismiss:v})=>{const[y,P]=(0,n.useState)(C),[b,S]=(0,n.useState)(D.title),[M,O]=(0,n.useState)(D.title),[R,L]=(0,n.useState)(!1);(0,n.useEffect)(()=>L(!0),[b]),(0,r.A)(()=>O(b),350,[b]);const{saveLibraryPanel:B}=(0,f.b)(),F=(0,n.useCallback)(()=>{D.libraryPanel={uid:"",name:b},B(D,y).then(W=>{(0,i.NF)(W)?D.libraryPanel=void 0:(v?.(),l?.(W))})},[D,b,B,y,v,l]),I=(0,a.A)(async()=>{try{return!(await(0,m.e9)(b)).some(W=>W.folderUid===y)}catch(W){return(0,i.NF)(W)&&(W.isHandled=!0),!0}finally{L(!1)}},[M,y]);console.log("isValidName:",I);const U=!I?.value&&I.value!==void 0&&b===M&&!R;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.D,{label:(0,E.t)("library-panel.add-modal.name","Library panel name"),invalid:U,error:U?(0,E.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,t.jsx)(c.p,{id:"share-panel-library-panel-name-input",name:"name",value:b,onChange:W=>S(W.currentTarget.value)})}),(0,t.jsx)(s.D,{label:(0,E.t)("library-panel.add-modal.folder","Save in folder"),description:(0,E.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,t.jsx)(o.d,{onChange:W=>P(W),value:y,inputId:"share-panel-library-panel-folder-picker"})}),x.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(d.B,{gap:1,justifyContent:"start",children:[(0,t.jsx)(u.$n,{onClick:F,disabled:U,children:(0,t.jsx)(E.x6,{i18nKey:"share-panel.new-library-panel.create-button",children:"Create library panel"})}),(0,t.jsx)(u.$n,{variant:"secondary",onClick:v,fill:"outline",children:(0,t.jsx)(E.x6,{i18nKey:"share-panel.new-library-panel.cancel-button",children:"Cancel"})})]}):(0,t.jsxs)(g.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:v,fill:"outline",children:(0,t.jsx)(E.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,t.jsx)(u.$n,{onClick:F,disabled:U,children:(0,t.jsx)(E.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},h=({isOpen:D=!1,panel:C,initialFolderUid:l,...v})=>(0,t.jsx)(g.a,{title:"Create library panel",isOpen:D,onDismiss:v.onDismiss,children:(0,t.jsx)(p,{panel:C,initialFolderUid:l,onDismiss:v.onDismiss})})},78935:(q,j,e)=>{"use strict";e.d(j,{E:()=>L});var t=e(74848),n=e(22803),r=e(96540),a=e(70255),i=e(32370),x=e(29675),s=e(79784),c=e(8270),d=e(71815),u=e(84132),g=e(78603),o=e(8392),E=e(25356),m=e(54594),f=e(18949),p=e(73973),h=e(81569),D=e(65307);const C={loadingState:o.Gu.Loading,dashboardTitles:[]},l=(0,D.VP)("libraryPanels/delete/searchCompleted"),v=(I=C,U)=>l.match(U)?{...I,dashboardTitles:U.payload.dashboards.map(W=>W.title),loadingState:o.Gu.Done}:I;function y(I){return async function(U){const W=await(0,h.xV)(I.uid);U(l({dashboards:W}))}}const P=({libraryPanel:I,onDismiss:U,onConfirm:W})=>{const A=(0,x.of)(f.o),[{dashboardTitles:N,loadingState:K},V]=(0,r.useReducer)(v,C),T=(0,r.useMemo)(()=>(0,p.QC)(V),[V]);(0,r.useEffect)(()=>{T(y(I))},[T,I]);const z=!!N.length,w=K===o.Gu.Done;return(0,t.jsxs)(E.a,{className:A.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:U,isOpen:!0,children:[w?null:(0,t.jsx)(b,{}),w?(0,t.jsxs)("div",{children:[z?(0,t.jsx)(M,{dashboardTitles:N}):null,z?null:(0,t.jsx)(S,{}),(0,t.jsxs)(E.a.ButtonRow,{children:[(0,t.jsx)(m.$n,{variant:"secondary",onClick:U,fill:"outline",children:"Cancel"}),(0,t.jsx)(m.$n,{variant:"destructive",onClick:W,disabled:z,children:"Delete"})]})]}):null]})},b=()=>(0,t.jsx)("span",{children:"Loading library panel..."}),S=()=>{const I=(0,x.of)(f.o);return(0,t.jsx)("div",{className:I.modalText,children:"Do you want to delete this panel?"})},M=({dashboardTitles:I})=>{const U=(0,x.of)(f.o),W=I.length===1?"dashboard.":"dashboards.",A=`${I.length} ${W}`;return I.length===0?null:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:U.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,t.jsx)("strong",{children:A})," Remove the library panel from the dashboards listed below and retry."]}),(0,t.jsxs)("table",{className:U.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:I.map((N,K)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:N})},`dash-title-${K}`))})]})]})},O=({libraryPanel:I,onClick:U,onDelete:W,showSecondaryActions:A})=>{const[N,K]=(0,r.useState)(!1),V=()=>{W?.(I),K(!1)},T=i.$.panels[I.model.type]??(0,u.$)(I.model.type).meta;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.b,{isCurrent:!1,title:I.name,description:I.description,plugin:T,onClick:()=>U?.(I),onDelete:A?()=>K(!0):void 0,children:(0,t.jsx)(B,{libraryPanel:I})}),N&&(0,t.jsx)(P,{libraryPanel:I,onConfirm:V,onDismiss:()=>K(!1)})]})},R=({showSecondaryActions:I,rootProps:U})=>{const W=(0,x.of)(F);return(0,t.jsx)(g.b.Skeleton,{hasDelete:I,...U,children:(0,t.jsx)(a.A,{containerClassName:W.metaContainer,width:80})})},L=(0,d.j)(O,R);function B({libraryPanel:I}){const U=(0,x.of)(F);return!I.meta?.folderUid&&!I.meta?.folderName?null:I.meta.folderUid?(0,t.jsx)("span",{className:U.metaContainer,children:(0,t.jsxs)(c.N,{href:`/dashboards/f/${I.meta.folderUid}`,children:[(0,t.jsx)(s.I,{name:"folder-upload",size:"sm"}),(0,t.jsx)("span",{children:I.meta.folderName})]})}):(0,t.jsxs)("span",{className:U.metaContainer,children:[(0,t.jsx)(s.I,{name:"folder",size:"sm"}),(0,t.jsx)("span",{children:"Dashboards"})]})}function F(I){return{metaContainer:(0,n.css)({display:"flex",alignItems:"center",color:I.colors.text.secondary,fontSize:I.typography.bodySmall.fontSize,paddingTop:I.spacing(.5),svg:{marginRight:I.spacing(.5),marginBottom:3}})}}},43518:(q,j,e)=>{"use strict";e.d(j,{j:()=>M,s:()=>S});var t=e(74848),n=e(22803),r=e(96540),a=e(40996),i=e(29675),x=e(19550),s=e(22560),c=e(76459),d=e.n(c),u=e(54594),g=e(44826),o=e(79784),E=e(88023),m=e(11817),f=e(75911),p=e(92914),h=e(61491);function D({onChange:B,maxMenuHeight:F}){const I=(0,i.of)(l),[U,W]=(0,r.useState)(!1),A=(0,r.useCallback)(z=>C(z,W),[]),N=(0,r.useMemo)(()=>d()(A,300),[A]),[K,V]=(0,r.useState)([]),T=(0,r.useCallback)(z=>{const w=z.filter(H=>!!H.value).map(H=>H.value);B(w),V(z)},[B]);return(0,t.jsxs)("div",{className:I.container,children:[K.length>0&&(0,t.jsx)(u.$n,{size:"xs",icon:"trash-alt",fill:"text",className:I.clear,onClick:()=>B([]),"aria-label":"Clear folders",children:(0,t.jsx)(m.x6,{i18nKey:"folder-filter.clear-folder-button",children:"Clear folders"})}),(0,t.jsx)(g.Iv,{value:K,onChange:T,isLoading:U,loadOptions:N,maxMenuHeight:F,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:(0,t.jsx)(o.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0})]})}async function C(B,F){if(F(!0),E.$W.featureToggles.unifiedStorageSearchUI){const K=(await(0,p.S)().search({query:B,kind:["folder"],limit:100,permission:h.PermissionLevelString.View})).view.map(V=>({label:V.name,value:{uid:V.uid,title:V.name}}));return(!B||"dashboards".includes(B.toLowerCase()))&&K.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),F(!1),K}const I={query:B,type:"folder",permission:h.PermissionLevelString.View},W=(await(0,f.AI)().search(I)).map(A=>({label:A.title,value:{uid:A.uid,title:A.title}}));return(!B||"dashboards".includes(B.toLowerCase()))&&W.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),F(!1),W}function l(B){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:B.spacing(1.5),position:"absolute",top:-B.spacing(4.5),right:0})}}var v=e(90935),y=e(89963),P=e(40828),b=e(89081),S=(B=>(B.Tight="tight",B.Spacious="spacious",B))(S||{});const M=({onClick:B,variant:F="spacious",currentPanelId:I,currentFolderUID:U,perPage:W=P.FG,showPanelFilter:A=!1,showFolderFilter:N=!1,showSort:K=!1,showSecondaryActions:V=!1})=>{const T=(0,i.of)(O,F),[z,w]=(0,r.useState)(""),[H,G]=(0,r.useState)("");(0,a.A)(()=>G(z),200,[z]);const[X,k]=(0,r.useState)({}),[_,ee]=(0,r.useState)(U?[U]:[]),[J,Z]=(0,r.useState)([]),te=K||A||N,ae=F==="tight"?"lg":"xs";return(0,t.jsx)("div",{className:T.container,children:(0,t.jsxs)(x.gW,{spacing:ae,children:[(0,t.jsxs)("div",{className:(0,n.cx)(T.gridContainer,{[T.tightLayout]:F==="tight"}),children:[(0,t.jsx)("div",{className:T.filterInputWrapper,children:(0,t.jsx)(s.Z,{value:z,onChange:w,placeholder:"Search by name or description",width:0,escapeRegex:!1})}),te&&(0,t.jsx)(R,{showSort:K,showPanelFilter:A,showFolderFilter:N,onSortChange:k,onFolderFilterChange:ee,onPanelFilterChange:Z,sortDirection:X.value,variant:F})]}),(0,t.jsx)("div",{className:T.libraryPanelsView,children:(0,t.jsx)(b.y,{onClickCard:B,searchString:H,sortDirection:X.value,panelFilter:J,folderFilter:_,currentPanelId:I,showSecondaryActions:V,perPage:W})})]})})};function O(B,F){return{filterInputWrapper:(0,n.css)({flexGrow:F==="tight"?1:"initial"}),container:(0,n.css)({width:"100%",overflowY:"auto",padding:B.spacing(1)}),libraryPanelsView:(0,n.css)({width:"100%"}),gridContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:B.spacing(1),rowGap:B.spacing(1),paddingBottom:B.spacing(2)}),tightLayout:(0,n.css)({flexDirection:"row",rowGap:B.spacing(1)})}}const R=(0,r.memo)(({variant:B="spacious",showSort:F,showPanelFilter:I,showFolderFilter:U,sortDirection:W,onSortChange:A,onFolderFilterChange:N,onPanelFilterChange:K})=>{const V=(0,i.of)(L),T=(0,r.useCallback)(w=>K(w.map(H=>H.id)),[K]),z=(0,r.useCallback)(w=>N(w.map(H=>H.uid??"")),[N]);return(0,t.jsxs)("div",{className:(0,n.cx)(V.container,{[V.containerTight]:B==="tight"}),children:[F&&(0,t.jsx)(y.r,{value:W,onChange:A,filter:["alpha-asc","alpha-desc"]}),(U||I)&&(0,t.jsxs)("div",{className:(0,n.cx)(V.filterContainer,{[V.filterContainerTight]:B==="tight"}),children:[U&&(0,t.jsx)(D,{onChange:z}),I&&(0,t.jsx)(v.$,{onChange:T})]})]})});R.displayName="SearchControls";function L(B){return{container:(0,n.css)({display:"flex",gap:B.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,n.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,n.css)({display:"flex",flexDirection:"row",gap:B.spacing(1)}),filterContainerTight:(0,n.css)({flexDirection:"column",marginLeft:"initial"})}}},89081:(q,j,e)=>{"use strict";e.d(j,{y:()=>f});var t=e(74848),n=e(22803),r=e(96540),a=e(40996),i=e(8392),x=e(29675),s=e(59830),c=e(54731),d=e(48583),u=e(16110),g=e(11817),o=e(78935),E=e(73973),m=e(59046);const f=({onClickCard:h,searchString:D,sortDirection:C,panelFilter:l,folderFilter:v,showSecondaryActions:y,currentPanelId:P,perPage:b=40})=>{const S=(0,x.of)(p),[{libraryPanels:M,page:O,perPage:R,numberOfPages:L,loadingState:B,currentPanelId:F},I]=(0,r.useReducer)(m.w_,{...m.Xb,currentPanelId:P,perPage:b}),U=(0,r.useMemo)(()=>(0,E.QC)(I),[I]);(0,a.A)(()=>U((0,E.IF)({searchString:D,sortDirection:C,panelFilter:l,folderFilterUIDs:v,page:O,perPage:R,currentPanelId:F})),300,[D,C,l,v,O,U]);const W=({uid:K})=>U((0,E.h4)(K,{searchString:D,sortDirection:C,panelFilter:l,folderFilterUIDs:v,page:O,perPage:R})),A=K=>U((0,m.yd)({page:K}));return!(D||l?.length||v?.length)&&B===i.Gu.Done&&M.length<1?(0,t.jsx)(s.p,{variant:"call-to-action",message:(0,g.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,t.jsxs)(g.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,t.jsx)(c.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,t.jsxs)(d.B,{direction:"column",wrap:"nowrap",children:[B===i.Gu.Loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.E.Skeleton,{showSecondaryActions:y}),(0,t.jsx)(o.E.Skeleton,{showSecondaryActions:y}),(0,t.jsx)(o.E.Skeleton,{showSecondaryActions:y})]}):M.length<1?(0,t.jsx)(s.p,{variant:"not-found",message:(0,g.t)("library-panels.empty-state.message","No library panels found")}):M?.map((K,V)=>(0,t.jsx)(o.E,{libraryPanel:K,onDelete:W,onClick:h,showSecondaryActions:y},`library-panel=${V}`)),M.length?(0,t.jsx)("div",{className:S.pagination,children:(0,t.jsx)(u.d,{currentPage:O,numberOfPages:L,onNavigate:A,hideWhenSinglePage:!0})}):null]})},p=h=>({pagination:(0,n.css)({alignSelf:"center",marginTop:h.spacing(1)})})},73973:(q,j,e)=>{"use strict";e.d(j,{IF:()=>m,QC:()=>p,h4:()=>f});var t=e(64423),n=e(65474),r=e(62467),a=e(44240),i=e(39697),x=e(69862),s=e(66847),c=e(69850),d=e(1005),u=e(65961),g=e(67791),o=e(81569),E=e(59046);function m(h){return function(D){const C=new t.yU,l=(0,n.H)((0,o.dq)({searchString:h.searchString,perPage:h.perPage,page:h.page,excludeUid:h.currentPanelId,sortDirection:h.sortDirection,typeFilter:h.panelFilter,folderFilterUIDs:h.folderFilterUIDs})).pipe((0,x.Z)(v=>{const{elements:y}=v;return(0,r.of)({...v,elements:y})}),(0,x.Z)(({perPage:v,elements:y,page:P,totalCount:b})=>(0,r.of)((0,E.c4)({libraryPanels:y,page:P,perPage:v,totalCount:b}))),(0,s.W)(v=>(console.error(v),(0,r.of)((0,E.c4)({...E.Xb,page:h.page,perPage:h.perPage})))),(0,c.j)(()=>C.unsubscribe()),(0,d.u)());C.add((0,a.h)((0,i.O)(50).pipe((0,u.u)((0,E.d9)()),(0,g.Q)(l)),l).subscribe(D))}}function f(h,D){return async function(C){try{await(0,o.h4)(h),m(D)(C)}catch(l){console.error(l)}}}function p(h){return function(D){return D instanceof Function?D(h):h(D)}}},59046:(q,j,e)=>{"use strict";e.d(j,{Xb:()=>r,c4:()=>i,d9:()=>a,w_:()=>s,yd:()=>x});var t=e(65307),n=e(8392);const r={loadingState:n.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},a=(0,t.VP)("libraryPanels/view/initSearch"),i=(0,t.VP)("libraryPanels/view/searchCompleted"),x=(0,t.VP)("libraryPanels/view/changePage"),s=(c,d)=>{if(a.match(d))return{...c,loadingState:n.Gu.Loading};if(i.match(d)){const{libraryPanels:u,page:g,perPage:o,totalCount:E}=d.payload,m=Math.ceil(E/o);return{...c,libraryPanels:u,perPage:o,totalCount:E,loadingState:n.Gu.Done,numberOfPages:m,page:g>m?g-1:g}}return x.match(d)?{...c,page:d.payload.page}:c}},54506:(q,j,e)=>{"use strict";e.d(j,{X:()=>t});function t(n){return!!n.libraryPanel?.uid}},81569:(q,j,e)=>{"use strict";e.d(j,{DW:()=>C,GN:()=>f,Yr:()=>u,d7:()=>o,dq:()=>d,e9:()=>g,h4:()=>m,jc:()=>E,xV:()=>p});var t=e(75505),n=e(39344),r=e(36503),a=e(60101),i=e(10817),x=e(2044),s=e(75911),c=e(67858);async function d({searchString:l="",perPage:v=100,page:y=1,excludeUid:P="",sortDirection:b="",typeFilter:S=[],folderFilterUIDs:M=[]}={}){const O=new URLSearchParams;O.append("searchString",l),O.append("sortDirection",b),O.append("typeFilter",S.join(",")),O.append("folderFilterUIDs",M.join(",")),O.append("excludeUid",P),O.append("perPage",v.toString(10)),O.append("page",y.toString(10)),O.append("kind",c.i.Panel.toString(10));const{result:R}=await(0,s.AI)().get(`/api/library-elements?${O.toString()}`);return R}async function u(l,v=!1){const y=await(0,t.s)((0,s.AI)().fetch({method:"GET",url:`/api/library-elements/${l}`,showSuccessAlert:!v,showErrorAlert:!v})),{result:P}=y.data,b=new r.G({...n.Ye,schemaVersion:35,panels:[P.model]}),{scopedVars:S,...M}=b.panels[0].getSaveModel();return delete M.gridPos,delete M.id,delete M.libraryPanel,b.destroy(),{...P,model:M}}async function g(l){const{result:v}=await(0,s.AI)().get(`/api/library-elements/name/${l}`);return v}async function o(l,v){const{result:y}=await(0,s.AI)().post("/api/library-elements",{folderUid:v,name:l.libraryPanel.name,model:l,kind:c.i.Panel});return y}async function E(l){const{libraryPanel:v,...y}=l,{uid:P,name:b,version:S,folderUid:M}=v,O=c.i.Panel,{result:R}=await(0,s.AI)().patch(`/api/library-elements/${P}`,{folderUid:M,name:b,model:y,version:S,kind:O});return R}function m(l){return(0,s.AI)().delete(`/api/library-elements/${l}`)}async function f(l){const{result:v}=await(0,s.AI)().get(`/api/library-elements/${l}/connections`);return v}async function p(l){const v=await f(l);return v.length===0?[]:await(0,s.AI)().search({dashboardUIDs:v.map(P=>P.connectionUid)})}function h(l){const v=(0,x.iL)(l),{uid:y,name:P,_loadedPanel:b}=v.state;let S=l.parent;if(!S||!(S instanceof a.U))throw new Error("Trying to save a library panel that does not have a DashboardGridItem parent");return{...b,uid:y,name:P,type:l.state.pluginId,model:(0,i.Z6)(l.clone({$behaviors:void 0}),{x:S.state.x??0,y:S.state.y??0,w:S.state.width??0,h:S.state.height??0},!1,S),kind:c.i.Panel,version:b?.version||0}}async function D(l){const{uid:v,folderUid:y,name:P,model:b,version:S,kind:M}=h(l),{result:O}=await(0,s.AI)().patch(`/api/library-elements/${v}`,{folderUid:y,name:P,model:b,version:S,kind:M});return O}async function C(l){const v=await D(l),y=(0,x.iL)(l);if(!y)throw new Error("Could not find library panel behavior for panel");y.setPanelFromLibPanel(v)}},18949:(q,j,e)=>{"use strict";e.d(j,{o:()=>n});var t=e(22803);function n(r){return{myTable:(0,t.css)({maxHeight:"204px",overflowY:"auto",marginTop:"11px",marginBottom:"28px",borderRadius:r.shape.radius.default,border:`1px solid ${r.colors.action.hover}`,background:r.colors.background.primary,color:r.colors.text.secondary,fontSize:r.typography.h6.fontSize,width:"100%",thead:{color:"#538ade",fontSize:r.typography.bodySmall.fontSize},"th, td":{padding:"6px 13px",height:r.spacing(4)},"tbody > tr:nth-child(odd)":{background:r.colors.background.secondary}}),noteTextbox:(0,t.css)({marginBottom:r.spacing(4)}),textInfo:(0,t.css)({color:r.colors.text.secondary,fontSize:r.typography.size.sm}),dashboardSearch:(0,t.css)({marginTop:r.spacing(2)}),modal:(0,t.css)({width:"500px"}),modalText:(0,t.css)({fontSize:r.typography.h4.fontSize,color:r.colors.text.primary,marginBottom:r.spacing(4),paddingTop:r.spacing(2)})}}},67858:(q,j,e)=>{"use strict";e.d(j,{i:()=>t});var t=(r=>(r[r.Panel=1]="Panel",r))(t||{}),n=(r=>(r[r.Dashboard=1]="Dashboard",r))(n||{})},72504:(q,j,e)=>{"use strict";e.d(j,{b:()=>u});var t=e(5805),n=e(28082),r=e(17687),a=e(11817),i=e(81569);async function x(g,o){const E=s(g),m=await d(E,o);return c(g,m),m}function s(g){let{scopedVars:o,...E}=g.getSaveModel();return E={libraryPanel:{name:g.title,uid:void 0},...E},E}function c(g,o){g.restoreModel({...o.model,configRev:0,libraryPanel:o,title:g.title}),g.hasSavedPanelEditChange=!0,g.refresh()}function d(g,o){return g.libraryPanel?g.libraryPanel&&g.libraryPanel.uid===""?(0,i.d7)(g,o):(0,i.jc)(g):Promise.reject()}const u=()=>{const g=(0,r._2)(),[o,E]=(0,t.default)(async(m,f)=>{try{const p=await x(m,f);return g.success((0,a.t)("library-panels.save.success","Library panel saved")),p}catch(p){throw(0,n.NF)(p)&&(p.isHandled=!0,g.error((0,a.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:p.message??p.data.message}))),p}},[]);return{state:o,saveLibraryPanel:E}}},10474:(q,j,e)=>{"use strict";e.d(j,{t:()=>C});var t=e(24726),n=e(17162),r=e(52718),a=e(37633),i=e(53027),x=e(87638),s=e(91830),c=e(16910),d=e(74848),u=e(22803),g=e(29675),o=e(25356),E=e(54594),m=(l=>(l.Saved="saved",l.EditingStarted="editing-started",l.EditingCanceled="editing-cancelled",l.Deleted="deleted",l))(m||{});function f({onDismiss:l,event:v}){const y=(0,g.of)(p),P=()=>{if(v?.action===m.Deleted){i.Ny.push("/");return}C.reloadPage(),l()};return(0,d.jsxs)(o.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:l,onClickBackdrop:()=>{},className:y.modal,children:[(0,d.jsx)("div",{className:y.description,children:"The dashboard has been updated by another session. Do you want to continue editing or discard your local changes?"}),(0,d.jsxs)(o.a.ButtonRow,{children:[(0,d.jsx)(E.$n,{onClick:l,variant:"secondary",fill:"outline",children:"Continue editing"}),(0,d.jsx)(E.$n,{onClick:P,variant:"destructive",children:"Discard local changes"})]})]})}const p=l=>({modal:(0,u.css)({width:"600px"}),description:(0,u.css)({color:l.colors.text.secondary,paddingBottom:l.spacing(1)})}),h=(0,t.A)();class D{constructor(){this.editing=!1,this.observer={next:v=>{if((0,n.ew)(v)&&this.editing&&v.state===n.ZF.Connected&&this.sendEditingState(),(0,n.Z7)(v)){if(v.message.sessionId===h)return;const{action:y}=v.message;switch(y){case m.EditingStarted:case m.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const P=(0,c.UA)().getCurrent();if(P?.uid!==v.message.uid){console.log("dashboard event for different dashboard?",v,P);return}const b=this.editing||P.hasUnsavedChanges();if(y===m.Saved)b?x.lE.publish(new s.S8({component:f,props:{event:v}})):(x.lE.emit(r.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(b&&y===m.EditingStarted&&!this.hasSeenNotice){const S=v.message,M=this.getRecentEditingEvent();(!M||M.message!==S.message)&&(this.hasSeenNotice=!0,x.lE.emit(r.r1.alertWarning,["Another session is editing this dashboard",S.message])),this.lastEditing=S}return}}}}}}setEditingState(v){const y=this.editing=v;this.editing=v,this.hasSeenNotice=!1,y&&x.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:v,uid:y}=this;v&&y&&(0,a.oF)().publish(v,{sessionId:h,uid:y,action:this.editing?m.EditingStarted:m.EditingCanceled,timestamp:Date.now()})}watch(v){const y=(0,a.oF)();y&&v!==this.uid&&(this.channel={scope:n.qD.Grafana,namespace:"dashboard",path:`uid/${v}`},this.leave(),v&&(this.subscription=y.getStream(this.channel).subscribe(this.observer)),this.uid=v)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){i.Ny.reload()}}const C=new D},25324:(q,j,e)=>{"use strict";e.d(j,{_w:()=>n,o$:()=>x,ot:()=>r});var t=e(4038),n=(s=>(s.NewValuesSameSchema="NewValuesSameSchema",s.FullFrame="FullFrame",s))(n||{});const r=(s,c)=>"type"in s&&s.type===c,a=Object.values(n),i=s=>"type"in s&&a.includes(s.type),x=s=>(0,t.ci)(s)&&"packetInfo"in s},14455:(q,j,e)=>{"use strict";e.d(j,{FE:()=>s,jE:()=>i,qE:()=>x});var t=e(2543),n=e.n(t),r=e(95536),a=e(33504);const i=(g,o)=>s(g,o),x=g=>{let o=[];return g.forEach(E=>{E.links?.forEach(m=>{if("variables"in m&&m.variables.length>0){const f={href:m.href,title:m.title,origin:m.origin,onClick:m.onClick,target:m.target},p=m.variables.map(D=>{const C=D.variableName,l=D.fieldPath?`.${D.fieldPath}`:"";return`${C}${l}`}),h=m.variables.map(D=>D.found?D.value:"");o.push({keys:p,values:h,links:[f],fieldIndex:E.fieldIndex})}})}),o},s=(g,o)=>u(g).map(m=>{const f=o?o(m,g.rowIndex,g.dataFrame):[],p=m.values[g.rowIndex],h=typeof p=="string"||typeof p=="number"?p.toString():(0,r.MA)(p);return{keys:[m.name],values:[h],links:f,fieldIndex:m.index}});function c(g,o){const E=(0,a.Os)(g);if(E===null)return new Set;const m=new Set(E.extraFields.map(f=>f.index));return E.severityField!==null&&m.add(E.severityField.index),o.keepBody&&m.add(E.bodyField.index),o.keepTimestamp&&m.add(E.timeField.index),m}function d(g,o){const E=g.fields.map((h,D)=>({...h,index:D})),m=c(g,o??{}),[f,p]=partition(E,h=>h.config.custom?.hidden?!1:(h.config.links??[]).length>0?!0:m.has(h.index));return{visible:f,hidden:p}}function u(g,o){const E=g.dataFrame,m=c(E,o??{}),f=[];for(let p=0;p<E.fields.length;p++){const h=E.fields[p];h.values[g.rowIndex]!=null&&(h.config.custom?.hidden||(h.config.links&&h.config.links.length>0||m.has(p))&&f.push({...h,index:p}))}return f}},33504:(q,j,e)=>{"use strict";e.d(j,{nC:()=>E,ww:()=>m,Os:()=>f});var t=e(38790),n=e(63739),r=e(47370);function a(p,h){const D=p.labels;if(D!==void 0){const C=new Array(h);return C.fill(D),C}else return null}function i(p,h,D){const C=p.getFieldByName("labels");if(C!==void 0&&C.type===n.PU.other){const l=C.values.map(E);return[C,()=>l]}else return[null,()=>a(h,D.length)]}function x(p){const h=new t.L(p),D=h.getFirstFieldOfType(n.PU.time),C=h.getFirstFieldOfType(n.PU.string);if(D===void 0||C===void 0)return null;const l=h.getFieldByName("tsNs")??null,v=h.getFieldByName("level")??h.getFieldByName("detected_level")??null,y=h.getFieldByName("id")??null,[P,b]=i(h,C,p),S=h.fields.filter((M,O)=>O!==D.index&&O!==C.index&&O!==l?.index&&O!==v?.index&&O!==y?.index&&O!==P?.index);return{timeField:D,bodyField:C,timeNanosecondField:l,severityField:v,idField:y,getLogFrameLabels:b,getLogFrameLabelsAsLabels:b,getLabelFieldName:()=>P?.name??null,extraFields:S}}function s(p,h,D){const C=p.getFieldByName(h);if(C!==void 0)return C.type===D?C:void 0}const c="timestamp",d="body",u="severity",g="id",o="labels";function E(p){const h={};return Object.entries(p).forEach(([D,C])=>{h[D]=typeof C=="string"?C:JSON.stringify(C)}),h}function m(p){const h=new t.L(p),D=s(h,c,n.PU.time),C=s(h,d,n.PU.string);if(D===void 0||C===void 0)return null;const l=s(h,u,n.PU.string)??null,v=s(h,g,n.PU.string)??null,y=s(h,o,n.PU.other)??null,P=y===null?null:y.values,b=h.fields.filter((S,M)=>M!==D.index&&M!==C.index&&M!==l?.index&&M!==v?.index&&M!==y?.index);return{timeField:D,bodyField:C,severityField:l,idField:v,getLogFrameLabels:()=>P,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>P!==null?P.map(E):null,getLabelFieldName:()=>y!==null?y.name:null,extraFields:b}}function f(p){return p.meta?.type===r.m.LogLines?m(p):x(p)}},55909:(q,j,e)=>{"use strict";e.d(j,{yR:()=>O,cZ:()=>R,HT:()=>z,M0:()=>N,ct:()=>K,f8:()=>ne,J9:()=>V,Wr:()=>ae,sg:()=>te});var t=e(88838),n=e(2543),r=e(88483),a=e(50832),i=e(65474),x=e(18163),s=e(7500),c=e(4038),d=e(38790),u=e(63739),g=e(62931),o=e(3202),E=e(55515),m=e(84099),f=e(88090),p=e(59577),h=e(8392),D=e(68123),C=e(32370),l=e(41090),v=e(88023);function y(ce,le){return v.Ay.bootData?.user?.lightTheme?le:ce}var P=e(57903),b=e(33504),S=e(48224);const M="Line limit",O="Common labels",R={[x.$b.critical]:l.Tj[7],[x.$b.error]:l.Tj[4],[x.$b.warning]:l.Tj[1],[x.$b.info]:l.Tj[0],[x.$b.debug]:l.Tj[5],[x.$b.trace]:l.Tj[2],[x.$b.unknown]:y("#8e8e8e","#bdc4cd")},L=1,B=1e3*L,F=60*B,I=60*F,U=24*I,W=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function A(ce,le,he){switch(he){case s.fY.exact:return ce.entry.replace(W,"")===le.entry.replace(W,"");case s.fY.numbers:return ce.entry.replace(/\d/g,"")===le.entry.replace(/\d/g,"");case s.fY.signature:return ce.entry.replace(/\w/g,"")===le.entry.replace(/\w/g,"");default:return!1}}function N(ce,le){return le===s.fY.none?ce:ce.reduce((he,oe,de)=>{const me=he[he.length-1];return de>0&&A(oe,me,le)?me.duplicates++:he.push({...oe,duplicates:0}),he},[])}function K(ce,le){return le.size===0?ce:ce.filter(he=>!le.has(he.logLevel))}function V(ce,le){const he={},oe=[];for(const de of ce){let me=he[de.logLevel];me||(he[de.logLevel]=me={lastTs:null,datapoints:[],target:de.logLevel,color:R[de.logLevel]},oe.push(me));const Pe=Math.floor(de.timeEpochMs/le)*le;Pe===me.lastTs?me.datapoints[me.datapoints.length-1][0]++:(me.datapoints.push([1,Pe]),me.lastTs=Pe);for(const Ee of oe)Ee!==me&&Ee.lastTs!==Pe&&(Ee.datapoints.push([0,Pe]),Ee.lastTs=Pe)}return oe.map((de,me)=>{de.datapoints.sort((Se,Xe)=>Se[1]-Xe[1]);const Pe=(0,c.Vc)(de),be=new d.L(Pe).getFirstFieldOfType(u.PU.number);return Pe.fields[be.index].config.min=0,Pe.fields[be.index].config.decimals=0,Pe.fields[be.index].config.color={mode:g.Y.Fixed,fixedColor:de.color},Pe.fields[be.index].config.custom={drawStyle:s.GR.Bars,barAlignment:s.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:de.color,pointColor:de.color,fillColor:de.color,lineWidth:0,fillOpacity:100,stacking:{mode:s.gs.Normal,group:"A"}},Pe})}function T(ce){return ce.fields.some(le=>le.type===u.PU.time)&&ce.fields.some(le=>le.type===u.PU.string)}function z(ce,le,he,oe,de){const{logSeries:me}=H(ce),Pe=X(me,oe,!!de);if(Pe){if(Pe.queries=oe,le&&Pe.rows.length>0){const Ee=Pe.rows.sort(S.M1),{visibleRange:be,bucketSize:Se,visibleRangeMs:Xe,requestedRangeMs:Qe}=w(Ee,le,he);Pe.visibleRange=be,Pe.bucketSize=Se,Pe.series=V(Ee,Se),Pe.meta&&(Pe.meta=k(Pe,Xe,Qe))}else Pe.series=[];return Pe}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:oe}}function w(ce,le,he,oe=20,de=1e3){let me=he,Pe=le,Ee=Math.max(Pe*oe,de),be,Se;if(he){const Xe=ce[0].timeEpochMs;if(Se=he.to-he.from,be=he.to-Xe,be>0){const Qe=be/Se;Pe*=Qe,Ee=Math.max(Math.ceil(Pe*oe),de),me={from:Math.floor(Xe/Ee)*Ee,to:he.to}}else be=1}return{bucketSize:Ee,visibleRange:me,visibleRangeMs:be,requestedRangeMs:Se}}function H(ce){const le=[],he=[];for(const oe of ce){if(T(oe)||!oe.fields.length){he.push(oe);continue}oe.length>0&&le.push(oe)}return{logSeries:he,metricSeries:le}}function G(ce,le,he){const oe=ce.values[he],me=(0,o.yT)(oe).valueOf();if(le)return{ts:oe,timeEpochMs:me,timeEpochNs:le.values[he]};if(ce.nanos!==void 0){const Pe=ce.nanos[he].toString().padStart(6,"0"),Ee=`${me}${Pe}`;return{ts:oe,timeEpochMs:me,timeEpochNs:Ee}}return{ts:oe,timeEpochMs:me,timeEpochNs:me+"000000"}}function X(ce,le=[],he=!1){if(ce.length===0)return;const oe=[];let de=[];const me=ce.filter(Me=>Me.fields.length);me.length&&me.forEach(Me=>{const De=(0,b.Os)(Me);if(De!=null){const Ke=De.getLogFrameLabelsAsLabels()??void 0,Ie={rawFrame:Me,logsFrame:De,frameLabels:Ke};de.push(Ie),Ke&&Ke.length>0&&oe.push(Ke)}});const Pe=oe.flat(),Ee=Pe.length>0?(0,E.yO)(Pe):{};let be=[],Se=!1;const Xe=(0,S.kA)();for(const Me of de){const{logsFrame:De,rawFrame:Ke,frameLabels:Ie}=Me,{timeField:Ne,timeNanosecondField:ie,bodyField:ve,severityField:fe,idField:ge}=De;for(let xe=0;xe<Ke.length;xe++){const{ts:je,timeEpochMs:Ve,timeEpochNs:ke}=G(Ne,ie??void 0,xe),Oe=ve.values[xe]??"",nt=typeof Oe=="string"?Oe:JSON.stringify(Oe),Je=m.sQ.hasAnsiCodes(nt),Be=!!nt.match(/\\n|\\t|\\r/),Ze=Ke.meta?.custom?.searchWords??Ke.meta?.searchWords??[],tt=Je?t.Ay.strip(nt):nt,Re=Ie?.[xe],at=(0,E.s6)(Re,Ee);Object.keys(at).length>0&&(Se=!0);let yt=x.$b.unknown;const ze=fe&&fe.values[xe]||(Re?.level??Re?.detected_level);typeof ze=="number"||typeof ze=="string"?yt=(0,S.EK)(ze):yt=(0,S.XM)(tt);const st=le.find(It=>It.refId===Ke.refId)?.datasource?.type,ht={entryFieldIndex:ve.index,rowIndex:xe,dataFrame:Ke,logLevel:yt,timeFromNow:(0,f.fq)(je),timeEpochMs:Ve,timeEpochNs:ke,timeLocal:(0,f.LE)(je,{timeZone:"browser"}),timeUtc:(0,f.LE)(je,{timeZone:"utc"}),uniqueLabels:at,hasAnsi:Je,hasUnescapedContent:Be,searchWords:Ze,entry:tt,raw:nt,labels:Re||{},uid:`${Ke.refId}_${ge?ge.values[xe]:xe.toString()}`,datasourceType:st};ge!==null&&(ht.rowId=ge.values[xe]),!(he&&Xe(ht))&&be.push(ht)}}const Qe=[];(0,n.size)(Ee)>0&&Qe.push({label:O,value:Ee,kind:x.tG.LabelsMap});const $e=ce.filter(Me=>Me?.meta?.custom?.limit??Me?.meta?.limit).reduce((Me,De)=>(Me[De.refId??""]=De.meta?.custom?.limit??De.meta?.limit??0,Me),{}),Fe=Object.values($e).reduce((Me,De)=>Me+=De,0);Fe>0&&Qe.push({label:M,value:Fe,kind:x.tG.Number});let Te=0;const Le={};let Ge=!1;for(const Me of ce){const De=Me.meta?.custom?.lokiQueryStatKey,{refId:Ke}=Me;if(!Ge&&Me.meta?.custom?.error&&(Qe.push({label:"",value:Me.meta?.custom.error,kind:x.tG.Error}),Ge=!0),Ke&&!Le[Ke]){if(De&&Me.meta?.stats){const Ie=Me.meta.stats.find(Ne=>Ne.displayName===De);Ie&&(Te+=Ie.value)}Le[Ke]=!0}}if(Te>0){const{text:Me,suffix:De}=(0,D.rT)("B")(Te);Qe.push({label:"Total bytes processed",value:`${Me} ${De}`,kind:x.tG.String})}return{hasUniqueLabels:Se,meta:Qe,rows:be}}function k(ce,le,he){if(!ce.meta)return[];let oe=[...ce.meta];const de=oe.findIndex(Pe=>Pe.label===M),me=de>=0&&oe[de]?.value;if(me&&typeof me=="number"&&me>0){let Pe;if(me===ce.rows.length&&le&&he){if(Pe=`${me} reached`,!ce.queries?.some(be=>"direction"in be&&be.direction===P.ti.Scan)){const be=(le/he*100).toFixed(2);Pe+=`, received logs cover ${be}% (${p.msRangeToTimeString(le)}) of your selected time range (${p.msRangeToTimeString(he)})`}}else{const Ee=C.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";Pe=`${me} (${ce.rows.length} ${Ee})`}oe[de]={label:M,value:Pe,kind:x.tG.String}}return oe}function _(ce,le){const he=le&&ce===x.$b.unknown?"logs":ce,oe=R[ce];return{displayNameFromDS:he,color:{mode:g.Y.Fixed,fixedColor:oe},custom:{drawStyle:s.GR.Bars,barAlignment:s.Nj.Center,lineColor:oe,pointColor:oe,fillColor:oe,lineWidth:1,fillOpacity:100,stacking:{mode:s.gs.Normal,group:"A"}}}}const ee=(ce,le,he)=>(ce.fields=ce.fields.map(oe=>(oe.type===u.PU.number&&(oe.config={...oe.config,..._(le(ce),he)}),oe)),ce);function J(ce){let le;try{le=new d.L(ce).getFirstFieldOfType(u.PU.number)}catch{}return le?.labels?Z(le.labels):x.$b.unknown}function Z(ce){const le=ce.level??ce.detected_level??ce.lvl??ce.loglevel??"";return le?(0,S.EK)(le):x.$b.unknown}function te(ce,le,he){const oe=le.range,de=he.targets,me=J,Pe=oe.to.valueOf()-oe.from.valueOf(),Ee=re(le.scopedVars,Pe);return le.interval=Ee.interval,le.scopedVars.__interval={value:Ee.interval,text:Ee.interval},Ee.intervalMs!==void 0&&(le.intervalMs=Ee.intervalMs,le.scopedVars.__interval_ms={value:Ee.intervalMs,text:Ee.intervalMs}),le.hideFromInspector=!0,new r.c(be=>{let Se=[];be.next({state:h.Gu.Loading,error:void 0,data:[]});const Xe=ce.query(le),we=((0,a.A)(Xe)?Xe:(0,i.H)(Xe)).subscribe({complete:()=>{be.complete()},next:$e=>{const{error:Fe}=$e;if(Fe!==void 0)be.next({state:h.Gu.Error,error:Fe,data:$e.data}),be.error(Fe);else{const Te=(0,n.groupBy)($e.data,"refId");Se=$e.data.map(Le=>{if(Le.meta?.dataTopic===s.QR.Annotations)return Le;let Ge=Le.refId||"";Ge.startsWith("log-volume-")&&(Ge=Ge.substr(11));const Me={logsVolumeType:x.Aj.FullRange,absoluteRange:{from:oe.from.valueOf(),to:oe.to.valueOf()},datasourceName:ce.name,sourceQuery:de.find(De=>De.refId===Ge)};return Le.meta={...Le.meta,custom:{...Le.meta?.custom,...Me}},ee(Le,me,Te[Le.refId].length===1)}),be.next({state:$e.state,error:void 0,data:Se})}},error:$e=>{be.next({state:h.Gu.Error,error:$e,data:[]}),be.error($e)}});return()=>{we?.unsubscribe()}})}function ae(ce,le){return le.hideFromInspector=!0,new r.c(he=>{let oe=[];he.next({state:h.Gu.Loading,error:void 0,data:[]});const de=ce.query(le),Pe=((0,a.A)(de)?de:(0,i.H)(de)).subscribe({complete:()=>{he.next({state:h.Gu.Done,error:void 0,data:oe}),he.complete()},next:Ee=>{const{error:be}=Ee;be!==void 0?(he.next({state:h.Gu.Error,error:be,data:[]}),he.error(be)):oe=Ee.data.map(Se=>{const Xe=(0,c.Vc)(Se),{timeIndex:Qe}=(0,c.KR)(Xe);return(0,c.ES)(Xe,Qe)})},error:Ee=>{he.next({state:h.Gu.Error,error:Ee,data:[]}),he.error(Ee)}});return()=>{Pe?.unsubscribe()}})}function re(ce,le){if(ce.__interval_ms){let he=ce.__interval_ms.value,oe="";return le<B*5?(he=L,oe="1ms"):he>I?(he=U,oe="1d"):he>F?(he=I,oe="1h"):he>B?(he=F,oe="1m"):(he=B,oe="1s"),{interval:oe,intervalMs:he}}else return{interval:"$__interval"}}function ne(ce){const le=ce.dataFrame;return le.length===0||le.length<=ce.rowIndex?null:(0,c.EI)({fields:le.fields.map(oe=>({...oe,values:[oe.values[ce.rowIndex]]})),refId:le.refId})}},48224:(q,j,e)=>{"use strict";e.d(j,{Ck:()=>N,Dg:()=>y,Dk:()=>O,Dm:()=>S,Dx:()=>P,EK:()=>g,Ei:()=>C,Hw:()=>v,M1:()=>f,PO:()=>A,Tj:()=>o,Vu:()=>K,XM:()=>u,a8:()=>L,dO:()=>I,e3:()=>M,kA:()=>B,oR:()=>D,oT:()=>b,qR:()=>l,s2:()=>E,tX:()=>R,zy:()=>h});var t=e(2543),n=e.n(t),r=e(18163),a=e(7500),i=e(36669),x=e(63739),s=e(38790),c=e(23570),d=e(14455);function u(V){if(!V)return r.$b.unknown;let T=r.$b.unknown,z;for(const[w,H]of Object.entries(r.$b)){const X=new RegExp(`\\b${w}\\b`,"i").exec(V);X&&(z===void 0||X.index<z)&&(T=H,z=X.index)}return T}function g(V){const T=r.$b[V.toString().toLowerCase()];if(T)return T;if(typeof V=="string"){const z=parseInt(V,10);if(V.length===z.toString().length)return r.s5[V]||r.$b.unknown}else if(typeof V=="number")return r.s5[V]||r.$b.unknown;return r.$b.unknown}function o(V,T){const z=V.filter(G=>G.labels[T]!==void 0),w=z.length,H=(0,t.countBy)(z,G=>G.labels[T]);return m(H,w)}function E(V){const T=V.filter(w=>w!=null),z=(0,t.countBy)(T);return m(z,T.length)}const m=(V,T)=>(0,t.chain)(V).map((z,w)=>({count:z,value:w,proportion:z/T})).sortBy("count").reverse().value(),f=(V,T)=>V.timeEpochMs<T.timeEpochMs?-1:V.timeEpochMs>T.timeEpochMs?1:V.timeEpochNs<T.timeEpochNs?-1:V.timeEpochNs>T.timeEpochNs?1:0,p=(V,T)=>V.timeEpochMs>T.timeEpochMs?-1:V.timeEpochMs<T.timeEpochMs?1:V.timeEpochNs>T.timeEpochNs?-1:V.timeEpochNs<T.timeEpochNs?1:0,h=(V,T)=>{const z=V?D(V.rows,T):[];return V?{...V,rows:z}:{hasUniqueLabels:!1,rows:z}},D=(V,T)=>T===a.uH.Ascending?V.sort(f):V.sort(p),C=V=>V.labels.__error__,l=V=>{if(V.labels.__adaptive_logs_sampled__)return V.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${V.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`},v=V=>V.replace(/\\r\\n|\\n|\\t|\\r/g,T=>T.slice(1)==="t"?"	":`
`);function y(V){return V.map(T=>{const z=(0,d.FE)(T).reduce((w,H)=>{const G=H.keys[0];return w[G]=H.values[0],w},{});return{line:T.entry,timestamp:T.timeEpochNs,fields:{...z,...T.labels}}})}const P=V=>{let T={from:1/0,to:-1/0};return V.forEach(z=>{const w=z.meta?.custom||{};w.absoluteRange?.from&&w.absoluteRange?.to&&(T={from:Math.min(T.from,w.absoluteRange.from),to:Math.max(T.to,w.absoluteRange.to)})}),T},b=V=>{if(V.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const T={},z={};let w=-1/0;const H={};let G=[];return V.forEach(X=>{const{level:k,valueField:_,timeField:ee}=R(X,V);if(!(!ee||!_)){H[k]={meta:X.meta,valueFieldConfig:_?.config??{},timeFieldConfig:ee?.config??{}};for(let J=0;J<X.length;J++){const Z=ee.values[J],te=_.values[J];T[k]??={},T[k][Z]=(T[k][Z]||0)+te,z[Z]=(z[Z]||0)+te,z[Z]>w&&(w=z[Z])}}}),Object.keys(T).forEach(X=>{const k=new i.k,{meta:_,timeFieldConfig:ee,valueFieldConfig:J}=H[X];k.name=X,k.meta=_,k.addField({name:"Time",type:x.PU.time,config:ee}),k.addField({name:"Value",type:x.PU.number,config:J}),Object.entries(T[X]).sort((Z,te)=>Number(Z[0])-Number(te[0])).forEach(([Z,te])=>{k.add({Time:Number(Z),Value:te})}),G.push(k)}),{dataFrames:G,maximum:w}},S=V=>{const T=V[0]?.meta?.custom;return T&&T.datasourceName?{name:T.datasourceName}:null},M=V=>V[0]?.meta?.custom?.logsVolumeType===r.Aj.Limited,O=async(V,T)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(V);{const z=document.createElement("textarea");T.current?.appendChild(z),z.value=V,z.focus(),z.select(),document.execCommand("copy"),z.remove()}};function R(V,T){const z=new s.L(V),w=z.getFirstFieldOfType(x.PU.time),H=z.getFirstFieldOfType(x.PU.number);return w||console.error("Time field missing in data frame"),H||console.error("Value field missing in data frame"),{level:H?(0,c.Ct)(H,V,T):"logs",valueField:H,timeField:w}}function L(V){return V instanceof Element}function B(){const V=new Set;return function(T){let z=`${T.dataFrame.refId}_${T.rowId?T.rowId:`${T.timeEpochNs}_${T.entry}`}`;return V.has(z)?!0:(V.add(z),!1)}}function F(V,T,z){const w=T.fields.find(H=>H.name==="labelTypes")?.values[z];return w?w[V]??null:null}function I(V,T){if(!T.datasourceType)return null;const z=T.dataFrame.fields.find(G=>G.name==="id");if(!z)return null;const w=z.values.findIndex(G=>G===T.rowId);if(w<0)return null;const H=F(V,T.dataFrame,w);return H?U(H,T.datasourceType):null}function U(V,T){switch(T){case"loki":switch(V){case"I":return"Indexed label";case"S":return"Structured metadata";case"P":return"Parsed label";default:return null}default:return null}}const W="logs.popover.disabled";function A(){localStorage.setItem(W,"true")}function N(){localStorage.removeItem(W)}function K(){return!!localStorage.getItem(W)}},33593:(q,j,e)=>{"use strict";e.d(j,{m:()=>c});var t=e(74848),n=e(22803),r=e(32370),a=e(29675),i=e(65164),x=e(11817);const s=()=>{const u=(0,a.of)(d);return(0,t.jsx)("p",{className:u.description,children:r.$.featureToggles.newDashboardSharingComponent?(0,x.t)("shared-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this access? The dashboard can no longer be shared."):(0,x.t)("public-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public.")})},c=({onConfirm:u,onDismiss:g})=>{const o=r.$.featureToggles.newDashboardSharingComponent?(0,x.t)("shared-dashboard.delete-modal.revoke-title","Revoke access"):(0,x.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,t.jsx)(i.u,{isOpen:!0,body:(0,t.jsx)(s,{}),onConfirm:u,onDismiss:g,title:o,icon:"trash-alt",confirmText:o})},d=u=>({title:(0,n.css)({marginBottom:u.spacing(1)}),description:(0,n.css)({fontSize:u.typography.body.fontSize})})},3142:(q,j,e)=>{"use strict";e.d(j,{P:()=>a});var t=e(92914);class n extends Error{constructor(x,s){super(s),this.type=x}}class r{constructor(){this.rootName="general"}validateNewDashboardName(x,s){return this.validate(x,s,"A dashboard or a folder with the same name already exists")}validateNewFolderName(x){return this.validate(this.rootName,x,"A folder or dashboard in the general folder with the same name already exists")}async validate(x,s,c){s=(s||"").trim();const d=s.toLowerCase();if(s.length===0)throw new n("REQUIRED","Name is required");if(d===this.rootName)throw new n("EXISTING","This is a reserved name and cannot be used for a folder.");const g=await(0,t.S)().search({kind:["dashboard"],query:s,location:x||"general"});for(const o of g.view)if(d===o.name.toLowerCase())throw new n("EXISTING",c)}}const a=new r},4956:(q,j,e)=>{"use strict";e.d(j,{FG:()=>C,Q9:()=>l,Ql:()=>M,c0:()=>S,iP:()=>g,rw:()=>u,vV:()=>P});var t=e(28082),n=e(98437),r=e(23737),a=e(17687),i=e(15664),x=e(61491),s=e(81569),c=e(67858),d=e(33914);function u(O){return async R=>{try{R((0,d.f7)());const L=await(0,t.AI)().get(`/api/gnet/dashboards/${O}`);await R(h(L.json)),await R(m(L)),R(p())}catch(L){R((0,d.oQ)()),(0,t.NF)(L)&&R((0,r.dx)((0,a.gi)(L.data.message||L)))}}}function g(O){return async R=>{await R(h(O)),await R(f(O)),R(p())}}const o=(O,R)=>O?.usage?.libraryPanels?.filter(L=>R.inputs.libraryPanels.some(B=>B.state!==d.J7.Exists&&B.model.uid===L.uid));function E(O,R){let L=O.__inputs;if(R.inputs.libraryPanels?.length){const B=[];O.__inputs?.forEach(F=>{if(!F?.usage?.libraryPanels){B.push(F);return}const I=o(F,R);F.usage={libraryPanels:I},!!I?.length&&B.push(F)}),L=B}return{...O,__inputs:L}}function m(O){return(R,L)=>{const B=L().importDashboard,F=E(O.json,B);R((0,d.Rp)({...O,json:F}))}}function f(O){return(R,L)=>{const B=L().importDashboard,F=E(O,B);R((0,d.dd)(F))}}function p(){return(O,R)=>{const L=R().importDashboard.dashboard;if(L&&L.__inputs){const B=[];L.__inputs.forEach(F=>{const I={name:F.name,label:F.label,info:F.description,value:F.value,type:F.type,pluginId:F.pluginId,options:[]};I.description=y(F),F.type===d.NZ.DataSource?v(F,I):I.info||(I.info="Specify a string constant"),B.push(I)}),O((0,d.y3)(B))}}}function h(O){return async function(R){const L=await D(O);R((0,d.dW)(L))}}async function D(O){if(!O||!O.__elements)return[];const R=[];for(const L of Object.values(O.__elements)){if(L.kind!==c.i.Panel)continue;const B=L.model,{type:F,description:I}=B,{uid:U,name:W}=L,A={model:{model:B,uid:U,name:W,version:0,type:F,kind:c.i.Panel,description:I},state:d.J7.New};try{const N=await(0,s.Yr)(U,!0);A.state=d.J7.Exists,A.model=N}catch(N){if(N.status!==404)throw N}R.push(A)}return R}function C(){return O=>{O((0,d.SN)())}}function l(O){return async(R,L)=>{const B=L().importDashboard.dashboard,F=L().importDashboard.inputs,I=[];O.dataSources?.forEach((U,W)=>{const A=F.dataSources[W];I.push({name:A.name,type:A.type,pluginId:A.pluginId,value:U.uid})}),O.constants?.forEach((U,W)=>{const A=F.constants[W];I.push({value:U,name:A.name,type:A.type})}),R(i.cU.endpoints.importDashboard.initiate({dashboard:{...B,title:O.title,uid:O.uid||B.uid},overwrite:!0,inputs:I,folderUid:O.folder.uid}))}}const v=(O,R)=>{(0,n.l)().getList({pluginId:O.pluginId}).length===0?R.info="No data sources of type "+O.pluginName+" found":R.info||(R.info="Select a "+O.pluginName+" data source")},y=O=>{if(O.usage&&O.usage.libraryPanels)return`List of affected library panels: ${O.usage.libraryPanels.reduce((L,B,F)=>F===0?B.name:`${L}, ${B.name}`,"")}`};function P(O){return(0,t.AI)().post("/api/folders",O)}const b=1e3;async function S(O,R,L=x.SearchQueryType.Folder){return(0,t.AI)().get("/api/search",{query:O,type:L,permission:R,limit:b})}function M(O){return(0,t.AI)().get(`/api/folders/${O}`)}},33914:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>p,J7:()=>i,NZ:()=>a,Rp:()=>u,SN:()=>c,V9:()=>x,dW:()=>o,dd:()=>g,f7:()=>m,oQ:()=>E,qx:()=>r,y3:()=>d});var t=e(65307),n=e(8392),r=(h=>(h[h.Gcom=0]="Gcom",h[h.Json=1]="Json",h))(r||{}),a=(h=>(h.DataSource="datasource",h.Constant="constant",h.LibraryPanel="libraryPanel",h))(a||{}),i=(h=>(h.New="new",h.Exists="exists",h.Different="different",h))(i||{});const x={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:n.Gu.NotStarted},s=(0,t.Z0)({name:"manageDashboards",initialState:x,reducers:{setGcomDashboard:(h,D)=>{h.dashboard={...D.payload.json,id:null},h.meta={updatedAt:D.payload.updatedAt,orgName:D.payload.orgName},h.source=0,h.state=n.Gu.Done},setJsonDashboard:(h,D)=>{h.dashboard={...D.payload,id:null},h.meta=x.meta,h.source=1,h.state=n.Gu.Done},clearDashboard:h=>{h.dashboard={},h.state=n.Gu.NotStarted},setInputs:(h,D)=>{h.inputs={dataSources:D.payload.filter(C=>C.type==="datasource"),constants:D.payload.filter(C=>C.type==="constant"),libraryPanels:h.inputs.libraryPanels||[]}},setLibraryPanelInputs:(h,D)=>{h.inputs.libraryPanels=D.payload},fetchFailed:h=>{h.dashboard={},h.state=n.Gu.Error},fetchDashboard:h=>{h.state=n.Gu.Loading}}}),{clearDashboard:c,setInputs:d,setGcomDashboard:u,setJsonDashboard:g,setLibraryPanelInputs:o,fetchFailed:E,fetchDashboard:m}=s.actions,p={importDashboard:s.reducer}},5989:(q,j,e)=>{"use strict";e.d(j,{O5:()=>l,r3:()=>o,dX:()=>p,hZ:()=>s,ri:()=>u,WH:()=>h,AC:()=>c,YX:()=>f,bM:()=>D,A_:()=>C,u:()=>y,SM:()=>x,M8:()=>m,YD:()=>g,aD:()=>E});var t=e(40034),n=e(31226),r=e(75816);const i=(0,r.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:(0,n.W)({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:P=>({getSessionList:P.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:P.mutation({query:b=>({url:"/cloudmigration/migration",method:"POST",body:b.cloudMigrationSessionRequestDto})}),deleteSession:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}`,method:"DELETE"})}),getSession:P.query({query:b=>({url:`/cloudmigration/migration/${b.uid}`})}),createSnapshot:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot`,method:"POST"})}),getSnapshot:P.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}`,params:{resultPage:b.resultPage,resultLimit:b.resultLimit}})}),cancelSnapshot:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:P.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/upload`,method:"POST"})}),getShapshotList:P.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshots`,params:{page:b.page,limit:b.limit,sort:b.sort}})}),getCloudMigrationToken:P.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:P.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:P.mutation({query:b=>({url:`/cloudmigration/token/${b.uid}`,method:"DELETE"})}),getDashboardByUid:P.query({query:b=>({url:`/dashboards/uid/${b.uid}`})}),getLibraryElementByUid:P.query({query:b=>({url:`/library-elements/${b.libraryElementUid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:x,useCreateSessionMutation:s,useDeleteSessionMutation:c,useGetSessionQuery:d,useCreateSnapshotMutation:u,useGetSnapshotQuery:g,useCancelSnapshotMutation:o,useUploadSnapshotMutation:E,useGetShapshotListQuery:m,useGetCloudMigrationTokenQuery:f,useCreateCloudMigrationTokenMutation:p,useDeleteCloudMigrationTokenMutation:h,useGetDashboardByUidQuery:D,useGetLibraryElementByUidQuery:C}=i,l=i.injectEndpoints({endpoints:P=>({getLocalPluginList:P.query({queryFn:async()=>{try{return{data:await(0,t.Gd)()}}catch(b){return(0,n.s)(b)}}})})}).enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getDashboardByUid:v,getLibraryElementByUid:v,getLocalPluginList:v}});function v(P){if(!P.query)return;const b=P.query;P.query=(...S)=>{const M=b(...S);return M.showErrorAlert=!1,M}}const{useGetLocalPluginListQuery:y}=l},80713:(q,j,e)=>{"use strict";e.d(j,{EC:()=>s,L_:()=>i,YS:()=>a,bA:()=>x,wV:()=>c});var t=e(28082),n=e(23737),r=e(8969);function a(d={getBackendSrv:t.AI}){return async u=>{const g=await d.getBackendSrv().get("/api/org");return u((0,r.bK)(g)),g}}function i(d={getBackendSrv:t.AI}){return async(u,g)=>{const o=g().organization.organization;await d.getBackendSrv().put("/api/org",{name:o.name}),u((0,n.YA)(o.name)),u(a(d))}}function x(d,u={getBackendSrv:t.AI}){return async g=>{const o=await u.getBackendSrv().post("/api/user/using/"+d);g((0,n.YA)(o.name))}}function s(d,u={getBackendSrv:t.AI}){return async g=>{const o=await u.getBackendSrv().post("/api/orgs/",d);g(x(o.orgId))}}function c(d={getBackendSrv:t.AI}){return async u=>{const g=await d.getBackendSrv().get("/api/user/orgs");return u((0,r.Bz)(g)),g}}},8969:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>c,Bz:()=>x,bK:()=>i,n:()=>a});var t=e(65307);const n={organization:{},userOrgs:[]},r=(0,t.Z0)({name:"organization",initialState:n,reducers:{organizationLoaded:(d,u)=>({...d,organization:u.payload}),setOrganizationName:(d,u)=>({...d,organization:{...d.organization,name:u.payload}}),userOrganizationsLoaded:(d,u)=>({...d,userOrgs:u.payload})}}),{setOrganizationName:a,organizationLoaded:i,userOrganizationsLoaded:x}=r.actions,c={organization:r.reducer}},55514:(q,j,e)=>{"use strict";e.d(j,{a:()=>l});var t=e(74848),n=e(22803),r=e(21288),a=e(16753),i=e(58779),x=e(53027),s=e(29675),c=e(90415),d=e(96540),u=e(79784);const g=d.forwardRef(({icon:P,children:b,onClick:S,...M},O)=>{const R=(0,s.of)(o);return(0,t.jsxs)("button",{...M,className:R.action,onClick:S,children:[(0,t.jsx)(u.I,{name:P,size:"xl"}),b]})});g.displayName="CardButton";const o=P=>({action:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:P.colors.background.secondary,borderRadius:P.shape.radius.default,color:P.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:P.colors.emphasize(P.colors.background.secondary)}})});var E=e(40828),m=e(82856),f=e(36608),p=e(75342),h=e(16910),D=e(61491),C=e(65305);function l(P){const b=(0,s.of)(y),S=(0,c.d2)(),M=new r.v2(P.data),{dataSummary:O}=M,R=v(P,O),L=(0,D.useDispatch)(),B=(0,h.UA)().getCurrent()?.getPanelById(P.panelId),F=()=>{m.A.setObject(E.wV,p.__.Suggestions),L((0,f.eK)(!0))},I=()=>{B&&L((0,C.gW)({panel:B,pluginId:"table"}))},U=W=>{B&&(L((0,C.gW)({...W,panel:B})),W.transformations&&setTimeout(()=>{x.Ny.partial({tab:"transform"})},100))};return(0,t.jsxs)("div",{className:b.wrapper,children:[(0,t.jsx)("div",{className:b.message,"data-testid":i.Tp.components.Panels.Panel.PanelDataErrorMessage,children:R}),S.app===a.Jk.PanelEditor&&O.hasData&&B&&(0,t.jsxs)("div",{className:b.actions,children:[P.suggestions&&(0,t.jsx)(t.Fragment,{children:P.suggestions.map(W=>(0,t.jsx)(g,{icon:"process",onClick:()=>U(W),children:W.name},W.name))}),(0,t.jsx)(g,{icon:"table",onClick:I,children:"Switch to table"}),(0,t.jsx)(g,{icon:"chart-line",onClick:F,children:"Open visualization suggestions"})]})]})}function v({data:P,fieldConfig:b,message:S,needsNumberField:M,needsTimeField:O,needsStringField:R},L){return S||(!P.series||P.series.length===0||P.series.every(B=>B.length===0)?b?.defaults.noValue??"No data":R&&!L.hasStringField?"Data is missing a string field":M&&!L.hasNumberField?"Data is missing a number field":O&&!L.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const y=P=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,n.css)({textAlign:"center",color:P.colors.text.secondary,fontSize:P.typography.size.lg,width:"100%"}),actions:(0,n.css)({marginTop:P.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:P.spacing(1),rowGap:P.spacing(1),width:"100%",maxWidth:"600px"})})},84132:(q,j,e)=>{"use strict";e.d(j,{$:()=>d,W:()=>c});var t=e(74848),n=e(96540),r=e(68256),a=e(41007),i=e(37e3),x=e(61491);class s extends n.PureComponent{constructor(g){super(g)}render(){const g={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,t.jsx)("div",{style:g,children:(0,t.jsx)(i.F,{severity:x.AppNotificationSeverity.Error,...this.props})})}}function c(u,g){const o=class extends n.PureComponent{render(){const f=(0,t.jsxs)(t.Fragment,{children:["Check the server startup logs for more information. ",(0,t.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,t.jsx)(s,{title:`Error loading: ${u.id}`,text:f})}},E=new r.m(o);return E.meta=u,E.loadError=!0,E}function d(u,g){const o=class extends n.PureComponent{render(){return(0,t.jsx)(s,{title:`Panel plugin not found: ${u}`})}},E=new r.m(g?()=>null:o);return E.meta={id:u,name:u,sort:100,type:a.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},E}},35884:(q,j,e)=>{"use strict";e.d(j,{m:()=>m});var t=e(74848),n=e(96540),r=e(35023),a=e(47286),i=e(86360),x=e(27999),s=e(39736),c=e(29675),d=e(90415),u=e(49816),g=e(87638),o=e(43956);const E={defaults:{},overrides:[]};function m(p){const{pluginId:h,data:D,timeZone:C=(0,r.O)(),options:l={},width:v,height:y,title:P,onOptionsChange:b=()=>{},onChangeTimeRange:S=()=>{},onFieldConfigChange:M=()=>{},fieldConfig:O=E}=p,R=(0,c.$j)(),L=(0,s.w)(),B=(0,n.useMemo)(()=>L.replace.bind(L),[L]),[F,I]=(0,n.useState)((0,o.PY)(h)),[U,W]=(0,n.useState)(),A=f(F,l,O),{dataLinkPostProcessor:N}=(0,d.d2)(),K=(0,a.rJ)(F,A?.fieldConfig,D,C,R,B,N);if((0,n.useEffect)(()=>{F&&F.hasPluginId(h)||(0,o.TV)(h).then(T=>I(T)).catch(T=>{W(T.message)})},[h,F]),U)return(0,t.jsxs)("div",{children:["Failed to load plugin: ",U]});if(!F||!F.hasPluginId(h))return(0,t.jsx)("div",{children:"Loading plugin panel..."});if(!F.panel)return(0,t.jsx)("div",{children:"Seems like the plugin you are trying to load does not have a panel component."});if(!K)return(0,t.jsx)("div",{children:"No panel data"});const V=F.panel;return(0,t.jsx)(u.Xw,{dependencies:[F,D],children:(0,t.jsx)(i.a,{meta:F.meta,children:(0,t.jsx)(V,{id:1,data:K,title:P,timeRange:K.timeRange,timeZone:C,options:A.options,fieldConfig:O,transparent:!1,width:v,height:y,renderCounter:0,replaceVariables:T=>T,onOptionsChange:b,onFieldConfigChange:M,onChangeTimeRange:S,eventBus:g.lE})})})}function f(p,h,D){return(0,n.useMemo)(()=>{if(p)return(0,x.F)({plugin:p,currentOptions:h,currentFieldConfig:D,isAfterPluginChange:!1})},[p,D,h])}},78603:(q,j,e)=>{"use strict";e.d(j,{b:()=>f});var t=e(74848),n=e(22803),r=e(70255),a=e(41007),i=e(3021),x=e(58779),s=e(29675),c=e(99764),d=e(50278),u=e(71815),g=e(62637);const o=38,E=({isCurrent:C,title:l,plugin:v,onClick:y,onDelete:P,disabled:b,showBadge:S,description:M,children:O})=>{const R=(0,s.of)(h),L=b||v.state===a.pn.deprecated,B=(0,n.cx)({[R.item]:!0,[R.itemDisabled]:L,[R.current]:C});return(0,t.jsxs)("div",{className:B,"aria-label":x.Tp.components.PluginVisualization.item(v.name),"data-testid":x.Tp.components.PluginVisualization.item(v.name),onClick:L?void 0:y,title:C?"Click again to close this section":v.name,children:[(0,t.jsx)("img",{className:(0,n.cx)(R.img,{[R.disabled]:L}),src:v.info.logos.small,alt:""}),(0,t.jsxs)("div",{className:(0,n.cx)(R.itemContent,{[R.disabled]:L}),children:[(0,t.jsx)("div",{className:R.name,children:l}),M?(0,t.jsx)("span",{className:R.description,children:M}):null,O]}),S&&(0,t.jsx)("div",{className:(0,n.cx)(R.badge,{[R.disabled]:L}),children:(0,t.jsx)(D,{plugin:v})}),P&&(0,t.jsx)(c.K,{name:"trash-alt",onClick:F=>{F.stopPropagation(),P()},className:R.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"})]})};E.displayName="PanelTypeCard";const m=({children:C,hasDescription:l,hasDelete:v,rootProps:y})=>{const P=(0,s.of)(h),b=(0,s.of)(p);return(0,t.jsxs)("div",{className:P.item,...y,children:[(0,t.jsx)(r.A,{className:(0,n.cx)(P.img,b.image),width:o,height:o}),(0,t.jsxs)("div",{className:P.itemContent,children:[(0,t.jsx)("div",{className:P.name,children:(0,t.jsx)(r.A,{width:160})}),l?(0,t.jsx)(r.A,{containerClassName:P.description,width:80}):null,C]}),v&&(0,t.jsx)(r.A,{containerClassName:(0,n.cx)(P.deleteButton,b.deleteButton),width:16,height:16})]})},f=(0,u.j)(E,m),p=()=>({deleteButton:(0,n.css)({lineHeight:1}),image:(0,n.css)({lineHeight:1})}),h=C=>({item:(0,n.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:C.colors.background.secondary,borderRadius:C.shape.radius.default,boxShadow:C.shadows.z1,border:`1px solid ${C.colors.background.secondary}`,alignItems:"center",padding:C.spacing(1),width:"100%",overflow:"hidden",[C.transitions.handleMotion("no-preference","reduce")]:{transition:C.transitions.create(["background"],{duration:C.transitions.duration.short})},"&:hover":{background:C.colors.emphasize(C.colors.background.secondary,.03)}}),itemContent:(0,n.css)({overflow:"hidden",position:"relative",padding:C.spacing(0,1)}),itemDisabled:(0,n.css)({cursor:"default","&, &:hover":{background:C.colors.action.disabledBackground}}),current:(0,n.css)({label:"currentVisualizationItem",border:`1px solid ${C.colors.primary.border}`,background:C.colors.action.selected}),disabled:(0,n.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:C.typography.size.sm,fontWeight:C.typography.fontWeightMedium,width:"100%"}),description:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:C.colors.text.secondary,fontSize:C.typography.bodySmall.fontSize,fontWeight:C.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,n.css)({maxHeight:o,width:o,display:"flex",alignItems:"center"}),badge:(0,n.css)({background:C.colors.background.primary}),deleteButton:(0,n.css)({cursor:"pointer",marginLeft:"auto"})}),D=({plugin:C})=>(0,i.x)(C.signature)?(0,t.jsx)(d.B,{status:C.signature}):(0,t.jsx)(g.p,{state:C.state});D.displayName="PanelPluginBadge"},31099:(q,j,e)=>{"use strict";e.d(j,{a:()=>C});var t=e(74848),n=e(22803),r=e(96540),a=e(16817),i=e(70713),x=e(29675),s=e(21288),c=e(32370),d=e(43956);const u=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function g(y,P){const b=new s.v2(y,P);for(const M of u){const R=(await(0,d.TV)(M)).getSuggestionsSupplier();R&&R.getSuggestionsForData(b)}const S=b.getList();if(b.dataSummary.fieldCount===0)for(const M of Object.values(c.$.panels))!M.skipDataQuery||M.hideFromList||S.push({name:M.name,pluginId:M.id,description:M.info.description,cardOptions:{imgSrc:M.info.logos.small}});return S.sort((M,O)=>{if(b.dataSummary.preferredVisualisationType){if(M.pluginId===b.dataSummary.preferredVisualisationType)return-1;if(O.pluginId===b.dataSummary.preferredVisualisationType)return 1}return(O.score??s.nQ.OK)-(M.score??s.nQ.OK)})}var o=e(2543),E=e(58779),m=e(6736),f=e(35884);function p({data:y,suggestion:P,onChange:b,width:S}){const M=(0,x.of)(h),{innerStyles:O,outerStyles:R,renderWidth:L,renderHeight:B}=D(S),F=P.cardOptions??{},I={"aria-label":P.name,className:M.vizBox,"data-testid":E.Tp.components.VisualizationPreview.card(P.name),style:R,onClick:()=>{b({pluginId:P.pluginId,options:P.options,fieldConfig:P.fieldConfig})}};if(F.imgSrc)return(0,t.jsx)(m.m,{content:P.description??P.name,children:(0,t.jsxs)("button",{...I,className:(0,n.cx)(M.vizBox,M.imgBox),children:[(0,t.jsx)("div",{className:M.name,children:P.name}),(0,t.jsx)("img",{className:M.img,src:F.imgSrc,alt:P.name})]})});let U=P;return P.cardOptions?.previewModifier&&(U=(0,o.cloneDeep)(P),P.cardOptions.previewModifier(U)),(0,t.jsx)("button",{...I,children:(0,t.jsx)(m.m,{content:P.name,children:(0,t.jsxs)("div",{style:O,className:M.renderContainer,children:[(0,t.jsx)(f.m,{title:"",data:y,pluginId:P.pluginId,width:L,height:B,options:U.options,fieldConfig:U.fieldConfig}),(0,t.jsx)("div",{className:M.hoverPane})]})})})}const h=y=>({hoverPane:(0,n.css)({position:"absolute",top:0,right:0,left:0,borderRadius:y.spacing(2),bottom:0}),vizBox:(0,n.css)({position:"relative",background:"none",borderRadius:y.shape.radius.default,cursor:"pointer",border:`1px solid ${y.colors.border.medium}`,[y.transitions.handleMotion("no-preference","reduce")]:{transition:y.transitions.create(["background"],{duration:y.transitions.duration.short})},"&:hover":{background:y.colors.background.secondary}}),imgBox:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",color:y.colors.text.primary,width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"}),name:(0,n.css)({paddingBottom:y.spacing(.5),marginTop:y.spacing(-1),fontSize:y.typography.bodySmall.fontSize,whiteSpace:"nowrap",overflow:"hidden",color:y.colors.text.secondary,fontWeight:y.typography.fontWeightMedium,textOverflow:"ellipsis"}),img:(0,n.css)({maxWidth:y.spacing(8),maxHeight:y.spacing(8)}),renderContainer:(0,n.css)({position:"absolute",transformOrigin:"left top",top:"6px",left:"6px"})});function D(y){const b=y,S=y*(1/1.6),M=350,O=M*(1/1.6),R=6,L=(b-R*2)/M,B=(S-R*2)/O;return{renderHeight:O,renderWidth:M,outerStyles:{width:b,height:S},innerStyles:{width:M,height:O,transform:`scale(${L}, ${B})`}}}function C({searchQuery:y,onChange:P,data:b,panel:S,trackSearch:M}){const O=(0,x.of)(v),{value:R}=(0,a.A)(()=>g(b,S),[b,S]),L=(0,r.useMemo)(()=>{const B=l(y,R);return M&&M(y,B.length),B},[y,R,M]);return(0,t.jsx)("div",{children:(0,t.jsx)(i.default,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:B})=>{if(!B)return null;B=B-1;const F=Math.floor(B/200),I=8*(F-1),U=Math.floor((B-I)/F);return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:O.filterRow,children:(0,t.jsx)("div",{className:O.infoText,children:"Based on current data"})}),(0,t.jsxs)("div",{className:O.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${U}px)`},children:[L.map((W,A)=>(0,t.jsx)(p,{data:b,suggestion:W,onChange:P,width:U-1},A)),y&&L.length===0&&(0,t.jsx)("div",{className:O.infoText,children:"No results matched your query"})]})]})}})})}function l(y,P){if(!y||!P)return P||[];const b=new RegExp(y,"i");return P.filter(S=>b.test(S.name)||b.test(S.pluginId))}const v=y=>({heading:(0,n.css)({...y.typography.h5,margin:y.spacing(0,.5,1)}),filterRow:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,n.css)({fontSize:y.typography.bodySmall.fontSize,color:y.colors.text.secondary,fontStyle:"italic"}),grid:(0,n.css)({display:"grid",gridGap:y.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:y.spacing(1),justifyContent:"space-evenly"})})},74201:(q,j,e)=>{"use strict";e.d(j,{G:()=>d});var t=e(74848),n=e(22803),r=e(96540),a=e(29675),i=e(3844),x=e(55452),s=e(78603);const c=({isCurrent:g,plugin:o,onClick:E,disabled:m})=>(0,t.jsx)(s.b,{title:o.name,plugin:o,description:o.info.description,onClick:E,isCurrent:g,disabled:m,showBadge:!0});c.displayName="VizTypePickerPlugin";function d({pluginId:g,searchQuery:o,onChange:E,trackSearch:m}){const f=(0,a.of)(u),p=(0,r.useMemo)(x.A4,[]),h=(0,r.useMemo)(()=>{const D=(0,x.CO)(p,o,g);return m&&m(o,D.length),D},[p,o,g,m]);return h.length===0?(0,t.jsx)(i.Z,{children:"Could not find anything matching your query"}):(0,t.jsx)("div",{className:f.grid,children:h.map(D=>(0,t.jsx)(c,{disabled:!1,isCurrent:D.id===g,plugin:D,onClick:C=>E({pluginId:D.id,withModKey:C.metaKey||C.ctrlKey||C.altKey})},D.id))})}const u=g=>({grid:(0,n.css)({maxWidth:"100%",display:"grid",gridGap:g.spacing(.5)}),heading:(0,n.css)({...g.typography.h5,margin:g.spacing(0,.5,1)})})},90143:(q,j,e)=>{"use strict";e.d(j,{CH:()=>c,E7:()=>s,EO:()=>x});var t=e(4038),n=e(59141),r=e(41931),a=e(18745),i=e(89146);const x=d=>{const u=d.field.links;if(!(!u||u.length===0))return{getLinks:g=>{const o={};if(d.view){const{dataFrame:m}=d.view;o.__series={value:{name:m.name,refId:m.refId},text:"Series"};const f=d.colIndex!==void 0?m.fields[d.colIndex]:void 0;if(f){if(o.__field={value:{name:f.name,labels:f.labels},text:"Field"},d.rowIndex!==void 0&&d.rowIndex>=0){const{timeField:p}=(0,t.KR)(m);o.__value={value:{raw:f.values[d.rowIndex],numeric:d.display.numeric,text:(0,n.cN)(d.display),time:p?p.values[d.rowIndex]:void 0},text:"Value"}}d.view&&(o.__data={value:{name:m.name,refId:m.refId,fields:(0,r.F)({frame:m,rowIndex:d.rowIndex})},text:"Data"})}else o.__value={value:{raw:d.display.numeric,numeric:d.display.numeric,text:(0,n.cN)(d.display),calc:d.name},text:"Value"}}else console.log("VALUE",d);const E=(m,f,p)=>{const h={...o,...f};return g(m,h,p)};return u.map(m=>(0,i.mQ)().getDataLinkUIModel(m,E,d))}}},s=(d,u)=>{const g=d.links;if(!(!g||g.length===0))return{getLinks:()=>g.map(o=>(0,i.mQ)().getDataLinkUIModel(o,u||d.replaceVariables,d))}},c=(d,u)=>{const g=a.b4.getPanelLinks(d)?.state.rawLinks;if(!(!g||g.length===0))return{getLinks:()=>g.map(o=>(0,i.mQ)().getDataLinkUIModel(o,u,d))}}},89146:(q,j,e)=>{"use strict";e.d(j,{Fq:()=>D,Hf:()=>v,mQ:()=>M});var t=e(2543),n=e.n(t),r=e(46399),a=e(47180),i=e(23570),x=e(63739),s=e(2567),c=e(84099),d=e(93407),u=e(33262),g=e(39736),o=e(7500),E=e(88023);const m=[{value:`${r.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:a.$0.BuiltIn},{value:`${r.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:a.$0.BuiltIn},{value:`${r.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:a.$0.BuiltIn}],f=[{value:`${r.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:a.$0.Series}],p=[{value:`${r.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:a.$0.Value},{value:`${r.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:a.$0.Value},{value:`${r.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:a.$0.Value}],h=O=>O.includes(".")||O.trim().includes(" ")?`["${O}"]`:`.${O}`,D=()=>[...(0,g.w)().getVariables().map(O=>({value:O.name,label:O.name,origin:a.$0.Template})),{value:`${r.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:a.$0.Template},...m],C=O=>{const R=[];for(const B of O)for(const F of B.fields)if(F.labels)for(const I of Object.keys(F.labels))R.push(I);const L=(0,t.chain)(R).flatten().uniq().value();return[{value:`${r.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:a.$0.Field},...L.map(B=>({value:`__field.labels${h(B)}`,label:`labels.${B}`,documentation:`${B} label value`,origin:a.$0.Field}))]},l=O=>{let R,L;const B=[],F={};if(O.length!==1)return[];const I=O[0];for(const U of I.fields){const W=(0,i.Ct)(U,I,O);F[W]||(B.push({value:`__data.fields${h(W)}`,label:`${W}`,documentation:`Formatted value for ${W} on the same row`,origin:a.$0.Fields}),F[W]=!0,!R&&U.type===x.PU.number&&(R={...U,name:W}),!L&&U.config.displayName&&U.config.displayName!==U.name&&(L={...U,name:W}))}return B.length&&B.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:a.$0.Fields}),R&&(B.push({value:`__data.fields${h(R.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:a.$0.Fields}),B.push({value:`__data.fields${h(R.name)}.text`,label:"Show text value",documentation:"the text value",origin:a.$0.Fields})),L&&B.push({value:`__data.fields${h(L.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:a.$0.Fields}),B},v=(O,R)=>{const L={value:`${r.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:a.$0.Value};return R===a.uP.Values?[...f,...C(O),...p,L,...l(O),...D()]:[...f,...C(O),...l(O),...D()]},y=O=>{const R=C(O),L={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...f,...R,...p,L,...D()]};class P{constructor(){this.getDataLinkUIModel=(R,L,B)=>{let F=R.url;R.onBuildUrl&&(F=R.onBuildUrl({origin:B,replaceVariables:L}));const I={href:s.I.assureBaseUrl(F.replace(/\n/g,"")),title:R.title??"",target:R.targetBlank!==void 0?R.targetBlank?"_blank":"_self":void 0,origin:B};return L&&(I.href=L(I.href,void 0,o.$m.UriEncode),I.title=L(R.title)),R.onClick&&(I.onClick=U=>{R.onClick({origin:B,replaceVariables:L,e:U})}),I.href=(0,E.zj)().disableSanitizeHtml?I.href:c.sQ.sanitizeUrl(I.href),I}}getLinkUrl(R){let L={};R.keepTime&&(L[`$${r.c.keepTime}`]=!0),R.includeVars&&(L[`$${r.c.includeVars}`]=!0);let B=s.I.assureBaseUrl(d.kM.appendQueryToUrl(R.url||"",d.kM.toUrlParams(L)));return B=(0,g.w)().replace(B),(0,E.zj)().disableSanitizeHtml?B:c.sQ.sanitizeUrl(B)}getAnchorInfo(R){const L=(0,g.w)();return{href:this.getLinkUrl(R),title:L.replace(R.title||""),tooltip:L.replace(R.tooltip||"")}}getPanelLinkAnchorInfo(R,L){(0,u.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const B=(F,I,U)=>(0,g.w)().replace(F,{...L,...I},U);return this.getDataLinkUIModel(R,B,{})}}let b;function S(O){b=O}function M(){return b||(b=new P),b}},65305:(q,j,e)=>{"use strict";e.d(j,{Ap:()=>s,O6:()=>c,Xk:()=>u,gW:()=>d});var t=e(27999),n=e(81569),r=e(84132),a=e(34547),i=e(91830),x=e(14297);function s(o){return async(E,m)=>{if(o.libraryPanel?.uid&&!("model"in o.libraryPanel)){E(g(o));return}o.maxDataPoints&&(o.maxDataPoints=Number(o.maxDataPoints));let f=o.type,p=m().plugins.panels[f];if(!p)try{p=await E((0,a.y7)(f))}catch{p=(0,r.$)(f,f==="row")}o.plugin||await o.pluginLoaded(p),E((0,x.XM)({key:o.key,plugin:p}))}}function c(o){return E=>{E((0,x.FC)({key:o}))}}function d({panel:o,pluginId:E,options:m,fieldConfig:f,transformations:p}){return async(h,D)=>{if(o.type===E&&!m&&!f&&!p)return;let l=D().plugins.panels[E];if(l||(l=await h((0,a.y7)(E))),o.type!==E&&o.changePlugin(l),m||f||p){const v=(0,t.F)({plugin:l,currentOptions:m||o.options,currentFieldConfig:f||o.fieldConfig,isAfterPluginChange:!1});o.options=v.options,o.fieldConfig=v.fieldConfig,o.transformations=p||o.transformations,o.configRev++}o.generateNewKey(),h((0,x.XM)({key:o.key,plugin:l}))}}function u(o,E){return async(m,f)=>{const p=E.model.type,h=o.type;if(o.restoreModel({...E.model,gridPos:o.gridPos,id:o.id,libraryPanel:E}),o.getQueryRunner().clearLastResult(),h!==p){let C=f().plugins.panels[p];C||(C=await m((0,a.y7)(p))),await o.pluginLoaded(C),o.generateNewKey(),await m((0,x.XM)({key:o.key,plugin:C}))}else{const D=o.key;o.generateNewKey(),m((0,x.io)({oldKey:D,newKey:o.key}))}o.configRev=0,o.hasSavedPanelEditChange=!0,o.refresh(),o.events.publish(i.zq),o.events.publish(i.PR)}}function g(o){return async(E,m)=>{const f=o.libraryPanel.uid;try{const p=await(0,n.Yr)(f,!0);o.initLibraryPanel(p);const h=m().dashboard.getModel();if(o.repeat&&h){const D=h.panels.findIndex(C=>C.id===o.id);h.repeatPanel(o,D),h.sortPanelsByGridPos(),h.events.publish(new i.Q$)}await E(s(o))}catch(p){console.log("ERROR: ",p),E((0,x.XM)({key:o.key,plugin:(0,r.$)("Unable to load library panel: "+f,!1)}))}}}},14297:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>g,FC:()=>c,S3:()=>i,XM:()=>a,io:()=>s,nF:()=>x,rG:()=>d});var t=e(65307);const n={},r=(0,t.Z0)({name:"panels",initialState:n,reducers:{panelModelAndPluginReady:(o,E)=>{o[E.payload.key]={plugin:E.payload.plugin}},changePanelKey:(o,E)=>{o[E.payload.newKey]=o[E.payload.oldKey],delete o[E.payload.oldKey]},removePanel:(o,E)=>{delete o[E.payload.key]},removeAllPanels:o=>{Object.keys(o).forEach(E=>delete o[E])},setPanelInstanceState:(o,E)=>{o[E.payload.key].instanceState=E.payload.value},setPanelAngularComponent:(o,E)=>{const m=o[E.payload.key];m.angularComponent=E.payload.angularComponent}}}),{panelModelAndPluginReady:a,setPanelAngularComponent:i,setPanelInstanceState:x,changePanelKey:s,removePanel:c,removeAllPanels:d}=r.actions,g={panels:r.reducer}},56152:(q,j,e)=>{"use strict";e.d(j,{U:()=>t});function t(n,r){return n.panels[r.key]}},55452:(q,j,e)=>{"use strict";e.d(j,{A4:()=>a,CO:()=>s});var t=e(41007),n=e(67793),r=e(88023);function a(){const c=r.$W.panels;return Object.keys(c).filter(d=>c[d].hideFromList===!1).map(d=>c[d]).sort((d,u)=>d.sort-u.sort)}function i(){return a().filter(c=>!!c.skipDataQuery)}function x(){return a().filter(c=>!c.skipDataQuery)}function s(c,d,u){if(!d.length)return c.filter(f=>f.state===t.pn.deprecated?u===f.id:!0);const g=(0,n.xb)(d).toLowerCase(),o=[],E=[],m="graph".startsWith(g);for(const f of c){if(f.state===t.pn.deprecated&&u!==f.id)continue;const h=f.name.toLowerCase().indexOf(g);h===0?o.push(f):h>0?E.push(f):m&&f.id==="timeseries"&&o.push(f)}return o.concat(E)}},40819:(q,j,e)=>{"use strict";e.d(j,{_o:()=>g});var t=e(2543),n=e.n(t),r=e(2567),a=e(93407),i=e(59577),x=e(53027),s=e(5761),c=e(9344);const d={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class u extends s.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,c.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const m=this.urls[this.index],f=x.Ny.getSearchObject(),p=(0,t.pickBy)(f,(D,C)=>d[C]),h=r.I.stripBaseFromUrl(m);this.index++,this.validPlaylistUrl=h,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),x.Ny.push(h+"?"+a.kM.toUrlParams(p))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(E){E.pathname!==this.validPlaylistUrl&&this.stop()}async start(E){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=x.Ny.getHistory().listen(this.locationUpdated);const m=[];let f=await this.api.getPlaylist(E);if(!f.items?.length)return;this.interval=i.intervalToMs(f.interval);const p=await(0,c.qY)(f.items);for(const h of p)if(h.dashboards)for(const D of h.dashboards)m.push(D.url);m.length&&(this.urls=m,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),x.Ny.getSearchObject().kiosk&&x.Ny.partial({kiosk:null}))}}const g=new u},9344:(q,j,e)=>{"use strict";e.d(j,{GM:()=>C,NF:()=>l,aV:()=>D,qY:()=>h});var t=e(75505),n=e(94626),r=e(28082),a=e(32370),i=e(23737),x=e(17687),s=e(45820),c=e(92980),d=e(83394),u=e(72458),g=e(92914);class o{async getAllPlaylist(){return(0,r.AI)().get("/api/playlists/")}async getPlaylist(y){const P=await(0,r.AI)().get(`/api/playlists/${y}`);return await f(P),P}async createPlaylist(y){await p(()=>(0,r.AI)().post("/api/playlists",y))}async updatePlaylist(y){await p(()=>(0,r.AI)().put(`/api/playlists/${y.uid}`,y))}async deletePlaylist(y){await p(()=>(0,r.AI)().delete(`/api/playlists/${y}`),"Playlist deleted")}}class E{constructor(){this.playlistAsK8sResource=y=>({metadata:{name:y.uid},spec:{title:y.name,interval:y.interval,items:y.items??[]}}),this.server=new u.ws({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(m)}async getPlaylist(y){const P=await this.server.get(y),b=m(P);return await f(b),b}async createPlaylist(y){const P=this.playlistAsK8sResource(y);await p(async()=>{await this.server.create(P)})}async updatePlaylist(y){const P=this.playlistAsK8sResource(y);await p(()=>this.server.update(P).then(()=>{}))}async deletePlaylist(y){await p(()=>this.server.delete(y).then(()=>{}),"Playlist deleted")}}function m(v){const{spec:y,metadata:P}=v;return{uid:P.name,name:y.title,interval:y.interval,items:y.items}}async function f(v){if(v?.items){for(const y of v.items)if(y.type==="dashboard_by_id"){y.type="dashboard_by_uid";const P=await(0,r.AI)().get(`/api/dashboards/ids/${y.value}`);P?.length&&(y.value=P[0])}}}async function p(v,y="Playlist saved"){try{await v(),(0,d.JD)((0,i.dx)((0,x.tZ)(y)))}catch(P){P instanceof Error&&(0,d.JD)((0,i.dx)((0,x.gi)("Unable to save playlist",P)))}}async function h(v){let y=0;if(!v?.length)return[];const P=[];for(const M of v){const O={query:"*",kind:["dashboard"],limit:1e3};switch(M.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":O.uid=[M.value];break;case"dashboard_by_tag":O.tags=[M.value];break}P.push({refId:`${y++}`,queryType:c.nj.Search,search:O})}if(!a.$.featureToggles.panelTitleSearch){const M=(0,g.S)(),O=[];for(let R=0;R<P.length;R++){const L=(await M.search(P[R].search)).view;O.push({...v[R],dashboards:L.map(B=>({...B}))})}return O}const b=await(0,s.o)(),S=await(0,t.s)(b.query({targets:P}));if(S.data.length!==v.length)throw new Error("unexpected result size");return v.map((M,O)=>{const R=new n.R(S.data[O]);return{...M,dashboards:R.map(L=>({...L}))}})}function D(){return{items:[],interval:"5m",name:"",uid:""}}function C(v,y){return y?.length?(y=y.toLowerCase(),v.filter(P=>P.name.toLowerCase().includes(y))):v}function l(){return a.$.featureToggles.kubernetesPlaylists?new E:new o}},40034:(q,j,e)=>{"use strict";e.d(j,{Ap:()=>m,Bj:()=>c,CB:()=>x,Gd:()=>E,T_:()=>s,XP:()=>f,cu:()=>h,ij:()=>D,xZ:()=>p});var t=e(60997),n=e(28082),r=e(15084),a=e(86519),i=e(83215);async function x(l){const v=await d(l),y=!!v,[P,b,S,M]=await Promise.all([E(),u(l,y),g(l),o(l)]),O=P.find(L=>L.id===l),R=O?.dependencies||v?.json?.dependencies;return{grafanaDependency:R?.grafanaDependency??R?.grafanaVersion??"",pluginDependencies:R?.plugins||[],links:O?.info.links||v?.json?.info.links||[],readme:S||v?.readme,versions:b,statusContext:v?.statusContext??"",iam:v?.json?.iam,lastCommitDate:v?.lastCommitDate,changelog:v?.changelog||M,licenseUrl:v?.licenseUrl,documentationUrl:v?.documentationUrl,signatureType:O?.signatureType||(v?.signatureType!==""?v?.signatureType:void 0),signature:O?.signature}}async function s(){try{const{items:l}=await(0,n.AI)().get(`${a.P5}/plugins`,{includeDeprecated:!0});return l.filter(i.hY)}catch(l){if((0,n.NF)(l))return l.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw l}}async function c(){try{return await(0,n.AI)().get(`${a.Sw}/errors`)}catch{return[]}}async function d(l){try{return await(0,n.AI)().get(`${a.P5}/plugins/${l}`,{})}catch(v){(0,n.NF)(v)&&(v.isHandled=!0);return}}async function u(l,v){try{return v?((await(0,n.AI)().get(`${a.P5}/plugins/${l}/versions`)).items||[]).map(P=>({version:P.version,createdAt:P.createdAt,updatedAt:P.updatedAt,isCompatible:P.isCompatible,grafanaDependency:P.grafanaDependency,angularDetected:P.angularDetected})):[]}catch(y){return(0,n.NF)(y)&&(y.isHandled=!0),[]}}async function g(l){try{const v=await(0,n.AI)().get(`${a.Sw}/${l}/markdown/README`);return v?(0,t.G)(v):""}catch(v){return(0,n.NF)(v)&&(v.isHandled=!0),""}}async function o(l){try{const v=await(0,n.AI)().get(`${a.Sw}/${l}/markdown/CHANGELOG`);return v?(0,t.G)(v):""}catch(v){return(0,n.NF)(v)&&(v.isHandled=!0),""}}async function E(){return(await(0,n.AI)().get(`${a.Sw}`,(0,r.F)({embedded:0}))).filter(i.Sq)}async function m(){const{items:l}=await(0,n.AI)().get(`${a.Mi}/plugins`);return l}async function f(){const{items:l}=await(0,n.AI)().get(`${a.Mi}/provisioned-plugins`);return l.map(v=>({slug:v.type}))}async function p(l,v){return await(0,n.AI)().post(`${a.Sw}/${l}/install`,{version:v},{showErrorAlert:!1})}async function h(l){return await(0,n.AI)().post(`${a.Sw}/${l}/uninstall`)}async function D(l,v){return(await(0,n.AI)().datasourceRequest({url:`/api/plugins/${l}/settings`,method:"POST",data:v}))?.data}const C={getRemotePlugins:s,getInstalledPlugins:E,installPlugin:p,uninstallPlugin:h}},83524:(q,j,e)=>{"use strict";e.d(j,{G:()=>a});var t=e(74848),n=e(22803),r=e(29675);const a=({children:x,wrap:s,className:c})=>{const d=(0,r.$j)(),u=i(d,s);return(0,t.jsx)("div",{className:(0,n.cx)(u.container,c),children:x})},i=(x,s)=>({container:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:s?"wrap":"nowrap","& > *":{marginBottom:x.spacing(),marginRight:x.spacing()},"& > *:last-child":{marginRight:0}})})},86519:(q,j,e)=>{"use strict";e.d(j,{Mi:()=>n,P5:()=>r,Sw:()=>t,fu:()=>a});const t="/api/plugins",n="/api/instance",r="/api/gnet",a="plugins"},83215:(q,j,e)=>{"use strict";e.d(j,{Gl:()=>v,H2:()=>f,N6:()=>P,Sq:()=>b,TD:()=>U,Xc:()=>h,bM:()=>R,by:()=>p,hY:()=>S,j_:()=>y,kH:()=>E,sP:()=>N,td:()=>u,tr:()=>l,wD:()=>A});var t=e(84139),n=e(41007),r=e(59457),a=e(32370),i=e(32864),x=e(87638),s=e(75911),c=e(61491),d=e(27207);function u({local:K=[],remote:V=[],instance:T=[],provisioned:z=[],pluginErrors:w}){const H=[],G=D(w),X=T.reduce((_,ee)=>(_.set(ee.pluginSlug,ee),_),new Map),k=z.reduce((_,ee)=>(_.add(ee.slug),_),new Set);return K.forEach(_=>{const ee=V.find(Z=>Z.slug===_.id),J=G[_.id];ee||H.push(g(_,void 0,J))}),V.forEach(_=>{const ee=K.find(te=>te.id===_.slug),J=G[_.slug];if(!(_.status===d.Uy.Deprecated&&!ee)){const te=g(ee,_,J);if(a.$.pluginAdminExternalManageEnabled){te.isFullyInstalled=te.isCore?!0:(X.has(_.slug)||k.has(_.slug))&&te.isInstalled,te.isInstalled=X.has(_.slug)||te.isInstalled;const ae=X.get(_.slug);te.isUpdatingFromInstance=X.has(_.slug)&&te.hasUpdate&&te.installedVersion!==ae?.version,ae?.version&&ae?.version!==_.version&&(te.hasUpdate=!0),te.isUninstallingFromInstance=!!ee&&!X.has(_.slug),te.isProvisioned=k.has(_.slug)}H.push(te)}}),H}function g(K,V,T){return!K&&V?o(V,T):K&&!V?E(K,T):m(K,V,T)}function o(K,V){const{name:T,slug:z,description:w,version:H,orgName:G,popularity:X,downloads:k,typeCode:_,updatedAt:ee,createdAt:J,status:Z,angularDetected:te,keywords:ae,signatureType:re,versionSignatureType:ne,versionSignedByOrgName:ce,url:le,raiseAnIssueUrl:he}=K,oe=!!V||L(_);return{description:w,downloads:k,id:z,info:{logos:{small:`${a.$.appSubUrl}/api/gnet/plugins/${z}/versions/${H}/logos/small`,large:`${a.$.appSubUrl}/api/gnet/plugins/${z}/versions/${H}/logos/large`},keywords:ae},name:T,orgName:G,popularity:X,publishedAt:J,signature:C({remote:K,error:V}),signatureType:re||ne||void 0,signatureOrg:ce,updatedAt:ee,hasUpdate:!1,isPublished:!0,isInstalled:oe,isDisabled:oe,isManaged:O(z),isPreinstalled:R(z),isDeprecated:Z===d.Uy.Deprecated,isCore:K.internal,isDev:!1,isEnterprise:Z===d.Uy.Enterprise,type:_,error:V?.errorCode,angularDetected:te,isFullyInstalled:oe,latestVersion:K.version,url:le,raiseAnIssueUrl:he}}function E(K,V){const{name:T,info:{description:z,version:w,logos:H,updated:G,author:X,keywords:k},id:_,dev:ee,type:J,signature:Z,signatureOrg:te,signatureType:ae,hasUpdate:re,accessControl:ne,angularDetected:ce,raiseAnIssueUrl:le}=K,he=!!V||L(J);return{description:z,downloads:0,id:_,info:{logos:H,keywords:k},name:T,orgName:X.name,popularity:0,publishedAt:"",signature:C({local:K,error:V}),signatureOrg:te,signatureType:ae,updatedAt:G,installedVersion:w,hasUpdate:re,isInstalled:!0,isDisabled:he,isCore:Z==="internal",isPublished:!1,isDeprecated:!1,isDev:!!ee,isEnterprise:!1,isManaged:O(_),isPreinstalled:R(_),type:J,error:V?.errorCode,accessControl:ne,angularDetected:ce,isFullyInstalled:!0,iam:K.iam,latestVersion:K.latestVersion,raiseAnIssueUrl:le}}function m(K,V,T){const z=K?.info.version,w=V?.slug||K?.id||"",H=K?.type||V?.typeCode,G=!!T||L(H),X=V?.keywords||K?.info.keywords||[];let k={small:`/public/img/icn-${H}.svg`,large:`/public/img/icn-${H}.svg`};return V?k={small:`${a.$.appSubUrl}/api/gnet/plugins/${w}/versions/${V.version}/logos/small`,large:`${a.$.appSubUrl}/api/gnet/plugins/${w}/versions/${V.version}/logos/large`}:K&&K.info.logos&&(k=K.info.logos),{description:K?.info.description||V?.description||"",downloads:V?.downloads||0,hasUpdate:K?.hasUpdate||!1,id:w,info:{logos:k,keywords:X},isCore:!!(V?.internal||K?.signature===n.Ac.internal),isDev:!!K?.dev,isEnterprise:V?.status===d.Uy.Enterprise,isInstalled:!!K||G,isDisabled:G,isDeprecated:V?.status===d.Uy.Deprecated,isPublished:!0,isManaged:O(w),isPreinstalled:R(w),name:V?.name||K?.name||"",orgName:V?.orgName||K?.info.author.name||"",popularity:V?.popularity||0,publishedAt:V?.createdAt||"",type:H,signature:C({local:K,remote:V,error:T}),signatureOrg:K?.signatureOrg||V?.versionSignedByOrgName,signatureType:K?.signatureType||V?.versionSignatureType||V?.signatureType||void 0,updatedAt:V?.updatedAt||K?.info.updated||"",installedVersion:z,error:T?.errorCode,accessControl:K?.accessControl,angularDetected:K?.angularDetected??V?.angularDetected,isFullyInstalled:!!K||G,iam:K?.iam,latestVersion:K?.latestVersion||V?.version||"",url:V?.url||"",raiseAnIssueUrl:V?.raiseAnIssueUrl||K?.raiseAnIssueUrl}}const f=K=>`${a.$.pluginCatalogURL}${K}`;var p=(K=>(K.nameAsc="nameAsc",K.nameDesc="nameDesc",K.updated="updated",K.published="published",K.downloads="downloads",K))(p||{});const h=(K,V)=>{const T={nameAsc:(z,w)=>z.name.localeCompare(w.name),nameDesc:(z,w)=>w.name.localeCompare(z.name),updated:(z,w)=>(0,r.b)(w.updatedAt).valueOf()-(0,r.b)(z.updatedAt).valueOf(),published:(z,w)=>(0,r.b)(w.publishedAt).valueOf()-(0,r.b)(z.publishedAt).valueOf(),downloads:(z,w)=>w.downloads-z.downloads};return T[V]?K.sort(T[V]):K};function D(K=[]){return K.reduce((V,T)=>(V[T.pluginId]=T,V),{})}function C(K){const{error:V,local:T,remote:z}=K;if(V)switch(V.errorCode){case n.ZK.invalidSignature:return n.Ac.invalid;case n.ZK.missingSignature:return n.Ac.missing;case n.ZK.modifiedSignature:return n.Ac.modified}return T?.signature?T.signature:z?.signatureType&&z?.versionSignatureType?n.Ac.valid:n.Ac.missing}const l=()=>(0,s.AI)().get("/api/frontend/settings").then(K=>{a.$.panels=K.panels});function v(K){if(!K)return;const[V]=K.filter(T=>!!T.isCompatible);return V}const y=()=>a.$.pluginAdminEnabled,P=(K,V,T)=>{const z=a.$.pluginAdminExternalManageEnabled,w=x.TP.hasPermission(c.AccessControlAction.PluginsInstall),H=!!T;return K.type===n.QE.renderer||K.type===n.QE.secretsmanager||K.isEnterprise&&!(0,i.a)("enterprise.plugins")||K.isDev||!w&&!z||!K.isPublished||!H||!V},b=K=>M(K.id),S=K=>M(K.slug);function M(K){const{pluginCatalogHiddenPlugins:V}=a.$;return!V.includes(K)}function O(K){const{pluginCatalogManagedPlugins:V}=a.$;return V?.includes(K)}function R(K){const{pluginCatalogPreinstalledPlugins:V}=a.$,T=V?.find(z=>z.id===K);return{found:!!T?.id,withVersion:!!T?.version}}function L(K){return K===n.QE.secretsmanager&&!a.$.secretsManagerPluginEnabled}function B(K){return K?.signature==="internal"}function F(K){return K.split(" - ")[0]}function I(K){return K.reduce((V,{id:T,name:z,type:w,orgName:H,info:G})=>{const X=G.keywords?.join(" ").toLowerCase(),k=`${T} - ${z} - ${w} - ${H} - ${X}`;return V.push(k),V},[])}function U(K,V){const T=I(K);let w=new t.A({intraMode:1,intraSub:0}).filter(T,V);return w===null?null:w.map(H=>F(T[H]))}function W(K){return!(K.isProvisioned||K.isCore||K.type===n.QE.renderer||K.isPreinstalled.withVersion||K.isManaged)}function A(K){return!(!W(K)||!K.hasUpdate||K.isUpdatingFromInstance)}function N(K){return!!(!W(K)||K.type===n.QE.secretsmanager||K.isEnterprise&&!(0,i.a)("enterprise.plugins")||!K.isPublished||K.isDisabled||!y())}},34547:(q,j,e)=>{"use strict";e.d(j,{JC:()=>S,JJ:()=>h,LR:()=>p,NJ:()=>O,aU:()=>C,ai:()=>P,h9:()=>M,mj:()=>f,nT:()=>b,t5:()=>D,y7:()=>R});var t=e(65307),n=e(65474),r=e(62467),a=e(66847),i=e(45650),x=e(90593),s=e(75505),c=e(32370),d=e(28082),u=e(43956),g=e(35378),o=e(40034),E=e(86519),m=e(83215);const f=(0,t.zD)(`${E.fu}/fetchAll`,async(L,B)=>{try{B.dispatch({type:`${E.fu}/fetchLocal/pending`}),B.dispatch({type:`${E.fu}/fetchRemote/pending`});const F=c.$.pluginAdminExternalManageEnabled?(0,n.H)((0,o.Ap)()):(0,r.of)(void 0),I=c.$.pluginAdminExternalManageEnabled?(0,n.H)((0,o.XP)()):(0,r.of)(void 0),U=500,W=(0,n.H)((0,o.Bj)()),A=(0,n.H)((0,o.Gd)()),N=(0,n.H)((0,o.T_)()).pipe((0,a.W)(K=>(B.dispatch({type:`${E.fu}/fetchRemote/rejected`}),console.error(K),(0,r.of)([]))));return(0,i.p)({local:A,remote:N,instance:F,provisioned:I,pluginErrors:W}).pipe((0,x.w)({each:U,with:()=>(N.subscribe(async K=>{if(B.dispatch({type:`${E.fu}/fetchRemote/fulfilled`}),K.length>0){const V=await(0,s.s)(A),T=await(0,s.s)(F),z=await(0,s.s)(I),w=await(0,s.s)(W);B.dispatch(C((0,m.td)({local:V,remote:K,instance:T,provisioned:z,pluginErrors:w})))}}),(0,i.p)({local:A,instance:F,provisioned:I,pluginErrors:W}))})).subscribe(({local:K,remote:V,instance:T,provisioned:z,pluginErrors:w})=>{K&&V?(B.dispatch({type:`${E.fu}/fetchLocal/fulfilled`}),B.dispatch({type:`${E.fu}/fetchRemote/fulfilled`}),B.dispatch(C((0,m.td)({local:K,remote:V,instance:T,provisioned:z,pluginErrors:w})))):K&&(B.dispatch({type:`${E.fu}/fetchLocal/fulfilled`}),B.dispatch(C((0,m.td)({local:K,pluginErrors:w}))))},K=>(console.log(K),B.dispatch({type:`${E.fu}/fetchLocal/rejected`}),B.dispatch({type:`${E.fu}/fetchRemote/rejected`}),B.rejectWithValue("Unknown error."))),null}catch{return B.rejectWithValue("Unknown error.")}}),p=(0,t.zD)(`${E.fu}/fetchAllLocal`,async(L,B)=>{try{return(await(0,o.Gd)()).map(I=>(0,m.kH)(I))}catch{return B.rejectWithValue("Unknown error.")}}),h=(0,t.zD)(`${E.fu}/fetchRemotePlugins`,async(L,B)=>{try{return await(0,o.T_)()}catch(F){return(0,d.NF)(F)&&(F.isHandled=!0),B.rejectWithValue([])}}),D=(0,t.zD)(`${E.fu}/fetchDetails`,async(L,B)=>{try{const F=await(0,o.CB)(L);return{id:L,changes:{details:F}}}catch{return B.rejectWithValue("Unknown error.")}}),C=(0,t.VP)(`${E.fu}/addPlugins`),l=(0,t.VP)(`${E.fu}/addLocalPlugins`),v=(0,t.VP)(`${E.fu}/addLocalPlugins`),y=(0,t.VP)(`${E.fu}/addLocalPlugins`),P=(0,t.zD)(`${E.fu}/install`,async({id:L,version:B,isUpdating:F=!1},I)=>{const U=F?{isInstalled:!0,installedVersion:B,hasUpdate:!1}:{isInstalled:!0,installedVersion:B};try{return await(0,o.xZ)(L,B),await(0,m.tr)(),F&&(0,g.sk)(L),{id:L,changes:U}}catch(W){return console.error(W),(0,d.NF)(W)?(W.data.id=L,I.rejectWithValue(W.data)):I.rejectWithValue("Unknown error.")}}),b=(0,t.zD)(`${E.fu}/install`,async()=>({})),S=(0,t.zD)(`${E.fu}/uninstall`,async(L,B)=>{try{return await(0,o.cu)(L),await(0,m.tr)(),(0,g.sk)(L),{id:L,changes:{isInstalled:!1,installedVersion:void 0,isFullyInstalled:!1}}}catch(F){return console.error(F),B.rejectWithValue("Unknown error.")}}),M=(0,t.zD)(`${E.fu}/loadPluginDashboards`,async(L,B)=>{const U=`api/plugins/${B.getState().dataSources.dataSource.type}/dashboards`;return(0,d.AI)().get(U)}),O=(0,t.VP)(`${E.fu}/panelPluginLoaded`),R=L=>async(B,F)=>{let I=F().plugins.panels[L];return I||(I=await(0,u.TV)(L),F().plugins.panels[L]||B(O(I))),I}},80840:(q,j,e)=>{"use strict";e.d(j,{AI:()=>i,Ff:()=>o});var t=e(65307),n=e(86519),r=e(27207),a=e(34547);const i=(0,t.pU)(),x=E=>new RegExp(`${n.fu}/(.*)/pending`).test(E.type),s=E=>new RegExp(`${n.fu}/(.*)/fulfilled`).test(E.type),c=E=>new RegExp(`${n.fu}/(.*)/rejected`).test(E.type),d=E=>{const m=E.lastIndexOf("/");return E.substring(0,m)},u={items:i.getInitialState(),requests:{},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},o=(0,t.Z0)({name:"plugins",initialState:u,reducers:{},extraReducers:E=>E.addCase(a.aU,(m,f)=>{i.upsertMany(m.items,f.payload)}).addCase(a.LR.fulfilled,(m,f)=>{i.upsertMany(m.items,f.payload)}).addCase(a.t5.fulfilled,(m,f)=>{i.updateOne(m.items,f.payload)}).addCase(a.ai.fulfilled,(m,f)=>{i.updateOne(m.items,f.payload)}).addCase(a.JC.fulfilled,(m,f)=>{i.updateOne(m.items,f.payload)}).addCase(a.NJ,(m,f)=>{m.panels[f.payload.meta.id]=f.payload}).addCase(a.h9.pending,(m,f)=>{m.isLoadingPluginDashboards=!0,m.dashboards=[]}).addCase(a.h9.fulfilled,(m,f)=>{m.isLoadingPluginDashboards=!1,m.dashboards=f.payload}).addMatcher(x,(m,f)=>{m.requests[d(f.type)]={status:r.IZ.Pending}}).addMatcher(s,(m,f)=>{m.requests[d(f.type)]={status:r.IZ.Fulfilled}}).addMatcher(c,(m,f)=>{m.requests[d(f.type)]={status:r.IZ.Rejected,error:f.payload}})}).reducer},27207:(q,j,e)=>{"use strict";e.d(j,{IZ:()=>s,Ip:()=>n,LZ:()=>x,Uy:()=>r,og:()=>i,u8:()=>a,vk:()=>t});var t=(c=>(c.Home="plugins-home",c.Browse="plugins-browse",c.Details="plugins-details",c))(t||{}),n=(c=>(c.app="apps",c.datasource="database",c.panel="credit-card",c.renderer="capture",c.secretsmanager="key-skeleton-alt",c))(n||{}),r=(c=>(c.Deleted="deleted",c.Active="active",c.Pending="pending",c.Deprecated="deprecated",c.Enterprise="enterprise",c))(r||{}),a=(c=>(c.INSTALL="INSTALL",c.UNINSTALL="UNINSTALL",c.UPDATE="UPDATE",c.REINSTALL="REINSTALL",c))(a||{}),i=(c=>(c.OVERVIEW="Overview",c.VERSIONS="Version history",c.CONFIG="Config",c.DASHBOARDS="Dashboards",c.USAGE="Usage",c.IAM="IAM",c.CHANGELOG="Changelog",c.PLUGINDETAILS="Plugin details",c.DATASOURCE_CONNECTIONS="Data source connections",c))(i||{}),x=(c=>(c.OVERVIEW="overview",c.VERSIONS="version-history",c.CONFIG="config",c.DASHBOARDS="dashboards",c.USAGE="usage",c.IAM="iam",c.CHANGELOG="changelog",c.PLUGINDETAILS="right-panel",c.DATASOURCE_CONNECTIONS="datasource-connections",c))(x||{}),s=(c=>(c.Pending="Pending",c.Fulfilled="Fulfilled",c.Rejected="Rejected",c))(s||{})},67853:(q,j,e)=>{"use strict";e.d(j,{j:()=>d});var t=e(74848),n=e(56276),r=e(37e3),a=e(54594),i=e(23657);const x="grafana.angularDeprecation.dashboardNoticeAndMigration.isDismissed";function s(u){return x+"."+u}function c(){const u="__feature.autoMigrateOldPanels",g=new URL(window.location.toString());g.searchParams.has(u)||g.searchParams.append(u,"true"),window.open(g.toString(),"_self")}function d({dashboardUid:u,showAutoMigrateLink:g}){return(0,t.jsx)(i.b,{storageKey:s(u),defaultValue:!1,children:(o,E)=>o?null:(0,t.jsx)("div",{children:(0,t.jsx)(r.F,{severity:"warning",title:"This dashboard depends on Angular, which is deprecated and will stop working in future releases of Grafana.",onRemove:()=>{(0,n.rR)("angular_deprecation_notice_dismissed"),E(!0)},children:(0,t.jsxs)("div",{className:"markdown-html",children:[(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",children:"Read our deprecation notice and migration advice."}),(0,t.jsx)("br",{}),g&&(0,t.jsx)(a.$n,{fill:"outline",size:"sm",onClick:c,style:{marginTop:10},children:"Try migration"})]})})})})}},93420:(q,j,e)=>{"use strict";e.d(j,{c:()=>s});var t=e(74848),n=e(96540),r=e(41007),a=e(56276),i=e(37e3);function x(c,d){let u;switch(c){case r.QE.app:u="app plugin";break;case r.QE.panel:u="panel plugin";break;case r.QE.datasource:u="data source plugin";break;default:u="plugin"}let g=`This ${u} uses a deprecated, legacy platform based on AngularJS and `;return d===void 0?g+" may be incompatible depending on your Grafana configuration.":d?g+" will stop working in future releases of Grafana.":g+" is incompatible with your current Grafana configuration."}function s(c){const{className:d,angularSupportEnabled:u,pluginId:g,pluginType:o,showPluginDetailsLink:E,interactionElementId:m,children:f}=c,[p,h]=(0,n.useState)(!1),D={};return g&&(D.pluginId=g),m&&(D.elementId=m),p?null:(0,t.jsxs)(i.F,{severity:"warning",title:"Angular plugin",className:d,onRemove:()=>h(!0),children:[(0,t.jsx)("p",{children:x(o,u)}),(0,t.jsx)("div",{className:"markdown-html",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,a.rR)("angular_deprecation_docs_clicked",D)},children:"Read our deprecation notice and migration advice."})}),E&&g?(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:`plugins/${encodeURIComponent(g)}`,className:"external-link",target:"_blank",rel:"noreferrer",children:"View plugin details"})}):null]})}),f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{}),f]})]})}},54414:(q,j,e)=>{"use strict";e.d(j,{Hv:()=>a,mz:()=>i});var t=e(32370);function n(x){return Object.values(t.$.datasources).find(s=>s.uid===x)??null}function r(x){return n(x)?.meta.angular?.detected??!1}function a(x){const s=n(x);return(s?.meta.angular?.detected&&!s?.meta.angular.hideDeprecation)??!1}const i=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},37096:(q,j,e)=>{"use strict";e.d(j,{A:()=>n,S:()=>a});var t=e(96540);const n=(0,t.createContext)(r());n.displayName="PluginPageContext";function r(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function a(i){return{sectionNav:i??r().sectionNav}}},62637:(q,j,e)=>{"use strict";e.d(j,{p:()=>a});var t=e(74848),n=e(41007),r=e(66384);const a=x=>{const s=i(x.state);return s?(0,t.jsx)(r.E,{className:x.className,color:s.color,title:s.tooltip,text:s.text,icon:s.icon}):null};function i(x){switch(x){case n.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case n.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case n.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},10059:(q,j,e)=>{"use strict";e.d(j,{tR:()=>h,xq:()=>m});var t=e(29997),n=e(52718),r=e(6989),a=e(39736),i=e(94888),x=e(28082),s=e(98437),c=e(65502),d=e(22492),u=e(88023),g=e(21475),o=e(44684),E=e(45251);class m{constructor(C=(0,a.w)()){this.templateSrv=C,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.runtimeDataSources={},this.defaultName=""}init(C,l){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=C,this.defaultName=l;for(const v of Object.values(C))v.uid||(v.uid=v.name),this.settingsMapByUid[v.uid]=v,this.settingsMapById[v.id]=v;for(const v of Object.values(this.runtimeDataSources))this.datasources[v.uid]=v,this.settingsMapByUid[v.uid]=v.instanceSettings;this.datasources[c.dR.type]=g.Ex,this.datasources[o.Uj]=g.Ex,this.settingsMapByUid[c.dR.uid]=g.$i,this.settingsMapByUid[o.Uj]=g.$i}registerRuntimeDataSource(C){if(this.runtimeDataSources[C.dataSource.uid])throw new Error(`A runtime data source with uid ${C.dataSource.uid} has already been registered`);if(this.settingsMapByUid[C.dataSource.uid])throw new Error(`A data source with uid ${C.dataSource.uid} has already been registered`);this.runtimeDataSources[C.dataSource.uid]=C.dataSource,this.datasources[C.dataSource.uid]=C.dataSource,this.settingsMapByUid[C.dataSource.uid]=C.dataSource.instanceSettings}getDataSourceSettingsByUid(C){return this.settingsMapByUid[C]}getInstanceSettings(C,l){let v=f(C);if((0,c.s9)(v))return g.$i;if(v==="default"||v==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(v[0]==="$"){const y=this.templateSrv.replace(v,l,p);let P;return y==="default"?P=this.settingsMapByName[this.defaultName]:P=this.settingsMapByUid[y]??this.settingsMapByName[y],P?{...P,isDefault:!1,name:v,uid:v,rawRef:{type:P.type,uid:P.uid}}:void 0}return this.settingsMapByUid[v]??this.settingsMapByName[v]??this.settingsMapById[v]}get(C,l){let v=f(C);if(!v)return this.get(this.defaultName);if((0,c.s9)(C))return Promise.resolve(this.datasources[o.Uj]);const y=this.settingsMapByName[v];return y&&(v=y.uid),this.datasources[v]?Promise.resolve(this.datasources[v]):(v=this.templateSrv.replace(v,l,p),v==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[v]?Promise.resolve(this.datasources[v]):this.loadDatasource(v))}async loadDatasource(C){if(this.datasources[C])return Promise.resolve(this.datasources[C]);const l=this.getInstanceSettings(C);if(!l)return Promise.reject({message:`Datasource ${C} was not found`});try{const v=await(0,E.cS)(l.meta);if(this.datasources[C])return this.datasources[C];const y=v.DataSourceClass.length!==1;let P;if(y?P=(0,i.C)().instantiate(v.DataSourceClass,{instanceSettings:l}):P=new v.DataSourceClass(l),P.components=v.components,!(P instanceof t.mA)){const b=P;b.name=l.name,b.id=l.id,b.type=l.type,b.meta=l.meta,b.uid=l.uid,b.getRef=t.mA.prototype.getRef}return this.datasources[C]=P,this.datasources[P.uid]=P,P}catch(v){return v instanceof Error&&d.A.emit(n.r1.alertError,[l.name+" plugin failed",v.toString()]),Promise.reject({message:`Datasource: ${C} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(C={}){const l=Object.values(this.settingsMapByName).filter(y=>!(y.meta.id==="grafana"||y.meta.id==="mixed"||y.meta.id==="dashboard"||C.metrics&&!y.meta.metrics||C.tracing&&!y.meta.tracing||C.logs&&y.meta.category!=="logging"&&!y.meta.logs||C.annotations&&!y.meta.annotations||C.alerting&&!y.meta.alerting||C.pluginId&&!(0,r._)(C.pluginId,y.meta)||C.filter&&!C.filter(y)||C.type&&(Array.isArray(C.type)?!C.type.includes(y.type):C.type!==y.type)||!C.all&&y.meta.metrics!==!0&&y.meta.annotations!==!0&&y.meta.tracing!==!0&&y.meta.logs!==!0&&y.meta.alerting!==!0));if(C.variables)for(const y of this.templateSrv.getVariables()){if(y.type!=="datasource")continue;let P=y.current.value==="default"?this.defaultName:y.current.value;Array.isArray(P)&&(P=P[0]);const b=!Array.isArray(P)&&(this.settingsMapByName[P]||this.settingsMapByUid[P]);if(b){const S=`\${${y.name}}`;l.push({...b,isDefault:!1,name:S,uid:S})}}const v=l.sort((y,P)=>y.name.toLowerCase()>P.name.toLowerCase()?1:y.name.toLowerCase()<P.name.toLowerCase()?-1:0);if(!C.pluginId&&!C.alerting){if(C.mixed){const y=this.getInstanceSettings("-- Mixed --");y&&l.push(y)}if(C.dashboard){const y=this.getInstanceSettings("-- Dashboard --");y&&l.push(y)}if(!C.tracing){const y=this.getInstanceSettings("-- Grafana --");y&&C.filter?.(y)!==!1&&l.push(y)}}return v}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(C=>({name:C.name,value:C.name,meta:C.meta}))}getMetricSources(C){return this.getList({metrics:!0,variables:!C?.skipVariables}).map(l=>({name:l.name,value:l.name,meta:l.meta}))}async reload(){const C=await(0,x.AI)().get("/api/frontend/settings");u.Ay.datasources=C.datasources,u.Ay.defaultDatasource=C.defaultDatasource,this.init(C.datasources,C.defaultDatasource)}}function f(D){return(0,c.s9)(D)?c.dR.uid:typeof D=="string"?D:D?.uid}function p(D){return Array.isArray(D)?D[0]:D}const h=()=>(0,s.l)()},83172:(q,j,e)=>{"use strict";e.d(j,{AZ:()=>g,OG:()=>s,TX:()=>c,ZV:()=>u,ov:()=>d});var t=e(74848),n=e(96540);const r=(0,n.createContext)(void 0),a=(0,n.createContext)(void 0),i=(0,n.createContext)(void 0),x=(0,n.createContext)(void 0);function s(){const o=(0,n.useContext)(r);if(!o)throw new Error("No `AddedLinksRegistryContext` found.");return o}function c(){const o=(0,n.useContext)(a);if(!o)throw new Error("No `AddedComponentsRegistryContext` found.");return o}function d(){const o=(0,n.useContext)(i);if(!o)throw new Error("No `AddedFunctionsRegistry` found.");return o}function u(){const o=(0,n.useContext)(x);if(!o)throw new Error("No `ExposedComponentsRegistryContext` found.");return o}const g=({registries:o,children:E})=>(0,t.jsx)(r.Provider,{value:o.addedLinksRegistry,children:(0,t.jsx)(a.Provider,{value:o.addedComponentsRegistry,children:(0,t.jsx)(i.Provider,{value:o.addedFunctionsRegistry,children:(0,t.jsx)(x.Provider,{value:o.exposedComponentsRegistry,children:E})})})})},72690:(q,j,e)=>{"use strict";e.d(j,{$$:()=>C,Bc:()=>D,Bs:()=>t,Cf:()=>c,E5:()=>p,FL:()=>E,H$:()=>s,O6:()=>x,Ri:()=>n,Td:()=>u,bw:()=>i,cu:()=>h,iS:()=>f,ij:()=>o,o2:()=>r,sm:()=>m,vT:()=>d,z5:()=>g});const t='Invalid usage of extension point. Reason: Extension point id should be prefixed with your plugin id, e.g "myorg-foo-app/toolbar/v1".',n='Invalid usage of extension point. Reason: The extension point is not recorded in the "plugin.json" file. Extension points must be listed in the section "extensions.extensionPoints[]". Returning an empty array of extensions.',r="Title is missing.",a="Description is missing.",i='The "fn" argument is invalid, it should be a function.',x='The "configure" function is invalid. It should be a function.',s='Either "path" or "onClick" is required.',c='The "path" is required and should start with "/a/<pluginId>".',d="The component id does not match the id naming convention. Id should be prefixed with plugin id. e.g 'myorg-basic-app/my-component-id/v1'.",u="An exposed component with the same id already exists.",g='The exposed component was not recorded in the plugin.json. Exposed component extensions must be listed in the section "extensions.exposedComponents[]". Currently, this is only required in development but will be enforced also in production builds in the future.',o='Invalid usage of extension point. Reason: The exposed component is not recorded in the "plugin.json" file. Exposed components must be listed in the dependencies[] section.',E='The extension was not recorded in the plugin.json. Added component extensions must be listed in the section "extensions.addedComponents[]". Currently, this is only required in development but will be enforced also in production builds in the future.',m=`The "title" doesn't match the title recorded in plugin.json.`,f='The extension was not recorded in the plugin.json. Added link extensions must be listed in the section "extensions.addedLinks[]". Currently, this is only required in development but will be enforced also in production builds in the future.',p='The extension was not recorded in the plugin.json. Added function extensions must be listed in the section "extensions.addedFunction[]". Currently, this is only required in development but will be enforced also in production builds in the future.',h=`The "description" doesn't match the description recorded in plugin.json.`,D='The "targets" for the registered extension does not match the targets recorded in plugin.json. Currently, this is only required in development but will be enforced also in production builds in the future.',C=l=>`The app plugin with plugin id "${l}" was not found.`},31731:(q,j,e)=>{"use strict";e.d(j,{R:()=>g});var t=e(2543),n=e.n(t),r=e(43561),a=e(39741),i=e(18163),x=e(32370);const s="ui-extension-logs",c=1e3,d=1e3*60*10;class u{constructor(E,m,f){this.baseLabels=E,this.channel=f??new BroadcastChannel(s),this.subject=m??new a.m(c,d),f||(this.channel.onmessage=p=>this.subject.next(p.data))}info(E,m){this.log(i.$b.info,E,m)}warning(E,m){x.$.buildInfo.env==="development"&&console.warn(E,{...this.baseLabels,...m}),this.log(i.$b.warning,E,m)}error(E,m){console.error(E,{...this.baseLabels,...m}),this.log(i.$b.error,E,m)}debug(E,m){this.log(i.$b.debug,E,m)}trace(E,m){this.log(i.$b.trace,E,m)}fatal(E,m){this.log(i.$b.fatal,E,m)}log(E,m,f){const p={...f,...this.baseLabels},{pluginId:h,extensionPointId:D}=p,C={level:E,labels:p,timestamp:Date.now(),id:(0,r.Ak)(),message:m,pluginId:(0,t.isString)(h)?h:void 0,extensionPointId:(0,t.isString)(D)?D:void 0};this.subject.next(C),this.channel.postMessage(C)}asObservable(){return this.subject.asObservable()}child(E){return new u({...E,...this.baseLabels},this.subject,this.channel)}}const g=new u},9290:(q,j,e)=>{"use strict";e.d(j,{a9:()=>U,rH:()=>N,lQ:()=>A,eY:()=>W,qm:()=>K});var t=e(74848),n=e(93253),r=e(87638),a=e(83394),i=e(61491),x=e(31731),s=e(32056),c=e(67078),d=e(4149),u=e(56292),g=e(24103);function o(){try{return[(0,s.xJ)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",targets:[n.S.ExploreToolbarAction],icon:"apps",category:"Dashboards",configure:()=>{if(r.TP.hasPermission(i.AccessControlAction.DashboardsCreate)||r.TP.hasPermission(i.AccessControlAction.DashboardsWrite))return{}},onClick:(V,{context:T,openModal:z})=>{z({title:(0,g.t)(),body:({onDismiss:w})=>(0,t.jsx)(u.H,{onClose:w,exploreId:T?.exploreId})})}}),(0,s.xJ)({title:"Add correlation",description:"Create a correlation from this query",targets:[n.S.ExploreToolbarAction],icon:"link",configure:V=>V?.shouldShowAddCorrelation?{}:void 0,onClick:(V,{context:T})=>{(0,a.JD)((0,c.am)({editorMode:!0})),(0,a.JD)((0,d.Od)({exploreId:T.exploreId}))}})]}catch(V){return x.R.warning(`Could not configure extensions for Explore due to: "${V}"`),[]}}function E(){return[...o()]}var m=e(72690),f=e(76018),p=e(13752),h=e(39741),D=e(29405),C=e(96222),l=e(81160),v=e(72985);const y="Cannot register to a read-only registry";class P{constructor(T){if(this.resultSubject=new p.B,this.logger=T.log??x.R,this.isReadOnly=!1,T.registrySubject){this.registrySubject=T.registrySubject,this.isReadOnly=!0;return}this.registrySubject=new h.m(1),this.resultSubject.pipe((0,D.S)(this.mapToRegistry.bind(this),T.initialState??{}),(0,C.Z)(T.initialState??{}),(0,l.T)(z=>(0,s.ol)(z))).subscribe(this.registrySubject)}register(T){if(this.isReadOnly)throw new Error(y);this.resultSubject.next(T)}asObservable(){return this.registrySubject.asObservable()}getState(){return(0,v._)(this.asObservable())}}const b="Could not register component extension. Reason:";class S extends P{constructor(T={}){super(T)}mapToRegistry(T,z){const{pluginId:w,configs:H}=z;for(const G of H){const X=this.logger.child({description:G.description,title:G.title,pluginId:w});if(!G.title){X.error(`${b} ${m.o2}`);continue}if(w!=="grafana"&&(0,s.V2)()&&(0,f.dt)(w,G,X))continue;const k=Array.isArray(G.targets)?G.targets:[G.targets];for(const _ of k){const ee=X.child({extensionPointId:_}),J={pluginId:w,component:(0,s.nv)(w,G.component,ee),description:G.description,title:G.title};ee.debug("Added component extension successfully registered"),_ in T?T[_].push(J):T[_]=[J]}}return T}readOnly(){return new S({registrySubject:this.registrySubject})}}var M=e(2543);const O="Could not register function extension. Reason:";class R extends P{constructor(T={}){super(T)}mapToRegistry(T,z){const{pluginId:w,configs:H}=z;for(const G of H){const X=this.logger.child({title:G.title,pluginId:w});if(!G.title){X.error(`${O} ${m.o2}`);continue}if(!(0,M.isFunction)(G.fn)){X.error(`${O} ${m.bw}`);continue}if(w!=="grafana"&&(0,s.V2)()&&(0,f.SY)(w,G,X))continue;const k=Array.isArray(G.targets)?G.targets:[G.targets];for(const _ of k){const ee=X.child({extensionPointId:_}),J={pluginId:w,fn:G.fn,description:G.description,title:G.title,extensionPointId:_};ee.debug("Added function extension successfully registered"),_ in T?T[_].push(J):T[_]=[J]}}return T}readOnly(){return new R({registrySubject:this.registrySubject})}}const L="Could not register link extension. Reason:";class B extends P{constructor(T={}){super(T)}mapToRegistry(T,z){const{pluginId:w,configs:H}=z;for(const G of H){const{path:X,title:k,description:_,configure:ee,onClick:J,targets:Z}=G,te=this.logger.child({path:X??"",description:_??"",title:k,pluginId:w,onClick:typeof J});if(!k){te.error(`${L} ${m.o2}`);continue}if(!(0,f.jk)(ee)){te.error(`${L} ${m.O6}`);continue}if(!X&&!J){te.error(`${L} ${m.H$}`);continue}if(X&&!(0,f.kl)(w,X)){te.error(`${L} ${m.Cf}`);continue}if(w!=="grafana"&&(0,s.V2)()&&(0,f.OO)(w,G,te))continue;const ae=Array.isArray(Z)?Z:[Z];for(const re of ae){const ne=te.child({extensionPointId:re}),{targets:ce,...le}=G;re in T||(T[re]=[]),ne.debug("Added link extension successfully registered"),T[re].push({...le,pluginId:w,extensionPointId:re})}}return T}readOnly(){return new B({registrySubject:this.registrySubject})}}const F="Could not register exposed component. Reason:";class I extends P{constructor(T={}){super(T)}mapToRegistry(T,{pluginId:z,configs:w}){if(!w)return T;for(const H of w){const{id:G,description:X,title:k}=H,_=this.logger.child({extensionPointId:G,description:X??"",title:k,pluginId:z});if(!G.startsWith(z)){_.error(`${F} ${m.vT}`);continue}if(T[G]){_.error(`${F} ${m.Td}`);continue}if(!k){_.error(`${F} ${m.o2}`);continue}z!=="grafana"&&(0,s.V2)()&&(0,f.nl)(z,H,_)||(_.debug("Exposed component extension successfully registered"),T[G]={...H,pluginId:z})}return T}readOnly(){return new I({registrySubject:this.registrySubject})}}const U=new S,W=new I,A=new B,N=new R,K={addedComponentsRegistry:U,exposedComponentsRegistry:W,addedLinksRegistry:A,addedFunctionsRegistry:N};A.register({pluginId:"grafana",configs:E()})},32056:(q,j,e)=>{"use strict";e.d(j,{$Y:()=>M,Ce:()=>T,N9:()=>I,Uy:()=>z,V2:()=>N,Xs:()=>H,YS:()=>A,dx:()=>W,hS:()=>U,mi:()=>G,nv:()=>v,ol:()=>P,pL:()=>F,uS:()=>K,xJ:()=>L,yt:()=>b});var t=e(74848),n=e(22803),r=e(2543),a=e.n(r),i=e(16817),x=e(86360),s=e(3202),c=e(93407),d=e(93253),u=e(56276),g=e(32370),o=e(25356),E=e(22492),m=e(6838),f=e(91830),p=e(31731),h=e(76018);function D(X){return typeof X=="object"&&"type"in X&&X.type===PluginExtensionTypes.link}function C(X,k=""){return(..._)=>{try{return X(..._)}catch(ee){ee instanceof Error&&console.warn(`${k}${ee.message}`)}}}function l(X){return async k=>{const{title:_,body:ee,width:J,height:Z}=k;E.A.publish(new f.S8({component:v(X,y({title:_,body:ee,width:J,height:Z}),p.R)}))}}const v=(X,k,_)=>J=>{const{error:Z,loading:te,value:ae}=(0,i.A)(()=>(0,m.x)(X,{showErrorAlert:!1}));return te?null:Z?(_.error(`Could not fetch plugin meta information for "${X}", aborting. (${Z.message})`,{stack:Z.stack??"",message:Z.message}),null):ae?(0,t.jsx)(x.a,{meta:ae,children:(0,t.jsx)(k,{...J})}):(_.error(`Fetched plugin meta information is empty for "${X}", aborting.`),null)},y=({title:X,body:k,width:_,height:ee})=>{const J=(0,n.css)({width:_,height:ee});return({onDismiss:te})=>(0,t.jsx)(o.a,{title:X,className:J,isOpen:!0,onDismiss:te,onClickBackdrop:te,children:(0,t.jsx)(k,{onDismiss:te})})};function P(X,k=new Map){if(!X||typeof X!="object"||Object.isFrozen(X))return X;const _=Array.isArray(X)?[...X]:{...X};if(k.has(X))return k.get(X);k.set(X,_);const ee=Reflect.ownKeys(_);for(const J of ee){const Z=Array.isArray(_)?_[Number(J)]:_[J];Z&&(typeof Z=="object"||typeof Z=="function")&&(Array.isArray(_)?_[Number(J)]=P(Z,k):_[J]=P(Z,k))}return Object.freeze(_)}function b(X,k,_){const ee=`${X}${k}${_}`;return Array.from(ee).reduce((J,Z)=>Math.imul(31,J)+Z.charCodeAt(0)|0,0).toString()}const S=Symbol("isReadOnlyProxy");function M(X){if(!X||typeof X!="object"||R(X))return X;const k=new WeakMap;return new Proxy(X,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(_,ee,J){if(ee===S)return!0;const Z=Reflect.get(_,ee,J);return(0,s.Ar)(Z)?(0,s.KQ)(Z):(0,r.isObject)(Z)||(0,r.isArray)(Z)?(k.has(Z)||k.set(Z,M(Z)),k.get(Z)):Z}})}function O(X){return typeof X=="object"&&X!==null}function R(X){return O(X)&&X[S]===!0}function L(X){const k={...X};return k}function B(X){}function F(X,k){return X.length<k?X:`${X.slice(0,k-3).trimEnd()}...`}function I(X){const k={},_=[];for(const J of X){const Z=J.category;if(!Z){_.push({text:F(J.title,25),href:J.path,onClick:J.onClick});continue}Array.isArray(k[Z])||(k[Z]=[]),k[Z].push({text:F(J.title,25),href:J.path,onClick:J.onClick})}const ee=Object.keys(k).reduce((J,Z)=>(J.push({text:F(Z,25),type:"group",subMenu:k[Z]}),J),[]);return _.length>0&&(ee.length>0&&ee.push({text:"divider",type:"divider"}),Array.prototype.push.apply(ee,_)),ee}function U(X,k,_,ee){try{const J=k.configure?.(ee);if(J===void 0)return;let{title:Z=k.title,description:te=k.description,path:ae=k.path,icon:re=k.icon,category:ne=k.category,...ce}=J;return(0,h.lq)(J,`The configure() function for "${k.title}" returned a promise, skipping updates.`),ae&&(0,h.wy)(X,ae),(0,h.aY)({title:Z,description:te},["title","description"]),Object.keys(ce).length>0&&_.warning(`Extension "${k.title}", is trying to override restricted properties: ${Object.keys(ce).join(", ")} which will be ignored.`),{title:Z,description:te,path:ae,icon:re,category:ne}}catch(J){J instanceof Error&&_.error(`Failed to configure link with title "${k.title}"`,{stack:J.stack??"",message:J.message});return}}function W(X,k,_,ee,J){const{onClick:Z}=_;if(Z)return function(ae){try{(0,u.rR)("ui_extension_link_clicked",{pluginId:X,extensionPointId:k,title:_.title,category:_.category});const re={context:J,openModal:l(X)};ee.debug(`onClick '${_.title}' at '${k}'`);const ne=Z(ae,re);(0,h.yL)(ne)&&ne.catch(ce=>{ce instanceof Error&&ee.error(ce.message,{message:ce.message,stack:ce.stack??""})})}catch(re){re instanceof Error&&ee.error(re.message,{message:re.message,stack:re.stack??""})}}}function A(X,k,_){return c.kM.appendQueryToUrl(k,c.kM.toUrlParams({uel_pid:X,uel_epid:_}))}const N=()=>g.$.buildInfo.env==="development",K=(X=[])=>Object.values(g.$.apps).filter(k=>X.includes(k.id)),V=X=>X.split("/")[0],T=X=>Object.values(g.$.apps).filter(k=>k.extensions.addedLinks.some(_=>_.targets.includes(X))||k.extensions.addedComponents.some(_=>_.targets.includes(X))).map(k=>k.id).reduce((k,_)=>[...k,_,...w(_)],[]),z=X=>[V(X)].reduce((_,ee)=>[..._,ee,...w(ee)],[]),w=(X,k=[])=>{if(!g.$.apps[X])return[];if(k.includes(X))return[];const _=g.$.apps[X].dependencies.extensions.exposedComponents.map(V);return _.reduce((ee,J)=>[...ee,...w(J,[...k,X])],_).filter(ee=>ee!==X)},H=()=>{const X=["cloud-home-app"];return Object.values(g.$.apps).filter(k=>X.includes(k.id))},G=()=>{const X=T(d.S.DashboardPanelMenu),k=H().map(ee=>ee.id),_=ee=>!k.includes(ee.id);return Object.values(g.$.apps).filter(ee=>_(ee)&&(ee.preload||X.includes(ee.id)))}},76018:(q,j,e)=>{"use strict";e.d(j,{Fe:()=>u,OO:()=>C,PW:()=>h,SY:()=>l,aY:()=>s,dt:()=>v,jk:()=>E,kl:()=>d,lq:()=>c,nl:()=>y,wy:()=>a,xM:()=>D,yL:()=>f});var t=e(32370),n=e(72690);function r(P,b="extension is not a link extension"){if(!isPluginExtensionLink(P))throw new Error(b)}function a(P,b){if(!d(P,b))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${P}/" (currently: "${b}"). Skipping the extension.`)}function i(P){if(!p(P))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function x(P){if(!E(P.configure))throw new Error(`Invalid extension "${P.title}". The "configure" property must be a function. Skipping the extension.`)}function s(P,b){for(const S of b)if(!m(P[S]))throw new Error(`Invalid extension "${P.title}". Property "${S}" must be a string and cannot be empty. Skipping the extension.`)}function c(P,b="The provided value is a Promise."){if(f(P))throw new Error(b)}function d(P,b){return!!(typeof b=="string"&&b.length>0&&b.startsWith(`/a/${P}/`))}function u({extensionPointId:P,pluginId:b}){return P.startsWith("grafana/")?!0:!!(P.startsWith(`plugins/${b}/`)||P.startsWith(`${b}/`))}function g(P){return P.match(/.*\/v\d+$/)}function o(P){return Object.values(PluginExtensionPoints).map(b=>b.toString()).includes(P)}function E(P){return P?typeof P=="function":!0}function m(P){return typeof P=="string"&&P.length>0}function f(P){return P instanceof Promise||typeof P=="object"&&P!==null&&"then"in P&&"catch"in P}function p(P){const b=M=>typeof M=="object"&&M!==null&&"$$typeof"in M;return typeof P=="function"||(M=>b(M)&&M.$$typeof===Symbol.for("react.memo"))(P)}const h=(P,b)=>{const S=b.meta?.extensions?.extensionPoints;return!S||!S.some(M=>M.id===P)},D=(P,b)=>{const S=b.meta?.dependencies?.extensions?.exposedComponents;return!S||!S.includes(P)},C=(P,b,S)=>{const M="Could not register link extension. Reason:",O=t.$.apps[P],R=O?O.extensions.addedLinks.find(({title:B})=>B===b.title):null;return O?R?(Array.isArray(b.targets)?b.targets:[b.targets]).every(B=>R.targets.includes(B))?(R.description!==b.description&&S.warning(n.cu),!1):(S.error(`${M} ${n.Bc}`),!0):(S.error(`${M} ${n.iS}`),!0):(S.error(`${M} ${n.$$(P)}`),!0)},l=(P,b,S)=>{const M="Could not register function extension. Reason:",O=t.$.apps[P],R=O?O.extensions.addedFunctions.find(({title:B})=>B===b.title):null;return O?R?(Array.isArray(b.targets)?b.targets:[b.targets]).every(B=>R.targets.includes(B))?(R.description!==b.description&&S.warning(n.cu),!1):(S.error(`${M} ${n.Bc}`),!0):(S.error(`${M} ${n.E5}`),!0):(S.error(`${M} ${n.$$(P)}`),!0)},v=(P,b,S)=>{const M="Could not register component extension. Reason:",O=t.$.apps[P],R=O?O.extensions.addedComponents.find(({title:B})=>B===b.title):null;return O?R?(Array.isArray(b.targets)?b.targets:[b.targets]).every(B=>R.targets.includes(B))?(R.description!==b.description&&S.warning(n.cu),!1):(S.error(`${M} ${n.Bc}`),!0):(S.error(`${M} ${n.FL}`),!0):(S.error(`${M} ${n.$$(P)}`),!0)},y=(P,b,S)=>{const M="Could not register exposed component extension. Reason:",O=t.$.apps[P],R=O?O.extensions.exposedComponents.find(({id:L})=>L===b.id):null;return O?R?R.title!==b.title?(S.error(`${M} ${n.sm}`),!0):(R.description!==b.description&&S.warning(n.cu),!1):(S.error(`${M} ${n.z5}`),!0):(S.error(`${M} ${n.$$(P)}`),!0)}},43956:(q,j,e)=>{"use strict";e.d(j,{Kk:()=>g,PY:()=>o,TV:()=>c,d4:()=>u,f7:()=>f,oZ:()=>d});var t=e(41007),n=e(68256),r=e(88023),a=e(84132),i=e(45251);const x={},s={};function c(p){const h=x[p];if(h)return h;const D=u(p);if(!D)throw new Error(`Plugin ${p} not found`);return x[p]=E(D),p!==D.type&&(x[D.type]=x[p]),x[p]}function d(p){return!!u(p)}function u(p){const h=r.Ay.panels[p];if(!h){for(const D of Object.values(r.Ay.panels))if(D.aliasIDs?.includes(p))return D}return h}function g(p){return E(p)}function o(p){return s[p]}function E(p){const h=p.loadingStrategy??t.xf.fetch;return(0,i.j4)({path:p.module,version:p.info?.version,isAngular:p.angular?.detected,loadingStrategy:h,pluginId:p.id,moduleHash:p.moduleHash}).then(D=>{if(D.plugin)return D.plugin;if(D.PanelCtrl){const C=new n.m(null);return C.angularPanelCtrl=D.PanelCtrl,C}throw new Error("missing export: plugin or PanelCtrl")}).then(D=>(D.meta=p,s[p.id]=D,!D.panel&&D.angularPanelCtrl&&(D.panel=m(D)),D)).catch(D=>(console.warn("Error loading panel plugin: "+p.id,D),(0,a.W)(p,D)))}let m=p=>null;function f(p){m=p}},35378:(q,j,e)=>{"use strict";e.d(j,{GD:()=>a,QO:()=>s,ni:()=>x,sk:()=>i});var t=e(6838),n=e(22065);const r={};function a({path:u,version:g,loadingStrategy:o}){const E=c(u);E&&!r[E]&&(r[E]={version:encodeURI(g),loadingStrategy:o})}function i(u){const g=u;r[g]&&delete r[g],(0,t.o)(u)}function x(u,g=n.x8){const o=d(u);if(!o)return`${u}?_cache=${g}`;const m=r[o]?.version||g;return`${u}?_cache=${m}`}function s(u){const g=d(u);if(g)return r[g]}function c(u){const g=/\/?public\/plugins\/([^\/]+)\//,o=u.match(g);return o?o[1]:null}function d(u){const g=Object.keys(r).find(o=>u.includes(o));if(g)return g}},22065:(q,j,e)=>{"use strict";e.d(j,{$b:()=>n,Bu:()=>r,XV:()=>t,x8:()=>a});const t="package",n=/^plugins.+\.css$/i,r=/^(text|application)\/(x-)?javascript(;|$)/,a=Date.now()},70092:(q,j,e)=>{"use strict";e.d(j,{z:()=>d});var t=e(59511),n=e.n(t),r=e(65024),a=e.n(r),i=e(82093),x=e.n(i),s=e(35135),c=e.n(s);const d=window.System},25713:(q,j,e)=>{"use strict";e.d(j,{Av:()=>c,OD:()=>s,kB:()=>i});var t=e(32370),n=e(2063),r=e(22065),a=e(70092);function i(d){return Object.keys(d).reduce((u,g)=>{const o=`${r.XV}:${g}`;return x(o,d[g]),n.s.set(g,d[g]),u[g]=o,u},{})}function x(d,u){if(a.z.has(d))return;let g;try{g=a.z.resolve(d)}catch(E){console.log(E)}if(g&&a.z.has(g))return;const o=g||d;typeof u=="function"?a.z.register(d,[],E=>({execute:async function(){const m=await u();E(m)}})):a.z.set(o,u)}function s(d){return!!t.$.pluginsCDNBaseURL&&d.startsWith(t.$.pluginsCDNBaseURL)}function c(d){return d.startsWith("http")||d.startsWith("/")?d:`${t.$.appSubUrl??""}/${d}`}},6838:(q,j,e)=>{"use strict";e.d(j,{o:()=>a,x:()=>r});var t=e(28082);const n={};function r(i,x){const s=n[i];return s?Promise.resolve(s):(0,t.AI)().get(`/api/plugins/${i}/settings`,void 0,void 0,x).then(c=>(n[i]=c,c)).catch(c=>typeof c=="object"&&c!==null&&"status"in c&&c.status===403?(c.isHandled=!0,Promise.reject(c)):Promise.reject(new Error("Unknown Plugin")))}const a=i=>i?delete n[i]:Object.keys(n).forEach(x=>delete n[x])},45251:(q,j,e)=>{"use strict";e.d(j,{ui:()=>fr,cS:()=>Rs,j4:()=>fa});var t=e(41007),n=e(29997),r=e(16753),a=e(32370);const te={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,69462)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(7445),e.e(4541),e.e(479),e.e(5074),e.e(147),e.e(3766)]).then(e.bind(e,60147)),"core:plugin/dashboard":async()=>await e.e(6979).then(e.bind(e,16979)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(7445),e.e(4541),e.e(479),e.e(5074),e.e(4292),e.e(3325),e.e(1717)]).then(e.bind(e,73325)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,76810)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,89194)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7445),e.e(4541),e.e(9404)]).then(e.bind(e,4193)),"core:plugin/loki":async()=>await Promise.all([e.e(479),e.e(4292),e.e(1477)]).then(e.bind(e,31266)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,16940)),"core:plugin/prometheus":async()=>await Promise.all([e.e(7445),e.e(4541),e.e(479),e.e(5074),e.e(4292),e.e(4967),e.e(9546)]).then(e.bind(e,44967)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(7445),e.e(4541),e.e(479),e.e(5074),e.e(4737)]).then(e.bind(e,59858)),"core:plugin/text":async()=>await e.e(404).then(e.bind(e,37683)),"core:plugin/timeseries":async()=>await Promise.all([e.e(2374),e.e(5906),e.e(7099),e.e(9527),e.e(9081),e.e(563)]).then(e.bind(e,72910)),"core:plugin/trend":async()=>await Promise.all([e.e(2374),e.e(9527),e.e(2666)]).then(e.bind(e,89181)),"core:plugin/state-timeline":async()=>await Promise.all([e.e(2374),e.e(825),e.e(7099),e.e(6199)]).then(e.bind(e,24275)),"core:plugin/status-history":async()=>await Promise.all([e.e(2374),e.e(825),e.e(7099),e.e(8259)]).then(e.bind(e,22549)),"core:plugin/candlestick":async()=>await Promise.all([e.e(2374),e.e(5906),e.e(7099),e.e(9527),e.e(9081),e.e(3090)]).then(e.bind(e,84572)),"core:plugin/graph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(1838),e.e(8068)]).then(e.bind(e,59489)),"core:plugin/xychart":async()=>await Promise.all([e.e(2374),e.e(9349),e.e(5594)]).then(e.bind(e,84151)),"core:plugin/geomap":async()=>await Promise.all([e.e(5906),e.e(825),e.e(5362),e.e(7110),e.e(3527),e.e(190)]).then(e.bind(e,92139)),"core:plugin/canvas":async()=>await Promise.all([e.e(2374),e.e(7110),e.e(7523)]).then(e.bind(e,45639)),"core:plugin/dashlist":async()=>await e.e(8995).then(e.bind(e,40123)),"core:plugin/alertlist":async()=>await e.e(3375).then(e.bind(e,33797)),"core:plugin/annolist":async()=>await e.e(4979).then(e.bind(e,69442)),"core:plugin/heatmap":async()=>await Promise.all([e.e(2374),e.e(5906),e.e(407),e.e(5995),e.e(7099),e.e(9349),e.e(5857)]).then(e.bind(e,63492)),"core:plugin/table":async()=>await e.e(3525).then(e.bind(e,25807)),"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,33112)),"core:plugin/news":async()=>await e.e(4940).then(e.bind(e,66751)),"core:plugin/live":async()=>await e.e(5413).then(e.bind(e,13765)),"core:plugin/stat":async()=>await Promise.resolve().then(e.bind(e,3917)),"core:plugin/datagrid":async()=>await Promise.all([e.e(7445),e.e(4348),e.e(5939)]).then(e.bind(e,14348)),"core:plugin/debug":async()=>await Promise.all([e.e(5906),e.e(2770)]).then(e.bind(e,46097)),"core:plugin/flamegraph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(5085),e.e(5686)]).then(e.bind(e,2975)),"core:plugin/gettingstarted":async()=>await e.e(9142).then(e.bind(e,49862)),"core:plugin/gauge":async()=>await Promise.resolve().then(e.bind(e,87714)),"core:plugin/piechart":async()=>await e.e(6105).then(e.bind(e,29131)),"core:plugin/bargauge":async()=>await e.e(3851).then(e.bind(e,31737)),"core:plugin/barchart":async()=>await Promise.all([e.e(2374),e.e(825),e.e(3124)]).then(e.bind(e,89299)),"core:plugin/logs":async()=>await Promise.all([e.e(3776),e.e(7884)]).then(e.bind(e,26035)),"core:plugin/logs-new":async()=>await Promise.all([e.e(3776),e.e(297),e.e(3976)]).then(e.bind(e,42172)),"core:plugin/traces":async()=>await Promise.all([e.e(407),e.e(5995),e.e(5085),e.e(8051),e.e(4301)]).then(e.bind(e,57738)),"core:plugin/welcome":async()=>await e.e(8463).then(e.bind(e,68917)),"core:plugin/nodeGraph":async()=>await Promise.all([e.e(5362),e.e(3141),e.e(7317)]).then(e.bind(e,7333)),"core:plugin/histogram":async()=>await Promise.all([e.e(2374),e.e(323)]).then(e.bind(e,63140))};var ae=e(9290),re=e(35378),ne=e(70092),ce=e(34796),le=e.n(ce),he=e(54087),oe=e(80851),de=e(32176),me=e(31221),Pe=e(91520),Ee=e(92275),be=e(82013),Se=e(2341),Xe=e(19538),Qe=e(68256),we=e(33234),$e=e(30468),Fe=e(2243),Te=e(38090),Le=e(12248),Ge=e(88023),Me=e(87638),De=e(75911),Ke=e(36167),Ie=e(97074),Ne=e(33935),ie=e(42961),ve=e(58410),fe=e(6641);const ge=Te;ge.PanelPlugin=Qe.m,ge.DataSourcePlugin=n.tD,ge.AppPlugin=r.hX,ge.DataSourceApi=n.mA;const xe=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((pt,Xt)=>({...pt,[Xt]:{fakeDep:1}}),{}),je={"@emotion/css":()=>Promise.resolve().then(e.bind(e,22803)),"@emotion/react":()=>Promise.resolve().then(e.bind(e,17437)),"@grafana/data":we,"@grafana/runtime":Fe,"@grafana/slate-react":()=>Promise.resolve().then(e.bind(e,29317)),"@grafana/ui":ge,"@kusto/monaco-kusto":()=>Promise.all([e.e(630),e.e(7396),e.e(7640)]).then(e.bind(e,20582)),"app/core/app_events":{default:Me.lE,__useDefault:!0},"app/core/config":{default:Ge.Ay,__useDefault:!0},"app/core/core":{appEvents:Me.lE,contextSrv:Me.TP},"app/core/services/backend_srv":{BackendSrv:De.Mf,getBackendSrv:De.AI},"app/core/table_model":{default:Le.A,__useDefault:!0},"app/core/time_series":{default:Ie.A,__useDefault:!0},"app/core/time_series2":{default:Ie.A,__useDefault:!0},"app/core/utils/datemath":$e,"app/core/utils/flatten":ie,"app/core/utils/kbn":{default:ve.A,__useDefault:!0},"app/core/utils/ticks":fe,"app/features/dashboard/impression_store":{impressions:Ke.A},d3:()=>Promise.all([e.e(407),e.e(5995)]).then(e.bind(e,55995)),emotion:()=>Promise.resolve().then(e.bind(e,22803)),i18next:()=>Promise.resolve().then(e.bind(e,72635)),jquery:{default:le(),__useDefault:!0},...xe,lodash:()=>Promise.resolve().then(e.t.bind(e,2543,23)).then(pt=>({...pt,move:Ne.b,__useDefault:!0})),moment:()=>Promise.resolve().then(e.t.bind(e,95093,23)).then(pt=>({...pt,__useDefault:!0})),prismjs:()=>Promise.resolve().then(e.t.bind(e,28848,23)),react:()=>Promise.resolve().then(e.t.bind(e,96540,19)),"react-dom":()=>Promise.resolve().then(e.t.bind(e,40961,19)),"react-inlinesvg":()=>Promise.resolve().then(e.bind(e,13686)),"react-redux":()=>Promise.resolve().then(e.bind(e,71468)),"react-router-dom":()=>Promise.resolve().then(e.bind(e,71519)),"react-router":()=>Promise.resolve().then(e.bind(e,35557)),redux:()=>Promise.resolve().then(e.bind(e,14644)),rxjs:()=>Promise.all([e.e(3812),e.e(5091)]).then(e.bind(e,75091)),"rxjs/operators":()=>Promise.all([e.e(3812),e.e(2975)]).then(e.bind(e,32975)),slate:()=>Promise.resolve().then(e.bind(e,82611)),"slate-plain-serializer":()=>Promise.resolve().then(e.bind(e,75226)),"slate-react":()=>Promise.resolve().then(e.bind(e,29317))};function Ve({url:pt,source:Xt,transformSourceMapURL:hn=!1,transformAssets:Sn=!0}){const Wn=pt.split("/public/plugins/"),Jn=Wn[0],fs=Wn[1].split("/")[0];let qn=Xt;return Sn&&(qn=qn.replace(/(\/?)(public\/plugins)/g,`${Jn}/$2`),qn=qn.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${Jn}/public/$2$3`)),hn&&(qn=qn.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${Jn}/public/plugins/${fs}/$2.map`)),qn}var ke=e(22065),Oe=e(25713);async function nt(pt,Xt,hn){const Sn=await pt(Xt,hn),Wn=Sn.headers.get("content-type")||"";if(ke.Bu.test(Wn)){let fs=await Sn.text();if((0,Oe.OD)(Sn.url)){const qn=Ve({url:Sn.url,source:fs});return new Response(new Blob([qn],{type:"text/javascript"}))}return new Response(new Blob([fs],{type:"text/javascript"}))}return Sn}function Je(pt,Xt,hn){try{const Sn=pt.apply(this,[Xt,hn]),Wn=Ze(Sn);return(Wn.endsWith(".js")||Wn.endsWith(".css"))&&!(0,Oe.OD)(Wn)?(0,re.ni)(Wn):Wn}catch{if(ke.$b.test(Xt)){const Wn=tt(Xt),Jn=pt.apply(this,[Wn,hn]);return(0,re.ni)(Jn)}return console.warn(`SystemJS: failed to resolve '${Xt}'`),Xt}}function Be(pt,Xt){if(new URL(Xt,window.location.origin).pathname.endsWith(".css")&&!pt){const Wn=ne.z.get(Xt)?.default;Wn&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,Wn])}}function Ze(pt){return pt.startsWith(`${ke.XV}:`)?pt:(pt.endsWith("!")&&(pt=pt.slice(0,-1)),["css","js","json","wasm"].some(Sn=>pt.endsWith(Sn))?pt:pt+".js")}function tt(pt){const Xt=pt.split("/")[1];let hn="";for(const[Jn]of ne.z.entries())if(Jn.includes(Xt)){hn=Jn;break}const Sn=hn.lastIndexOf("/plugins");return Sn===-1?`${a.$.appSubUrl??""}/public/${pt}`:`${hn.substring(0,Sn)}/${pt}`}var Re=e(22055),at=e(79568),yt=e(8503);function ze(pt){const Xt=new URL(window.location.href),hn=new URL(pt);return Xt.host===hn.host}async function st(pt,Xt){let hn="";if(ze(pt)?(hn=await(await fetch(pt)).text(),hn=Ve({url:pt,source:hn,transformSourceMapURL:!0,transformAssets:!1})):(0,Oe.OD)(pt)&&(hn=await(await fetch(pt)).text(),hn=Ve({url:pt,source:hn,transformSourceMapURL:!0,transformAssets:!0})),hn.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");hn=Gt(hn),Xt.evaluate(hn)}async function ht(pt){if((0,Oe.OD)(pt.module)){const Xt=pt.module;let Sn=await(await fetch(Xt)).text();if(!It(Sn,pt.moduleHash))throw new Error("Invalid SRI for plugin module file");return Sn=Ve({url:Xt,source:Sn,transformSourceMapURL:!0,transformAssets:!0}),Sn}else{let Xt=(0,Oe.Av)(pt.module);const hn=(0,re.ni)(Xt);let Wn=await(await fetch(hn)).text();if(!It(Wn,pt.moduleHash))throw new Error("Invalid SRI for plugin module file");return Wn=Ve({url:hn,source:Wn,transformSourceMapURL:!0,transformAssets:!1}),Wn=Gt(Wn),Wn}}async function It(pt,Xt){if(!a.$.featureToggles.pluginsSriChecks||!Xt||Xt.length===0)return!0;const[hn,Sn]=Xt.split("-"),Wn=hn.replace("sha","SHA-"),fs=new TextEncoder().encode(pt),qn=await crypto.subtle.digest(Wn,fs),Cs=btoa(String.fromCharCode(...new Uint8Array(qn)));return`${hn}-${Cs}`===Xt}function Gt(pt){return pt.replace(/window\.location/gi,"window.locationSandbox")}function un(pt){pt.evaluate(`${yt.V.toString()};${yt.V.name}()`)}function vn(pt){for(const Xt of Object.values(a.$.datasources))if(Xt.type===pt)return Xt.meta;for(const Xt of Object.values(a.$.panels))if(Xt.id===pt)return Xt;for(const Xt of Object.values(a.$.apps))if(Xt.id===pt)return{id:pt,type:t.QE.app,module:Xt.path,moduleHash:Xt.moduleHash};throw new Error(`Could not find plugin ${pt}`)}var pn=e(2543);const xn=["iframe"];var cn=e(7077),jn=e(28848),_n=e.n(jn),Ot=e(50471),Rt=e(96540),Ye=e(18729);const dt=!!a.$.featureToggles.frontendSandboxMonitorOnly;function lt(pt){return!!pt&&typeof pt=="object"&&pt?.hasOwnProperty("plugin")}function Pt(pt){throw new Error(`Unexpected object: ${pt}. This should never happen.`)}const Bt=(0,Ye.DW)("sandbox",{monitorOnly:String(dt)});function Jt(pt){return pt instanceof Rt.Component}function qt(pt,Xt){Bt.logWarning(pt,Xt)}function gn(pt,Xt){Bt.logError(pt,Xt)}function On(pt,Xt){Bt.logInfo(pt,Xt)}function Tn(pt){return pt?.constructor?.name==="RegExp"}function wn(pt){return pt&&(Tn(pt)&&(0,cn.U)(pt)?new RegExp(pt):Array.isArray(pt)?pt.map(wn):typeof pt=="object"?Object.keys(pt).reduce((Xt,hn)=>(Reflect.set(Xt,hn,wn(Reflect.get(pt,hn))),Xt),{}):pt)}function ps(pt){return pt&&((0,cn.U)(pt)?(0,pn.cloneDeep)(pt):Array.isArray(pt)?pt.map(ps):typeof pt=="object"?Object.keys(pt).reduce((Xt,hn)=>(Reflect.set(Xt,hn,ps(Reflect.get(pt,hn))),Xt),{}):pt)}const es=Symbol.for("@@SANDBOX_LIVE_VALUE"),ls=!!a.$.featureToggles.frontendSandboxMonitorOnly;function Lt(pt,Xt){const hn=Reflect.get(pt,"nodeName");if(hn==="body"||pt===document.body)return document.body;if(hn==="head"||pt===document.head||pt===document.documentElement)return pt;if(xn.includes(hn)&&(qt("<"+hn+"> is not allowed in sandboxed plugins",{pluginId:Xt,param:hn}),!ls))throw new Error("<"+hn+"> is not allowed in sandboxed plugins");if(zn(pt,Xt)||pt.parentNode===document.body||pt.closest("#reactRoot")===null||ls)return pt;{const Sn=document.createElement(hn);return Sn.dataset.grafanaPluginSandboxElement="true",Sn}}function $t(pt){if(typeof pt=="object"&&pt instanceof Element)try{return pt.nodeName!==void 0}catch{return!1}return!1}function nn(pt){const Xt=Reflect.get(pt,"style");Object.hasOwn(Xt,es)||Reflect.defineProperty(Xt,es,{})}function on(pt){pt&&(Array.isArray(pt)?(pt.forEach(on),bn(pt)):typeof pt=="object"&&(Object.values(pt).forEach(on),bn(pt)))}function bn(pt){if(pt)return Object.hasOwn(pt,es)||Reflect.defineProperty(pt,es,{}),pt}function In(pt){pt&&(Object.hasOwn(pt,es)||((0,cn.U)(pt)&&!(pt instanceof Function)&&(Jt(pt)||pt instanceof n.mA||pt instanceof Ot.f5)?Reflect.defineProperty(pt,es,{}):pt===_n().languages&&Object.defineProperty(pt,es,{})))}function Yn(pt){return Object.hasOwn(pt,es)}function zn(pt,Xt){return!document.contains(pt)||pt.closest(`[data-plugin-sandbox=${Xt}]`)!==null}let St;function zt(){return St||(St=document.createElement("div"),St.setAttribute("id","grafana-plugin-sandbox-body"),St.setAttribute("data-plugin-sandbox","true"),St.dataset.pluginSandbox="sandboxed-plugin",St.style.width="100%",St.style.height="0%",St.style.overflow="hidden",St.style.top="0",St.style.left="0",document.body.appendChild(St)),St}let Qt=!1;function an(){Qt||(Qt=!0,yn(),mn())}function mn(){const pt=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...Xt){return pt.apply(this,ps(Xt))}})}function yn(){const pt=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...Xt){let hn=Xt;try{hn=(0,pn.cloneDeep)(Xt)}catch(Sn){qt("Error cloning args in window.history.replaceState",{error:String(Sn)})}return Reflect.apply(pt,this,hn)},writable:!0,configurable:!0,enumerable:!1})}const Ct=new Map,ut=!!a.$.featureToggles.frontendSandboxMonitorOnly,Et=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function Ut(){return Ct.size===0&&(gt(Ct),Vt(Ct),Ft(Ct),ts(Ct),Un(Ct),dn(Ct),Cn(Ct),ms(Ct),us(Ct),Yt(Ct),ot(Ct),ft(Ct)),Ct}function Wt(pt,Xt){return qt(`Plugin ${Xt.id} tried to set a sandboxed property`,{pluginId:Xt.id,attrOrMethod:String(pt),entity:"window"}),ut?pt:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function gt(pt){const Xt=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const Sn of Xt){const Wn=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,Sn);if(Wn){let Jn=function(fs,qn){const Cs=qn.id;return qt(`Plugin ${Cs} tried to access iframe.${Sn}`,{pluginId:Cs,attrOrMethod:Sn,entity:"iframe"}),ut?fs:()=>{throw new Error("iframe."+Sn+" is not allowed in sandboxed plugins")}};var hn=Jn;Wn.value&&pt.set(Wn.value,Jn),Wn.set&&pt.set(Wn.set,Jn),Wn.get&&pt.set(Wn.get,Jn)}}}function Vt(pt){const Xt=Object.getOwnPropertyDescriptor(window,"console");if(Xt?.value){let Sn=function(Wn,Jn){const fs=Jn.id;if(ut)return Wn;function qn(...Cs){console.log(`[plugin ${fs}]`,...Cs)}return{log:qn,warn:qn,error:qn,info:qn,debug:qn,table:qn}};var hn=Sn;pt.set(Xt.value,Sn)}Xt?.set&&pt.set(Xt.set,Wt)}function Ft(pt){function Xt(Sn,Wn){const Jn=Wn.id;return qt(`Plugin ${Jn} accessed window.alert`,{pluginId:Jn,attrOrMethod:"alert",entity:"window"}),ut?Sn:function(...fs){console.log(`[plugin ${Jn}]`,...fs)}}const hn=Object.getOwnPropertyDescriptor(window,"alert");hn?.value&&pt.set(hn.value,Xt),hn?.set&&pt.set(hn.set,Wt)}function dn(pt){function Xt(Sn,Wn){const Jn=Wn.id;return function(...qn){for(const Cs of qn){const _s=String(Cs||"").toLowerCase();for(const Ls of xn)if(_s.includes("<"+Ls)){if(qt(`Plugin ${Jn} tried to set ${Ls} in innerHTML`,{pluginId:Jn,attrOrMethod:"innerHTML",param:Ls,entity:"HTMLElement"}),ut)continue;throw new Error("<"+Ls+"> is not allowed in sandboxed plugins")}}if((0,pn.isFunction)(Sn))return Sn.apply(this,qn)}}const hn=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const Sn of hn)Sn?.set&&pt.set(Sn.set,Xt),Sn?.value&&pt.set(Sn.value,Xt)}function Cn(pt){function Xt(Sn,Wn){const Jn=Wn.id;return function(qn,Cs){if(qn&&xn.includes(qn)&&(qt(`Plugin ${Jn} tried to create ${qn}`,{pluginId:Jn,attrOrMethod:"createElement",param:qn,entity:"document"}),!ut))return document.createDocumentFragment();if((0,pn.isFunction)(Sn))return Sn.apply(this,[qn,Cs])}}const hn=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");hn?.value&&pt.set(hn.value,Xt)}function Un(pt){function Xt(Jn,fs){const qn=fs.id;return function(_s,Ls){const $s=_s?.nodeName?.toLowerCase()||"";if(_s&&xn.includes($s)&&(qt(`Plugin ${qn} tried to insert ${$s}`,{pluginId:qn,attrOrMethod:"insertChild",param:$s,entity:"HTMLElement"}),!ut))return document.createDocumentFragment();if((0,pn.isFunction)(Jn))return Jn.call(this,_s,Ls)}}function hn(Jn,fs){const qn=fs.id;return function(_s,Ls){const $s=Ls?.nodeName?.toLowerCase()||"";if(Ls&&xn.includes($s)&&(qt(`Plugin ${qn} tried to insert ${$s}`,{pluginId:qn,attrOrMethod:"insertAdjacentElement",param:$s,entity:"HTMLElement"}),!ut))return document.createDocumentFragment();if((0,pn.isFunction)(Jn))return Jn.call(this,_s,Ls)}}const Sn=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const Jn of Sn)Jn?.value&&pt.set(Jn.set,Xt);const Wn=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");Wn?.value&&pt.set(Wn.set,hn)}function ts(pt){function Xt(Jn,fs){const qn=fs.id;return function(..._s){let Ls=_s;const $s=_s?.filter(Ea=>!xn.includes(Ea.nodeName.toLowerCase()));ut||(Ls=$s),Ls.length!==$s.length&&qt(`Plugin ${qn} tried to append fobiddenElements`,{pluginId:qn,attrOrMethod:"append",param:_s?.filter(Ea=>xn.includes(Ea.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,pn.isFunction)(Jn)&&Jn.apply(this,Ls)}}function hn(Jn,fs,qn){const Cs=fs.id;return function(Ls){const $s=Ls?.nodeName?.toLowerCase()||"";if(Ls&&xn.includes($s)&&(qt(`Plugin ${Cs} tried to append ${$s}`,{pluginId:Cs,attrOrMethod:"appendChild",param:$s,entity:"HTMLElement"}),!ut))return document.createDocumentFragment();if(qn&&Ls&&$s==="script"&&Ls instanceof HTMLScriptElement){st(Ls.src,qn).then(()=>{Ls.onload?.call(Ls,new Event("load"))}).catch(Ea=>{Ls.onerror?.call(Ls,new ErrorEvent("error",{error:Ea}))});return}if((0,pn.isFunction)(Jn))return Jn.call(this,Ls)}}const Sn=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const Jn of Sn)Jn?.value&&pt.set(Jn.value,Xt);const Wn=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");Wn?.value&&pt.set(Wn.value,hn)}function ms(pt){const Xt=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function hn(Sn){return function(...Jn){try{const fs=(0,pn.cloneDeep)(Jn);(0,pn.isFunction)(Sn)&&Sn.apply(this,fs)}catch{throw new Error("postMessage arguments are invalid objects")}}}Xt?.value&&pt.set(Xt.value,hn)}function us(pt){const Xt=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");Xt?.get&&pt.set(Xt.get,()=>()=>window);const hn=["write"];for(const Sn of hn){const Wn=Object.getOwnPropertyDescriptor(Document.prototype,Sn);Wn?.set&&pt.set(Wn.set,Wt),Wn?.value&&pt.set(Wn.value,Wt)}}async function Yt(pt){const Xt=Reflect.get(window,"monaco");if(!Xt||Object.hasOwn(Xt,Et))return;const hn=Xt.languages.setMonarchTokensProvider;function Sn(){return function(...Wn){return Wn.length!==2?hn.apply(Xt,Wn):hn.call(Xt,Wn[0],wn(Wn[1]))}}pt.set(Xt.languages.setMonarchTokensProvider,Sn),Reflect.set(Xt,Et,{})}async function ot(pt){const Xt=Object.getOwnPropertyDescriptor(window,"postMessage");function hn(Sn){return function(...Jn){try{const fs=(0,pn.cloneDeep)(Jn);(0,pn.isFunction)(Sn)&&Sn.apply(this,fs)}catch{throw new Error("postMessage arguments are invalid objects")}}}Xt?.value&&pt.set(Xt.value,hn)}function ct(pt){Yt(Ct)}function ft(pt){function Xt(hn){return(0,pn.isFunction)(hn)?function(...Sn){const Wn=hn.apply(this,Sn);return on(Wn),Wn}:hn}pt.set(pn.cloneDeep,Xt)}var vt=e(2063),Kt=e(74848);async function Zt(pt,Xt){if(!lt(pt))return pt;const hn=await Promise.resolve(pt.plugin);if(Reflect.has(hn,"panel")&&Reflect.set(hn,"panel",tn(Reflect.get(hn,"panel"),Xt)),Reflect.has(hn,"components")){const Sn=Reflect.get(hn,"components");Object.entries(Sn).forEach(([Wn,Jn])=>{Reflect.set(Sn,Wn,tn(Jn,Xt))}),Reflect.set(hn,"components",Sn)}if(Reflect.has(hn,"root")&&Reflect.set(hn,"root",tn(Reflect.get(hn,"root"),Xt)),Reflect.has(hn,"extensionConfigs")){const Sn=Reflect.get(hn,"extensionConfigs");for(const Wn of Sn)Reflect.has(Wn,"component")&&Reflect.set(Wn,"component",tn(Reflect.get(Wn,"component"),Xt));Reflect.set(hn,"extensionConfigs",Sn)}if(Reflect.has(hn,"configPages")){const Sn=Reflect.get(hn,"configPages")??[];for(const[Wn,Jn]of Object.entries(Sn))!Jn.body||!(0,pn.isFunction)(Jn.body)||Reflect.set(Sn,Wn,{...Jn,body:tn(Jn.body,Xt)});Reflect.set(hn,"configPages",Sn)}return pt}const tn=(pt,Xt)=>{const hn=Rt.memo(Sn=>(0,Kt.jsx)("div",{"data-plugin-sandbox":Xt.id,style:{height:Xt.type===t.QE.app||Xt.type===t.QE.panel?"100%":"auto"},children:(0,Kt.jsx)(pt,{...Sn})}));return hn.displayName=`GrafanaSandbox(${pt.displayName||pt.name||"Component"})`,hn},En=new Map,Ln={};async function Gn({pluginId:pt}){an();try{const Xt=vn(pt);return En.has(pt)||En.set(pt,Hn(Xt)),En.get(pt)}catch(Xt){const hn=new Error(`Could not import plugin ${pt} inside sandbox: `+Xt);throw gn(hn,{pluginId:pt,error:String(Xt)}),hn}}async function Hn(pt){return On("Loading with sandbox",{pluginId:pt.id}),new Promise(async(Xt,hn)=>{const Sn=Ut();let Wn;function Jn(qn){if($t(qn)){const Ls=Lt(qn,pt.id);return nn(Ls),Ls}else In(qn);const Cs=Sn.get(qn);if(Cs)return Cs(qn,pt,Wn);const _s=ct(qn);return _s||qn}Wn=(0,Re.A)(window,{distortionCallback:Jn,defaultPolicy:at.G,liveTargetCallback:Yn,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(qn,...Cs){return setTimeout(qn,0,...Cs)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(Ln[pt.id+"-grafanaBootData"]||(Ln[pt.id+"-grafanaBootData"]=!0,On("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:pt.id,guessedPluginName:pt.id,parent:"window",packageName:"window",key:"grafanaBootData"})),a.$.buildInfo.env==="development")throw new Error(`Error in ${pt.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${pt.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),a.$.bootData},async define(qn,Cs,_s){let Ls,$s;Array.isArray(qn)?(Ls=qn,$s=Cs):(Ls=Cs,$s=_s);try{const Ea=await Qn(Ls,pt),Ga=$s.apply(null,Ea),Wa=await Zt(Ga,pt);Xt(Wa)}catch(Ea){const Ga=new Error(`Could not execute plugin's define ${pt.id}: `+Ea);gn(Ga,{pluginId:pt.id,error:String(Ea)}),hn(Ga)}}})}),un(Wn);let fs="";try{fs=await ht(pt)}catch(qn){const Cs=new Error(`Could not load plugin code ${pt.id}: `+qn);gn(Cs,{pluginId:pt.id,error:String(qn)}),hn(Cs)}try{Wn.evaluate(fs)}catch(qn){const Cs=new Error(`Could not run plugin ${pt.id} inside sandbox: `+qn);gn(Cs,{pluginId:pt.id,error:String(qn)}),hn(Cs)}})}async function Qn(pt,Xt){const hn={},Sn={id:Xt.id,uri:Xt.module,exports:hn},Wn=[];for(const Jn of pt){let fs=vt.s.get(Jn);if(typeof fs=="function"&&(fs=await fs()),fs?.__useDefault&&(fs=fs.default),Jn==="module"&&(fs=Sn),Jn==="exports"&&(fs=hn),!fs){const qn=new Error(`[sandbox] Could not resolve dependency ${Jn}`);throw gn(qn,{pluginId:Xt.id,dependency:Jn,error:String(qn)}),qn}Wn.push(fs)}return Wn}var cs=e(40034),vs=e(6838);let hs=Da;function Vs(pt){hs=pt}async function As({isAngular:pt,pluginId:Xt}){return await Ys({isAngular:pt,pluginId:Xt})?hs({isAngular:pt,pluginId:Xt}):!1}async function Ys({isAngular:pt,pluginId:Xt}){return!a.$.featureToggles.pluginsFrontendSandbox||pt||location.search.includes("nosandbox")&&a.$.buildInfo.env==="development"?!1:ha({pluginId:Xt})}async function ha({pluginId:pt}){try{const Xt=await(0,vs.x)(pt,{showErrorAlert:!1});return Xt.signatureType!==t.kv.grafana&&Xt.signature!=="internal"}catch{try{const hn=await(0,cs.CB)(pt);return hn.signatureType!==t.kv.grafana&&hn.signature!=="internal"}catch{return!1}}}async function Da({pluginId:pt}){return!!a.$.enableFrontendSandboxForPlugins?.includes(pt)}var Sa=e(55463);const na=(0,Oe.kB)(je);ne.z.addImportMap({imports:na});const Zs=ne.z.constructor.prototype;Zs.shouldFetch=function(pt){const Xt=(0,re.QO)(pt);return/^[^#?]+\.(js)([?#].*)?$/.test(pt)?Xt?.loadingStrategy!==t.xf.script:!0};const sa=Zs.import;Zs.import=function(...pt){return sa.apply(this,pt).then(Xt=>Xt&&Xt.__useDefault?Xt.default:Xt)};const Ha=Zs.fetch;Zs.fetch=function(pt,Xt){return nt(Ha,pt,Xt)};const Ma=Zs.resolve;Zs.resolve=Je.bind(Zs,Ma),Zs.onload=Be;async function fa({path:pt,pluginId:Xt,loadingStrategy:hn,version:Sn,isAngular:Wn,moduleHash:Jn}){Sn&&(0,re.GD)({path:pt,version:Sn,loadingStrategy:hn});const fs=te[pt];if(fs)return typeof fs=="function"?await fs():fs;const qn=(0,Oe.Av)(pt);if(a.$.featureToggles.pluginsSriChecks){const Cs=System.resolve(qn),_s=System.getImportMap().integrity;Jn&&_s&&!_s[Cs]&&ne.z.addImportMap({integrity:{[Cs]:Jn}})}return await As({isAngular:Wn,pluginId:Xt})?Gn({pluginId:Xt}):ne.z.import(qn).catch(Cs=>{let _s=new Error("Could not load plugin: "+Cs);throw console.error(_s),Sa.z4.logError(_s,{path:pt,pluginId:Xt,pluginVersion:Sn??"",expectedHash:Jn??"",loadingStrategy:hn.toString(),sriChecksEnabled:(a.$.featureToggles.pluginsSriChecks??!1).toString()}),_s})}function Rs(pt){const Xt=pt.angular?.detected??pt.angularDetected,hn=pt.loadingStrategy??t.xf.fetch;return fa({path:pt.module,version:pt.info?.version,isAngular:Xt,loadingStrategy:hn,pluginId:pt.id,moduleHash:pt.moduleHash}).then(Sn=>{if(Sn.plugin){const Wn=Sn.plugin;return Wn.meta=pt,Wn}if(Sn.Datasource){const Wn=new n.tD(Sn.Datasource);return Wn.setComponentsFromLegacyExports(Sn),Wn.meta=pt,Wn}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}const xa={};async function fr(pt){const Xt=pt.id;if(xa[Xt])return xa[Xt];const hn=await fa({path:pt.module,version:pt.info?.version,pluginId:pt.id,isAngular:pt.angular?.detected??pt.angularDetected,loadingStrategy:pt.loadingStrategy??t.xf.fetch,moduleHash:pt.moduleHash}),{plugin:Sn=new r.hX}=hn;return Sn.init(pt),Sn.meta=pt,Sn.setComponentsFromLegacyExports(hn),ae.eY.register({pluginId:Xt,configs:Sn.exposedComponentConfigs||[]}),ae.a9.register({pluginId:Xt,configs:Sn.addedComponentConfigs||[]}),ae.lQ.register({pluginId:Xt,configs:Sn.addedLinkConfigs||[]}),ae.rH.register({pluginId:Xt,configs:Sn.addedFunctionConfigs||[]}),xa[Xt]=Sn,Sn}},3970:(q,j,e)=>{"use strict";e.d(j,{X:()=>K,v:()=>V});var t=e(74848),n=e(12636),r=e(65307),a=e(96540),i=e(54148),x=e(86360),s=e(83827),c=e(52718),d=e(41007),u=e(32370),g=e(53027),o=e(37e3),E=e(54122),m=e(20337),f=e(22961),p=e(95382),h=e(87638);function D(T){return console.error(T),l("Exception thrown","See console for details")}function C(){return l("Page not found","404 Error")}function l(T,z){const w={text:T,subTitle:z,icon:"exclamation-triangle"};return{node:w,main:w}}var v=e(44608),y=e(83172),P=e(6838),b=e(45251),S=e(55463),M=e(37096);const O={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function R({pluginId:T,pluginNavSection:z}){const{pluginId:w=""}=(0,i.g)();T=T||w;const H=(0,y.OG)(),G=(0,y.TX)(),X=(0,y.ZV)(),k=(0,y.ov)(),_=(0,i.zy)(),[ee,J]=(0,a.useReducer)(L.reducer,O),Z=u.$.appSubUrl+_.pathname+_.search,{plugin:te,loading:ae,loadingError:re,pluginNav:ne}=ee,ce=(0,S.Wy)(Z,z),le=(0,a.useMemo)(()=>(0,g.SE)(_.search),[_.search]),he=(0,a.useMemo)(()=>(0,M.S)(ce),[ce]),oe=(0,p.Il)();(0,a.useEffect)(()=>{B(T,J)},[T]);const de=(0,a.useCallback)(be=>J(L.actions.changeNav(be)),[]);if(!te||T!==te.meta.id){const be=oe.chrome.state.getValue().layout;return(0,t.jsxs)(E.Y,{navModel:ce,pageNav:{text:""},layout:be,children:[ae&&(0,t.jsx)(m.A,{}),!ae&&re&&(0,t.jsx)(f.L,{entity:"App"})]})}if(!te.root)return(0,t.jsx)(E.Y,{navModel:ce??l("Plugin load error"),children:(0,t.jsx)("div",{children:"No root app page component found"})});const me=te.root&&(0,t.jsx)(x.a,{meta:te.meta,children:(0,t.jsx)(y.AZ,{registries:{addedLinksRegistry:H.readOnly(),addedComponentsRegistry:G.readOnly(),exposedComponentsRegistry:X.readOnly(),addedFunctionsRegistry:k.readOnly()},children:(0,t.jsx)(te.root,{meta:te.meta,basename:_.pathname,onNavChanged:de,query:le,path:_.pathname})})}),Pe=()=>{if(!te.meta?.includes)return!0;const be=te.meta?.includes.find(Xe=>Xe.path===_.pathname);if(!be)return!0;if(be?.action&&u.$.featureToggles.accessControlOnCall)return h.TP.hasPermission(be.action);if(h.TP.isGrafanaAdmin||h.TP.user.orgRole===s.X.Admin)return!0;const Se=be?.role||"";return!Se||h.TP.isEditor&&Se===s.X.Viewer?!0:h.TP.hasRole(Se)},Ee=()=>(0,t.jsx)(o.F,{severity:"warning",title:"Access denied",children:"You do not have permission to see this page."});return Pe()?ne?(0,t.jsx)(t.Fragment,{children:ce?(0,t.jsx)(E.Y,{navModel:ce,pageNav:ne?.node,children:(0,t.jsx)(E.Y.Contents,{isLoading:ae,children:me})}):(0,t.jsx)(E.Y,{children:me})}):(0,t.jsx)(M.A.Provider,{value:he,children:me}):(0,t.jsx)(Ee,{})}const L=(0,r.Z0)({name:"prom-builder-container",initialState:O,reducers:{setState:(T,z)=>{Object.assign(T,z.payload)},changeNav:(T,z)=>{let w=z.payload;w&&w.node.children&&(w={...w,node:{...w.main,hideFromBreadcrumbs:!0}}),T.pluginNav=w}}});async function B(T,z){try{const w=await(0,P.x)(T).then(H=>{const G=F(H);return G?(h.lE.emit(c.r1.alertError,[G]),z(L.actions.setState({pluginNav:l(G)})),null):(0,b.ui)(H)});z(L.actions.setState({plugin:w,loading:!1,loadingError:!1,pluginNav:null}))}catch(w){z(L.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:C()}));const H=w instanceof Error?w:new Error((0,v.q6)(w));S.z4.logError(H),console.error(H)}}function F(T){return T?T.type!==d.QE.app?"Plugin must be an app":T.enabled?null:"Application Not Enabled":"Unknown Plugin"}const I=R;var U=e(83394);const W=T=>"pluginId"in T&&"id"in T,A=T=>T.startsWith("standalone-plugin-page-/");function N(T){const z=(0,n.rH)(T),w=`/a/${T.pluginId}`,H=A(T.id)&&T.url||w,G=A(T.id)&&!T.url?.startsWith("/a/");return{path:`${H}/*`,sensitive:G,component:()=>(0,t.jsx)(I,{pluginId:T.pluginId,pluginNavSection:z})}}function K(){const T=(0,U.Gu)(),{navIndex:z}=T;return[...Object.values(z).filter(W).map(N),{path:"/a/:pluginId/*",component:()=>(0,t.jsx)(I,{pluginNavSection:z.home})}]}function V(T){const z=(0,U.Gu)(),{navIndex:w}=z,H=Object.values(w).filter(W).find(G=>G.pluginId===T);return H?N(H):{path:"/a/:pluginId/*",component:()=>(0,t.jsx)(I,{pluginNavSection:w.home})}}},2063:(q,j,e)=>{"use strict";e.d(j,{s:()=>t});const t=new Map([])},55463:(q,j,e)=>{"use strict";e.d(j,{W3:()=>x,Wy:()=>s,z4:()=>c});var t=e(41007),n=e(18729),r=e(43956),a=e(6838),i=e(45251);async function x(d){const u=await(0,a.x)(d);let g;if(u.type===t.QE.app&&(g=await(0,i.ui)(u)),u.type===t.QE.datasource&&(g=await(0,i.cS)(u)),u.type===t.QE.panel&&(g=await(0,r.Kk)(u)),u.type===t.QE.renderer&&(g={meta:u}),!g)throw new Error("Unknown Plugin type: "+u.type);return g}function s(d,u){if(!u)return;const g=10;let o={...u},E;function m(p,h){return!h.startsWith(p.url??"")||E&&(E.url?.length??0)>(p.url?.length??0)?p:(E&&(E.active=!1),E={...p,active:!0},E)}function f(p,h=0){if(h>g)return p;if(p.children){const D=p.children.map(C=>f(C,h+1));return{...m(p,d),children:D}}return m(p,d)}return o.children=(o?.children??[]).map(f),{main:o,node:E??o}}const c=(0,n.DW)("features.plugins")},32126:(q,j,e)=>{"use strict";e.d(j,{Pj:()=>c,o:()=>d,Aj:()=>g});var t=e(75816),n=e(31226);const a=(0,t.xP)({reducerPath:"userPreferencesAPI",baseQuery:(0,n.W)({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:o=>({getUserPreferences:o.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:o.mutation({query:E=>({url:"/user/preferences",method:"PATCH",body:E.patchPrefsCmd})}),updateUserPreferences:o.mutation({query:E=>({url:"/user/preferences",method:"PUT",body:E.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:i,usePatchUserPreferencesMutation:x,useUpdateUserPreferencesMutation:s}=a,{useGetUserPreferencesQuery:c,usePatchUserPreferencesMutation:d,useUpdateUserPreferencesMutation:u}=a,g=a.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}})},89880:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>M,Cj:()=>g,HO:()=>D,Mj:()=>m,Nm:()=>E,Q9:()=>h,RS:()=>v,c1:()=>u,g$:()=>C,ny:()=>f,ri:()=>p,uh:()=>l,xu:()=>o});var t=e(65307),n=e(2543),r=e.n(n),a=e(88090),i=e(3202),x=e(88023),s=e(87638);const c={orgId:x.Ay.bootData.user.orgId,timeZone:x.Ay.bootData.user.timezone,weekStart:x.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},d=(0,t.Z0)({name:"user/profile",initialState:c,reducers:{updateTimeZone:(O,R)=>{O.timeZone=R.payload.timeZone},updateWeekStart:(O,R)=>{O.weekStart=R.payload.weekStart},updateFiscalYearStartMonth:(O,R)=>{O.fiscalYearStartMonth=R.payload.fiscalYearStartMonth},setUpdating:(O,R)=>{O.isUpdating=R.payload.updating},userLoaded:(O,R)=>{O.user=R.payload.user},initLoadTeams:(O,R)=>{O.teamsAreLoading=!0},teamsLoaded:(O,R)=>{O.teams=R.payload.teams,O.teamsAreLoading=!1},initLoadOrgs:(O,R)=>{O.orgsAreLoading=!0},orgsLoaded:(O,R)=>{O.orgs=R.payload.orgs,O.orgsAreLoading=!1},initLoadSessions:(O,R)=>{O.sessionsAreLoading=!0},sessionsLoaded:(O,R)=>{const L=R.payload.sessions.sort((B,F)=>Number(F.isActive)-Number(B.isActive));O.sessions=L.map(B=>({id:B.id,isActive:B.isActive,seenAt:(0,a.fq)(B.seenAt),createdAt:B.createdAt,clientIp:B.clientIp,browser:B.browser,browserVersion:B.browserVersion,authModule:B.authModule,os:B.os,osVersion:B.osVersion,device:B.device})),O.sessionsAreLoading=!1},userSessionRevoked:(O,R)=>{O.sessions=O.sessions.filter(L=>L.id!==R.payload.tokenId),O.isUpdating=!1}}}),u=O=>async R=>{(0,n.set)(s.TP,"user.fiscalYearStartMonth",O),R(b({fiscalYearStartMonth:O}))},g=O=>async R=>{(!(0,n.isString)(O)||(0,n.isEmpty)(O))&&(O=x.Ay?.bootData?.user?.timezone),(0,n.set)(s.TP,"user.timezone",O),R(y({timeZone:O}))},o=O=>async R=>{(!(0,n.isString)(O)||(0,n.isEmpty)(O))&&(O=x.Ay?.bootData?.user?.weekStart),(0,n.set)(s.TP,"user.weekStart",O),R(P({weekStart:O})),(0,i.$D)(O)},{setUpdating:E,initLoadOrgs:m,orgsLoaded:f,initLoadTeams:p,teamsLoaded:h,userLoaded:D,userSessionRevoked:C,initLoadSessions:l,sessionsLoaded:v,updateTimeZone:y,updateWeekStart:P,updateFiscalYearStartMonth:b}=d.actions,S=d.reducer,M={user:d.reducer}},10743:(q,j,e)=>{"use strict";e.d(j,{O:()=>t,q:()=>n});const t=r=>r.timeZone,n=r=>r.fiscalYearStartMonth},54230:(q,j,e)=>{"use strict";e.d(j,{d:()=>r,m:()=>n});class t{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(i){this.extraRenderActions=this.extraRenderActions.concat(i)}addKeyedExtraRenderAction(i,x){this.keyedScopedExtraRenderActions.set(i,x)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(i){return Array.from(this.keyedScopedExtraRenderActions,s=>s[1]).filter(s=>s.scope===i).map(s=>s.queryActionComponent)}}const n=new t,r=new t},52869:(q,j,e)=>{"use strict";e.d(j,{c:()=>T,E:()=>w});var t=e(74848),n=e(46942),r=e.n(n),a=e(2543),i=e(55127),x=e.n(i),s=e(96540),c=e(16753),d=e(83821),u=e(61809),g=e(10112),o=e(8392),E=e(4038),m=e(52718),f=e(58779),p=e(98437),h=e(4050),D=e(56276),C=e(66384),l=e(49816),v=e(8716),y=e(33833),P=e(56180),b=e(11817),S=e(80757),M=e(63845),O=e(59485),R=e(54230),L=e(22803),B=e(29675),F=e(79784),I=e(34128),U=e(64467),W=e(15773);const A=G=>{const{query:X,queries:k,onChange:_,collapsedText:ee,renderExtras:J,hidden:Z,hideRefId:te=!1}=G,ae=(0,B.of)(K),[re,ne]=(0,s.useState)(!1),[ce,le]=(0,s.useState)(null),he=be=>{ne(!0)},oe=be=>{if(ne(!1),ce){le(null);return}X.refId!==be&&_({...X,refId:be})},de=be=>{const Se=be.currentTarget.value.trim();if(Se.length===0){le("An empty query name is not allowed");return}for(const Xe of k)if(Xe!==X&&Se===Xe.refId){le("Query name already exists");return}ce&&le(null)},me=be=>{oe(be.currentTarget.value.trim())},Pe=be=>{be.key==="Enter"&&oe(be.currentTarget.value)},Ee=be=>{be.target.select()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:ae.wrapper,children:[!te&&!re&&(0,t.jsxs)("button",{className:ae.queryNameWrapper,"aria-label":f.Tp.components.QueryEditorRow.title(X.refId),title:"Edit query name",onClick:he,"data-testid":"query-name-div",type:"button",children:[(0,t.jsx)("span",{className:ae.queryName,children:X.refId}),(0,t.jsx)(F.I,{name:"pen",className:ae.queryEditIcon,size:"sm"})]}),!te&&re&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.p,{type:"text",defaultValue:X.refId,onBlur:me,autoFocus:!0,onKeyDown:Pe,onFocus:Ee,invalid:ce!==null,onChange:de,className:ae.queryNameInput,"data-testid":"query-name-input"}),ce&&(0,t.jsx)(U.P,{horizontal:!0,children:ce})]}),N(G,ae),J&&(0,t.jsx)("div",{className:ae.itemWrapper,children:J()}),Z&&(0,t.jsx)("em",{className:ae.contextInfo,children:"Hidden"})]}),ee&&(0,t.jsx)("div",{className:ae.collapsedText,children:ee})]})},N=(G,X)=>{const{alerting:k,dataSource:_,onChangeDataSource:ee}=G;return ee?(0,t.jsx)("div",{className:X.itemWrapper,children:(0,t.jsx)(W.s,{dashboard:!0,variables:!0,alerting:k,current:_.name,onChange:ee})}):(0,t.jsxs)("em",{className:X.contextInfo,children:["(",_.name,")"]})},K=G=>({wrapper:(0,L.css)({label:"Wrapper",display:"flex",alignItems:"center",marginLeft:G.spacing(.5),overflow:"hidden"}),queryNameWrapper:(0,L.css)({display:"flex",cursor:"pointer",border:"1px solid transparent",borderRadius:G.shape.radius.default,alignItems:"center",padding:G.spacing(0,0,0,.5),margin:0,background:"transparent",overflow:"hidden","&:hover":{background:G.colors.action.hover,border:`1px dashed ${G.colors.border.strong}`},"&:focus":{border:`2px solid ${G.colors.primary.border}`},"&:hover, &:focus":{".query-name-edit-icon":{visibility:"visible"}}}),queryName:(0,L.css)({fontWeight:G.typography.fontWeightMedium,color:G.colors.primary.text,cursor:"pointer",overflow:"hidden",marginLeft:G.spacing(.5)}),queryEditIcon:(0,L.cx)((0,L.css)({marginLeft:G.spacing(2),visibility:"hidden"}),"query-name-edit-icon"),queryNameInput:(0,L.css)({maxWidth:"300px",margin:"-4px 0"}),collapsedText:(0,L.css)({fontWeight:G.typography.fontWeightRegular,fontSize:G.typography.bodySmall.fontSize,color:G.colors.text.secondary,paddingLeft:G.spacing(1),alignItems:"center",overflow:"hidden",fontStyle:"italic",whiteSpace:"nowrap",textOverflow:"ellipsis"}),contextInfo:(0,L.css)({fontSize:G.typography.bodySmall.fontSize,fontStyle:"italic",color:G.colors.text.secondary,paddingLeft:"10px",paddingRight:"10px"}),itemWrapper:(0,L.css)({display:"flex",marginLeft:"4px"})});var V=e(87433);class T extends s.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,p.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const X=(0,h.E)(),k='<plugin-component type="query-ctrl" />',_={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=X.load(this.element,_,k),this.angularScope=_.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:X,onChange:k,queries:_,onRunQuery:ee,onAddQuery:J,app:Z=c.Jk.PanelEditor,history:te}=this.props,{datasource:ae,data:re}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(ae?.components?.QueryCtrl)return(0,t.jsx)("div",{ref:ne=>this.element=ne});if(ae){let ne=this.getReactQueryEditor(ae);if(ne)return(0,t.jsx)(d.p,{instanceSettings:this.props.dataSource,children:(0,t.jsx)(ne,{query:X,datasource:ae,onChange:k,onRunQuery:ee,onAddQuery:J,data:re,range:(0,S.jG)().timeRange(),queries:_,app:Z,history:te},ae?.name)})}return(0,t.jsx)("div",{children:(0,t.jsx)(b.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onToggleEditMode=(X,k)=>{X.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),k.isOpen||k.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:X,query:k,onQueryRemoved:_}=this.props;X(k),_&&_()},this.onCopyQuery=()=>{const{query:X,onAddQuery:k,onQueryCopied:_}=this.props,ee=(0,a.cloneDeep)(X);k(ee),_&&_()},this.onHideQuery=()=>{const{query:X,onChange:k,onRunQuery:_,onQueryToggled:ee}=this.props;k({...X,hide:!X.hide}),_(),ee&&ee(X.hide),(0,D.rR)("query_editor_row_hide_query_clicked",{hide:!X.hide})},this.onToggleHelp=()=>{this.setState(X=>({showingHelp:!X.showingHelp}))},this.onClickExample=X=>{X.datasource===void 0&&(X.datasource=(0,u.p$)(this.props.dataSource)),this.props.onChange({...X,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=X=>{const{data:k,query:_}=this.props,J=(w(k,_.refId)?.series??[]).reduce((le,he)=>{if(!he.meta?.notices)return le;const oe=(0,a.filter)(he.meta.notices,de=>de.severity===X)??[];return le.concat(oe)},[]),Z=(0,a.uniqBy)(J,"text");if(!(Z.length>0))return null;const ae="query-"+X+"s",re=X==="warning"?"orange":"blue",ne=X==="warning"?"exclamation-triangle":"file-landscape-alt",ce=Z.map(le=>le.text).join(`
`);return(0,t.jsx)(C.E,{color:re,icon:ne,text:(0,t.jsxs)(t.Fragment,{children:[Z.length," ",x()(X,Z.length)]}),tooltip:ce},ae)},this.renderExtraActions=()=>{const{query:X,queries:k,data:_,onAddQuery:ee,dataSource:J,app:Z}=this.props,te=R.d.getAllExtraRenderAction();let ae=[];Z!==void 0&&(ae=R.d.getScopedExtraRenderAction(Z));const re=[...te,...ae].map((ne,ce)=>ne({query:X,queries:k,timeRange:_.timeRange,onAddQuery:ee,dataSource:J,key:ce})).filter(Boolean);return re.push(this.renderWarnings("info")),re.push(this.renderWarnings("warning")),re},this.renderActions=X=>{const{query:k,hideHideQueryButton:_=!1}=this.props,{hasTextEditMode:ee,datasource:J,showingHelp:Z}=this.state,te=!!k.hide,ae=J?.components?.QueryEditorHelp;return(0,t.jsxs)(t.Fragment,{children:[ae&&(0,t.jsx)(y.A,{title:(0,b.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:Z}),ee&&(0,t.jsx)(y.q,{title:(0,b.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:re=>{this.onToggleEditMode(re,X)}}),this.renderExtraActions(),(0,t.jsx)(H,{query:k}),(0,t.jsx)(y.q,{title:(0,b.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),_?null:(0,t.jsx)(y.A,{dataTestId:f.Tp.components.QueryEditorRow.actionButton("Hide response"),title:k.hide?(0,b.t)("query-operation.header.show-response","Show response"):(0,b.t)("query-operation.header.hide-response","Hide response"),icon:te?"eye-slash":"eye",active:te,onClick:this.onHideQuery}),(0,t.jsx)(y.q,{title:(0,b.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=X=>{const{alerting:k,query:_,dataSource:ee,onChangeDataSource:J,onChange:Z,queries:te,renderHeaderExtras:ae,hideRefId:re}=this.props;return(0,t.jsx)(A,{query:_,queries:te,onChangeDataSource:J,dataSource:ee,hidden:_.hide,onClick:ne=>this.onToggleEditMode(ne,X),onChange:Z,collapsedText:X.isOpen?null:this.renderCollapsedText(),renderExtras:ae,alerting:k,hideRefId:re})}}componentDidMount(){const{data:X,query:k,id:_}=this.props,ee=w(X,k.refId);this.id=(0,a.uniqueId)(_+"_"),this.setState({data:ee}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:X,queries:k}=this.props,{datasource:_}=this.state,ee=new M.a9({targets:k}),J={},Z=this;return{datasource:_,target:X,panel:ee,dashboard:J,refresh:()=>{X.hide!==Z.props.query.hide&&(X.hide=Z.props.query.hide),this.props.onChange(X),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new g.o,range:(0,S.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const X=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return X?.rawRef?.uid??X?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let X;const k=this.getInterpolatedDataSourceUID();try{X=await this.dataSourceSrv.get(k)}catch{X=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(X),this.setState({datasource:X,queriedDataSourceIdentifier:k,hasTextEditMode:(0,a.has)(X,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(X){const{datasource:k,queriedDataSourceIdentifier:_}=this.state,{data:ee,query:J}=this.props;if(X.id!==this.props.id&&(this.id=(0,a.uniqueId)(this.props.id+"_")),ee!==X.data){const Z=w(ee,J.refId);this.setState({data:Z}),this.angularScope&&(this.angularScope.range=(0,S.jG)().timeRange()),this.angularQueryEditor&&Z&&z(this.angularScope,Z,this.angularQueryEditor)}if(k&&_!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(X){if(X)switch(this.props.app){case c.Jk.Explore:return X.components?.ExploreMetricsQueryField||X.components?.ExploreLogsQueryField||X.components?.ExploreQueryField||X.components?.QueryEditor;case c.Jk.PanelEditor:case c.Jk.Dashboard:default:return X.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:X}=this.state;return X?.getQueryDisplayText?X.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:X,index:k,visualization:_,collapsable:ee,hideActionButtons:J}=this.props,{datasource:Z,showingHelp:te,data:ae}=this.state,re=X.hide,ne=ae?.error&&ae.error.refId===X.refId?ae.error:ae?.errors?.find(oe=>oe.refId===X.refId),ce=r()("query-editor-row",{"query-editor-row--disabled":re,"gf-form-disabled":re});if(!Z)return null;const le=this.renderPluginEditor(),he=Z.components?.QueryEditorHelp;return(0,t.jsx)("div",{"data-testid":"query-editor-row","aria-label":f.Tp.components.QueryEditorRows.rows,children:(0,t.jsx)(P.u,{id:this.id,draggable:!J,collapsable:ee,index:k,headerElement:this.renderHeader,actions:J?void 0:this.renderActions,onOpen:this.onOpen,children:(0,t.jsxs)("div",{className:ce,id:this.id,children:[(0,t.jsxs)(l.Xw,{children:[te&&he&&(0,t.jsx)(v.j,{children:(0,t.jsx)(he,{onClickExample:oe=>this.onClickExample(oe),query:this.props.query,datasource:Z})}),le]}),ne&&(0,t.jsx)(V.x,{error:ne}),_]})})})}}function z(G,X,k){if(X.state===o.Gu.Done){const _=X.series.map(ee=>(0,E.w3)(ee));G.events.emit(m.ee.dataReceived,_)}else X.state===o.Gu.Error&&G.events.emit(m.ee.dataError,X.error);setTimeout(k.digest)}function w(G,X){const k=G.series.filter(Z=>Z.refId===X);if(G.state!==o.Gu.Loading&&(G.error||G.errors?.length)&&!G.series.length)return{...G,state:o.Gu.Error};let _=G.state,ee=G.errors?.find(Z=>Z.refId===X);!ee&&G.error&&(ee=G.error.refId===X?G.error:void 0),_!==o.Gu.Loading&&(ee?_=o.Gu.Error:G.state===o.Gu.Error&&(_=o.Gu.Done));const J=G.timeRange;return{...G,state:_,series:k,error:ee,errors:ee?[ee]:void 0,timeRange:J}}function H(G){const{renderSaveQueryButton:X}=(0,O.Y)();return X(G.query)}},33405:(q,j,e)=>{"use strict";e.d(j,{L:()=>c});var t=e(74848),n=e(57095),r=e(96540),a=e(61809),i=e(56276),x=e(98437),s=e(52869);class c extends r.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=g=>{this.props.onQueriesChange(this.props.queries.filter(o=>o!==g))},this.onDragStart=g=>{const{queries:o,dsSettings:E}=this.props;(0,i.rR)("query_row_reorder_started",{startIndex:g.source.index,numberOfQueries:o.length,datasourceType:E.type})},this.onDragEnd=g=>{const{queries:o,onQueriesChange:E,dsSettings:m}=this.props;if(!g||!g.destination)return;const f=g.source.index,p=g.destination.index;if(f===p){(0,i.rR)("query_row_reorder_canceled",{startIndex:f,endIndex:p,numberOfQueries:o.length,datasourceType:m.type});return}const h=Array.from(o),[D]=h.splice(f,1);h.splice(p,0,D),E(h),(0,i.rR)("query_row_reorder_ended",{startIndex:f,endIndex:p,numberOfQueries:o.length,datasourceType:m.type})}}onChangeQuery(g,o){const{queries:E,onQueriesChange:m}=this.props;m(E.map((f,p)=>p===o?g:f))}onDataSourceChange(g,o){const{queries:E,onQueriesChange:m}=this.props;m(E.map((f,p)=>{if(p!==o)return f;const h=(0,a.p$)(g);return f.datasource&&(0,x.l)().getInstanceSettings(f.datasource)?.type===g.type?{...f,datasource:h}:{refId:f.refId,hide:f.hide,datasource:h}}))}render(){const{dsSettings:g,data:o,queries:E,app:m,history:f,eventBus:p,onAddQuery:h,onRunQueries:D,onQueryCopied:C,onQueryRemoved:l,onQueryToggled:v,queryRowWrapper:y}=this.props;return(0,t.jsx)(n.DragDropContext,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.Droppable,{droppableId:"transformations-list",direction:"vertical",children:P=>(0,t.jsxs)("div",{"data-testid":"query-editor-rows",ref:P.innerRef,...P.droppableProps,children:[E.map((b,S)=>{const M=d(b,g),O=g.meta.mixed?L=>this.onDataSourceChange(L,S):void 0,R=(0,t.jsx)(s.c,{id:b.refId,index:S,data:o,query:b,dataSource:M,onChangeDataSource:O,onChange:L=>this.onChangeQuery(L,S),onRemoveQuery:this.onRemoveQuery,onAddQuery:h,onRunQuery:D,onQueryCopied:C,onQueryRemoved:l,onQueryToggled:v,queries:E,app:m,history:f,eventBus:p},b.refId);return y?y(R,b.refId):R}),P.placeholder]})})})}}const d=(u,g)=>u.datasource&&(0,x.l)().getInstanceSettings(u.datasource)||g},87433:(q,j,e)=>{"use strict";e.d(j,{x:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(79784);function i({error:s}){const c=(0,r.of)(x),d=s?.message??s?.data?.message??"Query error";return(0,t.jsxs)("div",{className:c.wrapper,children:[(0,t.jsx)("div",{className:c.icon,children:(0,t.jsx)(a.I,{name:"exclamation-triangle"})}),(0,t.jsxs)("div",{className:c.message,children:[d,s.traceId!=null&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{})," ",(0,t.jsxs)("span",{children:["(Trace ID: ",s.traceId,")"]})]})]})]})}const x=s=>({wrapper:(0,n.css)({marginTop:s.spacing(.5),background:s.colors.background.secondary,display:"flex"}),icon:(0,n.css)({background:s.colors.error.main,color:s.colors.error.contrastText,padding:s.spacing(1)}),message:(0,n.css)({fontSize:s.typography.bodySmall.fontSize,fontFamily:s.typography.fontFamilyMonospace,padding:s.spacing(1)})})},61648:(q,j,e)=>{"use strict";e.d(j,{g:()=>_,K:()=>J});var t=e(74848),n=e(22803),r=e(96540),a=e(8392),i=e(55801),x=e(61809),s=e(16753),c=e(41007),d=e(58779),u=e(98437),g=e(53027),o=e(19550),E=e(54594),m=e(99134),f=e(25356),p=e(90617),h=e(79172),D=e(16817),C=e(60997),l=e(28082),v=e(81876),y=e(11817);function P({pluginId:te}){const{value:ae,loading:re,error:ne}=(0,D.A)(async()=>(0,l.AI)().get(`/api/plugins/${te}/markdown/query_help`),[]),ce=(0,C.G)(ae);return re?(0,t.jsx)(v._,{text:"Loading help..."}):ne?(0,t.jsx)("h3",{children:(0,t.jsx)(y.x6,{i18nKey:"plugins.plugin-help.error",children:"An error occurred when loading help."})}):ae===""?(0,t.jsx)("h3",{children:(0,t.jsx)(y.x6,{i18nKey:"plugins.plugin-help.not-found",children:"No query help could be found."})}):(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:ce}})}var b=e(88023),S=e(75911),M=e(27315),O=e(83678),R=e(15773),L=e(21475),B=e(93420),F=e(52488),I=e(54414),U=e(11147),W=e(54230),A=e(33405),N=e(59577),K=e(29675),V=e(76302),T=e(34128),z=e(29010),w=e(56180);const H=r.memo(({options:te,dataSource:ae,data:re,onChange:ne})=>{const[ce,le]=(0,r.useState)(te.timeRange?.from||""),[he,oe]=(0,r.useState)(te.timeRange?.shift||""),[de,me]=(0,r.useState)(te.timeRange?.hide??!1),[Pe,Ee]=(0,r.useState)(!1),[be,Se]=(0,r.useState)(!0),[Xe,Qe]=(0,r.useState)(!0),we=(0,K.of)(k),$e=(0,r.useCallback)(Ve=>{le(Ve.target.value)},[]),Fe=(0,r.useCallback)(Ve=>{oe(Ve.target.value)},[]),Te=(0,r.useCallback)(Ve=>{const ke=X(Ve.target.value),Oe=G(ke);Oe&&te.timeRange?.from!==ke&&ne({...te,timeRange:{...te.timeRange??{},from:ke}}),Se(Oe)},[ne,te]),Le=(0,r.useCallback)(Ve=>{const ke=X(Ve.target.value),Oe=G(ke);Oe&&te.timeRange?.shift!==ke&&ne({...te,timeRange:{...te.timeRange??{},shift:ke}}),Qe(Oe)},[ne,te]),Ge=(0,r.useCallback)(()=>{const Ve=!de;me(Ve),ne({...te,timeRange:{...te.timeRange??{},hide:Ve}})},[ne,te,de]),Me=(0,r.useCallback)(Ve=>{ne({...te,cacheTimeout:X(Ve.target.value)})},[ne,te]),De=(0,r.useCallback)(Ve=>{let ke=parseInt(Ve.target.value,10);(isNaN(ke)||ke===0)&&(ke=null),ne({...te,queryCachingTTL:ke})},[ne,te]),Ke=(0,r.useCallback)(Ve=>{let ke=parseInt(Ve.currentTarget.value,10);(isNaN(ke)||ke===0)&&(ke=null),ke!==te.maxDataPoints&&ne({...te,maxDataPoints:ke})},[ne,te]),Ie=(0,r.useCallback)(Ve=>{const ke=X(Ve.target.value);ke!==te.minInterval&&ne({...te,minInterval:ke})},[ne,te]),Ne=(0,r.useCallback)(()=>{Ee(!0)},[]),ie=(0,r.useCallback)(()=>{Ee(!1)},[]),ve=()=>{const Ve=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return ae.meta.queryOptions?.cacheTimeout?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.c,{tooltip:Ve,htmlFor:"cache-timeout-id",children:"Cache timeout"}),(0,t.jsx)(T.p,{id:"cache-timeout-id",type:"text",placeholder:"60",spellCheck:!1,onBlur:Me,defaultValue:te.cacheTimeout??""})]}):null},fe=()=>{const Ve="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return ae.cachingConfig?.enabled?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.c,{tooltip:Ve,children:"Cache TTL"}),(0,t.jsx)(T.p,{type:"number",placeholder:`${ae.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:De,defaultValue:te.queryCachingTTL??void 0})]}):null},ge=()=>{const Ve=re.request?.maxDataPoints,ke=te.maxDataPoints??"",Oe=ke==="";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.c,{htmlFor:"max-data-points-input",tooltip:(0,t.jsx)(t.Fragment,{children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:"Max data points"}),(0,t.jsx)(T.p,{id:"max-data-points-input",type:"number",placeholder:`${Ve}`,spellCheck:!1,onBlur:Ke,defaultValue:ke}),Oe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:(0,n.cx)(we.noSquish,we.operator),children:"="}),(0,t.jsx)("span",{className:(0,n.cx)(we.noSquish,we.left),children:"Width of panel"})]})]})},xe=()=>{const Ve=re.request?.interval,ke=ae.interval??"No limit";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.c,{className:we.firstColumn,tooltip:(0,t.jsxs)(t.Fragment,{children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,t.jsx)("code",{children:"1m"})," if your data is written every minute. Default value can be set in data source settings for most data sources."]}),htmlFor:"min-interval-input",children:"Min interval"}),(0,t.jsx)(T.p,{id:"min-interval-input",type:"text",placeholder:`${ke}`,spellCheck:!1,onBlur:Ie,defaultValue:te.minInterval??""}),(0,t.jsx)(V.c,{className:we.firstColumn,tooltip:(0,t.jsxs)(t.Fragment,{children:["The evaluated interval that is sent to data source and is used in ",(0,t.jsx)("code",{children:"$__interval"})," and"," ",(0,t.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to ",(0,t.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:"Interval"}),(0,t.jsx)("span",{className:we.noSquish,children:Ve}),(0,t.jsx)("span",{className:(0,n.cx)(we.noSquish,we.operator),children:"="}),(0,t.jsx)("span",{className:(0,n.cx)(we.noSquish,we.left),children:"Time range / max data points"})]})},je=()=>{if(Pe)return;let Ve=te.maxDataPoints??"";Ve===""&&re.request&&(Ve=`auto = ${re.request.maxDataPoints}`);const ke=re.request?.interval??te.minInterval;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:we.collapsedText,children:["MD = ",Ve]}),(0,t.jsxs)("span",{className:we.collapsedText,children:["Interval = ",ke]})]})};return(0,t.jsx)(w.u,{id:"Query options",index:0,title:"Query options",headerElement:je(),isOpen:Pe,onOpen:Ne,onClose:ie,children:(0,t.jsxs)("div",{className:we.grid,children:[ge(),xe(),ve(),fe(),(0,t.jsx)(V.c,{htmlFor:"relative-time-input",tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,t.jsx)("code",{children:"now-5m"})," and ",(0,t.jsx)("code",{children:"5m"}),", or variables like"," ",(0,t.jsx)("code",{children:"$_relativeTime"}),"."]}),children:"Relative time"}),(0,t.jsx)(T.p,{id:"relative-time-input",type:"text",placeholder:"1h",onChange:$e,onBlur:Te,invalid:!be,value:ce}),(0,t.jsx)(V.c,{htmlFor:"time-shift-input",className:we.firstColumn,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,t.jsx)("code",{children:"now-1h"})," and ",(0,t.jsx)("code",{children:"1h"}),", or variables like ",(0,t.jsx)("code",{children:"$_timeShift"}),"."]}),children:"Time shift"}),(0,t.jsx)(T.p,{id:"time-shift-input",type:"text",placeholder:"1h",onChange:Fe,onBlur:Le,invalid:!Xe,value:he}),(he||ce)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.c,{htmlFor:"hide-time-info-switch",className:we.firstColumn,children:"Hide time info"}),(0,t.jsx)(z.K,{id:"hide-time-info-switch",className:we.left,value:de,onChange:Ge})]})]})})});H.displayName="QueryGroupOptionsEditor";function G(te){return!te||N.isValidTimeSpan(te)}function X(te){return te===""?null:te}function k(te){return{grid:(0,n.css)({display:"grid",gridTemplateColumns:"auto minmax(5em, 1fr) auto 1fr",gap:te.spacing(.5),gridAutoRows:te.spacing(4),whiteSpace:"nowrap"}),firstColumn:(0,n.css)({gridColumn:1}),collapsedText:(0,n.css)({marginLeft:te.spacing(2),fontSize:te.typography.size.sm,color:te.colors.text.secondary}),noSquish:(0,n.css)({display:"flex",alignItems:"center",padding:te.spacing(0,1),fontWeight:te.typography.fontWeightMedium,fontSize:te.typography.size.sm,backgroundColor:te.colors.background.secondary,borderRadius:te.shape.radius.default}),left:(0,n.css)({justifySelf:"left"}),operator:(0,n.css)({color:te.v1.palette.orange})}}class _ extends r.PureComponent{constructor(){super(...arguments),this.backendSrv=S.IB,this.dataSourceSrv=(0,u.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!g.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:a.Gu.NotStarted,series:[],timeRange:(0,i.E2)()}},this.onChangeDataSource=async(ae,re)=>{const{dsSettings:ne}=this.state,ce=ne?await(0,u.l)().get(ne.uid):void 0,le=await(0,u.l)().get(ae.uid),he=re||await(0,U.y)(le,ae.uid,this.state.queries,ce),oe=await this.dataSourceSrv.get(ae.name);this.onChange({queries:he,dataSource:{name:ae.name,uid:ae.uid,...(0,x.p$)(ae)}}),this.setState({queries:he,dataSource:oe,dsSettings:ae}),re&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:ae}=this.state;this.onQueriesChange((0,M.U7)(ae,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,M.U7)(this.state.queries,L.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=ae=>{this.props.onOptionsChange(ae),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=ae=>{const{dsSettings:re,queries:ne}=this.state;this.onQueriesChange((0,M.U7)(ne,ae,re?(0,x.p$)(re):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=ae=>{this.onChange({queries:ae}),this.setState({queries:ae})},this.setScrollRef=ae=>{this.setState({scrollElement:ae})}}async componentDidMount(){const{options:ae,queryRunner:re}=this.props;this.querySubscription=re.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:ne=>this.onPanelDataUpdate(ne)}),this.setNewQueriesAndDatasource(ae)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:ae}=this.props,re=await(0,u.l)().get(ae.dataSource);this.state.dataSource&&re.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(ae)}async setNewQueriesAndDatasource(ae){try{const re=await this.dataSourceSrv.get(ae.dataSource),ne=this.dataSourceSrv.getInstanceSettings(ae.dataSource),ce=await this.dataSourceSrv.get(),le=re.getRef(),he=ae.queries.map(oe=>({...(0,M.Ih)(oe)&&re?.getDefaultQuery?.(s.Jk.PanelEditor),datasource:le,...oe}));this.setState({queries:he,dataSource:re,dsSettings:ne,defaultDataSource:ce})}catch(re){console.error("failed to load data source",re)}}onPanelDataUpdate(ae){this.setState({data:ae})}newQuery(){const{dsSettings:ae,defaultDataSource:re}=this.state,ne=ae&&!ae.meta.mixed?(0,x.p$)(ae):re?re.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(s.Jk.PanelEditor),datasource:ne}}onChange(ae){this.props.onOptionsChange({...this.props.options,...ae})}renderTopSection(ae){const{onOpenQueryInspector:re,options:ne}=this.props,{dataSource:ce,data:le,dsSettings:he}=this.state;return!he||!ce?null:(0,t.jsx)(J,{data:le,dataSource:ce,options:ne,dsSettings:he,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:re})}renderQueries(ae){const{onRunQueries:re}=this.props,{data:ne,queries:ce}=this.state;return(0,t.jsx)("div",{"aria-label":d.Tp.components.QueryTab.content,children:(0,t.jsx)(A.L,{queries:ce,dsSettings:ae,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:re,data:ne})})}isExpressionsSupported(ae){return(ae.meta.alerting||ae.meta.mixed)===!0}renderExtraActions(){return W.m.getAllExtraRenderAction().map((ae,re)=>ae({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:re})).filter(Boolean)}renderAddQueryRow(ae,re){const ne=!(0,F.k)(ae.name);return(0,t.jsxs)(o.Gy,{spacing:"md",align:"flex-start",children:[ne&&(0,t.jsx)(E.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":d.Tp.components.QueryTab.addQuery,children:"Add query"}),b.Ay.expressionsEnabled&&this.isExpressionsSupported(ae)&&(0,t.jsx)(E.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:re.expressionButton,"data-testid":"query-tab-add-expression",children:(0,t.jsx)("span",{children:"Expression\xA0"})}),this.renderExtraActions()]})}render(){const{isHelpOpen:ae,dsSettings:re}=this.state,ne=ee();return(0,t.jsx)(m.P,{minHeight:"100%",ref:this.setScrollRef,children:(0,t.jsxs)("div",{className:ne.innerWrapper,children:[this.renderTopSection(ne),re&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:ne.queriesWrapper,children:this.renderQueries(re)}),this.renderAddQueryRow(re,ne),ae&&(0,t.jsx)(f.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp,children:(0,t.jsx)(P,{pluginId:re.meta.id})})]})]})})}}const ee=(0,p.N)(()=>{const{theme:te}=b.Ay;return{innerWrapper:(0,n.css)({display:"flex",flexDirection:"column",padding:te.spacing.md}),dataSourceRow:(0,n.css)({display:"flex",marginBottom:te.spacing.md}),dataSourceRowItem:(0,n.css)({marginRight:te.spacing.inlineFormMargin}),dataSourceRowItemOptions:(0,n.css)({flexGrow:1,marginRight:te.spacing.inlineFormMargin}),queriesWrapper:(0,n.css)({paddingBottom:"16px"}),expressionWrapper:(0,n.css)({}),expressionButton:(0,n.css)({marginRight:te.spacing.sm})}});function J({dataSource:te,options:ae,data:re,dsSettings:ne,onDataSourceChange:ce,onOptionsChange:le,onOpenQueryInspector:he}){const oe=ee(),[de,me]=(0,r.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{"data-testid":d.Tp.components.QueryTab.queryGroupTopSection,children:[(0,t.jsxs)("div",{className:oe.dataSourceRow,children:[(0,t.jsx)(h.I,{htmlFor:"data-source-picker",width:"auto",children:"Data source"}),(0,t.jsx)("div",{className:oe.dataSourceRowItem,children:(0,t.jsx)(Z,{options:ae,onChange:async(Pe,Ee)=>await ce?.(Pe,Ee),isDataSourceModalOpen:!!g.Ny.getSearchObject().firstPanel})}),te&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:oe.dataSourceRowItem,children:(0,t.jsx)(E.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>me(!0),"data-testid":"query-tab-help-button"})}),(0,t.jsx)("div",{className:oe.dataSourceRowItemOptions,children:(0,t.jsx)(H,{options:ae,dataSource:te,data:re,onChange:Pe=>{le?.(Pe)}})}),he&&(0,t.jsx)("div",{className:oe.dataSourceRowItem,children:(0,t.jsx)(E.$n,{variant:"secondary",onClick:he,"aria-label":d.Tp.components.QueryTab.queryInspectorButton,children:"Query inspector"})})]})]}),te&&(0,I.Hv)(te.uid)&&(0,t.jsx)(B.c,{pluginId:te.type,pluginType:c.QE.datasource,angularSupportEnabled:b.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})]}),de&&(0,t.jsx)(f.a,{title:"Data source help",isOpen:!0,onDismiss:()=>me(!1),children:(0,t.jsx)(P,{pluginId:ne.meta.id})})]})}function Z({options:te,onChange:ae,...re}){const[ne,ce]=(0,r.useState)(!!re.isDataSourceModalOpen);(0,r.useEffect)(()=>{g.Ny.getSearchObject().firstPanel&&g.Ny.partial({firstPanel:null},!0)},[]);const le={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:te.dataSource,uploadFile:!0,onChange:async(he,oe)=>{await ae(he,oe),ce(!1)}};return(0,t.jsxs)(t.Fragment,{children:[ne&&(0,t.jsx)(O.p,{...le,onDismiss:()=>ce(!1)}),(0,t.jsx)(R.s,{...le})]})}},85754:(q,j,e)=>{"use strict";e.d(j,{nm:()=>ae,Dh:()=>J});var t=e(39741),n=e(13752),r=e(64423),a=e(44240),i=e(39697),x=e(81160),s=e(67791),c=e(93031),d=e(71030),u=e(69850),g=e(1005),o=e(65961),E=e(86833),m=e(2543);function f(re){let ne=[];const ce=(0,m.partition)(re,"id"),le=(0,m.groupBy)(ce[0],"id");return ne=(0,m.map)(le,he=>he.length>1&&!(0,m.every)(he,p)?(0,m.find)(he,oe=>oe.eventType!=="panel-alert"):(0,m.head)(he)),ne=(0,m.concat)(ne,ce[1]),ne}function p(re){return re.eventType==="panel-alert"}var h=e(80757),D=e(62467),C=e(65474),l=e(66847),v=e(69862),y=e(16126),P=e(32370),b=e(98437),S=e(76019),M=e(91830),O=e(71184),R=e(95362);class L{canRun(ne){return ne?!!(!ne.annotationQuery||ne.annotations):!1}run({annotation:ne,datasource:ce,dashboard:le,range:he}){if(!this.canRun(ce))return(0,D.of)([]);const oe={};return(0,O.b)({dashboard:le,range:he,panel:oe},ce,ne).pipe((0,x.T)(de=>de.events??[]),(0,l.W)(R.SD))}}var B=e(89107);class F{canRun(ne){return ne?(0,B.E7)(ne)?!0:!!(ne.annotationQuery&&!ne.annotations):!1}run({annotation:ne,datasource:ce,dashboard:le,range:he}){return this.canRun(ce)?(0,C.H)(ce.annotationQuery({range:he,rangeRaw:he.raw,annotation:ne,dashboard:le})).pipe((0,l.W)(R.SD)):(0,D.of)([])}}class I{constructor(ne=[new F,new L]){this.runners=ne}canWork({dashboard:ne}){return!!ne.annotations.list.find(I.getAnnotationsToProcessFilter)}work(ne){if(!this.canWork(ne))return(0,R.$)();const{dashboard:ce,range:le}=ne;let he=ce.annotations.list.filter(I.getAnnotationsToProcessFilter);P.$.publicDashboardAccessToken&&he.length>0&&(he=[he[0]]);const oe=he.map(de=>{let me;if(P.$.publicDashboardAccessToken){const Pe=new S.X;me=(0,D.of)(Pe).pipe((0,l.W)(R.H0))}else me=(0,C.H)((0,b.l)().get(de.datasource)).pipe((0,l.W)(R.H0));return me.pipe((0,v.Z)(Pe=>{const Ee=this.runners.find(be=>be.canRun(Pe));return Ee?(ce.events.publish(new M.xc(de)),Ee.run({annotation:de,datasource:Pe,dashboard:ce,range:le}).pipe((0,s.Q)(J().cancellations().pipe((0,y.p)(be=>be===de))),(0,x.T)(be=>(ce.snapshot&&(de.snapshotData=(0,m.cloneDeep)(be)),P.$.publicDashboardAccessToken?be:(0,R.G9)(de,be))),(0,u.j)(()=>{ce.events.publish(new M.yj(de))}))):(0,D.of)([])}))});return(0,a.h)(oe).pipe((0,c.U)(),(0,d.T)((de,me)=>de.concat(me)),(0,x.T)(de=>({annotations:de,alertStates:[]})))}static getAnnotationsToProcessFilter(ne){return ne.enable&&!ne.snapshotData}}var U=e(58109),W=e(91323),A=e(61351),N=e(5240),K=e(76204),V=e(83466),T=e(88214),z=e(82700),w=e(82991),H=e(83394),G=e(61491);class X{constructor(){this.hasAlertRules={}}canWork({dashboard:ne,range:ce}){return!(!ne.uid||P.$.publicDashboardAccessToken||ce.raw.to!=="now"||this.hasAlertRules[ne.uid]===!1||!(A.TP.hasPermission(G.AccessControlAction.AlertingRuleRead)&&A.TP.hasPermission(G.AccessControlAction.AlertingRuleExternalRead)))}work(ne){if(!this.canWork(ne))return(0,R.$)();const{dashboard:ce}=ne,le=async()=>(await(0,H.JD)(N.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:T.hY,dashboardUid:ce.uid},{forceRefetch:!0}))).data;return(0,C.H)(le()).pipe((0,x.T)(oe=>(0,K.Kw)(oe))).pipe((0,x.T)(oe=>{this.hasAlertRules[ce.uid]=!1;const de={};return oe.forEach(me=>me.rules.forEach(Pe=>{if((0,z.Z8)(Pe)&&Pe.annotations&&Pe.annotations[V.YH.panelID]){this.hasAlertRules[ce.uid]=!0;const Ee=Number(Pe.annotations[V.YH.panelID]),be=(0,w.S)(Pe.state);de[Ee]?be===W.O.Alerting&&de[Ee].state!==W.O.Alerting?de[Ee].state=W.O.Alerting:be===W.O.Pending&&de[Ee].state!==W.O.Alerting&&de[Ee].state!==W.O.Pending&&(de[Ee].state=W.O.Pending):de[Ee]={state:be,id:Object.keys(de).length,panelId:Ee,dashboardId:ce.id}}})),{alertStates:Object.values(de),annotations:[]}}),(0,l.W)(R.Zr))}}class k{constructor(ne,ce=(0,h.jG)(),le=[new X,new U.F,new I]){this.dashboard=ne,this.timeSrv=ce,this.workers=le,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new t.m(1),this.runs=new n.B,this.cancellationStream=new n.B,this.runsSubscription=this.runs.subscribe(he=>this.executeRun(he)),this.eventsSubscription=ne.events.subscribe(E._,he=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(ne){this.runs.next(ne)}getResult(ne){return this.results.asObservable().pipe((0,x.T)(ce=>{const le=(0,R.FK)(ce.annotations,ne),he=ce.alertStates.find(oe=>!!ne&&oe.panelId===ne);return{annotations:f(le),alertState:he}}))}executeRun(ne){const le=this.workers.filter(Pe=>Pe.canWork(ne)).map(Pe=>Pe.work(ne)),he=new r.yU,oe=(0,a.h)(le).pipe((0,s.Q)(this.runs.asObservable()),(0,c.U)(),(0,d.T)((Pe,Ee)=>(Pe.annotations=Pe.annotations.concat(Ee.annotations),Pe.alertStates=Pe.alertStates.concat(Ee.alertStates),Pe)),(0,u.j)(()=>{he.unsubscribe()}),(0,g.u)()),de=new r.yU,me=(0,i.O)(200).pipe((0,o.u)({annotations:[],alertStates:[]}),(0,s.Q)(oe),(0,u.j)(()=>{de.unsubscribe()}));de.add(me.subscribe(Pe=>{this.results.next(Pe)})),he.add(oe.subscribe(Pe=>{this.results.next(Pe)}))}cancel(ne){this.cancellationStream.next(ne)}cancellations(){return this.cancellationStream.asObservable().pipe((0,g.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let _;function ee(re){_&&_.destroy(),_=re}function J(){if(!_)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return _}let Z;function te(re){Z=re}function ae(re){Z||(Z=({dashboard:ce,timeSrv:le,workers:he})=>new k(ce,le,he));const ne=Z(re);return ee(ne),ne}},76019:(q,j,e)=>{"use strict";e.d(j,{X:()=>u});var t=e(62467),n=e(65474),r=e(29997),a=e(4038),i=e(28082),x=e(32370),s=e(88214),c=e(92980);const d="-- Public --";class u extends r.mA{constructor(){let o={};super({name:"public-ds",id:0,type:"public-ds",meta:o,uid:d,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(E){return{...E,queryType:c.nj.Annotations,refId:"anno"}}}}query(o){return o.targets.length?o.targets[0]?.datasource?.uid===s.vv?(0,n.H)(this.getAnnotations(o)):(0,t.of)({data:[]}):(0,t.of)({data:[]})}async getAnnotations(o){const{range:{to:E,from:m}}=o,f={from:m.valueOf(),to:E.valueOf()},p=await(0,i.AI)().get(`/api/public/dashboards/${x.$.publicDashboardAccessToken}/annotations`,f);return{data:[(0,a.Vc)(p)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},58109:(q,j,e)=>{"use strict";e.d(j,{F:()=>r});var t=e(62467),n=e(95362);class r{canWork({dashboard:i}){return i?.annotations?.list?.some(x=>x.enable&&!!x.snapshotData)}work(i){if(!this.canWork(i))return(0,n.$)();const x=this.getAnnotationsFromSnapshot(i.dashboard);return(0,t.of)({annotations:x,alertStates:[]})}getAnnotationsFromSnapshot(i){return(i?.annotations?.list?.filter(d=>d.enable)).filter(d=>!!d.snapshotData).reduce((d,u)=>d.concat((0,n.G9)(u,u.snapshotData)),[])}getAnnotationsInSnapshot(i,x){const s=this.getAnnotationsFromSnapshot(i);return(0,n.FK)(s,x)}}},95362:(q,j,e)=>{"use strict";e.d(j,{$:()=>o,FK:()=>f,G9:()=>p,H:()=>h,H0:()=>g,SD:()=>u,Zr:()=>E});var t=e(2543),n=e.n(t),r=e(62467),a=e(94626),i=e(64121),x=e(32370),s=e(83394),c=e(17687),d=e(80847);function u(D){return D.cancelled?(0,r.of)([]):(m("AnnotationQueryRunner failed",D),(0,r.of)([]))}function g(D){return m("Failed to retrieve datasource",D),(0,r.of)(void 0)}const o=()=>(0,r.of)({annotations:[],alertStates:[]});function E(D){return D.cancelled||m("DashboardQueryRunner failed",D),o()}function m(D,C){const l=(0,i.u)(C);console.error("handleAnnotationQueryRunnerError",l);const v=(0,c.gi)(D,l.message);(0,s.JD)((0,d.dx)(v))}function f(D,C){return C==null?D:D.filter(l=>{let v;if(v=l.source,!v)return!0;if(v.filter){const y=(v.filter.ids??[]).includes(C);if(v.filter.exclude){if(y)return!1}else if(!y)return!1}return l.panelId&&l.source.type==="dashboard"?l.panelId===C:!0})}function p(D,C){D.snapshotData&&(D=(0,t.cloneDeep)(D),delete D.snapshotData);for(const l of C)switch(l.source=D,l.color=x.$.theme2.visualization.getColorByName(D.iconColor),l.type=D.name,l.isRegion=!!(l.timeEnd&&l.time!==l.timeEnd),l.newState?.toLowerCase()){case"pending":l.color="yellow";break;case"alerting":l.color="red";break;case"ok":l.color="green";break;case"normal":l.color="green";break;case"no_data":l.color="gray";break;case"nodata":l.color="gray";break}return C}function h(D){if(!D||!D.length)return[];const C=[];for(const l of D){const v=new a.R(l);for(let y=0;y<l.length;y++){const P=(0,t.cloneDeep)(v.get(y));C.push(P)}}return C}},16442:(q,j,e)=>{"use strict";e.d(j,{Z:()=>B,S:()=>L});var t=e(2543),n=e(39741),r=e(62467),a=e(69862),i=e(81160),x=e(66847),s=e(8392),c=e(4038),d=e(55801),u=e(47286),g=e(2049),o=e(7500),E=e(54092),m=e(16753),f=e(59577),p=e(64121),h=e(65502),D=e(25324),C=e(10059),l=e(84395),v=e(52488),y=e(85754),P=e(49510),b=e(75906);function S(I=[]){I.forEach(U=>{U.meta={...U.meta,dataTopic:o.QR.Annotations}})}function M(I,U){return(0,P.z)([I,U]).pipe((0,a.Z)(W=>{const[A,N]=W;if(N.annotations?.length||N.alertState){A.annotations||(A.annotations=[]);const K=A.annotations.concat((0,b.I)(N.annotations));S(K);const V=N.alertState;return(0,r.of)({...A,annotations:K,alertState:V})}return S(A.annotations),(0,r.of)(A)}))}var O=e(23234);let R=100;function L(){return"Q"+R++}class B{constructor(U){this.templateSrv=(0,l.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new n.m(1),this.dataConfigSource=U}getData(U){const{withFieldConfig:W,withTransforms:A}=U;let N=1,K,V=[],T=[],z,w=!0,H=-1;if(this.dataConfigSource.snapshotData){const G={state:s.Gu.Done,series:this.dataConfigSource.snapshotData.map(X=>(0,c.Vc)(X)),timeRange:(0,d.E2)(),structureRev:N};return(0,r.of)(G)}return this.subject.pipe((0,a.Z)(G=>{let X=this.dataConfigSource.getFieldOverrideOptions(),k=this.dataConfigSource.getTransformations();if(G.series===T&&K?.fieldConfig===X?.fieldConfig&&z===k)return(0,r.of)({...G,structureRev:N,series:V});K=X,z=k,T=G.series;let _=(0,r.of)(G);return A&&(_=this.applyTransformations(G)),_.pipe((0,i.T)(ee=>{let J=ee,Z=!1;if(W&&ee.series?.length){if(H===this.dataConfigSource.configRev){let te;for(const ae of ee.series)if((0,D.o$)(ae)){te=ae;break}te&&!te.packetInfo.schemaChanged&&V[0].fields.length===te.fields.length&&(J={...J,series:V.map((ae,re)=>({...ae,length:ee.series[re].length,fields:ae.fields.map((ne,ce)=>({...ne,values:ee.series[re].fields[ce].values,state:{...ne.state,calcs:void 0,range:void 0}}))}))},Z=!0)}X!=null&&(w||!Z)&&(H=this.dataConfigSource.configRev,J={...J,series:(0,u.we)({timeZone:ee.request?.timezone??"browser",data:J.series,...X})},J.annotations&&(J.annotations=(0,u.we)({data:J.annotations,...X,fieldConfig:{defaults:{},overrides:[]}})),w=!1)}return!Z&&!(0,g.J3)(V,J.series,g.bW)&&N++,V=J.series,{...J,structureRev:N}}))}))}applyTransformations(U){const W=this.dataConfigSource.getTransformations();if(W&&W.every(w=>w.disabled)||!W||W.length===0)return(0,r.of)(U);const N={interpolate:w=>this.templateSrv.replace(w,U?.request?.scopedVars)};let K=W.filter(w=>w.topic==null||w.topic===o.QR.Series),V=W.filter(w=>w.topic===o.QR.Annotations),T=(0,E.m)(K,U.series,N),z=(0,E.m)(V,U.annotations??[],N);return(0,t.merge)(T,z).pipe((0,i.T)(w=>{let G=w.some(X=>X.meta?.dataTopic===o.QR.Annotations)?{annotations:w}:{series:w};return{...U,...G}}),(0,x.W)(w=>(console.warn("Error running transformation:",w),(0,r.of)({...U,state:s.Gu.Error,errors:[(0,p.u)(w)]}))))}async run(U){const{queries:W,timezone:A,datasource:N,panelId:K,panelName:V,panelPluginId:T,dashboardUID:z,timeRange:w,timeInfo:H,cacheTimeout:G,queryCachingTTL:X,maxDataPoints:k,scopedVars:_,minInterval:ee,app:J}=U;if((0,v.k)(N)){this.pipeToSubject((0,v.m)(U,W[0]),K,!0);return}const Z=this.shouldAddErrorWhenDatasourceVariableIsMultiple(N,_),te={app:J??m.Jk.Dashboard,requestId:L(),timezone:A,panelId:K,panelName:V,panelPluginId:T,dashboardUID:z,range:w,timeInfo:H,interval:"",intervalMs:0,targets:(0,t.cloneDeep)(W),maxDataPoints:k,scopedVars:_||{},cacheTimeout:G,queryCachingTTL:X,startTime:Date.now(),rangeRaw:w.raw};try{const ae=await F(N,te.scopedVars),re=ae.meta?.mixed;te.targets=te.targets.map(le=>{const he=le.datasource?.type===h.dR.type;return(!le.datasource||le.datasource.uid!==ae.uid&&!re&&!he)&&(le.datasource=ae.getRef()),le});const ne=ee?this.templateSrv.replace(ee,te.scopedVars):ae.interval,ce=f.calculateInterval(w,k,ne);te.scopedVars=Object.assign({},te.scopedVars,{__interval:{text:ce.interval,value:ce.interval},__interval_ms:{text:ce.intervalMs.toString(),value:ce.intervalMs}}),te.interval=ce.interval,te.intervalMs=ce.intervalMs,te.filters=this.templateSrv.getAdhocFilters(ae.name,!0),te.panelId=K,te.panelName=V,this.lastRequest=te,this.pipeToSubject((0,O.BN)(ae,te),K,!1,Z)}catch(ae){this.pipeToSubject((0,r.of)({state:s.Gu.Error,error:(0,p.u)(ae),series:[],timeRange:te.range}),K)}}pipeToSubject(U,W,A=!1,N=!1){this.subscription&&this.subscription.unsubscribe();let K=U;const V=this.dataConfigSource.getDataSupport();if(V.alertStates||V.annotations){const T=this.dataConfigSource;K=M(U,(0,y.Dh)().getResult(T.id))}this.subscription=K.subscribe({next:T=>{const z=this.lastResult,w=A?T:(0,c.N$)(T,z);if(z!=null&&w.state!==s.Gu.Streaming){let H=(0,g.J3)(z.series??[],w.series??[],(_,ee)=>_===ee),G=(0,g.J3)(z.annotations??[],w.annotations??[],(_,ee)=>_===ee),X=z.state===w.state,k=(0,g.J3)(z.errors??[],w.errors??[],(_,ee)=>(0,t.isEqual)(_,ee));if(H&&(w.series=z.series),G&&(w.annotations=z.annotations),H&&G&&X&&k)return}this.lastResult=w,N&&(w.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],w.state=s.Gu.Error),this.subject.next(w)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===s.Gu.Loading||this.lastResult.state===s.Gu.Streaming)&&this.subject.next({...this.lastResult,state:s.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new n.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(U){this.lastResult=U.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(U){this.lastResult=U}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(U,W){let A=!1;return U?.uid?.startsWith("${")&&this.templateSrv.replace(U.uid,W,N=>(Array.isArray(N)&&N.length>1&&(A=!0),"")),A}}async function F(I,U){return I&&typeof I=="object"&&"query"in I?I:await(0,C.tR)().get(I,U)}},64061:(q,j,e)=>{"use strict";e.d(j,{N:()=>n});var t=e(69850);function n(r,a){return(0,t.j)(()=>{a&&r.resolveCancelerIfExists(a)})}},29341:(q,j,e)=>{"use strict";e.d(j,{B:()=>n});var t=e(2049);const n=(r,a)=>{let i=1;return a?.structureRev&&a.series&&(i=a.structureRev,(0,t.J3)(r.series,a.series,t.bW)||i++),r.structureRev=i,r}},23234:(q,j,e)=>{"use strict";e.d(j,{BN:()=>A});var t=e(2543),n=e(62467),r=e(44240),a=e(39697),i=e(65474),x=e(81160),s=e(66847),c=e(59099),d=e(1005),u=e(65961),g=e(67791),o=e(69862),E=e(8392),m=e(7500),f=e(30468),p=e(16753),h=e(64121),D=e(9174),C=e(32370),l=e(65502),v=e(75911),y=e(27315),P=e(21475),b=e(18729);const S=(0,b.DW)("features.query");var M=e(64061),O=e(93407),R=e(22136),L=e(56276),B=e(16910);function F(V){let T=!1;return w=>{if(!w.request||T||O.kM.getUrlSearchParams().editPanel!=null||w.state!==E.Gu.Done&&w.state!==E.Gu.Error)return;const G={eventName:R.n_.DataRequest,source:w.request.app,datasourceName:V.name,datasourceId:V.id,datasourceUid:V.uid,datasourceType:V.type,dataSize:0,panelId:0,panelPluginId:w.request?.panelPluginId,duration:w.request.endTime-w.request.startTime,...w?.request?.panelId&&Number.isInteger(w.request.panelId)&&{panelId:w.request.panelId},...w?.request?.panelName&&{panelName:w.request.panelName}};z(G,w),w.request.app!==p.Jk.Explore&&w.request.app!==p.Jk.Correlations&&I(G,w),w.series&&w.series.length>0&&(G.dataSize=w.series.length),(0,L.G$)(G),T=!0};function z(w,H){const G={};for(let k=0;k<H.series.length;k++){const _=H.series[k].refId;_&&!G[_]&&(G[_]=H.series[k].meta?.isCachedResponse??!1)}w.totalQueries=Object.keys(G).length,w.cachedQueries=Object.values(G).filter(k=>k===!0).length;const X=(0,B.UA)().getCurrent();X&&(w.dashboardId=X.id,w.dashboardName=X.title,w.dashboardUid=X.uid,w.folderName=X.meta.folderTitle)}}function I(V,T){T.errors?.length?V.error=T.errors.map(z=>z.message).join(", "):T.error&&(V.error=T.error.message)}function U(V,T){const z=T.panelData.request,w={...T.packets},H=V.key??V.data?.[0]?.refId??"A";w[H]=V;let G=V.state||E.Gu.Done,X,k;const _=[],ee=[];for(const ae in w){const re=w[ae];if((re.error||re.errors?.length)&&(G=E.Gu.Error,X=re.error,k=re.errors),re.data&&re.data.length)for(const ne of re.data){if(ne.meta?.dataTopic===m.QR.Annotations){ee.push(ne);continue}_.push(ne)}}const J=W(z,G),Z={state:G,series:_,annotations:ee,error:X,errors:k,request:z,timeRange:J},te=new Set([...T.panelData.traceIds??[],...V.traceIds??[]]);return te.size>0&&(Z.traceIds=Array.from(te)),{packets:w,panelData:Z}}function W(V,T){const z=V.range;return!(0,t.isString)(z.raw.from)||T!==E.Gu.Streaming?z:{...z,from:f.parse(z.raw.from,!1),to:f.parse(z.raw.to,!0)}}function A(V,T,z){let w={panelData:{state:E.Gu.Loading,series:[],request:T,timeRange:T.range},packets:{}};if(!T.targets.length)return T.endTime=Date.now(),w.panelData.state=E.Gu.Done,(0,n.of)(w.panelData);const H=N(V,T,z).pipe((0,x.T)(G=>{if(!(0,t.map)(G.data))throw new Error(`Expected response data to be array, got ${typeof G.data}.`);const X=T.targets.filter(k=>k.hide);for(const k of X)G.data=G.data.filter(_=>_.refId!==k.refId);return T.endTime=Date.now(),w=U(G,w),w.panelData}),(0,s.W)(G=>(console.error("runRequest.catchError",G),S.logError(G),(0,n.of)({...w.panelData,state:E.Gu.Error,error:(0,h.u)(G)}))),(0,c.M)(F(V)),(0,M.N)(v.IB,T.requestId),(0,d.u)());return(0,r.h)((0,a.O)(200).pipe((0,u.u)(w.panelData),(0,g.Q)(H)),H)}function N(V,T,z){if((0,D.LZ)(V)){const w=(0,D.xt)(V,T);return(0,i.H)(w).pipe((0,o.Z)(H=>K(V,H,z)))}return K(V,T,z)}function K(V,T,z){if(T.targets=T.targets.map(H=>(0,y.Ih)(H)?{...V?.getDefaultQuery?.(p.Jk.PanelEditor),...H}:H),C.$.publicDashboardAccessToken)return(0,i.H)(V.query(T));for(const H of T.targets)if((0,l.s9)(H.datasource))return P.Ex.query(T);if(z||(T.targets=T.targets.filter(H=>V.filterQuery?.(H)??!0)),T.targets.length===0)return(0,n.of)({data:[]});const w=z?z(T):V.query(T);return(0,i.H)(w)}},11147:(q,j,e)=>{"use strict";e.d(j,{y:()=>x});var t=e(16753),n=e(58462),r=e(44099),a=e(39736),i=e(65502);async function x(s,c,d,u){let g=d;const o={...s.getRef(),uid:c},E={...s?.getDefaultQuery?.(t.Jk.PanelEditor),datasource:o,refId:"A"};if(u?.meta.id!==s.meta.id){if(s.meta.mixed)return d;if((0,n.Ee)(u)&&(0,n.FL)(s)){const m=await u.exportToAbstractQueries(d);g=await s.importFromAbstractQueries(m)}else if(u&&s.importQueries)g=await s.importQueries(d,u);else{if(u){const m=(0,a.w)(),f=[];let p=s.uid;const h=m.containsTemplate(c);h&&(p=m.replace(s.uid));const D=d.reduce((C,l)=>{if(l.datasource){let v=l.datasource.uid;const y=m.containsTemplate(v);if(y&&(v=m.replace(l.datasource.uid)),v===p&&y===h)return l.refId=(0,r.M)(C),C.concat([l])}return C},f);if(D.length>0)return D}return[E]}}return g.length===0?[E]:g.map(m=>(!(0,i.s9)(m.datasource)&&!s.meta.mixed&&(m.datasource=o),m))}},81635:(q,j,e)=>{"use strict";e.d(j,{T3:()=>Ve,mN:()=>Re,Dh:()=>at,DF:()=>tt,f_:()=>ke,sq:()=>je,fX:()=>yt});var t=e(32370),n=e(74848),r=e(22803),a=e(2543),i=e(65474),x=e(69850),s=e(61034),c=e(29675),d=e(81876),u=e(99134),g=e(54594),o=e(11817),E=e(35557),m=e(93407),f=e(79784),p=e(65539);function h({dashboard:ze}){const st=(0,c.of)(D),[ht]=(0,p.s)();return(0,n.jsxs)(E.Link,{to:m.kM.renderUrl(`/d/${ze.dashboard}/`,ht),className:st.container,"data-testid":`scopes-dashboards-${ze.dashboard}`,role:"treeitem",children:[(0,n.jsx)(f.I,{name:"apps",className:st.icon})," ",ze.dashboardTitle]},ze.dashboard)}const D=ze=>({container:(0,r.css)({display:"flex",alignItems:"flex-start",gap:ze.spacing(1),padding:ze.spacing(.5,0),textAlign:"left",wordBreak:"break-word","&:last-child":(0,r.css)({paddingBottom:0})}),icon:(0,r.css)({marginTop:ze.spacing(.25)})});function C({folder:ze,folderPath:st,folders:ht,onFolderUpdate:It}){const Gt=(0,c.of)(l);return(0,n.jsxs)("div",{className:Gt.container,role:"treeitem","aria-selected":ze.isExpanded,children:[(0,n.jsxs)("button",{className:Gt.expand,"data-testid":`scopes-dashboards-${ze.title}-expand`,"aria-label":ze.isExpanded?(0,o.t)("scopes.dashboards.collapse","Collapse"):(0,o.t)("scopes.dashboards.expand","Expand"),onClick:()=>{It(st,!ze.isExpanded)},children:[(0,n.jsx)(f.I,{name:ze.isExpanded?"angle-down":"angle-right",className:Gt.icon}),ze.title]}),ze.isExpanded&&(0,n.jsx)("div",{className:Gt.children,children:(0,n.jsx)(v,{folders:ht,folderPath:st,onFolderUpdate:It})})]})}const l=ze=>({container:(0,r.css)({display:"flex",flexDirection:"column",padding:ze.spacing(.5,0)}),expand:(0,r.css)({alignItems:"flex-start",background:"none",border:0,display:"flex",gap:ze.spacing(1),margin:0,padding:0,textAlign:"left",wordBreak:"break-word"}),icon:(0,r.css)({marginTop:ze.spacing(.25)}),children:(0,r.css)({paddingLeft:ze.spacing(4)})});function v({folders:ze,folderPath:st,onFolderUpdate:ht}){const It=st[st.length-1],Gt=ze[It];return(0,n.jsxs)("div",{role:"tree",children:[Object.entries(Gt.folders).map(([un,vn])=>(0,n.jsx)(C,{folder:vn,folders:Gt.folders,folderPath:[...st,un],onFolderUpdate:ht},un)),Object.values(Gt.dashboards).map(un=>(0,n.jsx)(h,{dashboard:un},un.dashboard))]})}var y=e(96540),P=e(40996),b=e(22560);function S({disabled:ze,query:st,onChange:ht}){const It=(0,c.of)(M),[Gt,un]=(0,y.useState)({value:st,isDirty:!1}),[vn]=(0,P.A)(()=>{Gt.isDirty&&ht(Gt.value)},500,[Gt.isDirty,Gt.value]);return(0,y.useEffect)(()=>{(vn()||!Gt.isDirty)&&Gt.value!==st&&un({value:st,isDirty:!1})},[vn,Gt,st]),(0,n.jsx)("div",{className:It.container,children:(0,n.jsx)(b.Z,{disabled:ze,placeholder:(0,o.t)("scopes.dashboards.search","Search"),value:Gt.value,"data-testid":"scopes-dashboards-search",onChange:pn=>un({value:pn,isDirty:!0})})})}const M=ze=>({container:(0,r.css)({flex:"0 1 auto"})});var O=e(28082),R=e(72458),L=e(77855),B=(ze=>(ze[ze.Persisted=0]="Persisted",ze[ze.Result=1]="Result",ze))(B||{});function F(ze){return{metadata:{name:ze},spec:{filters:[],title:ze,type:"",category:"",description:""}}}function I(ze,st){return{...ze,metadata:{...ze.metadata,...st.metadata},spec:{...ze.spec,...st.spec}}}function U(ze){return ze.map(({scope:st,path:ht})=>({scopeName:st.metadata.name,path:ht}))}function W(ze){return ze.map(({scope:st})=>st)}function A(ze){return ze.map(({scope:st})=>st.metadata.name)}function N(ze,st,ht,It){const Gt=Object.values(It),vn=st.filter(({path:cn})=>cn.length===0).map(({scopeName:cn})=>cn).reduce((cn,jn)=>{const _n=Gt.find(Ot=>Ot.isSelectable&&Ot.linkId===jn);return _n&&(cn[jn]=[...ht,_n.name]),cn},{}),pn=ze.map(cn=>cn.path.length>0?cn:{...cn,path:vn[cn.scope.metadata.name]??[]}),xn=st.map(cn=>cn.path.length>0?cn:{...cn,path:vn[cn.scopeName]??[]});return[pn,xn]}function K(ze){return ze.reduce((st,ht)=>{const It=st[""],Gt=ht.status.groups??[];return Gt.forEach(vn=>{vn&&!It.folders[vn]&&(It.folders[vn]={title:vn,isExpanded:!1,folders:{},dashboards:{}})}),(Gt.length>0?Gt.map(vn=>vn===""?It.dashboards:It.folders[vn].dashboards):[It.dashboards]).forEach(vn=>{vn[ht.spec.dashboard]||(vn[ht.spec.dashboard]={dashboard:ht.spec.dashboard,dashboardTitle:ht.status.dashboardTitle,items:[]}),vn[ht.spec.dashboard].items.push(ht)}),st},{"":{title:"",isExpanded:!0,folders:{},dashboards:{}}})}function V(ze,st){return st=(st??"").toLowerCase(),Object.entries(ze).reduce((ht,[It,Gt])=>{if(Gt.title.toLowerCase().includes(st))return ht[It]={...Gt,isExpanded:!0},ht;const un=V(Gt.folders,st),vn=Object.entries(Gt.dashboards).filter(([pn,xn])=>xn.dashboardTitle.toLowerCase().includes(st));return(Object.keys(un).length>0||vn.length>0)&&(ht[It]={...Gt,isExpanded:!0,folders:un,dashboards:Object.fromEntries(vn)}),ht},{})}const T="scope.grafana.app",z="v0alpha1",w=(0,L.G)(),H=`/apis/${T}/${z}/namespaces/${w}/find/scope_node_children`,G=`/apis/${T}/${z}/namespaces/${w}/find/scope_dashboard_bindings`,X=new R.ws({group:T,version:z,resource:"scopes"}),k=new Map;async function _(ze,st){try{return(await(0,O.AI)().get(H,{parent:ze,query:st}))?.items??[]}catch{return[]}}async function ee(ze,st){return(await _(ze,st)).reduce((ht,{metadata:{name:It},spec:Gt})=>(ht[It]={name:It,...Gt,isExpandable:Gt.nodeType==="container",isSelectable:Gt.linkType==="scope",isExpanded:!1,query:"",reason:B.Result,nodes:{}},ht),{})}async function J(ze){if(k.has(ze))return k.get(ze);const st=new Promise(async ht=>{const It=F(ze);try{const Gt=await X.get(ze),un=I(It,Gt);ht(un)}catch{k.delete(ze),ht(It)}});return k.set(ze,st),st}async function Z(ze){return await Promise.all(ze.map(J))}async function te(ze){return(await Z(ze.map(({scopeName:ht})=>ht))).reduce((ht,It,Gt)=>(ht.push({scope:It,path:ze[Gt].path}),ht),[])}async function ae(ze){try{return(await(0,O.AI)().get(G,{scope:ze}))?.items??[]}catch{return[]}}const re=()=>({dashboards:[],folders:{},filteredFolders:{},forScopeNames:[],isLoading:!1,isPanelOpened:!1,isEnabled:!1,isReadOnly:!1,searchQuery:""});class ne extends s.Bs{static{this.Component=ce}constructor(){super({selector:null,...re()}),this.addActivationHandler(()=>()=>{this.dashboardsFetchingSub?.unsubscribe()})}async fetchDashboards(st){if(!(0,a.isEqual)(this.state.forScopeNames,st)){if(this.dashboardsFetchingSub?.unsubscribe(),this.setState({forScopeNames:st}),st.length===0)return this.setState({dashboards:[],folders:{},filteredFolders:{},forScopeNames:[],isLoading:!1,isPanelOpened:!1});this.setState({isLoading:!0}),this.dashboardsFetchingSub=(0,i.H)(ae(st)).pipe((0,x.j)(()=>{this.setState({isLoading:!1})})).subscribe(ht=>{const It=K(ht),Gt=V(It,this.state.searchQuery);this.setState({dashboards:ht,folders:It,filteredFolders:Gt,isLoading:!1,isPanelOpened:st.length>0}),this.dashboardsFetchingSub?.unsubscribe()})}}changeSearchQuery(st){st=st??"",this.setState({filteredFolders:V(this.state.folders,st),searchQuery:st})}updateFolder(st,ht){let It={...this.state.folders},Gt={...this.state.filteredFolders},un=It,vn=Gt;for(let jn=0;jn<st.length-1;jn++)un=un[st[jn]].folders,vn=vn[st[jn]].folders;const pn=st[st.length-1],xn=un[pn],cn=vn[pn];xn.isExpanded=ht,cn.isExpanded=ht,this.setState({folders:It,filteredFolders:Gt})}togglePanel(){this.state.isPanelOpened?this.closePanel():this.openPanel()}openPanel(){this.state.isPanelOpened||this.setState({isPanelOpened:!0})}closePanel(){this.state.isPanelOpened&&this.setState({isPanelOpened:!1})}enable(){this.setState({isEnabled:!0})}disable(){this.setState({isEnabled:!1})}enterReadOnly(){this.setState({isReadOnly:!0})}exitReadOnly(){this.setState({isReadOnly:!1})}}function ce({model:ze}){const{dashboards:st,filteredFolders:ht,forScopeNames:It,isLoading:Gt,isPanelOpened:un,isEnabled:vn,isReadOnly:pn,searchQuery:xn}=ze.useState(),cn=(0,c.of)(le);if(!vn||!un||pn)return null;if(!Gt){if(It.length===0)return(0,n.jsx)("div",{className:(0,r.cx)(cn.container,cn.noResultsContainer),"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,n.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsNoScopes",children:"No scopes selected"})});if(st.length===0)return(0,n.jsx)("div",{className:(0,r.cx)(cn.container,cn.noResultsContainer),"data-testid":"scopes-dashboards-notFoundForScope",children:(0,n.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsForScopes",children:"No dashboards found for the selected scopes"})})}return(0,n.jsxs)("div",{className:cn.container,"data-testid":"scopes-dashboards-container",children:[(0,n.jsx)(S,{disabled:Gt,query:xn,onChange:jn=>ze.changeSearchQuery(jn)}),Gt?(0,n.jsx)(d._,{className:cn.loadingIndicator,text:(0,o.t)("scopes.dashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):ht[""]?(0,n.jsx)(u.P,{children:(0,n.jsx)(v,{folders:ht,folderPath:[""],onFolderUpdate:(jn,_n)=>ze.updateFolder(jn,_n)})}):(0,n.jsxs)("p",{className:cn.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,n.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsForFilter",children:"No results found for your query"}),(0,n.jsx)(g.$n,{variant:"secondary",onClick:()=>ze.changeSearchQuery(""),"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,n.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const le=ze=>({container:(0,r.css)({backgroundColor:ze.colors.background.primary,borderRight:`1px solid ${ze.colors.border.weak}`,display:"flex",flexDirection:"column",height:"100%",gap:ze.spacing(1),padding:ze.spacing(2),width:ze.spacing(37.5)}),noResultsContainer:(0,r.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:ze.spacing(1),height:"100%",justifyContent:"center",margin:0,textAlign:"center"}),loadingIndicator:(0,r.css)({alignSelf:"center"})});var he=e(99764),oe=e(58528),de=e(20968),me=e(95382),Pe=e(34128),Ee=e(6736);function be({nodes:ze,scopes:st,isDisabled:ht,isLoading:It,onInputClick:Gt,onRemoveAllClick:un}){const vn=(0,c.of)(Se),[pn,xn]=(0,y.useState)(!1);(0,y.useEffect)(()=>{xn(!1)},[st]);const cn=(0,y.useMemo)(()=>{const Ot=st.reduce((Rt,{scope:Ye,path:dt})=>{let lt=ze;const Pt=dt.reduce((qt,gn)=>{const On=lt?.[gn];if(!On)return qt;const{title:Tn,nodes:wn}=On;return lt=wn,qt.push(Tn),qt},[]);Pt[0]===""&&Pt.splice(0,1);const Bt=Pt.length>0?Pt.pop():Ye.spec.title,Jt=Pt.length>0?Pt.join(" > "):"";return Rt[Jt]=Rt[Jt]?`${Rt[Jt]}, ${Bt}`:Bt,Rt},{});return(0,n.jsx)(n.Fragment,{children:Object.entries(Ot).map(([Rt,Ye])=>(0,n.jsx)("p",{className:vn.scopePath,children:Rt?`${Rt} > ${Ye}`:Ye},Rt))})},[ze,st,vn]),jn=(0,y.useMemo)(()=>st.map(({scope:Ot})=>Ot.spec.title).join(", "),[st]),_n=(0,y.useMemo)(()=>(0,n.jsx)(Pe.p,{readOnly:!0,placeholder:(0,o.t)("scopes.selector.input.placeholder","Select scopes..."),disabled:ht,loading:It,value:jn,"aria-label":(0,o.t)("scopes.selector.input.placeholder","Select scopes..."),"data-testid":"scopes-selector-input",suffix:st.length>0&&!ht?(0,n.jsx)(he.K,{"aria-label":(0,o.t)("scopes.selector.input.removeAll","Remove all scopes"),name:"times",onClick:()=>un()}):void 0,onMouseOver:()=>xn(!0),onMouseOut:()=>xn(!1),onClick:()=>{ht||Gt()}}),[ht,It,Gt,un,st,jn]);return(0,n.jsx)(Ee.m,{content:cn,show:st.length===0?!1:pn,children:_n})}const Se=ze=>({scopePath:(0,r.css)({color:ze.colors.text.primary,fontSize:ze.typography.pxToRem(12),margin:ze.spacing(0,0)})});function Xe({anyChildExpanded:ze,query:st,resultsNodes:ht}){const It=(0,c.of)(Qe);return ze?null:(0,n.jsx)("h6",{className:It.container,"data-testid":"scopes-tree-headline",children:st?ht.length===0?(0,n.jsx)(o.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,n.jsx)(o.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,n.jsx)(o.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const Qe=ze=>({container:(0,r.css)({color:ze.colors.text.secondary,margin:ze.spacing(1,0)})});var we=e(34511),$e=e(81942);function Fe({anyChildExpanded:ze,groupedNodes:st,isLastExpandedNode:ht,loadingNodeName:It,node:Gt,nodePath:un,nodeReason:vn,scopeNames:pn,scopes:xn,type:cn,onNodeSelectToggle:jn,onNodeUpdate:_n}){const Ot=(0,c.of)(Te),Rt=st[vn]||[];if(Rt.length===0)return null;const Ye=(0,n.jsx)("div",{role:"tree",className:ze?Ot.expandedContainer:void 0,children:Rt.map(dt=>{const lt=dt.isSelectable&&pn.includes(dt.linkId);if(ze&&!dt.isExpanded)return null;const Pt=[...un,dt.name],Bt=Pt.join(".");return(0,n.jsxs)("div",{role:"treeitem","aria-selected":dt.isExpanded,className:ze?Ot.expandedContainer:void 0,children:[(0,n.jsxs)("div",{className:(0,r.cx)(Ot.title,dt.isSelectable&&!dt.isExpanded&&Ot.titlePadding),children:[dt.isSelectable&&!dt.isExpanded?Gt.disableMultiSelect?(0,n.jsx)(we.J,{id:Bt,name:Bt,checked:lt,label:"","data-testid":`scopes-tree-${cn}-${dt.name}-radio`,onClick:()=>{jn(Pt)}}):(0,n.jsx)($e.S,{checked:lt,"data-testid":`scopes-tree-${cn}-${dt.name}-checkbox`,onChange:()=>{jn(Pt)}}):null,dt.isExpandable?(0,n.jsxs)("button",{className:Ot.expand,"data-testid":`scopes-tree-${cn}-${dt.name}-expand`,"aria-label":dt.isExpanded?(0,o.t)("scopes.tree.collapse","Collapse"):(0,o.t)("scopes.tree.expand","Expand"),onClick:()=>{_n(Pt,!dt.isExpanded,dt.query)},children:[(0,n.jsx)(f.I,{name:dt.isExpanded?"angle-down":"angle-right"}),dt.title]}):(0,n.jsx)("span",{"data-testid":`scopes-tree-${cn}-${dt.name}-title`,children:dt.title})]}),(0,n.jsx)("div",{className:Ot.children,children:dt.isExpanded&&(0,n.jsx)(Ie,{nodes:Gt.nodes,nodePath:Pt,loadingNodeName:It,scopes:xn,onNodeUpdate:_n,onNodeSelectToggle:jn})})]},dt.name)})});return ht?(0,n.jsx)(u.P,{minHeight:`${Math.min(5,Rt.length)*30}px`,maxHeight:vn===B.Persisted?`${Math.min(5,Rt.length)*30}px`:"100%",children:Ye}):Ye}const Te=ze=>({expandedContainer:(0,r.css)({display:"flex",flexDirection:"column",maxHeight:"100%"}),title:(0,r.css)({alignItems:"center",display:"flex",gap:ze.spacing(1),fontSize:ze.typography.pxToRem(14),lineHeight:ze.typography.pxToRem(22),padding:ze.spacing(.5,0),"& > label":(0,r.css)({gap:0})}),titlePadding:(0,r.css)({paddingLeft:ze.spacing(.5)}),expand:(0,r.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:ze.spacing(1),margin:0,padding:0}),children:(0,r.css)({display:"flex",flexDirection:"column",overflowY:"hidden",maxHeight:"100%",paddingLeft:ze.spacing(4)})});var Le=e(70255);function Ge({children:ze,isNodeLoading:st}){const ht=(0,c.of)(Me);return st?(0,n.jsx)(Le.A,{count:5,className:ht.loader}):ze}const Me=ze=>({loader:(0,r.css)({margin:ze.spacing(.5,0)})});function De({anyChildExpanded:ze,nodePath:st,query:ht,onNodeUpdate:It}){const Gt=(0,c.of)(Ke),[un,vn]=(0,y.useState)({value:ht,isDirty:!1});return(0,y.useEffect)(()=>{!un.isDirty&&un.value!==ht&&vn({value:ht,isDirty:!1})},[un,ht]),(0,P.A)(()=>{un.isDirty&&It(st,!0,un.value)},500,[un.isDirty,un.value]),ze?null:(0,n.jsx)(b.Z,{placeholder:(0,o.t)("scopes.tree.search","Search"),value:un.value,className:Gt.input,"data-testid":"scopes-tree-search",escapeRegex:!1,onChange:pn=>{vn({value:pn,isDirty:!0})}})}const Ke=ze=>({input:(0,r.css)({margin:ze.spacing(1,0),minHeight:ze.spacing(4),height:ze.spacing(4),maxHeight:ze.spacing(4),width:`calc(100% - ${ze.spacing(.5)})`})});function Ie({nodes:ze,nodePath:st,loadingNodeName:ht,scopes:It,onNodeUpdate:Gt,onNodeSelectToggle:un}){const vn=st[st.length-1],pn=ze[vn],xn=Object.values(pn.nodes),cn=ht===vn,jn=It.map(({scopeName:Ye})=>Ye),_n=xn.some(({isExpanded:Ye})=>Ye),Ot=(0,y.useMemo)(()=>(0,a.groupBy)(xn,"reason"),[xn]),Rt=!_n&&pn.isExpanded;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(De,{anyChildExpanded:_n,nodePath:st,query:pn.query,onNodeUpdate:Gt}),(0,n.jsxs)(Ge,{isNodeLoading:cn,children:[(0,n.jsx)(Fe,{anyChildExpanded:_n,groupedNodes:Ot,isLastExpandedNode:Rt,loadingNodeName:ht,node:pn,nodePath:st,nodeReason:B.Persisted,scopes:It,scopeNames:jn,type:"persisted",onNodeSelectToggle:un,onNodeUpdate:Gt}),(0,n.jsx)(Xe,{anyChildExpanded:_n,query:pn.query,resultsNodes:Ot[B.Result]??[]}),(0,n.jsx)(Fe,{anyChildExpanded:_n,groupedNodes:Ot,isLastExpandedNode:Rt,loadingNodeName:ht,node:pn,nodePath:st,nodeReason:B.Result,scopes:It,scopeNames:jn,type:"result",onNodeSelectToggle:un,onNodeUpdate:Gt})]})]})}const Ne={nodes:{"":{name:"",reason:B.Result,nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],treeScopes:[],isReadOnly:!1,isLoadingScopes:!1,isPickerOpened:!1,isEnabled:!1};class ie extends s.Bs{static{this.Component=ve}constructor(){super({dashboards:null,...Ne}),this.addActivationHandler(()=>(Object.keys(this.state.nodes[""].nodes).length===0&&this.fetchBaseNodes(),()=>{this.nodesFetchingSub?.unsubscribe()}))}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(st,ht,It){this.nodesFetchingSub?.unsubscribe();let Gt={...this.state.nodes},un=Gt;for(let cn=0;cn<st.length-1;cn++)un=un[st[cn]].nodes;const vn=st[st.length-1],pn=un[vn],xn=pn.query!==It;pn.isExpanded=ht,pn.query=It,ht||xn?(this.setState({nodes:Gt,loadingNodeName:vn}),this.nodesFetchingSub=(0,i.H)(ee(vn,It)).pipe((0,x.j)(()=>{this.setState({loadingNodeName:void 0})})).subscribe(cn=>{const[jn,_n]=N(this.state.scopes,this.state.treeScopes,st,cn),Ot=_n.map(({path:Rt})=>Rt[Rt.length-1]).filter(Rt=>Rt in pn.nodes&&!(Rt in cn)).reduce((Rt,Ye)=>(Rt[Ye]={...pn.nodes[Ye],reason:B.Persisted},Rt),{});pn.nodes={...Ot,...cn},this.setState({nodes:Gt,scopes:jn,treeScopes:_n}),this.nodesFetchingSub?.unsubscribe()})):this.setState({nodes:Gt,loadingNodeName:void 0})}toggleNodeSelect(st){let ht=[...this.state.treeScopes],It=this.state.nodes[""];for(let pn=1;pn<st.length-1;pn++)It=It.nodes[st[pn]];const Gt=st[st.length-1],{linkId:un}=It.nodes[Gt],vn=ht.findIndex(({scopeName:pn})=>pn===un);if(vn===-1){J(un);const pn=ht.length===0||Object.values(It.nodes).some(({linkId:cn})=>cn===ht[0].scopeName),xn={scopeName:un,path:st};this.setState({treeScopes:It?.disableMultiSelect||!pn?[xn]:[...ht,xn]})}else ht.splice(vn,1),this.setState({treeScopes:ht})}openPicker(){if(!this.state.isReadOnly){let st={...this.state.nodes};st=this.closeNodes(st);let ht=[...this.state.scopes[0]?.path??["",""]];ht.splice(ht.length-1,1),st=this.expandNodes(st,ht),this.setState({isPickerOpened:!0,nodes:st})}}closePicker(){this.setState({isPickerOpened:!1})}async updateScopes(st=this.state.treeScopes){if((0,a.isEqual)(st,U(this.state.scopes)))return;this.setState({scopes:st.map(({scopeName:It,path:Gt})=>({scope:F(It),path:Gt})),treeScopes:st,isLoadingScopes:!0}),this.state.dashboards?.resolve().fetchDashboards(st.map(({scopeName:It})=>It));const ht=await te(st);this.setState({scopes:ht,isLoadingScopes:!1})}resetDirtyScopeNames(){this.setState({treeScopes:U(this.state.scopes)})}async removeAllScopes(){return this.updateScopes([])}enterReadOnly(){this.setState({isReadOnly:!0,isPickerOpened:!1})}exitReadOnly(){this.setState({isReadOnly:!1})}enable(){this.setState({isEnabled:!0})}disable(){this.setState({isEnabled:!1})}closeNodes(st){return Object.entries(st).reduce((ht,[It,Gt])=>(ht[It]={...Gt,isExpanded:!1,nodes:this.closeNodes(Gt.nodes)},ht),{})}expandNodes(st,ht){st={...st};let It=st;for(let Gt=0;Gt<ht.length;Gt++){const un=ht[Gt];It[un]={...It[un],isExpanded:!0},It=It[un].nodes}return st}}function ve({model:ze}){const{chrome:st}=(0,me.Il)(),ht=st.useState(),It=!ht.chromeless&&ht.megaMenuDocked&&ht.megaMenuOpen,Gt=(0,c.of)(fe,It),{dashboards:un,nodes:vn,loadingNodeName:pn,scopes:xn,treeScopes:cn,isReadOnly:jn,isLoadingScopes:_n,isPickerOpened:Ot,isEnabled:Rt}=ze.useState(),Ye=un?.resolve(),{isPanelOpened:dt}=Ye?.useState()??{};if(!Rt)return null;const lt=jn?(0,o.t)("scopes.dashboards.toggle.disabled","Suggested dashboards list is disabled due to read only mode"):dt?(0,o.t)("scopes.dashboards.toggle.collapse","Collapse suggested dashboards list"):(0,o.t)("scopes.dashboards.toggle..expand","Expand suggested dashboards list");return(0,n.jsxs)("div",{className:Gt.container,children:[(0,n.jsx)(he.K,{name:"web-section-alt",className:Gt.dashboards,"aria-label":lt,tooltip:lt,"data-testid":"scopes-dashboards-expand",disabled:jn,onClick:()=>Ye?.togglePanel()}),(0,n.jsx)(be,{nodes:vn,scopes:xn,isDisabled:jn,isLoading:_n,onInputClick:()=>ze.openPicker(),onRemoveAllClick:()=>ze.removeAllScopes()}),Ot&&(0,n.jsx)(oe._,{title:(0,o.t)("scopes.selector.title","Select scopes"),size:"sm",onClose:()=>{ze.closePicker(),ze.resetDirtyScopeNames()},children:(0,n.jsxs)("div",{className:Gt.drawerContainer,children:[(0,n.jsx)("div",{className:Gt.treeContainer,children:_n?(0,n.jsx)(de.y,{"data-testid":"scopes-selector-loading"}):(0,n.jsx)(Ie,{nodes:vn,nodePath:[""],loadingNodeName:pn,scopes:cn,onNodeUpdate:(Pt,Bt,Jt)=>ze.updateNode(Pt,Bt,Jt),onNodeSelectToggle:Pt=>ze.toggleNodeSelect(Pt)})}),(0,n.jsxs)("div",{className:Gt.buttonsContainer,children:[(0,n.jsx)(g.$n,{variant:"primary","data-testid":"scopes-selector-apply",onClick:()=>{ze.closePicker(),ze.updateScopes()},children:(0,n.jsx)(o.x6,{i18nKey:"scopes.selector.apply",children:"Apply"})}),(0,n.jsx)(g.$n,{variant:"secondary","data-testid":"scopes-selector-cancel",onClick:()=>{ze.closePicker(),ze.resetDirtyScopeNames()},children:(0,n.jsx)(o.x6,{i18nKey:"scopes.selector.cancel",children:"Cancel"})})]})]})})]})}const fe=(ze,st)=>({container:(0,r.css)({display:"flex",flexDirection:"row",paddingLeft:st?ze.spacing(2):"unset"}),dashboards:(0,r.css)({color:ze.colors.text.secondary,marginRight:ze.spacing(2),"&:hover":(0,r.css)({color:ze.colors.text.primary})}),drawerContainer:(0,r.css)({display:"flex",flexDirection:"column",height:"100%"}),treeContainer:(0,r.css)({display:"flex",flexDirection:"column",maxHeight:"100%",overflowY:"hidden",paddingLeft:ze.spacing(.5)}),buttonsContainer:(0,r.css)({display:"flex",gap:ze.spacing(1),marginTop:ze.spacing(8)})});let ge=null,xe=null;function je(){t.$.featureToggles.scopeFilters&&(xe=new ie,ge=new ne,xe.setState({dashboards:ge.getRef()}),ge.setState({selector:xe.getRef()}))}function Ve(){return ge?(0,n.jsx)(ge.Component,{model:ge}):null}function ke(){return W(xe?.state.scopes??[])}function Oe(){return ke().map(ze=>ze.metadata.name)}function nt(){xe?.enable(),ge?.enable()}function Je(){xe?.disable(),ge?.disable()}function Be(){xe?.exitReadOnly(),ge?.exitReadOnly()}function Ze(){xe?.enterReadOnly(),ge?.enterReadOnly()}function tt(ze){return s.jh.findObject(ze,st=>st instanceof Re)}class Re extends s.Bs{constructor(st){super({...st,renderCount:0}),this._urlSync=new s.So(this,{keys:["scopes"]}),this._activationHandler=()=>(this.enable(),this._subs.add(xe?.subscribeToState((ht,It)=>{!ht.isLoadingScopes&&(It.isLoadingScopes||!(0,a.isEqual)(ht.scopes,It.scopes))&&(this.setState({renderCount:(this.state.renderCount??0)+1}),this.state.handler?.(this))})),()=>{this.disable()}),this.addActivationHandler(this._activationHandler)}getUrlState(){return{scopes:this.value.map(({metadata:st})=>st.name)}}updateFromUrl(st){if(!st.scopes&&!xe?.state.isEnabled)return;let ht=st.scopes??[];ht=Array.isArray(ht)?ht:[ht],xe?.updateScopes(ht.map(It=>({scopeName:It,path:[]})))}get value(){return ke()}enable(){nt()}disable(){Je()}enterReadOnly(){Ze()}exitReadOnly(){Be()}}function at(){return xe?(0,n.jsx)(xe.Component,{model:xe}):null}const yt=()=>ge?.useState()},93719:(q,j,e)=>{"use strict";e.d(j,{G3:()=>x,TF:()=>d,XJ:()=>m,YU:()=>o,d7:()=>g,if:()=>f,r4:()=>i,w7:()=>E});var t=e(70663);const n=null,r=58,a=8,i={label:"A\u2013Z",value:"alpha-asc"},x="search.sections",s="grafana.search.expanded-folder",c=0,d="general",u="Dashboards",g="grafana.search.include.panels",o="grafana.search.layout",E="grafana.search.sort",m={dashboard:t.G.DashDB,folder:t.G.DashFolder,home:t.G.DashHome},f=1e3},51253:(q,j,e)=>{"use strict";e.d(j,{d:()=>i,n:()=>x});var t=e(96540),n=e(13752),r=e(2567),a=e(53027);function i(){const s=(0,t.useRef)(new n.B);return{keyboardEvents:s.current,onKeyDown:c=>{switch(c.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":case"Escape":s.current.next(c);default:}}}}function x(s,c,d){const u=(0,t.useRef)({x:0,y:-1}),[g,o]=(0,t.useState)({x:0,y:-1}),E=(0,t.useRef)();return(0,t.useEffect)(()=>{E.current=d.view.fields.url,u.current.x=0,u.current.y=-1,o({...u.current})},[d]),(0,t.useEffect)(()=>{const m=s.subscribe({next:f=>{switch(f?.code){case"ArrowDown":{u.current.y++,o({...u.current});break}case"ArrowUp":u.current.y=Math.max(0,u.current.y-1),o({...u.current});break;case"ArrowRight":{c>0&&(u.current.x=Math.min(c,u.current.x+1),o({...u.current}));break}case"ArrowLeft":{c>0&&(u.current.x=Math.max(0,u.current.x-1),o({...u.current}));break}case"Enter":if(!E.current)break;const p=u.current.x*c+u.current.y;if(p<0){u.current.x=0,u.current.y=0,o({...u.current});break}const h=E.current.values?.[p];typeof h=="string"&&a.Ny.push(r.I.stripBaseFromUrl(h))}}});return()=>m.unsubscribe()},[s,c]),g}},19614:(q,j,e)=>{"use strict";e.d(j,{B9:()=>x,J$:()=>a,KZ:()=>i,MK:()=>r,Pf:()=>n});var t=e(56276);const n=(c,d)=>{(0,t.rR)(`${c}_viewed`,s(d))},r=(c,d)=>{(0,t.rR)(`${c}_result_clicked`,s(d))},a=(c,d)=>{(0,t.rR)(`${c}_query_submitted`,s(d))},i=(c,{error:d,...u})=>{(0,t.rR)(`${c}_query_failed`,{...s(u),error:d})},x=(c,d,u)=>{(0,t.rR)(`grafana_panel_inspect_${c}_${d}_clicked`,u)},s=c=>({layout:c.layout,starredFilter:c.starred??!1,sort:c.sortValue??"",tagCount:c.tagCount??0,queryLength:c.query?.length??0,includePanels:c.includePanels??!1,deleted:c.deleted??!1})},92914:(q,j,e)=>{"use strict";e.d(j,{S:()=>T});var t=e(32370),n=e(94626),r=e(4038),a=e(16869),i=e(28082),x=e(1167);const s="Loading",c="api/search-v2",d="name_sort";class u{constructor(w){this.fallbackSearcher=w}async search(w){if(w.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(w)}async starred(w){if(w.facet?.length)throw new Error("facets not supported!");const H=await(0,i.AI)().get("api/user/stars");return H?.length?this.doSearchQuery({uid:H,query:w.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(G,X)=>{},isItemLoaded:G=>!0}}async tags(w){const H={...w,query:w.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},X=(await(0,i.AI)().post(c,H)).frames.map(k=>(0,r.Vc)(k));if(X[0]?.name===s)return this.fallbackSearcher.tags(w);for(const k of X)if(k.fields[0].name==="tag")return E(k);return[]}getSortOptions(){const w=[{value:d,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const H of m)w.push({value:`-${H.name}`,label:`${H.display} (most)`}),w.push({value:`${H.name}`,label:`${H.display} (least)`});for(const H of f)w.push({value:`-${H.name}`,label:`${H.display} (recent)`}),w.push({value:`${H.name}`,label:`${H.display} (oldest)`})}return Promise.resolve(w)}async doSearchQuery(w){w=await(0,x.u4)(w);const H={...w,query:w.query??"*",limit:w.limit??g},X=(await(0,i.AI)().post(c,H)).frames.map(ae=>(0,r.Vc)(ae)),k=X.length?(0,r.Vc)(X[0]):{fields:[],length:0};if(k.name===s)return this.fallbackSearcher.search(w);for(const ae of k.fields)ae.display=(0,a.J)({field:ae,theme:t.$.theme2});k.meta?.custom||(k.meta={...k.meta,custom:{count:k.length,max_score:1}});const _=k.meta.custom;if(_.locationInfo||(_.locationInfo={}),_.sortBy?.length){const ae=k.fields.find(re=>re.name===_.sortBy);if(ae){const re=p(ae.name);_.sortBy=re,ae.name=re}}let ee=0,J;const Z=async()=>{for(;ee>te.dataFrame.length;){const ae=te.dataFrame.length;if(ae>=_.count)return;const re=await(0,i.AI)().post(c,{...H??{},from:ae,limit:o}),ne=(0,r.Vc)(re.frames[0]);if(!ne){console.log("no results",ne);return}if(ne.fields.length!==te.dataFrame.fields.length){console.log("invalid shape",ne,te.dataFrame);return}const ce=ne.length+te.dataFrame.length;for(let he=0;he<ne.fields.length;he++)te.dataFrame.fields[he].values.push(...ne.fields[he].values);te.dataFrame.length=ce;const le=ne.meta?.custom;if(le?.locationInfo&&_)for(const[he,oe]of Object.entries(le.locationInfo))_.locationInfo[he]=oe}J=void 0},te=new n.R(k);return{totalRows:_.count??k.length,view:te,loadMoreItems:async(ae,re)=>(ee=Math.max(ee,re),J||(J=Z()),J),isItemLoaded:ae=>ae<te.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const g=50,o=100;function E(z){const w=z.fields[0].values,H=z.fields[1].values,G=[];for(let X=0;X<z.length;X++)G.push({term:w[X],count:H[X]});return G}const m=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],f=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function p(z){for(const w of m)if(w.name===z)return w.display;for(const w of f)if(w.name===z)return w.display;return z}var h=e(84139);class D{constructor(w){this.parent=w,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(w){if(w.facet?.length)throw new Error("facets not supported!");if(w.sort!=null)throw new Error("custom sorting is not supported yet");if(w.tags?.length||w.ds_uid?.length)return this.parent.search(w);const G=(await this.getCache(w.kind)).search(w.query);return{isItemLoaded:()=>!0,loadMoreItems:async(X,k)=>{},totalRows:G.length,view:G}}async getCache(w){const H=w?w.sort().join(","):"*",G=this.cache.get(H);if(G)try{return await G}catch{return this.cache.delete(H),new C(new n.R({name:"error",fields:[],length:0}))}const X=this.parent.search({kind:w,limit:5e3}).then(k=>new C(k.view));return this.cache.set(H,X),X}async starred(w){return this.parent.starred(w)}async getSortOptions(){return this.parent.getSortOptions()}async tags(w){return this.parent.tags(w)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class C{constructor(w){this.full=w,this.ufuzzy=new h.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new n.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(H=>({...H,values:[]})),length:0})}search(w){if(!w?.length||w==="*")return this.full;const H=this.full.dataFrame.fields,G=this.names,X=H.map(J=>[]);let[k,_,ee]=this.ufuzzy.search(G,w,5);for(let J=0;J<H.length;J++){let Z=H[J].values,te=X[J];if(_&&ee)for(let ae=0;ae<ee.length;ae++){let re=_.idx[ee[ae]];te.push(Z[re])}else if(k)for(let ae=0;ae<k.length;ae++){let re=k[ae];te.push(Z[re])}}return this.empty.dataFrame.fields.forEach((J,Z)=>{J.values=X[Z]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var l=e(63739),v=e(75911),y=e(93719);class P{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(w,H){const G=await(0,x.u4)(H);return G.query?.length&&G.query!=="*"&&(w.query=G.query),G.kind?.length===1&&y.XJ[G.kind[0]]&&(w.type=y.XJ[G.kind[0]]),G.uid?w.dashboardUID=G.uid:G.location?.length&&(w.folderUIDs=[G.location]),w}async search(w){if(w.facet?.length)throw new Error("facets not supported!");if(w.from!==void 0){if(!w.limit)throw new Error("Must specify non-zero limit parameter when using from");if(w.from/w.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const H=w.limit??(w.from!==void 0?1:y.if),G=w.from!==void 0?w.from/H+1:void 0,X=await this.composeQuery({limit:H,tag:w.tags,sort:w.sort,permission:w.permission,page:G,deleted:w.deleted},w);return this.doAPIQuery(X)}async starred(w){if(w.facet?.length)throw new Error("facets not supported!");const H=await this.composeQuery({limit:w.limit??y.if,tag:w.tags,sort:w.sort,starred:w.starred},w);return this.doAPIQuery(H)}async getSortOptions(){return(await v.IB.get("/api/search/sorting")).sortOptions.map(H=>({value:H.name,label:H.displayName}))}async tags(w){return(await v.IB.get("/api/dashboards/tags")).sort((G,X)=>X.count-G.count)}async doAPIQuery(w){const H=await v.IB.get("/api/search",w),G=[],X=[],k=[],_=[],ee=[],J=[],Z=[],te=[],ae=[];let re;for(let le of H){const he=le.type==="dash-folder"?"folder":"dashboard";G.push(he),X.push(le.title),k.push(le.uid),_.push(le.url),ee.push(le.tags),Z.push(le.sortMeta),te.push(le.isDeleted??!1),ae.push(le.permanentlyDeleteDate?new Date(le.permanentlyDeleteDate):void 0);let oe=le.folderUid;!oe&&he==="dashboard"&&(oe=y.TF),J.push(oe),le.sortMetaName?.length&&(re=le.sortMetaName),le.folderUid&&le.folderTitle?this.locationInfo[le.folderUid]={kind:"folder",name:le.folderTitle,url:le.folderUrl,folderUid:le.folderUid}:he==="folder"&&(this.locationInfo[le.uid]={kind:he,name:le.title,url:le.url,folderUid:le.folderUid})}const ne={fields:[{name:"kind",type:l.PU.string,config:{},values:G},{name:"name",type:l.PU.string,config:{},values:X},{name:"uid",type:l.PU.string,config:{},values:k},{name:"url",type:l.PU.string,config:{},values:_},{name:"tags",type:l.PU.other,config:{},values:ee},{name:"location",type:l.PU.string,config:{},values:J},{name:"isDeleted",type:l.PU.boolean,config:{},values:te},{name:"permanentlyDeleteDate",type:l.PU.time,config:{},values:ae}],length:X.length,meta:{custom:{count:X.length,max_score:1,locationInfo:this.locationInfo}}};re?.length&&Z.length&&(ne.meta.custom.sortBy=re,ne.fields.push({name:re,type:l.PU.number,config:{},values:Z}));for(const le of ne.fields)le.display=(0,a.J)({field:le,theme:t.$.theme2});const ce=new n.R(ne);return{totalRows:ne.length,view:ce,loadMoreItems:async(le,he)=>{},isItemLoaded:le=>!0}}}var b=e(2543),S=e(58410),M=e(77855);const O="Loading",R=`apis/dashboard.grafana.app/v0alpha1/namespaces/${(0,M.G)()}/search`,L="name_sort";class B{constructor(w){this.fallbackSearcher=w,this.locationInfo=N()}async search(w){if(w.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(w)}async starred(w){if(w.facet?.length)throw new Error("facets not supported!");const H=await(0,i.AI)().get("api/user/stars");return H?.length?this.doSearchQuery({...w,name:H,query:w.query??"*"}):U()}async tags(w){const H=w.query??"*";let G=`${R}?facet=tags&query=${H}&limit=1`;return(await(0,i.AI)().get(G)).facets?.tags?.terms||[]}getSortOptions(){const w=[{value:L,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics)for(const H of I)w.push({value:`-${H.name}`,label:`${H.display} (most)`}),w.push({value:`${H.name}`,label:`${H.display} (least)`});return Promise.resolve(w)}async doSearchQuery(w){const H=await this.newRequest(w),G=await this.fetchResponse(H),X=A(G,w.sort??"");if(X.name===O)return this.fallbackSearcher.search(w);const k=X.meta?.custom||{};if(k.locationInfo=await this.locationInfo,k.sortBy?.length){const te=X.fields.find(ae=>ae.name===k.sortBy);if(te){const ae=W(te.name);k.sortBy=ae,te.name=ae}}let _=0,ee;const J=async()=>{for(;_>Z.dataFrame.length;){const te=Z.dataFrame.length;if(te>=k.count)return;const ae=`${H}&offset=${te}`,re=await this.fetchResponse(ae),ne=A(re,w.sort??"");if(!ne){console.log("no results",ne);return}if(ne.fields.length!==Z.dataFrame.fields.length){console.log("invalid shape",ne,Z.dataFrame);return}const ce=ne.length+Z.dataFrame.length;ne.fields.forEach(he=>{const oe=Z.dataFrame.fields.find(de=>de.name===he.name);oe&&oe.values.push(...he.values)}),Z.dataFrame.length=ce;const le=ne.meta?.custom;if(le?.locationInfo&&k)for(const[he,oe]of Object.entries(le.locationInfo))k.locationInfo[he]=oe}ee=void 0},Z=new n.R(X);return{totalRows:k.count??X.length,view:Z,loadMoreItems:async(te,ae)=>(_=Math.max(_,ae),ee||(ee=J()),ee),isItemLoaded:te=>te<Z.dataFrame.length}}async fetchResponse(w){const H=await(0,i.AI)().get(w);if(!await this.isFolderCacheStale(H.hits)||(this.locationInfo=N(),!await this.isFolderCacheStale(H.hits)))return H;const k=await this.locationInfo,_=H.hits.map(J=>J.folder===void 0?{...J,location:"general",folder:"general"}:k[J.folder]===void 0?{...J,location:"sharedwithme",folder:"sharedwithme"}:J),ee=H.totalHits-(H.hits.length-_.length);return{...H,hits:_,totalHits:ee}}async isFolderCacheStale(w){const H=await this.locationInfo;return w.some(G=>G.folder!==void 0&&H[G.folder]===void 0)}async newRequest(w){w=await(0,x.u4)(w);let H=R;if(H+=`?query=${encodeURIComponent(w.query??"*")}`,H+=`&limit=${w.limit??F}`,(0,b.isEmpty)(w.location)||(H+=`&folder=${w.location}`),w.kind&&(H+="&"+w.kind.map(G=>`type=${G}`).join("&")),w.tags?.length&&(H+="&"+w.tags.map(G=>`tag=${encodeURIComponent(G)}`).join("&")),w.sort){const G=w.sort.replace("_sort","").replace("name","title");H+=`&sort=${G}`;const X=G.startsWith("-")?G.substring(1):G;H+=`&field=${X}`}return w.name?.length&&(H+="&"+w.name.map(G=>`name=${encodeURIComponent(G)}`).join("&")),w.uid?.length&&(H+="&"+w.uid.map(G=>`name=${encodeURIComponent(G)}`).join("&")),H}getFolderViewSort(){return"name_sort"}}const F=50,I=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}];function U(){return{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(z,w)=>{},isItemLoaded:z=>!0}}function W(z){for(const w of I)if(w.name===z)return w.display;return z}function A(z,w){const H=z.hits;if(H.length<1)return{fields:[],length:0};const G=H.map(k=>{let _=k.folder;k.resource==="dashboards"&&(0,b.isEmpty)(_)&&(_="general");const ee=Object.fromEntries(Object.entries(k.field??{}).map(([J,Z])=>[J,Z??"-"]));return{...k,uid:k.name,url:K(k.resource,k.name,k.title),tags:k.tags||[],folder:k.folder||"general",location:_,name:k.title,kind:k.resource.substring(0,k.resource.length-1),...ee}}),X=(0,r.Vc)(G);X.meta={custom:{count:z.totalHits,max_score:1}},w&&X.meta.custom&&(X.meta.custom.sortBy=w.startsWith("-")?w.substring(1):w);for(const k of X.fields)k.display=(0,a.J)({field:k,theme:t.$.theme2});return X}async function N(){const z=`${R}?type=folders`;return(0,i.AI)().get(z).then(H=>{const G={general:{kind:"folder",name:"Dashboards",url:"/dashboards"},sharedwithme:{kind:"sharedwithme",name:"Shared with me",url:""}};for(const X of H.hits)G[X.name]={name:X.title,kind:"folder",url:K("folders",X.name,X.title)};return G})}function K(z,w,H){if(z==="folders")return`/dashboards/f/${w}`;const G=S.A.slugifyForUrl(H);return`/d/${w}/${G}`}let V;function T(){if(!V){const z=new P,w=t.$.featureToggles.panelTitleSearch;if(V=w?new u(z):z,w&&location.search.includes("do-frontend-query"))return new D(V);V=t.$.featureToggles.unifiedStorageSearchUI?new B(z):z}return V}},1167:(q,j,e)=>{"use strict";e.d(j,{TM:()=>x,cu:()=>s,hI:()=>d,u4:()=>r});var t=e(23758),n=e(16910);async function r(u){return u.query&&u.query.indexOf("folder:current")>=0&&(u={...u,location:await a(),query:u.query.replace("folder:current","").trim()},u.query?.length||(u.query="*")),Promise.resolve(u)}async function a(){try{let u=(0,n.UA)().getCurrent();return u||(await i(500),u=(0,n.UA)().getCurrent()),Promise.resolve(u?.meta?.folderUid)}catch(u){console.error(u)}}function i(u){return new Promise(g=>setTimeout(g,u))}function x(u,g){return u==="dashboard"?"apps":u==="folder"?g?"folder-open":"folder":u==="sharedwithme"?"users-alt":"question-circle"}function s(u,g){return u&&(0,t.I2)(u.uid)?"users-alt":x(u.kind,g)}function c(u){switch(u){case"dashboard":case"folder":case"panel":return u;default:return"dashboard"}}function d(u,g){const o=g?.dataFrame.meta?.custom,E={kind:c(u.kind),uid:u.uid,title:u.name,url:u.url,tags:u.tags??[]},m=o?.sortBy;if(m){const f=u[m];(typeof f=="string"||typeof f=="number")&&(E.sortMetaName=m,E.sortMeta=f)}if(u.location){const f=u.location.split("/"),p=f[f.length-1],h=o?.locationInfo[p];h&&(E.parentTitle=h.name,E.parentKind=h.kind,E.parentUID=p)}return E}},70663:(q,j,e)=>{"use strict";e.d(j,{G:()=>t,P:()=>n});var t=(r=>(r.DashDB="dash-db",r.DashHome="dash-home",r.DashFolder="dash-folder",r))(t||{}),n=(r=>(r.List="list",r.Folders="folders",r))(n||{})},10867:(q,j,e)=>{"use strict";e.d(j,{N1:()=>i,W1:()=>r});var t=e(93719);const n=x=>x?!!(x.query||x.tag?.length>0||x.starred||x.sort):!1,r=()=>{const x=t.G3+".";for(let s=0;s<window.localStorage.length;s++){const c=window.localStorage.key(s);c?.startsWith(x)&&window.localStorage.removeItem(c)}},a=(x="General")=>`${SECTION_STORAGE_KEY}.${x.toLowerCase()}`,i=x=>{const s=Object.entries(x).reduce((c,[d,u])=>{if(u){if(d==="tag"&&!Array.isArray(u))return{...c,tag:[u]}}else return c;return{...c,[d]:u}},{});if(x.folder){const c=`folder:${x.folder}`;return{...s,query:`${c} ${(s.query??"").replace(c,"")}`}}return{...s}}},83410:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>y,EC:()=>C,FW:()=>f,G3:()=>c,L5:()=>v,QM:()=>x,Yh:()=>p,aD:()=>d,c3:()=>l,ch:()=>s,dJ:()=>u,ew:()=>D,jE:()=>g,zh:()=>h});var t=e(65307),n=e(61491);const r={serviceAccount:{},isLoading:!0,tokens:[]},a=(0,t.Z0)({name:"serviceaccount",initialState:r,reducers:{serviceAccountFetchBegin:P=>({...P,isLoading:!0}),serviceAccountFetchEnd:P=>({...P,isLoading:!1}),serviceAccountLoaded:(P,b)=>({...P,serviceAccount:b.payload,isLoading:!1}),serviceAccountTokensLoaded:(P,b)=>({...P,tokens:b.payload,isLoading:!1}),rolesFetchBegin:P=>({...P,rolesLoading:!0}),rolesFetchEnd:P=>({...P,rolesLoading:!1})}}),i=a.reducer,{serviceAccountLoaded:x,serviceAccountTokensLoaded:s,serviceAccountFetchBegin:c,serviceAccountFetchEnd:d,rolesFetchBegin:u,rolesFetchEnd:g}=a.actions,o={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:n.ServiceAccountStateFilter.All},E=(0,t.Z0)({name:"serviceaccounts",initialState:o,reducers:{serviceAccountsFetched:(P,b)=>{const{totalCount:S,perPage:M,...O}=b.payload,R=Math.ceil(S/M);return{...P,...O,totalPages:R,perPage:M,showPaging:R>1,isLoading:!1}},serviceAccountsFetchBegin:P=>({...P,isLoading:!0}),serviceAccountsFetchEnd:P=>({...P,isLoading:!1}),acOptionsLoaded:(P,b)=>({...P,roleOptions:b.payload}),queryChanged:(P,b)=>({...P,query:b.payload,page:0}),pageChanged:(P,b)=>({...P,page:b.payload}),stateFilterChanged:(P,b)=>({...P,serviceAccountStateFilter:b.payload})}}),m=E.reducer,{serviceAccountsFetchBegin:f,serviceAccountsFetchEnd:p,serviceAccountsFetched:h,acOptionsLoaded:D,pageChanged:C,stateFilterChanged:l,queryChanged:v}=E.actions,y={serviceAccountProfile:i,serviceAccounts:m}},28378:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>E,NV:()=>g,Y1:()=>c,j7:()=>s,kH:()=>x,pB:()=>u,s7:()=>d,sF:()=>i,sJ:()=>a});var t=e(65307);const n={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},r=(0,t.Z0)({name:"supportBundles",initialState:n,reducers:{supportBundlesLoaded:(m,f)=>({...m,supportBundles:f.payload,isLoading:!1}),fetchBegin:m=>({...m,isLoading:!0}),fetchEnd:m=>({...m,isLoading:!1}),collectorsFetchBegin:m=>({...m,createBundlePageLoading:!0}),collectorsFetchEnd:m=>({...m,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(m,f)=>({...m,supportBundleCollectors:f.payload,createBundlePageLoading:!1}),setLoadBundleError:(m,f)=>({...m,loadBundlesError:f.payload,supportBundleCollectors:[]}),setCreateBundleError:(m,f)=>({...m,createBundleError:f.payload})}}),{supportBundlesLoaded:a,fetchBegin:i,fetchEnd:x,supportBundleCollectorsLoaded:s,collectorsFetchBegin:c,collectorsFetchEnd:d,setLoadBundleError:u,setCreateBundleError:g}=r.actions,E={supportBundles:r.reducer}},34361:(q,j,e)=>{"use strict";e.d(j,{$T:()=>E,$u:()=>s,Ay:()=>D,EC:()=>x,L5:()=>i,Q9:()=>a,dJ:()=>c,jE:()=>d,tC:()=>m});var t=e(65307);const n={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},r=(0,t.Z0)({name:"teams",initialState:n,reducers:{teamsLoaded:(C,l)=>{const{totalCount:v,perPage:y,...P}=l.payload,b=Math.ceil(v/y);return{...C,...P,totalPages:b,perPage:y,hasFetched:!0}},queryChanged:(C,l)=>({...C,page:1,query:l.payload}),pageChanged:(C,l)=>({...C,page:l.payload}),sortChanged:(C,l)=>({...C,sort:l.payload,page:1}),rolesFetchBegin:C=>({...C,rolesLoading:!0}),rolesFetchEnd:C=>({...C,rolesLoading:!1})}}),{teamsLoaded:a,queryChanged:i,pageChanged:x,sortChanged:s,rolesFetchBegin:c,rolesFetchEnd:d}=r.actions,u=r.reducer,g={team:{},members:[],groups:[],searchMemberQuery:""},o=(0,t.Z0)({name:"team",initialState:g,reducers:{teamLoaded:(C,l)=>({...C,team:l.payload}),teamMembersLoaded:(C,l)=>({...C,members:l.payload}),setSearchMemberQuery:(C,l)=>({...C,searchMemberQuery:l.payload}),teamGroupsLoaded:(C,l)=>({...C,groups:l.payload})}}),{teamLoaded:E,teamGroupsLoaded:m,teamMembersLoaded:f,setSearchMemberQuery:p}=o.actions,h=o.reducer,D={teams:u,team:h}},84395:(q,j,e)=>{"use strict";e.d(j,{w:()=>ee});var t=e(2543),n=e(33262),r=e(98437),a=e(39736),i=e(61034),x=e(7500),s=e(17738),c=e(19639),d=e(44690),u=e(21658),g=e(58843),o=e(2510);let E={};function m(J){const Z=E[J];return Z||(E[J]=(0,t.property)(J))}class f{constructor(Z,te,ae){this.state={name:Z.name,value:te,text:ae,type:Z.type}}getValue(Z){let{value:te}=this.state;return te==="string"||te==="number"||te==="boolean"?te:String(te)}getValueText(){const{value:Z,text:te}=this.state;return typeof te=="string"?Z===d.To?d.Zm:te:Array.isArray(te)?te.join(" + "):(console.log("value",te),String(te))}}let p;function h(J,Z,te){return p?(p.state.name=J.name,p.state.type=J.type,p.state.value=Z,p.state.text=te):p=new f(J,Z,te),p}function D(J,Z,te,ae){if(te=te||{},J==null||(0,u.EW)(te)&&Z!==x.$m.QueryParam)return"";if(!Array.isArray(J)&&typeof J=="object"&&(J=`${J}`),typeof Z=="function")return Z(J,te,D);Z||(Z=x.$m.Glob);let re=Z.split(":");re.length>1?(Z=re[0],re=re.slice(1)):re=[];let ne=i.vz.getIfExists(Z);ne||(console.error(`Variable format ${Z} not found. Using glob format as fallback.`),ne=i.vz.get(x.$m.Glob));const ce=h(te,J,ae??J);return ne.formatter(J,re,ce)}var C=e(84743),l=e.n(C),v=e(46399),y=e(93407),P=e(35023),b=e(80757),S=e(86278),M=e(59141),O=e(63739),R=e(41931),L=e(16869),B=e(23570),F=e(55515);function I(J,Z,te){return new Proxy({},{get:(ae,re)=>{if(re==="name")return J.name;if(re==="displayName")return(0,B.Ct)(J,Z,te);if(re==="labels"||re==="formattedLabels")return J.labels?{...J.labels,__values:Object.values(J.labels).sort().join(", "),toString:()=>(0,F.h6)(J.labels,"",!0)}:""}})}function U(J,Z,te,ae){const re=W(J,Z,te);return D(re,ae)}function W(J,Z,te){const ae=te?.__dataContext;if(!ae)return J;const{frame:re,rowIndex:ne,field:ce,calculatedValue:le}=ae.value;if(le)switch(Z){case"numeric":return le.numeric.toString();case"raw":return le.numeric;case"time":return"";case"text":default:return(0,M.cN)(le)}if(ne===void 0)return J;if(Z==="time"){const me=re.fields.find(Pe=>Pe.type===O.PU.time);return me?me.values[ne]:void 0}const he=ce.values[ne];if(Z==="raw")return he;const de=(ce.display??K())(he);switch(Z){case"numeric":return de.numeric;case"text":return de.text;default:return(0,M.cN)(de)}}function A(J,Z,te,ae){const re=te?.__dataContext;if(!re||!Z)return J;const{frame:ne,rowIndex:ce}=re.value;if(ce===void 0||Z===void 0)return J;const le={name:ne.name,refId:ne.refId,fields:(0,R.F)({frame:ne,rowIndex:ce})},he=m(Z)(le)??"";return D(he,ae)}let N;function K(){return N||(N=(0,L.J)()),N}function V(J,Z,te,ae){const re=te?.__dataContext;if(!re||Z!=="name")return J;const{frame:ne,frameIndex:ce}=re.value,le=(0,B.Ri)(ne,ce);return D(le,ae)}function T(J,Z,te,ae){const re=te?.__dataContext;if(!re||Z===void 0||Z==="")return J;const{frame:ne,field:ce,data:le}=re.value,he=I(ce,ne,le),oe=m(Z)(he)??"";return D(oe,ae)}const z={__value:U,__data:A,__series:V,__field:T,[v.c.includeVars]:w,[v.c.keepTime]:H,__timezone:G};function w(J,Z,te){const ae=(0,S.z)(te);return y.kM.toUrlParams(ae)}function H(){return y.kM.toUrlParams((0,b.jG)().timeRangeForUrl())}function G(){const J=(0,P.O)({timeZone:(0,b.jG)().timeModel?.getTimezone()});return J==="browser"?l().tz.guess():J}const X={getFilteredVariables:g.bZ,getVariables:g.UN,getVariableWithName:g._2};class k{constructor(Z=X){this.dependencies=Z,this.regex=o.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(Z,te){this._variables=Z,this._timeRange=te,this.updateIndex()}get variables(){return(0,n.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,s.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?i.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const Z=te=>te||te==="";if(this.index=this._variables.reduce((te,ae)=>(ae.current&&(ae.current.isNone||Z(ae.current.value))&&(te[ae.name]=ae),te),{}),this.timeRange){const te=this.timeRange.from.valueOf().toString(),ae=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:te,text:te}},__to:{current:{value:ae,text:ae}}}}}updateTimeRange(Z){this._timeRange=Z,this.updateIndex()}variableInitialized(Z){this.index[Z.name]=Z}getAdhocFilters(Z,te){let ae=[],re=(0,r.l)().getInstanceSettings(Z);if(!re)return[];!te&&!this._adhocFiltersDeprecationWarningLogged.get(re.type)&&((0,n.l)(`DataSource ${re.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(re.type,!0));for(const ne of this.getAdHocVariables()){const ce=ne.datasource?.uid;(ce===re.uid||ce?.indexOf("$")===0&&this.replace(ce)===re.uid)&&(ae=ae.concat(ne.filters))}return ae}setGrafanaVariable(Z,te){this.grafanaVariables.set(Z,te)}setGlobalVariable(Z,te){(0,n.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[Z]:{current:te}}}getVariableName(Z){this.regex.lastIndex=0;const te=this.regex.exec(Z);return te?te.slice(1).find(re=>re!==void 0):null}containsTemplate(Z){if(!Z)return!1;const te=this.getVariableName(Z),ae=te&&this.getVariableAtIndex(te);return ae!=null}variableExists(Z){return(0,n.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(Z)}highlightVariablesAsHtml(Z){return!Z||!(0,t.isString)(Z)?Z:(Z=(0,t.escape)(Z),this._replaceWithVariableRegex(Z,void 0,(te,ae)=>this.getVariableAtIndex(ae)?'<span class="template-variable">'+te+"</span>":te))}getAllValue(Z){if(Z.allValue)return Z.allValue;const te=[];for(let ae=1;ae<Z.options.length;ae++)te.push(Z.options[ae].value);return te}getVariableValue(Z,te){return te?m(te)(Z.value):Z.value}getVariableText(Z,te){return Z.value===te||typeof te!="string"?Z.text:te}replace(Z,te,ae,re){if(te&&te.__sceneObject){const ne=te.__sceneObject.value.valueOf();return i.jh.interpolate(ne,Z,te,ae,re)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?i.jh.interpolate(window.__grafanaSceneContext,Z,te,ae,re):Z?(this.regex.lastIndex=0,this._replaceWithVariableRegex(Z,ae,(ne,ce,le,he)=>{const oe=this._evaluateVariableExpression(ne,ce,le,he,te);return re&&re.push({match:ne,variableName:ce,fieldPath:le,format:he,value:oe,found:oe!==ne}),oe})):Z??""}_evaluateVariableExpression(Z,te,ae,re,ne){const ce=this.getVariableAtIndex(te),le=ne?.[te];if(le){const me=this.getVariableValue(le,ae),Pe=this.getVariableText(le,me);if(me!=null)return D(me,re,ce,Pe)}if(!ce){const me=z[te];return me?me(Z,ae,ne,re):Z}if(re===x.$m.QueryParam||(0,u.EW)(ce)){const me=c.B.get(ce.type).getValueForUrl(ce),Pe=(0,u.EW)(ce)?ce.id:ce.current.text;return D(me,re,ce,Pe)}const he=this.grafanaVariables.get(ce.current.value);if(he)return D(he,re,ce);let oe=ce.current.value,de=ce.current.text;if(this.isAllValue(oe)&&(oe=this.getAllValue(ce),de=d.Zm,ce.allValue&&re!==x.$m.Text&&re!==x.$m.PercentEncode))return this.replace(oe);if(ae){const me=this.getVariableValue({value:oe,text:de},ae);if(me!=null)return D(me,re,ce,de)}return D(oe,re,ce,de)}_replaceWithVariableRegex(Z,te,ae){return this.regex.lastIndex=0,Z.replace(this.regex,(re,ne,ce,le,he,oe,de)=>ae(re,ne||ce||he,oe,le||de||te))}isAllValue(Z){return Z===d.To||Array.isArray(Z)&&Z[0]===d.To}replaceWithText(Z,te){return(0,n.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(Z,te,"text")}getVariableAtIndex(Z){if(Z)return this.index[Z]?this.index[Z]:this.dependencies.getVariableWithName(Z)}getAdHocVariables(){return this.dependencies.getFilteredVariables(u.EW)}}const _=new k;(0,a.d)(_);const ee=()=>_},55522:(q,j,e)=>{"use strict";e.d(j,{b:()=>z,B:()=>w});var t=e(74848),n=e(22803),r=e(96540),a=e(93407),i=e(14964),x=e(53027),s=e(57862),c=e(61034),d=e(29675),u=e(81635),g=e(29010),o=e(60232),E=e(52120),m=e(11817),f=e(75637),p=e(33811),h=e(73750),D=e(56498);class C extends c.Bs{constructor(_){super({stickyMainGraph:_.stickyMainGraph??!0,isOpen:_.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const ee=!this.state.stickyMainGraph;(0,h.z)("settings_changed",{stickyMainGraph:ee}),this.setState({stickyMainGraph:ee})},this.onToggleOpen=ee=>{this.setState({isOpen:ee})},this.onTogglePreviews=()=>{const ee=(0,D.kj)(this);ee.setState({showPreviews:!ee.state.showPreviews})}}static{this.Component=({model:_})=>{const{stickyMainGraph:ee,isOpen:J}=_.useState(),Z=(0,d.of)(l),te=(0,D.kj)(_),{showPreviews:ae,topScene:re}=te.useState(),ne=()=>(0,t.jsxs)("div",{className:Z.popover,onClick:ce=>ce.stopPropagation(),children:[(0,t.jsx)("div",{className:Z.heading,children:"Settings"}),re instanceof f.R&&(0,t.jsxs)("div",{className:Z.options,children:[(0,t.jsx)("div",{children:(0,t.jsx)(m.x6,{i18nKey:"trails.settings.always-keep-selected-metric-graph-in-view",children:"Always keep selected metric graph in-view"})}),(0,t.jsx)(g.d,{value:ee,onChange:_.onToggleStickyMainGraph})]}),re instanceof p.t&&(0,t.jsxs)("div",{className:Z.options,children:[(0,t.jsx)("div",{children:(0,t.jsx)(m.x6,{i18nKey:"trails.settings.show-previews-of-metric-graphs",children:"Show previews of metric graphs"})}),(0,t.jsx)(g.d,{value:ae,onChange:_.onTogglePreviews})]})]});return(0,t.jsx)(o.m,{overlay:ne,placement:"bottom",onVisibleChange:_.onToggleOpen,children:(0,t.jsx)(E.I,{icon:"cog",variant:"canvas",isOpen:J})})}}}function l(k){return{popover:(0,n.css)({display:"flex",padding:k.spacing(2),flexDirection:"column",background:k.colors.background.primary,boxShadow:k.shadows.z3,borderRadius:k.shape.borderRadius(),border:`1px solid ${k.colors.border.weak}`,zIndex:1,marginRight:k.spacing(2)}),heading:(0,n.css)({fontWeight:k.typography.fontWeightMedium,paddingBottom:k.spacing(2)}),options:(0,n.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:k.spacing(1),columnGap:k.spacing(2)})}}var v=e(60044),y=e(48583),P=e(45565);const b=()=>(0,t.jsxs)(y.B,{direction:"column",gap:1,children:[(0,t.jsx)(P.E,{variant:"h1",children:"Metrics"}),(0,t.jsx)(P.E,{color:"secondary",children:"Explore your Prometheus-compatible metrics without writing a query"})]});var S=e(4935),M=e(37e3),O=e(54594),R=e(92986);function L(k){const{histogramsLoaded:_,nativeHistograms:ee,trail:J}=k,[Z,te]=(0,r.useState)(!0),[ae,re]=(0,r.useState)(!1),ne=(0,d.of)(I,0);return W()||!_||ee.length===0||!Z?null:(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(M.F,{title:"Native Histogram Support",severity:"info",onRemove:()=>{U(),te(!1)},className:ne.banner,children:[(0,t.jsxs)("div",{className:ne.histogramRow,children:[(0,t.jsx)("div",{className:ne.histogramSentence,children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.sentence",children:"Prometheus native histograms offer high resolution, high precision, simple usage in instrumentation and a way to combine and manipulate histograms in queries and in Grafana."})}),(0,t.jsx)("div",{className:ne.histogramLearnMore,children:(0,t.jsx)("div",{children:(0,t.jsx)(O.$n,{onClick:()=>window.open("https://grafana.com/docs/grafana-cloud/whats-new/native-histograms/","_blank"),className:ne.button,children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.learn-more",children:"Learn more"})})})})]}),(0,t.jsx)(B,{showHistogramExamples:ae,setShowHistogramExamples:re}),ae&&(0,t.jsx)(F,{trail:J,nativeHistograms:ee,setHistogramMessage:te})]})})}const B=({showHistogramExamples:k,setShowHistogramExamples:_})=>{const ee=(0,d.of)(I,0);return(0,t.jsx)("div",{children:(0,t.jsx)(O.$n,{className:`${ee.seeExamplesButton} native-histogram-examples-button`,type:"button",fill:"text",variant:"primary",onClick:()=>{k&&(0,h.z)("native_histogram_examples_closed",{}),_(!k)},children:k?(0,m.t)("trails.native-histogram-banner.hide-examples","Hide examples"):(0,m.t)("trails.native-histogram-banner.see-examples","> See examples")})})},F=({trail:k,nativeHistograms:_,setHistogramMessage:ee})=>{const J=(0,d.of)(I,0),Z=(0,d.$j)().isDark,te=re=>{(0,h.z)("native_histogram_example_clicked",{metric:re}),k.publishEvent(new R.OO(re),!0)},ae={nativeHeatmap:Z?"public/img/native-histograms/DarkModeHeatmapNativeHistogram.png":"public/img/native-histograms/LightModeHeatmapNativeHistogram.png",classicHeatmap:Z?"public/img/native-histograms/DarkModeHeatmapClassicHistogram.png":"public/img/native-histograms/LightModeHeatmapClassicHistogram.png",nativeHistogram:Z?"public/img/native-histograms/DarkModeHistogramNativehistogram.png":"public/img/native-histograms/LightModeHistogramClassicHistogram.png",classicHistogram:Z?"public/img/native-histograms/DarkModeHistogramClassicHistogram.png":"public/img/native-histograms/LightModeHistogramClassicHistogram.png"};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:`${J.histogramRow} ${J.seeExamplesRow}`,children:[(0,t.jsx)("div",{className:J.histogramImageCol,children:(0,t.jsx)("div",{children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.now",children:"Now:"})})}),(0,t.jsx)("div",{className:`${J.histogramImageCol} ${J.rightCol}`,children:(0,t.jsx)("div",{children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.previously",children:"Previously:"})})})]}),(0,t.jsxs)("div",{className:`${J.histogramRow} ${J.seeExamplesRow}`,children:[(0,t.jsx)("div",{className:J.histogramImageCol,children:(0,t.jsxs)("div",{className:J.histogramRow,children:[(0,t.jsxs)("div",{className:`${J.histogramImageCol} ${J.fontSmall}`,children:[(0,t.jsx)("div",{className:J.imageText,children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.nh-heatmap",children:"Native Histogram displayed as heatmap:"})}),(0,t.jsx)("div",{children:(0,t.jsx)("img",{width:"100%",src:ae.nativeHeatmap,alt:"Native Histogram displayed as heatmap"})})]}),(0,t.jsxs)("div",{className:`${J.histogramImageCol} ${J.fontSmall}`,children:[(0,t.jsx)("div",{className:J.imageText,children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.nh-histogram",children:"Native Histogram displayed as histogram:"})}),(0,t.jsx)("div",{children:(0,t.jsx)("img",{width:"100%",src:ae.nativeHistogram,alt:"Native Histogram displayed as histogram"})})]})]})}),(0,t.jsx)("div",{className:`${J.histogramImageCol} ${J.rightImageCol} ${J.rightCol}`,children:(0,t.jsxs)("div",{className:J.histogramRow,children:[(0,t.jsxs)("div",{className:`${J.histogramImageCol} ${J.fontSmall}`,children:[(0,t.jsx)("div",{className:J.imageText,children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.ch-heatmap",children:"Classic Histogram displayed as heatmap:"})}),(0,t.jsx)("div",{children:(0,t.jsx)("img",{width:"100%",src:ae.classicHeatmap,alt:"Classic Histogram displayed as heatmap"})})]}),(0,t.jsxs)("div",{className:`${J.histogramImageCol} ${J.fontSmall}`,children:[(0,t.jsx)("div",{className:J.imageText,children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.ch-histogram",children:"Classic Histogram displayed as histogram:"})}),(0,t.jsx)("div",{children:(0,t.jsx)("img",{width:"100%",src:ae.classicHistogram,alt:"Classic Histogram displayed as histogram"})})]})]})})]}),(0,t.jsx)("br",{}),(0,t.jsx)("div",{children:(0,t.jsx)(m.x6,{i18nKey:"trails.native-histogram-banner.click-histogram",children:"Click any of the native histograms below to explore them:"})}),(0,t.jsx)("div",{children:_.map(re=>(0,t.jsx)("div",{children:(0,t.jsx)(O.$n,{onClick:()=>{te(re),ee(!1)},variant:"primary",size:"sm",fill:"text",className:"native-histogram-example-clicked",children:(0,m.t)("trails.native-histogram-banner.metric-examples",re)},re)},re))})]})};function I(k,_){return{banner:(0,n.css)({flexGrow:0}),histogramRow:(0,n.css)({display:"flex",flexDirection:"row",gap:k.spacing(2)}),histogramSentence:(0,n.css)({width:"90%"}),histogramLearnMore:(0,n.css)({width:"10%"}),button:(0,n.css)({float:"right"}),seeExamplesButton:(0,n.css)({paddingLeft:"0px"}),seeExamplesRow:(0,n.css)({paddingTop:"4px"}),histogramImageCol:(0,n.css)({display:"flex",flexDirection:"column",flexBasis:"100%",flex:"1"}),fontSmall:(0,n.css)({fontSize:k.typography.size.sm}),imageText:(0,n.css)({paddingBottom:"4px"}),rightImageCol:(0,n.css)({borderLeft:`1px solid ${k.colors.secondary.borderTransparent}`}),rightCol:(0,n.css)({paddingLeft:"16px"})}}function U(){localStorage.setItem("nativeHistogramBanner","true")}function W(){return localStorage.getItem("nativeHistogramBanner")??!1}var A=e(48516);function N(k,_){const ee=_["var-deployment_environment"],J=_["var-otel_and_metric_filters"];if(J&&Array.isArray(J)&&J.length>0&&(k.state.startButtonClicked||J[0]!=="")||!ee||Array.isArray(ee)&&ee.length>0&&ee[0]==="undefined")return;let Z=[];const te=_["var-otel_resources"],ae=_["var-filters"];if(Array.isArray(ee)&&ee.length>0&&ee[0]!==""&&ee.every(ce=>ce&&typeof ce=="string")){const le=ee.map(he=>he.toString()).join("|");Z.push({key:"deployment_environment",operator:ee.length>1?"=~":"=",value:le})}K(te,Z),K(ae,Z);const re=c.jh.lookupVariable(R.mW,k),ne=c.jh.lookupVariable(R.p4,k);re instanceof c.H9&&ne instanceof c.yP&&(re.setState({filters:Z}),(0,h.z)("deployment_environment_migrated",{}),ne.setState({value:""}))}function K(k,_){return k&&Array.isArray(k)&&k.length>0&&k[0]!==""&&k.every(ee=>ee&&typeof ee=="string")&&k.forEach(ee=>{const J=ee.toString().split("|");_.push({key:J[0].toString(),operator:J[1].toString(),value:J[2].toString()})}),_}var V=e(99570),T=e(68612);class z extends c.Bs{constructor(_){super({$timeRange:_.$timeRange??new c.JZ({}),$variables:_.$variables??H(_.initialDS,_.metric,_.initialFilters,_.otelJoinQuery),controls:_.controls??[new c.K8({layout:"vertical"}),new c.N0,new c.KE({}),new c.WM({})],history:_.history??new v.LR({}),settings:_.settings??new C({}),createdAt:_.createdAt??new Date().getTime(),useOtelExperience:_.useOtelExperience??!1,otelJoinQuery:_.otelJoinQuery??"",showPreviews:_.showPreviews??!0,nativeHistograms:_.nativeHistograms??[],histogramsLoaded:_.histogramsLoaded??!1,nativeHistogramMetric:_.nativeHistogramMetric??"",..._}),this._urlSync=new c.So(this,{keys:["metric","metricSearch","showPreviews","nativeHistogramMetric"]}),this._variableDependency=new c.Sh(this,{variableNames:[R.EY,R.DU,R.Xt,R.mW],onReferencedVariableValueChanged:async ee=>{const{name:J}=ee.state;if(J===R.EY&&(this.datasourceHelper.reset(),this.resetNativeHistograms(),this.state.afterFirstOtelCheck&&(this.setState({initialOtelCheckComplete:!1}),this.resetOtelExperience()),this.checkDataSourceForOTelResources()),this.state.useOtelExperience&&J===R.DU&&this.state.initialOtelCheckComplete){const Z=this.state.$timeRange?.state,te=c.jh.interpolate(this,R.gR);Z&&(0,T.qJ)(this,te,Z)}}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new A.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const _=a.kM.getUrlSearchParams();N(this,_),this.state.topScene||this.setState({topScene:w(this.state.metric)}),this.subscribeToEvent(R.OO,this._handleMetricSelectedEvent.bind(this));const ee=c.jh.lookupVariable(R.Ao,this);ee instanceof c.H9&&this._subs.add(ee?.subscribeToState((ae,re)=>{this._addingFilterWithoutReportingInteraction||(0,h.h)(ae.filters,re.filters)}));const J=c.jh.lookupVariable(R.mW,this),Z=c.jh.lookupVariable(R.DU,this);J instanceof c.H9&&Z instanceof c.H9&&ee instanceof c.H9&&this._subs.add(J?.subscribeToState((ae,re)=>{if(this.state.useOtelExperience&&this.state.initialOtelCheckComplete&&!this.state.addingLabelFromBreakdown){const ne=this.state.nonPromotedOtelResources??[];(0,T.mc)(ae.filters,re.filters,ne,Z,ee)}}));const te=()=>{const ae=c.jh.lookupVariable(R.Ao,this),re=ae instanceof c.H9&&ae.state.filters.length>0;(this.state.metric||re)&&(0,S._r)().setRecentTrail(this)};return window.addEventListener("unload",te),()=>{this.state.embedded||te(),window.removeEventListener("unload",te)}}addFilterWithoutReportingInteraction(_){const ee=c.jh.lookupVariable("filters",this),J=c.jh.lookupVariable(R.mW,this);!(ee instanceof c.H9)||!(J instanceof c.H9)||(this._addingFilterWithoutReportingInteraction=!0,this.state.useOtelExperience?J.setState({filters:[...J.state.filters,_]}):ee.setState({filters:[...ee.state.filters,_]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(_){return this.datasourceHelper.getMetricMetadata(_)}isNativeHistogram(_){return this.datasourceHelper.isNativeHistogram(_)}async initializeHistograms(){this.state.histogramsLoaded||(await this.datasourceHelper.initializeHistograms(),this.setState({nativeHistograms:this.listNativeHistograms(),histogramsLoaded:!0}))}listNativeHistograms(){return this.datasourceHelper.listNativeHistograms()??[]}resetNativeHistograms(){this.setState({histogramsLoaded:!1,nativeHistograms:[]})}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(_){!_.topScene&&!_.metric&&(_.topScene=new p.t({})),this.setState(c.Go.cloneSceneObjectState(_,{history:this.state.history,metric:_.metric?_.metric:void 0,metricSearch:_.metricSearch?_.metricSearch:void 0,nativeHistogramMetric:_.nativeHistogramMetric?_.nativeHistogramMetric:void 0}));const ee=new c.g5().getUrlState(this),J=a.kM.renderUrl(x.Ny.getLocation().pathname,ee);x.Ny.replace(J)}async _handleMetricSelectedEvent(_){const ee=_.payload??"";this.state.useOtelExperience&&await(0,T.KO)(this,ee);let J=!1;this.isNativeHistogram(ee)&&(J=!0),this.setState(this.getSceneUpdatesForNewMetricValue(ee,J));const Z=c.jh.lookupVariable(R.Ao,this);Z instanceof c.H9&&Z.setState({baseFilters:X(_.payload)})}getSceneUpdatesForNewMetricValue(_,ee){const J={};return J.metric=_,J.nativeHistogramMetric=ee?"1":"",J.topScene=w(_,ee),J}getUrlState(){const{metric:_,metricSearch:ee,showPreviews:J,nativeHistogramMetric:Z}=this.state;return{metric:_,metricSearch:ee,showPreviews:J===!1?"false":null,nativeHistogramMetric:Z}}updateFromUrl(_){const ee={};if(typeof _.metric=="string"){if(this.state.metric!==_.metric){let J=!1;_.nativeHistogramMetric==="1"&&(J=!0),Object.assign(ee,this.getSceneUpdatesForNewMetricValue(_.metric,J))}}else _.metric==null&&(ee.metric=void 0,ee.topScene=new p.t({}));typeof _.metricSearch=="string"?ee.metricSearch=_.metricSearch:_.metric==null&&(ee.metricSearch=void 0),typeof _.showPreviews=="string"&&(ee.showPreviews=_.showPreviews!=="false"),this.setState(ee)}async checkDataSourceForOTelResources(){const _=(0,D.kj)(this),ee=_.state.$timeRange?.state;if(ee){const J=c.jh.interpolate(_,R.gR),Z=await(0,V.a8)(J,ee),te=await(0,V.wI)(J,ee,(0,u.f_)()),ae=Z.jobs.length>0&&Z.instances.length>0,re=c.jh.lookupVariable(R.mW,this);let ne=!1;re instanceof c.H9&&(ne=re.state.filters.length>0);const ce=await(0,V.hm)(J,ee);ae&&ce&&!this.state.startButtonClicked&&(ne||this.state.resettingOtel)?(0,T.qJ)(this,J,ee,te,ae,ce):this.resetOtelExperience(ae,ce)}}resetOtelExperience(_,ee){const J=c.jh.lookupVariable(R.DU,this),Z=c.jh.lookupVariable(R.Ao,this),te=c.jh.lookupVariable(R.mW,this),ae=c.jh.lookupVariable(R.Xt,this);J instanceof c.H9&&Z instanceof c.H9&&te instanceof c.H9&&ae instanceof c.x0&&(Z.setState({addFilterButtonText:"Add label",label:"Select label",hide:i.zL.hideLabel}),te.setState({filters:[],hide:i.zL.hideVariable}),J.setState({filters:[],defaultKeys:[],hide:i.zL.hideVariable}),ae.setState({value:""}),_&&ee?this.setState({hasOtelResources:_,isStandardOtel:ee.length>0,useOtelExperience:!1,otelTargets:{jobs:[],instances:[]},otelJoinQuery:"",afterFirstOtelCheck:!0,initialOtelCheckComplete:!0,isUpdatingOtel:!1}):this.setState({otelTargets:{jobs:[],instances:[]},otelJoinQuery:"",useOtelExperience:!1,afterFirstOtelCheck:!0,initialOtelCheckComplete:!0,isUpdatingOtel:!1}))}getQueries(){return c.jh.findAllObjects(this,ee=>ee instanceof c.dt).reduce((ee,J)=>(ee.push(...J.state.queries.map(Z=>({...Z,expr:c.jh.interpolate(J,Z.expr)}))),ee),[])}static{this.Component=({model:_})=>{const{controls:ee,topScene:J,history:Z,settings:te,useOtelExperience:ae,hasOtelResources:re,embedded:ne,histogramsLoaded:ce,nativeHistograms:le}=_.useState(),he=(0,s.k)(),oe=(0,d.of)(G,ne?0:he??0),de=(0,S._r)().recent.length<2;_.initializeHistograms(),(0,r.useEffect)(()=>{_.state.addingLabelFromBreakdown||(!ae&&_.state.afterFirstOtelCheck?_.resetOtelExperience():_.checkDataSourceForOTelResources())},[_,re,ae]),(0,r.useEffect)(()=>{const Pe=c.jh.lookupVariable(R.Ao,_),Ee=c.jh.lookupVariable(R.mW,_),be=ae?Ee:Pe,Se=_.datasourceHelper;(0,D.FG)(_,be,Se)},[_,ae]);const me=(0,r.useRef)(!1);return ae&&!me.current&&((0,h.z)("otel_experience_used",{}),me.current=!0),(0,t.jsxs)("div",{className:oe.container,children:[L({histogramsLoaded:ce,nativeHistograms:le,trail:_}),de&&(0,t.jsx)(b,{}),(0,t.jsx)(Z.Component,{model:Z}),ee&&(0,t.jsxs)("div",{className:oe.controls,children:[ee.map(Pe=>(0,t.jsx)(Pe.Component,{model:Pe},Pe.state.key)),(0,t.jsx)(te.Component,{model:te})]}),J&&(0,t.jsx)(c.$L,{scene:J,children:(0,t.jsx)("div",{className:oe.body,children:J&&(0,t.jsx)(J.Component,{model:J})})})]})}}}function w(k,_){return k?new f.R({metric:k,nativeHistogram:_??!1}):new p.t({})}function H(k,_,ee,J){return new c.Pj({variables:[new c.mI({name:R.EY,label:"Data source",description:"Only prometheus data sources are supported",value:k,pluginId:"prometheus"}),new c.H9({name:R.DU,label:"Select resource attributes",addFilterButtonText:"Select resource attributes",datasource:R.GH,hide:i.zL.hideVariable,layout:"combobox",defaultKeys:[],applyMode:"manual",allowCustomValue:!0}),new c.H9({name:R.Ao,addFilterButtonText:"Add label",datasource:R.GH,hide:i.zL.hideLabel,layout:"combobox",filters:ee??[],baseFilters:X(_),applyMode:"manual",allowCustomValue:!0,expressionBuilder:Z=>[...X(_),...Z].map(te=>`${te.key}${te.operator}"${te.value}"`).join(",")}),...(0,R.Mi)(J??""),new c.x0({name:R.lr,value:void 0,hide:i.zL.hideVariable}),new c.x0({name:R.jl,hide:i.zL.hideVariable,value:!1}),new c.H9({name:R.mW,addFilterButtonText:"Filter",datasource:R.GH,hide:i.zL.hideVariable,layout:"combobox",filters:ee??[],baseFilters:X(_),applyMode:"manual",allowCustomValue:!0}),new c.yP({name:R.p4,label:"Deployment environment",hide:i.zL.hideVariable,value:void 0,placeholder:"Select",isMulti:!0})]})}function G(k,_){return{container:(0,n.css)({flexGrow:1,display:"flex",gap:k.spacing(1),flexDirection:"column",background:k.isLight?k.colors.background.primary:k.colors.background.canvas,padding:k.spacing(2,3,2,3)}),body:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,n.css)({display:"flex",gap:k.spacing(1),padding:k.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:k.isDark?k.colors.background.canvas:k.colors.background.primary,zIndex:k.zIndex.navbarFixed,top:_})}}function X(k){return k?[{key:"__name__",operator:"=",value:k}]:[]}},60044:(q,j,e)=>{"use strict";e.d(j,{LR:()=>b,hi:()=>D});var t=e(74848),n=e(22803),r=e(96540),a=e(58064),i=e(55801),x=e(59577),s=e(32370),c=e(61034),d=e(48583),u=e(29675),g=e(6736),o=e(22492),E=e(91830),m=e(55522),f=e(73750),p=e(92986),h=e(56498);function D(I){return"currentStep"in I&&"steps"in I}function C(I){return!!I}const l=I=>typeof I=="string",v=" $2 ",y=/(\|)(=|=~|!=|>|<|!~)(\|)/g,P={start:"Start of history",metric:"Metric selected:",metric_page:"Metric select page",filters:"Filter applied:",time:"Time range changed:",dep_env:"Deployment environment selected:",resource:"Resource attribute selected:"};class b extends c.Bs{constructor(U){super({steps:U.steps??[],currentStep:U.currentStep??0,filtersApplied:[],otelResources:[],otelDepEnvs:[]}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const U=(0,h.kj)(this);if(this.state.steps.length===0)if(this.addTrailStep(U,"start"),U.state.metric){const{metric:W,...A}=U.state;A.topScene=(0,m.B)(void 0),this.state.steps[0].trailState=A,this.addTrailStep(U,"metric",U.state.metric)}else this.addTrailStep(U,"metric_page");U.subscribeToState((W,A)=>{W.metric!==A.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=c.Go.cloneSceneObjectState(A,{history:this})),W.metric?this.addTrailStep(U,"metric",W.metric):this.addTrailStep(U,"metric_page"))}),U.subscribeToEvent(c.oh,W=>{if(W.payload.state.name===p.Ao){const A=this.state.filtersApplied,N=c.Go.getUrlState(U);this.addTrailStep(U,"filters",M(N,A)),this.setState({filtersApplied:A})}if(W.payload.state.name===p.p4){const A=this.state.otelDepEnvs,N=c.Go.getUrlState(U);this.addTrailStep(U,"dep_env",R(N,A)),this.setState({otelDepEnvs:A})}if(W.payload.state.name===p.DU){const A=this.state.otelResources,N=c.Go.getUrlState(U);this.addTrailStep(U,"resource",O(N,A)),this.setState({otelResources:A})}}),U.subscribeToEvent(c.bZ,W=>{if(W.payload.changedObject instanceof c.JZ){const{prevState:A,newState:N}=W.payload;if((0,h.iG)(A)&&(0,h.iG)(N)){if(A.from===N.from&&A.to===N.to)return;const K=S({from:N.from,to:N.to,timeZone:N.timeZone});this.addTrailStep(U,"time",K),s.$.featureToggles.unifiedHistory&&o.l.publish(new E.sj({name:"Time range changed",description:K,url:window.location.href,time:Date.now()}))}}})}addTrailStep(U,W,A=""){if(this.stepTransitionInProgress)return;const N=this.state.steps.length,K=W==="start"?-1:this.state.currentStep;this.setState({currentStep:N,steps:[...this.state.steps,{type:W,detail:A,description:P[W],trailState:c.Go.cloneSceneObjectState(U.state,{history:this}),parentIndex:K}]})}addTrailStepFromStorage(U,W){if(this.stepTransitionInProgress)return;const A=W.type,N=this.state.steps.length,K=A==="start"?-1:this.state.currentStep,V=this.state.filtersApplied,T=this.state.otelResources,z=this.state.otelDepEnvs;let w="";switch(W.type){case"metric":w=W.urlValues.metric?.toString()??"";break;case"filters":w=M(W.urlValues,V);break;case"time":w=S(W.urlValues);break;case"dep_env":w=R(W.urlValues,z);case"resource":w=O(W.urlValues,T)}this.setState({filtersApplied:V,otelDepEnvs:z,otelResources:T,currentStep:N,steps:[...this.state.steps,{type:A,detail:w,description:P[A],trailState:c.Go.cloneSceneObjectState(U.state,{history:this}),parentIndex:K}]})}goBackToStep(U){if(U===this.state.currentStep)return;const W=this.state.steps[U],A=W.type==="metric"&&W.trailState.metric===void 0?"metric-clear":W.type;(0,f.z)("history_step_clicked",{type:A,step:U,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:U}),(0,h.kj)(this).restoreFromHistoryStep(W.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(U){return(0,t.jsxs)(d.B,{direction:"column",children:[(0,t.jsx)("div",{children:U.description}),U.detail!==""&&(0,t.jsx)("div",{children:U.detail})]})}static{this.Component=({model:U})=>{const{steps:W,currentStep:A}=U.useState(),N=(0,u.of)(L),{ancestry:K,alternatePredecessorStyle:V}=(0,r.useMemo)(()=>{const T=new Set;let z=A;for(;z>=0;){const H=W[z];if(!H)break;T.add(z),z=H.parentIndex}const w=new Map;return T.forEach(H=>{const G=W[H].parentIndex;G+1!==H&&w.set(H,F(H,G))}),{ancestry:T,alternatePredecessorStyle:w}},[A,W]);return(0,t.jsxs)("div",{className:N.container,children:[(0,t.jsx)("div",{className:N.heading,children:"History"}),W.map((T,z)=>{let w=T.type;return w==="metric"&&T.trailState.metric===void 0&&(w="start"),(0,t.jsx)(g.m,{content:()=>U.renderStepTooltip(T),children:(0,t.jsx)("button",{className:(0,n.cx)(N.step,N.stepTypes[w],A===z?N.stepSelected:"",V.get(z)??"",z!==T.parentIndex+1?N.stepOmitsDirectLeftLink:"",z===0?N.stepOmitsDirectLeftLink:"",K.has(z)?"":N.stepIsNotAncestorOfCurrent),onClick:()=>U.goBackToStep(z)})},z)})]})}}}function S(I){if(!(0,h.iG)(I))return"";const U=(0,x.convertRawToRange)({from:I.from,to:I.to}),W=l(I.timeZone)?I.timeZone:a.g$.localBrowserTime,A=(0,a.QZ)(W,Date.now()),N=U.from.subtract(A?.offsetInMins??0,"minute").format(i.G$),K=U.to.subtract(A?.offsetInMins??0,"minute").format(i.G$);return`${N} - ${K}`}function M(I,U){let W="";const A=I["var-filters"];return C(A)&&(W=A.filter(N=>N!==""&&!U.includes(N)?(U.push(N),!0):!1)[0]??""),W.replace(y,v)}function O(I,U){let W="";const A=I["var-otel_resources"];return C(A)&&(W=A.filter(N=>N!==""&&!U.includes(N)?(U.push(N),!0):!1)[0]??""),W.replace(y,v)}function R(I,U){let W="";const A=I["var-deployment_environment"];return typeof A=="string"?A:(C(A)&&(W=A?.filter(N=>N!==""&&!U.includes(N)?(U.push(N),!0):!1)[0]??""),W)}function L(I){const U=I.visualization;return{container:(0,n.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,n.css)({}),step:(0,n.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:I.shape.radius.circle,background:I.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:I.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,n.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${I.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,n.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,n.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:B(U.getColorByName("green")),filters:B(U.getColorByName("purple")),metric:B(U.getColorByName("orange")),metric_page:B(U.getColorByName("orange")),time:B(I.colors.primary.main),resource:B(U.getColorByName("purple")),dep_env:B(U.getColorByName("purple"))}}}function B(I){return(0,n.css)({background:I,"&:before":{background:I,borderColor:I},"&:after":{borderColor:I}})}function F(I,U){const N=(I-U)*18;return(0,n.css)({"&:before":{content:'""',width:N+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-N,background:"none"}})}},29088:(q,j,e)=>{"use strict";e.d(j,{G:()=>l});var t=e(74848),n=e(58820),r=e(61034),a=e(95536),i=e(2044),x=e(29012),s=e(99764),c=e(27323),d=e(92986);const u="grafana-explorations-app",g="grafana-explore-metrics/exploration/v1",o="add panel to exploration";class E extends r.Bs{constructor(S){super({...S,queries:[]}),this._onActivate=()=>{this._subs.add(this.subscribeToState(()=>{this.getQueries(),this.getContext()}));const M=r.jh.interpolate(this,d.gR);this.setState({dsUid:M})},this.getQueries=()=>{const M=r.jh.getData(this),O=r.jh.findObject(M,f);if(f(O)){const R=this.state.frame?m(this.state.frame):null,L=O.state.queries.map(B=>({...B,expr:r.jh.interpolate(O,B.expr),legendFormat:R?.name?`{{ ${R.name} }}`:r.jh.interpolate(O,B.legendFormat)}));JSON.stringify(L)!==JSON.stringify(this.state.queries)&&this.setState({queries:L})}},this.getContext=()=>{const{queries:M,dsUid:O,labelName:R,fieldName:L}=this.state,B=r.jh.getTimeRange(this);if(!B||!M||!O)return;const F={origin:"Metrics Drilldown",type:"timeseries",queries:M,timeRange:{...B.state.value},datasource:{uid:O},url:window.location.href,id:`${JSON.stringify(M)}${R}${L}`,title:`${R}${L?` > ${L}`:""}`,logoPath:c,drillDownLabel:L};JSON.stringify(F)!==JSON.stringify(this.state.context)&&this.setState({context:F})},this.addActivationHandler(this._onActivate.bind(this))}static{this.Component=({model:S})=>{const{context:M}=S.useState(),{links:O}=(0,x.U)({extensionPointId:g,context:M,limitPerPlugin:1}),R=O.find(L=>L.pluginId===u);return R?(0,t.jsx)(s.K,{tooltip:R.description,"aria-label":o,name:R.icon??"panel-add",onClick:L=>{R.onClick&&R.onClick(L)}},R.id):null}}}const m=b=>{const S=b.fields[1]?.labels??{},M=Object.keys(S);if(M.length!==1)return;const O=M[0];return{name:O,value:S[O]}};function f(b){return b instanceof r.dt}var p=e(56498);const h="Add to investigation",D="investigations_divider",C="Investigations";class l extends r.Bs{constructor(S){super({...S,addExplorationsLink:S.addExplorationsLink??!0}),this.addActivationHandler(()=>{let M;try{const L=r.jh.getAncestor(this,r.Eb),F=(0,i.un)(L)?.state.queries??[];F.forEach(A=>{delete A.legendFormat});const I=(0,p.kj)(this),U=(0,p.U4)(I),W=r.jh.getTimeRange(this);M=(0,a.Xe)({queries:F,dsRef:{uid:U},timeRange:W.state.value,scopedVars:{__sceneObject:{value:L}}})}catch{}const O=[{text:"Navigation",type:"group"},{text:"Explore",iconClassName:"compass",onClick:()=>M?.then(L=>L&&window.open(L,"_blank")),shortcut:"p x"}];this.setState({body:new r.Lw({items:O})});const R=new E({labelName:this.state.labelName,fieldName:this.state.fieldName,frame:this.state.frame});this._subs.add(R?.subscribeToState(()=>{P(this)})),this.setState({explorationsButton:R}),this.state.addExplorationsLink&&this.state.explorationsButton?.activate()})}addItem(S){this.state.body&&this.state.body.addItem(S)}setItems(S){this.state.body&&this.state.body.setItems(S)}static{this.Component=({model:S})=>{const{body:M}=S.useState();return M?(0,t.jsx)(M.Component,{model:M}):(0,t.jsx)(t.Fragment,{})}}}const v=b=>(0,n.Kf)({extensionPointId:g,context:b.state.context}).extensions[0],y=(b,S)=>{const M=v(S);M&&M.onClick&&M.onClick(b)};function P(b){const S=b.state.explorationsButton;if(S){const M=v(S),O=b.state.body?.state.items??[],R=O.find(L=>L.text===h);M&&(R?R&&b.state.body?.setItems(O.filter(L=>[D,C,h].includes(L.text)===!1)):(b.state.body?.addItem({text:D,type:"divider"}),b.state.body?.addItem({text:C,type:"group"}),b.state.body?.addItem({text:h,iconClassName:"plus-square",onClick:L=>y(L,S)})))}}},75637:(q,j,e)=>{"use strict";e.d(j,{k:()=>an,R:()=>zt});var t=e(74848),n=e(22803),r=e(32370),a=e(61034),i=e(29675),x=e(90231),s=e(48583),c=e(52120),d=e(79784),u=e(54594),g=e(10247),o=e(88849),E=e(6736),m=e(95536),f=e(33811);function p(){return new f.t({})}var h=e(10006),D=e(2543),C=e(96540),l=e(63739),v=e(23401),y=e(7500),P=e(86489),b=e(37e3),S=e(81876),M=e(11817),O=e(44826);function R({options:Ct,value:ut,onChange:Et}){const Ut=(0,i.of)(L);return(0,t.jsx)(O.l6,{options:Ct,value:ut,onChange:Wt=>Et(Wt.value),className:Ut.select})}function L(Ct){return{select:(0,n.css)({maxWidth:Ct.spacing(16)})}}var B=e(29088),F=e(48398),I=e(36890),U=e(73750),W=e(68612),A=e(5537);const N="$__all";var K=e(92986),V=e(56498);class T extends a.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(a.jh.lookupVariable("filters",this)instanceof a.H9))return;const Et=this.state.frame.fields[1]?.labels??{};if(Object.keys(Et).length!==1)return;const Ut=Object.keys(Et)[0];(0,U.z)("label_filter_changed",{label:Ut,action:"added",cause:"breakdown"});const Wt=(0,V.kj)(this),Vt=a.jh.lookupVariable(K.lr,Wt)?.getValue(),Ft={key:Ut,operator:"=",value:Et[Ut]};if(Vt&&typeof Vt=="string"&&Vt?.split(",").includes(Ut)){Wt.setState({addingLabelFromBreakdown:!0});const dn=a.jh.lookupVariable(K.DU,Wt),Cn=a.jh.lookupVariable(K.mW,Wt);if(!(dn instanceof a.H9&&Cn instanceof a.H9))return;dn.setState({filters:[...dn.state.filters,Ft]}),Cn.setState({filters:[...Cn.state.filters,Ft]}),Wt.setState({addingLabelFromBreakdown:!1})}else Wt.addFilterWithoutReportingInteraction(Ft)}}static{this.Component=({model:ut})=>{const Ut=ut.useState().frame.fields[1]?.labels||{};return Object.keys(Ut).length!==0?(0,t.jsx)(u.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ut.onClick,children:"Add to filters"}):null}}}var z=e(91733),w=e(8392);function H(Ct){const ut=Ct.fields[1]?.labels;if(!ut)return null;const Et=Object.keys(ut);return Et.length===0?null:ut[Et[0]]}var G=e(84139);const X=new G.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function k(Ct,ut,Et){const[Ut,Wt,gt]=X.search(Ct,ut,0,1e5);let Vt=[],Ft=new Set;if(Ut&&gt){const dn=(Cn,Un)=>{Un&&Ft.add(Cn)};for(let Cn=0;Cn<gt.length;Cn++){let Un=gt[Cn];G.A.highlight(Ct[Wt.idx[Un]],Wt.ranges[Un],dn),Vt.push(Ct[Wt.idx[Un]])}Et([Vt,[...Ft]])}else ut||Et([])}const _=(0,D.debounce)(k,300);var ee=e(91357),J=e(77230);const Z=(0,D.memoize)((Ct,ut,Et="asc")=>{if(ut==="alphabetical")return ne(Ct,"asc");if(ut==="alphabetical-reversed")return ne(Ct,"desc");ut==="outliers"&&te(Ct);const Ut=gt=>{try{if(ut==="outliers")return re(Ct,gt)}catch(dn){console.error(dn),ut=ee.gy.stdDev}return(ee.AS.get(ut).reduce?.(gt.fields[1],!0,!0)??(0,ee.H3)(gt.fields[1],!0,!0))[ut]??0},Wt=Ct.map(gt=>({value:Ut(gt),dataFrame:gt}));return Wt.sort((gt,Vt)=>gt.value!==void 0&&Vt.value!==void 0?Vt.value-gt.value:0),Et==="asc"&&Wt.reverse(),Wt.map(({dataFrame:gt})=>gt)},(Ct,ut,Et="asc")=>{const Ut=Ct.length>0?Ct[0].fields[0].values[0]:0,Wt=Ct.length>0?Ct[Ct.length-1].fields[0].values[Ct[Ct.length-1].fields[0].values.length-1]:0,gt=Ct.length>0?H(Ct[0]):"",Vt=Ct.length>0?H(Ct[Ct.length-1]):"";return`${gt}_${Vt}_${Ut}_${Wt}_${Ct.length}_${ut}_${Et}`}),te=Ct=>{if(!ce())return;const ut=(0,J.Fd)({frames:Ct});if(!ut)return;const Ut=ut.fields.filter(Wt=>Wt.type===l.PU.number).map(Wt=>new Float64Array(Wt.values));try{ae=h.hW.dbscan({sensitivity:.4}).preprocess(Ut).detect()}catch(Wt){console.error(Wt),ae=void 0}};let ae;const re=(Ct,ut)=>{if(!ce())throw new Error("WASM not supported, fall back to stdDev");if(!ae)throw new Error("Initialize outlier detector first");const Et=Ct.indexOf(ut);return ae.seriesResults[Et].isOutlier?-ae.seriesResults[Et].outlierIntervals.length:0},ne=(Ct,ut)=>{const Et=[...Ct];return Et.sort((Ut,Wt)=>{const gt=H(Ut),Vt=H(Wt);return!gt||!Vt?0:gt?.localeCompare(Vt)??0}),ut==="desc"&&Et.reverse(),Et},ce=()=>{const Ct=typeof WebAssembly=="object";return Ct||(0,U.z)("wasm_not_supported",{}),Ct};function le(Ct,ut){const Et=a.jh.lookupVariable(K.Ao,Ct),Ut=[];if(!(Et instanceof a.H9))return[];const Wt=Et.state.filters;for(const gt of ut.getOptionsForSelect()){const Vt=Wt.find(Ft=>Ft.key===gt.value);gt.label!=="le"&&(Vt||Ut.push({label:gt.label,value:String(gt.value)}))}return Ut}function he(Ct,ut){const Et=sceneGraph.findObject(Ct,Ut=>Ut instanceof ut);return Et instanceof ut?Et:null}function oe(Ct,ut){function Et(Wt){return Wt instanceof ut}return a.jh.findAllObjects(Ct,Et).filter(Et)}class de extends a.Bs{constructor({sortBy:ut,getFilter:Et,...Ut}){super(Ut),this.unfilteredChildren=[],this.sortedSeries=[],this.sort=Wt=>{const gt=a.jh.getData(this);this.sortBy=Wt,gt.state.data&&this.performRepeat(gt.state.data)},this.filterByString=Wt=>{let gt=[];this.iterateFrames((Vt,Ft)=>{const dn=Ee(Vt[Ft]);gt.push(dn)}),k(gt,Wt,Vt=>{Vt&&Vt[0]?this.filterFrames(Ft=>{const dn=Ee(Ft);return Vt[0].includes(dn)}):this.filterFrames(()=>!0)})},this.iterateFrames=Wt=>{if(a.jh.getData(this).state.data)for(let Vt=0;Vt<this.sortedSeries.length;Vt++)Wt(this.sortedSeries,Vt)},this.filterFrames=Wt=>{const gt=[];this.iterateFrames((Vt,Ft)=>{Wt(Vt[Ft])&&gt.push(this.unfilteredChildren[Ft])}),gt.length===0?this.state.body.setState({children:[me(this.getFilter(),this.clearFilter)]}):this.state.body.setState({children:gt})},this.clearFilter=()=>{this.publishEvent(new Qe,!0)},this.sortBy=ut,this.getFilter=Et,this.addActivationHandler(()=>{const Wt=a.jh.getData(this);this._subs.add(Wt.subscribeToState((gt,Vt)=>{if(gt.data===void 0)return;const Ft=gt.data;gt.data?.state!==Vt.data?.state&&oe(this,a.Zv).forEach(dn=>{dn.setState({data:{...dn.state.data,state:Ft.state}})}),Ft.state===w.Gu.Done&&this.performRepeat(Ft)})),Wt.state.data&&this.performRepeat(Wt.state.data)})}performRepeat(ut){const Et=[],Ut=Z(ut.series,this.sortBy);for(let Wt=0;Wt<Ut.length;Wt++){const gt=this.state.getLayoutChild(ut,Ut[Wt],Wt);Et.push(gt)}this.sortedSeries=Ut,this.unfilteredChildren=Et,this.getFilter()?(this.state.body.setState({children:[]}),this.filterByString(this.getFilter())):this.state.body.setState({children:Et})}static{this.Component=({model:ut})=>{const{body:Et}=ut.useState();return(0,t.jsx)(Et.Component,{model:Et})}}}function me(Ct,ut){return new a.G1({direction:"row",children:[new a.vA({body:new a.dM({reactNode:(0,t.jsx)("div",{className:Pe.alertContainer,children:(0,t.jsxs)(b.F,{title:"",severity:"info",className:Pe.noResultsAlert,children:[(0,t.jsxs)(M.x6,{i18nKey:"explore-metrics.breakdown.noMatchingValue",children:["No values found matching; ",{filter:Ct}]}),(0,t.jsx)(u.$n,{className:Pe.clearButton,onClick:ut,children:(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.breakdown.clearFilter",children:"Clear filter"})})]})})})})]})}const Pe={alertContainer:(0,n.css)({flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"}),noResultsAlert:(0,n.css)({minWidth:"30vw",flexGrow:0}),clearButton:(0,n.css)({marginLeft:"1.5rem"})};function Ee(Ct){return H(Ct)??"No labels"}var be=e(34128);const Se=({value:Ct,onChange:ut,placeholder:Et,onClear:Ut,...Wt})=>(0,t.jsx)(be.p,{value:Ct,onChange:ut,suffix:Ct?(0,t.jsx)(d.I,{onClick:Ut,title:"Clear search",name:"times",className:Xe.clearIcon}):void 0,prefix:(0,t.jsx)(d.I,{name:"search"}),placeholder:Et,...Wt}),Xe={clearIcon:(0,n.css)({cursor:"pointer"})};class Qe extends z.a{static{this.type="breakdown-search-reset"}}const we={};class $e extends a.Bs{constructor(ut){super({filter:we[ut]??""}),this.onValueFilterChange=Et=>{this.setState({filter:Et.target.value}),this.filterValues(Et.target.value)},this.clearValueFilter=()=>{this.setState({filter:""}),this.filterValues("")},this.reset=()=>{this.setState({filter:""}),we[this.cacheKey]=""},this.cacheKey=ut}static{this.Component=({model:ut})=>{const{filter:Et}=ut.useState();return(0,t.jsx)(Se,{value:Et,onChange:ut.onValueFilterChange,onClear:ut.clearValueFilter,placeholder:"Search for value"})}}filterValues(ut){this.parent instanceof fe&&(we[this.cacheKey]=ut,this.parent.state.body?.forEachChild(Ut=>{Ut instanceof de&&Ut.state.body.isActive&&Ut.filterByString(ut)}))}}var Fe=e(60641);const Te=["single","grid","rows"];function Le(Ct){return Te.includes(Ct)}class Ge extends a.Bs{constructor(ut){const Et=(0,A.Hy)();super({activeBreakdownLayout:Le(Et)?Et:"grid",...ut}),this._urlSync=new a.So(this,{keys:["breakdownLayout"]}),this.onLayoutChange=Ut=>{this.state.activeBreakdownLayout!==Ut&&((0,U.z)("breakdown_layout_changed",{layout:Ut}),(0,A.HU)(Ut),this.setState({activeBreakdownLayout:Ut}),this.state.onBreakdownLayoutChange(Ut))}}getUrlState(){return{breakdownLayout:this.state.activeBreakdownLayout}}updateFromUrl(ut){const Et=ut.breakdownLayout;typeof Et=="string"&&Le(Et)&&this.state.activeBreakdownLayout!==Et&&this.setState({activeBreakdownLayout:Et})}Selector({model:ut}){const{activeBreakdownLayout:Et,breakdownLayoutOptions:Ut}=ut.useState();return(0,t.jsx)(Fe.z,{options:Ut,value:Et,onChange:ut.onLayoutChange})}static{this.Component=({model:ut})=>{const{breakdownLayouts:Et,breakdownLayoutOptions:Ut,activeBreakdownLayout:Wt}=ut.useState(),gt=Ut.findIndex(Ft=>Ft.value===Wt);if(gt===-1)return null;const Vt=Et[gt];return(0,t.jsx)(Vt.Component,{model:Vt})}}}var Me=e(99764);class De extends z.a{constructor(ut,Et){super(),this.target=ut,this.sortBy=Et}static{this.type="sort-criteria-changed"}}class Ke extends a.Bs{constructor(ut){const{sortBy:Et}=(0,A.vs)(ut.target,"outliers");super({target:ut.target,sortBy:Et}),this.sortingOptions=[{label:"",options:[{value:"outliers",label:"Outlying series",description:"Prioritizes values that show distinct behavior from others within the same label"},{value:"alphabetical",label:"Name [A-Z]",description:"Alphabetical order"},{value:"alphabetical-reversed",label:"Name [Z-A]",description:"Reversed alphabetical order"}]}],this.onCriteriaChange=Ut=>{Ut.value&&(this.setState({sortBy:Ut.value}),(0,A.fq)(this.state.target,Ut.value),this.publishEvent(new De(this.state.target,Ut.value),!0))}}static{this.Component=({model:ut})=>{const Et=(0,i.of)(Ie),{sortBy:Ut}=ut.useState(),gt=ut.sortingOptions.find(Vt=>Vt.options.find(Ft=>Ft.value===Ut))?.options.find(Vt=>Vt.value===Ut);return(0,t.jsx)(P.D,{htmlFor:"sort-by-criteria",label:(0,t.jsxs)("div",{className:Et.sortByTooltip,children:[(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.breakdown.sortBy",children:"Sort by"}),(0,t.jsx)(Me.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:"Sorts values using standard or smart time series calculations."})]}),children:(0,t.jsx)(O.l6,{value:gt,width:20,isSearchable:!0,options:ut.sortingOptions,placeholder:"Choose criteria",onChange:ut.onCriteriaChange,inputId:"sort-by-criteria"})})}}}function Ie(Ct){return{sortByTooltip:(0,n.css)({display:"flex",gap:Ct.spacing(1)})}}class Ne extends z.x{static{this.type="selected-metric-query-results-event"}}const ie=Ct=>{const ut=a.jh.getAncestor(Ct,fe);oe(Ct,a.Eb).forEach(Wt=>{Wt.isActive?Et(Wt.state.$data):Wt.addActivationHandler(()=>{Et(Wt.state.$data)})}),oe(Ct,a.Eb).forEach(Wt=>Et(Wt.state.$data));function Et(Wt){Wt&&(Wt.isActive||Wt.addActivationHandler(()=>{Et(Wt)}),Wt.state.data&&ut.reportBreakdownPanelData(Wt.state.data),Wt.subscribeToState(({data:gt},Vt)=>{ut.reportBreakdownPanelData(gt)}))}const Ut=ut.subscribeToEvent(Ne,Wt=>{if(!Ct.isActive){Ut.unsubscribe();return}const gt=a.No.timeseries().setCustomFieldConfig("axisSoftMin",Wt.payload.min).setCustomFieldConfig("axisSoftMax",Wt.payload.max).build();oe(Ct,a.Eb).forEach(Vt=>{function Ft(){Vt.onFieldConfigChange(gt)}Vt.isActive?Ft():Vt.addActivationHandler(Ft)})})},ve=60;class fe extends a.Bs{constructor(ut){super({...ut,labels:ut.labels??[],sortBy:new Ke({target:"labels"}),search:new $e("labels")}),this._variableDependency=new a.Sh(this,{variableNames:[K.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,D.throttle)(()=>{const{breakdownPanelMinValue:Et,breakdownPanelMaxValue:Ut}=this;Et!==void 0&&Ut!==void 0&&this.publishEvent(new Ne({min:Et,max:Ut}))},1e3),this.handleSortByChange=Et=>{Et.target==="labels"&&(this.state.body instanceof Ge&&this.state.body.state.breakdownLayouts.forEach(Ut=>{Ut instanceof de&&Ut.sort(Et.sortBy)}),(0,U.z)("sorting_changed",{sortBy:Et.sortBy}))},this.onBreakdownLayoutChange=Et=>{this.clearBreakdownPanelAxisValues()},this.onChange=Et=>{if(!Et)return;(0,U.z)("label_selected",{label:Et,cause:"selector"}),this.getVariable().changeValueTo(Et)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){(0,h.Ay)().then(()=>console.debug("Grafana ML initialized"));const ut=this.getVariable();r.$.featureToggles.enableScopesInMetricsExplore&&this._subs.add(this.subscribeToEvent(K.H0,()=>{this.updateBody(this.getVariable())})),ut.subscribeToState((Vt,Ft)=>{(Vt.options!==Ft.options||Vt.value!==Ft.value||Vt.loading!==Ft.loading)&&this.updateBody(ut)}),this._subs.add(this.subscribeToEvent(Qe,()=>{this.state.search.clearValueFilter()})),this._subs.add(this.subscribeToEvent(De,this.handleSortByChange));const Ut=a.jh.getAncestor(this,zt).state.metric;this._query=(0,I.v)(Ut).breakdown;const Wt=(0,V.kj)(this);Wt.state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),this._subs.add(Wt.subscribeToState(({useOtelExperience:Vt},Ft)=>{Vt!==Ft.useOtelExperience&&this.updateBody(ut)}));const gt=a.jh.lookupVariable(K.lr,Wt);gt instanceof a.x0&&gt?.subscribeToState((Vt,Ft)=>{Vt.value!==Ft.value&&this.updateBody(ut)}),this.updateBody(ut)}reportBreakdownPanelData(ut){if(!ut)return;let Et=this.breakdownPanelMinValue,Ut=this.breakdownPanelMaxValue;ut.series.forEach(Wt=>{Wt.fields.forEach(gt=>{if(gt.type!==l.PU.number)return;const Vt=gt.values.filter(D.isNumber),Ft=(0,D.max)(Vt),dn=(0,D.min)(Vt);Ut=(0,D.max)([Ut,Ft].filter(D.isNumber)),Et=(0,D.min)([Et,dn].filter(D.isNumber))})}),!(Ut===void 0||Et===void 0||!Number.isFinite(Ut+Et))&&(this.breakdownPanelMaxValue===Ut&&this.breakdownPanelMinValue===Et||(this.breakdownPanelMaxValue=Ut,this.breakdownPanelMinValue=Et,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const ut=a.jh.lookupVariable(K.yr,this);if(!(ut instanceof a.fS))throw new Error("Group by variable not found");return ut}onReferencedVariableValueChanged(){const ut=this.getVariable();ut.changeValueTo(N),this.updateBody(ut)}updateBody(ut){const Et=le(this,ut),Ut=(0,V.kj)(this);let Wt=Et;Ut.state.useOtelExperience&&(Wt=this.updateLabelOptions(Ut,Wt));const gt={loading:ut.state.loading,value:String(ut.state.value),labels:Wt,error:ut.state.error,blockingMessage:void 0};!ut.state.loading&&ut.state.options.length?gt.body=ut.hasAllValue()?xe(Wt,this._query,this.onBreakdownLayoutChange,Ut.state.useOtelExperience):Ve(this._query,this.onBreakdownLayoutChange,this.state.search):ut.state.loading||(gt.body=void 0,gt.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(gt)}async updateOtelGroupLeft(){const ut=(0,V.kj)(this);ut.state.useOtelExperience&&await(0,W.KO)(ut,ut.state.metric??"")}updateLabelOptions(ut,Et){const Ut=a.jh.lookupVariable(K.lr,ut)?.getValue();if(typeof Ut!="string")return[];const Wt=Ut.split(",").map(Ft=>{let dn=Ft;return(0,v.Rq)(Ft)||(dn=Ft.slice(1,-1)),{label:dn,value:Ft}}),Vt=[{label:"All",value:N}].concat(Wt);return Et=Et.filter(Ft=>Ft.value!==N),Et=Vt.concat(Et),Et}static{this.Component=({model:ut})=>{const{labels:Et,body:Ut,search:Wt,sortBy:gt,loading:Vt,value:Ft,blockingMessage:dn}=ut.useState(),Cn=(0,i.of)(ge),Un=(0,V.kj)(ut),{useOtelExperience:ts}=Un.useState();let ms=Et;if(Un.state.useOtelExperience){const ct=[{label:"All",value:N}];ms.filter(ft=>ft.value!==N).unshift(ct)}const[us,Yt]=(0,C.useState)(!1),ot=a.jh.lookupVariable(K.jl,Un)?.getValue();return ot&&!us&&(0,U.z)("missing_otel_labels_by_truncating_job_and_instance",{metric:Un.state.metric}),(0,C.useEffect)(()=>{ts&&ut.updateOtelGroupLeft()},[ut,ts]),(0,t.jsx)("div",{className:Cn.container,children:(0,t.jsxs)(F.O,{isLoading:Vt,blockingMessage:dn,children:[(0,t.jsxs)("div",{className:Cn.controls,children:[!Vt&&Et.length&&(0,t.jsx)(P.D,{label:ts?"By attribute":"By label",children:(0,t.jsx)(R,{options:ms,value:Ft,onChange:ut.onChange})}),Ft!==N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.D,{label:"Search",className:Cn.searchField,children:(0,t.jsx)(Wt.Component,{model:Wt})}),(0,t.jsx)(gt.Component,{model:gt})]}),Ut instanceof Ge&&(0,t.jsx)(P.D,{label:"View",children:(0,t.jsx)(Ut.Selector,{model:Ut})})]}),ot&&!us&&(0,t.jsx)(b.F,{title:"Warning: There may be missing Open Telemetry resource attributes.",severity:"warning",onRemove:()=>Yt(!0),className:Cn.truncatedOTelResources,children:(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.breakdown.missing-otel-labels",children:"This metric has too many job and instance label values to call the Prometheus label_values endpoint with the match[] parameter. These label values are used to join the metric with target_info, which contains the resource attributes. Please include more resource attributes filters."})},"warning"),(0,t.jsx)("div",{className:Cn.content,children:Ut&&(0,t.jsx)(Ut.Component,{model:Ut})})]})})}}}function ge(Ct){return{container:(0,n.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingTop:Ct.spacing(1)}),content:(0,n.css)({flexGrow:1,display:"flex",paddingTop:Ct.spacing(0)}),searchField:(0,n.css)({flexGrow:1}),controls:(0,n.css)({flexGrow:0,display:"flex",alignItems:"flex-end",gap:Ct.spacing(2),justifyContent:"space-between"}),truncatedOTelResources:(0,n.css)({minWidth:"30vw",flexGrow:0})}}function xe(Ct,ut,Et,Ut){const Wt=[];for(const gt of Ct){if(gt.value===N)continue;if(Wt.length===ve)break;const Vt=ut.queries[0].expr.replaceAll(K.aZ,(0,v.Nc)(String(gt.value))),Ft=ut.unit,dn=a.d0.timeseries().setOption("tooltip",{mode:y.$N.Multi,sort:y.xB.Descending}).setOption("legend",{showLegend:!1}).setTitle(gt.label).setData(new a.dt({maxDataPoints:K.up,datasource:K.GH,queries:[{refId:`A-${gt.label}`,expr:Vt,legendFormat:`{{${gt.label}}}`,fromExploreMetrics:!0}]})).setHeaderActions([new nt({labelName:String(gt.value)})]).setShowMenuAlways(!0).setMenu(new B.G({labelName:String(gt.value)})).setUnit(Ft).setBehaviors([Be]).build();Wt.push(new a.xK({$behaviors:[ie],body:dn}))}return new Ge({breakdownLayoutOptions:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],onBreakdownLayoutChange:Et,breakdownLayouts:[new a.gF({templateColumns:je,autoRows:"200px",children:Wt,isLazy:!0}),new a.gF({templateColumns:"1fr",autoRows:"200px",children:Wt.map(gt=>gt.clone()),isLazy:!0})]})}const je="repeat(auto-fit, minmax(400px, 1fr))";function Ve(Ct,ut,Et){const Ut=Ct.unit;function Wt(Ft,dn,Cn){const Un=Ct.vizBuilder().setTitle(ke(dn)).setData(new a.Zv({data:{...Ft,series:[dn]}})).setColor({mode:"fixed",fixedColor:(0,V.Vy)(Cn)}).setHeaderActions([new T({frame:dn})]).setShowMenuAlways(!0).setMenu(new B.G({labelName:ke(dn)})).setUnit(Ut).build(),ts=dn.length<=1;return new a.xK({$behaviors:[ie],body:Un,isHidden:ts})}const{sortBy:gt}=(0,A.vs)("labels","outliers"),Vt=()=>Et.state.filter??"";return new Ge({$data:new a.dt({datasource:K.GH,maxDataPoints:K.up,queries:Ct.queries}),breakdownLayoutOptions:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],onBreakdownLayoutChange:ut,breakdownLayouts:[new a.G1({direction:"column",children:[new a.vA({minHeight:300,body:a.d0.timeseries().setOption("tooltip",{mode:y.$N.Multi,sort:y.xB.Descending}).setOption("legend",{showLegend:!1}).setTitle("$metric").build()})]}),new de({body:new a.gF({templateColumns:je,autoRows:"200px",children:[new a.vA({body:new a.dM({reactNode:(0,t.jsx)(S._,{text:"Loading..."})})})]}),getLayoutChild:Wt,sortBy:gt,getFilter:Vt}),new de({body:new a.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:Wt,sortBy:gt,getFilter:Vt})]})}function ke(Ct){const ut=Ct.fields[1]?.labels||{},Et=Object.keys(ut);return Et.length===0?"<unspecified>":ut[Et[0]]}function Oe(){return new fe({})}class nt extends a.Bs{constructor(){super(...arguments),this.onClick=()=>{const ut=this.state.labelName,Et=(0,V.kj)(this),Ut=a.jh.lookupVariable(K.lr,Et)?.getValue();let Wt=!1;typeof Ut=="string"&&(Wt=Ut?.split(",").includes(ut)),(0,U.z)("label_selected",{label:ut,cause:"breakdown_panel",otel_resource_attribute:Wt}),Je(this).onChange(ut)}}static{this.Component=({model:ut})=>(0,t.jsx)(u.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ut.onClick,children:(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.breakdown.labelSelect",children:"Select"})})}}function Je(Ct){if(Ct instanceof fe)return Ct;if(Ct.parent)return Je(Ct.parent);throw new Error("Unable to find breakdown scene")}function Be(Ct){Ct.state.$data?.subscribeToState((ut,Et)=>{const Ut=ut.data?.request?.targets[0];if(Ze(Ut)){const{legendFormat:Wt}=Ut,gt=Wt.slice(2,-2);ut.data?.series.forEach(Vt=>{if(!Vt.fields[1].labels?.[gt]){const Ft=Vt.fields[1].labels;Ft&&(Ft[gt]=`<unspecified ${gt}>`)}})}})}function Ze(Ct){return Ct!==void 0&&"legendFormat"in Ct&&typeof Ct.legendFormat=="string"}var tt=e(74958),Re=e(57862),at=e(48516);class yt extends a.Bs{constructor(ut){super(ut),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const{autoQuery:ut}=(0,V.aM)(this).state;ut.variants.length!==0&&this.setState({options:ut.variants.map(Et=>({label:Et.variant,value:Et.variant}))})}static{this.Component=({model:ut})=>{const{options:Et,onChangeQuery:Ut,queryDef:Wt}=ut.useState();return Et?(0,t.jsx)(Fe.z,{size:"sm",options:Et,value:Wt.variant,onChange:Ut}):null}}}class ze extends a.Bs{constructor(ut){super(ut),this.onChangeQuery=Et=>{const Ut=(0,V.aM)(this),Wt=Ut.state.autoQuery.variants.find(gt=>gt.variant===Et);this.getVizPanelFor(Wt).then(gt=>this.setState({panel:gt})),Ut.setState({queryDef:Wt})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:ut,metric:Et}=(0,V.aM)(this).state;this.getVizPanelFor(ut.main,Et).then(Ut=>this.setState({panel:Ut,metric:Et}))}}async getVizPanelFor(ut,Et){const Wt=await(0,V.kj)(this).getMetricMetadata(Et),gt=(0,at.R)(Wt);return ut.vizBuilder().setData(new a.dt({datasource:K.GH,maxDataPoints:K.dc,queries:ut.queries})).setDescription(gt).setHeaderActions([new yt({queryDef:ut,onChangeQuery:this.onChangeQuery})]).setShowMenuAlways(!0).setMenu(new B.G({labelName:Et??this.state.metric})).build()}static{this.Component=({model:ut})=>{const{panel:Et}=ut.useState();if(Et)return(0,t.jsx)(Et.Component,{model:Et})}}}const st=280,ht="40%";class It extends a.Bs{constructor(ut){super({topView:ut.topView??un(),...ut})}static{this.Component=({model:ut})=>{const{topView:Et,selectedTab:Ut}=ut.useState(),{stickyMainGraph:Wt}=(0,V.KE)(ut).useState(),gt=(0,Re.k)(),Vt=(0,V.kj)(ut),Ft=(0,i.of)(Gt,Vt.state.embedded?0:gt??0);return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Wt?Ft.sticky:Ft.nonSticky,children:(0,t.jsx)(Et.Component,{model:Et})}),Ut&&(0,t.jsx)(Ut.Component,{model:Ut})]})}}}function Gt(Ct,ut){return{container:(0,n.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,n.css)({display:"flex",flexDirection:"row",background:Ct.isLight?Ct.colors.background.primary:Ct.colors.background.canvas,position:"sticky",paddingTop:Ct.spacing(1),marginTop:`-${Ct.spacing(1)}`,top:`${ut+70}px`,zIndex:10}),nonSticky:(0,n.css)({display:"flex",flexDirection:"row"})}}function un(){return new a.G1({direction:"column",$behaviors:[new a.Gg.K2({key:"metricCrosshairSync",sync:tt.y.Crosshair})],children:[new a.vA({minHeight:st,maxHeight:ht,body:new ze({})}),new a.vA({ySizing:"content",body:new an({})})]})}var vn=e(98437),pn=e(28082);function xn(Ct){return Ct}const cn={job:"service_name",instance:"service_instance_id"};function jn(Ct){return Ct in cn}function _n(Ct){return jn(Ct)?cn[Ct]:Ct}async function Ot(Ct,ut,Et){const Ut=await(0,vn.l)().get(Ct),Wt=await Ut.getTagKeys?.({timeRange:Et,filters:ut.map(({key:Cn,operator:Un,value:ts})=>({key:_n(Cn),operator:Un,value:ts}))});if(!Array.isArray(Wt))return!1;const gt=new Set(Wt.map(Cn=>Cn.text));return ut.map(Cn=>_n(Cn.key)).every(Cn=>gt.has(Cn))?(await Promise.all(ut.map(async Cn=>{const Un=_n(Cn.key),ts=await Ut.getTagValues?.({key:Un,timeRange:Et,filters:ut});return Array.isArray(ts)?ts.some(ms=>ms.text===Cn.value):!1}))).every(Boolean):!1}const Rt=Ct=>({name:"labelsCrossReference",async getDataSources(){const ut=(0,V.kj)(Ct),Et=a.jh.lookupVariable(K.Ao,ut);if(!(0,V.Uk)(Et)||!Et.state.filters.length)return[];const Ut=Et.state.filters.map(({key:Ft,operator:dn,value:Cn})=>({key:Ft,operator:dn,value:Cn})),Wt=Ct.state.$timeRange?.state.value,gt=await on();return(await Promise.all(gt.map(async({uid:Ft,name:dn})=>await Ot(Ft,Ut,Wt)?{uid:Ft,name:dn}:null))).filter(Ft=>Ft!==null)},getLokiQueryExpr(){const ut=(0,V.kj)(Ct),Et=a.jh.lookupVariable(K.Ao,ut);return!(0,V.Uk)(Et)||!Et.state.filters.length?"":`{${Et.state.filters.map(Wt=>`${_n(Wt.key)}${Wt.operator}"${Wt.value}"`).join(",")}}`}});var Ye=e(75505),dt=e(36745);async function lt(Ct){const Et={url:`api/prometheus/${Ct.uid}/api/v1/rules`,showErrorAlert:!1,showSuccessAlert:!1},Ut=await(0,Ye.s)((0,pn.AI)().fetch(Et));return Ut.ok?Ut.data.data.groups:(console.warn(`Failed to fetch recording rules from Loki data source: ${Ct.name}`),[])}function Pt(Ct,ut){if(Ct.length===0)return[];const Et=new Map;return Ct.forEach(Ut=>{Ut.rules.filter(Wt=>Wt.type==="recording").forEach(({type:Wt,name:gt,query:Vt})=>{if(Et.has(gt)){const dn=Et.get(gt);dn&&(dn.hasMultipleOccurrences=!0,Et.set(gt,dn))}else Et.set(gt,{type:Wt,name:gt,query:Vt,datasource:{name:ut.name,uid:ut.uid},hasMultipleOccurrences:!1})})}),Array.from(Et.values())}function Bt(Ct,ut){const Et=[];return Object.values(ut).forEach(Ut=>{Ut.filter(Wt=>Wt.name===Ct).forEach(Wt=>{Et.push(Wt.datasource)})}),Et}function Jt(Ct,ut,Et){if(!ut||!Et[ut])return"";const Ut=Et[ut].find(gt=>gt.name===Ct);return Ut?(0,dt.OT)(Ut.query):""}async function qt(){const Ct=await on(),ut={};return await Promise.all(Ct.map(async Et=>{try{const Ut=await lt(Et),Wt=Pt(Ut,Et);ut[Et.uid]=Wt}catch(Ut){console.warn(Ut)}})),ut}const On=(()=>{let Ct={};return{name:"lokiRecordingRules",async getDataSources(ut){return Ct=await qt(),Bt(ut,Ct)},getLokiQueryExpr(ut,Et){return Jt(ut,Et,Ct)}}})();var Tn=e(45565),wn=e(54731);class ps extends a.Bs{static{this.Component=()=>{const ut=(0,i.of)(es);return(0,t.jsxs)(s.B,{direction:"column",gap:1,children:[(0,t.jsx)(Tn.E,{color:"warning",children:(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.related-logs.warnExperimentalFeature",children:"Related logs is an experimental feature."})}),(0,t.jsx)(Tn.E,{children:(0,t.jsxs)(M.x6,{i18nKey:"explore-metrics.related-logs.relatedLogsUnavailable",children:["No related logs found. To see related logs, you can either:",(0,t.jsxs)("ul",{className:ut.list,children:[(0,t.jsx)("li",{children:"adjust the label filter to find logs with the same labels as the currently-selected metric"}),(0,t.jsxs)("li",{children:["select a metric created by a"," ",(0,t.jsx)(wn.Y,{external:!0,href:"https://grafana.com/docs/loki/latest/alert/#recording-rules",children:(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.related-logs.LrrDocsLink",children:"Loki Recording Rule"})})]})]})]})})]})}}}function es(Ct){return{list:(0,n.css)({paddingLeft:Ct.spacing(2)})}}const ls="related_logs/logs_panel_container",Lt="related_logs/logs_query";class $t extends a.Bs{constructor(ut){super({controls:[],body:new a.G1({direction:"column",height:"400px",children:[new a.vA({key:ls,body:void 0})]}),connectors:[],...ut}),this._variableDependency=new a.Sh(this,{variableNames:[K.Az,K.Ao],onReferencedVariableValueChanged:Et=>{const{name:Ut}=Et.state;Ut===K.Az&&this.updateLokiQuery(),Ut===K.Ao&&this.setLogsDataSourceVar().then(()=>this.updateLokiQuery())}}),this.addActivationHandler(this.onActivate.bind(this))}onActivate(){this.setState({connectors:[On,Rt(this)]}),this.setLogsDataSourceVar()}setLogsDataSourceVar(){const ut=a.jh.interpolate(this,K.Rp);return Promise.all(this.state.connectors.map(Et=>Et.getDataSources(ut))).then(Et=>{const Ut=Et.flat().slice(0,10),Wt=a.jh.findByKeyAndType(this,ls,a.vA);Ut?.length?(Wt.setState({body:a.d0.logs().setTitle("Logs").setData(new a.dt({datasource:{uid:K.Kf},queries:[],key:Lt})).build()}),this.setState({$variables:new a.Pj({variables:[new a.yP({name:K.Az,label:"Logs data source",query:Ut?.map(gt=>`${gt.name} : ${gt.uid}`).join(",")})]}),controls:[new a.K8({layout:"vertical"})]})):(Wt.setState({body:new ps({})}),this.setState({$variables:void 0,controls:void 0}))})}updateLokiQuery(){const ut=a.jh.lookupVariable(K.Az,this),Et=a.jh.lookupVariable(K.PU,this);if(!(0,V.UG)(ut)||!(0,V.DJ)(Et))return;const Ut=Et.getValue(),Wt=ut.getValue();if(typeof Ut!="string"||typeof Wt!="string")return;const gt=this.state.connectors.reduce((Ft,dn,Cn)=>{const Un=dn.getLokiQueryExpr(Ut,Wt);return Un&&(Ft[dn.name??`connector-${Cn}`]=Un),Ft},{});a.jh.findByKeyAndType(this,Lt,a.dt).setState({queries:Object.keys(gt).map(Ft=>({refId:`RelatedLogs-${Ft}`,expr:gt[Ft],maxLines:100}))})}static{this.Component=({model:ut})=>{const{controls:Et,body:Ut}=ut.useState();return(0,t.jsx)("div",{children:(0,t.jsxs)(s.B,{gap:1,direction:"column",grow:1,children:[(0,t.jsxs)(s.B,{gap:1,direction:"row",grow:1,justifyContent:"space-between",alignItems:"start",children:[(0,t.jsx)(s.B,{gap:1,children:Et?.map(Wt=>(0,t.jsx)(Wt.Component,{model:Wt},Wt.state.key))}),(0,t.jsx)(u.z9,{href:`${r.$.appSubUrl}/a/grafana-lokiexplore-app`,target:"_blank",tooltip:"Navigate to the Explore Logs app",variant:"secondary",size:"sm",onClick:()=>(0,U.z)("related_logs_action_clicked",{action:"open_explore_logs"}),children:(0,t.jsx)(M.x6,{i18nKey:"explore-metrics.related-logs.openExploreLogs",children:"Open Explore Logs"})})]}),(0,t.jsx)(Ut.Component,{model:Ut})]})})}}}function nn(){return new $t({})}async function on(){const Ct=(0,vn.l)().getList({logs:!0,type:"loki",filter:Ut=>Ut.uid!=="grafana"}),ut=[],Et=[];return await Promise.all(Ct.map(Ut=>(0,pn.AI)().get(`/api/datasources/${Ut.id}/health`,void 0,void 0,{showSuccessAlert:!1,showErrorAlert:!1}).then(Wt=>Wt?.status==="OK"?ut.push(Ut):Et.push(Ut)).catch(()=>Et.push(Ut)))),Et.length&&console.warn(`Found ${Et.length} unhealthy Loki data sources: ${Et.map(Ut=>Ut.name).join(", ")}`),ut}const bn=({trail:Ct})=>{const[ut,Et]=(0,C.useState)("Copy url"),Ut=()=>{if(navigator.clipboard){(0,U.z)("selected_metric_action_clicked",{action:"share_url"});const gt=(r.$.appUrl.endsWith("/")?r.$.appUrl.slice(0,-1):r.$.appUrl)+(0,V.xi)(Ct);navigator.clipboard.writeText(gt),Et("Copied!"),setTimeout(()=>{Et("Copy url")},2e3)}};return(0,t.jsx)(c.I,{variant:"canvas",icon:"share-alt",tooltip:ut,onClick:Ut})};var In=e(60044),Yn=e(4935);function zn(Ct){const ut=()=>(0,Yn._r)().getBookmarkIndex(Ct),Et=ut(),[Ut,Wt]=(0,C.useState)(Et);(0,C.useEffect)(()=>{const dn=Ct.subscribeToEvent(a.bZ,({payload:{prevState:Cn,newState:Un}})=>{(0,In.hi)(Cn)&&(0,In.hi)(Un)&&Un.steps.length>Cn.steps.length&&Wt((0,Yn._r)().getBookmarkIndex(Ct))});return()=>dn.unsubscribe()},[Ct]),Et!==Ut&&Wt(Et);const gt=Ut!=null;return[gt,()=>{if((0,U.z)("bookmark_changed",{action:gt?"toggled_off":"toggled_on"}),gt){let dn=ut();for(;dn!=null;)(0,Yn._r)().removeBookmark(dn),dn=ut()}else(0,Yn._r)().addBookmark(Ct);Wt(ut())}]}const{exploreMetricsRelatedLogs:St}=r.$.featureToggles;class zt extends a.Bs{constructor(ut){const Et=ut.autoQuery??(0,I.v)(ut.metric,ut.nativeHistogram);super({$variables:ut.$variables??yn(ut.metric),body:ut.body??new It({}),autoQuery:Et,queryDef:ut.queryDef??Et.main,...ut}),this._urlSync=new a.So(this,{keys:["actionView"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("breakdown"),r.$.featureToggles.enableScopesInMetricsExplore&&this._subs.add(this.subscribeToEvent(K.H0,ut=>{this.state.body.state.selectedTab?.publishEvent(ut)}))}getUrlState(){return{actionView:this.state.actionView}}updateFromUrl(ut){if(typeof ut.actionView=="string"){if(this.state.actionView!==ut.actionView){const Et=Qt.find(Ut=>Ut.value===ut.actionView);Et&&this.setActionView(Et.value)}}else ut.actionView===null&&this.setActionView(void 0)}setActionView(ut){const{body:Et}=this.state,Ut=Qt.find(Wt=>Wt.value===ut);Ut&&Ut.value!==this.state.actionView?(Et.state.topView.state.children[0].setState({maxHeight:st}),Et.setState({selectedTab:Ut.getScene()}),this.setState({actionView:Ut.value})):(Et.state.topView.state.children[0].setState({maxHeight:ht}),Et.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:ut})=>{const{body:Et}=ut.useState();return(0,t.jsx)(Et.Component,{model:Et})}}}const Qt=[{displayName:"Breakdown",value:"breakdown",getScene:Oe},{displayName:"Related metrics",value:"related",getScene:p,description:"Relevant metrics based on current label filters"}];St&&Qt.push({displayName:"Related logs",value:"related_logs",getScene:nn,description:"Relevant logs based on current label filters and time range"});class an extends a.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const ut=a.jh.getAncestor(this,zt),Et=(0,V.kj)(this),Ut=(0,V.U4)(Et),Wt=ut.state.queryDef?.queries||[],gt=a.jh.getTimeRange(this);return(0,m.Xe)({queries:Wt,dsRef:{uid:Ut},timeRange:gt.state.value,scopedVars:{__sceneObject:{value:ut}}})},this.openExploreLink=async()=>{(0,U.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(ut=>{window.open(ut,"_blank")})}}static{this.Component=({model:ut})=>{const Et=a.jh.getAncestor(ut,zt),Ut=(0,i.of)(mn),Wt=(0,V.kj)(ut),[gt,Vt]=zn(Wt),{actionView:Ft}=Et.useState();return(0,t.jsxs)(x.a,{paddingY:1,children:[(0,t.jsx)("div",{className:Ut.actions,children:(0,t.jsxs)(s.B,{gap:1,children:[(0,t.jsx)(c.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,U.z)("selected_metric_action_clicked",{action:"unselect"}),Wt.publishEvent(new K.OO(void 0))},children:"Select new metric"}),(0,t.jsx)(c.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:ut.openExploreLink}),(0,t.jsx)(bn,{trail:Wt}),(0,t.jsx)(c.I,{variant:"canvas",icon:gt?(0,t.jsx)(d.I,{name:"favorite",type:"mono",size:"lg"}):(0,t.jsx)(d.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:Vt}),Wt.state.embedded&&(0,t.jsx)(u.z9,{href:(0,V.xi)(Wt),variant:"secondary",onClick:()=>(0,U.z)("selected_metric_action_clicked",{action:"open_from_embedded"}),children:"Open"})]})}),(0,t.jsx)(g.U,{children:Qt.map((dn,Cn)=>{const Un=(0,t.jsx)(o.o,{label:dn.displayName,active:Ft===dn.value,onChangeTab:()=>{(0,U.z)("metric_action_view_changed",{view:dn.value}),Et.setActionView(dn.value)}},Cn);return dn.description?(0,t.jsx)(E.m,{content:dn.description,placement:"bottom-start",theme:"info",children:Un},Cn):Un})})]})}}}function mn(Ct){return{actions:(0,n.css)({[Ct.breakpoints.up(Ct.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function yn(Ct){return new a.Pj({variables:[...(0,K.ym)(Ct),new a.fS({name:K.yr,label:"Group by",datasource:K.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${K.Rp})`,refId:"A"},value:"",text:""})]})}},33811:(q,j,e)=>{"use strict";e.d(j,{t:()=>Xe});var t=e(74848),n=e(22803),r=e(2543),a=e(96540),i=e(32370),x=e(28082),s=e(61034),c=e(29675),d=e(6736),u=e(79784),g=e(86489),o=e(34128),E=e(99764),m=e(44826),f=e(66384),p=e(29010),h=e(37e3),D=e(11817),C=e(81635),l=e(75637),v=e(48398);class y{constructor(){this.config={minGroupSize:3,idealMaxGroupSize:30,maxDepth:100}}parse(Te){if(this.config.maxDepth<=0)throw new Error("Max depth must be greater than 0");if(this.config.minGroupSize<1)throw new Error("Min group size must be greater than 0");if(this.config.idealMaxGroupSize<this.config.minGroupSize)throw new Error("Max group size must be greater than min group size");if(this.config.miscGroupKey&&this.config.miscGroupKey==="")throw new Error("miscGroupKey cannot be empty");return{root:this.parseStrings(Te,0)}}parseStrings(Te,Le){const Ge={groups:new Map,values:[],descendants:0};for(const De of Te){if(De.trim()==="")continue;const Ke=P(De,Le);let Ie=Ge.groups.get(Ke);Ie||(Ie={groups:new Map,values:[],descendants:0},Ge.groups.set(Ke,Ie)),Ie.values.push(De),Ie.descendants++}const Me=[];for(let[De,Ke]of Ge.groups.entries())Ke.values.length<this.config.minGroupSize?(this.config.miscGroupKey?Me.push(...Ke.values):Ge.values.push(...Ke.values),Ge.descendants+=Ke.values.length,Ge.groups.delete(De)):(Ke.values.length>this.config.idealMaxGroupSize&&Le<this.config.maxDepth-1&&(Ke=this.parseStrings(Ke.values,Le+1),Ge.groups.set(De,Ke)),Ge.descendants+=Ke.descendants);if(this.config.miscGroupKey&&Me.length>0){const De={groups:new Map,values:Me,descendants:Me.length};Ge.groups.set(this.config.miscGroupKey,De)}return Ge}}function P(Fe,Te){let Le=0;for(let Ge=0;Ge<Fe.length;Ge++){const Me=Fe.charCodeAt(Ge);if(!(Me>=48&&Me<=57||Me>=65&&Me<=90||Me>=97&&Me<=122||Me>=192&&Me<=214||Me>=216&&Me<=246||Me>=248&&Me<=255||Me>=256&&Me<=383)&&(Le++,Le>Te))return Fe.slice(0,Ge)}return Fe}var b=e(48516),S=e(73750),M=e(5537),O=e(92986),R=e(56498),L=e(54594);class B extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new O.OO(this.state.metric),!0)}}static{this.Component=({model:Te})=>{const{title:Le}=Te.useState();return(0,t.jsx)(L.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:Te.onClick,children:Le})}}}var F=e(18990),I=e(23401),U=e(87574),W=e(68612);const A="results truncated due to limit",N=new F.l;async function K(Fe,Te,Le,Ge,Me,De,Ke){return i.$.featureToggles.enableScopesInMetricsExplore?T(Fe,Te,Le,Ge,Me,De,Ke):await V(Fe,Te,Ge,Me,De,Ke)}async function V(Fe,Te,Le,Ge,Me,De){const Ke=i.$.featureToggles.prometheusSpecialCharsInLabelValues?Le.map(ge=>z(N.renderLabels([{label:ge.key,op:ge.operator,value:ge.value}]))):Le.map(ge=>`${(0,I.Nc)(ge.key)}${ge.operator}"${ge.value}"`);let Ie=!1;if(Ge.length>0&&Me.length>0){const ge=(0,W.GX)(Ke,Ge,Me);Ie=ge.missingOtelTargets,Ke.push(ge.jobsRegex),Ke.push(ge.instancesRegex)}const Ne=`{${Ke.join(",")}}`,ie=`/api/datasources/uid/${Fe}/resources/api/v1/label/__name__/values`,ve={start:(0,U.mv)(Te.from,!1),end:(0,U.mv)(Te.to,!0),...Ne&&Ne!=="{}"?{"match[]":Ne}:{},...De?{limit:De}:{}},fe=await(0,x.AI)().get(ie,ve,"metrics-drilldown-names");return De&&fe.warnings?.includes(A)?{...fe,limitReached:!0,missingOtelTargets:Ie}:{...fe,limitReached:!1,missingOtelTargets:Ie}}async function T(Fe,Te,Le,Ge,Me,De,Ke){const Ie=await(0,R.WD)(Fe,Te,Le,Ge,"__name__",Ke,"metrics-drilldown-names");return Me.length>0&&De.length>0&&(Ge.push({key:"job",operator:"=~",value:Me?.join("|")||""}),Ge.push({key:"instance",operator:"=~",value:De?.join("|")||""})),{...Ie.data,limitReached:!!Ke&&!!Ie.data.warnings?.includes(A),missingOtelTargets:!1}}function z(Fe){return Fe.match(/^\{(.*)\}$/)?.[1]??""}var w=e(29088),H=e(36890);class G extends s.Bs{static{this.Component=()=>{const Te=(0,c.of)(X);return(0,t.jsx)(f.E,{className:Te.badge,color:"blue",text:(0,t.jsx)(D.x6,{i18nKey:"trails.metric-select.native-histogram",children:"Native Histogram"})})}}}function X(Fe){return{badge:(0,n.css)({borderRadius:Fe.shape.radius.pill,border:`1px solid ${Fe.colors.info.text}`,background:Fe.colors.info.transparent,cursor:"auto",width:"112px",padding:"0rem 0.25rem 0 0.35rem"})}}var k=e(8392),_=e(63739);function ee(Fe){return Te=>{const Le=s.jh.getData(Te);Le&&Le.subscribeToState(Ge=>{if(Ge.data?.state===k.Gu.Loading||Ge.data?.state===k.Gu.Error)return;const Me=s.jh.getAncestor(Te,Xe);if(!Ge.data?.series.length){Me.updateMetricPanel(Fe,!0,!0);return}let De=!1;for(const Ke of Ge.data.series){for(const Ie of Ke.fields)if(Ie.type===_.PU.number&&(De=Ie.values.some(Ne=>Ne!=null&&!isNaN(Ne)&&Ne!==0),De))break;if(De)break}Me.updateMetricPanel(Fe,!0,!De)})}}function J(Fe,Te,Le,Ge,Me,De){const Ke=(0,H.v)(Fe,Me);let Ie=[new B({metric:Fe,title:"Select"})];Me&&Ie.unshift(new G({}));let Ne=Ke.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,R.Vy)(Te)}).setDescription(Ge).setHeaderActions(Ie).setShowMenuAlways(!0).setMenu(new w.G({labelName:Fe}));De||(Ne=Ne.setShowMenuAlways(!0).setMenu(new w.G({labelName:Fe})));const ie=Ne.build(),ve=Ke.preview.queries.map(fe=>Z(fe,Le));return new s.xK({$variables:new s.Pj({variables:(0,O.ym)(Fe)}),$behaviors:[ee(Fe)],$data:new s.dt({datasource:O.GH,maxDataPoints:O.up,queries:ve}),body:ie})}function Z(Fe,Te){const Le=Te>0?'__ignore_usage__="",${filters}':'__ignore_usage__=""',Ge=Fe.expr?.replace("${filters}",Le);return{...Fe,expr:Ge}}var te=e(51088);function ae(Fe,Te){return Fe.sort((Le,Ge)=>{const Me=ne(Le,Te),De=ne(Ge,Te);return Me.halfLeven+Me.wholeLeven-(De.halfLeven+De.wholeLeven)})}const re=new Map;function ne(Fe,Te){let Le=re.get(Fe);Le||(Le=new Map,re.set(Fe,Le));let Ge=Le.get(Te);if(!Ge){const Me=Fe.split("_"),De=Me.slice(0,Me.length/2).join("_"),Ke=(0,te.A)(De,Te)||0,Ie=(0,te.A)(Fe,Te)||0;Ge={halfLeven:Ke,wholeLeven:Ie},Le.set(Te,Ge)}return Ge}const ce=/[^a-z0-9_:]+/;function le(Fe){return Fe?.toLowerCase().split(ce).filter(Te=>Te.length>0)||[]}function he(Fe){const Te=le(Fe).map(Ge=>`(?=(.*${Ge.toLowerCase()}.*))`);if(Te.length===0)return null;const Le=Te.join("");return new RegExp(Le,"igy")}function oe(Fe){const Te=de(le(Fe)).filter(Me=>Me.length>0).map(Me=>`(.*${Me.toLowerCase()}.*)`),Le=Te.length;return Te.length===0?null:`(?i:${Te.join("|")}){${Le}}`}function de(Fe=[]){const Te=new Set(Fe.map(Le=>Le.toLowerCase().trim()));return Array.from(Te)}const me="175px",Pe="64px",Ee="all",be=2e4,Se="View by the metric prefix. A metric prefix is a single word at the beginning of the metric name, relevant to the domain the metric belongs to.";class Xe extends s.Bs{constructor(Te){super({$variables:Te.$variables,metricPrefix:Te.metricPrefix??Ee,body:Te.body??new s.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:me,isLazy:!0}),...Te}),this.previewCache={},this.ignoreNextUpdate=!1,this._debounceRefreshMetricNames=(0,r.debounce)(()=>this._refreshMetricNames(),1e3),this._urlSync=new s.So(this,{keys:["metricPrefix"]}),this._variableDependency=new s.Sh(this,{variableNames:[O.EY,O.Ao],onReferencedVariableValueChanged:()=>{this._debounceRefreshMetricNames()}}),this.updateMetricPanel=(Le,Ge,Me)=>{const De=this.previewCache[Le];De&&(De.isEmpty=Me,De.loaded=Ge,this.previewCache[Le]=De,this.state.metricPrefix==="All"&&this.buildLayout())},this.onSearchQueryChange=Le=>{const Ge=Le.currentTarget.value;(0,R.kj)(this).setState({metricSearch:Ge})},this.onPrefixFilterChange=Le=>{this.setState({metricPrefix:Le.value}),this._refreshMetricNames()},this.reportPrefixFilterInteraction=Le=>{const Ge=(0,R.kj)(this),{steps:Me,currentStep:De}=Ge.state.history.state,Ie=Me[De]?.trailState.metric!==void 0;(0,S.z)("prefix_filter_clicked",{from:Ie?"related_metrics":"metric_list",action:Le?"open":"close"})},this.onToggleOtelExperience=()=>{const Le=(0,R.kj)(this),Ge=Le.state.useOtelExperience;let Me=!1,De=!0;Ge?((0,S.z)("otel_experience_toggled",{value:"off"}),De=!1,Le.resetOtelExperience()):(0,S.z)("otel_experience_toggled",{value:"on"}),(0,M.yx)(!Ge),Le.setState({useOtelExperience:!Ge,resettingOtel:De,startButtonClicked:Me})},this.addActivationHandler(this._onActivate.bind(this))}getUrlState(){return{metricPrefix:this.state.metricPrefix}}updateFromUrl(Te){typeof Te.metricPrefix=="string"&&this.state.metricPrefix!==Te.metricPrefix&&this.setState({metricPrefix:Te.metricPrefix})}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const Te=(0,R.kj)(this);this._subs.add(Te.subscribeToEvent(O.OO,Le=>{const{steps:Ge,currentStep:Me}=Te.state.history.state,De=Ge[Me].parentIndex,Ie=Ge[De].trailState.metric!==void 0;if(Le.payload!==void 0){const Ne=$e(Te),ie=le(Ne).length;(0,S.z)("metric_selected",{from:Ie?"related_metrics":"metric_list",searchTermCount:ie})}})),this._subs.add(Te.subscribeToEvent(s.bZ,Le=>{if(Le.payload.changedObject instanceof s.JZ){const{prevState:Ge,newState:Me}=Le.payload;if((0,R.iG)(Ge)&&(0,R.iG)(Me)&&Ge.from===Me.from&&Ge.to===Me.to)return}})),this._subs.add(Te.subscribeToState(({metricSearch:Le},Ge)=>{const Me=le(Ge.metricSearch),De=le(Le);(0,r.isEqual)(Me,De)||this._debounceRefreshMetricNames()})),this.subscribeToState((Le,Ge)=>{Le.metricNames!==Ge.metricNames&&this.onMetricNamesChanged()}),this._subs.add(Te.subscribeToState(({otelTargets:Le},Ge)=>{Le?.instances!==Ge.otelTargets?.instances&&Le?.jobs!==Ge.otelTargets?.jobs&&this._debounceRefreshMetricNames()})),this._subs.add(Te.subscribeToState(()=>{this._debounceRefreshMetricNames()})),this._subs.add(Te.subscribeToState(()=>{this.buildLayout()})),i.$.featureToggles.enableScopesInMetricsExplore&&this._subs.add(Te.subscribeToEvent(O.H0,()=>{this._debounceRefreshMetricNames()})),this._debounceRefreshMetricNames()}async _refreshMetricNames(){const Te=(0,R.kj)(this),Le=Te.state.$timeRange?.state;if(!Le)return;const Ge=[],Me=s.jh.lookupVariable(O.Ao,this),De=Me instanceof s.H9?Me?.state.filters??[]:[];De.length>0&&Ge.push(...De);const Ke=oe(Te.state.metricSearch);Ke&&Ge.push({key:"__name__",operator:"=~",value:Ke});const Ie=s.jh.interpolate(Te,O.gR);this.setState({metricNamesLoading:!0,metricNamesError:void 0,metricNamesWarning:void 0});try{const Ne=Te.state.useOtelExperience?Te.state.otelTargets?.jobs??[]:[],ie=Te.state.useOtelExperience?Te.state.otelTargets?.instances??[]:[],ve=await K(Ie,Le,(0,C.f_)(),Ge,Ne,ie,be),fe=he($e(this));let ge=fe?ve.data.filter(nt=>!fe||fe.test(nt)):ve.data;const xe=ge,je=this.state.metricPrefix;if(je&&je!=="all"){const nt=new RegExp(`(^${je}.*)`,"igy");ge=ge.filter(Je=>!nt||nt.test(Je))}let Ve=ve.limitReached?`This feature will only return up to ${be} metric names for performance reasons. This limit is being exceeded for the current data source. Add search terms or label filters to narrow down the number of metric names returned.`:void 0;Te.state.useOtelExperience&&(Ne.length===0||ie.length===0)&&(ge=[],Ve=void 0);let ke=this.state.body,Oe=await this.generateGroups(xe);this.setState({metricNames:ge,rootGroup:Oe,body:ke,metricNamesLoading:!1,metricNamesWarning:Ve,metricNamesError:ve.error,missingOtelTargets:ve.missingOtelTargets})}catch(Ne){let ie="Unknown error";(0,x.NF)(Ne)&&(Ne.cancelled?ie="Request cancelled":Ne.statusText&&(ie=Ne.statusText)),this.setState({metricNames:void 0,metricNamesLoading:!1,metricNamesError:ie})}}async generateGroups(Te=[]){const Le=new y;Le.config={...Le.config,maxDepth:2,minGroupSize:2,miscGroupKey:"misc"};const{root:Ge}=Le.parse(Te);return Ge}onMetricNamesChanged(){const Te=this.state.metricNames||[],Le=new Set(Te);Object.values(this.previewCache).forEach(Ie=>{Le.has(Ie.name)||(Ie.isEmpty=!0)});const Ge=(0,R.kj)(this),Me=Ge.state.metric!==void 0?ae(Te,Ge.state.metric):Te,De={},Ke=120;Object.keys(this.previewCache).forEach(Ie=>{Le.has(Ie)||delete this.previewCache[Ie]});for(let Ie=0;Ie<Me.length;Ie++){const Ne=Me[Ie];if(Object.keys(De).length>Ke)break;const ie=this.previewCache[Ne];De[Ne]=ie||{name:Ne,index:Ie,loaded:!1}}try{const Ie=s.jh.getAncestor(this,l.R).state.metric;delete De[Ie]}catch{}this.previewCache=De,this.buildLayout()}sortedPreviewMetrics(){return Object.values(this.previewCache).sort((Te,Le)=>Te.isEmpty&&Le.isEmpty?Te.index-Le.index:Te.isEmpty?1:Le.isEmpty?-1:Te.index-Le.index)}async buildLayout(){const Te=(0,R.kj)(this),Le=Te.state.showPreviews;if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}const Ge=[],Me=this.sortedPreviewMetrics(),Ke=(0,R.gA)(this)?.length||0;for(let Ne=0;Ne<Me.length;Ne++){const ie=Me[Ne],ve=await Te.getMetricMetadata(ie.name),fe=(0,b.R)(ve);if(Le){if(ie.itemRef&&ie.isPanel){Ge.push(ie.itemRef.resolve());continue}const ge=Te.isNativeHistogram(ie.name),xe=J(ie.name,Ne,Ke,fe,ge,!0);ie.itemRef=xe.getRef(),ie.isPanel=!0,Ge.push(xe)}else{const ge=new s.xK({$variables:new s.Pj({variables:(0,O.ym)(ie.name)}),body:Qe(ie.name,fe)});ie.itemRef=ge.getRef(),ie.isPanel=!1,Ge.push(ge)}}const Ie=Le?me:Pe;this.state.body.setState({children:Ge,autoRows:Ie})}static{this.Component=({model:Te})=>{const{body:Le,metricNames:Ge,metricNamesError:Me,metricNamesLoading:De,metricNamesWarning:Ke,rootGroup:Ie,metricPrefix:Ne,missingOtelTargets:ie}=Te.useState(),{children:ve}=Le.useState(),fe=(0,R.kj)(Te),ge=(0,c.of)(we),[xe,je]=(0,a.useReducer)(()=>!0,!1),{metricSearch:Ve,useOtelExperience:ke,hasOtelResources:Oe,isStandardOtel:nt,metric:Je}=fe.useState(),Be=ve.length===0&&Ve,Ze=!De&&Ge&&Ge.length===0,tt=De&&ve.length===0,Re=tt?void 0:ie?"There are no metrics found. Please adjust your filters based on your OTel resource attributes.":Ze&&"There are no results found. Try a different time range or a different data source."||Be&&"There are no results found. Try adjusting your search or filters."||void 0,at=Ke?(0,t.jsx)(d.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Unable to retrieve metric names"}),(0,t.jsx)("p",{children:Ke})]}),children:(0,t.jsx)(u.I,{className:ge.warningIcon,name:"exclamation-triangle"})}):void 0;return(0,t.jsxs)("div",{className:ge.container,children:[(0,t.jsxs)("div",{className:ge.header,children:[(0,t.jsx)(g.D,{label:"Search metrics",className:ge.searchField,children:(0,t.jsx)(o.p,{placeholder:"Search metrics",prefix:(0,t.jsx)(u.I,{name:"search"}),value:Ve,onChange:Te.onSearchQueryChange,suffix:at})}),(0,t.jsx)(g.D,{label:(0,t.jsxs)("div",{className:ge.displayOptionTooltip,children:[(0,t.jsx)(D.x6,{i18nKey:"explore-metrics.viewBy",children:"View by"}),(0,t.jsx)(E.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:Se})]}),className:ge.displayOption,children:(0,t.jsx)(m.l6,{value:Ne,onChange:Te.onPrefixFilterChange,onOpenMenu:()=>Te.reportPrefixFilterInteraction(!0),onCloseMenu:()=>Te.reportPrefixFilterInteraction(!1),options:[{label:"All metric names",value:Ee},...Array.from(Ie?.groups.keys()??[]).map(yt=>({label:`${yt}_`,value:yt}))],className:"metrics-drilldown-metric-prefix-select"})}),!Je&&Oe&&(0,t.jsx)(g.D,{label:(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:ge.displayOptionTooltip,children:[(0,t.jsx)(D.x6,{i18nKey:"trails.metric-select.filter-by",children:"Filter by"}),(0,t.jsx)(E.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:(0,t.jsx)(D.x6,{i18nKey:"trails.metric-select.otel-switch",children:"This switch enables filtering by OTel resources for OTel native data sources."})}),(0,t.jsx)("div",{children:(0,t.jsx)(f.E,{text:(0,t.jsx)(D.x6,{i18nKey:"trails.metric-select.new-badge",children:"New"}),color:"blue",className:ge.badgeStyle})})]})}),className:ge.displayOption,children:(0,t.jsx)("div",{title:nt?"":"This setting is disabled because this is not an OTel native data source.",children:(0,t.jsx)(p.K,{disabled:!nt,showLabel:!0,label:"OTel experience",value:ke,onChange:Te.onToggleOtelExperience})})})]}),Me&&(0,t.jsxs)(h.F,{title:"Unable to retrieve metric names",severity:"error",children:[(0,t.jsx)("div",{children:"We are unable to connect to your data source. Double check your data source URL and credentials."}),(0,t.jsxs)("div",{children:["(",Me,")"]})]}),Ke&&!xe&&(0,t.jsx)(h.F,{title:"Unable to retrieve all metric names",severity:"warning",onSubmit:je,onRemove:je,children:(0,t.jsx)("div",{children:Ke})}),(0,t.jsxs)(v.O,{isLoading:tt,blockingMessage:Re,children:[Le instanceof s.G1&&(0,t.jsx)(Le.Component,{model:Le}),Le instanceof s.gF&&(0,t.jsx)(Le.Component,{model:Le})]})]})}}}function Qe(Fe,Te){return s.d0.text().setTitle(Fe).setDescription(Te).setHeaderActions([new B({metric:Fe,title:"Select"})]).setOption("content","").build()}function we(Fe){return{container:(0,n.css)({display:"flex",flexDirection:"column"}),headingWrapper:(0,n.css)({marginBottom:Fe.spacing(.5)}),header:(0,n.css)({flexGrow:0,display:"flex",gap:Fe.spacing(2),marginBottom:Fe.spacing(2),alignItems:"flex-end"}),searchField:(0,n.css)({flexGrow:1,marginBottom:0}),metricTabGroup:(0,n.css)({marginBottom:Fe.spacing(2)}),displayOption:(0,n.css)({flexGrow:0,marginBottom:0,minWidth:"184px"}),displayOptionTooltip:(0,n.css)({display:"flex",gap:Fe.spacing(1)}),warningIcon:(0,n.css)({color:Fe.colors.warning.main}),badgeStyle:(0,n.css)({display:"flex",height:"1rem",padding:"0rem 0.25rem 0 0.30rem",alignItems:"center",borderRadius:Fe.shape.radius.pill,border:`1px solid ${Fe.colors.info.text}`,background:Fe.colors.info.transparent,marginTop:"4px",marginLeft:"-3px"})}}function $e(Fe){return(0,R.kj)(Fe).state.metricSearch||""}},48398:(q,j,e)=>{"use strict";e.d(j,{O:()=>i});var t=e(74848),n=e(22803),r=e(29675),a=e(81876);function i({blockingMessage:s,isLoading:c,children:d}){const u=(0,r.of)(x);return c&&!s&&(s="Loading..."),c?(0,t.jsx)(a._,{className:u.statusMessage,text:s}):s?(0,t.jsx)("div",{className:u.statusMessage,children:s}):d}function x(s){return{statusMessage:(0,n.css)({fontStyle:"italic",marginTop:s.spacing(7),textAlign:"center",width:"100%"})}}},4935:(q,j,e)=>{"use strict";e.d(j,{yn:()=>D,_r:()=>l});var t=e(2543),n=e(93407),r=e(61034),a=e(83394),i=e(80847),x=e(55522),s=e(92986),c=e(56498),d=e(74848),u=e(48583),g=e(54594),o=e(17687);function E(){const y=(0,o.tZ)("Bookmark created");return y.component=(0,d.jsxs)(u.B,{gap:2,direction:"row",children:[(0,d.jsxs)("div",{children:["You can view bookmarks under ",(0,d.jsx)("i",{children:"Explore > Metrics"})]}),(0,d.jsx)(g.z9,{fill:"solid",variant:"secondary",href:s.QX,children:"View bookmarks"})]}),y}const m=20;class f{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load(),this._lastModified=Date.now();const P=()=>{const b=this._recent.slice(0,m).map(S=>this._serializeTrail(S.resolve()));localStorage.setItem(s.sQ,JSON.stringify(b)),localStorage.setItem(s.jT,JSON.stringify(this._bookmarks)),this._lastModified=Date.now()};this._save=(0,t.debounce)(P,1e3),window.addEventListener("beforeunload",b=>{this._save=P})}_loadRecentTrailsFromStorage(){const P=[],b=localStorage.getItem(s.sQ);if(b){const S=JSON.parse(b);for(const M of S){const O=this._deserializeTrail(M);P.push(O.getRef())}}return P}_loadBookmarksFromStorage(){const P=localStorage.getItem(s.jT);return(P?JSON.parse(P):[]).map(S=>{if(v(S)){const M=S.currentStep!=null?S.currentStep:S.history.length-1;return{urlValues:S.history[M].urlValues,createdAt:S.createdAt||Date.now()}}return S})}_deserializeTrail(P){const b=new x.b({createdAt:P.createdAt});P.history.map(M=>{this._loadFromUrl(b,M.urlValues);const O=M.parentIndex??b.state.history.state.steps.length-1;b.state.history.setState({currentStep:O}),b.state.history.addTrailStepFromStorage(b,M)});const S=P.currentStep??b.state.history.state.steps.length-1;return b.state.history.setState({currentStep:S}),b.setState(r.Go.cloneSceneObjectState(b.state.history.state.steps[S].trailState,{history:b.state.history})),b}_serializeTrail(P){return{history:P.state.history.state.steps.map(S=>{const M=new x.b(r.Go.cloneSceneObjectState(S.trailState));return{urlValues:r.Go.getUrlState(M),type:S.type,description:S.description,parentIndex:S.parentIndex}}),currentStep:P.state.history.state.currentStep,createdAt:P.state.createdAt}}getTrailForBookmarkIndex(P){const b=this._bookmarks[P];return b?this.getTrailForBookmark(b):(0,c.ef)()}getTrailForBookmark(P){const b=D(P);for(const M of this._recent){const O=M.resolve();if(D(O)===b)return O}const S=new x.b({});return this._loadFromUrl(S,P.urlValues),S}_loadFromUrl(P,b){const S=n.kM.renderUrl("",b);r.Go.syncStateFromSearchParams(P,new URLSearchParams(S))}get recent(){return this._recent}get lastModified(){return this._lastModified}load(){this._recent=this._loadRecentTrailsFromStorage(),this._bookmarks=this._loadBookmarksFromStorage(),this._refreshBookmarkIndexMap(),this._lastModified=Date.now()}setRecentTrail(P){const{steps:b}=P.state.history.state;if(b.length===0||b.length===1&&b[0].type==="start")return;this._recent=this._recent.filter(M=>M!==P.getRef());const S=p(P);this._recent=this._recent.filter(M=>{const O=p(M.resolve());return!(0,t.isEqual)(S,O)}),this._recent.unshift(P.getRef()),this._save()}get bookmarks(){return this._bookmarks}addBookmark(P){const S={urlValues:r.Go.getUrlState(P),createdAt:Date.now()};this._bookmarks.unshift(S),this._refreshBookmarkIndexMap(),this._save(),(0,a.JD)((0,i.dx)(E()))}removeBookmark(P){P<this._bookmarks.length&&(this._bookmarks.splice(P,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(P){const b=D(P);return this._bookmarkIndexMap.get(b)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((P,b)=>{const S=D(P);this._bookmarkIndexMap.set(S,b)})}}function p(y){const P=r.Go.getUrlState(y);return h(P),P}function h(y){return delete y.actionView,delete y.layout,delete y.metricSearch,delete y.refresh,(y["var-groupby"]===""||y["var-groupby"]===void 0)&&(y["var-groupby"]="$__all"),typeof y["var-filters"]!="string"&&(y["var-filters"]=y["var-filters"]?.filter(P=>P!=="")),y}function D(y){return y instanceof x.b?JSON.stringify(p(y)):JSON.stringify(h({...y.urlValues}))}let C;function l(){return C||(C=new f),C}function v(y){return y!=null&&typeof y=="object"&&"history"in y}},36890:(q,j,e)=>{"use strict";e.d(j,{v:()=>I});var t=e(23401),n=e(92986);const r="short",a="cps",i={bytes:"bytes",seconds:"s"},x=Object.keys(i),s={bytes:"Bps",seconds:"short"};function c(U){if(!U)return null;const W=U.toLowerCase().split("_").slice(-2);for(let A=W.length-1;A>=0;A--)if(x.includes(W[A]))return W[A];return null}function d(U){return U&&i[U]||r}function u(U){return U&&s[U]||a}const g=`${n.Rp}{${n.ui}}`,o=`rate(${g}[$__rate_interval])`,E=`{"${n.Rp}", ${n.ui}}`,m=`rate(${E}[$__rate_interval])`;function f({isRateQuery:U=!1,groupings:W=[],isUtf8Metric:A=!1}){const N=A?U?m:E:U?o:g;return W.length>0?`sum by(${W.join(", ")}) (${N} ${n.tM})`:`${N} ${n.tM}`}var p=e(61034),h=e(7500),D=e(90086);function C({title:U,unit:W}){return p.d0.timeseries().setTitle(U).setUnit(W).setOption("legend",{showLegend:!1}).setOption("tooltip",{mode:h.$N.Multi,sort:h.xB.Descending}).setCustomFieldConfig("fillOpacity",9)}function l({title:U,unit:W}){return p.d0.heatmap().setTitle(U).setUnit(W).setOption("calculate",!1).setOption("color",{mode:D.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function v({title:U,unit:W}){return p.d0.timeseries().setTitle(U).setUnit(W).setCustomFieldConfig("fillOpacity",9).setOption("tooltip",{mode:h.$N.Multi,sort:h.xB.Descending}).setOption("legend",{showLegend:!1})}function y({description:U,mainQueryExpr:W,breakdownQueryExpr:A,unit:N}){const K={title:n.Rp,unit:N},V={refId:"A",expr:W,legendFormat:U,fromExploreMetrics:!0},T={...K,title:U,queries:[V],variant:"main",vizBuilder:()=>C({...T})},z={...K,queries:[{...V,legendFormat:U}],vizBuilder:()=>C(z),variant:"preview"},w={...K,queries:[{refId:"A",expr:A,legendFormat:`{{${n.aZ}}}`,fromExploreMetrics:!0}],vizBuilder:()=>C(w),variant:"breakdown"};return{preview:z,main:T,breakdown:w,variants:[]}}const P=new Set(["count","total"]),b={count:"sum",total:"sum"},S={avg:"average",sum:"overall"};function M(U){return S[U]||U}function O(U){const{metricParts:W,suffix:A,isUtf8Metric:N}=U,K=A==="total"?W.at(-2):A,V=P.has(A),T=b[A]||"avg",z=V?u(K):d(K),w=f({isRateQuery:V,isUtf8Metric:N}),H=`${M(T)}${V?" per-second rate":""}`,G=`${n.Rp} (${H})`,X=`${T}(${w})`,k=`${T}(${w})by(${n.aZ})`;return y({description:G,mainQueryExpr:X,breakdownQueryExpr:k,unit:z})}function R(U){const{unit:W}=U,A={title:n.Rp,unit:W},N={...A,variant:"p50",queries:[L(U,50)],vizBuilder:()=>C(N)},K={...A,variant:"p50",queries:[L(U,50,[n.aZ])],vizBuilder:()=>C(K)},V={...A,variant:"percentiles",queries:[99,90,50].map(z=>L(U,z)),vizBuilder:()=>v(V)},T={...A,variant:"heatmap",queries:[{refId:"Heatmap",expr:f({isRateQuery:!0,isUtf8Metric:U.isUtf8Metric,groupings:["le"]}),fromExploreMetrics:!0,format:"heatmap"}],vizBuilder:()=>l(T)};return{preview:T,main:T,variants:[V,T],breakdown:K}}function L(U,W,A=[]){const N=W/100;let K=`${W}th Percentile`;A[0]&&(K=`{{${A[0]}}}`);const V=f({isRateQuery:!0,isUtf8Metric:U.isUtf8Metric,groupings:["le",...A]});return{refId:`Percentile${W}`,expr:`histogram_quantile(${N}, ${V})`,legendFormat:K,fromExploreMetrics:!0}}function B(U){const{metricParts:W,isUtf8Metric:A,unit:N}=U,K=W.slice(0,-1).join("_"),V=`${K} (average)`,T=f({isRateQuery:!0,isUtf8Metric:A}),z=F(`sum(${T})`,K),w=F(`sum(${T})by(${n.aZ})`,K);return y({description:V,mainQueryExpr:z,breakdownQueryExpr:w,unit:N})}function F(U,W){const A=U.replace(n.Rp,`${W}_sum`),N=U.replace(n.Rp,`${W}_count`);return`${A}/${N}`}function I(U,W){const A=!(0,t.Rq)(U),N=U.split("_"),K=N.at(-1);if(K==null)throw new Error(`This function does not support a metric suffix of "${K}"`);const V=N.at(-2),T=d(V),z={metricParts:N,isUtf8Metric:A,suffix:K,unitSuffix:V,unit:T};return K==="sum"?B(z):K==="bucket"||W?R(z):O(z)}},48516:(q,j,e)=>{"use strict";e.d(j,{R:()=>x,q:()=>i});var t=e(75257),n=e(15511),r=e(98437),a=e(92986);class i{constructor(u){this._classicHistograms={},this._nativeHistograms=[],this._trail=u}reset(){this._datasource=void 0,this._metricsMetadata=void 0,this._classicHistograms={},this._nativeHistograms=[]}async getDatasource(){return this._datasource||(this._datasource=(0,r.l)().get(a.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const u=await this.getDatasource();if(u.languageProvider instanceof t.Ay)return u.languageProvider.metricsMetadata||await u.languageProvider.loadMetricsMetadata(),u.languageProvider.metricsMetadata}async getMetricMetadata(u){return u?(this._metricsMetadata||(this._metricsMetadata=await this._getMetricsMetadata()),(await this._metricsMetadata)?.[u]):void 0}listNativeHistograms(){return this._nativeHistograms}async initializeHistograms(){const u=await this.getDatasource();if(Object.keys(this._classicHistograms).length===0&&u instanceof n.UD){const g=u.metricFindQuery("metrics(.*_bucket)"),o=u.metricFindQuery("metrics(.*)"),[E,m]=await Promise.all([g,o]);E.forEach(f=>{this._classicHistograms[f.text]=1}),u.languageProvider instanceof t.Ay&&!this._metricsMetadata&&!u.languageProvider.metricsMetadata&&(await u.languageProvider.loadMetricsMetadata(),this._metricsMetadata=u.languageProvider.metricsMetadata),m.forEach(f=>{this.isNativeHistogram(f.text)&&this.addNativeHistogram(f.text)})}}isNativeHistogram(u){if(!u)return!1;const g=this._metricsMetadata,E=(u.split("_").pop()??"")!=="bucket";return!!(g&&g[u]&&g[u].type==="histogram"&&E||this._classicHistograms[`${u}_bucket`])}addNativeHistogram(u){this._nativeHistograms.includes(u)||this._nativeHistograms.push(u)}async getTagKeys(u){const g=await this.getDatasource();return g instanceof n.UD?await g.getTagKeys(u):[]}async getTagValues(u){const g=await this.getDatasource();return g instanceof n.UD?(u.key=s(u.key),await g.getTagValues(u)):[]}}function x(d){if(!d)return;const{type:u,help:g,unit:o}=d;return[g,u&&`**Type:** *${u}*`,o&&`**Unit:** ${o}`].join(`

`)}function s(d){return d===""||!c(d)?d:d.slice(1,-1)}function c(d){return/^".*"$/.test(d)}},73750:(q,j,e)=>{"use strict";e.d(j,{h:()=>a,z:()=>r});var t=e(56276);const n="grafana_explore_metrics_";function r(i,x){(0,t.rR)(`${n}${i}`,x)}function a(i,x,s){if(i.length===x.length)for(const c of x)for(const d of i)c.key===d.key&&c.value!==d.value&&r("label_filter_changed",{label:c.key,action:"changed",cause:"adhoc_filter",otel_resource_attribute:s??!1});else if(i.length<x.length)for(const c of x){let d=!1;for(const u of i)if(c.key===u.key){d=!0;break}d||r("label_filter_changed",{label:c.key,action:"removed",cause:"adhoc_filter"})}else for(const c of i){let d=!1;for(const u of x)if(u.key===c.key){d=!0;break}d||r("label_filter_changed",{label:c.key,action:"added",cause:"adhoc_filter"})}}},99570:(q,j,e)=>{"use strict";e.d(j,{a8:()=>g,hm:()=>p,tE:()=>f,wI:()=>o});var t=e(87574),n=e(23401),r=e(28082),a=e(32370),i=e(56498),x=e(68612);const s=["__name__"],c=h=>`count(target_info{${h??""}}) by (job, instance)`,d=h=>`count(${h}) by (job, instance)`,u={key:"__name__",value:"target_info",operator:"="};async function g(h,D,C,l){const v=(0,t.mv)(D.from,!1),y=(0,t.mv)(D.to,!0);l&&!(0,n.Rq)(l)&&(l=`{"${l}"}`);const P=l?d(l):c(C),b=`/api/datasources/uid/${h}/resources/api/v1/query`,S={start:v,end:y,query:P},M=await(0,r.AI)().get(b,S,`metrics-drilldown-otel-check-total-${P}`);let O=[],R=[];return M.data.result.forEach(L=>{L.metric.job&&L.metric.instance&&(O.push(L.metric.job),R.push(L.metric.instance))}),{jobs:O,instances:R}}async function o(h,D,C){return a.$.featureToggles.enableScopesInMetricsExplore?m(h,D,C):E(h,D)}async function E(h,D){const C=(0,t.mv)(D.from,!1),l=(0,t.mv)(D.to,!0),v=`/api/datasources/uid/${h}/resources/api/v1/label/deployment_environment/values`,y={start:C,end:l};return(await(0,r.AI)().get(v,y,"metrics-drilldown-otel-resources-deployment-env")).data}async function m(h,D,C){return(await(0,i.WD)(h,D,C,[],"deployment_environment",void 0,"metrics-drilldown-otel-resources-deployment-env")).data.data}async function f(h,D,C,l){const v=(l??[]).concat(s),y=await g(h,D,void 0,C);if(y.jobs.length===0||y.instances.length===0)return{attributes:[],missingOtelTargets:!1};const P=`/api/datasources/uid/${h}/resources/api/v1/labels`,b=(0,x.GX)([],y.jobs,y.instances);let S="";(0,n.Rq)(C)?S=`${C}{${b.jobsRegex},${b.instancesRegex}}`:S=`{'${C}',${b.jobsRegex},${b.instancesRegex}}`;const M=(0,t.mv)(D.from,!1),O=(0,t.mv)(D.to,!0),R={start:M,end:O,"match[]":S},B=(await(0,r.AI)().get(P,R,`metrics-drilldown-otel-resources-metric-job-instance-${S}`)).data??[];let F=`target_info{${b.jobsRegex},${b.instancesRegex}}`;const I={start:M,end:O,"match[]":F},N=((await(0,r.AI)().get(P,I,`metrics-drilldown-otel-resources-metric-job-instance-${F}`)).data??[]).filter(T=>!B.includes(T)).filter(T=>!v.includes(T)).map(T=>({text:T}));return{attributes:(0,x.ql)(N,["job"]).map(T=>T.text),missingOtelTargets:b.missingOtelTargets}}async function p(h,D){const C=(0,t.mv)(D.from,!1),l=(0,t.mv)(D.to,!0),v=`/api/datasources/uid/${h}/resources/api/v1/labels`,y={start:C,end:l,"match[]":'{__name__="target_info"}'},P=(0,r.AI)().get(v,y,"metrics-drilldown-all-otel-resources-on-target_info"),b={start:C,end:l,"match[]":'{name!="",__name__!~"target_info"}'},S=await(0,r.AI)().get(v,b,"metrics-drilldown-all-metric-labels-not-otel-resource-attributes"),M=await Promise.all([P,S]),O=M[0].data??[],R=new Set(M[1].data??[]);return O.filter(B=>!R.has(B))}},68612:(q,j,e)=>{"use strict";e.d(j,{GX:()=>E,KO:()=>m,mc:()=>D,qJ:()=>p,ql:()=>u});var t=e(14964),n=e(23401),r=e(32370),a=e(61034),i=e(73750),x=e(5537),s=e(92986),c=e(99570);const d=()=>({cloud_availability_zone:0,cloud_region:0,container_name:0,k8s_cluster_name:0,k8s_container_name:0,k8s_cronjob_name:0,k8s_daemonset_name:0,k8s_deployment_name:0,k8s_job_name:0,k8s_namespace_name:0,k8s_pod_name:0,k8s_replicaset_name:0,k8s_statefulset_name:0,service_instance_id:0,service_name:0,service_namespace:0});function u(C,l){const v=d(),y=Object.keys(v);return C=C.filter(b=>{const S=(b.value??"").toString();return y.includes(S)?(v[S]=1,!1):!0}),Object.keys(v).filter(b=>v[b]&&!l.includes(b)).map(b=>({text:b})).concat(C)}function g(C,l){let v="";if(l){const P=a.jh.lookupVariable(s.lr,l)?.getValue();v=typeof P=="string"?P:""}let y="";return y=`* on (job, instance) group_left(${v}) topk by (job, instance) (1, target_info{${C.filters}})`,y}function o(C,l){const v=a.jh.lookupVariable(s.DU,C);let y={labels:"",filters:""};if(v instanceof a.H9){const P=v.state.filters;let b="",S="";for(let M=0;M<P?.length;M++){let O=P[M].key;(0,n.Rq)(O)||(O=`'${O}'`);const R=P[M].operator,L=P[M].value;M>0&&(b+=","),r.$.featureToggles.prometheusSpecialCharsInLabelValues?b+=`${O}${R}'${L}'`:b+=`${O}${R}"${L}"`,O!=="job"&&O!=="instance"&&(S+=`${O}`)}return y.labels=S,y.filters=b,y}return y}function E(C,l,v){let y=!1;const P=2e3;let b=C.join(",").length,S="job=~'",M="instance=~'";const O={},R={};for(let L=0;L<l.length;L++){const B=L===0?0:2;if(b+S.length+l[L].length+M.length+v[L].length+B<=P)L===0?(S+=`${l[L]}`,M+=`${v[L]}`):(S+=O[l[L]]?"":`|${l[L]}`,M+=R[v[L]]?"":`|${v[L]}`),O[l[L]]=!0,R[v[L]]=!0;else{y=!0;break}}return S+="'",M+="'",{missingOtelTargets:y,jobsRegex:S,instancesRegex:M}}async function m(C,l){const v=C.state.$timeRange?.state;if(!v)return;const y=a.jh.lookupVariable(s.lr,C),P=a.jh.lookupVariable(s.Xt,C),b=a.jh.lookupVariable(s.jl,C);if(!(y instanceof a.x0)||!(P instanceof a.x0)||!(b instanceof a.x0))return;if(!l||l==="target_info"){y.setState({value:""});const F=o(C),I=g(F,C);P.setState({value:I});return}const S=a.jh.lookupVariable(s.DU,C),M=a.jh.lookupVariable(s.Ao,C);let O=[];if(M instanceof a.H9&&S instanceof a.H9){const F=M.state.filters.map(U=>U.key),I=S.state.filters.map(U=>U.key);O=F.concat(I),O=O.concat(["job","instance"])}const R=a.jh.interpolate(C,s.gR),{attributes:L,missingOtelTargets:B}=await(0,c.tE)(R,v,l,O);if(L.length>0){const F=L.map(W=>(0,n.Rq)(W)?W:`'${W}'`);y.setState({value:F.join(",")});const I=o(C),U=g(I,C);P.setState({value:U})}b.setState({value:B})}function f(C){return C.length===0?null:C.find(l=>l.toLowerCase().indexOf("prod")>-1)??C[0]}async function p(C,l,v,y,P,b){if(C.state.isUpdatingOtel)return;C.setState({isUpdatingOtel:!0});const S=a.jh.lookupVariable(s.DU,C),M=a.jh.lookupVariable(s.Ao,C),O=a.jh.lookupVariable(s.mW,C),R=a.jh.lookupVariable(s.Xt,C),L=C.state.initialOtelCheckComplete,B=C.state.resettingOtel;if(!(S instanceof a.H9&&M instanceof a.H9&&O instanceof a.H9&&R instanceof a.x0))return;let F=f(y??[])??"";const I=(0,x.gO)();if(!I)C.resetOtelExperience(P,b);else{let N=B?M.state.filters:[];const K=L&&!B?[]:O.state.filters,V=h(K,b),T=L?[]:V.nonPromoted,z=L?[]:V.promoted;if(!L||B){const w=K.filter(Z=>Z.key==="deployment_environment").length>0,G=F===""||w?[]:[{key:"deployment_environment",value:F,operator:F.includes(",")?"=~":"="}],X=b?.includes("deployment_environment");N=X?N.filter(Z=>Z.key!=="deployment_environment"):N,O?.setState({filters:[...G,...N,...K],hide:t.zL.hideLabel});const _=[...X?G:[],...T];S.setState({filters:_,hide:t.zL.hideVariable});const ee=!X,J=N.filter(Z=>Z.key==="deployment_environment");ee&&J.length===0&&(N=[...N,...G]),N=[...N,...z],M.setState({filters:N,hide:t.zL.hideVariable})}}const U=o(C),W=g(U);R.setState({value:W});const A=await(0,c.a8)(l,v,U.filters);P&&y&&!L?C.setState({otelTargets:A,otelJoinQuery:W,hasOtelResources:P,isStandardOtel:(b??[]).length>0,useOtelExperience:I,nonPromotedOtelResources:b,initialOtelCheckComplete:!0,resettingOtel:!1,afterFirstOtelCheck:!0,isUpdatingOtel:!1}):C.setState({otelTargets:A,otelJoinQuery:W,resettingOtel:!1,afterFirstOtelCheck:!0,isUpdatingOtel:!1,nonPromotedOtelResources:b})}function h(C,l=[]){const v=new Set(l),y=C.filter(b=>v.has(b.key)),P=C.filter(b=>!v.has(b.key));return{nonPromoted:y,promoted:P}}function D(C,l,v,y,P){if(C.length>l.length){const S=C[C.length-1];v?.includes(S.key)?(y.setState({filters:[...y.state.filters,S]}),(0,i.h)(C,l,!0)):P.setState({filters:[...P.state.filters,S]});return}if(C.length<l.length){const S=l.filter(M=>!C.includes(M))[0];v?.includes(S.key)?(y.setState({filters:y.state.filters.filter(M=>M.key!==S.key)}),(0,i.h)(C,l,!0)):P.setState({filters:P.state.filters.filter(M=>M.key!==S.key)});return}let b=[];C.length===l.length&&C.some((S,M)=>{const O=S.key,R=S.value,L=l[M].key===O&&l[M].value!==R;return L&&b.push(S),L})&&(v?.includes(b[0].key)?(y.setState({filters:y.state.filters.map(S=>S.key===b[0].key?b[0]:S)}),(0,i.h)(C,l,!0)):P.setState({filters:P.state.filters.map(S=>S.key===b[0].key?b[0]:S)}))}},5537:(q,j,e)=>{"use strict";e.d(j,{HU:()=>r,Hy:()=>n,fq:()=>i,gO:()=>x,vs:()=>a,yx:()=>s});var t=e(92986);function n(){return localStorage.getItem(t.Pp)??"grid"}function r(c){return localStorage.setItem(t.Pp,c??"grid")}function a(c,d){const g=(localStorage.getItem(`${t.I1}.${c}.by`)??"").split(".");return!g[0]||!g[1]?{sortBy:d}:{sortBy:g[0],direction:g[1]}}function i(c,d){d&&localStorage.setItem(`${t.I1}.${c}.by`,`${d}`)}function x(){const c=localStorage.getItem(t.i$);return c!==null?JSON.parse(c):!0}function s(c){return localStorage.setItem(t.i$,c.toString())}},92986:(q,j,e)=>{"use strict";e.d(j,{Ao:()=>x,Az:()=>m,DU:()=>p,EY:()=>o,GH:()=>I,H0:()=>G,I1:()=>N,Kf:()=>f,Mi:()=>w,OO:()=>H,PU:()=>c,Pp:()=>A,QX:()=>i,Rp:()=>d,Xt:()=>l,aZ:()=>g,dc:()=>T,gR:()=>E,i$:()=>K,jT:()=>W,jl:()=>M,km:()=>a,lr:()=>b,mW:()=>R,p4:()=>D,sQ:()=>U,tM:()=>v,td:()=>B,ui:()=>s,up:()=>V,ym:()=>z,yr:()=>u});var t=e(91733),n=e(61034),r=e(39344);const a="/explore/metrics/trail",i="/explore/metrics",x="filters",s="${filters}",c="metric",d="${metric}",u="groupby",g="${groupby}",o="ds",E="${ds}",m="logsDs",f="${logsDs}",p="otel_resources",h="${otel_resources}",D="deployment_environment",C="${deployment_environment}",l="otel_join_query",v="${otel_join_query}",y="otel_groupby",P="${otel_groupby}",b="otel_group_left",S="${otel_group_left}",M="missing_otel_targets",O="${missing_otel_targets}",R="otel_and_metric_filters",L="${otel_and_metric_filters}",B="$__logs__",F="sqr-metric-viz-query",I={uid:E},U="grafana.trails.recent",W="grafana.trails.bookmarks",A="grafana.trails.breakdown.view",N="grafana.trails.breakdown.sort",K="grafana.trails.otel.experience.enabled",V=250,T=500;function z(X){return[new n.x0({name:c,value:X,hide:r.zL.hideVariable})]}function w(X){return[new n.x0({name:l,value:X,hide:r.zL.hideVariable})]}class H extends t.x{static{this.type="metric-selected-event"}}class G extends t.a{static{this.type="refresh-metrics-event"}}},56498:(q,j,e)=>{"use strict";e.d(j,{DJ:()=>h,FG:()=>I,KE:()=>C,U4:()=>b,UG:()=>p,Uk:()=>f,Vy:()=>R,WD:()=>U,aM:()=>P,aO:()=>M,ef:()=>l,gA:()=>B,hR:()=>O,iG:()=>L,kj:()=>D,xi:()=>v});var t=e(75505),n=e(93407),r=e(42853),a=e(87574),i=e(32370),x=e(28082),s=e(61034),c=e(81635),d=e(10059),u=e(55522),g=e(75637),o=e(4935),E=e(68612),m=e(92986);function f(W){return W!==null&&W.state.type==="adhoc"}function p(W){return W!==null&&W.state.type==="custom"}function h(W){return W!==null&&W.state.type==="constant"}function D(W){return s.jh.getAncestor(W,u.b)}function C(W){return s.jh.getAncestor(W,u.b).state.settings}function l(W,A){return new u.b({initialDS:W,$timeRange:new s.JZ({from:"now-1h",to:"now"}),embedded:!1,startButtonClicked:A})}function v(W){const A=s.Go.getUrlState(W);return y(A)}function y(W){return n.kM.renderUrl(m.km,W)}function P(W){if(W instanceof g.R)return W;if(W.parent)return P(W.parent);throw console.error("Unable to find graph view for",W),new Error("Unable to find trail")}function b(W){return s.jh.interpolate(W,m.gR)}function S(W){return getDataSourceSrv().getInstanceSettings(W)?.name||W}function M(W){return W?W===m.td?"Logs":W:"All metrics"}function O(){const W=(0,o._r)().recent[0];if(W){const N=s.jh.interpolate(W.resolve(),m.gR);if(N.length>0)return N}const A=(0,d.tR)().getList({type:"prometheus"});if(A.length>0)return A.find(K=>K.isDefault)?.uid??A[0].uid}function R(W){const A=i.$.theme2.visualization;return A.getColorByName(A.palette[W%8])}function L(W){const A=Object.keys(W);return A.includes("from")&&A.includes("to")}function B(W){const A=s.jh.lookupVariable("filters",W);return A instanceof s.H9?A.state.filters:null}const F=1e4;function I(W,A,N){A instanceof s.H9&&A.setState({getTagKeysProvider:async(K,V)=>{const T=A.state.filters,z={filters:T,scopes:(0,c.DF)(K)?.value,queries:W.getQueries()};z.queries.length>20&&(z.queries=[]);let w=(await N.getTagKeys(z)).slice(0,F);return A.state.name===m.mW&&(w=(0,E.ql)(w,T.map(H=>H.key))),{replace:!0,values:w}},getTagValuesProvider:async(K,V)=>{const z=A.state.filters.filter(G=>G.key!==V.key),w={key:V.key,filters:z,scopes:(0,c.DF)(K)?.value,queries:W.getQueries()};return w.queries.length>20&&(w.queries=[]),{replace:!0,values:(await N.getTagValues(w)).slice(0,F)}}})}async function U(W,A,N,K,V,T,z){return await(0,t.s)((0,x.AI)().fetch({url:`/api/datasources/uid/${W}/resources/suggestions`,data:{labelName:V,queries:[],scopes:N.reduce((w,H)=>(w.push(...H.spec.filters),w),[]),adhocFilters:K.map(w=>({key:w.key,operator:r.n[w.operator],value:w.value,values:w.values})),start:(0,a.mv)(A.from,!1).toString(),end:(0,a.mv)(A.to,!0).toString(),limit:T},requestId:z,method:"POST",headers:{"Content-Type":"application/json"}}))}},83283:(q,j,e)=>{"use strict";e.d(j,{J:()=>f});var t=e(7500),n=e(59698),r=e(74848),a=e(96540),i=e(47180),x=e(39736),s=e(19550),c=e(60641),d=e(19575),u=e(24847),g=e(54598);const o=[{label:"Size",value:t.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:t.J1.Count,description:"Split the buckets based on count"}],E=[{label:"Split",value:t.J1.Size,description:"Split the buckets based on size"}],m=({value:p,onChange:h,item:D})=>{const[C,l]=(0,a.useState)(!1),v=(0,a.useRef)(0),y=D.settings?.allowInterval??!1,P=({mode:M,scale:O,value:R=""})=>{let L=!0;M!==t.J1.Count&&(y?R!==""&&(0,g.Fv)(R)===void 0&&(L=!1):L=(0,u.N_)(R)),l(!L),h({mode:M,scale:O,value:R})},S=(0,x.w)().getVariables().map(M=>({value:M.name,label:M.label||M.name,origin:i.$0.Template}));return(0,r.jsxs)(s.Gy,{children:[(0,r.jsx)(c.z,{value:p?.mode||t.J1.Size,options:p?.scale?.type===t.L4.Log?E:o,onChange:M=>{v.current++,P({...p,value:"",mode:M})}}),(0,r.jsx)(d.y,{invalid:C,error:"Value needs to be an integer or a variable",value:p?.value??"",placeholder:"Auto",onChange:M=>{P({...p,value:M})},suggestions:S},v.current)]})};function f(p,h,D,C){h.addCustomEditor({id:"xBuckets",path:`${p}xBuckets`,name:"X Bucket",editor:m,category:C,defaultValue:{mode:t.J1.Size},settings:{allowInterval:!0}}),h.addCustomEditor({id:"yBuckets",path:`${p}yBuckets`,name:"Y Bucket",editor:m,category:C,defaultValue:{mode:t.J1.Size}}),h.addCustomEditor({id:"yBuckets-scale",path:`${p}yBuckets.scale`,name:"Y Bucket scale",category:C,editor:n.W1,defaultValue:{type:t.L4.Linear}})}},75771:(q,j,e)=>{"use strict";e.d(j,{Nb:()=>p,VQ:()=>C,eE:()=>f,wY:()=>o,yJ:()=>h});var t=e(81160),n=e(66564),r=e(19844),a=e(63739),i=e(23570),x=e(59141),s=e(47370),c=e(27844),d=e(77230),u=e(7500),g=e(54598);const o={id:n.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:P=>{const{xField:b,yField:S,xs:M,ys:O}=l(P);return b||S||!M.length||!O.length?r.M.NotPossible:r.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(P,b)=>S=>S.pipe((0,t.T)(M=>o.transformer(P,b)(M))),transformer:P=>b=>{const S=C(b,P);return P.keepOriginalData?[S,...b]:[S]}};function E(P){return P==="+Inf"?1/0:P==="-Inf"?-1/0:+(P??0)}function m(P,b){return E(P)-E(b)}function f(P){return P?.meta?.custom??{}}function p(P){let b=!1;for(let S of P.fields)switch(S.name){case"y":case"yMin":case"yMax":if(b)return!1;b=!0}return b}function h(P){const b=P.frame.fields[0],S=b.values,M=P.frame.fields.filter((N,K)=>N.type===a.PU.number&&K>0),O=S.length*M.length,R=new Array(O),L=new Array(O),B=new Array(O),F=M.map(N=>N.values.slice());F.forEach((N,K)=>{for(let V=0;V<N.length;V++)B[F.length*V+K]=N[V]});const I=Array.from({length:M.length},(N,K)=>K);for(let N=0,K=0,V=0;N<O;K=++N%I.length)L[N]=I[K],K===0&&N>=I.length&&V++,R[N]=S[V];let U=M[0].labels?.le!=null?"yMax":"y";switch(P.layout){case u.D7.le:U="yMax";break;case u.D7.ge:U="yMin";break;case u.D7.unknown:U="y";break}const W={yOrdinalDisplay:M.map(N=>(0,i.Ct)(N,P.frame)),yMatchWithLabel:Object.keys(M[0].labels??{})[0]};if(W.yMatchWithLabel&&(W.yOrdinalLabel=M.map(N=>N.labels?.[W.yMatchWithLabel]??""),W.yMatchWithLabel==="le"&&(W.yMinDisplay="0.0")),P.unit?.length||P.decimals!=null){const N=(0,x.j_)(P.unit??"short");W.yMinDisplay&&(W.yMinDisplay=(0,x.cN)(N(0,P.decimals))),W.yOrdinalDisplay=W.yOrdinalDisplay.map(K=>{let V=+K;return Number.isNaN(V)?K:(0,x.cN)(N(V,P.decimals))})}const A={...M[0].config};return A.displayNameFromDS&&delete A.displayNameFromDS,{length:R.length,refId:P.frame.refId,meta:{type:s.m.HeatmapCells,custom:W},fields:[{name:b.type===a.PU.time?"xMax":"x",type:b.type,values:R,config:b.config},{name:U,type:a.PU.number,values:L,config:{unit:"short"}},{name:P.value?.length?P.value:"Value",type:a.PU.number,values:B,config:A,display:M[0].display}]}}function D(P){P=P.slice(),P.sort((S,M)=>m(S.name,M.name));const b=P.map(S=>S.fields[1].values.slice());return b.reverse(),b.forEach((S,M)=>{if(M<b.length-1)for(let O=0;O<S.length;O++)S[O]-=b[M+1][O]}),b.reverse(),P.map((S,M)=>({...S,fields:[S.fields[0],{...S.fields[1],values:b[M]}]}))}function C(P,b){const{xField:S,yField:M,xs:O,ys:R}=l(P);if(!S||!M)throw"no heatmap fields found";if(!O.length||!R.length)throw"no values found";const L=b.xBuckets??{},B=b.yBuckets??{};if(L.scale?.type===u.L4.Log)throw"X axis only supports linear buckets";const F=b.yBuckets?.scale??{type:u.L4.Linear},I=v(O,R,{xSorted:(0,d.g2)(O),xTime:S.type===a.PU.time,xMode:L.mode,xSize:L.mode===u.J1.Size?(0,g.Fv)(L.value??""):L.value?+L.value:void 0,yMode:B.mode,ySize:B.value?+B.value:void 0,yLog:F?.type===u.L4.Log?F?.log:void 0,xMin:b.timeRange?.from.valueOf(),xMax:b.timeRange?.to.valueOf()});return{length:I.x.length,name:(0,i.Ct)(M),meta:{type:s.m.HeatmapCells},fields:[{name:"xMin",type:S.type,values:I.x,config:S.config},{name:"yMin",type:a.PU.number,values:I.y,config:{...M.config,custom:{scaleDistribution:F}}},{name:"Count",type:a.PU.number,values:I.count,config:{unit:"short"}}]}}function l(P){let b,S,M=0;for(let B of P)B.fields.find(I=>I.type===a.PU.time)&&(M+=B.length);let O=Array(M),R=Array(M),L=0;for(let B of P){const F=B.fields.find(U=>U.type===a.PU.time);if(!F)continue;b||(b=F);const I=F.values;for(let U of B.fields)if(U!==F&&U.type===a.PU.number){const W=U.values;for(let A=0;A<I.length;A++,L++)O[L]=I[A],R[L]=W[A];S||(S=U)}}return{xField:b,yField:S,xs:O,ys:R}}function v(P,b,S){let M=P.length,O=S?.xSorted??!1,R=S?.ySorted??!1,L=S?.xMin??(O?P[0]:1/0),B=R?b[0]:1/0,F=S?.xMax??(O?P[M-1]:-1/0),I=R?b[M-1]:-1/0,U=S?.yLog,W=S?.xMin!=null&&S?.xMax!=null,A=S?.yMin!=null&&S?.yMax!=null;for(let ae=0;ae<M;ae++)!O&&!W&&(L=Math.min(L,P[ae]),F=Math.max(F,P[ae])),!R&&!A&&(!U||b[ae]>0)&&(B=Math.min(B,b[ae]),I=Math.max(I,b[ae]));let N=S?.xSize??0,K=S?.ySize??0,V=S?.xMode,T=S?.yMode;if((!Number.isFinite(N)||N<=0)&&(V=u.J1.Count,N=20),(!Number.isFinite(K)||K<=0)&&(T=u.J1.Count,K=10),V===u.J1.Count){let ae=(F-L)/Math.max(N-1,1),re=S?.xTime?g.q_:g.eO,ne=re.findIndex(ce=>ce>ae)-1;N=re[Math.max(ne,0)]}if(T===u.J1.Count){let ae=(I-B)/Math.max(K-1,1),re=S?.yTime?g.q_:g.eO,ne=re.findIndex(ce=>ce>ae)-1;K=re[Math.max(ne,0)]}let z=S?.xCeil?ae=>(0,c.Uh)(ae,N):ae=>(0,c.rs)(ae,N),w=S?.yCeil?ae=>(0,c.Uh)(ae,K):ae=>(0,c.rs)(ae,K);if(U){K=1/(S?.ySize??1);let ae=U===2?Math.log2:Math.log10;w=S?.yCeil?re=>(0,c.Uh)(ae(re),K):re=>(0,c.rs)(ae(re),K)}let H=z(L),G=z(F),X=w(B),k=w(I),_=Math.round((G-H)/N)+1,ee=Math.round((k-X)/K)+1,[J,Z,te]=y(_,ee,H,N,X,K,U);for(let ae=0;ae<M;ae++){if(U&&b[ae]<=0)continue;const re=(z(P[ae])-H)/N,ne=(w(b[ae])-X)/K,ce=re*ee+ne;te[ce]++}return{x:J,y:Z,count:te}}function y(P,b,S,M,O,R,L){const B=P*b,F=new Array(B),I=new Array(B),U=new Array(B);for(let W=0,A=0,N=S;W<B;A=++W%b)U[W]=0,L?I[W]=L**(O+A*R):I[W]=O+A*R,A===0&&W>=b&&(N+=M),F[W]=N;return[F,I,U]}},54598:(q,j,e)=>{"use strict";e.d(j,{Fv:()=>v,eO:()=>m,q_:()=>l});var t=e(12936),n=e(66102),r=e(24847);const{abs:a,pow:i}=Math,x=new Map;function s(y,P,b,S){let M=[],O=S.map(t.E);for(let R=P;R<b;R++){let L=a(R),B=(0,t.h)(i(y,R),L);for(let F=0;F<S.length;F++){let I=S[F]*B,U=(I>=0&&R>=0?0:L)+(R>=O[F]?0:O[F]),W=(0,t.h)(I,U);M.push(W),x.set(W,U)}}return M}const c=y=>y%1===0,d=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],u=s(10,-16,0,d),g=s(10,0,16,d),o=g.filter(c),E=u.concat(g),m=u.concat(o),f=1*1e3,p=60*f,h=60*p,D=24*h,C=365*D,l=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,f,2*f,4*f,5*f,10*f,15*f,20*f,30*f,p,2*p,4*p,5*p,10*p,15*p,20*p,30*p,h,2*h,4*h,6*h,8*h,12*h,18*h,D,2*D,3*D,4*D,5*D,6*D,7*D,10*D,15*D,30*D,45*D,60*D,90*D,180*D,C,2*C,3*C,4*C,5*C,6*C,7*C,8*C,9*C,10*C],v=y=>{if((0,r.N_)(y)){const b=Number.parseInt(y,10);return Number.isNaN(b)?void 0:b}else{if((0,n.di)(y))return(0,n.WT)((0,n.E9)(y));{const S=y.match(/(\d+)ms$/i);if(S){const M=Number.parseInt(S[1],10);return Number.isNaN(M)?void 0:M}else return}}}},15817:(q,j,e)=>{"use strict";e.d(j,{$n:()=>r,g_:()=>t,uk:()=>n});var t=(i=>(i.ShortcodeFigure="shortcodeFigure",i.UIImage="uiImage",i))(t||{});const n={calculateField:{name:"Add field from calculation",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
  - **All number fields** - Set the left side of a **Binary operation** to apply the calculation to all number fields.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${a("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",i,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.

> **Note:** When you use this transformation for thresholds, the visualization continues to use the panel's base threshold.

  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **RegExp** - Parse content using a regular expression with [named capturing group(s)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group) like \`/(?<NewField>.*)/\`.
  ${a("/media/docs/grafana/panels-visualizations/screenshot-regexp-detail-v11.3-2.png",i,"Example of a regular expression")}
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${a("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",i,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${a("/static/img/docs/transformations/filter-name-table-before-7-0.png",i,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${a("/static/img/docs/transformations/filter-name-table-after-7-0.png",i,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${a("/static/img/docs/transformations/filter-name-stat-after-7-0.png",i,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(i="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${a("/static/img/docs/transformations/nested-table-select-calculation.png",i,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${a("/static/img/docs/transformations/nested-table-select-stat.png",i,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${a("/static/img/docs/transformations/join-fields-before-7-0.png",i,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${a("/static/img/docs/transformations/join-fields-after-7-0.png",i,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

Using a negative number, you can keep values from the end of the set. Here is the result after adding a Limit transformation with a value of '-3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |


This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${a("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",i,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${a("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",i,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${a("/static/img/docs/transformations/table-sparklines.png",i,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${a("/static/img/docs/transformations/timeseries-table-select-stat.png",i,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},transpose:{name:"Transpose",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to pivot the data frame, converting rows into columns and columns into rows. This transformation is particularly useful when you want to switch the orientation of your data to better suit your visualization needs.
If you have multiple types it will default to string type.

**Before Transformation:**

| env  | January   | February |
| ---- | --------- | -------- |
| prod | 1 | 2 |
| dev | 3 | 4 |

**After applying transpose transformation:**

| Field  | prod   | dev |
| ---- | --------- | -------- |
| January | 1 | 3 |
| February  | 2 | 4 |

${a("/media/docs/grafana/transformations/screenshot-grafana-11-2-transpose-transformation.png",i,"Before and after transpose transformation")}
  `}},regression:{name:"Regression analysis",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${a("/static/img/docs/transformations/linear-regression.png",i,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${a("/static/img/docs/transformations/polynomial-regression.png",i,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function r(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function a(i,x,s){return x==="shortcodeFigure"?`{{< figure src="${i}" class="docs-image--no-shadow" max-width= "1100px" alt="${s}" >}}`:`![${s}](https://grafana.com${i})`}},79411:(q,j,e)=>{"use strict";e.d(j,{YD:()=>a,dy:()=>n,kD:()=>r});var t=e(7500),n=(x=>(x.Prepare="prepare",x.Calculate="calculate",x.Modify="modify",x))(n||{}),r=(x=>(x.Heading="heading",x.Distance="distance",x.Area="area",x))(r||{}),a=(x=>(x.AsLine="asLine",x.LineBuilder="lineBuilder",x))(a||{});const i={action:"prepare",source:{mode:t.aG.Auto}}},30352:(q,j,e)=>{"use strict";e.d(j,{EX:()=>u,pp:()=>o,tt:()=>c});var t=e(70915),n=e(11217),r=e(44294),a=e(22796),i=e(52490),x=e(63739),s=e(79411);function c(E){const m=[];for(const f of E.values)f&&m.push(u(f));return new n.A(m)}function d(E){const m=new Array(E.length);if(E.length>1){let f=g(E[0]);for(let p=1;p<E.length;p++){let h=g(E[p]);if(f&&h){let D=Math.atan2(h[0]-f[0],h[1]-f[1])*180/Math.PI;D<0&&(D+=360),m[p-1]=m[p]=D}}}else m.fill(0);return m}function u(E){return E instanceof r.A?E.getCoordinates():(0,t.q1)(E.getExtent())}function g(E){if(E)return(0,a.WP)(u(E))}function o(E,m){const f=E.values,p=new Array(E.values.length),h=m.calc??s.kD.Heading,D=m.field??h;switch(h){case s.kD.Area:{for(let C=0;C<f.length;C++){const l=f[C];l&&(p[C]=(0,i.UG)(l))}return{name:D,type:x.PU.number,config:{unit:"areaM2"},values:p}}case s.kD.Distance:{for(let C=0;C<f.length;C++){const l=f[C];l&&(p[C]=(0,i.R3)(l))}return{name:D,type:x.PU.number,config:{unit:"lengthm"},values:p}}case s.kD.Heading:default:return{name:D,type:x.PU.number,config:{unit:"degree"},values:d(f)}}}},19575:(q,j,e)=>{"use strict";e.d(j,{c:()=>p,y:()=>D});var t=e(74848),n=e(22803),r=e(34743),a=e(83505),i=e(46885),x=e(96540),s=e(29675),c=e(75606),d=e(99134),u=e(64467),g=e(50926),o=e(79712),E=e(34128);const m=(l,v)=>l-v*Math.floor(l/v),f=8;var p=(l=>(l.InputElement="input",l.TextAreaElement="textarea",l))(p||{});const h=(l,v)=>({suggestionsWrapper:(0,n.css)({boxShadow:l.shadows.z2}),errorTooltip:(0,n.css)({position:"absolute",top:v+f+"px",zIndex:l.zIndex.tooltip}),inputWrapper:(0,n.css)({position:"relative"})}),D=({value:l="",onChange:v,suggestions:y,placeholder:P,error:b,invalid:S,type:M="input",style:O,autoFocus:R=!1})=>{const[L,B]=(0,x.useState)(!1),[F,I]=(0,x.useState)(0),[U,W]=(0,x.useState)(l.toString()),A=(0,x.useRef)(null),[N,K]=(0,x.useState)(0),[V,T]=(0,x.useState)(0),[z,w]=(0,x.useState)(0),H=(0,s.$j)(),G=h(H,V),X=(0,x.useRef)();(0,x.useEffect)(()=>{A.current?.scrollTo(0,N)},[N]);const k=[(0,r.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:_,floatingStyles:ee}=(0,a.we)({open:L,placement:"bottom-start",onOpenChange:B,middleware:k,whileElementsMounted:i.ll,strategy:"fixed"}),J=(0,x.useCallback)(le=>{_.setReference(le),X.current=le},[_]),Z=(0,x.useRef)(null);(0,x.useEffect)(()=>{K(C(Z.current,F))},[F]);const te=x.useCallback((le,he=X.current)=>{const oe=he.selectionStart,de=he.value;de[z-1]==="$"?he.value=de.slice(0,z)+le.value+de.slice(oe):he.value=de.slice(0,z)+`\${${le.value}}`+de.slice(oe),W(he.value),B(!1),I(0),v(he.value)},[v,z]),ae=x.useCallback(le=>{if(!L){if(le.key==="$"||le.key===" "&&le.ctrlKey){w(X.current.selectionStart||0),B(!0);return}return}switch(le.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return B(!1),I(0);case"Enter":return le.preventDefault(),te(y[F]);case"ArrowDown":case"ArrowUp":le.preventDefault();const he=le.key==="ArrowDown"?1:-1;return I(oe=>m(oe+he,y.length));default:return}},[L,y,F,te]),re=x.useCallback(le=>{W(le.currentTarget.value)},[]),ne=x.useCallback(le=>{v(le.currentTarget.value)},[v]);(0,x.useEffect)(()=>{T(X.current.clientHeight)},[]);const ce={placeholder:P,invalid:S,value:U,onChange:re,onBlur:ne,onKeyDown:ae};return(0,t.jsxs)("div",{className:G.inputWrapper,style:O??{},children:[L&&(0,t.jsx)(c.ZL,{children:(0,t.jsx)("div",{ref:_.setFloating,style:ee,className:G.suggestionsWrapper,children:(0,t.jsx)(d.P,{maxHeight:"300px",onScroll:le=>K(le.currentTarget.scrollTop??0),ref:A,children:(0,t.jsx)(o.k,{activeRef:Z,suggestions:y,onSuggestionSelect:te,onClose:()=>B(!1),activeIndex:F})})})}),S&&b&&(0,t.jsx)("div",{className:G.errorTooltip,children:(0,t.jsx)(u.P,{children:b})}),M==="input"?(0,t.jsx)(E.p,{...ce,ref:J,autoFocus:R}):(0,t.jsx)(g.f,{...ce,ref:J,autoFocus:R,rows:5})]})};D.displayName="SuggestionsInput";function C(l,v){return(l?.clientHeight??0)*v}},24847:(q,j,e)=>{"use strict";e.d(j,{I9:()=>g,N_:()=>d,ZI:()=>x,aG:()=>s,eJ:()=>c,qt:()=>u});var t=e(96540),n=e(23570),r=e(58064),a=e(47180),i=e(39736);function x(o){return(0,t.useMemo)(()=>Array.isArray(o)?Object.keys(o.reduce((E,m)=>!m||!Array.isArray(m.fields)?E:m.fields.reduce((f,p)=>{const h=(0,n.Ct)(p,m,o);return f[h]=!0,f},E),{})):[],[o])}function s(o){const E=new Set;for(const m of o)for(const f of m.fields)if(f.labels)for(const p of Object.keys(f.labels))E.add(p);return E}const c={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},d=o=>!!(typeof o=="number"||!Number.isNaN(Number(o))||/^\$[A-Za-z0-9_]+$/.test(o));function u(o){const E=[];o&&(E.push({label:"Browser",value:"browser"}),E.push({label:"UTC",value:"utc"}));const m=(0,r.P3)();for(const f of m)E.push({label:f,value:f});return E}function g(){return(0,i.w)().getVariables().map(o=>({value:o.name,label:o.label||o.name,origin:a.$0.Template}))}},11488:(q,j,e)=>{"use strict";e.d(j,{$u:()=>g,Ay:()=>f,Cj:()=>c,EC:()=>u,Y_:()=>s,dJ:()=>o,g4:()=>d,jE:()=>E,t_:()=>i});var t=e(65307),n=e(88023);const r={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:n.Ay.externalUserMngInfo,externalUserMngLinkName:n.Ay.externalUserMngLinkName,externalUserMngLinkUrl:n.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},a=(0,t.Z0)({name:"users",initialState:r,reducers:{usersLoaded:(p,h)=>{const{totalCount:D,perPage:C,page:l,orgUsers:v}=h.payload,y=Math.ceil(D/C);return{...p,isLoading:!0,users:v,perPage:C,page:l,totalPages:y}},searchQueryChanged:(p,h)=>({...p,searchQuery:h.payload,page:r.page}),setUsersSearchPage:(p,h)=>({...p,page:h.payload}),pageChanged:(p,h)=>({...p,page:h.payload}),sortChanged:(p,h)=>({...p,sort:h.payload}),usersFetchBegin:p=>({...p,isLoading:!0}),usersFetchEnd:p=>({...p,isLoading:!1}),rolesFetchBegin:p=>({...p,rolesLoading:!0}),rolesFetchEnd:p=>({...p,rolesLoading:!1})}}),{searchQueryChanged:i,setUsersSearchPage:x,usersLoaded:s,usersFetchBegin:c,usersFetchEnd:d,pageChanged:u,sortChanged:g,rolesFetchBegin:o,rolesFetchEnd:E}=a.actions,f={users:a.reducer}},23431:(q,j,e)=>{"use strict";e.d(j,{o:()=>n});var t=e(32370);function n(r){const a=new URL(t.$.externalUserMngLinkUrl);return t.$.externalUserMngAnalytics&&(t.$.externalUserMngAnalyticsParams&&t.$.externalUserMngAnalyticsParams.split("&").forEach(x=>{const[s,c]=x.split("=");a.searchParams.append(s,c)}),a.searchParams.append("cnt",r)),a.toString()}},19639:(q,j,e)=>{"use strict";e.d(j,{B:()=>n});var t=e(64015);const n=new t.O},34394:(q,j,e)=>{"use strict";e.d(j,{$u:()=>m,D4:()=>h,Iv:()=>D,U2:()=>p,VT:()=>f,z_:()=>E});var t=e(2543),n=e.n(t),r=e(10059),a=e(5353),i=e(21658),x=e(20138),s=e(5636),c=e(58843),d=e(30990),u=e(2510),g=e(3485);const o="Filters",E=v=>async(y,P)=>{let b=l(v,P());if(!b&&(y(C(v)),b=l(v,P()),!b))return;const S=b.filters.findIndex(O=>O.key===v.key&&O.value===v.value);if(S===-1){const{value:O,key:R,operator:L}=v,B={value:O,key:R,operator:L};return await y(p((0,u.jX)(b),B))}const M={...b.filters[S],operator:v.operator};return await y(m((0,u.jX)(b),{index:S,filter:M}))},m=(v,y)=>async(P,b)=>{const S=(0,c.dn)(v,b());P((0,s.kb)(v.rootStateKey,(0,g.E2)((0,u.qD)(S,y)))),await P((0,x.us)((0,u.jX)(S),!0))},f=(v,y)=>async(P,b)=>{const S=(0,c.dn)(v,b());P((0,s.kb)(v.rootStateKey,(0,g.D$)((0,u.qD)(S,y)))),await P((0,x.us)((0,u.jX)(S),!0))},p=(v,y)=>async(P,b)=>{const S=(0,c.dn)(v,b());P((0,s.kb)(v.rootStateKey,(0,g.xt)((0,u.qD)(S,y)))),await P((0,x.us)((0,u.jX)(S),!0))},h=(v,y)=>async(P,b)=>{const S=(0,c.dn)(v,b());P((0,s.kb)(v.rootStateKey,(0,g.qZ)((0,u.qD)(S,y)))),await P((0,x.us)((0,u.jX)(S),!0))},D=(v,y)=>async(P,b)=>{const S=(0,c.dn)(v,b());P((0,s.kb)(v.rootStateKey,(0,d.QP)((0,u.qD)(S,{propName:"datasource",propValue:y}))));const O=(await(0,r.tR)().get(y))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";P((0,s.kb)(v.rootStateKey,(0,a.BC)({infoText:O})))},C=v=>(y,P)=>{const b=(0,c.y7)(P()),S={...(0,t.cloneDeep)(g.MK),datasource:v.datasource,name:o,id:o,rootStateKey:b},M=!1,O=(0,c.hk)(b,P()),R={type:"adhoc",id:S.id,rootStateKey:b};y((0,s.kb)(b,(0,d.QV)((0,u.qD)(R,{global:M,model:S,index:O}))))},l=(v,y)=>{const P=(0,c.y7)(y),b=(0,c.nx)(P,y);let S;for(const M of Object.values(b.variables))if((0,i.EW)(M)&&M.datasource?.uid===v.datasource.uid){S=M;break}return S}},3485:(q,j,e)=>{"use strict";e.d(j,{AA:()=>g,D$:()=>c,E2:()=>d,MK:()=>i,qZ:()=>u,xt:()=>s});var t=e(65307),n=e(76802),r=e(58843),a=e(64744);const i={...n.Vg,type:"adhoc",datasource:null,filters:[]},x=(0,t.Z0)({name:"templating/adhoc",initialState:a.j,reducers:{filterAdded:(o,E)=>{const m=(0,r.Fs)(o,E.payload.id);m.type==="adhoc"&&m.filters.push(E.payload.data)},filterRemoved:(o,E)=>{const m=(0,r.Fs)(o,E.payload.id);if(m.type!=="adhoc")return;const f=E.payload.data;m.filters.splice(f,1)},filterUpdated:(o,E)=>{const m=(0,r.Fs)(o,E.payload.id);if(m.type!=="adhoc")return;const{filter:f,index:p}=E.payload.data;m.filters[p]=f},filtersRestored:(o,E)=>{const m=(0,r.Fs)(o,E.payload.id);m.type==="adhoc"&&(m.filters=E.payload.data)}}}),{filterAdded:s,filterRemoved:c,filterUpdated:d,filtersRestored:u}=x.actions,g=x.reducer},44690:(q,j,e)=>{"use strict";e.d(j,{Ek:()=>i,To:()=>r,Zm:()=>n,ou:()=>a,qF:()=>t,qz:()=>x});const t="00000000-0000-0000-0000-000000000000",n="All",r="$__all",a="None",i="",x="var-"},31139:(q,j,e)=>{"use strict";e.d(j,{c:()=>c,z:()=>d});var t=e(74848),n=e(92145),r=e(96540),a=e(58779),i=e(29675),x=e(50926),s=e(36390);const c="Grafana-LegacyVariableQueryEditor",d=({onChange:u,query:g})=>{const o=(0,i.of)(s.$),[E,m]=(0,r.useState)(g),f=D=>{m(D.currentTarget.value)},p=(0,r.useCallback)(D=>{u(D.currentTarget.value,D.currentTarget.value)},[u]),h=(0,n.Bi)();return(0,t.jsx)(x.f,{id:h,rows:2,value:E,onChange:f,onBlur:p,placeholder:"Metric name or tags query",required:!0,"data-testid":a.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:o.textarea})};d.displayName=c},5596:(q,j,e)=>{"use strict";e.d(j,{y:()=>s});var t=e(74848),n=e(96540),r=e(39736),a=e(45251),i=e(21658),x=e(31139);async function s(d,u=a.cS){if((0,i.zs)(d))return d.variables.editor;if((0,i.X3)(d)){const g=await u(d.meta);if(!g.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return g.components.QueryEditor??null}return(0,i.Hf)(d)?c:(0,i.d5)(d)?(await u(d.meta)).components.VariableQueryEditor??x.z:null}function c({datasource:d,query:u,onChange:g}){const o=(0,n.useCallback)(E=>{g({refId:"StandardVariableQuery",query:E})},[g]);return(0,t.jsx)(x.z,{query:u.query,onChange:o,datasource:d,templateSrv:(0,r.w)()})}},5353:(q,j,e)=>{"use strict";e.d(j,{BC:()=>d,DW:()=>x,Eo:()=>g,FN:()=>i,NY:()=>u,T7:()=>c,nS:()=>n,sJ:()=>s,wf:()=>a,y8:()=>o});var t=e(65307);const n={id:"",isValid:!0,errors:{},name:"",extended:null},r=(0,t.Z0)({name:"templating/editor",initialState:n,reducers:{variableEditorMounted:(E,m)=>{E.name=m.payload.name,E.id=m.payload.id},variableEditorUnMounted:(E,m)=>n,changeVariableNameSucceeded:(E,m)=>{E.name=m.payload.data.newName,delete E.errors.name,E.isValid=Object.keys(E.errors).length===0},changeVariableNameFailed:(E,m)=>{E.name=m.payload.newName,E.errors.name=m.payload.errorText,E.isValid=Object.keys(E.errors).length===0},addVariableEditorError:(E,m)=>{E.errors[m.payload.errorProp]=m.payload.errorText,E.isValid=Object.keys(E.errors).length===0},removeVariableEditorError:(E,m)=>{delete E.errors[m.payload.errorProp],E.isValid=Object.keys(E.errors).length===0},changeVariableEditorExtended:(E,m)=>{E.extended={...E.extended,...m.payload}},cleanEditorState:()=>n}}),a=r.reducer,{changeVariableNameSucceeded:i,changeVariableNameFailed:x,variableEditorMounted:s,variableEditorUnMounted:c,changeVariableEditorExtended:d,addVariableEditorError:u,removeVariableEditorError:g,cleanEditorState:o}=r.actions},86796:(q,j,e)=>{"use strict";e.d(j,{M:()=>t});var t=(n=>(n[n.MaxSize=50]="MaxSize",n))(t||{})},86278:(q,j,e)=>{"use strict";e.d(j,{z:()=>a});var t=e(39736),n=e(19639),r=e(44690);function a(i){const x={},s=(0,t.w)().getVariables();for(let c=0;c<s.length;c++){const d=s[c],u=i&&i[d.name];d.skipUrlSync||(u?x[r.qz+d.name]=u.value:x[r.qz+d.name]=n.B.get(d.type).getValueForUrl(d))}return x}},21658:(q,j,e)=>{"use strict";e.d(j,{CH:()=>f,EW:()=>a,Hf:()=>g,P4:()=>r,SP:()=>s,VN:()=>m,VO:()=>i,X3:()=>E,d5:()=>u,iv:()=>x,m8:()=>c,zs:()=>o});var t=e(50471),n=e(31139);const r=p=>p.type==="query",a=p=>p.type==="adhoc",i=p=>p.type==="constant",x=p=>"multi"in p,s=p=>"options"in p,c=p=>"current"in p;function d(p){return p===null?!1:typeof p=="string"}const u=p=>!!p.metricFindQuery&&!p.variables,g=p=>{if(!p.variables||p.variables.getType()!==t.Qz.Standard)return!1;const h=p.variables;return"toDataQuery"in h&&!!h.toDataQuery},o=p=>{if(!p.variables||p.variables.getType()!==t.Qz.Custom)return!1;const h=p.variables;return"query"in h&&"editor"in h&&!!h.query&&!!h.editor},E=p=>p.variables?p.variables.getType()===t.Qz.Datasource:!1;function m(p,h){return p?p.displayName===n.c||u(h):!1}function f(p,h){return p?p.displayName!==n.c&&(E(h)||g(h)||o(h)):!1}},41079:(q,j,e)=>{"use strict";e.d(j,{i:()=>s});var t=e(74848),n=e(96540),r=e(25356);const a=({nodes:c,edges:d,direction:u,width:g,height:o,onDoubleClick:E})=>{const m=(0,n.useRef)(null),f=(0,n.useRef)(null),p=(0,n.useCallback)(h=>{E&&E(h.nodes[0])},[E]);return(0,n.useEffect)(()=>((async()=>{const D=await e.e(5083).then(e.t.bind(e,83416,23)),C={nodes:i(D,c),edges:x(D,d)},l={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:u??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};m.current=new D.Network(f.current,C,l),m.current?.on("doubleClick",p)})(),()=>{m.current&&m.current.off("doubleClick")}),[u,d,c,p]),(0,t.jsx)("div",{children:(0,t.jsx)("div",{ref:f,style:{width:g??"100%",height:o??"60vh"}})})};function i(c,d){const u=d.map(g=>({...g,shape:"box"}));return new c.DataSet(u)}function x(c,d){const u=d.map(g=>({...g,arrows:"to",dashes:!0}));return new c.DataSet(u)}function s({edges:c,nodes:d,show:u,title:g,children:o}){const[E,m]=(0,n.useState)(u),f=(0,n.useCallback)(()=>m(!0),[m]),p=(0,n.useCallback)(()=>m(!1),[m]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.a,{isOpen:E,title:g,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:p,onDismiss:p,children:(0,t.jsx)(a,{nodes:d,edges:c})}),o({showModal:f})]})}},90604:(q,j,e)=>{"use strict";e.d(j,{WT:()=>n,bX:()=>i,t4:()=>a});var t=e(65307);const n={usages:[],usagesNetwork:[]},r=(0,t.Z0)({name:"templating/inspect",initialState:n,reducers:{initInspect:(x,s)=>{const{usages:c,usagesNetwork:d}=s.payload;x.usages=c,x.usagesNetwork=d}}}),a=r.reducer,{initInspect:i}=r.actions},66012:(q,j,e)=>{"use strict";e.d(j,{qJ:()=>u,hI:()=>c,hM:()=>f,H7:()=>d,xU:()=>D,P5:()=>S,Jx:()=>m,g0:()=>p,PK:()=>P,Ow:()=>v});var t=e(46399);function n(M,O){const R=new Set;for(const L of M)R.add(O(L));return R}var r=e(63845),a=e(95536),i=e(19639),x=e(21658),s=e(2510);const c=M=>{const O=[];for(const R of M)O.push({id:R.id,label:`${R.id}`});return O},d=(M,O)=>M.filter(R=>O.some(L=>L.from===R.id||L.to===R.id)),u=M=>{const O=[];for(const R of M)for(const L of M){if(R===L)continue;i.B.get(R.type).dependsOn(R,L)&&O.push({from:R.id,to:L.id})}return O};function g(M){const O=(0,s.t4)(M);if(!O)return;const R=O.slice(1).find(L=>L!==void 0);if(!(R in{}))return R}const o=(M,O)=>{s.SY.lastIndex=0;const R=[],B=(0,a.MA)(O,2).match(s.SY);if(!B)return R;for(const F of B){if(!F||F.indexOf("$__")!==-1||F.indexOf("${__")!==-1||F.indexOf("$hashKey")!==-1)continue;const I=g(F);M.some(U=>U.id===I)||R.find(U=>U===I)||I&&R.push(I)}return R},E={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},m=(M,O,R)=>{const L=Object.keys(O.value).reduce((F,I)=>{const U=O.value[I];if(!U||typeof U!="string")return F;const W=E[I]?E[I].find(N=>N.test(M)):void 0;let A=(0,s.wJ)(U,M);return I==="repeat"&&U===M&&(A=!0),!W&&A&&(F={...F,[I]:U}),F},{}),B=Object.keys(O.value).reduce((F,I)=>{const U=O.value[I];if(U&&typeof U=="object"&&Object.keys(U).length){let W=U.title||U.name||U.id||I;Array.isArray(O.value)&&O.key==="panels"&&(W=`${W}[${U.id}]`);const A=m(M,{key:I,value:U},{});Object.keys(A).length&&(F={...F,[W]:A})}return F},{});return(Object.keys(L).length||Object.keys(B).length)&&(R={...R,...L,...B}),R},f=(M,O)=>{if(!O)return{unUsed:[],usages:[]};const R=[];let L=[];const B=O.getSaveModelCloneOld();for(const F of M){const I=F.id,U=m(I,{key:"model",value:B},{});!Object.keys(U).length&&!(0,x.EW)(F)&&R.push(F),Object.keys(U).length&&L.push({variable:F,tree:U})}return{unUsed:R,usages:L}};async function p(M,O){return new Promise((R,L)=>{setTimeout(()=>{try{const B=h(M,O);R(v(B))}catch(B){L(B)}},200)})}function h(M,O){if(!O)return[];let R=[];const L=O.getSaveModelCloneOld(),B=o(M,L);for(const F of B){const I=m(F,{key:"model",value:L},{});if(Object.keys(I).length){const U={id:F,name:F};R.push({variable:U,tree:I})}}return R}function D(M,O,R){const L=n(O.descendants(M),F=>F.name);L.add(t.c.includeVars);for(const F of M)L.add(F);return C([...L],R)}function C(M,O){const R=[];for(const L of M)O[L]&&R.push(...O[L]);return new Set(R)}const l=(M,O)=>{const{id:R,value:L}=O,{nodes:B,edges:F}=M;if(L&&typeof L=="string"){const I=`${O.id}-${L}`;return B.push({id:I,label:L}),F.push({from:I,to:R}),M}if(L&&typeof L=="object"){const I=Object.keys(L);for(const U of I){const W=`${O.id}-${U}`;B.push({id:W,label:U}),F.push({from:W,to:R}),M=l(M,{id:W,value:L[U]})}return M}return M},v=M=>{const O=[];for(const R of M){const{variable:L,tree:B}=R,F={variable:L,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};O.push(l(F,{id:"dashboard",value:B}))}return O},y=M=>Object.values(M).reduce((R,L)=>typeof L=="object"?R+y(L):R+1,0),P=(M,O)=>{const R=O.find(L=>L.variable.id===M);return R?y(R.tree):0};function b(M){const O=[];for(const R of M)O.push(R),R.panels?.length&&O.push(...b(R.panels.map(L=>new PanelModel(L))));return O}function S(M){const O={};for(const R of M){const L=(0,r.tw)(R),B=[...L.matchAll(/"repeat":"([^"]+)"/g)].map(U=>U[1]),F=L.match(s.SY)?.map(U=>g(U))??[],I=[...B,...F];for(const U of I)U in O?O[U].add(R.id):O[U]=new Set([R.id])}return O}},26197:(q,j,e)=>{"use strict";e.d(j,{E5:()=>u,Ez:()=>c,mn:()=>g});var t=e(65307),n=e(2543),r=e.n(n),a=e(14964),i=e(58843),x=e(64744),s=e(76802);const c={...s.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:a.CO.onTimeRangeChanged,current:{}},d=(0,t.Z0)({name:"templating/interval",initialState:x.j,reducers:{createIntervalOptions:(o,E)=>{const m=(0,i.Fs)(o,E.payload.id);if(m.type!=="interval")return;const f=(0,n.map)(m.query.match(/(["'])(.*?)\1|\w+/g),p=>(p=p.replace(/["']+/g,""),{text:p.trim(),value:p.trim(),selected:!1}));m.auto&&f.length&&f[0].text!=="auto"&&f.unshift({text:"auto",value:"$__auto_interval_"+m.name,selected:!1}),m.options=f}}}),u=d.reducer,{createIntervalOptions:g}=d.actions},74716:(q,j,e)=>{"use strict";e.d(j,{jR:()=>O,Fu:()=>v,$z:()=>d,O$:()=>y,ho:()=>R,MO:()=>l,an:()=>P,U9:()=>C,fx:()=>S,qh:()=>M,S8:()=>b});var t=e(84139),n=e(65307),r=e(2543),a=e(34227);const i=(L,...B)=>B.reduce((F,I)=>I(F),L);var x=e(44690),s=e(21658);const c=/[^ -~]/m,d={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},u=1e3,g=new t.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),o=L=>Array.isArray(L)?L.reduce((B,F)=>((0,r.isString)(F.value)&&(B[F.value]=F),B),{}):{},E=L=>{if(!Array.isArray(L.options))return L.options=[],L;const B=o(L.selectedValues);return L.selectedValues=Object.values(B),L.options=L.options.map(F=>{if(!(0,r.isString)(F.value))return F;const I=!!B[F.value];return F.selected===I?F:{...F,selected:I}}),L.options=m(L.options),L},m=L=>Array.isArray(L)?L.length<=u?L:L.slice(0,u):[],f=L=>{const{options:B,selectedValues:F}=L;return B.length===0||F.length>0||!B[0]||B[0].value!==x.To||(L.selectedValues=[{...B[0],selected:!0}]),L},p=L=>{const{selectedValues:B}=L;return B.length>1&&(L.selectedValues=B.filter(F=>F.value!==x.To)),L},h=L=>L.filter(B=>B.value!==x.To).map(B=>({...B,selected:!0})),D=(0,n.Z0)({name:"templating/optionsPicker",initialState:d,reducers:{showOptions:(L,B)=>{const{query:F,options:I}=B.payload;if(L.highlightIndex=-1,L.options=(0,r.cloneDeep)(I),L.id=B.payload.id,L.queryValue="",L.multi=!1,(0,s.iv)(B.payload)&&(L.multi=B.payload.multi??!1),(0,s.P4)(B.payload)){const{queryValue:U}=B.payload,W=(0,a.E)(F);L.queryValue=W&&U?U:""}return L.selectedValues=L.options.filter(U=>U.selected),i(L,f,E)},hideOptions:(L,B)=>({...d}),toggleOption:(L,B)=>{const{option:F,clearOthers:I,forceSelect:U}=B.payload,{multi:W,selectedValues:A}=L;if(F){const N=!A.find(K=>K.value===F.value&&K.text===F.text);if(F.value===x.To||!W||I)return N||U?L.selectedValues=[{...F,selected:!0}]:L.selectedValues=[],i(L,f,p,E);if(U||N)return L.selectedValues.push({...F,selected:!0}),i(L,f,p,E);L.selectedValues=A.filter(K=>K.value!==F.value&&K.text!==F.text)}else L.selectedValues=[];return i(L,f,p,E)},moveOptionsHighlight:(L,B)=>{let F=L.highlightIndex+B.payload;return F<0?F=-1:F>=L.options.length&&(F=L.options.length-1),{...L,highlightIndex:F}},toggleAllOptions:(L,B)=>{const F=L.selectedValues.find(U=>U.value===x.To),I=L.options.find(U=>U.value===x.To);return L.selectedValues.length>0&&I&&!F?(L.selectedValues=[],L.selectedValues.push({text:I.text??"All",value:I.value,selected:!0}),i(L,E)):F&&L.selectedValues.length===1?(L.selectedValues=h(L.options),i(L,E)):L.selectedValues.length>0&&!I?(L.selectedValues=[],i(L,E)):(L.selectedValues=h(L.options),i(L,E))},updateSearchQuery:(L,B)=>(L.queryValue=B.payload,L),updateOptionsAndFilter:(L,B)=>{const F=L.queryValue.trim();let I=[];if(F==="")I=B.payload;else if(c.test(F))I=B.payload.filter(U=>U.text.includes(F));else{const U=B.payload.map(({text:K})=>Array.isArray(K)?K.toString():K),[W,A,N]=g.search(U,F,5);W?.length&&(A&&N?I=N.map(K=>B.payload[A.idx[K]]):I=W.map(K=>B.payload[K]),I.sort((K,V)=>(K.value===x.To?-1:0)-(V.value===x.To?-1:0)))}if(L.highlightIndex=0,F!==""){let U=I.findIndex(W=>W.value!==x.To);(U===-1||I[U].value!==F)&&(I.unshift({selected:!1,text:"> "+F,value:F}),L.highlightIndex=U===-1?0:U+1)}return L.options=I,i(L,f,E)},updateOptionsFromSearch:(L,B)=>(L.options=B.payload,L.highlightIndex=0,i(L,f,E)),cleanPickerState:()=>d}}),{toggleOption:C,showOptions:l,hideOptions:v,moveOptionsHighlight:y,toggleAllOptions:P,updateSearchQuery:b,updateOptionsAndFilter:S,updateOptionsFromSearch:M,cleanPickerState:O}=D.actions,R=D.reducer},12332:(q,j,e)=>{"use strict";e.d(j,{C:()=>t});const t=(a,i)=>a&&(i&&!Array.isArray(a.value)?{...a,value:r(a.value),text:r(a.text)}:!i&&Array.isArray(a.value)?{...a,value:n(a.value),text:n(a.text)}:a),n=a=>Array.isArray(a)?a.length>0?a[0]:"":a,r=a=>Array.isArray(a)?a:[a]},20138:(q,j,e)=>{"use strict";e.d(j,{Y7:()=>Ge,TI:()=>_,_q:()=>Fe,RK:()=>Se,t9:()=>he,x7:()=>ne,Hn:()=>Qe,mZ:()=>Me,kl:()=>le,us:()=>de});var t=e(2543),n=e(14964),r=e(34923),a=e(8392),i=e(61809),x=e(53027),s=e(18729),c=e(32370),d=e(23737),u=e(61351),g=e(80757),o=e(83394),E=e(17687),m=e(87638),f=e(75911),p=e(83023),h=e(10059),D=e(84395),C=e(19639),l=e(44690),v=e(5353),y=e(21658),P=e(66012),b=e(74716),S=e(12332),M=e(76802),O=e(2510),R=e(13076),L=e(86983),B=e(5636),F=e(91164);const I=(ie,ve=-1,fe=!1,ge=!1)=>{const xe={};if(ge){const je={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Ve={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},ke={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};xe[je.id]=je,xe[Ve.id]=Ve,xe[ke.id]=ke}for(let je=0;je<ie;je++)xe[je]=createQueryVariable({id:je.toString(),name:`Name-${je}`,label:`Label-${je}`,index:je});return fe&&(xe[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:ie})),xe},U=(ie,ve={})=>{const fe={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...ie.initialState,...fe},...ve}}}},W=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),A=()=>combineReducers({templating:keyedVariablesReducer});function N(ie,ve){return{templating:{lastKey:ie,keys:{[ie]:{...getInitialTemplatingState(),...ve}}}}}function K(ie,ve){return ie.find(ge=>ge.name===ve)}function V(ie){return(ie.type==="query"||ie.type==="datasource"||ie.type==="interval")&&ie.refresh===R.CO.onTimeRangeChanged}var T=e(58843),z=e(30990),w=e(85581),H=e(96354);const G=(ie,ve)=>(fe,ge)=>{let xe=0;const je=ve.templating.list;for(let ke=0;ke<je.length;ke++){const Oe=X(je[ke]);Oe.rootStateKey=ie,C.B.getIfExists(Oe.type)&&fe((0,B.kb)(ie,(0,z.QV)((0,O.qD)(Oe,{global:!1,index:xe++,model:Oe}))))}(0,D.w)().updateTimeRange((0,g.jG)().timeRange());const Ve=(0,T.SS)(ie,ge());for(const ke of Ve)fe((0,B.kb)(ie,(0,z.wB)((0,O.qD)(ke))))};function X(ie){if(!(0,y.SP)(ie))return ie;let ve=!1;for(const fe of ie.options)if(fe.selected=!1,Array.isArray(ie.current.value))for(const ge of ie.current.value)fe.value===ge&&(fe.selected=ve=!0);else fe.value===ie.current.value&&(fe.selected=ve=!0);return!ve&&ie.options.length&&(ie.options[0].selected=!0),ie}const k=(ie,ve)=>fe=>{const ge={...M.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:ve.title,uid:ve.uid,toString:()=>ve.title}}};fe((0,B.kb)(ie,(0,z.QV)((0,O.qD)(ge,{global:ge.global,index:ge.index,model:ge}))));const xe={...M.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:u.TP.user.orgName,id:u.TP.user.orgId,toString:()=>u.TP.user.orgId.toString()}}};fe((0,B.kb)(ie,(0,z.QV)((0,O.qD)(xe,{global:xe.global,index:xe.index,model:xe}))));const je={...M.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{login:u.TP.user.login,id:u.TP.user.id,email:u.TP.user.email,toString:()=>u.TP.user.id.toString()}}};fe((0,B.kb)(ie,(0,z.QV)((0,O.qD)(je,{global:je.global,index:je.index,model:je}))))},_=(ie,ve)=>(fe,ge)=>{const{rootStateKey:xe}=ie,je=(0,T.dn)(ie,ge());if(!(0,y.iv)(je)||(0,r.R)(je.current))return;const Ve=(0,S.C)(je.current,ve);fe((0,B.kb)(xe,(0,z.QP)((0,O.qD)(ie,{propName:"multi",propValue:ve})))),fe((0,B.kb)(xe,(0,z.QP)((0,O.qD)(ie,{propName:"current",propValue:Ve}))))},ee=async(ie,ve)=>{if(!ie.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ie.id}`);if(J(ie,ve))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const fe=Z(ie,ve);te(ie.rootStateKey,fe,ve)&&await new Promise(ge=>{const xe=o.M_.subscribe(()=>{if(!ie.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ie.id}`);te(ie.rootStateKey,fe,o.M_.getState())||(xe(),ge())})})},J=(ie,ve,fe=new Set)=>fe.has(ie.id)?!0:(fe=new Set([...fe,ie.id]),Z(ie,ve).some(ge=>J(ge,ve,fe))),Z=(ie,ve)=>{if(!ie.rootStateKey)return[];const fe=[];for(const ge of(0,T.SS)(ie.rootStateKey,ve))ie!==ge&&C.B.getIfExists(ie.type)&&C.B.get(ie.type).dependsOn(ie,ge)&&fe.push(ge);return fe},te=(ie,ve,fe)=>{if(ve.length===0)return!1;const ge=(0,T.SS)(ie,fe);return ve.filter(je=>ge.some(Ve=>Ve.id===je.id&&(Ve.state===a.Gu.NotStarted||Ve.state===a.Gu.Loading))).length>0},ae=(ie,ve)=>async(fe,ge)=>{const xe=(0,T.dn)(ie,ge());await ee(xe,ge());const je=ve[l.qz+xe.name];if(je!==void 0){const Ve=(0,O.QT)(je);await C.B.get(xe.type).setValueFromUrl(xe,Ve);return}if(xe.hasOwnProperty("refresh")){const Ve=xe;if(Ve.refresh===n.CO.onDashboardLoad||Ve.refresh===n.CO.onTimeRangeChanged){await fe(Me((0,O.jX)(Ve)));return}}if(xe.type==="custom"){await fe(Me((0,O.jX)(xe)));return}fe(Ke(ie))},re=ie=>async(ve,fe)=>{const ge=x.Ny.getSearchObject(),xe=(0,T.SS)(ie,fe()).map(async je=>await ve(ae((0,O.jX)(je),ge)));await Promise.all(xe)},ne=(ie,ve)=>async(fe,ge)=>{const xe=(0,O.QT)(ve),je=(0,T.dn)(ie,ge());(0,O.q$)(je)!==n.CO.never&&await fe(Me((0,O.jX)(je)));const Ve=(0,T.dn)((0,O.jX)(je),ge());if(!(0,y.SP)(Ve))return;if(!Ve)throw new Error(`Couldn't find variable with name: ${je.name}`);let ke=Ve.options.find(Oe=>Oe.text===xe||Oe.value===xe);if(!ke&&(0,y.iv)(Ve)&&Ve.allValue&&xe===Ve.allValue&&(ke={text:l.Zm,value:l.To,selected:!1}),!ke){let Oe=xe;const nt=xe;Array.isArray(xe)&&(Oe=xe.reduce((Je,Be)=>{const Ze=Ve.options.find(tt=>tt.value===Be);return Ze?[].concat(Je,[Ze.text]):[].concat(Je,[Be])},[])),ke={text:Oe,value:nt,selected:!1}}(0,y.iv)(Ve)&&(ke=(0,S.C)({text:(0,t.castArray)(ke.text),value:(0,t.castArray)(ke.value),selected:!1},Ve.multi)),await C.B.get(je.type).setValue(Ve,ke)},ce=ie=>{let ve,fe,ge,xe;const je=[];for(ve=0;ve<ie.options.length;ve++)if(xe={...ie.options[ve]},xe.selected=!1,Array.isArray(ie.current.value))for(fe=0;fe<ie.current.value.length;fe++)ge=ie.current.value[fe],xe.value===ge&&(xe.selected=!0,je.push(xe));else xe.value===ie.current.value&&(xe.selected=!0,je.push(xe));return je},le=(ie,ve)=>(fe,ge)=>{const xe=(0,T.dn)(ie,ge());if(!(0,y.SP)(xe))return Promise.resolve();const je=xe.current||{},Ve=C.B.get(xe.type).setValue;if(Array.isArray(je.value)){const Je=ce(xe);if(Je.length===0){const Ze=xe.options[0];return Ve(xe,{value:typeof Ze.value=="string"?[Ze.value]:Ze.value,text:typeof Ze.text=="string"?[Ze.text]:Ze.text,selected:!0})}const Be={value:Je.map(Ze=>Ze.value),text:Je.map(Ze=>Ze.text),selected:!0};return Ve(xe,Be)}let ke=null;const Oe=(0,O.Nz)(xe),nt=(0,O.Lz)(xe);if(ke=xe.options?.find(Je=>Je.text===Oe||Je.value===nt),ke||ve&&(ke=xe.options?.find(Je=>Je.text===ve||Je.value===ve),ke))return Ve(xe,ke);if(xe.options){const Je=xe.options[0];if(Je)return Ve(xe,Je)}return Promise.resolve()},he=(ie,ve,fe)=>async ge=>{const{rootStateKey:xe}=ie;return ge((0,B.kb)(xe,(0,z.dE)((0,O.qD)(ie,{option:ve})))),await ge(de(ie,fe))},oe=ie=>{const ve=new p.TS;return ie.forEach(fe=>{ve.createNode(fe.name)}),ie.forEach(fe=>{ie.forEach(ge=>{if(fe!==ge&&C.B.get(fe.type).dependsOn(fe,ge))try{ve.link(fe.name,ge.name)}catch(xe){const je=xe instanceof Error?xe.message:"Unknown error";(0,s.FF)("Error linking variables",{error:je})}})}),ve},de=(ie,ve,fe=m.lE)=>async(ge,xe)=>{const je=xe(),{rootStateKey:Ve}=ie,ke=(0,T.dn)(ie,je);if((0,T.nx)(Ve,je).transaction.status===M.x8.Fetching)return(0,O.q$)(ke)===n.CO.never&&(await ge(Ie((0,O.jX)(ke))),ge(Ke(ie))),Promise.resolve();const Oe=(0,T.SS)(Ve,je),nt=oe(Oe),Je=je.dashboard?.getModel()?.panels??[],Be=(0,P.P5)(Je),Ze=ke.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,P.xU)([ke.id],nt,Be)),variable:(0,T.dn)(ie,je)},tt=nt.getNode(ke.name);let Re=[];return tt&&(Re=tt.getOptimizedInputEdges().map(at=>{const yt=Oe.find(ze=>ze.name===at.inputNode?.name);return yt?ge(Me((0,O.jX)(yt))):Promise.resolve()})),Promise.all(Re).then(()=>{ve&&(fe.publish(new M.og(Ze)),x.Ny.partial($e(Ve,xe)))})},me=(ie,ve,fe,ge)=>(ve.includes(ie.name)||ve.push(ie.name),ie.outputEdges.forEach(xe=>{const je=xe.outputNode;if(je&&!ve.includes(je.name)){const Ve=fe.find(ke=>ke.name===je.name);Ve&&Ve.refresh===n.CO.onTimeRangeChanged&&ge.indexOf(Ve)===-1?(ge.push(Ve),ve.push(je.name)):me(je,ve,fe,ge)}}),ge),Pe=(ie,ve)=>ie.outputEdges.every(fe=>{const ge=fe.outputNode;if(ge){const xe=K(ve,ge.name);if(xe&&xe.type==="query")return xe.refresh!==n.CO.onTimeRangeChanged}return!0}),Ee=(ie,ve)=>{const fe=(0,T.SS)(ie,ve),ge=oe(fe),xe=[],je=[];return fe.forEach(Ve=>{const ke=ge.getNode(Ve.name);if(!xe.includes(Ve.name)&&ke){const Oe=K(fe,ke.name);if(!Oe)return;const nt=V(Oe);nt&&ke.outputEdges.length===0&&je.push(Oe),nt&&je.includes(Oe)&&ke.outputEdges.length>0&&(je.push(Oe),me(ke,xe,fe,je)),nt&&ke.outputEdges.length>0&&Pe(ke,fe)&&(je.includes(Oe)||je.push(Oe)),!nt&&ke.outputEdges.length>0&&me(ke,xe,fe,je)}}),je},be=(ie,ve)=>(0,T.SS)(ie,ve).filter(xe=>"refresh"in xe&&"options"in xe?xe.refresh===n.CO.onTimeRangeChanged:!1),Se=(ie,ve,fe={templateSrv:(0,D.w)(),events:m.lE})=>async(ge,xe)=>{fe.templateSrv.updateTimeRange(ve);let je=[];c.$.featureToggles.refactorVariablesTimeRange?je=Ee(ie,xe()):je=be(ie,xe());const Ve=je.map(Oe=>Oe.id),ke=je.map(Oe=>ge(Xe((0,O.jX)(Oe))));try{await Promise.all(ke),fe.events.publish(new M.BS({variableIds:Ve}))}catch(Oe){console.error(Oe),ge((0,d.dx)(De("Template variable service failed",Oe)))}},Xe=ie=>async(ve,fe)=>{const ge=(0,T.dn)(ie,fe());if(!(0,y.SP)(ge))return;const xe=ge.options.slice();await ve(Me((0,O.jX)(ge),!0));const je=(0,T.dn)(ie,fe());if(!(0,y.SP)(je))return;const Ve=je.options;JSON.stringify(xe)!==JSON.stringify(Ve)&&fe().dashboard.getModel()?.templateVariableValueUpdated()},Qe=(ie,ve,fe=m.lE)=>async(ge,xe)=>{const je=[],Ve=xe().dashboard.getModel(),ke=(0,T.SS)(ie,xe());for(const Ze of ke){const tt=l.qz+Ze.name;if(!ve.hasOwnProperty(tt)||!we(Ze,ve[tt].value))continue;let Re=ve[tt].value;if(ve[tt].removed){const yt=Ve?.templating.list.find(ze=>ze.name===Ze.name);yt&&(0,y.m8)(yt)&&(Re=yt.current.value),yt&&yt.type==="constant"&&(Re=yt.query)}const at=C.B.get(Ze.type).setValueFromUrl(Ze,Re);je.push(at)}const Oe=ke.filter(Ze=>{const tt=l.qz+Ze.name;return ve.hasOwnProperty(tt)&&we(Ze,ve[tt].value)&&Ze.type!=="adhoc"}),nt=oe(ke),Je=(0,P.P5)(Ve?.panels??[]),Be=(0,P.xU)(Oe.map(Ze=>Ze.id),nt,Je);je.length&&(await Promise.all(je),fe.publish(new M.eF({refreshAll:Be.size===0,panelIds:Array.from(Be)})))};function we(ie,ve){const fe=C.B.get(ie.type).getValueForUrl(ie);let ge=(0,O.QT)(ve);return Array.isArray(fe)&&!Array.isArray(ge)&&(ge=[ge]),!(0,t.isEqual)(fe,ge)}const $e=(ie,ve)=>{const fe=x.Ny.getSearchObject(),ge=Object.keys(fe).filter(xe=>xe.indexOf(l.qz)===-1).reduce((xe,je)=>(xe[je]=fe[je],xe),{});for(const xe of(0,T.SS)(ie,ve())){if(xe.skipUrlSync)continue;const je=C.B.get(xe.type);ge[l.qz+xe.name]=je.getValueForUrl(xe)}return ge},Fe=(ie,ve)=>async(fe,ge)=>{try{const xe=(0,O.q4)(ie),je=ge(),Ve=(0,T.Tk)(je);Ve&&(0,T.nx)(Ve,je).transaction.status===M.x8.Fetching&&fe(Ge(Ve)),fe((0,B.kb)(xe,(0,w.kH)({uid:xe}))),fe(k(xe,ve)),fe(G(xe,ve)),fe(Te(xe)),await fe(re(xe)),fe((0,B.kb)(xe,(0,w.$O)({uid:xe})))}catch(xe){fe((0,d.dx)(De("Templating init failed",xe))),console.error(xe)}};function Te(ie,ve=h.tR){return(fe,ge)=>{const xe=(0,T.SS)(ie,ge());for(const je of xe){if(je.type!=="adhoc"&&je.type!=="query")continue;const{datasource:Ve}=je;if((0,i.fN)(Ve))continue;const ke=ve().getInstanceSettings(Ve),Oe=ke?(0,i.p$)(ke):{uid:Ve};fe((0,B.kb)(ie,(0,z.QP)((0,O.qD)(je,{propName:"datasource",propValue:Oe}))))}}}const Le=ie=>ve=>{ve((0,B.kb)(ie,(0,H.v)())),ve((0,B.kb)(ie,(0,v.y8)())),ve((0,B.kb)(ie,(0,b.jR)())),ve((0,B.kb)(ie,(0,w.pu)()))},Ge=(ie,ve={getBackendSrv:f.AI})=>fe=>{ve.getBackendSrv().cancelAllInFlightRequests(),fe(Le(ie))},Me=(ie,ve=!1)=>async(fe,ge)=>{const{rootStateKey:xe}=ie;try{if(!(0,O.sN)(xe,ge()))return;const je=(0,T.dn)(ie,ge());fe((0,B.kb)(xe,(0,z.a7)((0,O.qD)(je)))),await fe(Ie((0,O.jX)(je))),await C.B.get(je.type).updateOptions(je),fe(Ke(ie))}catch(je){if(fe((0,B.kb)(xe,(0,z.Te)((0,O.qD)(ie,{error:je})))),ve||(console.error(je),fe((0,d.dx)(De("Error updating options:",je,ie)))),ve)throw je}},De=(ie,ve,fe)=>(0,E.gi)(`${fe?`Templating [${fe.id}]`:"Templating"}`,ve instanceof Error?`${ie} ${ve.message}`:`${ie}`),Ke=ie=>(ve,fe)=>{const{rootStateKey:ge}=ie;if(!(0,O.sN)(ge,fe()))return;const xe=(0,T.dn)(ie,fe());xe.state!==a.Gu.Done&&ve((0,B.kb)(ie.rootStateKey,(0,z.Pu)((0,O.qD)(xe))))};function Ie(ie,ve=h.tR){return async function(fe,ge){const{id:xe,rootStateKey:je}=ie;if(!(0,O.sN)(je,ge()))return;const Ve=(0,T.dn)(ie,ge());if(Ve.type==="query")try{const ke=await ve().get(Ve.datasource??"");if((0,y.d5)(ke)||!(0,y.Hf)(ke)||Ne(Ve.query))return;const Oe={refId:`${ke.name}-${xe}-Variable-Query`,query:Ve.query};fe((0,B.kb)(je,(0,z.QP)((0,O.qD)(ie,{propName:"query",propValue:Oe}))))}catch(ke){fe((0,d.dx)(De("Failed to upgrade legacy queries",ke))),console.error(ke)}}}function Ne(ie){return(0,a.Gv)(ie)&&"refId"in ie&&typeof ie.refId=="string"}},5636:(q,j,e)=>{"use strict";e.d(j,{Ay:()=>d,L1:()=>a,kb:()=>x});var t=e(2510),n=e(91164),r=e(85581);const a={keys:{}},i=u=>({type:`templating/keyed/${u.action.type.replace(/^templating\//,"")}`,payload:u});function x(u,g){const o=(0,t.q4)(u);return i({key:o,action:g})}const s=u=>typeof u.type=="string"&&u.type.startsWith("templating/keyed")&&"payload"in u&&typeof u.payload.key=="string";function c(u=a,g){if(s(g)){const{key:o,action:E}=g.payload,m=(0,t.q4)(o),f=r.kH.match(E)?m:u.lastKey,p=(0,n.H)(),h=u.keys[m],D=p(h,E);return{...u,lastKey:f,keys:{...u.keys,[m]:D}}}return u}const d={templating:c}},91164:(q,j,e)=>{"use strict";e.d(j,{H:()=>d,x:()=>u});var t=e(14644),n=e(5353),r=e(90604),a=e(74716),i=e(85581),x=e(64744),s=e(96354);let c;function d(){return c||(c=(0,t.combineReducers)({editor:n.wf,variables:s.Y,optionsPicker:a.ho,transaction:i.Dd,inspect:r.t4})),c}function u(){return{editor:n.nS,variables:x.j,optionsPicker:a.$z,transaction:i.i3,inspect:r.WT}}},58843:(q,j,e)=>{"use strict";e.d(j,{Fs:()=>l,SS:()=>c,Tk:()=>f,UN:()=>D,_2:()=>C,bZ:()=>h,dn:()=>i,hk:()=>o,nS:()=>g,nx:()=>s,pi:()=>u,wk:()=>E,y7:()=>p});var t=e(41811),n=e(83394),r=e(2510),a=e(91164);function i(v,y=(0,n.Gu)(),P=!0){const{id:b,rootStateKey:S}=v,O=s(S,y).variables[b];if(!O){if(P)throw new Error(`Couldn't find variable with id:${b}`);return}return O}function x(v,y,P=(0,n.Gu)()){return Object.values(s(y,P).variables).filter(v).sort((b,S)=>b.index-S.index)}function s(v,y=(0,n.Gu)()){return y.templating.keys[(0,r.q4)(v)]??(0,a.x)()}function c(v,y=(0,n.Gu)()){return x(d,v,y)}function d(v){return v.type!=="system"}const u=(0,t.default)((v,y)=>c(v,(0,n.Gu)())),g=(v,y)=>c(v,y);function o(v,y=(0,n.Gu)()){return E(Object.values(s(v,y).variables))}function E(v){const y=v.filter(d).sort((P,b)=>P.index-b.index);return y.length>0?y[y.length-1].index+1:0}function m(v,y=getState()){return s(v,y).transaction.isDirty}function f(v=(0,n.Gu)()){return v.templating?.lastKey}function p(v=(0,n.Gu)()){if(!v.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return v.templating.lastKey}function h(v,y=(0,n.Gu)()){const P=f(y);return P?x(v,P,y):[]}function D(v=(0,n.Gu)()){const y=f(v);return y?c(y,v):[]}function C(v,y=(0,n.Gu)()){const P=f(y);if(P)return i({id:v,rootStateKey:P,type:"query"},y,!1)}function l(v,y){return v[y]}},30990:(q,j,e)=>{"use strict";e.d(j,{Hr:()=>E,Pu:()=>y,QP:()=>f,QV:()=>m,Te:()=>P,a7:()=>v,dE:()=>D,hj:()=>p,l_:()=>C,qi:()=>o,ut:()=>h,wB:()=>l});var t=e(65307),n=e(2543),r=e.n(n),a=e(8392),i=e(19639),x=e(5353),s=e(21658),c=e(2510),d=e(58843),u=e(64744);const g=(0,t.Z0)({name:"templating/shared",initialState:u.j,reducers:{addVariable:(b,S)=>{const M=S.payload.id??S.payload.data.model.name,O=i.B.get(S.payload.type),R=(0,n.cloneDeep)(O.initialState),L=O.beforeAdding?O.beforeAdding(S.payload.data.model):(0,n.cloneDeep)(S.payload.data.model),B={...(0,n.defaults)({},L,R),id:M,index:S.payload.data.index,global:S.payload.data.global};b[M]=B},variableStateNotStarted:(b,S)=>{const M=(0,d.Fs)(b,S.payload.id);M.state=a.Gu.NotStarted,M.error=null},variableStateFetching:(b,S)=>{const M=(0,d.Fs)(b,S.payload.id);M.state=a.Gu.Loading,M.error=null},variableStateCompleted:(b,S)=>{const M=(0,d.Fs)(b,S.payload.id);M&&(M.state=a.Gu.Done,M.error=null)},variableStateFailed:(b,S)=>{const M=(0,d.Fs)(b,S.payload.id);M&&(M.state=a.Gu.Error,M.error=S.payload.data.error)},removeVariable:(b,S)=>{if(delete b[S.payload.id],!S.payload.data.reIndex)return;const M=Object.values(b).sort((O,R)=>O.index-R.index);for(let O=0;O<M.length;O++)M[O].index=O},duplicateVariable:(b,S)=>{function M(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const O=(0,n.cloneDeep)(b[S.payload.id]),R=new RegExp(`^copy_of_${M(O.name)}(_(\\d+))?$`),L=Object.values(b).map(({name:A})=>A.match(R)).filter(A=>A!=null),B=L.map(A=>A[2]).filter(A=>A!=null),F=L.length===0?null:B.length===0?1:B.map(A=>+A).sort((A,N)=>N-A)[0]+1,I=`copy_of_${O.name}${F?`_${F}`:""}`,U=S.payload.data?.newId??I,W=(0,d.wk)(Object.values(b));b[U]={...(0,n.cloneDeep)(i.B.get(S.payload.type).initialState),...O,id:U,name:I,index:W}},changeVariableOrder:(b,S)=>{const{toIndex:M,fromIndex:O}=S.payload.data,R=Object.values(b);for(let L=0;L<R.length;L++){const B=R[L];B.index===O?B.index=M:B.index>O&&B.index<=M?B.index--:B.index<O&&B.index>=M&&B.index++}},changeVariableType:(b,S)=>{const{id:M}=S.payload,{label:O,name:R,index:L,description:B,rootStateKey:F}=b[M];b[M]={...(0,n.cloneDeep)(i.B.get(S.payload.data.newType).initialState),id:M,rootStateKey:F,label:O,name:R,index:L,description:B}},setCurrentVariableValue:(b,S)=>{if(!S.payload.data.option)return;const M=(0,d.Fs)(b,S.payload.id);if(!(0,s.SP)(M))return;const{option:O}=S.payload.data,R={...O,text:(0,c.QT)(O?.text),value:(0,c.QT)(O?.value)};M.current=R,M.options=M.options.map(L=>{L.value=(0,c.QT)(L.value),L.text=(0,c.QT)(L.text);let B=!1;if(Array.isArray(R.value))for(let F=0;F<R.value.length;F++){const I=R.value[F];if(L.value===I){B=!0;break}}else L.value===R.value&&(B=!0);return L.selected=B,L})},changeVariableProp:(b,S)=>{const M=(0,d.Fs)(b,S.payload.id);M[S.payload.data.propName]=S.payload.data.propValue}},extraReducers:b=>b.addCase(x.FN,(S,M)=>{const O=(0,d.Fs)(S,M.payload.id);O.name=M.payload.data.newName})}),o=g.reducer,{removeVariable:E,addVariable:m,changeVariableProp:f,changeVariableOrder:p,duplicateVariable:h,setCurrentVariableValue:D,changeVariableType:C,variableStateNotStarted:l,variableStateFetching:v,variableStateCompleted:y,variableStateFailed:P}=g.actions},85581:(q,j,e)=>{"use strict";e.d(j,{$O:()=>d,Dd:()=>u,i3:()=>a,kH:()=>s,pu:()=>c});var t=e(65307),n=e(76802),r=e(30990);const a={uid:null,status:n.x8.NotStarted,isDirty:!1},i=(0,t.Z0)({name:"templating/transaction",initialState:a,reducers:{variablesInitTransaction:(g,o)=>{g.uid=o.payload.uid,g.status=n.x8.Fetching},variablesCompleteTransaction:(g,o)=>{g.uid===o.payload.uid&&(g.status=n.x8.Completed)},variablesClearTransaction:(g,o)=>{g.uid=null,g.status=n.x8.NotStarted,g.isDirty=!1}},extraReducers:g=>g.addMatcher(x,(o,E)=>{o.status===n.x8.Completed&&(o.isDirty=!0)})});function x(g){return r.Hr.match(g)||r.QV.match(g)||r.QP.match(g)||r.hj.match(g)||r.ut.match(g)||r.l_.match(g)}const{variablesInitTransaction:s,variablesClearTransaction:c,variablesCompleteTransaction:d}=i.actions,u=i.reducer},64744:(q,j,e)=>{"use strict";e.d(j,{j:()=>t});const t={}},96354:(q,j,e)=>{"use strict";e.d(j,{Y:()=>x,v:()=>i});var t=e(65307),n=e(19639),r=e(30990),a=e(64744);const i=(0,t.VP)("templating/cleanVariables"),x=(s=a.j,c)=>{if(i.match(c)){const d=Object.values(s).filter(g=>g.global);return d?d.reduce((g,o)=>(g[o.id]=o,g),{}):a.j}return c?.payload?.type&&n.B.getIfExists(c?.payload?.type)?n.B.get(c.payload.type).reducer((0,r.qi)(s,c),c):s}},76802:(q,j,e)=>{"use strict";e.d(j,{BS:()=>c,Vg:()=>x,eF:()=>d,og:()=>s,x8:()=>i});var t=e(14964),n=e(8392),r=e(91733),a=e(44690),i=(u=>(u.NotStarted="Not started",u.Fetching="Fetching",u.Completed="Completed",u))(i||{});const x={id:a.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:t.zL.dontHide,skipUrlSync:!1,state:n.Gu.NotStarted,error:null,description:null};class s extends r.x{static{this.type="variables-changed"}}class c extends r.x{static{this.type="variables-time-range-process-done"}}class d extends r.x{static{this.type="variables-changed-in-url"}}},2510:(q,j,e)=>{"use strict";e.d(j,{AX:()=>l,Lz:()=>p,ML:()=>m,Nz:()=>f,QT:()=>P,SY:()=>g,Wz:()=>y,iP:()=>D,jX:()=>M,q$:()=>C,q4:()=>S,qD:()=>O,sN:()=>b,t4:()=>o,u7:()=>h,wJ:()=>E});var t=e(2543),n=e.n(t),r=e(14964),a=e(39736),i=e(95536),x=e(83394),s=e(19639),c=e(44690),d=e(58843),u=e(76802);const g=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,o=L=>(g.lastIndex=0,g.exec(L));function E(...L){const B=L[L.length-1];L[0]=typeof L[0]=="string"?L[0]:(0,i.MA)(L[0]);const I=L.slice(0,-1).join(" ").match(g);return!!(I!==null?I.find(W=>{const A=o(W);return A!==null&&A.indexOf(B)>-1}):!1)}const m=L=>{if(!L||!L.current)return!1;if(L.current.value){const B=Array.isArray(L.current.value);if(B&&L.current.value.length&&L.current.value[0]===c.To||!B&&L.current.value===c.To)return!0}if(L.current.text){const B=Array.isArray(L.current.text);if(B&&L.current.text.length&&L.current.text[0]===c.Zm||!B&&L.current.text===c.Zm)return!0}return!1},f=L=>!L||!L.current||!L.current.text?"":Array.isArray(L.current.text)?L.current.text.toString():typeof L.current.text!="string"?"":L.current.text,p=L=>!L||!L.current||L.current.value===void 0||L.current.value===null?null:Array.isArray(L.current.value)?L.current.value.toString():typeof L.current.value!="string"?null:L.current.value;function h(L,B=(0,a.w)()){return!L||!L.regex?"":B.replace(L.regex,{},"regex")}function D(L,B,F,I){const U={range:void 0,variable:L,searchFilter:B,scopedVars:I};return(L.refresh===r.CO.onTimeRangeChanged||L.refresh===r.CO.onDashboardLoad)&&(U.range=F.timeRange()),U}function C(L){return L?.type==="custom"?r.CO.onDashboardLoad:!L||!("refresh"in L)||L.refresh!==r.CO.onTimeRangeChanged&&L.refresh!==r.CO.onDashboardLoad?r.CO.never:L.refresh}function l(){return s.B.list().filter(L=>L.id!=="system").map(({id:L,name:B,description:F})=>({label:B,value:L,description:F}))}function v(L){return(0,t.isArray)(L)&&(L.length===0?L=void 0:L.length===1&&(L=L[0])),L}function y(L,B){let F=0;const I={};for(const U in L){if(!U.startsWith(c.qz))continue;let W=v(B[U]),A=v(L[U]);(0,t.isEqual)(A,W)||(I[U]={value:L[U]},F++)}for(const U in B){if(!U.startsWith(c.qz))continue;const W=B[U];(0,t.isArray)(W)&&W.length===0||L.hasOwnProperty(U)||(I[U]={value:"",removed:!0},F++)}return F?I:void 0}function P(L){return Array.isArray(L)?L.map(String):L==null?"":typeof L=="number"?L.toString(10):typeof L=="string"?L:typeof L=="boolean"?L.toString():""}function b(L,B=(0,x.Gu)()){return(0,d.nx)(L,B).transaction.status!==u.x8.NotStarted}function S(L){return String(L)}const M=L=>{if(!L.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${L.id}`);return{type:L.type,id:L.id,rootStateKey:L.rootStateKey}};function O(L,B){return{type:L.type,id:L.id,data:B}}function R(){const L=getTemplateSrv().getVariables(),B=locationService.getSearchObject();return Object.keys(B).filter(F=>F.indexOf(VARIABLE_PREFIX)!==-1&&L.some(I=>I.name===F.replace(VARIABLE_PREFIX,""))).reduce((F,I)=>{const U=I.replace(VARIABLE_PREFIX,"");return F[U]=B[I],F},{})}},38714:(q,j,e)=>{"use strict";var t=e(79568),n=e(9423),r=e(7452),a=e(78624),i=e(4213),x=e(34796),s=e(96540),c=e(5338),d=e(3202),u=e(35023),g=e(79488),o=e(48279),E=e(48913),m=e(2567),f=e(28082),p=e(22239),h=e(53027),D=e(83911),C=e(83835),l=e(14372),v=e(86833),y=e(87425),P=e(5885),b=e(98437),S=e(58820),M=e(70415),O=e(29012),R=e(23269),L=e(75177),B=e(25612),F=e(51312),I=e(57862),U=e(3353),W=e(350),A=e(47454),N=e(12417),K=e(88023),V=e(32370),T=e(74848),z=e(2543),w=e(63739),H=e(40462),G=e(38075),X=e(23570),k=e(66564),_=e(36596),ee=e(13710),J=e(60484),Z=e(60641),te=e(90231),ae=e(54594),re=e(15817);function ne(Q){if(Q in re.uk){const{name:Y,getHelperDocs:se,links:ue}=re.uk[Q],ye=se(re.g_.UIImage),Ce=ce(ye);if(ue?.length){const Ue=ue.map(_e=>`
  Or visit <a href="${_e.url}" target="_blank">${_e.title}</a>

  `).join("");return{name:Y,helperDocs:`
        ${Ce}
        ${(0,re.$n)()}
  ${Ue}
        `}}return{name:Y,helperDocs:`
      ${Ce}
      ${(0,re.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,re.$n)()}}const ce=Q=>Q.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var le=e(77222),he=e(44826),oe=e(64015),de=e(19575),me=e(24847);function Pe(Q){return function({options:se,onChange:ue}){const{validator:ye}=Q,{value:Ce}=se,[Ue,_e]=(0,s.useState)(!ye(Ce)),He=(0,s.useCallback)(rt=>{_e(!ye(rt)),ue({...se,value:rt})},[_e,ye,ue,se]);return(0,T.jsx)(de.y,{invalid:Ue,value:Ce,error:"Value needs to be a number or a variable",onChange:He,placeholder:"Value or variable",suggestions:(0,me.I9)()})}}const Ee=()=>[{name:"Is greater",id:G.Js.greater,component:Pe({validator:me.N_})},{name:"Is greater or equal",id:G.Js.greaterOrEqual,component:Pe({validator:me.N_})},{name:"Is lower",id:G.Js.lower,component:Pe({validator:me.N_})},{name:"Is lower or equal",id:G.Js.lowerOrEqual,component:Pe({validator:me.N_})},{name:"Is equal",id:G.Js.equal,component:Pe({validator:()=>!0})},{name:"Is not equal",id:G.Js.notEqual,component:Pe({validator:()=>!0})},{name:"Is Substring",id:G.Js.substring,component:Pe({validator:()=>!0})},{name:"Is not substring",id:G.Js.notSubstring,component:Pe({validator:()=>!0})}],be=()=>null,Se=()=>[{name:"Is null",id:G.Js.isNull,component:be},{name:"Is not null",id:G.Js.isNotNull,component:be}];var Xe=e(76302);function Qe(Q){return function({options:se,onChange:ue}){const{validator:ye}=Q,[Ce,Ue]=(0,s.useState)({from:!ye(se.from),to:!ye(se.to)}),_e=(0,s.useCallback)((rt,it)=>{const xt=!ye(rt);Ue({...Ce,[it]:xt}),!xt&&ue({...se,[it]:rt})},[se,ue,Ce,Ue,ye]),He=(0,me.I9)();return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(de.y,{value:String(se.from),invalid:Ce.from,error:"Value needs to be a number or a variable",placeholder:"From",onChange:rt=>_e(rt,"from"),suggestions:He}),(0,T.jsx)(Xe.c,{children:"and"}),(0,T.jsx)(de.y,{invalid:Ce.to,error:"Value needs to be a number or a variable",value:String(se.to),placeholder:"To",suggestions:He,onChange:rt=>_e(rt,"to")})]})}}const we=()=>[{name:"Is between",id:G.Js.between,component:Qe({validator:me.N_})}];function $e(Q){return function({options:se,onChange:ue}){const{validator:ye}=Q,{value:Ce}=se,[Ue,_e]=(0,s.useState)(!ye(Ce)),He=(0,s.useCallback)(rt=>{_e(!ye(rt)),ue({...se,value:rt})},[_e,ye,ue,se]);return(0,T.jsx)(de.y,{invalid:Ue,value:Ce,onChange:He,placeholder:"Value or variable",suggestions:(0,me.I9)()})}}const Fe=()=>[{name:"Regex",id:G.Js.regex,component:$e({validator:()=>!0})}],Te=new oe.O(()=>[...Ee(),...Se(),...we(),...Fe()]),Le=Q=>{const{onDelete:Y,onChange:se,filter:ue,fieldsInfo:ye}=Q,{fieldsAsOptions:Ce,fieldByDisplayName:Ue}=ye,_e=De(ue,Ce)??"",He=Ue[_e],rt=He?Ge(He):[],it=Me(ue,rt),xt=Te.getIfExists(it),Mt=(0,s.useCallback)(wt=>{wt?.value&&se({...ue,fieldName:wt.value})},[se,ue]),Dt=(0,s.useCallback)(wt=>{if(!wt?.value)return;const sn=wt.value,Rn=H.hI.get(sn).getDefaultOptions(He);se({...ue,config:{id:sn,options:Rn}})},[se,ue,He]),Tt=(0,s.useCallback)(wt=>{se({...ue,config:{...ue.config,options:wt}})},[se,ue]);return!He||!xt||!xt.component?null:(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Field",labelWidth:14,children:(0,T.jsx)(he.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:Ce,value:ue.fieldName,onChange:Mt})}),(0,T.jsx)(J.I,{label:"Match",children:(0,T.jsx)(he.l6,{className:"width-12",placeholder:"Select test",options:rt,value:it,onChange:Dt})}),(0,T.jsx)(J.I,{label:"Value",grow:!0,children:(0,T.jsx)(xt.component,{field:He,options:ue.config.options??{},onChange:Tt})}),(0,T.jsx)(te.a,{marginBottom:.5,children:(0,T.jsx)(ae.$n,{icon:"times",onClick:Y,variant:"secondary"})})]})},Ge=Q=>{const Y=[];for(const se of H.hI.list())!se.isApplicable(Q)||!Te.getIfExists(se.id)||Y.push({value:se.id,label:se.name,description:se.description});return Y},Me=(Q,Y)=>{const se=Y.find(ue=>ue.value===Q.config.id);if(se&&se.value)return se.value;if(Y[0]?.value)return Y[0]?.value},De=(Q,Y)=>{const se=Y.find(ue=>ue.value===Q.fieldName);if(se&&se.value)return se.value;if(Y[0]?.value)return Y[0]?.value},Ke=[{label:"Include",value:ee.j4.include},{label:"Exclude",value:ee.j4.exclude}],Ie=[{label:"Match all",value:ee.Sm.all},{label:"Match any",value:ee.Sm.any}],Ne=Q=>{const{input:Y,options:se,onChange:ue}=Q,ye=ve(Y),Ce=(0,s.useCallback)(()=>{const it=Y[0],xt=it.fields.find(Tt=>Tt.type!==w.PU.time);if(!xt)return;const Mt=(0,z.cloneDeep)(se.filters),Dt=H.hI.get(G.Js.isNull);Mt.push({fieldName:(0,X.Ct)(xt,it,Y),config:{id:Dt.id,options:Dt.getDefaultOptions(xt)}}),ue({...se,filters:Mt})},[ue,se,Y]),Ue=(0,s.useCallback)(it=>{let xt=(0,z.cloneDeep)(se.filters);xt.splice(it,1),ue({...se,filters:xt})},[se,ue]),_e=(0,s.useCallback)((it,xt)=>{let Mt=(0,z.cloneDeep)(se.filters);Mt[xt]=it,ue({...se,filters:Mt})},[se,ue]),He=(0,s.useCallback)(it=>{ue({...se,type:it??ee.j4.include})},[se,ue]),rt=(0,s.useCallback)(it=>{ue({...se,match:it??ee.Sm.all})},[se,ue]);return(0,T.jsxs)("div",{children:[(0,T.jsx)(J.I,{label:"Filter type",labelWidth:16,children:(0,T.jsx)("div",{className:"width-15",children:(0,T.jsx)(Z.z,{options:Ke,value:se.type,onChange:He,fullWidth:!0})})}),(0,T.jsx)(J.I,{label:"Conditions",labelWidth:16,children:(0,T.jsx)("div",{className:"width-15",children:(0,T.jsx)(Z.z,{options:Ie,value:se.match,onChange:rt,fullWidth:!0})})}),(0,T.jsxs)(te.a,{paddingLeft:2,children:[se.filters.map((it,xt)=>(0,T.jsx)(Le,{filter:it,fieldsInfo:ye,onChange:Mt=>_e(Mt,xt),onDelete:()=>Ue(xt)},xt)),(0,T.jsx)(ae.$n,{icon:"plus",size:"sm",onClick:Ce,variant:"secondary",children:"Add condition"})]})]})},ie={id:k.F.filterByValue,editor:Ne,transformation:_.c.filterByValueTransformer,name:_.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([o.m.Filter]),help:ne(k.F.filterByValue).helperDocs},ve=Q=>(0,s.useMemo)(()=>{const Y={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(Q)?Q.reduce((se,ue)=>ue.fields.reduce((ye,Ce)=>{const Ue=(0,X.Ct)(Ce,ue,Q);return ye.fieldByDisplayName[Ue]||(ye.fieldsAsOptions.push({label:Ue,value:Ue,type:Ce.type}),ye.fieldByDisplayName[Ue]=Ce),ye},se),Y):Y},[Q]);var fe=e(41007),ge=e(14781),xe=e(12422),je=e(4527),Ve=e(14770);function ke(Q,Y){const se={data:Q.input,options:Q.options},ue=new xe.C({id:"root",title:"root"}),ye=Ue=>{if(Ue?.length){const _e=Ue[0];let He=ue.categories.find(rt=>rt.props.id===_e);return He||(He=new xe.C({id:_e,title:_e}),ue.categories.push(He)),He}return ue},Ce={getValue:Ue=>(0,z.get)(Q.options,Ue),onChange:(Ue,_e)=>{Q.onChange((0,Ve.Sf)(Q.options,Ue,_e))}};return(0,je.g5)(Y,Ce,ye,se),ue}function Oe(Q){const Y={data:[],options:{}},se={},ue=new ge.pv;Q(ue,Y);for(const ye of ue.getItems())ye.defaultValue!=null&&(0,z.set)(se,ye.path,ye.defaultValue);return se}var nt=e(83283),Je=e(75771);const Be=(Q,Y)=>{const se=Y.options??{};(0,nt.J)("",Q,se)},Ze=Q=>{(0,s.useEffect)(()=>{if(!Q.options.xBuckets?.mode){const se=Oe(Be);Q.onChange({...se,...Q.options})}});const Y=ke(Q,Be);return(0,T.jsx)("div",{children:(0,T.jsx)("div",{children:Y.items.map(se=>se.render())})})},tt={id:Je.wY.id,editor:Ze,transformation:Je.wY,name:Je.wY.name,description:Je.wY.description,state:fe.pn.alpha,categories:new Set([o.m.CreateNewVisualization]),help:ne(Je.wY.id).helperDocs};var Re=e(22803),at=e(29675),yt=e(13286),ze=e(91357),st=e(54852),ht=e(62931),It=e(39244),Gt=e(99116),un=e(65329);function vn(Q,Y,se){const ue={},ye={};for(const Ce of Q.fields){const Ue=(0,X.Ct)(Ce,Q),_e=se.index[Ue],He=_e.handler;if(!He)continue;const rt=Ce.values[Y];if(rt==null)continue;const it=He.processor(rt,ue,ye,_e.handlerArguments);it!=null&&(ue[He.targetProperty??He.key]=it)}return ye.mappingValues&&(ue.mappings=cn(ye)),ue}var pn=(Q=>(Q.Name="field.name",Q.Value="field.value",Q.Label="field.label",Q.Ignore="__ignore",Q))(pn||{});const xn=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Ot},{key:"min",processor:Ot},{key:"unit",processor:Q=>Q.toString()},{key:"decimals",processor:Ot},{key:"displayName",name:"Display name",processor:Q=>Q.toString()},{key:"color",processor:Q=>({fixedColor:Q,mode:ht.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(Q,Y,se,ue)=>{const ye=(0,It.t)(Q);if(!isNaN(ye))return Y.thresholds||(Y.thresholds={mode:Gt.O.Absolute,steps:[]}),Y.thresholds.steps.push({value:ye,color:ue.threshold?.color??"red"}),Y.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:ze.gy.allValues,processor:(Q,Y,se)=>{if((0,z.isArray)(Q))return se.mappingValues=Q,Y.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:ze.gy.allValues,processor:(Q,Y,se)=>{if((0,z.isArray)(Q))return se.mappingColors=Q,Y.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:ze.gy.allValues,processor:(Q,Y,se)=>{if((0,z.isArray)(Q))return se.mappingTexts=Q,Y.mappings}}];function cn(Q){const Y={type:un.d.ValueToText,options:{}};if(!Q.mappingValues)return[];for(let se=0;se<Q.mappingValues.length;se++){const ue=Q.mappingValues[se];ue!=null&&(Y.options[ue.toString()]={color:Q.mappingColors&&Q.mappingColors[se],text:Q.mappingTexts&&Q.mappingTexts[se],index:se})}return[Y]}let jn=null;function _n(){if(jn===null){jn={};for(const Q of xn)jn[Q.key]=Q}return jn}function Ot(Q){const Y=(0,It.t)(Q);if(!isNaN(Y))return Y}function Rt(Q,Y){for(const se of Y)if(Q===se.fieldName)return se.handlerKey;return Q.toLowerCase()}function Ye(Q){return Q?_n()[Q]:null}function dt(Q,Y,se){const ue={index:{}};let ye=Y.find(Ue=>Ue.handlerKey==="field.name"),Ce=Y.find(Ue=>Ue.handlerKey==="field.value");for(const Ue of Q.fields){const _e=(0,X.Ct)(Ue,Q),He=Y.find(xt=>xt.fieldName===_e),rt=He?He.handlerKey:_e.toLowerCase();let it=Ye(rt);se&&(it?(it.key==="field.name"&&(ue.nameField=Ue),it.key==="field.value"&&(ue.valueField=Ue)):He||(!ue.nameField&&!ye&&Ue.type===w.PU.string&&(ue.nameField=Ue,it=Ye("field.name")),!ue.valueField&&!Ce&&Ue.type===w.PU.number&&(ue.valueField=Ue,it=Ye("field.value")))),!it&&se&&(it=Ye("field.label")),ue.index[_e]={automatic:!He,handler:it,handlerArguments:He?.handlerArguments??{},reducerId:He?.reducerId??it?.defaultReducer??ze.gy.lastNotNull}}return ue}var lt=e(34128),Pt=e(57836);function Bt(Q){switch(Q){case"threshold1":return!0;default:return!1}}function Jt({handlerArguments:Q,handlerKey:Y,onChange:se}){const ue=ye=>{se(ye?{...Q,threshold:{...Q.threshold,color:ye}}:{...Q,threshold:void 0})};return(0,T.jsx)(T.Fragment,{children:Y==="threshold1"&&(0,T.jsx)(lt.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:(0,T.jsx)(Pt.sk,{color:Q.threshold?.color??"red",onChange:ue,enableNamedColors:!0})})})}function qt({frame:Q,mappings:Y,onChange:se,withReducers:ue,withNameAndValue:ye}){const Ce=(0,at.of)(Tn),Ue=gn(Q,Y,ye),_e=xn.map(Mt=>On(Mt,!1)),He=Y.reduce((Mt,Dt)=>Mt||Bt(Dt.handlerKey),!1),rt=(Mt,Dt)=>{const Tt=Y.findIndex(wt=>wt.fieldName===Mt.fieldName);if(Dt)if(Tt!==-1){const wt=[...Y];wt.splice(Tt,1,{...Y[Tt],handlerKey:Dt.value}),se(wt)}else se([...Y,{fieldName:Mt.fieldName,handlerKey:Dt.value}]);else se(Tt!==-1?Y.filter((wt,sn)=>sn!==Tt):[...Y,{fieldName:Mt.fieldName,handlerKey:"__ignore"}])},it=(Mt,Dt)=>{const Tt=Y.findIndex(wt=>wt.fieldName===Mt.fieldName);if(Tt!==-1){const wt=[...Y];wt.splice(Tt,1,{...Y[Tt],reducerId:Dt}),se(wt)}else se([...Y,{fieldName:Mt.fieldName,handlerKey:Mt.handlerKey,reducerId:Dt}])},xt=(Mt,Dt)=>{const Tt=Y.findIndex(wt=>wt.fieldName===Mt.fieldName);if(Tt!==-1){const wt=[...Y];wt.splice(Tt,1,{...Y[Tt],handlerArguments:Dt}),se(wt)}else se([...Y,{fieldName:Mt.fieldName,handlerKey:Mt.handlerKey,handlerArguments:Dt}])};return(0,T.jsxs)("table",{className:Ce.table,children:[(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{children:[(0,T.jsx)("th",{children:"Field"}),(0,T.jsx)("th",{children:"Use as"}),ue&&(0,T.jsx)("th",{children:"Select"}),He&&(0,T.jsx)("th",{children:"Additional settings"})]})}),(0,T.jsx)("tbody",{children:Ue.map(Mt=>(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{className:Ce.labelCell,children:Mt.fieldName}),(0,T.jsx)("td",{className:Ce.selectCell,"data-testid":`${Mt.fieldName}-config-key`,children:(0,T.jsx)(he.l6,{options:_e,value:Mt.configOption,placeholder:Mt.placeholder,isClearable:!0,onChange:Dt=>rt(Mt,Dt)})}),ue&&(0,T.jsx)("td",{"data-testid":`${Mt.fieldName}-reducer`,className:Ce.selectCell,children:(0,T.jsx)(st.S,{stats:[Mt.reducerId],defaultStat:Mt.reducerId,onChange:Dt=>it(Mt,Dt[0])})}),He&&(0,T.jsx)("td",{"data-testid":`${Mt.fieldName}-handler-arg`,className:Ce.selectCell,children:(0,T.jsx)(Jt,{handlerKey:Mt.handlerKey,handlerArguments:Mt.handlerArguments,onChange:Dt=>xt(Mt,Dt)})})]},Mt.fieldName))})]})}function gn(Q,Y,se){const ue=[],ye=dt(Q,Y??[],se);for(const Ce of Q.fields){const Ue=(0,X.Ct)(Ce,Q),_e=ye.index[Ue],He=On(_e.handler,_e.automatic);ue.push({fieldName:Ue,configOption:_e.automatic?null:He,placeholder:_e.automatic?He?.label:"Choose",handlerKey:_e.handler?.key??null,reducerId:_e.reducerId,handlerArguments:_e.handlerArguments})}for(const Ce of Y)if(!ue.find(Ue=>Ue.fieldName===Ce.fieldName)){const Ue=Ye(Ce.handlerKey);ue.push({fieldName:Ce.fieldName,handlerKey:Ce.handlerKey,configOption:On(Ue,!1),missingInFrame:!0,reducerId:Ce.reducerId??ze.gy.lastNotNull,handlerArguments:{}})}return Object.values(ue)}function On(Q,Y){if(!Q)return null;let se=Q.name??(0,z.capitalize)(Q.key);return Y&&(se=`${se} (auto)`),{label:se,value:Q.key}}const Tn=Q=>({table:(0,Re.css)({marginTop:Q.spacing(1),"td, th":{borderRight:`4px solid ${Q.colors.background.primary}`,borderBottom:`4px solid ${Q.colors.background.primary}`,whiteSpace:"nowrap"},th:{fontSize:Q.typography.bodySmall.fontSize,lineHeight:Q.spacing(4),padding:Q.spacing(0,1)}}),labelCell:(0,Re.css)({fontSize:Q.typography.bodySmall.fontSize,background:Q.colors.background.secondary,padding:Q.spacing(0,1),maxWidth:"400px",overflow:"hidden",textOverflow:"ellipsis",minWidth:"140px"}),selectCell:(0,Re.css)({padding:0,minWidth:"161px"})});var wn=e(81160);function ps(Q,Y){let se=null;for(const _e of Y)if(_e.refId===Q.configRefId){se=_e;break}if(!se)return Y;const ue={fields:[],length:1},ye=dt(se,Q.mappings??[],!1);for(const _e of se.fields){const He={..._e},rt=(0,X.Ct)(_e,se),it=ye.index[rt],xt=(0,ze.Nw)({field:_e,reducers:[it.reducerId]});He.values=[xt[it.reducerId]],ue.fields.push(He)}const Ce=[],Ue=(0,H.NS)(Q.applyTo||{id:G.Ct.numeric});for(const _e of Y){if(_e===se&&Y.length>1)continue;const He={fields:[],length:_e.length,refId:_e.refId};for(const rt of _e.fields)if(Ue(rt,_e,Y)){const it=vn(ue,0,ye);He.fields.push({...rt,config:{...rt.config,...it}})}else He.fields.push(rt);Ce.push(He)}return Ce}const es={id:k.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:Q=>Y=>Y.pipe((0,wn.T)(se=>ps(Q,se)))};function ls({input:Q,onChange:Y,options:se}){const ue=(0,at.of)($t),ye=Q.map(Dt=>Dt.refId).filter(Dt=>Dt!=null).map(Dt=>({label:Dt,value:Dt})),Ce=se.configRefId||"config",Ue=se.applyTo??{id:G.Ct.byType,options:"number"},_e=yt.g.get(Ue.id),He=Q.find(Dt=>Dt.refId===Ce),rt=Dt=>{Y({...se,configRefId:Dt.value||"config"})},it=Dt=>{Y({...se,applyTo:{id:Dt.value}})},xt=Dt=>{Y({...se,applyTo:{id:Ue.id,options:Dt}})},Mt=yt.g.list().filter(Dt=>!Dt.excludeFromPicker).map(Dt=>({label:Dt.name,value:Dt.id,description:Dt.description}));return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Config query",labelWidth:20,children:(0,T.jsx)(he.l6,{onChange:rt,options:ye,value:Ce,width:30})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Apply to",labelWidth:20,children:(0,T.jsx)(he.l6,{onChange:it,options:Mt,value:Ue.id,width:30})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Apply to options",labelWidth:20,className:ue.matcherOptions,children:(0,T.jsx)(_e.component,{matcher:_e.matcher,data:Q,options:Ue.options,onChange:xt})})}),(0,T.jsx)(le.C,{children:He&&(0,T.jsx)(qt,{frame:He,mappings:se.mappings,onChange:Dt=>Y({...se,mappings:Dt}),withReducers:!0})})]})}const Lt={id:es.id,editor:ls,transformation:es,name:es.name,description:es.description,state:fe.pn.beta,categories:new Set([o.m.CalculateNewFields]),help:ne(es.id).helperDocs},$t=Q=>({matcherOptions:(0,Re.css)({minWidth:"404px"})});var nn=e(62467),on=e(46884),bn=e(39736),In=e(29010),Yn=e(16268),zn=e(22399);const St=17,zt=Q=>{const{options:Y,onChange:se}=Q,ue=(0,on.pR)(Q.options.binary?.left??"",Q.names),ye=(0,on.pR)(Q.options.binary?.right??"",Q.names);(ue!==Q.options.binary?.left||ye!==Q.options.binary?.right)&&se({...Y,mode:on.UY.BinaryOperation,binary:{operator:Y.binary?.operator,left:ue,right:ye}});const{binary:Ce}=Y;let Ue=!Ce?.left,_e=!Ce?.right;const He=!Ce?.left?.matcher,rt=!Ce?.right?.matcher,it=Ce?.left?.matcher?.options,xt=Ce?.right?.matcher?.options,Mt=Ce?.left?.matcher?.id===G.Ct.byName,Dt=Ce?.right?.matcher?.id===G.Ct.byName,Tt=Q.names.map(ks=>(Mt&&ks===it&&(Ue=!0),Dt&&ks===xt&&(_e=!0),{label:ks,value:JSON.stringify({matcher:{id:G.Ct.byName,options:ks}})})),wt=Ue?[...Tt]:Mt?[...Tt,{label:it,value:JSON.stringify(Ce.left),icon:""}]:[...Tt],sn=_e?[...Tt]:Dt?[...Tt,{label:xt,value:JSON.stringify(Ce.right),icon:""}]:[...Tt];wt.push({label:`All ${w.PU.number} fields`,value:JSON.stringify({matcher:{id:G.Ct.byType,options:w.PU.number}}),icon:(0,zn.lV)(w.PU.number)}),He&&Ce?.left?.fixed&&wt.push({label:Ce.left.fixed,value:JSON.stringify(Ce.left)??"",icon:""}),rt&&Ce?.right?.fixed&&sn.push({label:Ce.right.fixed,value:JSON.stringify(Ce.right)??"",icon:""});const Rn=Yn.b.list().map(ks=>({label:ks.binaryOperationID,value:ks.binaryOperationID})),$n=ks=>{se({...Y,mode:on.UY.BinaryOperation,binary:ks})},rs=ks=>{const Lr=JSON.parse(ks.value??"");Lr.matcher?$n({...Ce,left:Lr}):$n({...Ce,left:{fixed:Lr.fixed??ks.value?.toString()}})},kn=ks=>{const Lr=JSON.parse(ks.value??"");Lr.matcher?$n({...Ce,right:Lr}):$n({...Ce,right:{fixed:Lr.fixed??ks.value?.toString()}})},ia=ks=>{$n({...Ce,operator:ks.value})};return(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Operation",labelWidth:St,children:(0,T.jsx)(he.l6,{allowCustomValue:!0,placeholder:"Field(s) or number",options:wt,className:"min-width-18",value:JSON.stringify(Ce?.left),onChange:rs})}),(0,T.jsx)(J.I,{children:(0,T.jsx)(he.l6,{className:"width-4",options:Rn,value:Ce?.operator??Rn[0].value,onChange:ia})}),(0,T.jsx)(J.I,{children:(0,T.jsx)(he.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:sn,value:JSON.stringify(Ce?.right),onChange:kn})})]})})},Qt=Q=>{const{names:Y,onChange:se,options:ue}=Q,{cumulative:ye}=ue,Ce=Y.map(rt=>({label:rt,value:rt})),Ue=rt=>{const it=rt.length?rt[0]:ze.gy.sum;_e({...ye,reducer:it})},_e=rt=>{se({...ue,mode:on.UY.CumulativeFunctions,cumulative:rt})},He=rt=>{_e({...ye,field:rt.value})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{label:"Field",labelWidth:St,children:(0,T.jsx)(he.l6,{placeholder:"Field",options:Ce,className:"min-width-18",value:ye?.field,onChange:He})}),(0,T.jsx)(J.I,{label:"Calculation",labelWidth:St,children:(0,T.jsx)(st.S,{allowMultiple:!1,className:"width-18",stats:[ye?.reducer||ze.gy.sum],onChange:Ue,defaultStat:ze.gy.sum,filterOptions:rt=>rt.id===ze.gy.sum||rt.id===ze.gy.mean})})]})},an=Q=>{const{options:Y,onChange:se}=Q,{index:ue}=Y,ye=Ce=>{se({...Y,index:{asPercentile:Ce.currentTarget.checked}})};return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(J.I,{labelWidth:St,label:"As percentile",tooltip:"Transform the row index as a percentile.",children:(0,T.jsx)(In.K,{value:!!ue?.asPercentile,onChange:ye})})})};var mn=e(19550),yn=e(99076);const Ct=Q=>{const{names:Y,selected:se,onChange:ue,options:ye}=Q,{reduce:Ce}=ye,Ue=it=>{ue({...ye,reduce:it})},_e=it=>{se.indexOf(it)>-1?He(se.filter(xt=>xt!==it)):He([...se,it])},He=it=>{Ue({...Ce,include:it})},rt=it=>{const xt=it.length?it[0]:ze.gy.sum,{reduce:Mt}=ye;Ue({...Mt,reducer:xt})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{label:"Operation",labelWidth:St,grow:!0,children:(0,T.jsx)(mn.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:Y.map((it,xt)=>(0,T.jsx)(yn.m,{onClick:()=>{_e(it)},label:it,selected:se.indexOf(it)>-1},`${it}/${xt}`))})}),(0,T.jsx)(J.I,{label:"Calculation",labelWidth:St,children:(0,T.jsx)(st.S,{allowMultiple:!1,className:"width-18",stats:[Ce?.reducer||ze.gy.sum],onChange:rt,defaultStat:ze.gy.sum})})]})};var ut=e(90808);const Et=Q=>{const{options:Y,onChange:se}=Q,{unary:ue}=Y,ye=xt=>{se({...Y,mode:on.UY.UnaryOperation,unary:xt})},Ce=xt=>{ye({...ue,operator:xt.value})},Ue=xt=>{ye({...ue,fieldName:xt.value})};let _e=!ue?.fieldName;const He=Q.names.map(xt=>(xt===ue?.fieldName&&(_e=!0),{label:xt,value:xt})),rt=ut.j.list().map(xt=>({label:xt.unaryOperationID,value:xt.unaryOperationID})),it=_e?He:[...He,{label:ue?.fieldName,value:ue?.fieldName}];return(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Operation",labelWidth:St,children:(0,T.jsx)(he.l6,{options:rt,value:ue?.operator??rt[0].value,onChange:Ce})}),(0,T.jsx)(J.I,{label:"(",labelWidth:2,children:(0,T.jsx)(he.l6,{placeholder:"Field",className:"min-width-11",options:it,value:ue?.fieldName,onChange:Ue})}),(0,T.jsx)(Xe.c,{width:2,children:")"})]})})};var Ut=e(30602);const Wt=Q=>{const{options:Y,names:se,onChange:ue}=Q,{window:ye}=Y,Ce=se.map(Tt=>({label:Tt,value:Tt})),Ue=[{label:"Trailing",value:on.ip.Trailing},{label:"Centered",value:on.ip.Centered}],_e=[{label:"Percentage",value:on.Bp.Percentage},{label:"Fixed",value:on.Bp.Fixed}],He=Tt=>{ue({...Y,mode:on.UY.WindowFunctions,window:Tt})},rt=Tt=>{He({...ye,field:Tt.value})},it=Tt=>{He({...ye,windowSize:Tt&&ye?.windowSizeMode===on.Bp.Percentage?Tt/100:Tt})},xt=Tt=>{He({...ye,windowSize:ye?.windowSize?Tt===on.Bp.Percentage?ye.windowSize/100:ye.windowSize*100:void 0,windowSizeMode:Tt})},Mt=Tt=>{const wt=Tt.length?Tt[0]:ze.gy.sum;He({...ye,reducer:wt})},Dt=Tt=>{He({...ye,windowAlignment:Tt})};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{label:"Field",labelWidth:St,children:(0,T.jsx)(he.l6,{placeholder:"Field",options:Ce,className:"min-width-18",value:ye?.field,onChange:rt})}),(0,T.jsx)(J.I,{label:"Calculation",labelWidth:St,children:(0,T.jsx)(st.S,{allowMultiple:!1,className:"width-18",stats:[ye?.reducer||ze.gy.mean],onChange:Mt,defaultStat:ze.gy.mean,filterOptions:Tt=>Tt.id===ze.gy.mean||Tt.id===ze.gy.variance||Tt.id===ze.gy.stdDev})}),(0,T.jsx)(J.I,{label:"Type",labelWidth:St,children:(0,T.jsx)(Z.z,{value:ye?.windowAlignment??on.ip.Trailing,options:Ue,onChange:Dt})}),(0,T.jsx)(J.I,{label:"Window size mode",labelWidth:St,children:(0,T.jsx)(Z.z,{value:ye?.windowSizeMode??on.Bp.Percentage,options:_e,onChange:xt})}),(0,T.jsx)(J.I,{label:ye?.windowSizeMode===on.Bp.Percentage?"Window size %":"Window size",labelWidth:St,tooltip:ye?.windowSizeMode===on.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size",children:(0,T.jsx)(Ut.Q,{placeholder:"Auto",min:.1,value:ye?.windowSize&&ye.windowSizeMode===on.Bp.Percentage?ye.windowSize*100:ye?.windowSize,onChange:it})})]})},gt=[{value:on.UY.BinaryOperation,label:"Binary operation"},{value:on.UY.UnaryOperation,label:"Unary operation"},{value:on.UY.ReduceRow,label:"Reduce row"},{value:on.UY.Index,label:"Row index"}];V.$.featureToggles.addFieldFromCalculationStatFunctions&&gt.push({value:on.UY.CumulativeFunctions,label:"Cumulative functions"},{value:on.UY.WindowFunctions,label:"Window functions"});const Vt=new Set([w.PU.time,w.PU.number,w.PU.string]),Ft=Q=>{const{options:Y,onChange:se,input:ue}=Q,ye=Y?.reduce?.include,[Ce,Ue]=(0,s.useState)({names:[],selected:[]});(0,s.useEffect)(()=>{const wt={interpolate:Rn=>Rn},sn=(0,nn.of)(ue).pipe(_.c.ensureColumnsTransformer.operator(null,wt),He(),_e(),rt(ye||[])).subscribe(({selected:Rn,names:$n})=>{Ue({names:$n,selected:Rn})});return()=>{sn.unsubscribe()}},[ue,ye]);const _e=()=>{const wt=(0,bn.w)();return sn=>sn.pipe((0,wn.T)(Rn=>(Rn.push(...wt.getVariables().map($n=>"$"+$n.name)),Rn)))},He=()=>wt=>wt.pipe((0,wn.T)(sn=>{const Rn=[],$n={};for(const rs of sn)for(const kn of rs.fields){if(!Vt.has(kn.type))continue;const ia=(0,X.Ct)(kn,rs,sn);$n[ia]||($n[ia]=!0,Rn.push(ia))}return Rn})),rt=wt=>sn=>sn.pipe((0,wn.T)(Rn=>{if(!wt.length)return{names:Rn,selected:[]};const $n=[],rs=[];for(const kn of Rn)wt.includes(kn)&&rs.push(kn),$n.push(kn);return{names:$n,selected:rs}})),it=wt=>{se({...Y,replaceFields:wt.currentTarget.checked})},xt=wt=>{const sn=wt.value??on.UY.BinaryOperation;sn===on.UY.WindowFunctions&&(Y.window=Y.window??on.Uj),se({...Y,mode:sn})},Mt=wt=>{se({...Y,alias:wt.target.value})},Dt=Y.mode??on.UY.BinaryOperation,Tt=Dt===on.UY.BinaryOperation&&Y.binary?.left.matcher?.id===G.Ct.byType;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{labelWidth:St,label:"Mode",children:(0,T.jsx)(he.l6,{className:"width-18",options:gt,value:gt.find(wt=>wt.value===Dt),onChange:xt})}),Dt===on.UY.BinaryOperation&&(0,T.jsx)(zt,{options:Y,names:Ce.names,onChange:Q.onChange}),Dt===on.UY.UnaryOperation&&(0,T.jsx)(Et,{names:Ce.names,options:Y,onChange:Q.onChange}),Dt===on.UY.ReduceRow&&(0,T.jsx)(Ct,{names:Ce.names,selected:Ce.selected,options:Y,onChange:Q.onChange}),Dt===on.UY.CumulativeFunctions&&(0,T.jsx)(Qt,{names:Ce.names,options:Y,onChange:Q.onChange}),Dt===on.UY.WindowFunctions&&(0,T.jsx)(Wt,{names:Ce.names,options:Y,onChange:Q.onChange}),Dt===on.UY.Index&&(0,T.jsx)(an,{options:Y,onChange:Q.onChange}),(0,T.jsx)(J.I,{labelWidth:St,label:"Alias",disabled:Tt,children:(0,T.jsx)(lt.p,{className:"width-18",value:Y.alias??"",placeholder:(0,on.sw)(Y),onChange:Mt})}),(0,T.jsx)(J.I,{labelWidth:St,label:"Replace all fields",children:(0,T.jsx)(In.K,{value:!!Y.replaceFields,onChange:it})})]})},dn={id:k.F.calculateField,editor:Ft,transformation:_.c.calculateFieldTransformer,name:_.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([o.m.CalculateNewFields]),help:ne(k.F.calculateField).helperDocs};var Cn=e(70736);const Un=[{value:Cn.x1.FieldName,label:"Copy frame name to field name"},{value:Cn.x1.Label,label:"Add a label with the frame name"},{value:Cn.x1.Drop,label:"Ignore the frame name"}];class ts extends s.PureComponent{constructor(Y){super(Y),this.onModeChanged=se=>{const{options:ue,onChange:ye}=this.props,Ce=se.value??Cn.x1.FieldName;ye({...ue,frameNameMode:Ce})},this.onLabelChanged=se=>{const{options:ue}=this.props;this.props.onChange({...ue,frameNameLabel:se.target.value})}}render(){const{options:Y}=this.props,se=Y.frameNameMode??Cn.x1.FieldName;return(0,T.jsxs)("div",{children:[(0,T.jsx)(J.I,{label:"Name",labelWidth:16,grow:!0,children:(0,T.jsx)(he.l6,{width:36,options:Un,value:Un.find(ue=>ue.value===se),onChange:this.onModeChanged})}),se===Cn.x1.Label&&(0,T.jsx)(J.I,{label:"Label",labelWidth:16,grow:!0,children:(0,T.jsx)(lt.p,{width:36,value:Y.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})})]})}}const ms={id:k.F.concatenate,editor:ts,transformation:_.c.concatenateTransformer,name:_.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([o.m.Combine]),help:ne(k.F.concatenate).helperDocs};var us=e(58064),Yt=e(59748),ot=e(31642),ct=e(73528),ft=e(57095),vt=e(79784),Kt=e(64467),Zt=e(99764);const tn=({transformIndex:Q,value:Y,index:se,mappedIndex:ue,onChangeEnumValue:ye,onRemoveEnumRow:Ce,checkIsEnumUniqueValue:Ue})=>{const _e=(0,at.of)(En),[He,rt]=(0,s.useState)(Y),[it,xt]=(0,s.useState)(He===""),[Mt,Dt]=(0,s.useState)(null),Tt=(0,s.useRef)(null);(0,s.useEffect)(()=>{Tt.current&&Tt.current.focus()},[Tt]);const wt=kn=>{kn.currentTarget.value!==""&&Ue(kn.currentTarget.value)&&kn.currentTarget.value!==Y?Dt("Enum value already exists"):Dt(null),rt(kn.currentTarget.value)},sn=()=>{if(xt(!1),Dt(null),He===""||Mt!==null){Ce(ue);return}ye(ue,He)},Rn=kn=>{kn.key==="Enter"&&(kn.preventDefault(),sn())},$n=()=>{xt(!0)},rs=()=>{Ce(ue)};return(0,T.jsx)(ft.Draggable,{draggableId:`${Q}/${Y}`,index:se,children:kn=>(0,T.jsxs)("tr",{ref:kn.innerRef,...kn.draggableProps,children:[(0,T.jsx)("td",{children:(0,T.jsx)("div",{className:_e.dragHandle,...kn.dragHandleProps,children:(0,T.jsx)(vt.I,{name:"draggabledots",size:"lg"})})}),it?(0,T.jsxs)("td",{children:[(0,T.jsx)(lt.p,{ref:Tt,type:"text",value:He,onChange:wt,onBlur:sn,onKeyDown:Rn}),Mt&&(0,T.jsx)(Kt.P,{children:Mt})]}):(0,T.jsx)("td",{onClick:$n,className:_e.clickableTableCell,children:Y&&Y!==""?Y:"Click to edit"}),(0,T.jsx)("td",{className:_e.textAlignCenter,children:(0,T.jsx)(mn.Gy,{spacing:"sm",children:(0,T.jsx)(Zt.K,{name:"trash-alt",onClick:rs,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})})})]},se)},`${Q}/${Y}`)},En=Q=>({dragHandle:(0,Re.css)({cursor:"grab"}),textAlignCenter:(0,Re.css)({textAlign:"center"}),clickableTableCell:(0,Re.css)({cursor:"pointer",width:"100px","&:hover":{color:Q.colors.text.maxContrast}})}),Ln=tn,Gn=({input:Q,options:Y,transformIndex:se,onChange:ue})=>{const ye=(0,at.of)(Hn),[Ce,Ue]=(0,s.useState)(Y.conversions[se].enumConfig?.text??[]);(0,s.useEffect)(()=>{!Y.conversions[se].enumConfig?.text?.length&&Q.length&&_e()},[Q]),(0,s.useEffect)(()=>{(()=>{const wt=Ce.map($n=>$n),sn=Y.conversions,Rn={text:wt};sn[se]={...sn[se],enumConfig:Rn},ue({...Y,conversions:sn})})()},[se,Ce]);const _e=()=>{const Tt=Q.flatMap(sn=>sn?.fields??[]).find(sn=>sn.name===Y.conversions[se].targetField);if(!Tt)return;const wt=new Set(Tt?.values);Ce.length>0&&!(0,z.isEqual)(Ce,Array.from(wt))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||Ue([...wt])},He=(Tt,wt)=>{const sn=[...Ce];sn.splice(Tt,1,wt),Ue(sn)},rt=Tt=>{const wt=[...Ce];wt.splice(Tt,1),Ue(wt)},it=()=>{Ue(["",...Ce])},xt=(Tt,wt)=>{Ce.includes(wt)||He(Tt,wt)},Mt=Tt=>Ce.includes(Tt),Dt=Tt=>{if(!Tt.destination)return;const wt=Ce.length-Tt.source.index-1,sn=Ce.length-Tt.destination.index-1,Rn=[...Ce],$n=Rn[wt];Rn.splice(wt,1),Rn.splice(sn,0,$n),Ue(Rn)};return(0,T.jsxs)(le.C,{children:[(0,T.jsxs)(mn.Gy,{children:[(0,T.jsx)(ae.$n,{size:"sm",icon:"plus",onClick:()=>_e(),className:ye.button,children:"Generate enum values from data"}),(0,T.jsx)(ae.$n,{size:"sm",icon:"plus",onClick:()=>it(),className:ye.button,children:"Add enum value"})]}),(0,T.jsx)(mn.gW,{children:(0,T.jsx)("table",{className:ye.compactTable,children:(0,T.jsx)(ft.DragDropContext,{onDragEnd:Dt,children:(0,T.jsx)(ft.Droppable,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:Tt=>(0,T.jsxs)("tbody",{ref:Tt.innerRef,...Tt.droppableProps,children:[[...Ce].reverse().map((wt,sn)=>{const Rn=Ce.length-sn-1;return(0,T.jsx)(Ln,{transformIndex:se,value:wt,index:sn,mappedIndex:Rn,onChangeEnumValue:xt,onRemoveEnumRow:rt,checkIsEnumUniqueValue:Mt},`${se}/${wt}`)}),Tt.placeholder]})})})})})]})},Hn=Q=>({compactTable:(0,Re.css)({"tbody td":{padding:Q.spacing(.5)},marginTop:Q.spacing(1),marginBottom:Q.spacing(2)}),button:(0,Re.css)({marginTop:Q.spacing(1)})}),Qn={settings:{width:24,isClearable:!1}},cs=({input:Q,options:Y,onChange:se})=>{const ue=ot.bx.filter(Dt=>Dt.value!==w.PU.trace),ye=(0,me.qt)(!0),Ce=(0,us.P3)();ye.push({label:"Browser",value:"browser"}),ye.push({label:"UTC",value:"utc"});for(const Dt of Ce)ye.push({label:Dt,value:Dt});const Ue=(0,s.useCallback)(Dt=>Tt=>{const wt=Y.conversions;wt[Dt]={...wt[Dt],targetField:Tt??"",dateFormat:void 0},se({...Y,conversions:wt})},[se,Y]),_e=(0,s.useCallback)(Dt=>Tt=>{const wt=Y.conversions;wt[Dt]={...wt[Dt],destinationType:Tt.value},se({...Y,conversions:wt})},[se,Y]),He=(0,s.useCallback)(Dt=>Tt=>{const wt=Y.conversions;wt[Dt]={...wt[Dt],dateFormat:Tt.currentTarget.value},se({...Y,conversions:wt})},[se,Y]),rt=(0,s.useCallback)(Dt=>Tt=>{const wt=Y.conversions;wt[Dt]={...wt[Dt],joinWith:Tt.currentTarget.value},se({...Y,conversions:wt})},[se,Y]),it=(0,s.useCallback)(()=>{se({...Y,conversions:[...Y.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[se,Y]),xt=(0,s.useCallback)(Dt=>{const Tt=Y.conversions;Tt.splice(Dt,1),se({...Y,conversions:Tt})},[se,Y]),Mt=(0,s.useCallback)(Dt=>Tt=>{const wt=Y.conversions;wt[Dt]={...wt[Dt],timezone:Tt?.value},se({...Y,conversions:wt})},[se,Y]);return(0,T.jsxs)(T.Fragment,{children:[Y.conversions.map((Dt,Tt)=>{const wt=(0,ct.findField)(Q?.[0],Dt.targetField);return(0,T.jsxs)("div",{children:[(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Field",children:(0,T.jsx)(Yt.O,{context:{data:Q},value:Dt.targetField??"",onChange:Ue(Tt),item:Qn})}),(0,T.jsx)(J.I,{label:"as",children:(0,T.jsx)(he.l6,{options:ue,value:Dt.destinationType,placeholder:"Type",onChange:_e(Tt),width:18})}),Dt.destinationType===w.PU.time&&(0,T.jsx)(J.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly.",children:(0,T.jsx)(lt.p,{value:Dt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:He(Tt),width:24})}),Dt.destinationType===w.PU.string&&(0,T.jsxs)(T.Fragment,{children:[(Dt.joinWith?.length||wt?.type===w.PU.other)&&(0,T.jsx)(J.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values",children:(0,T.jsx)(lt.p,{value:Dt.joinWith,placeholder:"JSON",onChange:rt(Tt),width:9})}),wt?.type===w.PU.time&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{label:"Date format",tooltip:"Specify the output format.",children:(0,T.jsx)(lt.p,{value:Dt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:He(Tt),width:24})}),(0,T.jsx)(J.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually",children:(0,T.jsx)(he.l6,{options:ye,value:Dt.timezone,onChange:Mt(Tt),isClearable:!0})})]})]}),(0,T.jsx)(ae.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>xt(Tt),"aria-label":"Remove convert field type transformer"})]}),Dt.destinationType===w.PU.enum&&(0,T.jsx)(Gn,{input:Q,options:Y,transformIndex:Tt,onChange:se})]},`${Dt.targetField}-${Tt}`)}),(0,T.jsx)(ae.$n,{size:"sm",icon:"plus",onClick:it,variant:"secondary","aria-label":"Add a convert field type transformer",children:"Convert field type"})]})},vs={id:k.F.convertFieldType,editor:cs,transformation:_.c.convertFieldTypeTransformer,name:_.c.convertFieldTypeTransformer.name,description:_.c.convertFieldTypeTransformer.description,categories:new Set([o.m.Reformat]),help:ne(k.F.convertFieldType).helperDocs};var hs=e(67793);class Vs extends s.PureComponent{constructor(Y){super(Y),this.onFieldToggle=se=>{const{selected:ue}=this.state;ue.indexOf(se)>-1?this.onChange(ue.filter(ye=>ye!==se)):this.onChange([...ue,se])},this.onChange=se=>{const{regex:ue,isRegexValid:ye}=this.state,Ce={...this.props.options,include:{names:se}};ue&&ye&&(Ce.include=Ce.include??{},Ce.include.pattern=ue),this.setState({selected:se},()=>{this.props.onChange(Ce)})},this.onInputBlur=se=>{const{selected:ue,regex:ye}=this.state;let Ce=!0;try{ye&&(0,hs.dO)(ye)}catch{Ce=!1}Ce?this.props.onChange({...this.props.options,include:{pattern:ye}}):this.props.onChange({...this.props.options,include:{names:ue}}),this.setState({isRegexValid:Ce})},this.onVariableChange=se=>{this.props.onChange({...this.props.options,include:{variable:se.value}}),this.setState({variable:se.value})},this.onFromVariableChange=se=>{const ue=se.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:ue}),this.setState({byVariable:ue})},this.state={include:Y.options.include?.names||[],regex:Y.options.include?.pattern,variable:Y.options.include?.variable,byVariable:Y.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(Y){this.props.input!==Y.input&&this.initOptions()}initOptions(){const{input:Y,options:se}=this.props,ue=Array.from(se.include?.names??[]),ye=(0,bn.w)().getVariables().map(_e=>({label:"$"+_e.name,value:"$"+_e.name})),Ce=[],Ue={};for(const _e of Y)for(const He of _e.fields){const rt=(0,X.Ct)(He,_e,Y);let it=Ue[rt];it||(it=Ue[rt]={name:rt,count:0},Ce.push(it)),it.count++}if(se.include?.pattern)try{const _e=(0,hs.dO)(se.include.pattern);for(const He of Ce)_e.test(He.name)&&ue.push(He.name)}catch(_e){console.error(_e)}if(ue.length){const _e=Ce.filter(He=>ue.includes(He.name));this.setState({options:Ce,selected:_e.map(He=>He.name),variables:ye,byVariable:se.byVariable||!1,variable:se.include?.variable,regex:se.include?.pattern})}else this.setState({options:Ce,selected:Ce.map(_e=>_e.name),variables:ye,byVariable:se.byVariable||!1,variable:se.include?.variable,regex:se.include?.pattern})}render(){const{options:Y,selected:se,isRegexValid:ue}=this.state;return(0,T.jsxs)("div",{children:[(0,T.jsx)(le.C,{label:"Use variable",children:(0,T.jsx)(J.I,{label:"From variable",children:(0,T.jsx)(In.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Variable",children:(0,T.jsx)(he.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,T.jsxs)(le.C,{label:"Identifier",children:[(0,T.jsx)(J.I,{label:"Identifier",invalid:!ue,error:ue?void 0:"Invalid pattern",children:(0,T.jsx)(lt.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:ye=>this.setState({regex:ye.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),Y.map((ye,Ce)=>{const Ue=`${ye.name}${ye.count>1?" ("+ye.count+")":""}`,_e=se.indexOf(ye.name)>-1;return(0,T.jsx)(yn.m,{onClick:()=>{this.onFieldToggle(ye.name)},label:Ue,selected:_e},`${ye.name}/${Ce}`)})]})]})}}const As={id:k.F.filterFieldsByName,editor:Vs,transformation:_.c.filterFieldsByNameTransformer,name:_.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([o.m.Filter]),help:ne(k.F.filterFieldsByName).helperDocs};var Ys=e(1561);const ha=Q=>(0,T.jsx)(Ys.M,{value:{id:G.jR.byRefId,options:Q.options.include||""},onChange:Y=>{Q.onChange({...Q.options,include:Y?.options||""})},context:{data:Q.input}}),Da={id:k.F.filterByRefId,editor:ha,transformation:_.c.filterFramesByRefIdTransformer,name:_.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([o.m.Filter]),help:ne(k.F.filterByRefId).helperDocs};var Sa=e(41758);const na={settings:{width:30,filter:Q=>Q.type===w.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function Zs({input:Q,options:Y,onChange:se}){const ue=(0,s.useCallback)(He=>{se({...Y,stringField:He??""})},[se,Y]),ye=(0,s.useCallback)(He=>{const rt=He.value??Sa.gs.UpperCase;se({...Y,outputFormat:rt})},[se,Y]),Ce=(0,s.useCallback)(He=>{se({...Y,substringStart:He??0})},[se,Y]),Ue=(0,s.useCallback)(He=>{se({...Y,substringEnd:He??0})},[se,Y]),_e=Object.values(Sa.gs).map(He=>({label:He,value:He}));return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Field",labelWidth:10,children:(0,T.jsx)(Yt.O,{context:{data:Q},value:Y.stringField??"",onChange:ue,item:na})}),(0,T.jsx)(J.I,{label:"Format",labelWidth:10,children:(0,T.jsx)(he.l6,{options:_e,value:Y.outputFormat,onChange:ye,width:20})})]}),Y.outputFormat===Sa.gs.Substring&&(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Substring range",labelWidth:15,children:(0,T.jsx)(Ut.Q,{min:0,value:Y.substringStart??0,onChange:Ce,width:7})}),(0,T.jsx)(J.I,{children:(0,T.jsx)(Ut.Q,{min:0,value:Y.substringEnd??0,onChange:Ue,width:7})})]})]})}const sa={id:k.F.formatString,editor:Zs,transformation:_.c.formatStringTransformer,name:_.c.formatStringTransformer.name,state:fe.pn.beta,description:_.c.formatStringTransformer.description,categories:new Set([o.m.Reformat])};function Ha({input:Q,options:Y,onChange:se}){const ue=[],ye=(0,me.qt)(!0);for(const He of Q)for(const rt of He.fields)if(rt.type==="time"){const it=(0,X.Ct)(rt,He,Q);ue.push({label:it,value:it})}const Ce=(0,s.useCallback)(He=>{const rt=He?.value!==void 0?He.value:"";se({...Y,timeField:rt})},[se,Y]),Ue=(0,s.useCallback)(He=>{const rt=He.target.value;se({...Y,outputFormat:rt})},[se,Y]),_e=(0,s.useCallback)(He=>{const rt=He?.value!==void 0?He.value:"";se({...Y,timezone:rt})},[se,Y]);return(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Time Field",labelWidth:15,grow:!0,children:(0,T.jsx)(he.l6,{options:ue,value:Y.timeField,onChange:Ce,placeholder:"time",isClearable:!0})}),(0,T.jsx)(J.I,{label:"Format",labelWidth:10,tooltip:(0,T.jsxs)(T.Fragment,{children:["The output format for the field specified as a"," ",(0,T.jsx)("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer",children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,T.jsx)(lt.p,{onChange:Ue,value:Y.outputFormat})}),(0,T.jsx)(J.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20,children:(0,T.jsx)(he.l6,{options:ye,value:Y.timezone,onChange:_e,isClearable:!0})})]})})}const Ma={id:k.F.formatTime,editor:Ha,transformation:_.c.formatTimeTransformer,name:_.c.formatTimeTransformer.name,state:fe.pn.alpha,description:_.c.formatTimeTransformer.description,help:ne(k.F.formatTime).helperDocs};var fa=e(97463),Rs=e(48583),xa=e(37e3);const fr=({input:Q,options:Y,onChange:se})=>{const ue=(0,me.ZI)(Q),ye=(0,s.useCallback)(He=>rt=>{se({...Y,fields:{...Y.fields,[He]:rt}})},[se]);let Ce,Ue=!1;for(const He of Object.values(Y.fields))He.aggregations.length>0&&He.operation!==null&&(Ue=!0),He.operation===fa.R3.groupBy&&(Ce=!0);const _e=Ue&&!Ce;return(0,T.jsxs)(Rs.B,{direction:"column",children:[_e&&(0,T.jsx)(xa.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),ue.map(He=>(0,T.jsx)(Xt,{onConfigChange:ye(He),fieldName:He,config:Y.fields[He]},He))]})},pt=[{label:"Group by",value:fa.R3.groupBy},{label:"Calculate",value:fa.R3.aggregate}],Xt=({fieldName:Q,config:Y,onConfigChange:se})=>{const ue=(0,at.$j)(),ye=hn(ue),Ce=(0,s.useCallback)(Ue=>{se({aggregations:Y?.aggregations??[],operation:Ue?.value??null})},[Y,se]);return(0,T.jsx)(J.I,{className:ye.label,label:Q,grow:!0,shrink:!0,children:(0,T.jsxs)(Rs.B,{gap:.5,direction:"row",children:[(0,T.jsx)("div",{className:ye.operation,children:(0,T.jsx)(he.l6,{options:pt,value:Y?.operation,placeholder:"Ignored",onChange:Ce,isClearable:!0})}),Y?.operation===fa.R3.aggregate&&(0,T.jsx)(st.S,{className:ye.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:Y.aggregations,onChange:Ue=>{se({...Y,aggregations:Ue})}})]})})},hn=Q=>({label:(0,Re.css)({label:{minWidth:Q.spacing(32)}}),operation:(0,Re.css)({flexShrink:0,height:"100%",width:Q.spacing(24)}),aggregations:(0,Re.css)({flexGrow:1})}),Sn={id:k.F.groupBy,editor:fr,transformation:_.c.groupByTransformer,name:_.c.groupByTransformer.name,description:_.c.groupByTransformer.description,categories:new Set([o.m.Combine,o.m.CalculateNewFields,o.m.Reformat]),help:ne(k.F.groupBy).helperDocs};var Wn=e(22915),Jn=e(86489);const fs=({input:Q,options:Y,onChange:se})=>{const ue=(0,me.ZI)(Q),ye=Y.showSubframeHeaders===void 0?Wn.l:Y.showSubframeHeaders,Ce=(0,s.useCallback)(it=>xt=>{se({...Y,fields:{...Y.fields,[it]:xt}})},[se]),Ue=(0,s.useCallback)(()=>{const it=Y.showSubframeHeaders===void 0?!Wn.l:!Y.showSubframeHeaders;se({showSubframeHeaders:it,fields:{...Y.fields}})},[se]);let _e,He=!1;for(const it of Object.values(Y.fields))it.aggregations.length>0&&it.operation!==null&&(He=!0),it.operation===fa.R3.groupBy&&(_e=!0);const rt=He&&!_e;return(0,T.jsxs)(Rs.B,{direction:"column",children:[rt&&(0,T.jsx)(xa.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),(0,T.jsx)("div",{children:ue.map(it=>(0,T.jsx)(Cs,{onConfigChange:Ce(it),fieldName:it,config:Y.fields[it]},it))}),(0,T.jsx)(Jn.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header",children:(0,T.jsx)(In.d,{value:ye,onChange:Ue})})]})},qn=[{label:"Group by",value:fa.R3.groupBy},{label:"Calculate",value:fa.R3.aggregate}],Cs=({fieldName:Q,config:Y,onConfigChange:se})=>{const ue=(0,at.$j)(),ye=_s(ue),Ce=(0,s.useCallback)(Ue=>{se({aggregations:Y?.aggregations??[],operation:Ue?.value??null})},[Y,se]);return(0,T.jsx)(J.I,{className:ye.label,label:Q,grow:!0,shrink:!0,children:(0,T.jsxs)(Rs.B,{gap:.5,direction:"row",wrap:!1,children:[(0,T.jsx)("div",{className:ye.operation,children:(0,T.jsx)(he.l6,{options:qn,value:Y?.operation,placeholder:"Ignored",onChange:Ce,isClearable:!0})}),Y?.operation===fa.R3.aggregate&&(0,T.jsx)(st.S,{className:ye.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:Y.aggregations,onChange:Ue=>{se({...Y,aggregations:Ue})}})]})})},_s=Q=>({label:(0,Re.css)({minWidth:Q.spacing(32)}),operation:(0,Re.css)({flexShrink:0,height:"100%",width:Q.spacing(24)}),aggregations:(0,Re.css)({flexGrow:1})}),Ls={id:k.F.groupToNestedTable,editor:fs,transformation:_.c.groupToNestedTable,name:_.c.groupToNestedTable.name,description:_.c.groupToNestedTable.description,categories:new Set([o.m.Combine,o.m.CalculateNewFields,o.m.Reformat]),state:fe.pn.beta};var $s=e(19844);const Ea=({input:Q,options:Y,onChange:se})=>{const ue=(0,me.ZI)(Q).map(it=>({label:it,value:it})),ye=(0,bn.w)().getVariables().map(it=>({value:"$"+it.name,label:"$"+it.name})),Ce=(0,s.useCallback)(it=>{se({...Y,columnField:it?.value})},[se,Y]),Ue=(0,s.useCallback)(it=>{se({...Y,rowField:it?.value})},[se,Y]),_e=(0,s.useCallback)(it=>{se({...Y,valueField:it?.value})},[se,Y]),He=[{label:"Null",value:$s.N.Null,description:"Null value"},{label:"True",value:$s.N.True,description:"Boolean true value"},{label:"False",value:$s.N.False,description:"Boolean false value"},{label:"Zero",value:$s.N.Zero,description:"Number 0 value"},{label:"Empty",value:$s.N.Empty,description:"Empty string"}],rt=(0,s.useCallback)(it=>{se({...Y,emptyValue:it?.value})},[se,Y]);return(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Column",labelWidth:8,children:(0,T.jsx)(he.l6,{options:[...ue,...ye],value:Y.columnField,onChange:Ce,isClearable:!0})}),(0,T.jsx)(J.I,{label:"Row",labelWidth:8,children:(0,T.jsx)(he.l6,{options:[...ue,...ye],value:Y.rowField,onChange:Ue,isClearable:!0})}),(0,T.jsx)(J.I,{label:"Cell Value",labelWidth:10,children:(0,T.jsx)(he.l6,{options:[...ue,...ye],value:Y.valueField,onChange:_e,isClearable:!0})}),(0,T.jsx)(J.I,{label:"Empty Value",children:(0,T.jsx)(he.l6,{options:He,value:Y.emptyValue,onChange:rt,isClearable:!0})})]})})},Ga={id:k.F.groupingToMatrix,editor:Ea,transformation:_.c.groupingToMatrixTransformer,name:_.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([o.m.Combine,o.m.Reformat]),help:ne(k.F.groupingToMatrix).helperDocs};var Wa=e(27844);const To=({input:Q,options:Y,onChange:se})=>{const[ye,Ce]=(0,s.useState)({bucketCount:!(0,me.N_)(Y.bucketCount||""),bucketSize:!(0,me.N_)(Y.bucketSize||""),bucketOffset:!(0,me.N_)(Y.bucketOffset||"")}),Ue=(0,s.useCallback)(xt=>{Ce({...ye,bucketCount:!(0,me.N_)(xt)}),se({...Y,bucketCount:Number(xt)===0?void 0:Number(xt)})},[se,Y,ye]),_e=(0,s.useCallback)(xt=>{Ce({...ye,bucketSize:!(0,me.N_)(xt)}),se({...Y,bucketSize:xt})},[se,Y,ye,Ce]),He=(0,s.useCallback)(xt=>{Ce({...ye,bucketOffset:!(0,me.N_)(xt)}),se({...Y,bucketOffset:xt})},[se,Y,ye,Ce]),rt=(0,s.useCallback)(()=>{se({...Y,combine:!Y.combine})},[se,Y]),it=(0,me.I9)();return(0,T.jsxs)("div",{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{invalid:ye.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Wa.Rt.bucketCount.name,tooltip:Wa.Rt.bucketCount.description,children:(0,T.jsx)(de.y,{suggestions:it,value:Y.bucketCount,placeholder:"Default: 30",onChange:Ue})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{invalid:ye.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Wa.Rt.bucketSize.name,tooltip:Wa.Rt.bucketSize.description,children:(0,T.jsx)(de.y,{suggestions:it,value:Y.bucketSize,placeholder:"auto",onChange:_e})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{labelWidth:18,label:Wa.Rt.bucketOffset.name,tooltip:Wa.Rt.bucketOffset.description,invalid:ye.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,T.jsx)(de.y,{suggestions:it,value:Y.bucketOffset,placeholder:"none",onChange:He})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{labelWidth:18,label:Wa.Rt.combine.name,tooltip:Wa.Rt.combine.description,children:(0,T.jsx)(In.K,{value:Y.combine??!1,onChange:rt})})})]})},ui={id:k.F.histogram,editor:To,transformation:_.c.histogramTransformer,name:_.c.histogramTransformer.name,description:_.c.histogramTransformer.description,categories:new Set([o.m.CreateNewVisualization]),help:ne(k.F.histogram).helperDocs};var jr=e(71393),Br=e(51396);const hi=[{value:jr.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:jr.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:jr.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function fi({input:Q,options:Y,onChange:se}){const ue=(0,Br.sE)(Q),ye=(0,Br.m3)(ue),Ce=(0,bn.w)().getVariables().map(He=>({value:"$"+He.name,label:"$"+He.name})),Ue=(0,s.useCallback)(He=>{se({...Y,byField:He?.value})},[se,Y]),_e=(0,s.useCallback)(He=>{se({...Y,mode:He?.value})},[se,Y]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Mode",labelWidth:8,grow:!0,children:(0,T.jsx)(he.l6,{options:hi,value:Y.mode??jr.W.outer,onChange:_e})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Field",labelWidth:8,grow:!0,children:(0,T.jsx)(he.l6,{options:[...ye,...Ce],value:Y.byField,onChange:Ue,placeholder:"time",isClearable:!0})})})]})}const gi={id:k.F.joinByField,aliasIds:[k.F.seriesToColumns],editor:fi,transformation:_.c.joinByFieldTransformer,name:_.c.joinByFieldTransformer.name,description:_.c.joinByFieldTransformer.description,categories:new Set([o.m.Combine]),help:ne(k.F.joinByField).helperDocs};var Ur=e(55883);const pi=[{value:Ur.n.Columns,label:"Columns"},{value:Ur.n.Rows,label:"Rows"}],mi=({input:Q,options:Y,onChange:se})=>{const{labelNames:ye,selected:Ce}=(0,s.useMemo)(()=>{let He=[],rt={};for(const xt of Q)for(const Mt of xt.fields)if(Mt.labels)for(const Dt of Object.keys(Mt.labels))rt[Dt]||(He.push({value:Dt,label:Dt}),rt[Dt]=!0);const it=new Set(Y.keepLabels?.length?Y.keepLabels:Object.keys(rt));return{labelNames:He,selected:it}},[Y.keepLabels,Q]),Ue=He=>{se({...Y,valueLabel:He?.value})},_e=He=>{if(Ce.has(He)?Ce.delete(He):Ce.add(He),Ce.size===ye.length||!Ce.size){const{keepLabels:rt,...it}=Y;se(it)}else se({...Y,keepLabels:[...Ce]})};return(0,T.jsxs)("div",{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Mode",labelWidth:20,children:(0,T.jsx)(Z.z,{options:pi,value:Y.mode??Ur.n.Columns,onChange:He=>se({...Y,mode:He})})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Labels",labelWidth:20,children:(0,T.jsx)(Rs.B,{gap:1,wrap:"wrap",children:ye.map((He,rt)=>{const it=He.label;return(0,T.jsx)(yn.m,{onClick:()=>_e(it),label:it,selected:Ce.has(it)},`${it}/${rt}`)})})})}),Y.mode!==Ur.n.Rows&&(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name",children:(0,T.jsx)(he.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:ye,value:Y?.valueLabel,onChange:Ue,className:"min-width-16"})})})]})},So={id:k.F.labelsToFields,editor:mi,transformation:_.c.labelsToFieldsTransformer,name:_.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([o.m.Reformat]),help:ne(k.F.labelsToFields).helperDocs},Mo=({options:Q,onChange:Y})=>{const[se,ue]=(0,s.useState)(!1),ye=(0,s.useCallback)(Ce=>{ue(!(0,me.N_)(Ce)),Y({...Q,limitField:Ce})},[Y,Q]);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(le.C,{children:(0,T.jsx)(de.y,{invalid:se,error:"Value needs to be an integer or a variable",value:String(Q.limitField),onChange:ye,placeholder:"Value or variable",suggestions:(0,me.I9)()})})})},Oo={id:k.F.limit,editor:Mo,transformation:_.c.limitTransformer,name:_.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([o.m.Filter]),help:ne(k.F.limit).helperDocs},Nr=({input:Q,options:Y,onChange:se})=>Q.length<=1?(0,T.jsx)(Kt.P,{children:"Merge has no effect when applied on a single frame."}):null,Io={id:k.F.merge,editor:Nr,transformation:_.c.mergeTransformer,name:_.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([o.m.Combine]),help:ne(k.F.merge).helperDocs};var Wr=e(86242),Ua=e(45565);const Fr=({options:Q,input:Y,onChange:se})=>{const{indexByName:ue,excludeByName:ye,renameByName:Ce,includeByName:Ue}=Q,_e=(0,me.ZI)(Y),He=(0,s.useMemo)(()=>yi(_e,ue),[_e,ue]),rt=Ue&&Object.keys(Ue).length>0?"include":"exclude",it=(0,s.useCallback)((Tt,wt)=>{se({...Q,excludeByName:{...ye,[Tt]:wt}})},[se,Q,ye]),xt=(0,s.useCallback)((Tt,wt)=>{const sn={...Q,includeByName:{...Ue,[Tt]:!wt}};se(sn)},[se,Q,Ue]),Mt=(0,s.useCallback)(Tt=>{if(!Tt||!Tt.destination)return;const wt=Tt.source.index,sn=Tt.destination.index;wt!==sn&&se({...Q,indexByName:vi(_e,wt,sn)})},[se,Q,_e]),Dt=(0,s.useCallback)((Tt,wt)=>{se({...Q,renameByName:{...Q.renameByName,[Tt]:wt}})},[se,Q]);return Y.length>1?(0,T.jsx)(Kt.P,{children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."}):(0,T.jsx)(ft.DragDropContext,{onDragEnd:Mt,children:(0,T.jsx)(ft.Droppable,{droppableId:"sortable-fields-transformer",direction:"vertical",children:Tt=>(0,T.jsxs)("div",{ref:Tt.innerRef,...Tt.droppableProps,children:[He.map((wt,sn)=>{const Rn=Ue&&wt in Ue?Ue[wt]:!1,$n=rt==="include"?Rn:!ye[wt],rs=rt==="include"?xt:it;return(0,T.jsx)(Ao,{fieldName:wt,renamedFieldName:Ce[wt],index:sn,onToggleVisibility:rs,onRenameField:Dt,visible:$n},wt)}),Tt.placeholder]})})})};Fr.displayName="OrganizeFieldsTransformerEditor";const Ao=({fieldName:Q,renamedFieldName:Y,index:se,visible:ue,onToggleVisibility:ye,onRenameField:Ce})=>{const Ue=(0,at.of)(Ro);return(0,T.jsx)(ft.Draggable,{draggableId:Q,index:se,children:_e=>(0,T.jsxs)(te.a,{marginBottom:.5,display:"flex",gap:0,ref:_e.innerRef,..._e.draggableProps,children:[(0,T.jsx)(Xe.c,{width:60,as:"div",children:(0,T.jsxs)(Rs.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,T.jsx)("span",{..._e.dragHandleProps,children:(0,T.jsx)(vt.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:Ue.draggable})}),(0,T.jsx)(Zt.K,{className:Ue.toggle,size:"md",name:ue?"eye":"eye-slash",onClick:()=>ye(Q,ue),tooltip:ue?"Disable":"Enable"}),(0,T.jsx)(Ua.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:Q})]})}),(0,T.jsx)(lt.p,{defaultValue:Y||"",placeholder:`Rename ${Q}`,onBlur:He=>Ce(Q,He.currentTarget.value)})]})})};Ao.displayName="DraggableFieldName";const Ro=Q=>({toggle:(0,Re.css)({margin:Q.spacing(0,1),color:Q.colors.text.secondary}),draggable:(0,Re.css)({opacity:.4,"&:hover":{color:Q.colors.text.maxContrast}})}),vi=(Q,Y,se)=>{const ue=Array.from(Q),[ye]=ue.splice(Y,1);return ue.splice(se,0,ye),ue.reduce((Ce,Ue,_e)=>(Ce[Ue]=_e,Ce),{})},yi=(Q,Y={})=>{if(!Y||Object.keys(Y).length===0)return Q;const se=(0,Wr.X)(Y);return Q.sort(se)},xi={id:k.F.organize,editor:Fr,transformation:_.c.organizeFieldsTransformer,name:_.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([o.m.ReorderAndRename]),help:ne(k.F.organize).helperDocs};var gr=e(27586),da=e(58779);const er=({options:Q,onChange:Y})=>{const se=[{label:"Series to rows",value:gr.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:gr.rV.ReduceFields,description:"Collapse each field into a single value"}],ue=(0,s.useCallback)(Ue=>{const _e=Ue.value;Y({...Q,mode:_e,includeTimeField:_e===gr.rV.ReduceFields?!!Q.includeTimeField:!1})},[Y,Q]),ye=(0,s.useCallback)(()=>{Y({...Q,includeTimeField:!Q.includeTimeField})},[Y,Q]),Ce=(0,s.useCallback)(()=>{Y({...Q,labelsToFields:!Q.labelsToFields})},[Y,Q]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{label:"Mode","data-testid":da.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,T.jsx)(he.l6,{options:se,value:se.find(Ue=>Ue.value===Q.mode)||se[0],onChange:ue})}),(0,T.jsx)(J.I,{label:"Calculations","data-testid":da.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,T.jsx)(st.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:Q.reducers||[],onChange:Ue=>{Y({...Q,reducers:Ue})}})}),Q.mode===gr.rV.ReduceFields&&(0,T.jsx)(J.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time",children:(0,T.jsx)(In.K,{id:"include-time-field",value:!!Q.includeTimeField,onChange:ye})}),Q.mode!==gr.rV.ReduceFields&&(0,T.jsx)(J.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields",children:(0,T.jsx)(In.K,{id:"labels-to-fields",value:!!Q.labelsToFields,onChange:Ce})})]})},Ei={id:k.F.reduce,editor:er,transformation:_.c.reduceTransformer,name:_.c.reduceTransformer.name,description:_.c.reduceTransformer.description,categories:new Set([o.m.CalculateNewFields]),help:ne(k.F.reduce).helperDocs};class Pi extends s.PureComponent{constructor(Y){super(Y),this.handleRegexChange=se=>{const ue=se.currentTarget.value;let ye=!0;if(ue)try{ue&&(0,hs.dO)(ue)}catch{ye=!1}this.setState(Ce=>({...Ce,regex:ue,isRegexValid:ye}))},this.handleRenameChange=se=>{const ue=se.currentTarget.value;this.setState(ye=>({...ye,renamePattern:ue}))},this.handleRegexBlur=se=>{const ue=se.currentTarget.value;let ye=!0;try{ue&&(0,hs.dO)(ue)}catch{ye=!1}this.setState({isRegexValid:ye},()=>{ye&&this.props.onChange({...this.props.options,regex:ue})})},this.handleRenameBlur=se=>{const ue=se.currentTarget.value;this.setState({renamePattern:ue},()=>this.props.onChange({...this.props.options,renamePattern:ue}))},this.state={regex:Y.options.regex,renamePattern:Y.options.renamePattern,isRegexValid:!0}}render(){const{regex:Y,renamePattern:se,isRegexValid:ue}=this.state;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{label:"Match",labelWidth:16,invalid:!ue,error:ue?void 0:"Invalid pattern",children:(0,T.jsx)(lt.p,{placeholder:"Regular expression pattern",value:Y||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,T.jsx)(J.I,{label:"Replace",labelWidth:16,children:(0,T.jsx)(lt.p,{placeholder:"Replacement pattern",value:se||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const Di={id:k.F.renameByRegex,editor:Pi,transformation:_.c.renameByRegexTransformer,name:_.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([o.m.ReorderAndRename]),help:ne(k.F.renameByRegex).helperDocs},ir=({input:Q,options:Y,onChange:se})=>null,Ci={id:k.F.seriesToRows,editor:ir,transformation:_.c.seriesToRowsTransformer,name:_.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([o.m.Combine,o.m.Reformat]),help:ne(k.F.seriesToRows).helperDocs},Pa=({input:Q,options:Y,onChange:se})=>{const ue=(0,me.ZI)(Q).map(He=>({label:He,value:He})),Ce=(0,bn.w)().getVariables().map(He=>({label:"$"+He.name,value:"$"+He.name})),Ue=(0,s.useCallback)((He,rt)=>{se({...Y,sort:[rt]})},[se,Y]),_e=Y.sort?.length?Y.sort:[{}];return(0,T.jsx)("div",{children:_e.map((He,rt)=>(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Field",labelWidth:10,grow:!0,children:(0,T.jsx)(he.l6,{options:[...ue,...Ce],value:He.field,placeholder:"Select field",onChange:it=>{Ue(rt,{...He,field:it.value})}})}),(0,T.jsx)(J.I,{label:"Reverse",children:(0,T.jsx)(In.K,{value:!!He.desc,onChange:()=>{Ue(rt,{...He,desc:!He.desc})}})})]},`${He.field}/${rt}`))})},ro={id:k.F.sortBy,editor:Pa,transformation:_.c.sortByTransformer,name:_.c.sortByTransformer.name,description:_.c.sortByTransformer.description,categories:new Set([o.m.ReorderAndRename]),help:ne(k.F.sortBy).helperDocs},bi=({options:Q,onChange:Y})=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"First field name",labelWidth:24,children:(0,T.jsx)(lt.p,{placeholder:"Field",value:Q.firstFieldName,onChange:se=>Y({...Q,firstFieldName:se.currentTarget.value}),width:25})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Remaining fields name",tooltip:"Name for value fields",labelWidth:24,children:(0,T.jsx)(lt.p,{placeholder:"Value",value:Q.restFieldsName,onChange:se=>Y({...Q,restFieldsName:se.currentTarget.value}),width:25})})})]}),Kr={id:k.F.transpose,editor:bi,transformation:_.c.transposeTransformer,name:_.c.transposeTransformer.name,description:_.c.transposeTransformer.description,categories:new Set([o.m.Reformat])};var Lo=e(51064);function Ti({options:Q,onChange:Y}){const[se,ue]=(0,s.useState)(Q),ye=oo(),Ce=Si(),Ue=()=>{se.push({path:""}),ue([...se]),rt()},_e=it=>{se&&(se.splice(it,1),ue([...se]),rt())},He=(it,xt,Mt)=>{se&&(Mt==="alias"?se[xt].alias=it.currentTarget.value??"":se[xt].path=it.currentTarget.value??"",ue([...se]))},rt=()=>{Y(se)};return(0,T.jsxs)("ol",{className:(0,Re.cx)(Ce.list),children:[se&&se.map((it,xt)=>(0,T.jsx)("li",{children:(0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{label:"Field",tooltip:ye.field,grow:!0,children:(0,T.jsx)(lt.p,{onBlur:rt,onChange:Mt=>He(Mt,xt,"path"),value:it.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})}),(0,T.jsx)(J.I,{label:"Alias",tooltip:ye.alias,children:(0,T.jsx)(lt.p,{width:12,value:it.alias,onBlur:rt,onChange:Mt=>He(Mt,xt,"alias")})}),(0,T.jsx)(J.I,{className:(0,Re.cx)(Ce.removeIcon),children:(0,T.jsx)(Zt.K,{onClick:()=>_e(xt),name:"trash-alt",tooltip:"Remove path"})})]})},xt)),(0,T.jsx)(J.I,{children:(0,T.jsx)(ae.$n,{icon:"plus",onClick:()=>Ue(),variant:"secondary",children:"Add path"})})]})}const oo=()=>{const Q=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:(0,T.jsxs)("div",{children:["A valid path of an json object.",(0,T.jsx)("div",{children:(0,T.jsx)("strong",{children:"JSON Value:"})}),(0,T.jsx)("pre",{children:(0,T.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,T.jsx)("strong",{children:"Valid Paths:"}),Q.map((Y,se)=>(0,T.jsxs)("p",{children:[(0,T.jsx)("code",{children:Y.path}),(0,T.jsx)("i",{children:Y.description})]},se))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function Si(){return{list:(0,Re.css)({marginLeft:"20px"}),removeIcon:(0,Re.css)({margin:"0 0 0 4px",alignItems:"center"})}}var tr=e(4038),Na=(Q=>(Q.JSON="json",Q.KeyValues="kvp",Q.Auto="auto",Q.RegExp="regexp",Q.Delimiter="delimiter",Q))(Na||{});const Mi={id:Na.JSON,name:"JSON",description:"Parse JSON string",getParser:Q=>Y=>JSON.parse(Y)},wr={id:Na.RegExp,name:"RegExp",description:"Parse with RegExp",getParser:Q=>{let Y=/(?<NewField>.*)/;if((0,hs.AP)(Q.regExp))try{Y=(0,hs.dO)(Q.regExp)}catch(se){se instanceof Error&&console.warn(se.message)}return se=>se.match(Y)?.groups}};function Oi(Q){const Y=[];let se="",ue="";const ye={};for(let Ce=0;Ce<Q.length;Ce++){let Ue=Q[Ce];Ue===se&&(se="",Ue=Q[++Ce]);const _e=Ue==="\\";if(_e&&(Ue=Q[++Ce]),_e||se.length){Y.push(Ue);continue}switch((Ue==='"'||Ue==="'")&&(se=Ue),Ue){case":":case"=":Y.length&&(ue&&(ye[ue]=""),ue=Y.join(""),Y.length=0);break;case'"':case"'":case" ":case"	":case"\r":case`
`:Y.length&&ue===""&&(ye[Y.join("")]="",Y.length=0);case",":case";":case"&":case"{":case"}":if(Y.length){const He=Y.join("");ue.length?(ye[ue]=He,ue=""):ue=He,Y.length=0}break;default:Y.push(Ue),Ce===Q.length-1&&ue===""&&Y.length&&(ye[Y.join("")]="",Y.length=0)}}return ue.length&&(ye[ue]=Y.join("")),ye}const io={id:Na.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",getParser:Q=>Oi},jo={id:Na.Delimiter,name:"Split by delimiter",description:"Splits at delimited values, such as commas",getParser:({delimiter:Q=","})=>{const Y=new RegExp(`\\s*${(0,hs.jD)(Q)}\\s*`,"g");return se=>{const ue=se.trim().split(Y),ye={};for(const Ce of ue)ye[Ce]=1;return ye}}},Bo=[Mi,io,jo,wr],Ii={id:Na.Auto,name:"Auto",description:"parse new fields automatically",getParser:Q=>{const Y=Bo.map(se=>se.getParser(Q));return se=>{for(const ue of Y)try{const ye=ue(se);if(ye!=null)return ye}catch{}}}},Uo=new oe.O(()=>[...Bo,Ii]),pr={id:k.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{delimiter:","},operator:(Q,Y)=>se=>se.pipe((0,wn.T)(ue=>pr.transformer(Q,Y)(ue))),transformer:Q=>Y=>Y.map(se=>No(se,Q))};function No(Q,Y){if(!Y.source)return Q;const se=(0,ct.findField)(Q,Y.source);if(!se)return Q;const ue=Uo.getIfExists(Y.format??Na.Auto);if(!ue)throw new Error("unkonwn extractor");const ye=Q.length,Ce=[],Ue=new Map,_e=ue.getParser(Y);for(let rt=0;rt<ye;rt++){let it=se.values[rt];if((0,z.isString)(it))try{it=_e(it)}catch{it={}}if(it!=null){if(Y.format===Na.JSON&&Y.jsonPaths&&Y.jsonPaths?.length>0){const xt={},Mt=Y.jsonPaths.filter(Dt=>Dt.path);Mt.length>0&&(Mt.forEach(Dt=>{const Tt=Dt.alias&&Dt.alias.length>0?Dt.alias:Dt.path;xt[Tt]=(0,z.get)(it,Dt.path)??"Not Found"}),it=xt)}for(const[xt,Mt]of Object.entries(it)){let Dt=Ue.get(xt);Dt==null&&(Dt=new Array(ye).fill(void 0),Ue.set(xt,Dt),Ce.push(xt)),Dt[rt]=Mt}}}const He=Ce.map(rt=>{const it=Ue.get(rt),xt={name:rt,values:it,type:it?(0,tr.oE)(it.find(Mt=>Mt!=null)):w.PU.other,config:{}};return V.$.featureToggles.extractFieldsNameDeduplication&&(xt.name=(0,X.fk)(xt,Q)),xt});if(Y.keepTime){const rt=(0,ct.findField)(Q,"Time")||(0,ct.findField)(Q,"time");rt&&He.unshift(rt)}return Y.replace||He.unshift(...Q.fields),{...Q,fields:He}}const Ai={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},Wo=({input:Q,options:Y={delimiter:","},onChange:se})=>{const ue=xt=>{se({...Y,source:xt})},ye=xt=>{se({...Y,format:xt?.value})},Ce=xt=>{se({...Y,jsonPaths:xt})},Ue=xt=>{se({...Y,regExp:xt.target.value})},_e=xt=>{se({...Y,delimiter:xt.value})},He=()=>{Y.replace&&(Y.keepTime=!1),se({...Y,replace:!Y.replace})},rt=()=>{se({...Y,keepTime:!Y.keepTime})},it=Uo.selectOptions(Y.format?[Y.format]:void 0);return(0,T.jsxs)("div",{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Source",labelWidth:16,children:(0,T.jsx)(Yt.O,{context:{data:Q},value:Y.source??"",onChange:ue,item:Ai})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Format",labelWidth:16,children:(0,T.jsx)(he.l6,{value:it.current[0],options:it.options,onChange:ye,width:24,placeholder:"Auto"})})}),Y.format===Na.RegExp&&(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"RegExp",labelWidth:16,interactive:!0,tooltip:"Example: /(?<NewField>.*)/",children:(0,T.jsx)(lt.p,{placeholder:"/(?<NewField>.*)/",value:Y.regExp,onChange:Ue})})}),Y.format===Na.JSON&&(0,T.jsx)(Ti,{options:Y.jsonPaths??[],onChange:Ce}),Y.format===Na.Delimiter&&(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Delimiter",labelWidth:16,children:(0,T.jsx)(Lo.G,{value:Y.delimiter,options:[{value:","},{value:";"},{value:"|"}],onChange:_e,placeholder:"Select delimiter...",width:24})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Replace all fields",labelWidth:16,children:(0,T.jsx)(In.K,{value:Y.replace??!1,onChange:He})})}),Y.replace&&(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Keep time",labelWidth:16,children:(0,T.jsx)(In.K,{value:Y.keepTime??!1,onChange:rt})})})]})},Ri={id:k.F.extractFields,editor:Wo,transformation:pr,name:pr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([o.m.Reformat]),help:ne(k.F.extractFields).helperDocs};var Fo=e(31952);const lr={id:k.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(Q,Y)=>se=>se.pipe((0,wn.T)(ue=>lr.transformer(Q,Y)(ue))),transformer:Q=>Y=>!Y||!Y.length?Y:[Li(Q,Y)]};function Li(Q,Y){if(!Q.value?.length)return lo("No value label configured");const se=(0,me.aG)(Y);if(se.size<1)return lo("No labels in result");if(!se.has(Q.value))return lo("Value label not found");let ue=Q.join?.length?Q.join:Array.from(se);ue=ue.filter(xt=>xt!==Q.value);const ye=new Set,Ce=new Map,Ue={};for(const xt of Y)for(const Mt of xt.fields)if(Mt.labels&&Mt.type!==w.PU.time){const Dt=ue.map(rs=>Mt.labels[rs]),Tt=Dt.join(",");let wt=Ce.get(Tt);wt||(wt={keys:Dt,values:{}},Ce.set(Tt,wt));const sn=Mt.labels[Q.value],Rn=Mt.values,$n=wt.values[sn];$n?wt.values[sn]=$n.concat(Rn):wt.values[sn]=Rn,Ue[sn]||(Ue[sn]=Mt),ye.add(sn)}const _e=Array.from(ye),He=ue.map(()=>[]),rt=_e.map(()=>[]);for(const xt of Ce.values()){let Mt=-1,Dt=!1;for(;!Dt;){Mt++,Dt=!0;for(let Tt=0;Tt<ue.length;Tt++)He[Tt].push(xt.keys[Tt]);for(let Tt=0;Tt<_e.length;Tt++){const wt=_e[Tt],sn=xt.values[wt]??[];rt[Tt].push(sn[Mt]),sn.length>Mt+1&&(Dt=!1)}}}const it={fields:[],length:rt[0].length,refId:`${k.F.joinByLabels}-${Y.map(xt=>xt.refId).join("-")}`};for(let xt=0;xt<ue.length;xt++)it.fields.push({name:ue[xt],config:{},type:w.PU.string,values:He[xt]});for(let xt=0;xt<_e.length;xt++){const Mt=Ue[_e[xt]];it.fields.push({name:_e[xt],config:{},type:Mt.type??w.PU.number,values:rt[xt]})}return it}function lo(Q){return{meta:{notices:[{severity:"error",text:Q}]},fields:[{name:"Error",type:w.PU.string,config:{},values:[Q]}],length:0}}function Ko({input:Q,options:Y,onChange:se}){const ue=(0,s.useMemo)(()=>{let He;const rt=(0,me.aG)(Q),it=Array.from(rt).map(sn=>({label:sn,value:sn}));let xt=it.find(sn=>sn.value===Y.value);!xt&&Y.value&&(xt={label:`${Y.value} (not found)`,value:Y.value},it.push(xt)),Q.length?rt.size===0&&(He=(0,T.jsx)(xa.F,{title:"No labels found",children:"The input does not contain any labels"})):He=(0,T.jsx)(xa.F,{title:"No input found",children:"No input (or labels) found"}),rt.delete(Y.value);const Mt=Array.from(rt).map(sn=>({label:sn,value:sn}));let Dt=Mt;const Tt=!!Y.join?.length;let wt="Join";return Tt?Dt=Mt.filter(sn=>!Y.join.includes(sn.value)):wt=Mt.map(sn=>sn.value).join(", "),{warn:He,valueOptions:it,valueOption:xt,joinOptions:Mt,addOptions:Dt,addText:wt,hasJoin:Tt,key:Date.now()}},[Y,Q]),ye=(He,rt)=>{if(!Y.join)return;const it=Y.join.slice();if(rt)it[He]=rt;else if(it.splice(He,1),!it.length){se({...Y,join:void 0});return}const xt=new Set(it);Y.value&&xt.delete(Y.value),se({...Y,join:Array.from(xt)})},Ce=He=>{const rt=He?.value;if(!rt)return;const it=Y.join?Y.join.slice():[];it.push(rt),se({...Y,join:it})},Ue=10,_e="No labels found";return(0,T.jsxs)("div",{children:[ue.warn,(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{error:"required",invalid:!Y.value?.length,label:"Value",labelWidth:Ue,tooltip:"Select the label indicating the values name",children:(0,T.jsx)(he.l6,{options:ue.valueOptions,value:ue.valueOption,onChange:He=>se({...Y,value:He.value}),noOptionsMessage:_e})})}),ue.hasJoin?Y.join.map((He,rt)=>(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Join",labelWidth:Ue,error:"Unable to join by the value label",invalid:He===Y.value,children:(0,T.jsxs)(mn.Gy,{children:[(0,T.jsx)(he.l6,{options:ue.joinOptions,value:ue.joinOptions.find(it=>it.value===He),isClearable:!0,onChange:it=>ye(rt,it?.value),noOptionsMessage:_e}),!!(ue.addOptions.length&&rt===Y.join.length-1)&&(0,T.jsx)(Fo.i,{icon:"plus",label:"",options:ue.addOptions,onChange:Ce,variant:"secondary"})]})})},He+rt)):(0,T.jsx)(T.Fragment,{children:!!ue.addOptions.length&&(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Join",labelWidth:Ue,children:(0,T.jsx)(he.l6,{options:ue.addOptions,placeholder:ue.addText,onChange:Ce,noOptionsMessage:_e})})})})]})}const co={id:lr.id,editor:Ko,transformation:lr,name:lr.name,description:lr.description,state:fe.pn.beta,categories:new Set([o.m.Combine]),help:ne(lr.id).helperDocs};var ji=e(53304),mr=e(69862),nr=e(65474),wo=e(93124);const Vo={id:k.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:Q=>Y=>Y.pipe((0,mr.Z)(se=>(0,nr.H)($o(se,Q))))};async function $o(Q,Y){const se=H.sJ.get(G.Ct.byName).get(Y?.lookupField),ue=await(0,wo.q3)(Y?.gazetteer??wo.fx);return ue.frame?Vr(Q,ue,se):Promise.reject("missing frame in gazetteer")}function Vr(Q,Y,se){const ue=Y.frame()?.fields;return ue?Q.map(ye=>{const Ce=ye.length,Ue=[];for(const _e of ye.fields)if(Ue.push(_e),se(_e,ye,Q)){const He=_e.values,rt=[];for(const it of ue){const xt=new Array(Ce);rt.push(xt),Ue.push({...it,values:xt})}for(let it=0;it<Y.count;it++){const xt=Y.find(He[it]);if(xt?.index!=null)for(let Mt=0;Mt<ue.length;Mt++)rt[Mt][it]=ue[Mt].values[xt.index]}}return{...ye,fields:Ue}}):Q}const Bi={settings:{width:30,filter:Q=>Q.type===w.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},Ui={settings:{}},Ni=({input:Q,options:Y,onChange:se})=>{const ue=(0,s.useCallback)(Ce=>{se({...Y,lookupField:Ce})},[se,Y]),ye=(0,s.useCallback)(Ce=>{se({...Y,gazetteer:Ce})},[se,Y]);return(0,T.jsxs)("div",{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Field",labelWidth:12,children:(0,T.jsx)(Yt.O,{context:{data:Q},value:Y?.lookupField??"",onChange:ue,item:Bi})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Lookup",labelWidth:12,children:(0,T.jsx)(ji.G,{value:Y?.gazetteer??"",context:{data:Q},item:Ui,onChange:ye})})})]})},Wi={id:k.F.fieldLookup,editor:Ni,transformation:Vo,name:Vo.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:fe.pn.alpha,categories:new Set([o.m.PerformSpatialOperations]),help:ne(k.F.fieldLookup).helperDocs};var zo=e(3468),uo=e(6896);const Ho=(Q,Y,se=[])=>(Y===0?se.push(Q):Q.forEach(ue=>{Ho(ue,Y-1,se)}),se);function _o(Q){const Y=Q[0].length,se=Q.length,ue=new Map;for(let ye=0;ye<Y;ye++){let Ce=ue;for(let Ue=0;Ue<se;Ue++){let _e=Q[Ue][ye],He=Ce.get(_e);He==null&&(He=Ue===se-1?[]:new Map,Ce.set(_e,He)),Ce=He}Ce.push(ye)}return Ho(ue,se)}const Fi={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function Go(Q,Y,se){return Y.map((ue,ye)=>Q.withNames?`${ue}${Q.separator1}${se[ye]}`:se[ye]).join(Q.separator2)}function Ki(Q,Y){const se={};return Q.forEach((ue,ye)=>{se[ue]=String(Y[ye])}),se}const $r={id:k.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(Q,Y)=>se=>se.pipe((0,wn.T)(ue=>$r.transformer(Q,Y)(ue))),transformer:(Q,Y)=>{const se=(0,zo.R)({names:Q.fields});if(!se)return uo.W.transformer({},Y);const ue=(0,H.NS)(se);return ye=>ye.length?Qo(ye[0],ue,Q):ye}};function Qo(Q,Y,se){const ue=Q.fields.filter(_e=>Y(_e,Q,[Q]));if(!ue.length)return[Q];const ye=ue.map(_e=>_e.values),Ce=ue.map(_e=>_e.name),Ue={...Fi,...se?.naming};return _o(ye).map(_e=>{let He=Q.name,rt={};if(Ue.asLabels)rt=Ki(Ce,ue.map((xt,Mt)=>ye[Mt][_e[0]]));else{let xt=Go(Ue,Ce,ue.map((Mt,Dt)=>ye[Dt][_e[0]]));Ue?.append&&Q.name&&(xt=`${Q.name} ${xt}`),He=xt}let it=Q.fields;if(!se?.keepFields){const xt=new Set(Ce);it=Q.fields.filter(Mt=>!xt.has(Mt.name))}return{name:He,meta:Q.meta,length:_e.length,fields:it.map(xt=>{const Mt=xt.values,Dt=Array(_e.length);for(let Tt=0;Tt<_e.length;Tt++)Dt[Tt]=Mt[_e[Tt]];return{name:xt.name,type:xt.type,config:xt.config,labels:{...xt.labels,...rt},values:Dt}})}})}function ko({input:Q,options:Y,onChange:se}){const ue=(0,Br.sE)(Q),ye=(0,Br.m3)(ue),Ce=(0,s.useMemo)(()=>{const Mt=new Set(Y.fields);return Mt.size<1?ye:ye.filter(Dt=>!Mt.has(Dt.value))},[ye,Y]),Ue=(0,s.useCallback)(Mt=>{if(!Mt.value)return;const Dt=new Set(Y.fields);Dt.add(Mt.value),se({...Y,fields:[...Dt]})},[se,Y]);let _e;(Mt=>{Mt[Mt.asLabels=0]="asLabels",Mt[Mt.frameName=1]="frameName"})(_e||(_e={}));const He=[{label:"As label",value:0},{label:"As frame name",value:1}],rt=[{label:"Yes",value:!0},{label:"No",value:!1}],it=(0,s.useCallback)(Mt=>{if(!Mt)return;const Dt=new Set(Y.fields);Dt.delete(Mt),se({...Y,fields:[...Dt]})},[se,Y]);if(Q.length>1)return(0,T.jsx)(Kt.P,{children:"Partition by values only works with a single frame."});const xt=[...new Set(Y.fields)];return(0,T.jsxs)("div",{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Field",labelWidth:10,grow:!0,children:(0,T.jsxs)(mn.Gy,{children:[xt.map(Mt=>(0,T.jsx)(ae.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>it(Mt),children:Mt},Mt)),Ce.length&&(0,T.jsx)(Fo.i,{variant:"secondary",size:"md",options:Ce,onChange:Ue,label:"Select field",icon:"plus"})]})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10,children:(0,T.jsx)(Z.z,{options:He,value:Y.naming?.asLabels===void 0||Y.naming.asLabels?0:1,onChange:Mt=>se({...Y,naming:{...Y.naming,asLabels:Mt===0}})})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16,children:(0,T.jsx)(Z.z,{options:rt,value:Y.keepFields,onChange:Mt=>se({...Y,keepFields:Mt})})})})]})}const wi={id:k.F.partitionByValues,editor:ko,transformation:$r,name:$r.name,description:$r.description,state:fe.pn.alpha,categories:new Set([o.m.Reformat]),help:ne(k.F.partitionByValues).helperDocs};var Za=e(47370),ho=e(36669),Yo=e(77230),cr=(Q=>(Q.TimeSeriesWide="wide",Q.TimeSeriesLong="long",Q.TimeSeriesMulti="multi",Q.TimeSeriesMany="many",Q))(cr||{});function Vi(Q){if(!Array.isArray(Q)||Q.length===0)return Q;const Y=[];for(const se of Jo(Q)){const ue=se.fields[0];if(!ue||ue.type!==w.PU.time)continue;const ye=[],Ce=[];for(const Ue of se.fields)switch(Ue.type){case w.PU.number:case w.PU.boolean:ye.push(Ue);break;case w.PU.string:Ce.push(Ue);break}for(const Ue of ye)if(Ce.length){const _e=new Map;for(let He=0;He<se.length;He++){const rt=ue.values[He],it=Ue.values[He];if(it===void 0||rt==null)continue;const xt=Ce.map(Dt=>Dt.values[He]).join("/");let Mt=_e.get(xt);if(!Mt){Mt={key:xt,time:[],value:[],labels:{}};for(const Dt of Ce)Mt.labels[Dt.name]=Dt.values[He];_e.set(xt,Mt)}Mt.time.push(rt),Mt.value.push(it)}for(const He of _e.values())Y.push({name:se.name,refId:se.refId,meta:{...se.meta,type:Za.m.TimeSeriesMulti},fields:[{...ue,values:He.time},{...Ue,values:He.value,labels:He.labels}],length:He.time.length})}else Y.push({name:se.name,refId:se.refId,meta:{...se.meta,type:Za.m.TimeSeriesMulti},fields:[ue,Ue],length:se.length})}return Y}function Jo(Q){if(!Array.isArray(Q)||Q.length===0)return Q;const Y=[];for(const se of Q){let ue;const ye=[],Ce={},Ue={},_e={},He={};for(let Tt=0;Tt<se.fields.length;Tt++){const wt=se.fields[Tt];switch(wt.type){case w.PU.string:case w.PU.boolean:wt.name in He||(He[wt.name]=Tt,Ue[wt.name]=!0);break;case w.PU.time:if(!ue){ue=wt;break}default:if(wt.name in Ce){const $n=Ce[wt.name];if(wt.type!==$n)continue}else Ce[wt.name]=wt.type,ye.push(wt.name);const sn=JSON.stringify(wt.labels),Rn=_e[sn];if(Rn!==void 0?Rn.push(Tt):_e[sn]=[Tt],wt.labels!=null)for(const $n in wt.labels)Ue[$n]=!0}}if(!ue)continue;const rt=[],it=[],xt=[],Mt=[];for(let Tt=0;Tt<se.length;Tt++)rt.push({time:ue.values[Tt],wideRowIndex:Tt});for(const Tt in _e)it.push(Tt);for(const Tt in Ue)xt.push(Tt);for(const Tt in He)Mt.push(Tt);rt.sort((Tt,wt)=>Tt.time-wt.time),it.sort(),xt.sort(),ye.sort();const Dt=new ho.k({...se,meta:{...se.meta,type:Za.m.TimeSeriesLong},fields:[{name:ue.name,type:ue.type}]});for(const Tt of ye)Dt.addField({name:Tt,type:Ce[Tt]});for(const Tt of xt)Dt.addField({name:Tt,type:w.PU.string});for(const Tt of rt){const{time:wt,wideRowIndex:sn}=Tt;for(const Rn of it){const $n={};for(const kn of Mt)$n[kn]=se.fields[He[kn]].values[sn];let rs=0;for(const kn of _e[Rn]){const ia=se.fields[kn];if(rs++===0&&ia.labels!=null)for(const ks in ia.labels)$n[ks]=ia.labels[ks];$n[ia.name]=ia.values[sn]}$n[ue.name]=wt,Dt.add($n)}}Y.push(Dt)}return Y}function $i(Q){return Qo(Q,se=>se.type===w.PU.string).map(se=>(se.meta||(se.meta={}),se.meta.type=Za.m.TimeSeriesMulti,se))}const sr={id:k.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(Q,Y)=>se=>se.pipe((0,wn.T)(ue=>sr.transformer(Q,Y)(ue))),transformer:Q=>{const Y=Q?.format??"wide";if(Y==="many"||Y==="multi")return Vi;if(Y==="long")return Jo;const se=H.sJ.get(G.Ct.firstTimeField).get({});return ue=>{if(!ue.length)return[];const ye=[];for(const Ue of ue)Ue.meta?.type===Za.m.TimeSeriesLong?$i(Ue).forEach(_e=>ye.push(_e)):ye.push(Ue);const Ce=(0,Yo.Fd)({frames:ye,joinBy:se,keepOriginIndices:!0});return Ce?(Ce.meta||(Ce.meta={}),Ce.meta.type=Za.m.TimeSeriesWide,[Ce]):[]}}},zi={label:"Wide time series",value:cr.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,T.jsxs)("ul",{children:[(0,T.jsx)("li",{children:"Single frame"}),(0,T.jsx)("li",{children:"1st field is shared time field"}),(0,T.jsx)("li",{children:"Time in ascending order"}),(0,T.jsx)("li",{children:"Multiple value fields of any type"})]})},bs={label:"Multi-frame time series",value:cr.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,T.jsxs)("ul",{children:[(0,T.jsx)("li",{children:"Multiple frames"}),(0,T.jsx)("li",{children:"Each frame has two fields: time, value"}),(0,T.jsx)("li",{children:"Time in ascending order"}),(0,T.jsx)("li",{children:"String values are represented as labels"}),(0,T.jsx)("li",{children:"All values are numeric"})]})},Xo={label:"Long time series",value:cr.TimeSeriesLong,description:"Convert each frame to long format",info:(0,T.jsxs)("ul",{children:[(0,T.jsx)("li",{children:"Single frame"}),(0,T.jsx)("li",{children:"1st field is time field"}),(0,T.jsx)("li",{children:"Time in ascending order, but may have duplicates"}),(0,T.jsx)("li",{children:"String values are represented as separate fields rather than as labels"}),(0,T.jsx)("li",{children:"Multiple value fields may exist"})]})},Ra=[zi,bs,Xo];function Zo(Q){const{options:Y,onChange:se}=Q,ue=(0,at.of)(fo),ye=(0,s.useCallback)(Ce=>{se({...Y,format:Ce.value})},[se,Y]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Format",labelWidth:12,children:(0,T.jsx)(he.l6,{width:35,options:Ra,value:Ra.find(Ce=>Ce.value===cr.TimeSeriesMulti&&Y.format===cr.TimeSeriesMany?!0:Ce.value===Y.format)||Ra[0],onChange:ye,className:"flex-grow-1"})})}),(0,T.jsx)(le.C,{children:(0,T.jsx)(J.I,{label:"Info",labelWidth:12,children:(0,T.jsx)("div",{className:ue.info,children:(Ra.find(Ce=>Ce.value===Y.format)||Ra[0]).info})})})]})}const fo=Q=>({info:(0,Re.css)({marginLeft:"20px"})}),Hi={id:sr.id,editor:Zo,transformation:sr,name:sr.name,description:sr.description,categories:new Set([o.m.Reformat]),help:ne(sr.id).helperDocs};var go=e(66648),qo=e(48817),zr=(Q=>(Q.linear="linear",Q.polynomial="polynomial",Q))(zr||{});const ar={predictionCount:100,modelType:"linear",degree:2},vr={id:k.F.regression,name:"Regression analysis",operator:(Q,Y)=>se=>se.pipe((0,wn.T)(ue=>vr.transformer(Q,Y)(ue))),transformer:(Q,Y)=>se=>{const{predictionCount:ue,modelType:ye,degree:Ce}={...ar,...Q};if(se.length===0)return se;const Ue=H.sJ.get(G.Ct.byName).get(Q.yFieldName),_e=H.sJ.get(G.Ct.byName).get(Q.xFieldName);let He,rt,it;for(const kn of se){const ia=kn.fields.find(ks=>Ue(ks,kn,se));if(ia){rt=ia;const ks=kn.fields.find(Lr=>_e(Lr,kn,se));if(ks){He=ks,it=kn;break}else throw"X and Y fields must be part of the same frame"}}if(!He||!rt)return se;let xt=He.values[0],Mt=He.values[0];for(let kn=1;kn<He.values.length;kn++)He.values[kn]<xt&&(xt=He.values[kn]),He.values[kn]>Mt&&(Mt=He.values[kn]);const Dt=(Mt-xt)/(ue-1),Tt=[...[...Array(ue-1).keys()].map((kn,ia)=>ia*Dt+xt),Mt],wt=He.type===w.PU.time?xt:0,sn=[],Rn=[];for(let kn=0;kn<He.values.length;kn++)rt.values[kn]!==null&&!isNaN(rt.values[kn])&&(Rn.push(He.values[kn]-wt),sn.push(rt.values[kn]));let $n;switch(ye){case"linear":$n=new qo.X(Rn,sn);break;case"polynomial":$n=new go.Y(Rn,sn,Ce);break;default:return se}const rs={name:`${ye} regression`,length:Tt.length,fields:[{name:He.name,type:He.type,values:Tt,config:{}},{name:`${(0,X.Ct)(rt,it,se)} predicted`,type:rt.type,values:Tt.map(kn=>$n.predict(kn-wt)),config:{}}]};return[...se,rs]}},po={editor:Yt.O,id:"",name:"",settings:{width:24,isClearable:!1}},yr=20,ei=({input:Q,options:Y,onChange:se})=>{const ue=[{label:"Linear",value:zr.linear},{label:"Polynomial",value:zr.polynomial}];return(0,s.useEffect)(()=>{let ye,Ce;if(!Y.xFieldName){const Ue=H.sJ.get(G.Ct.firstTimeField).get({});for(const _e of Q)if(ye=_e.fields.find(He=>Ue(He,_e,Q)),ye)break;if(!ye){const _e=H.sJ.get(G.Ct.numeric).get({});for(const He of Q)if(ye=He.fields.find(rt=>_e(rt,He,Q)),ye)break}}if(!Y.yFieldName){const Ue=H.sJ.get(G.Ct.numeric).get({});for(const _e of Q)if(Ce=_e.fields.find(He=>Ue(He,_e,Q)&&He!==ye),Ce)break}ye&&Ce&&se({...Y,xFieldName:ye.name,yFieldName:Ce.name})}),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J.I,{labelWidth:yr,label:"X field",children:(0,T.jsx)(Yt.O,{context:{data:Q},value:Y.xFieldName??"",item:po,onChange:ye=>{se({...Y,xFieldName:ye})}})}),(0,T.jsx)(J.I,{labelWidth:yr,label:"Y field",children:(0,T.jsx)(Yt.O,{context:{data:Q},value:Y.yFieldName??"",item:po,onChange:ye=>{se({...Y,yFieldName:ye})}})}),(0,T.jsx)(J.I,{labelWidth:yr,label:"Model type",children:(0,T.jsx)(he.l6,{value:Y.modelType??ar.modelType,onChange:ye=>{se({...Y,modelType:ye.value??ar.modelType})},options:ue})}),(0,T.jsx)(J.I,{labelWidth:yr,label:"Predicted points",tooltip:"Number of X,Y points to predict",children:(0,T.jsx)(Ut.Q,{value:Y.predictionCount??ar.predictionCount,onChange:ye=>{se({...Y,predictionCount:ye})}})}),Y.modelType===zr.polynomial&&(0,T.jsx)(J.I,{labelWidth:yr,label:"Degree",children:(0,T.jsx)(he.l6,{value:Y.degree??ar.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:ye=>{se({...Y,degree:ye.value})}})})]})},_i={id:k.F.regression,editor:ei,transformation:vr,name:vr.name,description:vr.description,categories:new Set([o.m.CalculateNewFields]),help:ne(k.F.regression).helperDocs},xr={id:k.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:Q=>Y=>Y.pipe((0,wn.T)(se=>se.map(ue=>ti(Q,ue))))};function ti(Q,Y){const se=dt(Y,Q.mappings??[],!0),{nameField:ue,valueField:ye}=se;if(!ue||!ye)return Y;const Ce=[];for(let Ue=0;Ue<ue.values.length;Ue++){const _e=ue.values[Ue],He=ye.values[Ue],rt=vn(Y,Ue,se),it=Qa(Y,Ue,se),xt={name:`${_e}`,type:ye.type,values:[He],config:rt,labels:it};Ce.push(xt)}return{fields:Ce,length:1,refId:`${k.F.rowsToFields}-${Y.refId}`}}function Qa(Q,Y,se){const ue={...se.nameField.labels};for(let ye=0;ye<Q.fields.length;ye++){const Ce=Q.fields[ye],Ue=(0,X.Ct)(Ce,Q),_e=se.index[Ue];if(_e.handler&&_e.handler.key!==pn.Label)continue;const He=Ce.values[Y];He!=null&&(ue[Ue]=He)}return ue}function mo({input:Q,options:Y,onChange:se}){return Q.length===0?null:(0,T.jsx)("div",{children:(0,T.jsx)(qt,{frame:Q[0],mappings:Y.mappings??[],onChange:ue=>se({...Y,mappings:ue}),withNameAndValue:!0})})}const ka={id:xr.id,editor:mo,transformation:xr,name:xr.name,description:xr.description,state:fe.pn.beta,categories:new Set([o.m.Reformat]),help:ne(xr.id).helperDocs};var Ya=e(7500),vo=e(68723),zs=e(79411),ni=e(7014),Er=e(47362),yo=e(30352);const Hr={id:k.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:Q=>Y=>Y.pipe((0,mr.Z)(se=>(0,nr.H)(si(se,Q))))};function xo(Q){return Q.action===zs.dy.Modify&&Q.modify?.op===zs.YD.LineBuilder}async function si(Q,Y){const se=await(0,Er.nE)(Y.source);if(xo(Y)){const ue=await(0,Er.nE)(Y.modify?.target);return Q.map(ye=>{const Ce=(0,Er.FM)(ye,se),Ue=(0,Er.FM)(ye,ue);if(Ce.field&&Ue.field){const _e=[...ye.fields],He=(0,ni.XR)(Ce.field,Ue.field),rt=_e[0];return rt.type===w.PU.geo&&rt!==Ce.field&&rt!==Ue.field?_e[0]=(0,ni.RA)(rt,He):_e.unshift(He),{...ye,fields:_e}}return ye})}return Q.map(ue=>{let ye=(0,Er.FM)(ue,se);if(ye.field){if(Y.action===zs.dy.Modify){switch(Y.modify?.op){case zs.YD.AsLine:let Ue=ye.field.name;return(!Ue||Ue==="Point")&&(Ue="Line"),{...ue,length:1,fields:[{...ye.field,name:Ue,type:w.PU.geo,values:[(0,yo.tt)(ye.field)]}]}}return ue}const Ce=ye.derived?[ye.field,...ue.fields]:ue.fields.slice(0);if(Y.action===zs.dy.Calculate&&(Ce.push((0,yo.pp)(ye.field,Y.calculate??{})),ye.derived=!0),ye.derived)return{...ue,fields:Ce}}return ue})}const Pr=(Q,Y)=>{const se=Y.options??{};Q.addSelect({path:"action",name:"Action",description:"",defaultValue:zs.dy.Prepare,settings:{options:[{value:zs.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:zs.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:zs.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),se.action===zs.dy.Calculate?Q.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:zs.kD.Heading,settings:{options:[{value:zs.kD.Heading,label:"Heading"},{value:zs.kD.Area,label:"Area"},{value:zs.kD.Distance,label:"Distance"}]}}):se.action===zs.dy.Modify&&Q.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:zs.YD.AsLine,settings:{options:[{value:zs.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:zs.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),xo(se)?(Q.addNestedOptions({category:["Source"],path:"source",build:(ue,ye)=>{const Ce=se.source??{mode:Ya.aG.Auto};(0,vo.G)("Point","",ue,Ce)}}),Q.addNestedOptions({category:["Target"],path:"modify",build:(ue,ye)=>{const Ce=se.modify?.target??{mode:Ya.aG.Auto};(0,vo.G)("Point","target.",ue,Ce)}})):(0,vo.G)("Location","source.",Q,se.source)},qa=Q=>{(0,s.useEffect)(()=>{if(!Q.options.source?.mode){const ue=Oe(Pr);Q.onChange({...ue,...Q.options}),console.log("geometry useEffect",ue)}},[]);const Y=il((0,at.$j)()),se=ke(Q,Pr);return(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{children:se.items.map(ue=>ue.render())}),(0,T.jsx)("div",{children:se.categories.map(ue=>(0,T.jsxs)("div",{className:Y.wrap,children:[(0,T.jsx)("h5",{children:ue.props.title}),(0,T.jsx)("div",{className:Y.item,children:ue.items.map(ye=>ye.render())})]},ue.props.id))})]})},il=Q=>({wrap:(0,Re.css)({marginBottom:"20px"}),item:(0,Re.css)({borderLeft:`4px solid ${Q.colors.border.strong}`,paddingLeft:"10px"})}),_r={id:k.F.spatial,editor:qa,transformation:Hr,name:Hr.name,description:Hr.description,state:fe.pn.alpha,categories:new Set([o.m.PerformSpatialOperations]),help:ne(k.F.spatial).helperDocs};var Dr=e(67555);const dr={id:k.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:Q=>{for(const Y of Q)if((0,Dr.aH)(Y))return $s.M.Applicable;return $s.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:Q=>Y=>Y.pipe((0,wn.T)(se=>Gi(Q,se)))};function Gi(Q,Y){const se={},ue={},ye=[];let Ce=Eo(Y);for(const Ue of Object.keys(Ce)){const _e=Y.filter(rt=>rt.refId===Ue);se[Ue]={},ue[Ue]={};const He=[];_e.forEach(rt=>{rt.fields.forEach(it=>{it.type===w.PU.number&&it.labels&&Object.keys(it.labels).forEach(xt=>{He.includes(xt)||(ue[Ue][xt]=Cr(xt,w.PU.string),He.push(xt))})})});for(let rt=0;rt<_e.length;rt++){const it=_e[rt];let xt=null,Mt=Q[Ue]?.timeField;if(Mt&&Mt.length>0?xt=it.fields.find(Dt=>Dt.name===Mt):xt=it.fields.find(Dt=>(0,Dr.hF)(Dt)),!(0,Dr.aH)(it)){ye.push(it);continue}for(const Dt of it.fields){if(Dt.type!==w.PU.number)continue;const Tt=Q[Ue]?.stat??ze.gy.lastNotNull,wt=(0,ze.Nw)({field:Dt,reducers:[Tt]})[Tt]??null,sn=new ho.k;xt!==void 0&&(sn.addField(xt),sn.addField(Dt),se[Ue][`Trend #${Ue}`]===void 0&&(se[Ue][`Trend #${Ue}`]=Cr(`Trend #${Ue}`,w.PU.frame)),se[Ue][`Trend #${Ue}`].values.push({...sn,value:wt,length:Dt.values.length})),He.forEach(Rn=>{ue[Ue][Rn].values.push(Dt.labels?.[Rn]??"")})}}}for(const Ue of Object.keys(Ce)){const _e={},He=new ho.k;He.refId=Ue;const rt=ue[Ue];if(rt!==void 0)for(const[xt,Mt]of Object.entries(rt))_e[xt]===void 0&&(_e[xt]=Mt);for(const xt of Object.values(_e))He.addField(xt);const it=se[Ue];for(const xt of Object.values(it))He.addField(xt);He.fields.length>0&&ye.push(He)}return ye}function Cr(Q,Y){return{name:Q,type:Y,config:{},values:[]}}function Eo(Q){let Y={};for(const se of Q)se.refId!==void 0&&(Y[se.refId]===void 0?Y[se.refId]=1:Y[se.refId]++);return Y}function Po({input:Q,options:Y,onChange:se}){const ue=Eo(Q),ye=(0,s.useCallback)((_e,He)=>{const rt=He?.value!==void 0?He.value:"";se({...Y,[_e]:{...Y[_e],timeField:rt}})},[se,Y]),Ce=(0,s.useCallback)((_e,He)=>{const rt=He[0];rt&&(0,ze.Em)(rt)&&se({...Y,[_e]:{...Y[_e],stat:rt}})},[se,Y]);let Ue=[];for(const _e of Object.keys(ue)){const He={},rt=[];for(const it of Q)if(it.refId===_e)for(const xt of it.fields)(0,Dr.hF)(xt)&&(He[xt.name]=xt);for(const it of Object.values(He)){const{name:xt}=it;rt.push({label:xt,value:xt})}Ue.push((0,T.jsxs)(le.C,{children:[(0,T.jsx)(J.I,{children:(0,T.jsx)(Xe.c,{children:`Trend #${_e}`})}),(0,T.jsx)(J.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used.",children:(0,T.jsx)(he.l6,{onChange:ye.bind(null,_e),options:rt,value:Y[_e]?.timeField,isClearable:!0})}),(0,T.jsx)(J.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series.",children:(0,T.jsx)(st.S,{stats:[Y[_e]?.stat??ze.gy.lastNotNull],onChange:Ce.bind(null,_e),filterOptions:it=>it.id!==ze.gy.allValues&&it.id!==ze.gy.uniqueValues})})]},_e))}return(0,T.jsx)(T.Fragment,{children:Ue})}const Fa={id:dr.id,editor:Po,transformation:dr,name:dr.name,description:dr.description,state:fe.pn.beta,help:ne(dr.id).helperDocs},Gr=()=>[Ei,As,Di,Da,ie,xi,gi,Ci,ms,dn,So,Sn,ro,Io,ui,ka,Lt,Hi,vs,_r,Wi,Ri,tt,Ga,Oo,co,wi,...V.$.featureToggles.formatString?[sa]:[],...V.$.featureToggles.regressionTransformation?[_i]:[],...V.$.featureToggles.groupToNestedTableTransformation?[Ls]:[],Ma,Fa,Kr];var ai=e(34242),Js=e(1503),ri=e(35254),Ja=e(71468),qs=e(54148),_a=e(56276),Do=e(10586),ur=e(31906),oi=e(2041),Qi=e(49816),Ae=e(65268),pe=e(75606),We=e(8392),et=e(54122),At=e(10011),Nt=e(14485);function _t({navId:Q,header:Y}){const{node:se}=(0,At.C)(Q),ue=(0,at.of)(rn),ye=se.children?.filter(Ce=>!Ce.hideFromTabs);return(0,T.jsx)(et.Y,{navId:se.id,children:(0,T.jsx)(et.Y.Contents,{children:(0,T.jsxs)("div",{className:ue.content,children:[Y,ye&&ye.length>0&&(0,T.jsx)("section",{className:ue.grid,children:ye?.map(Ce=>(0,T.jsx)(Nt.I,{description:Ce.subTitle,text:Ce.text,url:Ce.url??""},Ce.id))})]})})})}const rn=Q=>({content:(0,Re.css)({display:"flex",flexDirection:"column",gap:Q.spacing(2)}),grid:(0,Re.css)({display:"grid",gap:Q.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:Q.spacing(2,0)})});var An=e(57017),en=e(61351),Nn=e(49785),as=e(32864),os=e(87638),Bn=e(11817),Dn=e(61491),ys=e(8476),is=e(6736),Us=e(14123);const Qs=({ldapConnectionInfo:Q})=>{const Y=(0,s.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:ue=>ue.cell.value?(0,T.jsx)(Rs.B,{justifyContent:"end",children:(0,T.jsx)(is.m,{content:"Connection is available",children:(0,T.jsx)(vt.I,{name:"check"})})}):(0,T.jsx)(Rs.B,{justifyContent:"end",children:(0,T.jsx)(is.m,{content:"Connection is not available",children:(0,T.jsx)(vt.I,{name:"exclamation-triangle"})})})}],[]),se=(0,s.useMemo)(()=>Q,[Q]);return(0,T.jsx)("section",{children:(0,T.jsxs)(Rs.B,{direction:"column",gap:2,children:[(0,T.jsx)(Ua.E,{color:"primary",element:"h3",children:(0,T.jsx)(Bn.x6,{i18nKey:"admin.ldap-status.title",children:"LDAP Connection"})}),(0,T.jsx)(Us.j,{data:se,columns:Y,getRowId:ue=>ue.host+ue.port}),(0,T.jsx)(ga,{ldapConnectionInfo:Q})]})})},ga=({ldapConnectionInfo:Q})=>{if(!Q.some(ye=>ye.error))return null;const se=[];Q.forEach(ye=>{ye.error&&se.push(ye)});const ue=se.map((ye,Ce)=>(0,T.jsxs)("div",{children:[(0,T.jsxs)("span",{style:{fontWeight:500},children:[`${ye.host}:${ye.port}`,(0,T.jsx)("br",{})]}),(0,T.jsx)("span",{children:ye.error}),Ce!==se.length-1&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("br",{}),(0,T.jsx)("br",{})]})]},Ce));return(0,T.jsx)(xa.F,{title:"Connection error",severity:Dn.AppNotificationSeverity.Error,children:ue})};var xs=e(88090);const aa="dddd YYYY-MM-DD HH:mm zz",rr=({ldapSyncInfo:Q})=>{const Y=(0,xs.LE)(Q.nextSync,{format:aa}),se=[{id:"syncAttribute"},{id:"syncValue"}],ue=[{syncAttribute:"Active synchronization",syncValue:Q.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:Q.schedule},{syncAttribute:"Next synchronization",syncValue:Y}];return(0,T.jsxs)("section",{children:[(0,T.jsx)(Ua.E,{element:"h3",children:(0,T.jsx)(Bn.x6,{i18nKey:"admin.ldap-sync-info.title",children:"LDAP Synchronization"})}),(0,T.jsx)(Us.j,{data:ue,columns:se,getRowId:ye=>ye.syncAttribute})]})},ua=({groups:Q})=>{const Y=(0,s.useMemo)(()=>Q,[Q]),se=(0,s.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:ue=>ue.value&&ue.row.original.orgRole?ue.value:""},{id:"orgRole",header:"Role",cell:ue=>ue.value||(0,T.jsx)(T.Fragment,{children:(0,T.jsxs)(Bn.x6,{i18nKey:"admin.ldap-user-groups.no-org-found",children:["No match"," ",(0,T.jsx)(is.m,{content:"No matching organizations found",children:(0,T.jsx)(vt.I,{name:"info-circle"})})]})})}],[]);return(0,T.jsx)(Us.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:se,data:Y,getRowId:ue=>ue.orgId+ue.orgRole+ue.groupDN})},Ca=({info:Q})=>{const Y=(0,s.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),se=(0,s.useMemo)(()=>[{userInfo:"First name",ldapValue:Q.name.ldapValue,cfgAttrValue:Q.name.cfgAttrValue},{userInfo:"Surname",ldapValue:Q.surname.ldapValue,cfgAttrValue:Q.surname.cfgAttrValue},{userInfo:"Username",ldapValue:Q.login.ldapValue,cfgAttrValue:Q.login.cfgAttrValue},{userInfo:"Email",ldapValue:Q.email.ldapValue,cfgAttrValue:Q.email.cfgAttrValue}],[Q]);return(0,T.jsx)(Us.j,{columns:Y,data:se,getRowId:ue=>ue.userInfo})},la=({permissions:Q})=>{const Y=(0,s.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),se=(0,s.useMemo)(()=>[{permission:"Grafana admin",value:Q.isGrafanaAdmin?(0,T.jsxs)(Bn.x6,{i18nKey:"admin.ldap-permissions.admin",children:[(0,T.jsx)(vt.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:Q.isDisabled?(0,T.jsxs)(Bn.x6,{i18nKey:"admin.ldap-permissions.inactive",children:[(0,T.jsx)(vt.I,{name:"times"})," Inactive"]}):(0,T.jsxs)(Bn.x6,{i18nKey:"admin.ldap-permissions.active",children:[(0,T.jsx)(vt.I,{name:"check"})," Active"]})}],[Q]);return(0,T.jsx)(Us.j,{data:se,columns:Y,getRowId:ue=>ue.permission})},br=({teams:Q})=>{const Y=(0,s.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:se}}})=>(0,T.jsx)(T.Fragment,{children:se||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:se,orgName:ue}}})=>se&&ue?se:""}],[]);return(0,T.jsx)(Us.j,{data:Q,columns:Y,getRowId:se=>se.teamName})},ll=({ldapUser:Q})=>(0,T.jsxs)(Rs.B,{direction:"column",gap:4,children:[(0,T.jsx)(Ca,{info:Q.info}),(0,T.jsx)(la,{permissions:Q.permissions}),Q.roles&&Q.roles.length>0&&(0,T.jsx)(ua,{groups:Q.roles}),Q.teams&&Q.teams.length>0?(0,T.jsx)(br,{teams:Q.teams}):(0,T.jsx)(te.a,{children:(0,T.jsx)(Ua.E,{children:(0,T.jsx)(Bn.x6,{i18nKey:"admin.ldap-user-info.no-team",children:"No teams found via LDAP"})})})]}),Dl={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},Cl=({clearUserMappingInfo:Q,queryParams:Y,loadLdapState:se,loadLdapSyncStatus:ue,loadUserMapping:ye,clearUserError:Ce,ldapUser:Ue,userError:_e,ldapError:He,ldapSyncInfo:rt,ldapConnectionInfo:it})=>{const[xt,Mt]=(0,s.useState)(!0),{register:Dt,handleSubmit:Tt}=(0,Nn.mN)(),wt=(0,s.useCallback)(async rs=>ye(rs),[ye]);(0,s.useEffect)(()=>{const rs=async()=>Promise.all([se(),ue()]);async function kn(){await Q(),await rs(),Y.username&&await wt(Y.username),Mt(!1)}kn()},[Q,wt,se,ue,Y]);const sn=({username:rs})=>{rs&&wt(rs)},Rn=()=>{Ce()},$n=os.TP.hasPermission(Dn.AccessControlAction.LDAPUsersRead);return(0,T.jsx)(et.Y,{navId:"authentication",pageNav:Dl,children:(0,T.jsx)(et.Y.Contents,{isLoading:xt,children:(0,T.jsxs)(Rs.B,{direction:"column",gap:4,children:[He&&He.title&&(0,T.jsx)(xa.F,{title:He.title,severity:Dn.AppNotificationSeverity.Error,children:He.body}),(0,T.jsx)(Qs,{ldapConnectionInfo:it}),(0,as.a)("ldapsync")&&rt&&(0,T.jsx)(rr,{ldapSyncInfo:rt}),$n&&(0,T.jsxs)("section",{children:[(0,T.jsx)("h3",{children:(0,T.jsx)(Bn.x6,{i18nKey:"admin.ldap.test-mapping-heading",children:"Test user mapping"})}),(0,T.jsx)("form",{onSubmit:Tt(sn),children:(0,T.jsx)(Jn.D,{label:"Username",children:(0,T.jsx)(lt.p,{...Dt("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:Y.username,addonAfter:(0,T.jsx)(ae.$n,{variant:"primary",type:"submit",children:(0,T.jsx)(Bn.x6,{i18nKey:"admin.ldap.test-mapping-run-button",children:"Run"})})})})}),_e&&_e.title&&(0,T.jsx)(xa.F,{title:_e.title,severity:Dn.AppNotificationSeverity.Error,onRemove:Rn,children:_e.body}),Ue&&(0,T.jsx)(ll,{ldapUser:Ue})]})]})})})},bl=Q=>({ldapConnectionInfo:Q.ldap.connectionInfo,ldapUser:Q.ldap.user,ldapSyncInfo:Q.ldap.syncInfo,userError:Q.ldap.userError,ldapError:Q.ldap.ldapError}),Tl={loadLdapState:ys.JI,loadLdapSyncStatus:ys.pm,loadUserMapping:ys.Kg,clearUserError:ys.DX,clearUserMappingInfo:ys.Jc},Ml=(0,Ja.connect)(bl,Tl)(Cl),qe=Q=>(0,s.lazy)(Q);var mt=e(91495),bt=e(60088),Ht=e(82945),kt=e(90666),jt=e(96621);function fn(Q=K.$W){return[{path:"/alerting",component:ln(()=>e.e(3236).then(e.bind(e,44634)))},{path:"/alerting/home",component:ln(()=>e.e(3236).then(e.bind(e,44634)))},{path:"/alerting/list",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleRead,Dn.AccessControlAction.AlertingRuleExternalRead]),component:ln(()=>Promise.all([e.e(1085),e.e(6814),e.e(3511)]).then(e.bind(e,68093)))},{path:"/alerting/routes",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsRead,Dn.AccessControlAction.AlertingNotificationsExternalRead,...Ht.rw,...Ht.nv,...bt.xK,...bt.Zr]),component:ln(()=>Promise.all([e.e(1085),e.e(1909)]).then(e.bind(e,93112)))},{path:"/alerting/routes/mute-timing/new",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsWrite,Dn.AccessControlAction.AlertingNotificationsExternalWrite,...bt.Zr]),component:ln(()=>Promise.all([e.e(8835),e.e(8302)]).then(e.bind(e,19083)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsWrite,Dn.AccessControlAction.AlertingNotificationsExternalWrite,...bt.xK,...bt.Zr]),component:ln(()=>Promise.all([e.e(8835),e.e(558)]).then(e.bind(e,10119)))},{path:"/alerting/silences",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingInstanceRead,Dn.AccessControlAction.AlertingInstancesExternalRead,Dn.AccessControlAction.AlertingSilenceRead]),component:ln(()=>e.e(1668).then(e.bind(e,88176)))},{path:"/alerting/silence/new",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingInstanceCreate,Dn.AccessControlAction.AlertingInstancesExternalWrite,Dn.AccessControlAction.AlertingSilenceCreate,Dn.AccessControlAction.AlertingSilenceUpdate]),component:ln(()=>e.e(1649).then(e.bind(e,78525)))},{path:"/alerting/silence/:id/edit",component:ln(()=>Promise.resolve().then(e.bind(e,97609)))},{path:"/alerting/notifications",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsRead,Dn.AccessControlAction.AlertingNotificationsExternalRead,...mt.w6,...kt.X]),component:ln(()=>Promise.all([e.e(1085),e.e(4312)]).then(e.bind(e,6353)))},{path:"/alerting/notifications/receivers/new",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsRead,Dn.AccessControlAction.AlertingNotificationsExternalRead,...mt.w6]),component:ln(()=>Promise.all([e.e(1085),e.e(4312),e.e(3461),e.e(8979),e.e(1595),e.e(1345),e.e(3167)]).then(e.bind(e,23495)))},{path:"/alerting/notifications/receivers/:name/edit",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsWrite,Dn.AccessControlAction.AlertingNotificationsExternalWrite,Dn.AccessControlAction.AlertingNotificationsRead,Dn.AccessControlAction.AlertingNotificationsExternalRead,...mt.w6]),component:ln(()=>Promise.all([e.e(1085),e.e(4312),e.e(3461),e.e(8979),e.e(1595),e.e(1345),e.e(6877)]).then(e.bind(e,43935)))},{path:"/alerting/notifications/templates/*",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsRead,Dn.AccessControlAction.AlertingNotificationsExternalRead,...kt.X]),component:ln(()=>Promise.all([e.e(1085),e.e(4312),e.e(3461),e.e(8979),e.e(9224)]).then(e.bind(e,51866)))},{path:"/alerting/notifications/global-config",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingNotificationsWrite,Dn.AccessControlAction.AlertingNotificationsExternalWrite]),component:ln(()=>Promise.all([e.e(1085),e.e(4312),e.e(3461),e.e(8979),e.e(1595),e.e(8504)]).then(e.bind(e,6405)))},{path:"/alerting/groups/",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingInstanceRead,Dn.AccessControlAction.AlertingInstancesExternalRead]),component:ln(()=>e.e(8427).then(e.bind(e,25605)))},{path:"/alerting/history/",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleRead]),component:ln(()=>Promise.all([e.e(825),e.e(9069),e.e(44)]).then(e.bind(e,68184)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleCreate,Dn.AccessControlAction.AlertingRuleExternalWrite]),component:ln(()=>Promise.all([e.e(1085),e.e(3461),e.e(6814),e.e(4009)]).then(e.bind(e,3936)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleUpdate,Dn.AccessControlAction.AlertingRuleExternalWrite]),component:ln(()=>Promise.all([e.e(1085),e.e(3461),e.e(6814),e.e(4009)]).then(e.bind(e,3936)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleRead]),component:ln(()=>Promise.all([e.e(1085),e.e(3461),e.e(6814),e.e(4009)]).then(e.bind(e,30179)))},{path:"/alerting/export-new-rule",pageClass:"page-alerting",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleRead]),component:ln(()=>Promise.all([e.e(1085),e.e(3461),e.e(6814),e.e(4009)]).then(e.bind(e,38625)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleRead,Dn.AccessControlAction.AlertingRuleExternalRead]),component:ln(()=>Promise.resolve().then(e.bind(e,48675)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,jt.C0)([Dn.AccessControlAction.AlertingRuleRead,Dn.AccessControlAction.AlertingRuleExternalRead]),component:ln(()=>e.e(5516).then(e.bind(e,32606)))},{path:"/alerting/admin",roles:()=>["Admin"],component:ln(()=>e.e(9438).then(e.bind(e,20605)))}]}function ln(Q){const Y=()=>e.e(9029).then(e.bind(e,867));return qe(K.$W.unifiedAlertingEnabled?Q:Y)}var Mn=e(85651),Pn=e(61674);const Fn=Q=>({alertContent:(0,Re.css)({display:"flex",flexDirection:"row",padding:0,justifyContent:"space-between",alignItems:"center"}),alertParagraph:(0,Re.css)({margin:Q.spacing(0,1,0,0),lineHeight:Q.spacing(Q.components.height.sm)})});function Xn(){const Q=(0,at.of)(Fn),Y=os.TP.hasPermission(Dn.AccessControlAction.DataSourcesCreate)||os.TP.hasPermission(Dn.AccessControlAction.DataSourcesWrite),[se,ue]=(0,s.useState)(Y);return se?(0,T.jsx)(xa.F,{severity:"info",title:"",onRemove:()=>ue(!1),children:(0,T.jsxs)("div",{className:Q.alertContent,children:[(0,T.jsx)("p",{className:Q.alertParagraph,children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."}),(0,T.jsx)(ae.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:Pn.b.DataSources,fill:"text",children:"Go to connections"})]})}):(0,T.jsx)(T.Fragment,{})}function Kn(){return[{path:`/${Pn.q}/*`,component:qe(()=>Promise.all([e.e(5906),e.e(3202),e.e(9467),e.e(2154)]).then(e.bind(e,2983)))}]}var Zn=e(84641),Ds=e(84558),Ts=e(88214),gs=(Q=>(Q.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",Q.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",Q.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",Q.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",Q))(gs||{});function Fs(Q,Y){(0,_a.rR)(Q,{...Y})}var Ss=e(35626),js=e(27889),Es=e(19165),Ms=e(35874),ds=e(5240),Vn=e(94736),Os=e(8276);function ns(){const[Q,{data:Y,isLoading:se}]=ds.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:ue,isLoadingDsFeatures:ye}=(0,Os.O3)(Ts.hY),Ce=ue?.rulerConfig;return(0,s.useEffect)(()=>{Ce&&Q({rulerConfig:Ce})},[Ce,Q]),{isDone:(Y?Object.entries(Y).flatMap(([He,rt])=>rt.flatMap(it=>it.rules)):[]).length>0,isLoading:se||ye}}function Bs(Q){return Q.some(Y=>Y.grafana_managed_receiver_configs?.some(se=>se.type===Vn.J4.OnCall))}const Ns="<example@email.com>";function Ws(Q,Y){const se=Y.find(ue=>ue.name===Q);return se?se.grafana_managed_receiver_configs?.some(ue=>ue.type==="email"?ue.settings?.addresses!==Ns:!0):!1}var Is=e(79120);const Gs=Q=>`/api/plugins/${(0,Es.Wx)()}/resources${Q}`,ea=Is.H.injectEndpoints({endpoints:Q=>({getIncidentsPluginConfig:Q.query({query:()=>({url:Gs("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var ba=e(51311);function Oa(){const{installed:Q,loading:Y}=(0,ba._)((0,Es.Wx)()),{data:se,isLoading:ue}=ea.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:Q??!1,isChatOpsInstalled:se?.isChatOpsInstalled??!1,isIncidentCreated:se?.isIncidentCreated??!1,isLoading:Y||ue}}var pa=e(65333);function Ka(){const{installed:Q}=(0,ba._)((0,Es.BO)()),{data:Y}=pa.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!Q,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return Y??[]}function Qr(){const{data:Q,isLoading:Y}=pa.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:Y,onCallConfigChecks:Q??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function oa(){return Ka().map(Y=>({label:Y.display_name,value:Y.value}))}function wa(){const{onCallConfigChecks:{is_chatops_connected:Q,is_integration_chatops_connected:Y},isLoading:se}=Qr();return{is_chatops_connected:Q,is_integration_chatops_connected:Y,isLoading:se}}var La=e(10148);const ma=`/api/plugins/${La.W.Slo}/resources/v1`,ja=Is.H.injectEndpoints({endpoints:Q=>({getSlos:Q.query({query:()=>({url:`${ma}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function Ia(){const{installed:Q}=(0,ba._)(La.W.Slo),{data:Y,isLoading:se}=ja.endpoints.getSlos.useQuery(void 0,{skip:!Q,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:se,hasSlo:!!Y?.slos.length,hasSloWithAlert:!!Y?.slos?.some(ue=>ue.alerting)}}function va(){const{contactPoints:Q,isLoading:Y}=(0,Ss.Z3)(),{data:se,isLoading:ue}=(0,js.yV)({alertmanager:Ts.hY}),ye=se?.[0].receiver||"",{isDone:Ce,isLoading:Ue}=ns(),{isChatOpsInstalled:_e,isInstalled:He,isLoading:rt}=Oa(),it=oa(),{is_chatops_connected:xt,is_integration_chatops_connected:Mt,isLoading:Dt}=wa(),{hasSlo:Tt,hasSloWithAlert:wt,isLoading:sn}=Ia();return{alerting:{contactPoints:Q,defaultContactpoint:ye,isCreateAlertRuleDone:Ce},incidents:{isChatOpsInstalled:_e,isIncidentsInstalled:He},onCall:{onCallOptions:it,is_chatops_connected:xt,is_integration_chatops_connected:Mt},slo:{hasSlo:Tt,hasSloWithAlert:wt},isLoading:Y||ue||Ue||rt||Dt||sn}}function Va(){const{alerting:{contactPoints:Q,defaultContactpoint:Y,isCreateAlertRuleDone:se},incidents:{isChatOpsInstalled:ue,isIncidentsInstalled:ye},onCall:{onCallOptions:Ce,is_chatops_connected:Ue,is_integration_chatops_connected:_e},slo:{hasSlo:He,hasSloWithAlert:rt},isLoading:it}=va();function xt(sn,Rn){const $n=(0,Ms.G)(`${Rn} + ${sn}`,{returnTo:location.pathname+location.search});h.Ny.push($n)}function Mt(){let sn=[{title:"Update default contact point",description:"Update the default contact point to a method other than the example email address.",button:{type:"openLink",urlLink:{url:"/alerting/notifications",queryParams:{search:Y,alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:Ws(Y,Q)}];return(0,Es.ZP)()||(sn=[...sn,{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:Bs(Q)}]),sn=[...sn,{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:se},{title:"Create SLO",description:"Create SLOs to monitor your service.",button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:"Create",urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:He},{title:"Enable SLO alerting",description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:"Enable",urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:rt}],sn}const Dt={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:Mt()},{title:"Respond",description:(0,Es.ZP)()?"Configure IRM":"Configure OnCall and Incident",steps:(0,Es.ZP)()?[{title:"Connect alerting to IRM",description:"Create an IRM integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:Bs(Q)},{title:"Connect IRM to your Slack workspace",description:"Receive alerts and oncall notifications, or automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.Wx)()}/integrations/apps/grate.irm.slack`},label:"Connect",urlLinkOnDone:{url:`/a/${(0,Es.Wx)()}/integrations`}},done:ue},{title:"Add Slack notifications to IRM integrations",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.BO)()}/integrations/`},label:"Add",urlLinkOnDone:{url:`/a/${(0,Es.BO)()}/integrations/`},labelOnDone:"View"},done:_e}]:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.Wx)()}/walkthrough/generate-key`},label:"Initialize",urlLinkOnDone:{url:`/a/${(0,Es.Wx)()}`},labelOnDone:"View"},done:ye},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.BO)()}/settings`,queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:`/a/${(0,Es.BO)()}/settings`,queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:Ue},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.Wx)()}/integrations/grate.slack`},label:"Connect",urlLinkOnDone:{url:`/a/${(0,Es.Wx)()}/integrations`}},done:ue},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.BO)()}/integrations/`},label:"Add",urlLinkOnDone:{url:`/a/${(0,Es.BO)()}/integrations/`},labelOnDone:"View"},done:_e}]},{title:"Test your configuration",description:"",steps:[{title:(0,Es.ZP)()?"Send test alert":"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:Ce,onClickOption:sn=>xt(sn,`/a/${(0,Es.BO)()}/integrations/`),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:`/a/${(0,Es.Wx)()}`,queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:Tt,totalStepsToDo:wt}=Dt.sections.reduce((sn,Rn)=>{const $n=Rn.steps.filter(kn=>kn.done).length,rs=Rn.steps.reduce((kn,ia)=>ia.done!==void 0?kn+1:kn,0);return{stepsDone:sn.stepsDone+$n,totalStepsToDo:sn.totalStepsToDo+rs}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Dt,stepsDone:Tt,totalStepsToDo:wt,isLoading:it}}const Tr=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:Q},essentialsConfigurationData:{stepsDone:Y,totalStepsToDo:se}})=>(0,s.useMemo)(()=>{function ue(){const ye=Q?"You have connected a datasource.":"Connect at least one data source to start receiving data",Ce=Q?"View":"Connect";return{id:Il.CONNECT_DATASOURCE,title:"Connect data source",description:ye,actionButtonTitle:Ce,isDone:Q}}return[ue(),{id:Il.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:Y===se?"View":"Configure",stepsDone:Y,totalStepsToDo:se}]},[Q,Y,se]);var Xa=e(81876);function kr({stepsDone:Q,totalStepsToDo:Y}){const se=(0,at.of)(Ps);return Y===0?null:(0,T.jsx)("div",{className:se.containerStyles,role:"progressbar","aria-valuenow":Q,"aria-valuemax":Y,children:(0,T.jsx)("div",{className:se.fillerStyles(Q/Y*100)})})}function hr({stepsDone:Q,totalStepsToDo:Y}){return(0,T.jsxs)("span",{children:[(0,T.jsx)(Ua.E,{color:"success",children:Q})," of ",Y]})}function Ps(Q){return{containerStyles:(0,Re.css)({height:Q.spacing(2),borderRadius:Q.shape.radius.pill,backgroundColor:Q.colors.border.weak,flex:"auto"}),fillerStyles:Y=>(0,Re.css)({height:"100%",width:`${Y}%`,backgroundColor:Q.colors.success.main,borderRadius:Q.shape.radius.pill,textAlign:"right"})}}function ra({config:Q,handleActionClick:Y,isLoading:se=!1}){const ue=(0,at.of)(ca);return(0,T.jsx)(Rs.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,T.jsxs)("div",{className:ue.cardContent,children:[(0,T.jsxs)(Rs.B,{direction:"column",gap:1,children:[(0,T.jsxs)(Rs.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,T.jsx)("div",{className:"fs-unmask",children:(0,T.jsxs)(Rs.B,{direction:"row",gap:1,alignItems:"center",children:[Q.title,Q.titleIcon&&(0,T.jsx)(vt.I,{name:Q.titleIcon}),Q.isDone&&!se&&(0,T.jsx)(vt.I,{name:"check-circle",color:"green",size:"lg"})]})}),Q.stepsDone&&Q.totalStepsToDo&&!se&&(0,T.jsx)("div",{className:"fs-unmask",children:(0,T.jsxs)(Rs.B,{direction:"row",gap:.5,children:[(0,T.jsx)(hr,{stepsDone:Q.stepsDone,totalStepsToDo:Q.totalStepsToDo}),(0,T.jsx)(Bn.x6,{i18nKey:"configuration-tracker.config-card.complete",children:"complete"})]})})]}),(0,T.jsxs)(Rs.B,{direction:"column",children:[se?(0,T.jsx)(Xa._,{text:"Loading configuration...."}):Q.description,!se&&Q.stepsDone&&Q.totalStepsToDo&&(0,T.jsx)(kr,{stepsDone:Q.stepsDone,totalStepsToDo:Q.totalStepsToDo})]})]}),(0,T.jsx)(Rs.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,T.jsx)(ae.$n,{variant:"secondary",onClick:()=>Y(Q.id,Q.isDone),className:"fs-unmask",children:Q.actionButtonTitle})})]})})}const ca=Q=>({cardTitle:(0,Re.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,Re.css)({background:Q.colors.background.secondary,padding:Q.spacing(2),borderRadius:Q.shape.radius.default,height:"100%",gap:Q.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var Ks=e(58528),$a=e(60232),Yr=e(19224);function Jr({onClose:Q,essentialsConfig:Y,stepsDone:se,totalStepsToDo:ue}){return(0,T.jsx)(Ks._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:Q,children:(0,T.jsx)(Sr,{essentialContent:Y,stepsDone:se,totalStepsToDo:ue})})}function Sr({essentialContent:Q,stepsDone:Y,totalStepsToDo:se}){return(0,T.jsxs)(Rs.B,{direction:"column",gap:1,children:[(0,T.jsx)(Bd,{stepsDone:Y,totalStepsToDo:se}),Q.sections.map(ue=>(0,T.jsx)(cl,{section:ue},ue.title))]})}function cl({section:Q}){const Y=(0,at.of)(Ud);return(0,T.jsxs)("div",{className:Y.wrapper,children:[(0,T.jsx)(Ua.E,{element:"h4",children:(0,T.jsx)("span",{className:"fs-unmask",children:Q.title})}),(0,T.jsx)(Ua.E,{color:"secondary",children:(0,T.jsx)("span",{className:"fs-unmask",children:Q.description})}),(0,T.jsx)(Rs.B,{direction:"column",gap:2,children:Q.steps.map((se,ue)=>(0,T.jsx)(Rd,{step:se},ue))})]})}function Ol({done:Q}){return Q?(0,T.jsx)(vt.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,T.jsx)(vt.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function Rd({step:Q}){return(0,T.jsxs)(Rs.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,T.jsxs)(Rs.B,{direction:"row",alignItems:"center",children:[Q.done!==void 0&&(0,T.jsx)(Ol,{done:Q.done}),(0,T.jsx)(Ua.E,{variant:"body",children:(0,T.jsx)("span",{className:"fs-unmask",children:Q.title})}),(0,T.jsx)(is.m,{content:Q.description,placement:"right",children:(0,T.jsx)(vt.I,{name:"question-circle"})})]}),(0,T.jsx)(jd,{...Q.button,done:Q.done,"data-testid":"step-button"})]})}function Ld(Q){const{urlLink:Y,label:se,urlLinkOnDone:ue,labelOnDone:ye,done:Ce}=Q,Ue=Y?.url?(0,Ms.G)(Y.url,{returnTo:location.pathname+location.search,...Y.queryParams}):"",_e=ue?.url?(0,Ms.G)(ue.url,{returnTo:location.pathname+location.search,...ue.queryParams}):"",He=Ce?_e:Ue;return(0,T.jsx)(ae.z9,{href:He,variant:"secondary",className:"fs-unmask",children:Ce?ye??se:se})}function jd({type:Q,urlLink:Y,urlLinkOnDone:se,label:ue,labelOnDone:ye,options:Ce,onClickOption:Ue,done:_e,stepNotAvailableText:He}){switch(Q){case"openLink":return(0,T.jsx)(Ld,{urlLink:Y,label:ue,urlLinkOnDone:se,labelOnDone:ye,done:_e});case"dropDown":return Ce?.length?(0,T.jsx)($a.m,{overlay:(0,T.jsx)(Yr.W,{className:"fs-unmask",children:Ce?.map(rt=>(0,T.jsx)(Yr.W.Item,{label:rt.label,className:"fs-unmask",onClick:()=>{Ue?.(rt.value)}},rt.value))}),children:(0,T.jsxs)(ae.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[ue,(0,T.jsx)(vt.I,{name:"angle-down"})]})}):(0,T.jsxs)(Ua.E,{children:[He??"No options available"," "]})}}function Bd({stepsDone:Q,totalStepsToDo:Y}){return(0,T.jsxs)(Rs.B,{direction:"row",gap:1,alignItems:"center",children:["Your progress",(0,T.jsx)(kr,{stepsDone:Q,totalStepsToDo:Y}),(0,T.jsx)(hr,{stepsDone:Q,totalStepsToDo:Y})]})}const Ud=Q=>({wrapper:(0,Re.css)({margin:Q.spacing(2,0),padding:Q.spacing(2),border:`1px solid ${Q.colors.border.medium}`,borderRadius:Q.shape.radius.default,display:"flex",flexDirection:"column",gap:Q.spacing(2)})});var Il=(Q=>(Q[Q.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",Q[Q.ESSENTIALS=1]="ESSENTIALS",Q))(Il||{});function Nd(){return{dataSourceCompatibleWithAlerting:!!(0,Ts.k5)()}}function Wd(){const Q=(0,at.of)(Fd),Y=(0,qs.Zp)(),se=Nd(),ue=Va(),ye=Tr({dataSourceConfigurationData:se,essentialsConfigurationData:ue});(0,s.useEffect)(()=>{Fs(gs.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:se.dataSourceCompatibleWithAlerting})},[se.dataSourceCompatibleWithAlerting]);const[Ce,Ue]=(0,Ds.l)(),_e=Ce.get("essentials")==="open",He=(it,xt)=>{switch(Fs(gs.ClickDataSources,{essentialStepsDone:ue.stepsDone,essentialStepsToDo:ue.totalStepsToDo,dataSourceCompatibleWithAlerting:se.dataSourceCompatibleWithAlerting}),it){case 0:Y(xt?Zn.I.List:Zn.I.New);break;case 1:Ue({essentials:"open"}),Fs(gs.OpenEssentials,{essentialStepsDone:ue.stepsDone,essentialStepsToDo:ue.totalStepsToDo,dataSourceCompatibleWithAlerting:se.dataSourceCompatibleWithAlerting});break;default:return}};function rt(){Ue({essentials:void 0}),Fs(gs.CloseEssentials,{essentialStepsDone:ue.stepsDone,essentialStepsToDo:ue.totalStepsToDo,dataSourceCompatibleWithAlerting:se.dataSourceCompatibleWithAlerting})}return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ua.E,{element:"h4",variant:"h4",children:"Configure"}),(0,T.jsxs)("section",{className:Q.container,children:[ye.map(it=>(0,T.jsx)(ra,{config:it,handleActionClick:He,isLoading:ue.isLoading},it.id)),_e&&(0,T.jsx)(Jr,{onClose:rt,essentialsConfig:ue.essentialContent,stepsDone:ue.stepsDone,totalStepsToDo:ue.totalStepsToDo})]}),(0,T.jsx)(Ua.E,{element:"h4",variant:"h4",children:"IRM apps"})]})}const Fd=Q=>({container:(0,Re.css)({marginBottom:0,display:"grid",gap:Q.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var Al=e(27207);const Kd=[{path:"/plugins",navId:"plugins",roles:Rl([Dn.AccessControlAction.PluginsInstall,Dn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Al.vk.Home,component:qe(()=>e.e(4519).then(e.bind(e,18920)))},{path:"/plugins/browse",navId:"plugins",roles:Rl([Dn.AccessControlAction.PluginsInstall,Dn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Al.vk.Browse,component:qe(()=>e.e(4519).then(e.bind(e,18920)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:Rl([Dn.AccessControlAction.PluginsInstall,Dn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Al.vk.Details,component:qe(()=>Promise.all([e.e(5906),e.e(3202),e.e(9467),e.e(7891)]).then(e.bind(e,16586)))}];function Rl(Q,Y){return()=>Q.some(se=>os.TP.hasPermission(se))?[]:Y}function wd(){return Kd}var Vd=e(3970);const nc=[{path:"/profile",component:qe(()=>e.e(2472).then(e.bind(e,37474)))},{path:"/profile/password",component:qe(()=>e.e(6686).then(e.bind(e,6686)))},{path:"/profile/select-org",component:qe(()=>e.e(7430).then(e.bind(e,90607)))},{path:"/profile/notifications",component:qe(()=>e.e(4140).then(e.bind(e,748)))}];function $d(Q=K.$W){return Q.profileEnabled?nc:(0,z.uniq)(nc.map(se=>se.path)).map(se=>({path:se,component:qe(()=>e.e(5173).then(e.bind(e,1114)))}))}const zd=()=>K.$W.publicDashboardsEnabled?[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:Dn.DashboardRoutes.Public,component:qe(()=>e.e(5761).then(e.bind(e,65425)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:Dn.DashboardRoutes.Public,chromeless:!0,component:qe(()=>Promise.all([e.e(1115),e.e(446),e.e(7197)]).then(e.bind(e,90821)))}]:[],Hd=K.Ay.buildInfo.env==="development",_d=[];function Gd(){return[...(0,Vd.X)(),{path:"/",pageClass:"page-dashboard",routeName:Dn.DashboardRoutes.Home,component:qe(()=>Promise.all([e.e(1115),e.e(7241),e.e(446),e.e(210),e.e(9136)]).then(e.bind(e,210)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:Dn.DashboardRoutes.Normal,component:qe(()=>Promise.all([e.e(1115),e.e(7241),e.e(446),e.e(210),e.e(9136)]).then(e.bind(e,210)))},{path:"/dashboard/new",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:Dn.DashboardRoutes.New,component:qe(()=>Promise.all([e.e(1115),e.e(7241),e.e(446),e.e(210),e.e(2976)]).then(e.bind(e,210)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.DashboardsCreate]),component:qe(()=>Promise.all([e.e(1115),e.e(7241),e.e(446),e.e(210),e.e(2976)]).then(e.bind(e,3824)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:Dn.DashboardRoutes.Normal,component:qe(()=>Promise.all([e.e(1115),e.e(7241),e.e(446),e.e(210),e.e(2976)]).then(e.bind(e,210)))},{path:"/dashboards/embedding-test",component:qe(()=>Promise.all([e.e(1115),e.e(7241),e.e(446),e.e(210),e.e(2976)]).then(e.bind(e,26088)))},{path:"/d-solo/:uid/:slug?",routeName:Dn.DashboardRoutes.Normal,chromeless:!0,component:qe(()=>K.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,60918)):Promise.all([e.e(1115),e.e(4492)]).then(e.bind(e,28982)))},{path:"/dashboard-solo/:type/:slug",routeName:Dn.DashboardRoutes.Normal,chromeless:!0,component:qe(()=>K.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,60918)):Promise.all([e.e(1115),e.e(4492)]).then(e.bind(e,28982)))},{path:"/dashboard/import",component:qe(()=>e.e(2550).then(e.bind(e,83029)))},{path:Zn.I.List,component:()=>(0,T.jsx)(qs.C5,{replace:!0,to:Pn.b.DataSources})},{path:Zn.I.Edit,component:Yd},{path:Zn.I.Dashboards,component:kd},{path:Zn.I.New,component:()=>(0,T.jsx)(qs.C5,{replace:!0,to:Pn.b.DataSourcesNew})},{path:"/datasources/correlations",component:qe(()=>K.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,86816)):e.e(8014).then(e.bind(e,16154)))},{path:"/dashboards",component:qe(()=>Promise.all([e.e(5906),e.e(3202),e.e(152)]).then(e.bind(e,89232)))},{path:"/dashboards/f/:uid/:slug",component:qe(()=>Promise.all([e.e(5906),e.e(3202),e.e(152)]).then(e.bind(e,89232)))},{path:"/dashboards/f/:uid",component:qe(()=>Promise.all([e.e(5906),e.e(3202),e.e(152)]).then(e.bind(e,89232)))},{path:"/explore",pageClass:"page-explore",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.DataSourcesExplore]),component:qe(()=>K.Ay.exploreEnabled?Promise.all([e.e(407),e.e(5995),e.e(3776),e.e(5085),e.e(7241),e.e(5362),e.e(8051),e.e(3141),e.e(297),e.e(9604)]).then(e.bind(e,93125)):e.e(4422).then(e.bind(e,52076)))},{path:"/drilldown",component:()=>(0,T.jsx)(_t,{navId:"drilldown"})},{path:"/apps",component:()=>(0,T.jsx)(_t,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,T.jsx)(_t,{navId:"alerts-and-incidents",header:!(0,Mn.y$)()&&(0,Mn.qc)()||(0,Mn.ES)()?(0,T.jsx)(Wd,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,T.jsx)(_t,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,T.jsx)(_t,{navId:"monitoring"})},{path:"/infrastructure",component:()=>(0,T.jsx)(_t,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,T.jsx)(_t,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,T.jsx)(_t,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,T.jsx)(_t,{navId:"cfg/plugins"})},{path:"/admin/extensions",navId:"extensions",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.PluginsInstall,Dn.AccessControlAction.PluginsWrite]),component:Hd||K.Ay.featureToggles.enableExtensionsAdminPage?qe(()=>e.e(5902).then(e.bind(e,19040))):()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/admin"})},{path:"/admin/access",component:()=>(0,T.jsx)(_t,{navId:"cfg/access"})},{path:"/org",component:qe(()=>e.e(1510).then(e.bind(e,82250)))},{path:"/org/new",component:qe(()=>e.e(7930).then(e.bind(e,80127)))},{path:"/org/users",component:()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/admin/users"})},{path:"/org/users/invite",component:qe(()=>e.e(7720).then(e.bind(e,44992)))},{path:"/org/apikeys",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.ActionAPIKeysRead]),component:qe(()=>e.e(4196).then(e.bind(e,45525)))},{path:"/org/serviceaccounts",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.ServiceAccountsRead,Dn.AccessControlAction.ServiceAccountsCreate]),component:qe(()=>Promise.all([e.e(7675),e.e(6777)]).then(e.bind(e,80877)))},{path:"/org/serviceaccounts/create",component:qe(()=>Promise.all([e.e(7675),e.e(4176)]).then(e.bind(e,94616)))},{path:"/org/serviceaccounts/:id",component:qe(()=>Promise.all([e.e(7675),e.e(6576)]).then(e.bind(e,66604)))},{path:"/org/teams",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.ActionTeamsRead,Dn.AccessControlAction.ActionTeamsCreate]),component:qe(()=>Promise.all([e.e(7675),e.e(1036)]).then(e.bind(e,83165)))},{path:"/org/teams/new",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.ActionTeamsCreate]),component:qe(()=>Promise.all([e.e(7675),e.e(5436)]).then(e.bind(e,5209)))},{path:"/org/teams/edit/:uid/:page?",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.ActionTeamsRead,Dn.AccessControlAction.ActionTeamsCreate]),component:qe(()=>Promise.all([e.e(7675),e.e(2212)]).then(e.bind(e,36605)))},{path:"/admin",component:()=>(0,T.jsx)(_t,{navId:"cfg",header:(0,T.jsx)(Xn,{})})},{path:"/admin/authentication",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.SettingsWrite]),component:K.Ay.licenseInfo.enabledFeatures?.saml||K.Ay.ldapEnabled||K.Ay.featureToggles.ssoSettingsApi?qe(()=>e.e(5592).then(e.bind(e,53094))):()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/admin"})},{path:"/admin/authentication/ldap",component:K.Ay.featureToggles.ssoSettingsLDAP?qe(()=>e.e(4582).then(e.bind(e,66242))):Ml},{path:"/admin/authentication/:provider",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.SettingsWrite]),component:K.Ay.featureToggles.ssoSettingsApi?qe(()=>e.e(5592).then(e.bind(e,95599))):()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/admin"})},{path:"/admin/settings",component:qe(()=>e.e(7659).then(e.bind(e,25658)))},{path:"/admin/upgrading",component:qe(()=>e.e(9208).then(e.bind(e,39208)))},{path:"/admin/users",component:qe(()=>Promise.all([e.e(7675),e.e(1743)]).then(e.bind(e,99002)))},{path:"/admin/users/create",component:qe(()=>e.e(9239).then(e.bind(e,3843)))},{path:"/admin/users/edit/:id",component:qe(()=>Promise.all([e.e(7675),e.e(8054)]).then(e.bind(e,21466)))},{path:"/admin/orgs",component:qe(()=>e.e(9736).then(e.bind(e,73117)))},{path:"/admin/orgs/edit/:id",component:qe(()=>Promise.all([e.e(7675),e.e(9119)]).then(e.bind(e,9333)))},{path:"/admin/featuretoggles",component:K.Ay.featureToggles.featureToggleAdminPage?qe(()=>e.e(7024).then(e.bind(e,65995))):()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/admin"})},{path:"/admin/stats",component:qe(()=>e.e(9299).then(e.bind(e,43388)))},K.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.MigrationAssistantMigrate]),component:qe(()=>e.e(3704).then(e.bind(e,68880)))},{path:"/login",component:qe(()=>Promise.all([e.e(2004),e.e(3883)]).then(e.bind(e,75466))),pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:qe(()=>e.e(8576).then(e.bind(e,97813))),chromeless:!0},{path:"/verify",component:K.Ay.verifyEmailEnabled?qe(()=>e.e(8006).then(e.bind(e,58006))):()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:K.Ay.disableUserSignUp?()=>(0,T.jsx)(qs.C5,{replace:!0,to:"/login"}):qe(()=>e.e(6964).then(e.bind(e,26964))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:qe(()=>e.e(3818).then(e.bind(e,49294)))},{path:"/user/password/reset",component:qe(()=>Promise.all([e.e(2004),e.e(641)]).then(e.bind(e,89066))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.SnapshotsRead]),component:qe(()=>e.e(6590).then(e.bind(e,15278)))},K.Ay.featureToggles.dashboardRestore&&{path:"/dashboard/recently-deleted",roles:()=>["Admin","ServerAdmin"],component:qe(()=>Promise.all([e.e(5906),e.e(3202),e.e(6299)]).then(e.bind(e,78763)))},{path:"/playlists",component:qe(()=>e.e(1168).then(e.bind(e,92703)))},{path:"/playlists/play/:uid",component:qe(()=>e.e(1374).then(e.bind(e,45071)))},{path:"/playlists/new",component:qe(()=>e.e(7616).then(e.bind(e,67921)))},{path:"/playlists/edit/:uid",component:qe(()=>e.e(7620).then(e.bind(e,58273)))},{path:"/sandbox/benchmarks",component:qe(()=>e.e(9354).then(e.bind(e,15602)))},{path:"/sandbox/test",component:qe(()=>e.e(5354).then(e.bind(e,66964)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:qe(()=>e.e(5804).then(e.bind(e,6221)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.AlertingRuleRead]),component:qe(()=>e.e(4333).then(e.bind(e,19405)))},{path:"/library-panels",component:qe(()=>e.e(8516).then(e.bind(e,9808)))},{path:"/notifications",component:qe(()=>e.e(4140).then(e.bind(e,748)))},K.Ay.featureToggles.exploreMetrics&&{path:"/explore/metrics/*",roles:()=>en.TP.evaluatePermission([Dn.AccessControlAction.DataSourcesExplore]),...K.Ay.featureToggles.exploreMetricsUseExternalAppPlugin?{component:qe(()=>e.e(8513).then(e.bind(e,58666)))}:{chromeless:!1,component:qe(()=>e.e(4785).then(e.bind(e,52402)))}},{path:"/bookmarks",component:qe(()=>e.e(7759).then(e.bind(e,57515)))},...wd(),...Qd(),...fn(),...$d(),..._d,...zd(),...Kn(),{path:"/goto/*",component:Jd},{path:"/*",component:An.H}].filter(We.zz)}function Qd(Q=K.Ay){return Q.supportBundlesEnabled?[{path:"/support-bundles",component:qe(()=>e.e(123).then(e.bind(e,72055)))},{path:"/support-bundles/create",component:qe(()=>e.e(1515).then(e.bind(e,77323)))}]:[]}function kd(){const{uid:Q=""}=(0,qs.g)();return(0,T.jsx)(qs.C5,{replace:!0,to:Pn.b.DataSourcesDashboards.replace(":uid",Q)})}function Yd(){const{uid:Q=""}=(0,qs.g)();return(0,T.jsx)(qs.C5,{replace:!0,to:Pn.b.DataSourcesEdit.replace(":uid",Q)})}function Jd(){const{pathname:Q}=(0,qs.zy)();return(0,s.useEffect)(()=>{window.location.href=Q},[Q]),null}var ta=e(83394),Xr=e(33262),Xd=e(4050),Zd=e(94888),Ll=e(16910),Zr=e(80757),qd=e(3142),eu=e(89146);async function tu(){if(V.$.angularSupportEnabled){const{AngularApp:Q}=await Promise.all([e.e(1838),e.e(9978),e.e(8888)]).then(e.bind(e,29978)),Y=new Q;Y.init(),Y.bootstrap()}else(0,Xd.w)({load:(Q,Y,se)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,Zd.j)({get:Q=>{switch(Q){case"backendSrv":return(0,Xr.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,f.AI)();case"contextSrv":return(0,Xr.l)("getLegacyAngularInjector","contextSrv"),os.TP;case"dashboardSrv":return(0,Xr.l)("getLegacyAngularInjector","getDashboardSrv"),(0,Ll.UA)();case"datasourceSrv":return(0,Xr.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,b.l)();case"linkSrv":return(0,Xr.l)("getLegacyAngularInjector","linkSrv"),(0,eu.mQ)();case"validationSrv":return(0,Xr.l)("getLegacyAngularInjector","validationSrv"),qd.P;case"timeSrv":return(0,Xr.l)("getLegacyAngularInjector","timeSrv"),(0,Zr.jG)();case"templateSrv":return(0,Xr.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,bn.w)()}throw"Angular is disabled.  Unable to expose: "+Q}})}var Mr=e(95382),nu=e(66899),su=e.n(nu),au=e(80426),sc=e(32336);function ru({error:Q,errorInfo:Y}){const se=(0,qs.zy)(),ue=Q?.name==="ChunkLoadError",ye=(0,at.of)(ou);return(0,s.useEffect)(()=>{ue&&se.search.indexOf("chunkNotFound")===-1&&(window.location.href=m.I.getUrlForPartial(se,{chunkNotFound:!0}))},[se,ue]),(0,T.jsx)(et.Y,{navId:"error",layout:au.k.Canvas,children:(0,T.jsxs)("div",{className:ye.container,children:[ue&&(0,T.jsxs)("div",{children:[(0,T.jsx)("h2",{children:(0,T.jsx)(Bn.x6,{i18nKey:"route-error.title",children:"Unable to find application file"})}),(0,T.jsx)("br",{}),(0,T.jsx)("h2",{className:"page-heading",children:(0,T.jsx)(Bn.x6,{i18nKey:"route-error.description",children:"Grafana has likely been updated. Please try reloading the page."})}),(0,T.jsx)("br",{}),(0,T.jsx)(ae.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:(0,T.jsx)(Bn.x6,{i18nKey:"route-error.reload-button",children:"Reload"})}),(0,T.jsx)(sc.D,{title:"Error details",error:Q,errorInfo:Y})]}),!ue&&(0,T.jsx)(sc.D,{title:"An unexpected error happened",error:Q,errorInfo:Y})]})})}const ou=Q=>({container:(0,Re.css)({width:"500px",margin:Q.spacing(8,"auto")})});function iu(){const Q=(0,at.of)(hu);return(0,T.jsx)("div",{className:Q.container,"aria-live":"polite",role:"status","aria-label":(0,Bn.t)("bouncing-loader.label","Loading"),children:(0,T.jsx)("div",{className:Q.bounce,children:(0,T.jsx)("img",{alt:"",src:"public/img/grafana_icon.svg",className:Q.logo})})})}const lu=(0,Re.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),cu=(0,Re.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),du=(0,Re.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),uu=(0,Re.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),hu=Q=>({container:(0,Re.css)({opacity:0,[Q.transitions.handleMotion("no-preference")]:{animationName:lu,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[Q.transitions.handleMotion("reduce")]:{animationName:cu,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,Re.css)({textAlign:"center",[Q.transitions.handleMotion("no-preference")]:{animationName:du,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,Re.css)({display:"inline-block",[Q.transitions.handleMotion("no-preference")]:{animationName:uu,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function fu(){const Q=(0,at.of)(gu);return(0,T.jsx)("div",{className:Q.loadingPage,children:(0,T.jsx)(iu,{})})}const gu=Q=>({loadingPage:(0,Re.css)({backgroundColor:Q.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function pu(Q){const{chrome:Y,keybindings:se}=(0,Mr.Il)();return Y.setMatchedRoute(Q.route),(0,s.useLayoutEffect)(()=>{se.clearAndInitGlobalBindings(Q.route)},[se,Q.route]),(0,s.useEffect)(()=>(ac(Q.route),rc(),(0,h.Lc)("GrafanaRoute",!1,"Mounted",Q.route),()=>{(0,h.Lc)("GrafanaRoute",!1,"Unmounted",Q.route),ac(Q.route,!0)}),[]),(0,s.useEffect)(()=>{rc(),(0,_a.Jy)(),(0,h.Lc)("GrafanaRoute",!1,"Updated",Q)}),(0,h.Lc)("GrafanaRoute",!1,"Rendered",Q.route),(0,T.jsx)(Qi.tH,{children:({error:ue,errorInfo:ye})=>ue?(0,T.jsx)(ru,{error:ue,errorInfo:ye}):(0,T.jsx)(s.Suspense,{fallback:(0,T.jsx)(fu,{}),children:(0,T.jsx)(Q.route.component,{...Q,queryParams:(0,h.SE)(Q.location.search)})})})}function mu({route:Q}){const Y=(0,qs.zy)(),se=Q.roles?Q.roles():[];return se?.length&&!se.some(ue=>en.TP.hasRole(ue))?(0,T.jsx)(qs.C5,{replace:!0,to:"/"}):(0,T.jsx)(pu,{route:Q,location:Y})}function vu(Q){return Q.pageClass?Q.pageClass.split(" "):[]}function ac(Q,Y=!1){for(const se of vu(Q))Y?document.body.classList.remove(se):document.body.classList.add(se)}function rc(){document.body.classList.remove("sidemenu-open--xs");const Q=document.getElementById("tooltip");Q?.parentElement?.removeChild(Q);const Y=document.querySelectorAll(".tooltip");for(let se=0;se<Y.length;se++){const ue=Y[se];ue.parentElement?.removeChild(ue)}for(const se of su().drops)se.destroy()}var yu=e(77188),xu=e(83827),jl=e(37633),oc=e(90617);class Eu extends s.PureComponent{constructor(){super(...arguments),this.styles=Pu(V.$.theme2),this.state={},this.initListener=()=>{const Y=(0,jl.oF)();Y&&(this.subscription=Y.getConnectionState().subscribe({next:se=>{this.setState({show:!se})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:Y}=this.state;return Y?!en.TP.isSignedIn||!V.$.liveEnabled||en.TP.user.orgRole===xu.X.None?null:(0,T.jsx)("div",{className:this.styles.foot,children:(0,T.jsx)(xa.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})}):null}}const Pu=(0,oc.N)(Q=>({foot:(0,Re.css)({position:"fixed",bottom:0,left:0,right:0,zIndex:1e4,cursor:"wait",margin:Q.spacing(2)}),warn:(0,Re.css)({maxWidth:"400px",margin:"auto"})}));var ki=e(83172),Bl=e(9290),ic=e(61574),lc=e(35557),cc=e(43908),Du=e(13147);const dc=(0,s.forwardRef)((Q,Y)=>(0,T.jsx)("div",{id:"ngRoot",ref:Y,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));dc.displayName="AngularRoot";var Cu=e(46942),bu=e.n(Cu),Tu=e(59041),uc=e(82856),hc=e(18828),fc=e(85690),gc=e(93225),Su=e(37008),Mu=e(59830),pc=e(65178),Ou=e(35822);const dl=0,Iu=Q=>{const Y=s.useRef(null),se=s.useRef(null),ue=s.useRef(Q.items);ue.current=Q.items;const ye=(0,Ou.useVirtual)({size:ue.current.length,parentRef:se}),{query:Ce,search:Ue,currentRootActionId:_e,activeIndex:He,options:rt}=(0,Js.useKBar)(Dt=>({search:Dt.searchQuery,currentRootActionId:Dt.currentRootActionId,activeIndex:Dt.activeIndex}));s.useEffect(()=>{const Dt=Tt=>{Tt.key==="ArrowUp"||Tt.ctrlKey&&Tt.key==="p"?(Tt.preventDefault(),Ce.setActiveIndex(wt=>{let sn=wt>dl?wt-1:wt;if(typeof ue.current[sn]=="string"){if(sn===0)return wt;sn-=1}return sn})):Tt.key==="ArrowDown"||Tt.ctrlKey&&Tt.key==="n"?(Tt.preventDefault(),Ce.setActiveIndex(wt=>{let sn=wt<ue.current.length-1?wt+1:wt;if(typeof ue.current[sn]=="string"){if(sn===ue.current.length-1)return wt;sn+=1}return sn})):Tt.key==="Enter"&&(Tt.preventDefault(),Y.current?.click())};return window.addEventListener("keydown",Dt),()=>window.removeEventListener("keydown",Dt)},[Ce]);const{scrollToIndex:it}=ye;s.useEffect(()=>{it(He,{align:He<=1?"end":"auto"})},[He,it]),s.useEffect(()=>{Ce.setActiveIndex(typeof Q.items[dl]=="string"?dl+1:dl)},[Ue,_e,Q.items,Ce]);const xt=s.useCallback((Dt,Tt)=>{if(typeof Tt=="string")return;const wt=Tt.url;Tt.command?(Tt.command.perform(Tt),Ce.toggle()):wt?Dt.ctrlKey||Dt.metaKey||Dt.shiftKey||Ce.toggle():(Ce.setSearch(""),Ce.setCurrentRootAction(Tt.id)),rt.callbacks?.onSelectAction?.(Tt)},[Ce,rt]),Mt=(0,pc.usePointerMovedSinceMount)();return(0,T.jsx)("div",{ref:se,style:{maxHeight:Q.maxHeight||400,position:"relative",overflow:"auto"},children:(0,T.jsx)("div",{role:"listbox",id:Js.KBAR_LISTBOX,style:{height:`${ye.totalSize}px`,width:"100%"},children:ye.virtualItems.map(Dt=>{const Tt=ue.current[Dt.index],{target:wt,url:sn}=Tt,Rn=typeof Tt!="string"&&{onPointerMove:()=>Mt&&He!==Dt.index&&Ce.setActiveIndex(Dt.index),onPointerDown:()=>Ce.setActiveIndex(Dt.index),onClick:ia=>xt(ia,Tt)},$n=Dt.index===He,rs={id:(0,Js.getListboxItemId)(Dt.index),role:"option","aria-selected":$n,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${Dt.start}px)`},...Rn},kn=s.cloneElement(Q.onRender({item:Tt,active:$n}),{ref:Dt.measureRef});return sn?(0,T.jsx)("a",{href:typeof sn=="function"?sn(Ue):sn,target:wt,ref:$n?Y:null,...rs,children:kn},Dt.index):(0,T.jsx)("div",{ref:$n?Y:null,...rs,children:kn},Dt.index)})})})},mc=s.forwardRef(({action:Q,active:Y,currentRootActionId:se},ue)=>{const ye=s.useMemo(()=>{if(!se)return Q.ancestors;const He=Q.ancestors.findIndex(rt=>rt.id===se);return Q.ancestors.slice(He+1)},[Q.ancestors,se]),Ce=(0,at.of)(Au);let Ue=Q.name;const _e=He=>!!(He.command?.perform||He.url);return Q.children.length&&!_e(Q)&&!Ue.endsWith("...")&&(Ue+="..."),(0,T.jsx)("div",{ref:ue,className:(0,Re.cx)(Ce.row,Y&&Ce.activeRow),children:(0,T.jsxs)("div",{className:Ce.actionContainer,children:[Q.icon,(0,T.jsxs)("div",{className:Ce.textContainer,children:[ye.map(He=>(0,T.jsx)(s.Fragment,{children:!_e(He)&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("span",{className:Ce.breadcrumbAncestor,children:He.name}),(0,T.jsx)("span",{className:Ce.breadcrumbSeparator,children:"\u203A"})]})},He.id)),(0,T.jsx)("span",{children:Ue})]}),Q.subtitle&&(0,T.jsx)("span",{className:Ce.subtitleText,children:Q.subtitle})]})})});mc.displayName="ResultItem";const Au=Q=>({row:(0,Re.css)({padding:Q.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:Q.shape.radius.default,margin:Q.spacing(0,1)}),activeRow:(0,Re.css)({color:Q.colors.text.maxContrast,background:Q.colors.emphasize(Q.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:Q.spacing(.5),borderRadius:Q.shape.radius.default,backgroundImage:Q.colors.gradients.brandVertical}}),actionContainer:(0,Re.css)({display:"flex",gap:Q.spacing(1),alignItems:"baseline",fontSize:Q.typography.fontSize,width:"100%"}),textContainer:(0,Re.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,Re.css)({color:Q.colors.text.secondary}),breadcrumbSeparator:(0,Re.css)({color:Q.colors.text.secondary,marginLeft:Q.spacing(1),marginRight:Q.spacing(1)}),subtitleText:(0,Re.css)({...Q.typography.bodySmall,color:Q.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var Ru=e(76459),Lu=e.n(Ru),ju=e(36167),vc=e(92914);const Bu=6,Uu=5,Nu=4,Ul=3,Wu=2,Fu=1,Ku=100,yc=5,wu=Lu()($u,200);async function Vu(){if(!en.TP.user.isSignedIn)return[];const Q=(await ju.A.getDashboardOpened()).slice(0,yc),se=(await(0,vc.S)().search({kind:["dashboard"],limit:yc,uid:Q})).view.toArray();return se.sort((ye,Ce)=>{const Ue=Q.indexOf(ye.uid),_e=Q.indexOf(Ce.uid);return Ue-_e}),se.map(ye=>{const{url:Ce,name:Ue}=ye;return{id:`recent-dashboards${Ce}`,name:`${Ue}`,section:(0,Bn.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:Bu,url:Ce}})}async function $u(Q){if(Q.length===0||!en.TP.user.isSignedIn&&!V.$.bootData.settings.anonymousEnabled)return[];const Y=await(0,vc.S)().search({kind:["dashboard","folder"],query:Q,limit:Ku});return Y.view.map(ue=>{const{url:ye,name:Ce,kind:Ue,location:_e}=ue;return{id:`go/${Ue}${ye}`,name:`${Ce}`,section:Ue==="dashboard"?(0,Bn.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,Bn.t)("command-palette.section.folder-search-results","Folders"),priority:Fu,url:ye,subtitle:Y.view.dataFrame.meta?.custom?.locationInfo[_e]?.name}})}function zu(Q,Y){const[se,ue]=(0,s.useState)([]),[ye,Ce]=(0,s.useState)(!1),Ue=(0,s.useRef)(0);return(0,s.useEffect)(()=>{const _e=Date.now();Y&&Q.length>0?(Ce(!0),wu(Q).then(He=>{_e>Ue.current&&(ue(He),Ce(!1),Ue.current=_e)})):(ue([]),Ce(!1),Ue.current=_e)},[Y,Q]),{searchResults:se,isFetchingSearchResults:ye}}var qr=e(8629),ul=e(97267);function xc(Q){return"navModel."+(Q.id??Q.url??Q.text??Q.subTitle)}function Ec(Q,Y=[]){const se=[];for(let ue of Q){ue.id==="help"&&(ue=(0,qr.CS)({...ue}),delete ue.url);const{url:ye,target:Ce,text:Ue,isCreateAction:_e,children:He,onClick:rt,keywords:it}=ue,xt=!!He?.length;if(!(ye||rt||xt))continue;let Mt=ye;ye&&(ue.id==="connections-add-new-connection"||ue.id==="standalone-plugin-page-/connections/add-new-connection")&&(Mt=Rn=>{const $n=it?.find(rs=>rs.toLowerCase().includes(Rn.toLowerCase()));return $n?`${ye}?search=${$n}`:ye});const Dt=_e?(0,Bn.t)("command-palette.section.actions","Actions"):(0,Bn.t)("command-palette.section.pages","Pages"),Tt=_e?Uu:Nu,wt=Y.map(Rn=>Rn.text).join(" > "),sn={id:xc(ue),name:Ue,section:Dt,url:Mt,target:Ce,parent:Y.length>0&&!_e?xc(Y[Y.length-1]):void 0,perform:rt,keywords:it?.join(" "),priority:Tt,subtitle:_e?void 0:wt};if(se.push(sn),He?.length){const Rn=Ec(He,[...Y,ue]);se.push(...Rn)}}return se}const Hu=(Q,Y)=>{const se=[{id:"preferences/theme",name:(0,Bn.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,Bn.t)("command-palette.section.preferences","Preferences"),priority:Ul},{id:"preferences/dark-theme",name:(0,Bn.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,ul.K)("dark"),parent:"preferences/theme",priority:Ul},{id:"preferences/light-theme",name:(0,Bn.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,ul.K)("light"),parent:"preferences/theme",priority:Ul}],ue=Ec(Q);return[...se,...Y,...ue]};var ii=e(93253);const _u={};function Gu(){const{links:Q}=(0,O.U)({extensionPointId:ii.S.CommandPalette,context:_u,limitPerPlugin:3});return(0,s.useMemo)(()=>Q.map(Y=>({section:Y.category??"Extensions",priority:Wu,id:Y.id,name:Y.title,target:Y.path,perform:()=>Y.onClick&&Y.onClick()})),[Q])}function Qu(Q){const[Y,se]=(0,s.useState)([]),[ue,ye]=(0,s.useState)([]),Ce=Gu(),Ue=(0,Dn.useSelector)(_e=>_e.navBarTree);return(0,s.useEffect)(()=>{const _e=Hu(Ue,Ce);se(_e)},[Ue,Ce]),(0,s.useEffect)(()=>{Q||Vu().then(_e=>ye(_e)).catch(_e=>{console.error("Error loading recent dashboard actions",_e)})},[Q]),Q?Y:[...ue,...Y]}var ku=e(84139);const Pc={name:"none",priority:Js.Priority.NORMAL};function Nl(Q,Y){return Y.priority-Q.priority}function Yu(){const{search:Q,actions:Y,rootActionId:se}=(0,Js.useKBar)(it=>({search:it.searchQuery,actions:it.actions,rootActionId:it.currentRootActionId})),ue=s.useMemo(()=>Object.keys(Y).reduce((it,xt)=>{const Mt=Y[xt];if(!Mt.parent&&!se&&it.push(Mt),Mt.id===se)for(let Dt=0;Dt<Mt.children.length;Dt++)it.push(Mt.children[Dt]);return it},[]).sort(Nl),[Y,se]),ye=s.useCallback(it=>{let xt=[];for(let Mt=0;Mt<it.length;Mt++)xt.push(it[Mt]);return function Mt(Dt,Tt=xt){for(let wt=0;wt<Dt.length;wt++)if(Dt[wt].children.length>0){let sn=Dt[wt].children;for(let Rn=0;Rn<sn.length;Rn++)Tt.push(sn[Rn]);Mt(Dt[wt].children,Tt)}return Tt}(it)},[]),Ce=!Q,Ue=s.useMemo(()=>Ce?ue:ye(ue),[ye,ue,Ce]),_e=Ju(Ue,Q),He=s.useMemo(()=>{let it={},xt=[],Mt=[];for(let Tt=0;Tt<_e.length;Tt++){const wt=_e[Tt],sn=wt.action,Rn=wt.score||Js.Priority.NORMAL,$n={name:typeof sn.section=="string"?sn.section:sn.section?.name||Pc.name,priority:typeof sn.section=="string"?Rn:sn.section?.priority||0+Rn};it[$n.name]||(it[$n.name]=[],xt.push($n)),it[$n.name].push({priority:sn.priority+Rn,action:sn})}Mt=xt.sort(Nl).map(Tt=>({name:Tt.name,actions:it[Tt.name].sort(Nl).map(wt=>wt.action)}));let Dt=[];for(let Tt=0;Tt<Mt.length;Tt++){let wt=Mt[Tt];wt.name!==Pc.name&&Dt.push(wt.name);for(let sn=0;sn<wt.actions.length;sn++)Dt.push(wt.actions[sn])}return Dt},[_e]),rt=s.useMemo(()=>se,[He]);return s.useMemo(()=>({results:He,rootActionId:rt}),[rt,He])}function Ju(Q,Y){const se=Zu(),ue=s.useMemo(()=>({filtered:Q,search:Y}),[Q,Y]),{filtered:ye,search:Ce}=(0,pc.useThrottledValue)(ue);return s.useMemo(()=>{if(Ce.trim()==="")return ye.map(He=>({score:0,action:He}));const Ue=ye.map(({name:He,keywords:rt})=>`${He} ${rt??""}`.toLowerCase()),_e=[];if(Ce.length>Xu){const He=Ce.toLowerCase();for(let rt=0;rt<Ue.length;rt++){const xt=Ue[rt].indexOf(He);if(xt>-1){const Mt=xt*-1,Dt=ye[rt];_e.push({score:Mt,action:Dt})}}}else{const He=se.split(Ce).length,rt=1/0,it=He<5?4:0,[,xt,Mt]=se.search(Ue,Ce,it,rt);if(xt&&Mt)for(let Dt=0;Dt<Mt.length;Dt++){const Tt=Mt[Dt],wt=Mt.length-Dt,sn=ye[xt.idx[Tt]];_e.push({score:wt,action:sn})}}return _e},[ye,Ce,se])}const Xu=25;function Zu(){const Q=s.useRef();return Q.current||(Q.current=new ku.A({intraMode:0,intraIns:0})),Q.current}function qu(){const Q=Dc(),Y=(0,at.of)(Cc,Q),{query:se,showing:ue,searchQuery:ye}=(0,Js.useKBar)(xt=>({showing:xt.visualState===Js.VisualState.showing,searchQuery:xt.searchQuery})),Ce=Qu(ye);(0,Js.useRegisterActions)(Ce,[Ce]);const{searchResults:Ue,isFetchingSearchResults:_e}=zu(ye,ue),He=(0,s.useRef)(null),{overlayProps:rt}=(0,gc.e)({isOpen:ue,onClose:()=>se.setVisualState(Js.VisualState.animatingOut)},He),{dialogProps:it}=(0,hc.s)({},He);return(0,s.useEffect)(()=>{ue&&(0,_a.rR)("command_palette_opened")},[ue]),Ce.length>0?(0,T.jsx)(Js.KBarPortal,{children:(0,T.jsx)(Js.KBarPositioner,{className:Y.positioner,children:(0,T.jsx)(Js.KBarAnimator,{className:Y.animator,children:(0,T.jsx)(fc.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,T.jsxs)("div",{...rt,...it,children:[(0,T.jsxs)("div",{className:Y.searchContainer,children:[(0,T.jsx)(vt.I,{name:"search",size:"md"}),(0,T.jsx)(Js.KBarSearch,{defaultPlaceholder:(0,Bn.t)("command-palette.search-box.placeholder","Search or jump to..."),className:Y.search}),(0,T.jsx)("div",{className:Y.loadingBarContainer,children:_e&&(0,T.jsx)(Su.G,{width:500,delay:0})})]}),(0,T.jsx)("div",{className:Y.resultsContainer,children:(0,T.jsx)(eh,{isFetchingSearchResults:_e,searchResults:Ue})})]})})})})}):null}const eh=({isFetchingSearchResults:Q,searchResults:Y})=>{const{results:se,rootActionId:ue}=Yu(),ye=Dc(),Ce=(0,at.of)(Cc,ye),Ue=(0,Bn.t)("command-palette.section.dashboard-search-results","Dashboards"),_e=(0,Bn.t)("command-palette.section.folder-search-results","Folders"),He=(0,s.useMemo)(()=>Y.filter(Mt=>Mt.id.startsWith("go/dashboard")).map(Mt=>new Js.ActionImpl(Mt,{store:{}})),[Y]),rt=(0,s.useMemo)(()=>Y.filter(Mt=>Mt.id.startsWith("go/folder")).map(Mt=>new Js.ActionImpl(Mt,{store:{}})),[Y]),it=(0,s.useMemo)(()=>{const Mt=[...se];return rt.length>0&&(Mt.push(_e),Mt.push(...rt)),He.length>0&&(Mt.push(Ue),Mt.push(...He)),Mt},[se,Ue,He,_e,rt]),xt=!Q&&it.length===0;return(0,s.useEffect)(()=>{xt&&(0,_a.rR)("grafana_empty_state_shown",{source:"command_palette"})},[xt]),xt?(0,T.jsx)(Mu.p,{variant:"not-found",role:"alert",message:(0,Bn.t)("command-palette.empty-state.message","No results found")}):(0,T.jsx)(Iu,{items:it,maxHeight:650,onRender:({item:Mt,active:Dt})=>{const Tt=it[0]===Mt;return typeof Mt=="string"?(0,T.jsx)("div",{className:(0,Re.cx)(Ce.sectionHeader,Tt&&Ce.sectionHeaderFirst),children:Mt}):(0,T.jsx)(mc,{action:Mt,active:Dt,currentRootActionId:ue})}})},Dc=()=>{const Y=document.querySelector(`[data-testid="${da.Tp.components.NavToolbar.commandPaletteTrigger}"]`)?.getBoundingClientRect().right??0;return document.body.clientWidth-Y},Cc=(Q,Y)=>({positioner:(0,Re.css)({zIndex:Q.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:Q.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,Re.css)({width:"100%",maxWidth:Q.breakpoints.values.md,background:Q.colors.background.primary,color:Q.colors.text.primary,borderRadius:Q.shape.radius.default,border:`1px solid ${Q.colors.border.weak}`,overflow:"hidden",boxShadow:Q.shadows.z3,[Q.breakpoints.up("lg")]:{position:"fixed",right:Y,left:Y,maxWidth:"unset",width:"unset"}}),loadingBarContainer:(0,Re.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,Re.css)({alignItems:"center",background:Q.components.input.background,borderBottom:`1px solid ${Q.colors.border.weak}`,display:"flex",gap:Q.spacing(1),padding:Q.spacing(1,2),position:"relative"}),search:(0,Re.css)({fontSize:Q.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:Q.components.input.text}),spinner:(0,Re.css)({height:"22px"}),resultsContainer:(0,Re.css)({paddingBottom:Q.spacing(1)}),sectionHeader:(0,Re.css)({padding:Q.spacing(1.5,2,2,2),fontSize:Q.typography.bodySmall.fontSize,fontWeight:Q.typography.fontWeightMedium,color:Q.colors.text.secondary,borderTop:`1px solid ${Q.colors.border.weak}`,marginTop:Q.spacing(1)}),sectionHeaderFirst:(0,Re.css)({paddingBottom:Q.spacing(1),borderTop:"none",marginTop:0})});var Wl=e(81635),th=e(59875),bc=e(86634),nh=e(99134),Tc=e(19606),hl=e(32126),Yi=e(71149),sh=e(64599),ah=e(78685),rh=e(5005),oh=e(66384),ih=e(40917);const lh=({children:Q})=>{const Y=(0,at.of)(ch);return(0,T.jsxs)(T.Fragment,{children:[Q,(0,T.jsx)("span",{className:Y.highlight})]})},ch=Q=>({highlight:(0,Re.css)({backgroundColor:Q.colors.success.main,borderRadius:Q.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var dh=e(8270);function Sc({children:Q,isActive:Y,onClick:se,target:ue,url:ye,onPin:Ce,isPinned:Ue}){const _e=(0,at.$j)(),He=uh(_e,Y),rt=!ue&&ye.startsWith("/")?dh.N:"a",it=(0,T.jsxs)("div",{className:He.linkContent,children:[Q,ue==="_blank"&&(0,T.jsx)(vt.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,T.jsxs)("div",{className:(0,Re.cx)(He.wrapper,{[He.wrapperActive]:Y,[He.wrapperBookmark]:V.$.featureToggles.pinNavItems}),children:[(0,T.jsx)(rt,{"data-testid":da.Tp.components.NavMenu.item,className:He.container,href:ye,target:ue,onClick:se,...Y&&{"aria-current":"page"},children:it}),V.$.featureToggles.pinNavItems&&en.TP.isSignedIn&&ye&&ye!=="/bookmarks"&&(0,T.jsx)(Zt.K,{name:"bookmark",className:"pin-icon",iconType:Ue?"solid":"default",onClick:()=>Ce(ye),"aria-label":Ue?(0,Bn.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,Bn.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}Sc.displayName="MegaMenuItemText";const uh=(Q,Y)=>({wrapper:(0,Re.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,Re.css)({".pin-icon":{visibility:"hidden"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{visibility:"visible"}}}),wrapperActive:(0,Re.css)({backgroundColor:Q.colors.action.selected,borderTopRightRadius:Q.shape.radius.default,borderBottomRightRadius:Q.shape.radius.default,position:"relative","&::before":{backgroundImage:Q.colors.gradients.brandVertical,borderRadius:Q.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:Q.spacing(.5)}}),container:(0,Re.css)({alignItems:"center",color:Y?Q.colors.text.primary:Q.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover span, &:focus-visible span":{color:Q.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${Q.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,Re.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})}),fl=2;function Mc({link:Q,activeItem:Y,level:se=0,onClick:ue,onPin:ye,isPinned:Ce}){const{chrome:Ue}=(0,Mr.Il)(),He=Ue.useState().megaMenuDocked,rt=(0,qs.zy)(),it=Q.highlightText?lh:s.Fragment,xt=(0,qr.m0)(Q,Y),Mt=Q===Y||se===fl&&xt,[Dt,Tt]=(0,ah.A)(`grafana.navigation.expanded[${Q.text}]`,!!(xt||Q.isNew)),wt=se<fl&&!!(Oc(Q)||Q.emptyMessage),sn=(0,s.useRef)(null),Rn=(0,at.of)(hh);if((0,s.useEffect)(()=>{xt&&Tt(!0)},[xt,rt,He,Tt]),(0,s.useEffect)(()=>{Mt&&sn.current&&fh(sn.current)&&sn.current.scrollIntoView({block:"center"})},[Mt]),!Q.url)return null;let $n=null;Q.icon?$n=(0,T.jsx)(vt.I,{className:Rn.icon,name:(0,rh.Uo)(Q.icon)??"link",size:"lg"}):Q.img&&($n=(0,T.jsx)(Rs.B,{width:3,justifyContent:"center",children:(0,T.jsx)("img",{className:Rn.img,src:Q.img,alt:""})}));function rs(kn){return kn?"angle-up":"angle-down"}return(0,T.jsxs)("li",{ref:sn,className:Rn.listItem,children:[(0,T.jsxs)("div",{className:(0,Re.cx)(Rn.menuItem,{[Rn.menuItemWithIcon]:!!(se===0&&$n)}),children:[se!==0&&(0,T.jsx)(ih.T,{level:se===fl?se-1:se,spacing:3}),se===fl&&(0,T.jsx)("div",{className:Rn.itemConnector}),(0,T.jsx)("div",{className:Rn.collapsibleSectionWrapper,children:(0,T.jsx)(Sc,{isActive:Mt,onClick:()=>{Q.onClick?.(),ue?.()},target:Q.target,url:Q.url,onPin:()=>ye(Q),isPinned:Ce(Q.url),children:(0,T.jsxs)("div",{className:(0,Re.cx)(Rn.labelWrapper,{[Rn.hasActiveChild]:xt,[Rn.labelWrapperWithIcon]:!!(se===0&&$n)}),children:[se===0&&$n&&(0,T.jsx)(it,{children:$n}),(0,T.jsx)(Ua.E,{truncate:!0,children:Q.text}),Q.isNew&&(0,T.jsx)(oh.E,{text:(0,Bn.t)("navigation.megamenu.new","New!"),color:"blue"})]})})}),(0,T.jsx)("div",{className:Rn.collapseButtonWrapper,children:wt&&(0,T.jsx)(Zt.K,{"aria-label":`${Dt?"Collapse":"Expand"} section ${Q.text}`,className:Rn.collapseButton,onClick:()=>Tt(!Dt),name:rs(!!Dt),size:"md",variant:"secondary"})})]}),wt&&Dt&&(0,T.jsx)("ul",{className:Rn.children,children:Oc(Q)?Q.children.filter(kn=>!kn.isCreateAction).map(kn=>(0,T.jsx)(Mc,{link:kn,activeItem:Y,onClick:ue,level:se+1,onPin:ye,isPinned:Ce},`${Q.text}-${kn.text}`)):(0,T.jsx)("div",{className:Rn.emptyMessage,"aria-live":"polite",children:Q.emptyMessage})})]})}const hh=Q=>({icon:(0,Re.css)({width:Q.spacing(3)}),img:(0,Re.css)({height:Q.spacing(2),width:Q.spacing(2)}),listItem:(0,Re.css)({flex:1,maxWidth:"100%"}),menuItem:(0,Re.css)({display:"flex",alignItems:"center",gap:Q.spacing(1),height:Q.spacing(4),paddingLeft:Q.spacing(.5),position:"relative"}),menuItemWithIcon:(0,Re.css)({paddingLeft:Q.spacing(0)}),collapseButtonWrapper:(0,Re.css)({display:"flex",justifyContent:"center",width:Q.spacing(3),flexShrink:0}),itemConnector:(0,Re.css)({position:"relative",height:"100%",width:Q.spacing(1.5),"&::before":{borderLeft:`1px solid ${Q.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,Re.css)({margin:0}),collapsibleSectionWrapper:(0,Re.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,Re.css)({display:"flex",alignItems:"center",gap:Q.spacing(2),minWidth:0,paddingLeft:Q.spacing(1)}),labelWrapperWithIcon:(0,Re.css)({paddingLeft:Q.spacing(.5)}),hasActiveChild:(0,Re.css)({color:Q.colors.text.primary}),children:(0,Re.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,Re.css)({color:Q.colors.text.secondary,fontStyle:"italic",padding:Q.spacing(1,1.5,1,7)})});function Oc(Q){return!!(Q.children&&Q.children.length>0)}function fh(Q){const Y=Q.getBoundingClientRect();return Y.bottom<0||Y.top>=window.innerHeight}var gh=e(24124);const Co="300px",Fl=(0,s.memo)((0,s.forwardRef)(({onClose:Q,...Y},se)=>{const ue=(0,Dn.useSelector)(Rn=>Rn.navBarTree),ye=(0,at.of)(ph),Ce=(0,qs.zy)(),{chrome:Ue}=(0,Mr.Il)(),_e=(0,Dn.useDispatch)(),He=Ue.useState(),[rt]=(0,hl.o)(),it=(0,gh.s)(),xt=ue.filter(Rn=>Rn.id!=="profile"&&Rn.id!=="help").map(Rn=>(0,qr.J0)(Rn,He.megaMenuDocked));if(V.$.featureToggles.pinNavItems){const Rn=(0,qr.Wk)(xt,"/bookmarks");Rn&&(Rn.children=it.reduce(($n,rs)=>{const kn=(0,qr.Wk)(xt,rs);if(!kn)return $n;const ia={id:kn.id,text:kn.text,url:kn.url,parentItem:{id:"bookmarks",text:"Bookmarks"}};return $n.push((0,qr.J0)(ia,He.megaMenuDocked)),$n},[]))}const Mt=(0,qr.A6)(xt,He.sectionNav.node,Ce.pathname),Dt=()=>{Ue.setMegaMenuOpen(!He.megaMenuOpen)},Tt=()=>{Ue.setMegaMenuDocked(!He.megaMenuDocked),He.megaMenuDocked&&Ue.setMegaMenuOpen(!1)},wt=(0,s.useCallback)(Rn=>!Rn||!it?.length?!1:it?.includes(Rn),[it]),sn=Rn=>{const $n=Rn.url;if($n&&V.$.featureToggles.pinNavItems){const rs=wt($n),kn=rs?it.filter(ks=>$n!==ks):[...it,$n],ia=rs?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,_a.rR)(ia,{path:$n}),rt({patchPrefsCmd:{navbar:{bookmarkUrls:kn}}}).then(ks=>{ks.error||_e((0,Tc.ve)({item:Rn,isSaved:!rs}))})}};return(0,T.jsxs)("div",{"data-testid":da.Tp.components.NavMenu.Menu,ref:se,...Y,children:[(0,T.jsx)(sh.fn,{handleDockedMenu:Tt,handleMegaMenu:Dt,onClose:Q}),(0,T.jsx)("nav",{className:ye.content,children:(0,T.jsx)(nh.P,{height:"100%",overflowX:"hidden",showScrollIndicators:!0,children:(0,T.jsx)("ul",{className:ye.itemList,"aria-label":(0,Bn.t)("navigation.megamenu.list-label","Navigation"),children:xt.map((Rn,$n)=>(0,T.jsx)(Rs.B,{direction:$n===0?"row-reverse":"row",alignItems:"start",children:(0,T.jsx)(Mc,{link:Rn,isPinned:wt,onClick:He.megaMenuDocked?void 0:Q,activeItem:Mt,onPin:sn})},Rn.text))})})})]})}));Fl.displayName="MegaMenu";const ph=Q=>({content:(0,Re.css)({display:"flex",flexDirection:"column",height:`calc(100% - ${Yi.l}px)`,minHeight:0,position:"relative"}),mobileHeader:(0,Re.css)({display:"flex",justifyContent:"space-between",padding:Q.spacing(1,1,1,2),borderBottom:`1px solid ${Q.colors.border.weak}`,[Q.breakpoints.up("md")]:{display:"none"}}),itemList:(0,Re.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:Q.spacing(1,1,2,1),[Q.breakpoints.up("md")]:{width:Co}}),dockMenuButton:(0,Re.css)({display:"none",position:"relative",top:Q.spacing(1),[Q.breakpoints.up("xl")]:{display:"inline-flex"}})});function mh({}){const Q=(0,at.$j)(),{chrome:Y}=(0,Mr.Il)(),se=Y.useState(),ue=(0,s.useRef)(null),ye=(0,s.useRef)(null),Ce=Q.transitions.duration.shortest,Ue=(0,at.of)(yh,Ce),_e=se.megaMenuOpen&&!se.megaMenuDocked,He=()=>Y.setMegaMenuOpen(!1),{overlayProps:rt,underlayProps:it}=(0,gc.e)({isDismissable:!0,isOpen:!0,onClose:He,shouldCloseOnInteractOutside:Dt=>!document.querySelector(`[data-testid="${da.Tp.components.Select.menu}"]`)?.contains(Dt)},ue),{dialogProps:xt}=(0,hc.s)({},ue),Mt=(0,at.of)(vh);return(0,T.jsx)("div",{className:Mt.wrapper,children:(0,T.jsxs)(th.Sf,{children:[(0,T.jsx)(bc.A,{nodeRef:ue,in:_e,unmountOnExit:!0,classNames:Ue.overlay,timeout:{enter:Ce,exit:0},children:(0,T.jsx)(T.Fragment,{children:_e&&(0,T.jsx)(fc.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,T.jsx)(Fl,{className:Mt.menu,onClose:He,ref:ue,...rt,...xt})})})}),(0,T.jsx)(bc.A,{nodeRef:ye,in:_e,unmountOnExit:!0,classNames:Ue.backdrop,timeout:{enter:Ce,exit:0},children:(0,T.jsx)("div",{ref:ye,className:Mt.backdrop,...it})})]})})}const vh=Q=>({backdrop:(0,Re.css)({backdropFilter:"blur(1px)",backgroundColor:Q.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:0,zIndex:Q.zIndex.modalBackdrop}),menu:(0,Re.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:Q.zIndex.modal,position:"fixed",top:0,backgroundColor:Q.colors.background.primary,flex:"1 1 0",[Q.breakpoints.up("md")]:{right:"unset"}}),wrapper:(0,Re.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:Q.zIndex.sidemenu})}),yh=(Q,Y)=>{const se={[Q.transitions.handleMotion("no-preference")]:{transitionDuration:`${Y}ms`,transitionTimingFunction:Q.transitions.easing.easeInOut},[Q.breakpoints.down("md")]:{overflow:"hidden"}},ue={...se,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},ye={...se,transitionProperty:"opacity"},Ce={width:"100%",[Q.breakpoints.up("md")]:{borderRight:`1px solid ${Q.colors.border.weak}`,boxShadow:Q.shadows.z3,width:Co}},Ue={boxShadow:"none",width:0},_e={opacity:1},He={opacity:0};return{backdrop:{enter:(0,Re.css)(He),enterActive:(0,Re.css)(ye,_e),enterDone:(0,Re.css)(_e)},overlay:{enter:(0,Re.css)(Ue),enterActive:(0,Re.css)(ue,Ce),enterDone:(0,Re.css)(Ce)}}};var Kl=e(94885),xh=e(90333);const Ic=({label:Q,onClick:Y,onDismiss:se})=>{const ue=(0,at.of)(Eh);return(0,T.jsxs)(xh.e,{className:ue.buttonGroup,children:[(0,T.jsx)(ae.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:Y,title:Q,className:ue.mainDismissableButton,"data-testid":da.Tp.components.ReturnToPrevious.backButton,children:Q}),(0,T.jsx)(ae.$n,{icon:"times","aria-label":(0,Bn.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:se,"data-testid":da.Tp.components.ReturnToPrevious.dismissButton})]})},Eh=Q=>({mainDismissableButton:(0,Re.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,Re.css)({width:"fit-content",backgroundColor:Q.colors.background.secondary})});Ic.displayName="DismissableButton";const Ac=({href:Q,title:Y})=>{const se=(0,at.of)(Ph),{chrome:ue}=(0,Mr.Il)(),ye=(0,s.useCallback)(()=>{h.Ny.push(Q),ue.clearReturnToPrevious("clicked")},[Q,ue]),Ce=(0,s.useCallback)(()=>{ue.clearReturnToPrevious("dismissed")},[ue]);return(0,T.jsx)("div",{className:se.returnToPrevious,"data-testid":da.Tp.components.ReturnToPrevious.buttonGroup,children:(0,T.jsx)(Ic,{label:(0,Bn.t)("return-to-previous.button.label","Back to {{title}}",{title:Y}),onClick:ye,onDismiss:Ce})})},Ph=Q=>({returnToPrevious:(0,Re.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:Q.zIndex.tooltip,position:"fixed",bottom:Q.spacing.x4,boxShadow:Q.shadows.z3})});Ac.displayName="ReturnToPrevious";var Dh=e(10747);function Ch({children:Q}){const Y=(0,at.of)(bh);return(0,T.jsx)("div",{"data-testid":da.XF.NavToolbar.container,className:Y.actionsBar,children:(0,T.jsx)(Rs.B,{alignItems:"center",justifyContent:"flex-end",flex:1,wrap:"nowrap",minWidth:0,children:Q})})}const bh=Q=>({actionsBar:(0,Re.css)({alignItems:"center",backgroundColor:Q.colors.background.primary,borderBottom:`1px solid ${Q.colors.border.weak}`,display:"flex",height:Yi.l,padding:Q.spacing(0,1,0,2)})});function Th({children:Q}){const{chrome:Y}=(0,Mr.Il)(),se=Y.useState(),ue=(0,at.$j)(),ye=(0,at.of)(Sh,!!se.actions),Ce=ue.breakpoints.values.xl,Ue=uc.A.getBool(Kl.hE,!0),_e=!se.chromeless&&se.megaMenuDocked&&se.megaMenuOpen,He=(0,Wl.fX)(),rt=!!(He?.isEnabled&&He?.isPanelOpened&&!He?.isReadOnly);(0,Tu.Y)({breakpoint:Ce,onChange:sn=>{Ue&&(Y.setMegaMenuDocked(sn.matches,!1),Y.setMegaMenuOpen(sn.matches?uc.A.getBool(Kl.k0,se.megaMenuOpen):!1))}}),(0,qr.n0)(se.megaMenuOpen,se.megaMenuDocked);const it=(0,Re.cx)({[ye.content]:!0,[ye.contentChromeless]:se.chromeless}),xt=()=>{Y.setMegaMenuOpen(!se.megaMenuOpen)},{pathname:Mt,search:Dt}=h.Ny.getLocation(),Tt=Mt+Dt,wt=se.returnToPrevious&&Tt!==se.returnToPrevious.href;return(0,s.useEffect)(()=>{se.returnToPrevious&&Tt===se.returnToPrevious.href&&Y.clearReturnToPrevious("auto_dismissed")},[Y,Tt]),(0,s.useEffect)(()=>{const sn=(0,h.SE)(Dt);Y.setKioskModeFromUrl(sn.kiosk)},[Y,Dt]),(0,T.jsxs)("div",{className:bu()("main-view",{"main-view--chrome-hidden":se.chromeless}),children:[!se.chromeless&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ae.z9,{className:ye.skipLink,href:"#pageContent",children:(0,T.jsx)(Bn.x6,{i18nKey:"app-chrome.skip-content-button",children:"Skip to main content"})}),_e&&(0,T.jsx)(Fl,{className:ye.dockedMegaMenu,onClose:()=>Y.setMegaMenuOpen(!1)}),(0,T.jsxs)("header",{className:(0,Re.cx)(ye.topNav,_e&&ye.topNavMenuDocked),children:[(0,T.jsx)(Dh.h,{sectionNav:se.sectionNav.node,pageNav:se.pageNav,onToggleMegaMenu:xt,onToggleKioskMode:Y.onToggleKioskMode}),se.actions&&(0,T.jsx)(Ch,{children:se.actions})]})]}),(0,T.jsx)("div",{className:it,children:(0,T.jsxs)("div",{className:ye.panes,children:[!se.chromeless&&(0,T.jsx)("div",{className:(0,Re.cx)(ye.scopesDashboardsContainer,{[ye.scopesDashboardsContainerDocked]:_e}),children:(0,T.jsx)(Wl.T3,{})}),(0,T.jsx)("main",{className:(0,Re.cx)(ye.pageContainer,{[ye.pageContainerMenuDocked]:_e||rt,[ye.pageContainerMenuDockedScopes]:_e&&rt}),id:"pageContent",children:Q})]})}),!se.chromeless&&!se.megaMenuDocked&&(0,T.jsx)(mh,{}),!se.chromeless&&(0,T.jsx)(qu,{}),wt&&se.returnToPrevious&&(0,T.jsx)(Ac,{href:se.returnToPrevious.href,title:se.returnToPrevious.title})]})}const Sh=(Q,Y)=>({content:(0,Re.css)({display:"flex",flexDirection:"column",paddingTop:Y?Yi.l*2:Yi.l,flexGrow:1,height:"auto"}),contentChromeless:(0,Re.css)({paddingTop:0}),dockedMegaMenu:(0,Re.css)({background:Q.colors.background.primary,borderRight:`1px solid ${Q.colors.border.weak}`,display:"none",height:"100%",position:"fixed",top:0,width:Co,zIndex:2,[Q.breakpoints.up("xl")]:{display:"block"}}),scopesDashboardsContainer:(0,Re.css)({position:"fixed",height:`calc(100% - ${Yi.l}px)`,zIndex:1}),scopesDashboardsContainerDocked:(0,Re.css)({left:Co}),topNav:(0,Re.css)({display:"flex",position:"fixed",zIndex:Q.zIndex.navbarFixed,left:0,right:0,background:Q.colors.background.primary,flexDirection:"column"}),topNavMenuDocked:(0,Re.css)({left:Co}),panes:(0,Re.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"}),pageContainerMenuDocked:(0,Re.css)({paddingLeft:Co}),pageContainerMenuDockedScopes:(0,Re.css)({paddingLeft:`calc(${Co} * 2)`}),pageContainer:(0,Re.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1}),skipLink:(0,Re.css)({position:"fixed",top:-1e3,":focus":{left:Q.spacing(1),top:Q.spacing(1),zIndex:Q.zIndex.portal}})});var Ji=e(52718),Xi=e(23737),Ta=e(22492),Rc=e(80847),gl=e(17687),Mh=e(94701);function Oh({appNotification:Q,onClearNotification:Y}){const se=(0,at.of)(Ih);(0,Mh.A)(()=>{setTimeout(()=>{Y(Q.id)},Dn.timeoutMap[Q.severity])});const ue=Q.component||Q.text||Q.traceId,ye=Q.traceId;return(0,T.jsx)(xa.F,{severity:Q.severity,title:Q.title,onRemove:()=>Y(Q.id),elevated:!0,children:ue&&(0,T.jsxs)("div",{className:se.wrapper,children:[(0,T.jsx)("span",{children:Q.component||Q.text}),ye&&(0,T.jsx)("span",{className:se.trace,children:(0,T.jsxs)(Bn.x6,{i18nKey:"app-notification.item.trace-id",children:["Trace ID: ",{traceId:ye}]})})]})})}function Ih(Q){return{wrapper:(0,Re.css)({display:"flex",flexDirection:"column"}),trace:(0,Re.css)({fontSize:Q.typography.pxToRem(10)})}}function Ah(){const Q=(0,Dn.useSelector)(ye=>(0,Rc.fX)(ye.appNotifications)),Y=(0,Dn.useDispatch)(),se=(0,at.of)(Rh);(0,s.useEffect)(()=>{Ta.A.on(Ji.r1.alertWarning,ye=>Y((0,Xi.dx)((0,gl.q8)(...ye)))),Ta.A.on(Ji.r1.alertSuccess,ye=>Y((0,Xi.dx)((0,gl.tZ)(...ye)))),Ta.A.on(Ji.r1.alertError,ye=>Y((0,Xi.dx)((0,gl.gi)(...ye)))),Ta.A.on(Ji.r1.alertInfo,ye=>Y((0,Xi.dx)((0,gl.Cf)(...ye))))},[Y]);const ue=ye=>{Y((0,Xi.Do)(ye))};return(0,T.jsx)("div",{className:se.wrapper,children:(0,T.jsx)(Rs.B,{direction:"column",children:Q.map((ye,Ce)=>(0,T.jsx)(Oh,{appNotification:ye,onClearNotification:ue},`${ye.id}-${Ce}`))})})}function Rh(Q){return{wrapper:(0,Re.css)({label:"app-notifications-list",zIndex:Q.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var Lh=e(84099),jh=e(65164),za=e(91830);function Bh(Q){const[Y,se]=(0,s.useState)({component:null,props:{}}),ue=(0,s.useMemo)(()=>{function ye(Ue,_e){se({component:Ue,props:_e})}function Ce(){se({component:null,props:{}})}return{component:Y.component,props:{...Y.props,isOpen:!0,onDismiss:Ce},showModal:ye,hideModal:Ce}},[Y]);return(0,s.useEffect)(()=>{Ta.A.subscribe(za.S8,({payload:Ce})=>{se({component:Ce.component,props:Ce.props})}),Ta.A.subscribe(za.bY,Ce=>{Uh(Ce,se)});let ye="";h.Ny.getHistory().listen(Ce=>{Ce.pathname!==ye&&se({component:null,props:{}}),ye=Ce.pathname})},[]),(0,T.jsx)(cc.wE.Provider,{value:ue,children:Q.children})}function Uh({payload:Q},Y){const{confirmText:se,onConfirm:ue=()=>{},onDismiss:ye,text2:Ce,altActionText:Ue,onAltAction:_e,noText:He,text:rt,text2htmlBind:it,yesText:xt="Yes",icon:Mt,title:Dt="Confirm",yesButtonVariant:Tt}=Q,wt=()=>Y({component:null,props:{}}),sn={confirmText:xt,confirmButtonVariant:Tt,confirmationText:se,icon:Mt,title:Dt,body:rt,description:Ce&&it?Lh.sQ.sanitize(Ce):Ce,isOpen:!0,dismissText:He,onConfirm:()=>{ue(),wt()},onDismiss:()=>{ye?.(),wt()},onAlternative:_e?()=>{_e(),wt()}:void 0,alternativeText:Ue};Y({component:jh.u,props:sn})}var Nh=e(12049);function Wh(Q){return Q.providers.reduce((Y,se)=>(0,T.jsx)(se,{children:Y}),Q.children)}function Lc(Q){return(0,T.jsx)(ic.Ix,{history:h.Ny.getHistory(),children:(0,T.jsx)(h._K,{service:h.Ny,children:(0,T.jsx)(lc.CompatRouter,{children:(0,T.jsx)(Nh.YZ,{children:(0,T.jsx)(Wh,{providers:Q.providers,children:(0,T.jsxs)(Bh,{children:[(0,T.jsxs)(Th,{children:[(0,T.jsx)(dc,{}),(0,T.jsx)(Ah,{}),(0,T.jsxs)(Rs.B,{gap:0,grow:1,direction:"column",children:[Q.pageBanners.map((Y,se)=>(0,T.jsx)(Y,{},se.toString())),Q.routes]}),Q.bodyRenderHooks.map((Y,se)=>(0,T.jsx)(Y,{},se.toString()))]}),(0,T.jsx)(cc.EO,{})]})})})})})})}function Fh(Q){const{closeApp:Y,locationService:se,activePluginId:ue}=(0,Do.M)();let{containerProps:ye,primaryProps:Ce,secondaryProps:Ue,splitterProps:_e}=(0,Du.h)({direction:"row",initialSize:.6,dragPosition:"end",handleSize:"sm"});function He(Mt){return{...Mt,style:{...Mt.style,overflow:"auto",minWidth:"unset",minHeight:"unset"}}}Ce=He(Ce),Ue=He(Ue);const rt=(0,I.k)(),it=(0,at.of)(Kh,rt),xt=!!ue;return(0,T.jsxs)("div",{...xt?ye:{className:it.dummyWrapper},children:[(0,T.jsx)("div",{...xt?Ce:{className:it.dummyWrapper},children:(0,T.jsx)(Lc,{...Q})}),xt&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{..._e}),(0,T.jsx)("div",{...Ue,children:(0,T.jsx)(ic.Ix,{history:se.getHistory(),children:(0,T.jsx)(h._K,{service:se,children:(0,T.jsxs)(lc.CompatRouter,{children:[(0,T.jsx)(Ae.k,{}),(0,T.jsxs)("div",{className:it.secondAppChrome,children:[(0,T.jsx)("div",{className:it.secondAppToolbar,children:(0,T.jsx)(Zt.K,{size:"lg",style:{margin:"8px"},name:"times","aria-label":"close",onClick:()=>Y()})}),(0,T.jsx)("div",{className:it.secondAppWrapper,children:Q.routes})]})]})})})})]})]})}const Kh=(Q,Y)=>({secondAppChrome:(0,Re.css)({label:"secondAppChrome",display:"flex",height:"100%",width:"100%",paddingTop:Y||0,flexGrow:1,flexDirection:"column"}),secondAppToolbar:(0,Re.css)({label:"secondAppToolbar",display:"flex",justifyContent:"flex-end"}),secondAppWrapper:(0,Re.css)({label:"secondAppWrapper",overflow:"auto",flex:"1"}),dummyWrapper:(0,Re.css)({label:"dummyWrapper",display:"flex",height:"100vh",flexDirection:"column"})});let jc=[],Bc=[];const Uc=[];function x0(Q){Uc.push(Q)}function E0(Q){jc.push(Q)}function P0(Q){Bc.push(Q)}class wh extends s.Component{constructor(Y){super(Y),this.iconCacheID=`grafana-icon-cache-${V.$.buildInfo.commit}`,this.renderRoute=se=>(0,T.jsx)(qs.qh,{caseSensitive:se.sensitive===void 0?!1:se.sensitive,path:se.path,element:(0,T.jsx)(mu,{route:se})},se.path),this.state={}}async componentDidMount(){await tu(),this.setState({ready:!0}),$(".preloader").remove();const Y=await window.caches.keys();for(const se of Y)se.startsWith("grafana-icon-cache")&&se!==this.iconCacheID&&window.caches.delete(se)}renderRoutes(){return(0,T.jsx)(qs.BV,{children:Gd().map(Y=>this.renderRoute(Y))})}render(){const{app:Y}=this.props,{ready:se}=this.state;(0,h.Lc)("AppWrapper",!1,"rendering");const ue=Ue=>{(0,_a.rR)("command_palette_action_selected",{actionId:Ue.id,actionName:Ue.name})},ye={routes:se&&this.renderRoutes(),pageBanners:Bc,bodyRenderHooks:jc,providers:Uc},Ce=V.$.featureToggles.timeRangeProvider?oi.A:s.Fragment;return(0,T.jsx)(Ja.Provider,{store:ta.M_,children:(0,T.jsx)(Qi.Xw,{style:"page",children:(0,T.jsx)(Mr.YE.Provider,{value:Y.context,children:(0,T.jsx)(yu.N,{value:V.$.theme2,children:(0,T.jsx)(ri.A,{name:this.iconCacheID,children:(0,T.jsxs)(Js.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:ue}},children:[(0,T.jsx)(Ae.k,{}),(0,T.jsx)(Ce,{children:(0,T.jsx)(Do.K.Provider,{value:ur.R,children:(0,T.jsx)(ki.AZ,{registries:Bl.qm,children:(0,T.jsxs)("div",{className:"grafana-app",children:[V.$.featureToggles.appSidecar?(0,T.jsx)(Fh,{...ye}):(0,T.jsx)(Lc,{...ye}),(0,T.jsx)(Eu,{}),(0,T.jsx)(pe.qB,{})]})})})})]})})})})})})}}var Nc=e(71536),Vh=e(37096);function $h({actions:Q,children:Y,info:se,pageNav:ue,layout:ye,renderTitle:Ce,subTitle:Ue}){const _e=(0,s.useContext)(Vh.A);return(0,T.jsx)(et.Y,{navModel:_e.sectionNav,pageNav:ue,layout:ye,actions:Q,renderTitle:Ce,info:se,subTitle:Ue,children:(0,T.jsx)(et.Y.Contents,{children:Y})})}var zh=e(45928),Hh=e(43561),_h=e(18729),Wc=e(89956);function Fc(){return typeof window.SharedWorker<"u"}class Gh{constructor(Y,se){if(!Fc())throw new Error("SharedWorker is not supported");const ue=Y.toString(),ye=new URL(".",Y).toString(),Ce=`importScripts('${ue}');`,Ue=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${ye}'; ${Ce}`],{type:"application/javascript"})),_e=new SharedWorker(Ue,se);return URL.revokeObjectURL(Ue),_e}}function Qh(Q){return!Q||typeof Q!="object"?!1:"totalJSHeapSize"in Q&&"usedJSHeapSize"in Q&&"jsHeapSizeLimit"in Q}function kh(Q){return!Q||typeof Q!="object"?!1:"memory"in Q&&Qh(Q.memory)}function Kc(Q){const Y={};function se(ue,ye){if(typeof ue=="object"&&ue!==null){if(Array.isArray(ue))throw new Error("Array values are not supported.");for(const Ce in ue)ue.hasOwnProperty(Ce)&&se(ue[Ce],ye?`${ye}_${Ce}`:Ce)}else typeof ue=="string"?Y[ye]=ue:typeof ue=="number"&&(Number.isInteger(ue)?Y[ye]=ue.toString():Y[ye]=ue.toFixed(4))}return se(Q,"crash"),Y}const wc=(0,_h.DW)("core.crash-detection");function Yh(){if(!Fc())return;let Q=Date.now();document.body.addEventListener("click",()=>Q=Date.now(),!0),document.body.addEventListener("keypress",()=>Q=Date.now(),!0),(0,zh.initCrashDetection)({id:(0,Hh.Ak)(5),dbName:"grafana.crashes",createClientWorker(){return new Wc.c(new URL(e.p+e.u(3804),e.b))},createDetectorWorker(){return new Gh(new URL(e.p+e.u(4747),e.b))},reportCrash:async Y=>{const se=Kc(Y);return wc.logWarning("browser crash detected",se),!0},reportStaleTab:async Y=>{const se=Kc(Y);return wc.logWarning("stale browser tab detected",se),!0},updateInfo:Y=>{Y.app={version:V.$.buildInfo.version,url:window.location.href},Y.user={email:en.TP.user.email,login:en.TP.user.login,name:en.TP.user.name,lastInteraction:Q},kh(performance)&&(Y.memory={heapUtilization:performance.memory.usedJSHeapSize/performance.memory.totalJSHeapSize,limitUtilization:performance.memory.totalJSHeapSize/performance.memory.jsHeapSizeLimit,usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize,jsHeapSizeLimit:performance.memory.jsHeapSizeLimit})}})}var Jh=e(71711),Xh=e(93407);function Zh(Q){const Y=Q.target instanceof Element&&qh(Q.target);if(!(Q.ctrlKey||Q.metaKey||Q.defaultPrevented)&&Y){let se=Y.getAttribute("href");const ue=Y.getAttribute("target");if(se&&!ue){const ye=Xh.kM.parseKeyValue(se.split("?")[1]),Ce=ye.orgId&&Number(ye.orgId)!==K.$W.bootData.user.orgId;if((0,h.Lc)("utils",!1,"intercepting link click",Q),Q.preventDefault(),se=m.I.stripBaseFromUrl(se),se[0]!=="/"||Ce)if(se.indexOf("://")>0||se.indexOf("mailto:")===0||Ce){window.location.href=se;return}else if(se.indexOf("#")===0){window.location.hash=se;return}else se=`/${se}`;h.Ny.push(se)}}}function qh(Q){for(;Q!==null&&Q.tagName;){if(Q.tagName.toUpperCase()==="A")return Q;Q=Q.parentElement}return null}var Vc=e(3930),ef=e(97414);class tf{attachCorrelationsToDataFrames(Y,se,ue){return(0,Vc.cA)(Y,se,ue)}correlationsDataLinkPostProcessorFactory(Y){return(0,ef.YV)(void 0,Y)}getCorrelationsBySourceUIDs(Y){return(0,Vc.J6)(Y)}}var nf=e(40819);class sf{constructor(Y){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=Y??1e3*60*5}start(){const Y=(0,jl.oF)();Y&&Y.getConnectionState().subscribe(se=>{se&&this._checkForUpdates()}),h.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=h.Ny.getLocation().pathname}locationUpdated(Y){if(this.prevLocationPath===Y.pathname)return;const se=Y.pathname.split("/");se[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():se[1]==="d"&&!nf._o.state.isPlaying?this.reloadIfUpdateDetected():this.hasUpdates&&(0,_a.rR)("new_frontend_assets_reload_ignored",{newLocation:Y.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=Y.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const Y=this.previous,se=await(0,f.AI)().get("/api/frontend/assets");Y&&!(0,z.isEqual)(Y,se)&&(this.hasUpdates=!0,(0,_a.rR)("new_frontend_assets_detected",{assets:Y.assets!==se.assets,plugins:Y.plugins!==se.plugins,version:Y.version!==se.version,flags:Y.flags!==se.flags})),this.previous=se}reloadIfUpdateDetected(){this.hasUpdates&&((0,_a.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var $c=e(75911),zc=e(87851);class af{constructor(Y){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const se of this.backends)se.flush()},this.addBackend=se=>{(0,zc.S5)("Adding backend",!1,se),this.backends.push(se)},this.addEvent=(se,ue)=>{const ye=this.getMeta(),Ce={...se,meta:{...ye,...ue}};for(const Ue of this.backends)(Ue.supportedEvents.length===0||Ue.supportedEvents.indexOf(Ce.type)>-1)&&Ue.addEvent(Ce);(0,zc.S5)(`${se.type} event`,!1,{...se.payload,meta:Ce.meta})},this.getMeta=()=>({sessionId:"",userId:en.TP.user.id,userLogin:en.TP.user.login,userSignedIn:en.TP.user.isSignedIn,orgRole:en.TP.user.orgRole,orgId:en.TP.user.orgId,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...Y},setInterval(this.flush,this.config.flushInterval)}}var rf=e(42228),of=e(35383),lf=e(95536),cf=e(23040),df=e(96464),uf=e(74064),pl=e(14765);class hf{constructor(Y,se){this.locationService=Y,this.chromeService=se,this.panelId=null,Ta.A.subscribe(of.Tp,ue=>{this.panelId=ue.payload.panelId})}clearAndInitGlobalBindings(Y){pl.R.reset(),Y.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,ul.O)(!1)),this.bind("c r",()=>(0,ul.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const se=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(se&&se instanceof HTMLElement&&(se.nodeName==="INPUT"||se.nodeName==="TEXTAREA"||se.hasAttribute("data-slate-editor"))){se.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){Ta.A.publish(new za.S8({component:uf.N}))}exit(){const Y=this.locationService.getSearchObject();if(Y.editview){this.locationService.partial({editview:null,editIndex:null});return}if(Y.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(Y.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(Y.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:se}=this.chromeService.state.getValue();se&&this.chromeService.exitKioskMode(),Y.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(Y,se){pl.R.bind(Y,ue=>{ue.preventDefault(),ue.stopPropagation(),ue.returnValue=!1,se.call(this)},"keydown")}bindGlobal(Y,se){pl.R.bindGlobal(Y,ue=>{ue.preventDefault(),ue.stopPropagation(),ue.returnValue=!1,se.call(this)},"keydown")}unbind(Y,se){pl.R.unbind(Y,se)}bindWithPanelId(Y,se){this.bind(Y,this.withFocusedPanel(se))}withFocusedPanel(Y){return()=>{if(typeof this.panelId=="number"){Y(this.panelId);return}}}setupTimeRangeBindings(Y=!0){this.bind("t a",()=>{Ta.A.publish(new za.Rh({updateUrl:Y}))}),this.bind("t z",()=>{Ta.A.publish(new za.U0({scale:2,updateUrl:Y}))}),this.bind("ctrl+z",()=>{Ta.A.publish(new za.U0({scale:2,updateUrl:Y}))}),this.bind("t left",()=>{Ta.A.publish(new za.Io({direction:za.xL.Left,updateUrl:Y}))}),this.bind("t right",()=>{Ta.A.publish(new za.Io({direction:za.xL.Right,updateUrl:Y}))}),this.bind("t c",()=>{Ta.A.publish(new za.Bt)}),this.bind("t v",()=>{Ta.A.publish(new za.VZ({updateUrl:Y}))})}setupDashboardBindings(Y){this.bind("mod+o",()=>{Y.graphTooltip=(Y.graphTooltip+1)%3,Y.events.publish(new Ji.Tq),Y.startRefresh()}),this.bind("mod+s",()=>{Y.meta.canSave&&Ta.A.publish(new za.S8({component:cf.$,props:{dashboard:Y}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",se=>{if(Y.canEditPanelById(se)){const ue=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:ue?null:se})}}),this.bindWithPanelId("v",se=>{const ue=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:ue?null:se})}),this.bindWithPanelId("p l",se=>{const ue=Y.getPanelById(se),ye={...ue.options};ye.legend.showLegend?ye.legend.showLegend=!1:ye.legend.showLegend=!0,ue.updateOptions(ye)}),this.bindWithPanelId("i",se=>{this.locationService.partial({inspect:se})}),os.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async se=>{const ue=Y.getPanelById(se),ye=await(0,lf.Xe)({queries:ue.targets,dsRef:ue.datasource,scopedVars:ue.scopedVars,timeRange:(0,Zr.jG)().timeRange()});if(ye){const Ce=m.I.stripBaseFromUrl(ye);Ce&&this.locationService.push(Ce)}}),this.bindWithPanelId("p r",se=>{Y.canEditPanelById(se)&&!(Y.panelInView||Y.panelInEdit)&&Ta.A.publish(new za.Vz(se))}),this.bindWithPanelId("p d",se=>{if(Y.canEditPanelById(se)){const ue=Y.getPanelInfoById(se).index;Y.duplicatePanel(Y.panels[ue])}}),this.bindWithPanelId("p s",se=>{const ue=Y.getPanelInfoById(se);Ta.A.publish(new za.S8({component:df.Zy,props:{dashboard:Y,panel:ue?.panel}}))}),this.bind("d l",()=>{Y.toggleLegendsForAll()}),this.bind("d x",()=>{Y.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{Y.collapseRows()}),this.bind("d shift+e",()=>{Y.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{Y.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const ue=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+ue})}}var Hc=e(36314);async function D0(){if(window.location.search.indexOf("why-render")!==-1){const{default:Q}=await e.e(3718).then(e.t.bind(e,13718,23));Q(React,{trackAllPureComponents:!0})}}var ff=e(70973);const gf=(0,s.lazy)(()=>e.e(192).then(e.bind(e,51803)));function pf(){const Q=(0,jt.Wd)(Ts.hY),Y=V.$.unifiedAlertingEnabled;en.TP.hasPermission(Q.read)&&(0,ff.fP)({show:()=>Y,component:({dashboard:se})=>Y?(0,T.jsx)(s.Suspense,{fallback:null,children:se&&(0,T.jsx)(gf,{dashboardUid:se.uid})},"alert-rules-button"):null,index:-2})}var mf=e(4545);function vf(Q){return(0,T.jsx)(yf,{...Q})}const yf=(0,s.lazy)(async()=>{const{EmbeddedDashboard:Q}=await e.e(2859).then(e.bind(e,6857));return{default:Q}});var xf=e(5468),Ef=e(8845),Pf=e(75112),C0=e(7805),Zi=e(14590),Df=e(19895),Cf=e(44838);const bf=()=>new Wc.c(new URL(e.p+e.u(5358),e.b));var Tf=e(88483),_c=e(63720);const Sf=Q=>new Tf.c(Y=>{const se=Q.subscribe(Zi.BX(ue=>{Y.next(ue)}),Zi.BX(ue=>{Y.error(ue)}),Zi.BX(()=>{Y.complete()}));return{unsubscribe:()=>{se.then(ue=>ue.unsubscribe())}}}),wl=Q=>(0,nr.H)(Q).pipe((0,_c.n)(Y=>Sf(Y)));class Mf{constructor(Y){this.getConnectionState=()=>wl(this.centrifugeWorker.getConnectionState()),this.getDataStream=se=>wl(this.centrifugeWorker.getDataStream(se)).pipe((0,Df.Q)(Cf.E)),this.getQueryData=async se=>{const ue=JSON.parse(JSON.stringify(se));return this.centrifugeWorker.getQueryData(ue)},this.getPresence=se=>this.centrifugeWorker.getPresence(se),this.getStream=se=>wl(this.centrifugeWorker.getStream(se)),this.centrifugeWorker=Zi.LV(bf()),this.centrifugeWorker.initialize(Y,Zi.BX(Y.dataStreamSubscriberReadiness))}}var Gc=e(59765),Of=e(17162),If=e(23919),Qc=e(65502),ml=e(25324);class Af{constructor(Y){this.deps=Y,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=se=>{let ue;const ye=Ce=>{const Ue=Ce.data[0];if(!ue&&!(0,ml.ot)(Ue,ml._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${Ue?.type}`);return}switch(Ue.type){case ml._w.FullFrame:{ue=Gc.k9.deserialize(Ue.frame);return}case ml._w.NewValuesSameSchema:{ue.pushNewValues(Ue.values);return}}};return this.deps.centrifugeSrv.getDataStream(se).pipe((0,wn.T)(Ce=>(ye(Ce),{...Ce,data:[ue??Gc.k9.empty()]})))},this.getStream=se=>this.deps.centrifugeSrv.getStream(se),this.getQueryData=se=>(0,nr.H)(this.deps.centrifugeSrv.getQueryData(se)).pipe((0,_c.n)(ue=>{const ye=(0,If.bE)(ue,se.request.targets);return ye.data?.length&&ye.data.find(Ue=>Ue.meta?.channel)?(0,Qc.x7)(ye,se.request,Qc.ph):(0,nn.of)(ye)})),this.publish=async(se,ue)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,Of.Qp)(se),data:ue}),this.getPresence=se=>this.deps.centrifugeSrv.getPresence(se)}}function Rf(){const Q={appUrl:`${window.location.origin}${V.$.appSubUrl}`,orgId:en.TP.user.orgId,orgRole:en.TP.user.orgRole,liveEnabled:V.$.liveEnabled,dataStreamSubscriberReadiness:xf.a.ok.asObservable(),grafanaAuthToken:(0,Ef.r)()},Y=V.$.featureToggles["live-service-web-worker"]?new Mf(Q):new Pf.w(Q);(0,jl.S8)(new Af({centrifugeSrv:Y,backendSrv:(0,f.AI)()}))}function b0(){return getGrafanaLiveSrv()}var Lf=e(55514),jf=e(35884),li=e(10059),eo=e(31731),Xs=e(32056);function Bf(Q){let Y,se;return Q.addedComponentsRegistry.asObservable().subscribe(ue=>{Y=ue}),Q.addedLinksRegistry.asObservable().subscribe(ue=>{se=ue}),ue=>kc({...ue,addedComponentsRegistry:Y,addedLinksRegistry:se})}const kc=({context:Q,extensionPointId:Y,limitPerPlugin:se,addedLinksRegistry:ue,addedComponentsRegistry:ye})=>{const Ce=Q?(0,Xs.$Y)(Q):{},Ue=[],_e={};for(const rt of ue?.[Y]??[])try{const{pluginId:it}=rt;if(se&&_e[it]>=se)continue;_e[it]===void 0&&(_e[it]=0);const xt=eo.R.child({pluginId:it,extensionPointId:Y,path:rt.path??"",title:rt.title,description:rt.description??"",onClick:typeof rt.onClick}),Mt=(0,Xs.hS)(it,rt,xt,Ce);if(rt.configure&&Mt===void 0)continue;const Dt=Mt?.path||rt.path,Tt={id:(0,Xs.yt)(it,Y,rt.title),type:ii.u.link,pluginId:it,onClick:(0,Xs.dx)(it,Y,rt,xt,Ce),icon:Mt?.icon||rt.icon,title:Mt?.title||rt.title,description:Mt?.description||rt.description||"",path:(0,z.isString)(Dt)?(0,Xs.YS)(it,Dt,Y):void 0,category:Mt?.category||rt.category};Ue.push(Tt),_e[it]+=1}catch(it){it instanceof Error&&eo.R.error(it.message,{stack:it.stack??"",message:it.message})}const He=ye?.[Y]??[];for(const rt of He){if(se&&_e[rt.pluginId]>=se)continue;_e[rt.pluginId]===void 0&&(_e[rt.pluginId]=0);const it=eo.R.child({title:rt.title,description:rt.description??"",pluginId:rt.pluginId}),xt={id:(0,Xs.yt)(rt.pluginId,Y,rt.title),type:ii.u.component,pluginId:rt.pluginId,title:rt.title,description:rt.description??"",component:(0,Xs.nv)(rt.pluginId,rt.component,it)};Ue.push(xt),_e[rt.pluginId]+=1}return{extensions:Ue}};var ci=e(24120),qi=e(79748),Or=e(72690),Uf=e(16817),Nf=e(6838),Wf=e(45251);const Yc=new Set,Ff=({id:Q})=>!Yc.has(Q),Kf=Q=>Q.forEach(({id:Y})=>Yc.add(Y));async function Vl(Q=[]){const Y=Q.filter(Ff);Y.length!==0&&(Kf(Q),await Promise.all(Y.map(wf)))}async function wf(Q){try{const Y=await(0,Nf.x)(Q.id);await(0,Wf.ui)(Y)}catch(Y){console.error(`[Plugins] Failed to preload plugin: ${Q.path} (version: ${Q.version})`,Y)}}function el(Q=[]){const{loading:Y}=(0,Uf.A)(async()=>{const se=(0,Xs.uS)(Q);se.length&&await Vl(se)});return{isLoading:Y}}var Ir=e(76018);function Vf(Q){const Y=(0,ki.ZV)(),se=(0,ci.A)(Y.asObservable()),ue=(0,qi.Q)(),{isLoading:ye}=el((0,Xs.Uy)(Q));return(0,s.useMemo)(()=>{const Ce=(0,Xs.V2)()&&ue;if(ye)return{isLoading:!0,component:null};if(!se?.[Q])return{isLoading:!1,component:null};const Ue=se[Q],_e=eo.R.child({title:Ue.title,description:Ue.description??"",pluginId:Ue.pluginId});return Ce&&(0,Ir.xM)(Q,ue)?(_e.error(Or.ij),{isLoading:!1,component:null}):{isLoading:!1,component:(0,Xs.nv)(Ue.pluginId,Ue.component,_e)}},[Q,ue,se,ye])}function $f({limitPerPlugin:Q,extensionPointId:Y}){const se=(0,ki.TX)(),ue=(0,ci.A)(se.asObservable()),ye=(0,qi.Q)(),{isLoading:Ce}=el((0,Xs.Ce)(Y));return(0,s.useMemo)(()=>{const Ue=(0,Xs.V2)()&&ye,_e=[],He={},rt=ye?.meta.id??"",it=eo.R.child({pluginId:rt,extensionPointId:Y});if(Ue&&!(0,Ir.Fe)({extensionPointId:Y,pluginId:rt})&&it.error(Or.Bs),Ue&&(0,Ir.PW)(Y,ye))return it.error(Or.Ri),{isLoading:!1,components:[]};if(Ce)return{isLoading:!0,components:[]};for(const xt of ue?.[Y]??[]){const{pluginId:Mt}=xt;if(Q&&He[Mt]>=Q)continue;He[Mt]===void 0&&(He[Mt]=0);const Dt=zf(xt,Y);_e.push(Dt),He[Mt]+=1}return{isLoading:!1,components:_e}},[Y,Q,ye,ue,Ce])}function zf(Q,Y){const{component:se,...ue}=Q;function ye(Ce){return(0,T.jsx)(se,{...Ce})}return ye.displayName=se.displayName,ye.defaultProps=se.defaultProps,ye.propTypes=se.propTypes,ye.contextTypes=se.contextTypes,ye.meta={pluginId:ue.pluginId,title:ue.title??"",description:ue.description??"",id:(0,Xs.yt)(ue.pluginId,Y,ue.title),type:ii.u.component},ye}function Hf(Q){const Y=Q.addedComponentsRegistry.asObservable(),se=Q.addedLinksRegistry.asObservable();return function(ye){const Ce=(0,qi.Q)(),Ue=(0,ci.A)(Y),_e=(0,ci.A)(se),{extensionPointId:He,context:rt,limitPerPlugin:it}=ye,{isLoading:xt}=el((0,Xs.Ce)(He));return(0,s.useMemo)(()=>{const Mt=(0,Xs.V2)()&&Ce!==null,Dt=Ce?.meta.id??"",Tt=eo.R.child({pluginId:Dt,extensionPointId:He});if(!_e&&!Ue)return{extensions:[],isLoading:!1};if(Mt&&!(0,Ir.Fe)({extensionPointId:He,pluginId:Dt}))return Tt.error(Or.Bs),{isLoading:!1,extensions:[]};if(Mt&&(0,Ir.PW)(He,Ce))return Tt.error(Or.Ri),{isLoading:!1,extensions:[]};if(xt)return{isLoading:!0,extensions:[]};const{extensions:wt}=kc({extensionPointId:He,context:rt,limitPerPlugin:it,addedComponentsRegistry:Ue,addedLinksRegistry:_e});return{extensions:wt,isLoading:!1}},[_e,Ue,He,rt,it,Ce,xt])}}function _f({limitPerPlugin:Q,extensionPointId:Y}){const se=(0,ki.ov)(),ue=(0,ci.A)(se.asObservable()),ye=(0,qi.Q)(),Ce=(0,Xs.Ce)(Y),{isLoading:Ue}=el(Ce);return(0,s.useMemo)(()=>{const _e=(0,Xs.V2)()&&ye,He=[],rt={},it=ye?.meta.id??"",xt=eo.R.child({pluginId:it,extensionPointId:Y});if(_e&&!(0,Ir.Fe)({extensionPointId:Y,pluginId:it})&&xt.error(Or.Bs),_e&&(0,Ir.PW)(Y,ye))return xt.error(Or.Ri),{isLoading:!1,functions:[]};if(Ue)return{isLoading:!0,functions:[]};for(const Mt of ue?.[Y]??[]){const{pluginId:Dt}=Mt;Q&&rt[Dt]>=Q||(rt[Dt]===void 0&&(rt[Dt]=0),He.push({id:(0,Xs.yt)(Dt,Y,Mt.title),type:ii.u.function,title:Mt.title,description:Mt.description??"",pluginId:Dt,fn:Mt.fn}),rt[Dt]+=1)}return{isLoading:!1,functions:He}},[Y,Q,ye,ue,Ue])}function Gf({limitPerPlugin:Q,extensionPointId:Y,context:se}){const ue=(0,ki.OG)(),ye=(0,qi.Q)(),Ce=(0,ci.A)(ue.asObservable()),{isLoading:Ue}=el((0,Xs.Ce)(Y));return(0,s.useMemo)(()=>{const _e=(0,Xs.V2)()&&ye!==null,He=ye?.meta.id??"",rt=eo.R.child({pluginId:He,extensionPointId:Y});if(_e&&!(0,Ir.Fe)({extensionPointId:Y,pluginId:He}))return rt.error(Or.Bs),{isLoading:!1,links:[]};if(_e&&(0,Ir.PW)(Y,ye))return rt.error(Or.Ri),{isLoading:!1,links:[]};if(Ue)return{isLoading:!0,links:[]};if(!Ce||!Ce[Y])return{isLoading:!1,links:[]};const it=se?(0,Xs.$Y)(se):{},xt=[],Mt={};for(const Dt of Ce[Y]??[]){const{pluginId:Tt}=Dt,wt=rt.child({path:Dt.path??"",title:Dt.title,description:Dt.description??"",onClick:typeof Dt.onClick});if(Q&&Mt[Tt]>=Q){wt.debug(`Skipping link extension from plugin "${Tt}". Reason: Limit reached.`);continue}Mt[Tt]===void 0&&(Mt[Tt]=0);const sn=(0,Xs.hS)(Tt,Dt,wt,it);if(Dt.configure&&sn===void 0)continue;const Rn=sn?.path||Dt.path,$n={id:(0,Xs.yt)(Tt,Y,Dt.title),type:ii.u.link,pluginId:Tt,onClick:(0,Xs.dx)(Tt,Y,Dt,wt,it),icon:sn?.icon||Dt.icon,title:sn?.title||Dt.title,description:sn?.description||Dt.description||"",path:(0,z.isString)(Rn)?(0,Xs.YS)(Tt,Rn,Y):void 0,category:sn?.category||Dt.category};xt.push($n),Mt[Tt]+=1}return{isLoading:!1,links:xt}},[se,Y,Q,Ce,ye,Ue])}var Jc=e(43956),Qf=e(39741),kf=e(57532),Xc=e(16753),Zc=e(59577),Yf=e(16442),Jf=e(29341),$l=e(23234);class Xf{constructor(){this.subject=new Qf.m(1)}get(){return this.subject.asObservable()}run(Y){const{queries:se,timezone:ue,datasource:ye,panelId:Ce,app:Ue,dashboardUID:_e,timeRange:He,timeInfo:rt,cacheTimeout:it,queryCachingTTL:xt,maxDataPoints:Mt,scopedVars:Dt,minInterval:Tt}=Y;this.subscription&&this.subscription.unsubscribe();const wt={app:Ue??Xc.Jk.Unknown,requestId:(0,Yf.S)(),timezone:ue,panelId:Ce,dashboardUID:_e,range:He,timeInfo:rt,interval:"",intervalMs:0,targets:(0,z.cloneDeep)(se),maxDataPoints:Mt,scopedVars:Dt||{},cacheTimeout:it,queryCachingTTL:xt,startTime:Date.now()};wt.rangeRaw=He.raw,(0,nr.H)(Zf(ye,wt.scopedVars)).pipe((0,kf.$)()).subscribe({next:sn=>{wt.targets=wt.targets.map(rs=>(rs.datasource||(rs.datasource=sn.getRef()),rs));const Rn=Tt?(0,bn.w)().replace(Tt,wt.scopedVars):sn.interval,$n=Zc.calculateInterval(He,Mt,Rn);wt.scopedVars=Object.assign({},wt.scopedVars,{__interval:{text:$n.interval,value:$n.interval},__interval_ms:{text:$n.intervalMs.toString(),value:$n.intervalMs}}),wt.interval=$n.interval,wt.intervalMs=$n.intervalMs,this.subscription=(0,$l.BN)(sn,wt).subscribe({next:rs=>{const kn=(0,tr.N$)(rs,this.lastResult);this.lastResult=(0,Jf.B)(kn,this.lastResult),this.subject.next(this.lastResult)}})},error:sn=>console.error("PanelQueryRunner Error",sn)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===We.Gu.Loading&&this.subject.next({...this.lastResult,state:We.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function Zf(Q,Y){return Q&&"query"in Q?Q:(0,li.tR)().get(Q,Y)}function qf(){window.grafanaRuntime={getDashboardSaveModel:()=>{const Q=(0,Ll.UA)().getCurrent();if(Q)return Q.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const Q=(0,Zr.jG)().timeRange();return{from:Q.from.valueOf(),to:Q.to.valueOf(),raw:Q.raw}},getPanelData:()=>{const Q=(0,Ll.UA)().getCurrent();if(Q)return Q.panels.reduce((Y,se)=>(Y[se.id]=se.getQueryRunner().getLastResult(),Y),{})}}}var eg=e(10867),tl=e(19639),ss=e(2510),qc=e(61809),tg=e(79961),Ar=e(5353);function ed(Q){return Q.extended&&"infoText"in Q.extended?Q.extended:null}function td(Q){return Q.extended&&"dataSourceTypes"in Q.extended?Q.extended:null}function zl(Q){return Q.extended&&"dataSource"in Q.extended?Q.extended:null}var ws=e(58843),nl=e(34394);const ng=(Q,Y)=>{const{rootStateKey:se}=Y.variable;if(!se)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:ed(Ar.nS)};const{editor:ue}=(0,ws.nx)(se,Q);return{extended:ed(ue)}},sg={changeVariableDatasource:nl.Iv},ag=(0,Ja.connect)(ng,sg);class rg extends s.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=Y=>{this.props.changeVariableDatasource((0,ss.jX)(this.props.variable),(0,qc.p$)(Y))}}componentDidMount(){const{rootStateKey:Y}=this.props.variable;if(!Y){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:Y,extended:se}=this.props;return(0,T.jsx)(tg.Q,{datasource:Y.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:se?.infoText})}}const og=ag(rg);var nd=e(67692),Hl=e(80762);const sd=90,ad=({datasource:Q,onChange:Y,disabled:se,filterKey:ue,allFilters:ye})=>{const Ce=()=>rd(Q,ue,ye),Ue=()=>cg(Q,ue,ye);return ue===null?(0,T.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,T.jsx)(Hl.s,{disabled:se,className:"query-segment-key",Component:lg,value:ue,onChange:Y,loadOptions:Ce,inputMinWidth:sd})}):(0,T.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,T.jsx)(Hl.s,{disabled:se,className:"query-segment-key",value:ue,onChange:Y,loadOptions:Ue,inputMinWidth:sd})})},vl="-- remove filter --",ig={label:vl,value:vl},lg=(0,T.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,T.jsx)(vt.I,{name:"plus"})}),rd=async(Q,Y,se)=>{const ue=await(0,li.tR)().get(Q);if(!ue||!ue.getTagKeys)return[];const ye=se.filter(_e=>_e.key!==Y),Ce=await ue.getTagKeys({filters:ye});return(Array.isArray(Ce)?Ce:Ce.data).map(_e=>({label:_e.text,value:_e.text}))},cg=async(Q,Y,se)=>{const ue=await rd(Q,Y,se);return[ig,...ue]},dg=({datasource:Q,disabled:Y,onChange:se,filterKey:ue,filterValue:ye,placeHolder:Ce,allFilters:Ue})=>{const _e=(0,at.of)(hg),He=()=>ug(Q,ue,Ue);return(0,T.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,T.jsx)(Hl.s,{className:_e.segment,disabled:Y,placeholder:Ce,value:ye,onChange:se,loadOptions:He})})},ug=async(Q,Y,se)=>{const ue=await(0,li.tR)().get(Q);if(!ue||!ue.getTagValues)return[];const ye=(0,Zr.jG)().timeRange(),Ce=se.filter(He=>He.key!==Y),Ue=await ue.getTagValues({key:Y,filters:Ce,timeRange:ye});return(Array.isArray(Ue)?Ue:Ue.data).map(He=>({label:He.text,value:He.text}))};function hg(){return{segment:(0,Re.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const fg=["=","!=","<",">","=~","!~"].map(Q=>({label:Q,value:Q})),gg=({value:Q,disabled:Y,onChange:se})=>(0,T.jsx)(nd.Y,{className:"query-segment-operator",value:Q,disabled:Y,options:fg,onChange:se}),od=({datasource:Q,filter:{key:Y,operator:se,value:ue},onKeyChange:ye,onOperatorChange:Ce,onValueChange:Ue,placeHolder:_e,allFilters:He,disabled:rt})=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ad,{disabled:rt,datasource:Q,filterKey:Y,onChange:ye,allFilters:He}),(0,T.jsx)("div",{className:"gf-form",children:(0,T.jsx)(gg,{disabled:rt,value:se,onChange:Ce})}),(0,T.jsx)(dg,{disabled:rt,datasource:Q,filterKey:Y,filterValue:ue,allFilters:He,onChange:Ue,placeHolder:_e})]}),pg=({datasource:Q,appendBefore:Y,onCompleted:se,allFilters:ue})=>{const[ye,Ce]=(0,s.useState)(null),[Ue,_e]=(0,s.useState)("="),He=(0,s.useCallback)(xt=>{if(xt.value!==vl){Ce(xt.value??"");return}Ce(null)},[Ce]),rt=(0,s.useCallback)(xt=>_e(xt.value??""),[_e]),it=(0,s.useCallback)(xt=>{se({value:xt.value??"",operator:Ue,key:ye}),Ce(null),_e("=")},[se,Ue,ye]);return ye===null?(0,T.jsx)(ad,{datasource:Q,filterKey:ye,onChange:He,allFilters:ue}):(0,T.jsxs)(s.Fragment,{children:[Y,(0,T.jsx)(od,{datasource:Q,filter:{key:ye,value:"",operator:Ue},placeHolder:(0,Bn.t)("variable.adhoc.placeholder","Select value"),onKeyChange:He,onOperatorChange:rt,onValueChange:it,allFilters:ue})]},"filter-builder")},id=({label:Q})=>(0,T.jsx)("div",{className:"gf-form",children:(0,T.jsx)("span",{className:"gf-form-label query-keyword",children:Q})});class mg extends s.PureComponent{constructor(){super(...arguments),this.onChange=(Y,se)=>ue=>{const{filters:ye}=this.props,{value:Ce}=ue;return ue.value===vl?this.props.removeFilter(Y):this.props.changeFilter(Y,{...ye[Y],[se]:Ce})},this.appendFilterToVariable=Y=>{this.props.addFilter(Y)}}render(){const{filters:Y,disabled:se}=this.props;return(0,T.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(Y,se),!se&&(0,T.jsx)(pg,{datasource:this.props.datasource,appendBefore:Y.length>0?(0,T.jsx)(id,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(Y,se){return Y.length===0&&se?(0,T.jsx)(nd.Y,{disabled:se,value:"No filters",options:[],onChange:()=>{}}):Y.reduce((ue,ye,Ce)=>(ue.length>0&&ue.push((0,T.jsx)(id,{label:"AND"},`condition-${Ce}`)),ue.push(this.renderFilterSegments(ye,Ce,se)),ue),[])}renderFilterSegments(Y,se,ue){return(0,T.jsx)(s.Fragment,{children:(0,T.jsx)(od,{disabled:ue,datasource:this.props.datasource,filter:Y,onKeyChange:this.onChange(se,"key"),onOperatorChange:this.onChange(se,"operator"),onValueChange:this.onChange(se,"value"),allFilters:this.getAllFilters()})},`filter-${se}`)}}const vg={addFilter:nl.U2,removeFilter:nl.VT,changeFilter:nl.$u},yg=(0,Ja.connect)(null,vg);class xg extends s.PureComponent{constructor(){super(...arguments),this.addFilter=Y=>{this.props.addFilter((0,ss.jX)(this.props.variable),Y)},this.removeFilter=Y=>{this.props.removeFilter((0,ss.jX)(this.props.variable),Y)},this.changeFilter=(Y,se)=>{this.props.changeFilter((0,ss.jX)(this.props.variable),{index:Y,filter:se})}}render(){const{filters:Y,datasource:se,baseFilters:ue}=this.props.variable;return(0,T.jsx)(mg,{datasource:se,filters:Y,baseFilters:ue,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const ld=yg(xg);ld.displayName="AdHocPicker";var cd=e(3485);const Eg=Q=>Q.map(Y=>bg(Y).map(Dg).join("|")),Pg=Q=>{if((0,z.isArray)(Q))return Q.map(dd).filter(Tg);const Y=dd(Q);return Y===null?[]:[Y]};function Dg(Q){return Q==null?"":/\|/g[Symbol.replace](Q,"__gfp__")}function Cg(Q){return Q==null?"":/__gfp__/g[Symbol.replace](Q,"|")}function bg(Q){return[Q.key,Q.operator,Q.value]}function dd(Q){if(!(0,z.isString)(Q)||Q.length===0)return null;const Y=Q.split("|").map(Cg);return{key:Y[0],operator:Y[1],value:Y[2]}}function Tg(Q){return Q!==null&&(0,z.isString)(Q.value)}const ud=async()=>{},Sg=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:cd.MK,reducer:cd.AA,picker:ld,editor:og,dependsOn:()=>!1,setValue:ud,setValueFromUrl:async(Q,Y)=>{const se=Pg(Y);await(0,ta.JD)((0,nl.D4)((0,ss.jX)(Q),se))},updateOptions:ud,getSaveModel:Q=>{const{index:Y,id:se,state:ue,global:ye,rootStateKey:Ce,...Ue}=(0,z.cloneDeep)(Q);return Ue},getValueForUrl:Q=>{const Y=Q?.filters??[];return Eg(Y)}});var _l=e(14644),Mg=e(77576),Ba=e(44690),Aa=e(21658),Gl=e(13752),hd=e(13288),Og=e(44240),yl=e(16126),Ig=e(38975),Ag=e(67791),Rg=e(66847),Lg=e(69850),jg=e(24726),ya=e(20138),Hs=e(5636),Rr=e(65307),bo=e(14964),sl=e(64744),di=e(76802);const Bg={...di.Vg,type:"query",datasource:null,query:"",regex:"",sort:bo.ZG.disabled,refresh:bo.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},Ug=(Q,Y)=>{if(Y===bo.ZG.disabled)return Q;const se=Math.ceil(Y/2),ue=Y%2===0;return se===1?Q=(0,z.sortBy)(Q,"text"):se===2?Q=(0,z.sortBy)(Q,ye=>{if(!ye.text)return-1;const Ce=ye.text.match(/.*?(\d+).*/);return!Ce||Ce.length<2?-1:parseInt(Ce[1],10)}):se===3?Q=(0,z.sortBy)(Q,ye=>(0,z.toLower)(ye.text)):se===4&&Q.sort((ye,Ce)=>ye.text?Ce.text?ye.text.localeCompare(Ce.text,void 0,{numeric:!0}):1:-1),ue&&(Q=Q.reverse()),Q},Ng=(Q,Y)=>{const se=[];let ue=null;Y.lastIndex=0;do ue=Y.exec(Q),ue&&se.push(ue);while(Y.global&&ue&&ue[0]!==""&&ue[0]!==void 0);return se},Wg=(Q,Y,se)=>{let ue,ye=[];Q&&(ue=(0,hs.dO)(Q));for(let Ce=0;Ce<se.length;Ce++){const Ue=se[Ce];let _e=Ue.text===void 0||Ue.text===null?Ue.value:Ue.text,He=Ue.value===void 0||Ue.value===null?Ue.text:Ue.value;if((0,z.isNumber)(He)&&(He=He.toString()),(0,z.isNumber)(_e)&&(_e=_e.toString()),ue){const rt=Ng(He,ue);if(!rt.length)continue;const it=rt.find(Tt=>Tt.groups&&Tt.groups.value),xt=rt.find(Tt=>Tt.groups&&Tt.groups.text),Mt=rt.find(Tt=>Tt.length>1),Dt=rt.length>1&&Mt;if(it||xt)He=it?.groups?.value??xt?.groups?.text,_e=xt?.groups?.text??it?.groups?.value;else if(Dt){for(let Tt=0;Tt<rt.length;Tt++){const wt=rt[Tt];ye.push({text:wt[1],value:wt[1],selected:!1})}continue}else Mt&&(_e=Mt[1],He=Mt[1])}ye.push({text:_e,value:He,selected:!1})}return ye=(0,z.uniqBy)(ye,"value"),Ug(ye,Y)},fd=(0,Rr.Z0)({name:"templating/query",initialState:sl.j,reducers:{updateVariableOptions:(Q,Y)=>{const{results:se,templatedRegex:ue}=Y.payload.data,ye=(0,ws.Fs)(Q,Y.payload.id);if(ye.type!=="query")return;const{includeAll:Ce,sort:Ue}=ye,_e=Wg(ue,Ue,se);Ce&&_e.unshift({text:Ba.Zm,value:Ba.To,selected:!1}),_e.length||_e.push({text:Ba.ou,value:Ba.Ek,isNone:!0,selected:!1}),ye.options=_e}}}),Fg=fd.reducer,{updateVariableOptions:Kg}=fd.actions;function wg(){return Q=>Q.pipe((0,wn.T)(Vg))}function Vg(Q){const Y=Q.series;if(!Y||!Y.length)return[];if(Hg(Y))return Y;const se=(0,tr.Bt)(Y),ue=[];let ye=-1,Ce=-1,Ue=-1,_e=-1;for(const He of se)for(let rt=0;rt<He.fields.length;rt++){const it=He.fields[rt],xt=(0,X.Ct)(it,He,Y).toLowerCase();it.type===w.PU.string&&Ue===-1&&(Ue=rt),xt==="text"&&it.type===w.PU.string&&Ce===-1&&(Ce=rt),xt==="value"&&it.type===w.PU.string&&ye===-1&&(ye=rt),xt==="expandable"&&(it.type===w.PU.boolean||it.type===w.PU.number)&&_e===-1&&(_e=rt)}if(Ue===-1)throw new Error("Couldn't find any field of type string in the results.");for(const He of se)for(let rt=0;rt<He.length;rt++){const it=_e!==-1?He.fields[_e].values[rt]:void 0,xt=He.fields[Ue].values[rt],Mt=Ce!==-1?He.fields[Ce].values[rt]:null,Dt=ye!==-1?He.fields[ye].values[rt]:null;if(ye===-1&&Ce===-1){ue.push({text:xt,value:xt,expandable:it});continue}if(ye===-1&&Ce!==-1){ue.push({text:Mt,value:Mt,expandable:it});continue}if(ye!==-1&&Ce===-1){ue.push({text:Dt,value:Dt,expandable:it});continue}ue.push({text:Mt,value:Dt,expandable:it})}return ue}function $g(Q){return Y=>Y.pipe((0,wn.T)(se=>{const{variable:ue,dispatch:ye,getTemplatedRegexFunc:Ce}=Q;if(!ue.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const Ue=Ce(ue),_e=(0,ss.qD)(ue,{results:se,templatedRegex:Ue});ye((0,Hs.kb)(ue.rootStateKey,Kg(_e)))}))}function zg(Q){return Y=>Y.pipe((0,mr.Z)(()=>{const{dispatch:se,variable:ue,searchFilter:ye}=Q;return ye?(0,nn.of)():(0,nr.H)(se((0,ya.kl)((0,ss.jX)(ue))))}))}function Hg(Q){if(!Q)return!1;if(!Q.length)return!0;const Y=Q[0];if((0,tr.ci)(Y))return!1;for(const se in Y){if(!Y.hasOwnProperty(se)||Y[se]!==null&&typeof Y[se]!="string"&&typeof Y[se]!="number")continue;const ue=se.toLowerCase();if(ue==="text"||ue==="value")return!0}return!1}var xl=e(50471),_g=e(55801);class Gg{constructor(){this.runners=[new Qg,new kg,new Yg,new Xg]}getRunnerForDatasource(Y){const se=this.runners.find(ue=>ue.canRun(Y));if(se)return se;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(Y){return this.runners.some(se=>se.canRun(Y))}}class Qg{constructor(){this.type=xl.Qz.Legacy}canRun(Y){return(0,Aa.d5)(Y)}getTarget({datasource:Y,variable:se}){if((0,Aa.d5)(Y))return se.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,variable:se,searchFilter:ue,timeSrv:ye},Ce){if(!(0,Aa.d5)(Y))return al();const Ue=(0,ss.iP)(se,ue,ye,Ce.scopedVars);return(0,nr.H)(Y.metricFindQuery(se.query,Ue)).pipe((0,mr.Z)(_e=>{if(!_e||!_e.length)return al();const He=_e;return(0,nn.of)({series:He,state:We.Gu.Done,timeRange:Ue.range})}))}}class kg{constructor(){this.type=xl.Qz.Standard}canRun(Y){return(0,Aa.Hf)(Y)}getTarget({datasource:Y,variable:se}){if((0,Aa.Hf)(Y))return Y.variables.toDataQuery(se.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,runRequest:se},ue){return(0,Aa.Hf)(Y)?Y.variables.query?se(Y,ue,Y.variables.query.bind(Y.variables)):se(Y,ue):al()}}class Yg{constructor(){this.type=xl.Qz.Custom}canRun(Y){return(0,Aa.zs)(Y)}getTarget({datasource:Y,variable:se}){if((0,Aa.zs)(Y))return se.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,runRequest:se},ue){return(0,Aa.zs)(Y)?se(Y,ue,Y.variables.query.bind(Y.variables)):al()}}const Jg="variable-query";class Xg{constructor(){this.type=xl.Qz.Datasource}canRun(Y){return(0,Aa.X3)(Y)}getTarget({datasource:Y,variable:se}){if((0,Aa.X3)(Y))return{...se.query,refId:se.query.refId??Jg};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:Y,runRequest:se},ue){return(0,Aa.X3)(Y)?se(Y,ue):al()}}function al(){return(0,nn.of)({state:We.Gu.Done,series:[],timeRange:(0,_g.E2)()})}class Zg{constructor(Y={dispatch:ta.JD,getState:ta.Gu,getVariable:ws.dn,getTemplatedRegex:ss.u7,getTimeSrv:Zr.jG,queryRunners:new Gg,runRequest:$l.BN}){this.dependencies=Y,this.updateOptionsRequests=new Gl.B,this.updateOptionsResults=new Gl.B,this.cancelRequests=new Gl.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(Y){this.updateOptionsRequests.next(Y)}getResponse(Y){return this.updateOptionsResults.asObservable().pipe((0,yl.p)(se=>se.identifier===Y))}cancelRequest(Y){this.cancelRequests.next({identifier:Y})}destroy(){this.subscription.unsubscribe()}onNewRequest(Y){const{datasource:se,identifier:ue,searchFilter:ye}=Y;try{const{dispatch:Ce,runRequest:Ue,getTemplatedRegex:_e,getVariable:He,queryRunners:rt,getTimeSrv:it,getState:xt}=this.dependencies,Mt=(0,ws.y7)(xt());this.updateOptionsResults.next({identifier:ue,state:We.Gu.Loading});const Dt=He(ue,xt());if(Dt.type!=="query")return;const Tt=it(),wt={variable:Dt,datasource:se,searchFilter:ye,timeSrv:Tt,runRequest:Ue};if(!rt.isQueryRunnerAvailableForDatasource(se)){const rs=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:ue,state:We.Gu.Error,error:rs});return}const sn=rt.getRunnerForDatasource(se),Rn=sn.getTarget({datasource:se,variable:Dt}),$n=this.getRequest(Dt,Y,Rn);sn.runRequest(wt,$n).pipe((0,yl.p)(()=>{const rs=(0,ws.y7)(xt());return Mt===rs}),(0,yl.p)(rs=>rs.state===We.Gu.Done||rs.state===We.Gu.Error),(0,Ig.s)(1),(0,mr.Z)(rs=>rs.state===We.Gu.Error?(0,hd.$)(()=>rs.error):(0,nn.of)(rs)),wg(),$g({variable:Dt,dispatch:Ce,getTemplatedRegexFunc:_e}),zg({variable:Dt,dispatch:Ce,searchFilter:ye}),(0,Ag.Q)((0,Og.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,yl.p)(rs=>{let kn=!1;return rs.identifier.id===ue.id&&(kn=!0,this.updateOptionsResults.next({identifier:ue,state:We.Gu.Loading,cancelled:kn})),kn}))),(0,Rg.W)(rs=>rs.cancelled?(0,nn.of)({}):(this.updateOptionsResults.next({identifier:ue,state:We.Gu.Error,error:rs}),(0,hd.$)(()=>rs))),(0,Lg.j)(()=>{this.updateOptionsResults.next({identifier:ue,state:We.Gu.Done})})).subscribe()}catch(Ce){this.updateOptionsResults.next({identifier:ue,state:We.Gu.Error,error:Ce})}}getRequest(Y,se,ue){const{searchFilter:ye}=se,Ce={variable:{text:Y.current.text,value:Y.current.value}},He={...ye?{searchFilter:{text:ye,value:ye}}:{},...Ce},rt=this.dependencies.getTimeSrv().timeRange();return{app:Xc.Jk.Dashboard,requestId:(0,jg.A)(),timezone:"",range:rt,interval:"",intervalMs:0,targets:[ue],scopedVars:He,startTime:Date.now()}}}let gd;function qg(Q){gd=Q}function Ql(){return gd}const ep=Q=>{if(!tp(Q))return Q.name;const{current:Y}=Q;return Array.isArray(Y.text)?Y.text.join(" + "):Y.text},tp=Q=>Array.isArray(Q?.options)||typeof Q?.current=="object";var to=(Q=>(Q[Q.moveUp=38]="moveUp",Q[Q.moveDown=40]="moveDown",Q[Q.select=32]="select",Q[Q.cancel=27]="cancel",Q[Q.selectAndClose=13]="selectAndClose",Q))(to||{});class np extends s.PureComponent{constructor(){super(...arguments),this.onKeyDown=Y=>{if(to[Y.keyCode]&&Y.keyCode!==to.select){const se=Y.ctrlKey||Y.metaKey||Y.shiftKey;this.props.onNavigate(Y.keyCode,se),Y.preventDefault()}},this.onChange=Y=>{this.props.onChange(Y.target.value)}}render(){const{value:Y,id:se,onNavigate:ue,...ye}=this.props;return(0,T.jsx)("input",{...ye,ref:Ce=>{Ce&&(Ce.focus(),Ce.setAttribute("style",`width:${Math.max(Ce.width,150)}px`))},id:se,type:"text",className:"gf-form-input",value:Y??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,Bn.t)("variable.dropdown.placeholder","Enter variable value")})}}var sp=e(28065),ap=e(29272);const rp=({loading:Q,disabled:Y,onClick:se,text:ue,onCancel:ye,id:Ce})=>{const Ue=(0,at.of)(md),_e=(0,s.useCallback)(He=>{He.stopPropagation(),He.preventDefault(),se()},[se]);return Q?(0,T.jsxs)("div",{className:Ue.container,"data-testid":da.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${ue}`),title:ue,id:Ce,children:[(0,T.jsx)(pd,{text:ue}),(0,T.jsx)(sp.I,{loading:!0,onCancel:ye})]}):(0,T.jsxs)("button",{onClick:_e,className:Ue.container,"data-testid":da.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${ue}`),"aria-expanded":!1,"aria-controls":`options-${Ce}`,id:Ce,title:ue,disabled:Y,children:[(0,T.jsx)(pd,{text:ue}),(0,T.jsx)(vt.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},pd=({text:Q})=>{const Y=(0,at.of)(md);return(0,T.jsx)("span",{className:Y.textAndTags,children:Q===Ba.Zm?(0,Bn.t)("variable.picker.link-all","All"):Q})},md=Q=>{const Y=(0,ap.$)(Q);return{container:(0,Re.css)({maxWidth:"500px",paddingRight:"10px",padding:Q.spacing(0,1),backgroundColor:Q.components.input.background,border:`1px solid ${Q.components.input.borderColor}`,borderRadius:Q.shape.radius.default,display:"flex",alignItems:"center",color:Q.colors.text.primary,height:Q.spacing(Q.components.height.md),[`.${Y.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:Q.colors.action.disabledBackground,color:Q.colors.action.disabledText,border:`1px solid ${Q.colors.action.disabledBackground}`}}),textAndTags:(0,Re.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:Q.spacing(.25),userSelect:"none"})}};class op extends s.PureComponent{constructor(){super(...arguments),this.onToggle=Y=>se=>{const ue=se.shiftKey||se.ctrlKey||se.metaKey;this.handleEvent(se),this.props.onToggle(Y,ue)},this.onToggleAll=Y=>{this.handleEvent(Y),this.props.onToggleAll()}}handleEvent(Y){Y.preventDefault(),Y.stopPropagation()}render(){const{multi:Y,values:se,highlightIndex:ue,selectedValues:ye,onToggle:Ce,onToggleAll:Ue,theme:_e,...He}=this.props,rt=kl(_e);return(0,T.jsx)("div",{className:rt.variableValueDropdown,children:(0,T.jsx)("div",{className:rt.variableOptionsWrapper,children:(0,T.jsxs)("ul",{className:rt.variableOptionsColumn,"aria-label":da.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...He,children:[this.renderMultiToggle(),se.map((it,xt)=>this.renderOption(it,xt))]})})})}renderOption(Y,se){const{highlightIndex:ue,multi:ye,theme:Ce}=this.props,Ue=kl(Ce),_e=Y.value===Ba.To;return(0,T.jsx)("li",{children:(0,T.jsxs)("button",{"data-testid":da.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":Y.selected,className:(0,Re.cx)((0,ae.my)(Ce),Ue.variableOption,{[Ue.highlighted]:se===ue,[Ue.variableAllOption]:_e},Ue.noStyledButton),onClick:this.onToggle(Y),children:[(0,T.jsx)("span",{className:(0,Re.cx)(Ue.variableOptionIcon,{[Ue.variableOptionIconSelected]:Y.selected,[Ue.hideVariableOptionIcon]:!ye})}),(0,T.jsx)("span",{"data-testid":da.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${Y.text}`),children:_e?(0,Bn.t)("variable.picker.option-all","All"):Y.text})]})},`${Y.value}`)}renderMultiToggle(){const{multi:Y,selectedValues:se,theme:ue,values:ye}=this.props,Ce=kl(ue),Ue=ye.some(He=>He.value===Ba.To);if(!Y)return null;const _e=()=>(0,T.jsx)(Bn.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,T.jsx)(is.m,{content:_e,placement:"top",children:(0,T.jsxs)("button",{className:(0,Re.cx)((0,ae.my)(ue),Ce.variableOption,Ce.variableOptionColumnHeader,Ce.noStyledButton,{[Ce.noPaddingBotton]:Ue}),role:"checkbox","aria-checked":se.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top",children:[(0,T.jsx)("span",{className:(0,Re.cx)(Ce.variableOptionIcon,{[Ce.variableOptionIconManySelected]:se.length>1})}),(0,T.jsx)(Bn.x6,{i18nKey:"variable.picker.option-selected-values",children:"Selected"})," (",se.length,")"]})})}}const kl=(0,oc.N)(Q=>{const Y=Q.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,Re.css)({display:"none"}),highlighted:(0,Re.css)({backgroundColor:Q.colors.action.hover}),noStyledButton:(0,Re.css)({width:"100%",textAlign:"left"}),variableOption:(0,Re.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:Q.colors.action.hover}}),variableOptionColumnHeader:(0,Re.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,Re.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${Y}) left top no-repeat`}),variableOptionIconManySelected:(0,Re.css)({background:`url(${Y}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,Re.css)({background:`url(${Y}) 0px -18px no-repeat`}),variableValueDropdown:(0,Re.css)({backgroundColor:Q.colors.background.primary,border:`1px solid ${Q.colors.border.weak}`,borderRadius:Q.shape.borderRadius(2),boxShadow:Q.shadows.z2,position:"absolute",top:Q.spacing(Q.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:Q.zIndex.typeahead}),variableOptionsColumn:(0,Re.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,Re.css)({display:"table",width:"100%"}),variableAllOption:(0,Re.css)({borderBottom:`1px solid ${Q.colors.border.weak}`,paddingBottom:Q.spacing(1)}),noPaddingBotton:(0,Re.css)({paddingBottom:0})}}),ip=(0,at.cV)(op);var lp=e(34227),vd=e(34923),no=e(30990),or=e(74716);const cp=(Q,Y,se)=>async(ue,ye)=>{if(Y===to.cancel)return await ue(El(Q));if(Y===to.select)return ue(Yl(Q,se));if(Y===to.selectAndClose)return(0,ws.nx)(Q,ye()).optionsPicker.multi?ue(Yl(Q,se)):(ue(Yl(Q,se,!0)),ue(El(Q)));if(Y===to.moveDown)return ue((0,Hs.kb)(Q,(0,or.O$)(1)));if(Y===to.moveUp)return ue((0,Hs.kb)(Q,(0,or.O$)(-1)))},dp=(Q,Y="")=>async(se,ue)=>{const{rootStateKey:ye}=Q,{id:Ce,queryValue:Ue}=(0,ws.nx)(ye,ue()).optionsPicker,_e={id:Ce,rootStateKey:ye,type:"query"},He=(0,ws.dn)(_e,ue());if(!("options"in He)||(se((0,Hs.kb)(ye,(0,or.S8)(Y))),(0,z.trim)(Ue)===(0,z.trim)(Y)))return;const{query:rt,options:it}=He,xt=typeof rt=="string"?rt:rt.target;return(0,lp.E)(xt)?gp(se,ue,Y,ye):se((0,Hs.kb)(ye,(0,or.fx)(it)))},up=async Q=>{if((0,vd.R)(Q.current))return;await tl.B.get(Q.type).setValue(Q,Q.current,!0)},El=(Q,Y)=>async(se,ue)=>{const ye=(0,ws.nx)(Q,ue()).optionsPicker,Ce={id:ye.id,rootStateKey:Q,type:"query"},Ue=(0,ws.dn)(Ce,ue());if(!(0,Aa.SP)(Ue))return;const _e={option:pp(ye)},He={propName:"queryValue",propValue:ye.queryValue};se((0,Hs.kb)(Q,(0,no.dE)((0,ss.qD)(Ue,_e)))),se((0,Hs.kb)(Q,(0,no.QP)((0,ss.qD)(Ue,He))));const rt=(0,ws.dn)(Ce,ue());if((0,Aa.SP)(rt)&&(se((0,Hs.kb)(Q,(0,or.Fu)())),(0,ss.Lz)(Ue)!==(0,ss.Lz)(rt)))return Y?Y(rt):await up(rt)},hp=(Q,Y)=>async(se,ue)=>{const{id:ye,rootStateKey:Ce}=Q,Ue=(0,ws.nx)(Ce,ue()).optionsPicker;Ue.id&&Ue.id!==ye&&await se(El(Ce,Y));const _e=(0,ws.dn)(Q,ue());(0,Aa.SP)(_e)&&se((0,Hs.kb)(Ce,(0,or.MO)(_e)))},Yl=(Q,Y,se=!1)=>(ue,ye)=>{const{highlightIndex:Ce,options:Ue}=(0,ws.nx)(Q,ye()).optionsPicker,_e=Ue[Ce];ue((0,Hs.kb)(Q,(0,or.U9)({option:_e,forceSelect:se,clearOthers:Y})))},fp=async(Q,Y,se,ue)=>{try{const{id:ye}=(0,ws.nx)(ue,Y()).optionsPicker,Ce={id:ye,rootStateKey:ue,type:"query"},Ue=(0,ws.dn)(Ce,Y());if(!(0,Aa.SP)(Ue))return;await tl.B.get(Ue.type).updateOptions(Ue,se);const He=(0,ws.dn)(Ce,Y());if(!(0,Aa.SP)(He))return;Q((0,Hs.kb)(ue,(0,or.qh)(He.options)))}catch(ye){console.error(ye)}},gp=(0,z.debounce)(fp,500);function pp(Q){const{options:Y,selectedValues:se,queryValue:ue,multi:ye}=Q;if(Y.length===0&&ue&&ue.length>0)return{text:ue,value:ue,selected:!1};if(!ye)return se.find(_e=>_e.selected);const Ce=[],Ue=[];for(const _e of se)_e.selected&&(Ce.push(_e.text.toString()),Ue.push(_e.value.toString()));return{value:Ue,text:Ce,selected:!0}}const rl=()=>{const Q=Ce=>({...(0,_l.bindActionCreators)({openOptions:hp,commitChangesToVariable:El,navigateOptions:cp},Ce),filterOrSearchOptions:(Ue,_e="")=>{Ce(dp(Ue,_e))},toggleAllOptions:Ue=>Ce((0,Hs.kb)(Ue.rootStateKey,(0,or.an)())),toggleOption:(Ue,_e,He,rt)=>Ce((0,Hs.kb)(Ue.rootStateKey,(0,or.U9)({option:_e,clearOthers:He,forceSelect:rt})))}),Y=(Ce,Ue)=>{const{rootStateKey:_e}=Ue.variable;return _e?{picker:(0,ws.nx)(_e,Ce).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:or.$z})},se=(0,Ja.connect)(Y,Q);class ue extends s.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,ss.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(Ue,_e)=>{((0,Aa.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(Ue,_e)},this.onToggleSingleValueVariable=(Ue,_e)=>{this.props.toggleOption((0,ss.jX)(this.props.variable),Ue,_e,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(Ue,_e)=>{this.props.toggleOption((0,ss.jX)(this.props.variable),Ue,_e,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,ss.jX)(this.props.variable))},this.onFilterOrSearchOptions=Ue=>{this.props.filterOrSearchOptions((0,ss.jX)(this.props.variable),Ue)},this.onNavigate=(Ue,_e)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,Ue,_e)},this.onCancel=()=>{Ql().cancelRequest((0,ss.jX)(this.props.variable))}}render(){const{variable:Ue,picker:_e}=this.props,He=_e.id===Ue.id,rt=mp();return(0,T.jsx)("div",{className:rt.variableLinkWrapper,"data-testid":da.Tp.components.Variables.variableLinkWrapper,children:He?this.renderOptions(_e):this.renderLink(Ue)})}renderLink(Ue){const _e=ep(Ue),He=Ue.state===We.Gu.Loading;return(0,T.jsx)(rp,{id:Ba.qz+Ue.id,text:_e,onClick:this.onShowOptions,loading:He,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(Ue){const{id:_e}=this.props.variable;return(0,T.jsxs)(Mg.N,{onClick:this.onHideOptions,children:[(0,T.jsx)(np,{id:Ba.qz+_e,value:Ue.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${_e}`}),(0,T.jsx)(ip,{values:Ue.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:Ue.highlightIndex,multi:Ue.multi,selectedValues:Ue.selectedValues,id:`options-${_e}`})]})}}const ye=se(ue);return ye.displayName="OptionsPicker",ye},mp=()=>({variableLinkWrapper:(0,Re.css)({display:"inline-block",position:"relative"})});var vp=e(53504);class yp extends s.PureComponent{constructor(){super(...arguments),this.onChange=Y=>{this.props.onPropChange({propName:"query",propValue:Y.currentTarget.value,updateOptions:!0})}}render(){return(0,T.jsx)(vp.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const xp={...di.Vg,type:"constant",hide:bo.zL.hideVariable,query:"",current:{},options:[]},yd=(0,Rr.Z0)({name:"templating/constant",initialState:sl.j,reducers:{createConstantOptionsFromQuery:(Q,Y)=>{const se=(0,ws.Fs)(Q,Y.payload.id);se.type==="constant"&&(se.options=[{text:se.query.trim(),value:se.query.trim(),selected:!1}])}}}),Ep=yd.reducer,{createConstantOptionsFromQuery:Pp}=yd.actions,Dp=Q=>async Y=>{const{rootStateKey:se}=Q;await Y((0,Hs.kb)(se,Pp((0,ss.qD)(Q)))),await Y((0,ya.kl)(Q))},Cp=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:xp,reducer:Ep,picker:rl(),editor:yp,dependsOn:()=>!1,setValue:async(Q,Y,se=!1)=>{await(0,ta.JD)((0,ya.t9)((0,ss.jX)(Q),Y,se))},setValueFromUrl:async(Q,Y)=>{await(0,ta.JD)((0,ya.x7)((0,ss.jX)(Q),Y))},updateOptions:async Q=>{await(0,ta.JD)(Dp((0,ss.jX)(Q)))},getSaveModel:Q=>{const{index:Y,id:se,state:ue,global:ye,current:Ce,options:Ue,rootStateKey:_e,...He}=(0,z.cloneDeep)(Q);return He},getValueForUrl:Q=>Q.current.value,beforeAdding:Q=>{const{current:Y,options:se,query:ue,...ye}=(0,z.cloneDeep)(Q),Ce={selected:!0,text:ue,value:ue};return{...ye,current:Ce,options:[Ce],query:ue}}});function bp(Q,...Y){const se=(0,Ja.connect)(...Y)(Q);return ue=>(0,T.jsx)(se,{...ue,store:ta.M_})}function T0(Q,...Y){const se=connect(...Y)(Q);return ue=>jsx(Provider,{store,children:jsx(se,{...ue,store})})}var Tp=e(3661);class Sp extends s.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:Y,propValue:se})=>{this.props.onPropChange({propName:Y,propValue:se,updateOptions:!0})},this.onQueryChange=Y=>{this.props.onPropChange({propName:"query",propValue:Y.currentTarget.value,updateOptions:!0})}}render(){return(0,T.jsx)(Tp.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:Y=>this.onSelectionOptionsChange({propName:"multi",propValue:Y.currentTarget.checked}),onIncludeAllChange:Y=>this.onSelectionOptionsChange({propName:"includeAll",propValue:Y.currentTarget.checked}),onAllValueChange:Y=>this.onSelectionOptionsChange({propName:"allValue",propValue:Y.currentTarget.value})})}}const Mp=(Q,Y)=>({}),Op={changeVariableMultiValue:ya.TI},Ip=bp(Sp,Mp,Op),Ap={...di.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},xd=(0,Rr.Z0)({name:"templating/custom",initialState:sl.j,reducers:{createCustomOptionsFromQuery:(Q,Y)=>{const se=(0,ws.Fs)(Q,Y.payload.id);if(se.type!=="custom")return;const{includeAll:ue}=se,Ue=(Y.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(_e=>{_e=_e.replace(/\\,/g,",");const He=/^(.+)\s:\s(.+)$/g.exec(_e)??[];if(He.length===3){const[,rt,it]=He;return{text:rt.trim(),value:it.trim(),selected:!1}}else return{text:_e.trim(),value:_e.trim(),selected:!1}});ue&&Ue.unshift({text:Ba.Zm,value:Ba.To,selected:!1}),se.options=Ue}}}),Rp=xd.reducer,{createCustomOptionsFromQuery:Lp}=xd.actions,jp=Q=>async(Y,se)=>{const{rootStateKey:ue}=Q,ye=(0,ws.dn)(Q,se());if(ye.type!=="custom")return;const Ce=(0,bn.w)().replace(ye.query);await Y((0,Hs.kb)(ue,Lp((0,ss.qD)(Q,Ce)))),await Y((0,ya.kl)(Q))},Bp=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:Ap,reducer:Rp,picker:rl(),editor:Ip,dependsOn:(Q,Y)=>(0,ss.wJ)(Q.query,Y.name),setValue:async(Q,Y,se=!1)=>{await(0,ta.JD)((0,ya.t9)((0,ss.jX)(Q),Y,se))},setValueFromUrl:async(Q,Y)=>{await(0,ta.JD)((0,ya.x7)((0,ss.jX)(Q),Y))},updateOptions:async Q=>{await(0,ta.JD)(jp((0,ss.jX)(Q)))},getSaveModel:Q=>{const{index:Y,id:se,state:ue,global:ye,rootStateKey:Ce,...Ue}=(0,z.cloneDeep)(Q);return Ue},getValueForUrl:Q=>(0,ss.ML)(Q)?Ba.Zm:Q.current.value});var Up=e(29815),Np=e(6989);const Wp={...di.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:bo.CO.onDashboardLoad},Ed=(0,Rr.Z0)({name:"templating/datasource",initialState:sl.j,reducers:{createDataSourceOptions:(Q,Y)=>{const{sources:se,regex:ue}=Y.payload.data,ye=[],Ce=(0,ws.Fs)(Q,Y.payload.id);if(Ce.type==="datasource"){for(let Ue=0;Ue<se.length;Ue++){const _e=se[Ue];(0,Np._)(Ce.query,_e.meta)&&(Fp(_e,ue)&&ye.push({text:_e.name,value:_e.uid,selected:!1}),Kp(_e,ue)&&ye.push({text:"default",value:"default",selected:!1}))}ye.length===0&&ye.push({text:"No data sources found",value:"",selected:!1}),Ce.includeAll&&ye.unshift({text:Ba.Zm,value:Ba.To,selected:!1}),Ce.options=ye}}}});function Fp(Q,Y){return Y?Y.exec(Q.name):!0}function Kp(Q,Y){return Q.isDefault?Y?Y.exec("default"):!0:!1}const wp=Ed.reducer,{createDataSourceOptions:Vp}=Ed.actions,$p=(Q,Y={getDatasourceSrv:li.tR})=>async(se,ue)=>{const{rootStateKey:ye}=Q,Ce=Y.getDatasourceSrv().getList({metrics:!0,variables:!1}),Ue=(0,ws.dn)(Q,ue());if(Ue.type!=="datasource")return;let _e;Ue.regex&&(_e=(0,bn.w)().replace(Ue.regex,void 0,"regex"),_e=(0,hs.dO)(_e)),se((0,Hs.kb)(ye,Vp((0,ss.qD)(Q,{sources:Ce,regex:_e})))),await se((0,ya.kl)(Q))},zp=(Q,Y={getDatasourceSrv:li.tR})=>se=>{const ue=Y.getDatasourceSrv().getList({metrics:!0,variables:!0}),ye=(0,z.chain)(ue).uniqBy("meta.id").map(Ce=>({text:Ce.meta.name,value:Ce.meta.id})).value();ye.unshift({text:"",value:""}),se((0,Hs.kb)(Q,(0,Ar.BC)({dataSourceTypes:ye})))},Hp=(Q,Y)=>{const{variable:{rootStateKey:se}}=Y;if(!se)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:td(Ar.nS)};const{editor:ue}=(0,ws.nx)(se,Q);return{extended:td(ue)}},_p={initDataSourceVariableEditor:zp,changeVariableMultiValue:ya.TI},Gp=(0,Ja.connect)(Hp,_p);class Qp extends s.PureComponent{constructor(){super(...arguments),this.onRegExBlur=Y=>{this.props.onPropChange({propName:"regex",propValue:Y.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:Y,propName:se})=>{this.props.onPropChange({propName:se,propValue:Y,updateOptions:!0})},this.onMultiChanged=Y=>{this.props.changeVariableMultiValue((0,ss.jX)(this.props.variable),Y.currentTarget.checked)},this.onIncludeAllChanged=Y=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:Y.currentTarget.checked})},this.onAllValueChanged=Y=>{this.onSelectionOptionsChange({propName:"allValue",propValue:Y.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:Y}=this.props;if(!Y?.dataSourceTypes.length)return"";const se=Y.dataSourceTypes.find(ye=>ye.value===this.props.variable.query);return(se?se.value:Y.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=Y=>{this.props.onPropChange({propName:"query",propValue:Y.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:Y}=this.props.variable;if(!Y){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(Y)}render(){const{variable:Y,extended:se}=this.props,ue=se?.dataSourceTypes?.length?se.dataSourceTypes?.map(ye=>({value:ye.value??"",label:ye.text})):[];return(0,T.jsx)(Up.y,{query:Y.query,regex:Y.regex,multi:Y.multi,includeAll:Y.includeAll,optionTypes:ue,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const kp=Gp(Qp),Yp=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:Wp,reducer:wp,picker:rl(),editor:kp,dependsOn:(Q,Y)=>Q.regex?(0,ss.wJ)(Q.regex,Y.name):!1,setValue:async(Q,Y,se=!1)=>{await(0,ta.JD)((0,ya.t9)((0,ss.jX)(Q),Y,se))},setValueFromUrl:async(Q,Y)=>{await(0,ta.JD)((0,ya.x7)((0,ss.jX)(Q),Y))},updateOptions:async Q=>{await(0,ta.JD)($p((0,ss.jX)(Q)))},getSaveModel:Q=>{const{index:Y,id:se,state:ue,global:ye,rootStateKey:Ce,...Ue}=(0,z.cloneDeep)(Q);return{...Ue,options:[]}},getValueForUrl:Q=>(0,ss.ML)(Q)?Ba.Zm:Q.current.value});var Jp=e(86278),Xp=e(12619);const Pd=(0,s.memo)(({onPropChange:Q,variable:Y})=>{const se=Ue=>{Q({propName:"auto",propValue:Ue.target.checked,updateOptions:!0})},ue=Ue=>{Q({propName:"query",propValue:Ue.currentTarget.value,updateOptions:!0})},ye=Ue=>{Q({propName:"auto_count",propValue:Ue.value,updateOptions:!0})},Ce=Ue=>{Q({propName:"auto_min",propValue:Ue.currentTarget.value,updateOptions:!0})};return(0,T.jsx)(Xp.s,{intervals:Y.query,autoStepCount:Y.auto_count,autoEnabled:Y.auto,onAutoCountChanged:ye,onIntervalsChange:ue,onAutoEnabledChange:se,onAutoMinIntervalChanged:Ce,autoMinInterval:Y.auto_min})});Pd.displayName="IntervalVariableEditor";var Zp=e(84395),Jl=e(26197);const qp=Q=>async Y=>{const{rootStateKey:se}=Q;await Y((0,Hs.kb)(se,(0,Jl.mn)((0,ss.qD)(Q)))),await Y(Xl(Q)),await Y((0,ya.kl)(Q))},Xl=(Q,Y={calculateInterval:Zc.calculateInterval,getTimeSrv:Zr.jG,templateSrv:(0,Zp.w)()})=>(se,ue)=>{const ye=(0,ws.dn)(Q,ue());if(ye.type==="interval"&&ye.auto){const Ce=Y.calculateInterval(Y.getTimeSrv().timeRange(),ye.auto_count,ye.auto_min);Y.templateSrv.setGrafanaVariable("$__auto_interval_"+ye.name,Ce.interval),Y.templateSrv.setGrafanaVariable("$__auto_interval",Ce.interval)}},em=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:Jl.Ez,reducer:Jl.E5,picker:rl(),editor:Pd,dependsOn:()=>!1,setValue:async(Q,Y,se=!1)=>{await(0,ta.JD)(Xl((0,ss.jX)(Q))),await(0,ta.JD)((0,ya.t9)((0,ss.jX)(Q),Y,se))},setValueFromUrl:async(Q,Y)=>{await(0,ta.JD)(Xl((0,ss.jX)(Q))),await(0,ta.JD)((0,ya.x7)((0,ss.jX)(Q),Y))},updateOptions:async Q=>{await(0,ta.JD)(qp((0,ss.jX)(Q)))},getSaveModel:Q=>{const{index:Y,id:se,state:ue,global:ye,rootStateKey:Ce,...Ue}=(0,z.cloneDeep)(Q);return Ue},getValueForUrl:Q=>Q.current.value});var tm=e(92467),nm=e(64423),sm=e(64121),am=e(5596);function rm(Q,Y,se){return{next:ye=>{if(ye.state===We.Gu.Error){se.unsubscribe(),Y(ye.error);return}if(ye.state===We.Gu.Done){se.unsubscribe(),Q();return}},error:ye=>{se.unsubscribe(),Y(ye)},complete:()=>{se.unsubscribe(),Q()}}}const om=(Q,Y)=>async(se,ue)=>{try{const{rootStateKey:ye}=Q;if(!(0,ss.sN)(ye,ue()))return;const Ce=(0,ws.dn)(Q,ue());if(Ce.type!=="query")return;(0,ws.nx)(ye,ue()).editor.id===Ce.id&&se((0,Hs.kb)(ye,(0,Ar.Eo)({errorProp:"update"})));const Ue=await(0,b.l)().get(Ce.datasource??"");await new Promise((_e,He)=>{const rt=new nm.yU,it=rm(_e,He,rt),xt=Ql().getResponse(Q).subscribe(it);rt.add(xt),Ql().queueRequest({identifier:Q,datasource:Ue,searchFilter:Y})})}catch(ye){if(ye instanceof Error){const Ce=(0,sm.u)(ye),{rootStateKey:Ue}=Q;throw(0,ws.nx)(Ue,ue()).editor.id===Q.id&&se((0,Hs.kb)(Ue,(0,Ar.NY)({errorProp:"update",errorText:Ce.message}))),Ce}}},im=Q=>async(Y,se)=>{const ue=(0,ws.dn)(Q,se());ue.type==="query"&&await Y(Dd((0,ss.jX)(ue),ue.datasource))},Dd=(Q,Y)=>async(se,ue)=>{try{const{rootStateKey:ye}=Q,{editor:Ce}=(0,ws.nx)(ye,ue()),_e=zl(Ce)?.dataSource,He=await(0,b.l)().get(Y??"");_e&&_e.type!==He?.type&&se((0,Hs.kb)(ye,(0,no.QP)((0,ss.qD)(Q,{propName:"query",propValue:""}))));const rt=await(0,am.y)(He);se((0,Hs.kb)(ye,(0,Ar.BC)({dataSource:He,VariableQueryEditor:rt})))}catch(ye){console.error(ye)}},lm=(Q,Y,se)=>async(ue,ye)=>{const{rootStateKey:Ce}=Q,Ue=(0,ws.dn)(Q,ye());if(Ue.type==="query"){if(cm(Ue.name,Y)){const _e="Query cannot contain a reference to itself. Variable: $"+Ue.name;ue((0,Hs.kb)(Ce,(0,Ar.NY)({errorProp:"query",errorText:_e})));return}ue((0,Hs.kb)(Ce,(0,Ar.Eo)({errorProp:"query"}))),ue((0,Hs.kb)(Ce,(0,no.QP)((0,ss.qD)(Q,{propName:"query",propValue:Y})))),se!==void 0?ue((0,Hs.kb)(Ce,(0,no.QP)((0,ss.qD)(Q,{propName:"definition",propValue:se})))):typeof Y=="string"&&ue((0,Hs.kb)(Ce,(0,no.QP)((0,ss.qD)(Q,{propName:"definition",propValue:Y})))),await ue((0,ya.mZ)(Q))}};function cm(Q,Y){if(typeof Y=="string"&&Y.match(new RegExp("\\$"+Q+"(/| |$)")))return!0;const se=Cd(Y);for(let ue in se)if(se.hasOwnProperty(ue)){const ye=se[ue];if(typeof ye=="string"&&ye.match(new RegExp("\\$"+Q+"(/| |$)")))return!0}return!1}function Cd(Q){return typeof Q!="object"||Q===null?{query:Q}:Object.keys(Q).reduce((ue,ye)=>{const Ce=Q[ye];if(typeof Ce!="object"||Ce===null)return ue[ye]=Ce,ue;const Ue=Cd(Ce);for(let _e in Ue)Ue.hasOwnProperty(_e)&&(ue[`${ye}_${_e}`]=Ue[_e]);return ue},{})}const dm=(Q,Y)=>{const{rootStateKey:se}=Y.variable;if(!se)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:zl(Ar.nS)};const{editor:ue}=(0,ws.nx)(se,Q);return{extended:zl(ue)}},um={initQueryVariableEditor:im,changeQueryVariableDataSource:Dd,changeQueryVariableQuery:lm,changeVariableMultiValue:ya.TI},hm=(0,Ja.connect)(dm,um);class fm extends s.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=Y=>{this.props.onPropChange({propName:"datasource",propValue:Y.isDefault?null:(0,qc.p$)(Y)})},this.onLegacyQueryChange=async(Y,se)=>{this.props.variable.query!==Y&&this.props.changeQueryVariableQuery((0,ss.jX)(this.props.variable),Y,se)},this.onQueryChange=async Y=>{if(this.props.variable.query!==Y){let se="";Y&&Y.hasOwnProperty("query")&&typeof Y.query=="string"&&(se=Y.query),this.props.changeQueryVariableQuery((0,ss.jX)(this.props.variable),Y,se)}},this.onRegExBlur=async Y=>{const se=Y.currentTarget.value;this.props.variable.regex!==se&&this.props.onPropChange({propName:"regex",propValue:se,updateOptions:!0})},this.onRefreshChange=Y=>{this.props.onPropChange({propName:"refresh",propValue:Y})},this.onSortChange=async Y=>{this.props.onPropChange({propName:"sort",propValue:Y.value,updateOptions:!0})},this.onMultiChange=Y=>{this.props.onPropChange({propName:"multi",propValue:Y.currentTarget.checked})},this.onIncludeAllChange=Y=>{this.props.onPropChange({propName:"includeAll",propValue:Y.currentTarget.checked})},this.onAllValueChange=Y=>{this.props.onPropChange({propName:"allValue",propValue:Y.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,ss.jX)(this.props.variable))}componentDidUpdate(Y){Y.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,ss.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:Y,variable:se}=this.props;if(!Y||!Y.dataSource)return null;const ue=(0,Zr.jG)().timeRange();return(0,T.jsx)(tm.u,{datasource:se.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:se.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:ue,regex:se.regex,onRegExChange:this.onRegExBlur,sort:se.sort,onSortChange:this.onSortChange,refresh:se.refresh,onRefreshChange:this.onRefreshChange,isMulti:se.multi,includeAll:se.includeAll,allValue:se.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const gm=hm(fm),pm=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:Bg,reducer:Fg,picker:rl(),editor:gm,dependsOn:(Q,Y)=>(0,ss.wJ)(Q.query,Q.datasource?.uid,Q.regex,Y.name),setValue:async(Q,Y,se=!1)=>{await(0,ta.JD)((0,ya.t9)((0,ss.jX)(Q),Y,se))},setValueFromUrl:async(Q,Y)=>{await(0,ta.JD)((0,ya.x7)((0,ss.jX)(Q),Y))},updateOptions:async(Q,Y)=>{await(0,ta.JD)(om((0,ss.jX)(Q),Y))},getSaveModel:Q=>{const{index:Y,id:se,state:ue,global:ye,queryValue:Ce,rootStateKey:Ue,..._e}=(0,z.cloneDeep)(Q);return Q.refresh!==bo.CO.never?{..._e,options:[]}:_e},getValueForUrl:Q=>(0,ss.ML)(Q)?Ba.Zm:Q.current.value}),mm=()=>({id:"system",description:"",name:"system",initialState:{...di.Vg,type:"system",hide:bo.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:We.Gu.Done},reducer:Q=>Q,picker:null,editor:null,dependsOn:()=>!1,setValue:async(Q,Y,se=!1)=>{},setValueFromUrl:async(Q,Y)=>{},updateOptions:async Q=>{},getSaveModel:Q=>({}),getValueForUrl:Q=>""});var vm=e(17077),ym=e(7807);function xm({onPropChange:Q,variable:{query:Y}}){const se=(0,s.useCallback)((Ce,Ue)=>{Ce.preventDefault(),Q({propName:"originalQuery",propValue:Ce.currentTarget.value,updateOptions:!1}),Q({propName:"query",propValue:Ce.currentTarget.value,updateOptions:Ue})},[Q]),ue=(0,s.useCallback)(Ce=>se(Ce,!1),[se]),ye=(0,s.useCallback)(Ce=>se(Ce,!0),[se]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(vm.Y,{children:"Text options"}),(0,T.jsx)(ym._,{value:Y,name:"Default value",placeholder:"default value, if any",onChange:ue,onBlur:ye,width:30,testId:da.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function Em({variable:Q,onVariableChange:Y,readOnly:se}){const ue=(0,Dn.useDispatch)(),[ye,Ce]=(0,s.useState)(Q.current.value);(0,s.useEffect)(()=>{Ce(Q.current.value)},[Q]);const Ue=(0,s.useCallback)(()=>{if(!Q.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(Q.current.value!==ye){if(ue((0,Hs.kb)(Q.rootStateKey,(0,no.QP)((0,ss.qD)({id:Q.id,type:Q.type},{propName:"query",propValue:ye})))),Y){Y({...Q,current:(0,vd.R)(Q.current)?{}:{...Q.current,value:ye}});return}tl.B.get(Q.type).updateOptions(Q)}},[Q,ye,ue,Y]),_e=(0,s.useCallback)(it=>Ce(it.target.value),[Ce]),He=it=>Ue(),rt=it=>{it.keyCode===13&&(it.preventDefault(),Ue())};return(0,T.jsx)(lt.p,{type:"text",value:ye,onChange:_e,onBlur:He,disabled:se,onKeyDown:rt,placeholder:(0,Bn.t)("variable.textbox.placeholder","Enter variable value"),id:Ba.qz+Q.id})}const Pm={...di.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},bd=(0,Rr.Z0)({name:"templating/textbox",initialState:sl.j,reducers:{createTextBoxOptions:(Q,Y)=>{const se=(0,ws.Fs)(Q,Y.payload.id);if(se.type!=="textbox")return;const ue={text:se.query.trim(),value:se.query.trim(),selected:!1};se.options=[ue],se.current=ue}}}),Dm=bd.reducer,{createTextBoxOptions:Cm}=bd.actions,bm=Q=>async(Y,se)=>{const{rootStateKey:ue,type:ye}=Q;Y((0,Hs.kb)(ue,Cm((0,ss.qD)(Q))));const Ce=(0,ws.dn)(Q,se());Ce.type==="textbox"&&await tl.B.get(ye).setValue(Ce,Ce.options[0],!0)},Tm=(Q,Y)=>async(se,ue)=>{const{rootStateKey:ye}=Q,Ce=(0,ws.dn)(Q,ue());if(Ce.type!=="textbox")return;const Ue=(0,ss.QT)(Y);se((0,Hs.kb)(ye,(0,no.QP)((0,ss.qD)(Ce,{propName:"query",propValue:Ue})))),await se((0,ya.x7)((0,ss.jX)(Ce),Ue))},Sm=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:Pm,reducer:Dm,picker:Em,editor:xm,dependsOn:(Q,Y)=>!1,setValue:async(Q,Y,se=!1)=>{await(0,ta.JD)((0,ya.t9)((0,ss.jX)(Q),Y,se))},setValueFromUrl:async(Q,Y)=>{await(0,ta.JD)(Tm((0,ss.jX)(Q),Y))},updateOptions:async Q=>{await(0,ta.JD)(bm((0,ss.jX)(Q)))},getSaveModel:(Q,Y)=>{const{index:se,id:ue,state:ye,global:Ce,originalQuery:Ue,rootStateKey:_e,...He}=(0,z.cloneDeep)(Q);if(Q.query!==Ue&&!Y){const rt=Ue??"",it={selected:!1,text:rt,value:rt};return{...He,query:rt,current:it,options:[it]}}return He},getValueForUrl:Q=>Q.current.value,beforeAdding:Q=>({...(0,z.cloneDeep)(Q),originalQuery:Q.query})});var Mm=e(10378),Zl=e(15664),ql=e(65728),ec=e(5989),Td=e(76829);const Om={navBarTree:Tc.I_,navIndex:Td._h,appNotifications:Rc.g5};var Im=e(69818),so=e(4013),ao=e(48542);const Am=(0,_l.combineReducers)({promRules:(0,so.Xw)("promRules",ao.mB,({rulesSourceName:Q})=>Q).reducer,rulerRules:(0,so.Xw)("rulerRules",ao.eB,({rulesSourceName:Q})=>Q).reducer,saveAMConfig:(0,so.J7)("saveAMConfig",ao.RW).reducer,deleteAMConfig:(0,so.J7)("deleteAMConfig",ao.nO).reducer,folders:(0,so.Xw)("folders",ao.Tp,Q=>Q).reducer,amAlertGroups:(0,so.Xw)("amAlertGroups",ao.D3,Q=>Q).reducer,testReceivers:(0,so.J7)("testReceivers",ao.bO).reducer,managedAlertStateHistory:(0,so.J7)("managedAlertStateHistory",ao.JH).reducer});var Rm=e(71481);const Lm={items:[],searchQuery:"",isLoading:!1},jm={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function Bm(Q,Y){const se=Rm.A.getStateDisplayModel(Y),ue={...Q,stateText:se.text,stateIcon:se.iconClass,stateClass:se.stateClass,stateAge:(0,d.KQ)(Q.newStateDate).fromNow(!0)};return ue.state!=="paused"&&(ue.executionError&&(ue.info="Execution Error: "+ue.executionError),ue.evalData&&ue.evalData.noData&&(ue.info="Query returned no data")),ue}const Sd=(0,Rr.Z0)({name:"alertRules",initialState:Lm,reducers:{loadAlertRules:Q=>({...Q,isLoading:!0}),loadedAlertRules:(Q,Y)=>{const ue=Y.payload.map(ye=>Bm(ye,ye.state));return{...Q,items:ue,isLoading:!1}},setSearchQuery:(Q,Y)=>({...Q,searchQuery:Y.payload})}}),Md=(0,Rr.Z0)({name:"notificationChannel",initialState:jm,reducers:{setNotificationChannels:(Q,Y)=>({...Q,notificationChannelTypes:Km(Y.payload),notifiers:Y.payload}),notificationChannelLoaded:(Q,Y)=>{const se=Y.payload,ye=Q.notifiers.find(Ce=>Ce.type===se.type).options.filter(Ce=>Ce.secure);return ye.length>0&&ye.some(Ce=>se.settings[Ce.propertyName]!=="")?Fm(Q,Y.payload,ye):{...Q,notificationChannel:se}},resetSecureField:(Q,Y)=>({...Q,notificationChannel:{...Q.notificationChannel,secureFields:{...Q.notificationChannel.secureFields,[Y.payload]:!1}}})}}),{loadAlertRules:M0,loadedAlertRules:O0,setSearchQuery:I0}=Sd.actions,{setNotificationChannels:A0,notificationChannelLoaded:R0,resetSecureField:L0}=Md.actions,Um=Sd.reducer,Nm=Md.reducer,Wm={alertRules:Um,notificationChannel:Nm,unifiedAlerting:Am};function Fm(Q,Y,se){const ue={},ye={};return se.forEach(Ce=>{ye[Ce.propertyName]=Y.settings[Ce.propertyName],ue[Ce.propertyName]=""}),{...Q,notificationChannel:{...Y,settings:{...Y.settings,...ue},secureSettings:{...ye}}}}function Km(Q){return Q.map(Y=>({value:Y.type,label:Y.name,...Y,typeName:Y.type})).sort((Y,se)=>Y.name>se.name?1:-1)}var wm=e(95242),Vm=e(33790),$m=e(41900),zm=e(36608),Hm=e(86983),_m=e(26629),Gm=e(67078),Qm=e(31512),km=e(85545),Ym=e(33914),Jm=e(8969),Xm=e(14297),Zm=e(80840),qm=e(89880),e0=e(83410),t0=e(28378),n0=e(34361),s0=e(11488),a0=e(75816),r0=e(31226),o0=e(77855);const i0=(0,o0.T)("iam.grafana.app","v0alpha1"),tc=(0,a0.xP)({baseQuery:(0,r0.W)({baseURL:i0}),reducerPath:"iamAPI",endpoints:()=>({})});var l0=e(40449);const c0={...Om,...Wm,...n0.Ay,...wm.Ay,...Qm.Ay,...Hm.Ay,...Gm.Ay,..._m.Ay,...s0.Ay,...e0.Ay,...qm.Ay,...km.Ay,...Jm.Ay,...$m.Ay,...Im.Ay,...Ym.Ay,...zm.Ay,...Xm.Ay,...Hs.Ay,...t0.Ay,...Vm.Ay,plugins:Zm.Ff,[Is.H.reducerPath]:Is.H.reducer,[ql.Sm.reducerPath]:ql.Sm.reducer,[Zl.cU.reducerPath]:Zl.cU.reducer,[ec.O5.reducerPath]:ec.O5.reducer,[tc.reducerPath]:tc.reducer,[hl.Aj.reducerPath]:hl.Aj.reducer},Od={},j0=Q=>{Object.assign(Od,Q)},d0=()=>{const Q=(0,_l.combineReducers)({...c0,...Od});return(Y,se)=>{if(se.type!==l0.N.type)return Q(Y,se);const{cleanupAction:ue}=se.payload;return ue(Y),Q(Y,se)}};function B0(Q){addReducer(Q)}const u0=(0,Rr.Nc)(),Id=[];function U0(Q){Id.push(Q)}function h0(Q){const Y=(0,Rr.U1)({reducer:d0(),middleware:se=>se({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(u0.middleware,Is.H.middleware,ql.Sm.middleware,Zl.cU.middleware,ec.O5.middleware,hl.Aj.middleware,tc.middleware,...Id),devTools:!1,preloadedState:{navIndex:(0,Td.s2)(),...Q}});return(0,Mm.$k)(Y.dispatch),(0,ta.k3)(Y),Y}const Ad=e(39572),Pl=Ad.keys().map(Q=>Ad(Q));class f0{async init(){try{parent.postMessage("GrafanaAppInit","*");const Y=(0,Bn.JL)(K.Ay.bootData.user.language);Y.then(({language:He})=>(0,K._R)({language:He})),(0,f.u5)($c.IB),await m0(),(0,Hc.j)("frontend_app_init"),(0,d.xS)(K.Ay.bootData.user.locale),(0,d.$D)(K.Ay.bootData.user.weekStart),(0,A.Y)(jf.m),(0,N.l)($h),(0,W.e)(Lf.a),(0,p.T)(h.Ny),(0,D.l)(new tf),(0,C.p)(vf),(0,u.G)(()=>K.Ay.bootData.user.timezone),Rf(),(0,l.l)(en.TP.user),(0,mf.initAuthConfig)(),(0,v.H8)(Ta.A),await Y,g0(),h0(),p0(),pf(),g.D.setInit(Nc.H),g.G.setInit(Nc.u),o.h.setInit(Gr),tl.B.setInit(()=>[pm(),Bp(),Sm(),Cp(),Yp(),em(),Sg(),mm()]),E.l.setInit(ai.A),(0,Jh.f)(),(0,y.HC)(()=>new Xf),qg(new Zg),(0,y.pC)($l.BN),(0,P.se)({importPanelPlugin:Jc.TV,getPanelPluginFromCache:Jc.PY}),K.Ay.featureToggles.useSessionStorageForRedirection&&v0(),m.I.initialize({config:K.Ay,getTimeRangeForUrl:(0,Zr.jG)().timeRangeForUrl,getVariablesUrlParams:Jp.z}),document.addEventListener("click",Zh);const se=new li.xq;if(se.init(K.Ay.datasources,K.Ay.defaultDatasource),(0,b.h)(se),qf(),en.TP.user.orgRole!==""){const He=(0,Xs.Xs)(),rt=(0,Xs.mi)();Vl(rt),await Vl(He)}(0,S.cE)(Bf(Bl.qm)),(0,M.Vu)(Hf(Bl.qm)),(0,O.q)(Gf),(0,R.A)(Vf),(0,L.R)($f),(0,B.U)(_f);const ue=h.Ny.getSearchObject(),ye=new Kl.dk,Ce=new hf(h.Ny,ye),Ue=new sf;Ue.start(),ye.setKioskModeFromUrl(ue.kiosk);try{(0,eg.W1)()}catch(He){console.warn("Failed to clean up old expanded folders",He)}this.context={backend:$c.IB,location:h.Ny,chrome:ye,keybindings:Ce,newAssetsChecker:Ue,config:K.Ay},(0,F._)(Mr.ni),(0,I._)(Mr.k9),(0,Wl.sq)(),K.Ay.featureToggles.crashDetection&&Yh(),(0,c.H)(document.getElementById("reactRoot")).render((0,s.createElement)(wh,{app:this}))}catch(Y){console.error("Failed to start Grafana",Y),window.__grafana_load_failed()}finally{(0,Hc.z)("frontend_app_init")}}}function g0(){Pl.length>0&&Pl[0].addExtensionReducers()}function p0(){Pl.length>0&&Pl[0].init()}async function m0(){if((0,U.H2)(new af({debug:!1})),window.addEventListener("load",Q=>{const Y="frontend_boot_load_time_seconds";performance&&(performance.mark(Y),ol("first-paint","frontend_boot_","_time_seconds"),ol("first-contentful-paint","frontend_boot_","_time_seconds"),ol(Y),ol("frontend_boot_js_done_time_seconds"),ol("frontend_boot_css_time_seconds"))}),en.TP.user.orgRole!==""){const{PerformanceBackend:Q}=await e.e(8737).then(e.bind(e,81118));(0,U.pl)(new Q({}))}if(K.Ay.grafanaJavascriptAgent.enabled){const Q=[K.Ay.rudderstackConfigUrl,K.Ay.rudderstackDataPlaneUrl,K.Ay.rudderstackIntegrationsUrl].filter(Boolean).map(se=>new RegExp(`${se}.*.`)),{GrafanaJavascriptAgentBackend:Y}=await e.e(2741).then(e.bind(e,72741));(0,U.pl)(new Y({...K.Ay.grafanaJavascriptAgent,app:{version:K.Ay.buildInfo.version,environment:K.Ay.buildInfo.env},buildInfo:K.Ay.buildInfo,user:{id:String(K.Ay.bootData.user?.id),email:K.Ay.bootData.user?.email},ignoreUrls:Q}))}if(K.Ay.googleAnalyticsId){const{GAEchoBackend:Q}=await e.e(9905).then(e.bind(e,79905));(0,U.pl)(new Q({googleAnalyticsId:K.Ay.googleAnalyticsId}))}if(K.Ay.googleAnalytics4Id){const{GA4EchoBackend:Q}=await e.e(3501).then(e.bind(e,93501));(0,U.pl)(new Q({googleAnalyticsId:K.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:K.Ay.googleAnalytics4SendManualPageViews}))}if(K.Ay.rudderstackWriteKey&&K.Ay.rudderstackDataPlaneUrl){const{RudderstackBackend:Q}=await e.e(9395).then(e.bind(e,49395));(0,U.pl)(new Q({writeKey:K.Ay.rudderstackWriteKey,dataPlaneUrl:K.Ay.rudderstackDataPlaneUrl,user:K.Ay.bootData.user,sdkUrl:K.Ay.rudderstackSdkUrl,configUrl:K.Ay.rudderstackConfigUrl,integrationsUrl:K.Ay.rudderstackIntegrationsUrl,buildInfo:K.Ay.buildInfo}))}if(K.Ay.applicationInsightsConnectionString){const{ApplicationInsightsBackend:Q}=await e.e(7388).then(e.bind(e,17388));(0,U.pl)(new Q({connectionString:K.Ay.applicationInsightsConnectionString,endpointUrl:K.Ay.applicationInsightsEndpointUrl}))}if(K.Ay.analyticsConsoleReporting){const{BrowserConsoleBackend:Q}=await e.e(4692).then(e.bind(e,44692));(0,U.pl)(new Q)}}function ol(Q,Y="",se=""){const ue=performance.getEntriesByName(Q).at(0);if(ue){const ye=ue.name.replace(/-/g,"_");(0,rf.n)(`${Y}${ye}${se}`,Math.round(ue.startTime)/1e3)}}function v0(){const Q=h.Ny.getSearch(),Y="redirectTo";if(Q.has("auth_token")){window.sessionStorage.removeItem(en.OG);return}if(Q.has(Y)&&window.location.pathname!=="/"){const ye=Q.get(Y);window.sessionStorage.setItem(en.OG,encodeURIComponent(ye)),Q.delete(Y),window.history.replaceState({},"",`${window.location.pathname}${Q.size>0?`?${Q}`:""}`);return}if(!en.TP.user.isSignedIn)return;const se=window.sessionStorage.getItem(en.OG);if(!se)return;window.sessionStorage.removeItem(en.OG);const ue=decodeURIComponent(se);ue.startsWith("/goto/")?window.location.replace(ue):h.Ny.replace(ue)}const y0=new f0;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,(async()=>Promise.resolve())().then(()=>{y0.init()})},80187:(q,j,e)=>{"use strict";e.d(j,{Or:()=>r,Oz:()=>x,RC:()=>n,ho:()=>a,nA:()=>i,uz:()=>t});const t=Symbol("routes_metadata");var n=(s=>(s.Active="active",s.Expired="expired",s.Pending="pending",s))(n||{}),r=(s=>(s.Unprocessed="unprocessed",s.Active="active",s.Suppressed="suppressed",s))(r||{}),a=(s=>(s.equal="=",s.notEqual="!=",s.regex="=~",s.notRegex="!~",s))(a||{}),i=(s=>(s.Internal="internal",s.External="external",s.All="all",s))(i||{}),x=(s=>(s.cortex="cortex",s.mimir="mimir",s.prometheus="prometheus",s))(x||{})},21783:(q,j,e)=>{"use strict";e.d(j,{Dw:()=>x,Rx:()=>r,_M:()=>s,_W:()=>i,d$:()=>n});const t={statistics:[]};var n=(d=>(d[d.Insights=1]="Insights",d[d.Search=0]="Search",d))(n||{}),r=(d=>(d[d.Builder=0]="Builder",d[d.Code=1]="Code",d))(r||{});const a={parameters:[]};var i=(d=>(d.And="and",d.Function="function",d.FunctionParameter="functionParameter",d.GroupBy="groupBy",d.Operator="operator",d.Or="or",d.Property="property",d))(i||{}),x=(d=>(d.String="string",d))(x||{}),s=(d=>(d.CWLI="CWLI",d.PPL="PPL",d.SQL="SQL",d))(s||{});const c={logGroupNames:[],logGroups:[],statsGroups:[]}},87854:(q,j,e)=>{"use strict";e.d(j,{Rx:()=>t.Rx,YZ:()=>n,_M:()=>t._M,b4:()=>r,d$:()=>t.d$});var t=e(21783),n=(a=>(a.Scheduled="Scheduled",a.Running="Running",a.Complete="Complete",a.Failed="Failed",a.Cancelled="Cancelled",a.Timeout="Timeout",a))(n||{}),r=(a=>(a.Regions="regions",a.Namespaces="namespaces",a.Metrics="metrics",a.DimensionKeys="dimensionKeys",a.DimensionValues="dimensionValues",a.EBSVolumeIDs="ebsVolumeIDs",a.EC2InstanceAttributes="ec2InstanceAttributes",a.ResourceArns="resourceARNs",a.Statistics="statistics",a.LogGroups="logGroups",a.Accounts="accounts",a))(r||{})},11747:(q,j,e)=>{"use strict";e.d(j,{K:()=>t});const t="-- Dashboard --",n="dashboard"},52488:(q,j,e)=>{"use strict";e.d(j,{k:()=>c,m:()=>d});var t=e(88483),n=e(7500),r=e(8392),a=e(55801),i=e(16910),x=e(63845),s=e(11747);function c(o){return o?typeof o=="string"?o===s.K:"meta"in o&&o.meta.name===s.K||o.uid===s.K:!1}function d(o,E){return new t.c(m=>{const f=(0,i.UA)().getCurrent(),p=u(o.queries);if(!p){m.next(g("Missing panel reference ID"));return}let h=f?.getPanelById(p,!0);if(h instanceof x.a9||(h=new x.a9(h)),!h){m.next(g("Unknown Panel: "+p));return}const D=h.getQueryRunner(),C=D.getData({withTransforms:!!E?.withTransforms,withFieldConfig:!1}).subscribe({next:l=>{E?.topic===n.QR.Annotations&&(l={...l,series:l.annotations??[],annotations:void 0}),m.next(l)}});if(!h.isInView&&h.refreshWhenInView||f?.otherPanelInFullscreen(h)){const{datasource:l,targets:v}=h,y={...o,datasource:l,panelId:p,queries:v};h.refreshWhenInView=!1,D.run(y)}return()=>{C.unsubscribe()}})}function u(o){if(!(!o||!o.length))return o[0].panelId}function g(o){return{state:r.Gu.Error,series:[],request:{},error:{message:o},timeRange:(0,a.E2)()}}},45820:(q,j,e)=>{"use strict";e.d(j,{i:()=>he,o:()=>oe});var t=e(2543),n=e(65474),r=e(62467),a=e(44240),i=e(81160),x=e(26701),s=e(8392),c=e(17162),d=e(36669),u=e(94626),g=e(4038),o=e(65502),E=e(39736),m=e(37633),f=e(28082),p=e(98437),h=e(5597),D=e(16910),C=e(74848),l=e(22803),v=e(96540),y=e(29675),P=e(44617),b=e(86489),S=e(44826),M=e(29010),O=e(96601),R=e(65596),L=e(92980),B=e(95093),F=e.n(B),I=e(58064),U=e(3202),W=e(14749),A=e(54594),N=e(48583),K=e(21144),V=e(34128),T=e(91262),z=e(53453),w=e(11817);const H=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((de,me)=>({label:de,value:me+1})),G=({value:de,onChange:me})=>{const Pe=(0,y.of)(X),Ee=Date.now(),be=(0,I.QZ)(de.timezone??"utc",Ee),Se=(0,D.UA)().getCurrent()?.getTimezone()===de.timezone,[Xe,Qe]=(0,v.useState)(!1),we=()=>{Qe(!Xe)},$e=ge=>{if(!ge)return;const xe=F()();if(ge){const je=ge.split(":");xe.set("hour",parseInt(je[0],10)),xe.set("minute",parseInt(je[1],10))}return xe},Fe=()=>{let ge="Everyday";return de.fromDayOfWeek&&!de.toDayOfWeek&&(ge=H[de.fromDayOfWeek-1].label),ge},Te=()=>{const ge=(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(z.U,{title:be?.name}),(0,C.jsx)(T.X,{timeZone:de.timezone,timestamp:Ee})]});return Se?(0,C.jsxs)(C.Fragment,{children:["Dashboard timezone (",ge,")"]}):ge},Le=(ge,xe)=>{const je=ge?ge.format("HH:mm"):void 0;me(xe==="from"?{...de,from:je}:{...de,to:je})},Ge=ge=>{me({...de,timezone:ge})},Me=ge=>{me({...de,mode:ge})},De=ge=>{me({...de,cronExpr:ge})},Ke=ge=>{me({...de,duration:ge})},Ie=ge=>{const xe=ge?ge.value:void 0,je=ge?de.toDayOfWeek:void 0;me({...de,fromDayOfWeek:xe,toDayOfWeek:je})},Ne=ge=>{me({...de,toDayOfWeek:ge?ge.value:void 0})},ie=()=>Xe?(0,C.jsx)(W.U,{value:de.timezone,includeInternal:!0,onChange:ge=>Ge(ge),onBlur:()=>Qe(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,C.jsxs)("div",{className:Pe.timezoneContainer,children:[(0,C.jsx)("div",{className:Pe.timezone,children:Te()}),(0,C.jsx)(A.$n,{variant:"secondary",onClick:we,size:"sm",children:"Change timezone"})]}),ve=$e(de.from),fe=$e(de.to);return(0,C.jsxs)(P.n,{className:Pe.wrapper,children:[(0,C.jsx)(b.D,{label:(0,w.t)("dashboard-settings.time-regions.advanced-label","Advanced"),description:(0,C.jsxs)(C.Fragment,{children:[(0,w.t)("dashboard-settings.time-regions.advanced-description-use","Use "),(0,C.jsx)("a",{href:"https://crontab.run/",target:"_blank",children:(0,w.t)("dashboard-settings.time-regions.advanced-description-cron","Cron syntax")}),(0,w.t)("dashboard-settings.time-regions.advanced-description-rest"," to define a recurrence schedule and duration")]}),children:(0,C.jsx)(M.d,{id:"time-regions-adanced-mode-toggle",value:de.mode==="cron",onChange:ge=>Me(ge.currentTarget.checked?"cron":null)})}),de.mode==null&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.D,{label:"From",children:(0,C.jsxs)(N.B,{gap:.5,children:[(0,C.jsx)(S.l6,{options:H,isClearable:!0,placeholder:"Everyday",value:de.fromDayOfWeek??null,onChange:ge=>Ie(ge),width:20}),(0,C.jsx)(K.R,{value:(0,U.Ar)(ve)?ve:void 0,onChange:ge=>Le(ge&&(0,U.AN)(ge),"from"),allowEmpty:!0,placeholder:"HH:mm",size:"sm"})]})}),(0,C.jsx)(b.D,{label:"To",children:(0,C.jsxs)(N.B,{gap:.5,children:[(de.fromDayOfWeek||de.toDayOfWeek)&&(0,C.jsx)(S.l6,{options:H,isClearable:!0,placeholder:Fe(),value:de.toDayOfWeek??null,onChange:ge=>Ne(ge),width:20}),(0,C.jsx)(K.R,{value:(0,U.Ar)(fe)?fe:void 0,onChange:ge=>Le(ge&&(0,U.AN)(ge),"to"),allowEmpty:!0,placeholder:"HH:mm",size:"sm"})]})})]}),de.mode==="cron"&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.D,{label:"Cron expression",children:(0,C.jsx)(V.p,{onChange:ge=>De(ge.target.value),value:de.cronExpr,placeholder:"0 9 * * 1-5",width:40})}),(0,C.jsx)(b.D,{label:"Duration",children:(0,C.jsx)(V.p,{onChange:ge=>Ke(ge.target.value),value:de.duration,placeholder:"8h",width:40})})]}),(0,C.jsx)(b.D,{label:"Timezone",children:ie()})]})},X=de=>({wrapper:(0,l.css)({maxWidth:de.spacing(60),marginBottom:de.spacing(2)}),timezoneContainer:(0,l.css)({padding:"5px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:"12px"}),timezone:(0,l.css)({marginRight:"5px"})}),k="Enabling this returns annotations that match any of the tags specified below",_=(0,C.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),ee=[{label:"Dashboard",value:L.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:L.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],J=[{label:"Annotations & Alerts",value:L.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:L.nj.TimeRegions,description:"Configure a repeating time region"}],Z=[10,50,100,200,300,500,1e3,2e3].map(de=>({label:String(de),value:de}));function te({query:de,onChange:me}){const Pe=de,{limit:Ee,matchAny:be,tags:Se,type:Xe,queryType:Qe}=Pe;let we=Qe??L.nj.Annotations;const $e=(0,v.useMemo)(()=>(0,D.UA)().dashboard?.getTimezone(),[]),Fe=(0,y.of)(ae),Te=Ie=>me({...Pe,type:Ie.value}),Le=Ie=>me({...Pe,limit:Ie.value}),Ge=Ie=>me({...Pe,matchAny:Ie.target.checked}),Me=Ie=>me({...Pe,tags:Ie}),De=Ie=>{const Ne={...Pe,queryType:Ie.value};Ne.queryType===L.nj.TimeRegions?Ne.timeRegion||(Ne.timeRegion={timezone:$e}):delete Ne.timeRegion,me(Ne)},Ke=Ie=>{me({...Pe,timeRegion:Ie})};return(0,C.jsxs)(P.n,{className:Fe.container,children:[(0,C.jsx)(b.D,{label:"Query type",children:(0,C.jsx)(S.l6,{inputId:"grafana-annotations__query-type",options:J,value:we,onChange:De})}),we===L.nj.Annotations&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.D,{label:"Filter by",children:(0,C.jsx)(S.l6,{inputId:"grafana-annotations__filter-by",options:ee,value:Xe,onChange:Te})}),(0,C.jsx)(b.D,{label:"Max limit",children:(0,C.jsx)(S.l6,{inputId:"grafana-annotations__limit",width:16,options:Z,value:Ee,onChange:Le})}),Xe===L.St.Tags&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.D,{label:"Match any",description:k,children:(0,C.jsx)(M.d,{id:"grafana-annotations__match-any",value:be,onChange:Ge})}),(0,C.jsx)(b.D,{label:"Tags",description:_,children:(0,C.jsx)(O.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:Me,tagOptions:R.vy,tags:Se??[]})})]})]}),we===L.nj.TimeRegions&&Pe.timeRegion&&(0,C.jsx)(G,{value:Pe.timeRegion,onChange:Ke})]})}const ae=de=>({container:(0,l.css)({maxWidth:de.spacing(60),marginBottom:de.spacing(2)})});var re=e(63739),ne=e(95181);function ce(de,me,Pe){const{mode:Ee,duration:be,cronExpr:Se,from:Xe,fromDayOfWeek:Qe}=me,we=Ee==null&&(Qe!=null||Xe!=null),$e=Ee==="cron"&&Se!=null&&be!=null;if(we||$e){const Fe=(0,ne.i)(me,Pe);if(Fe.length>0)return{fields:[{name:"time",type:re.PU.time,values:Fe.map(Le=>Le.from),config:{}},{name:"timeEnd",type:re.PU.time,values:Fe.map(Le=>Le.to),config:{}},{name:"text",type:re.PU.string,values:Array(Fe.length).fill(de),config:{}}],length:Fe.length}}}let le=100;class he extends o.iy{constructor(me){super(me),this.annotations={QueryEditor:te,prepareAnnotation(Pe){return Pe.target=Pe.target??{type:Pe.type??L.St.Dashboard,limit:Pe.limit??100,tags:Pe.tags??[],matchAny:Pe.matchAny??!1},Pe},prepareQuery(Pe){let Ee;if((0,t.isString)(Pe.datasource)){const Xe=(0,h.og)(Pe.datasource,{returnDefaultAsNull:!1});Xe&&(Ee=Xe)}else Ee=Pe.datasource;const{filter:be,...Se}=Pe;return{...Se,refId:Pe.name,queryType:L.nj.Annotations,datasource:Ee}}}}getDefaultQuery(){return{queryType:L.nj.RandomWalk}}query(me){const Pe=[],Ee=[],be=(0,E.w)();for(const Se of me.targets){if(Se.queryType===L.nj.Annotations)return(0,n.H)(this.getAnnotations({range:me.range,rangeRaw:me.range.raw,annotation:Se,dashboard:(0,D.UA)().getCurrent()}));if(!Se.hide){if(Se.queryType===L.nj.Snapshot){Pe.push((0,r.of)({data:(Se.snapshot??[]).map(Xe=>(0,x.or)(Xe)),state:s.Gu.Done}));continue}if(Se.queryType===L.nj.TimeRegions){const Xe=ce("",Se.timeRegion,me.range);Pe.push((0,r.of)({data:Xe?[Xe]:[],state:s.Gu.Done}));continue}if(Se.queryType===L.nj.LiveMeasurements){let Xe=be.replace(Se.channel,me.scopedVars);const{filter:Qe}=Se,we=(0,c.DG)(Xe);if(!(0,c.aj)(we))continue;const $e={maxLength:me.maxDataPoints??500};Se.buffer?($e.maxDelta=Se.buffer,$e.maxLength=$e.maxLength*2):me.rangeRaw?.to==="now"&&($e.maxDelta=me.range.to.valueOf()-me.range.from.valueOf()),Pe.push((0,m.oF)().getDataStream({key:`${me.requestId}.${le++}`,addr:we,filter:Qe,buffer:$e}))}else Se.queryType||(Se.queryType=L.nj.RandomWalk),Ee.push(Se)}}return Ee.length&&Pe.push(super.query({...me,targets:Ee})),Pe.length?Pe.length===1?Pe[0]:(0,a.h)(...Pe):(0,r.of)()}listFiles(me,Pe){return this.query({targets:[{refId:"A",queryType:L.nj.List,path:me}],maxDataPoints:Pe}).pipe((0,i.T)(Ee=>{const be=Ee.data[0]??new d.k;return new u.R(be)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(me){const Pe=me.annotation.target;if(Pe?.queryType===L.nj.TimeRegions){const Qe=ce(me.annotation.name,Pe.timeRegion,me.range);return Promise.resolve({data:Qe?[Qe]:[]})}const Ee=me.annotation,be=Ee.target,Se={from:me.range.from.valueOf(),to:me.range.to.valueOf(),limit:be.limit,tags:be.tags,matchAny:be.matchAny};if(be.type===L.St.Dashboard){if(!me.dashboard?.uid)return Promise.resolve({data:[]});Se.dashboardUID=me.dashboard.uid,delete Se.tags}else{if(!Array.isArray(be.tags)||be.tags.length===0)return Promise.resolve({data:[]});const Qe=(0,E.w)(),we="__delimiter__",$e=[];for(const Fe of Se.tags){const Te=Qe.replace(Fe,{},Le=>typeof Le=="string"?Le:Le.join(we));for(const Le of Te.split(we))$e.push(Le)}Se.tags=$e}const Xe=await(0,f.AI)().get("/api/annotations",Se,`grafana-data-source-annotations-${Ee.name}-${me.dashboard?.uid}`);return{data:[(0,g.Vc)(Xe)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function oe(){return await(0,p.l)().get("-- Grafana --")}},92980:(q,j,e)=>{"use strict";e.d(j,{St:()=>a,dx:()=>r,nj:()=>t,uJ:()=>n});var t=(i=>(i.LiveMeasurements="measurements",i.Annotations="annotations",i.Snapshot="snapshot",i.TimeRegions="timeRegions",i.RandomWalk="randomWalk",i.List="list",i.Read="read",i.Search="search",i.SearchNext="searchNext",i))(t||{});const n={refId:"A",queryType:"randomWalk"},r={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var a=(i=>(i.Dashboard="dashboard",i.Tags="tags",i))(a||{})},45288:(q,j,e)=>{"use strict";e.d(j,{H:()=>s,j:()=>d});var t=e(26701),n=e(22492),r=e(88214),a=e(62709),i=e(91830),x=e(92980);function s(u,g){return new Promise(o=>{if(u.datasource?.uid===r.vv){c(g,u),o(!0);return}n.A.publish(new i.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{c(g,u),o(!0)},onDismiss:()=>{o(!1)}}))})}function c(u,g){const o=u.map(m=>(0,t.Nw)(m)),E={refId:"A",queryType:x.nj.Snapshot,snapshot:o,datasource:{uid:r.vv}};g.updateQueries({dataSource:{uid:r.vv},queries:[E]}),g.refresh()}function d(u){return(g,o,E)=>{a.vI(g).subscribe(async m=>{const f=[];m.dataFrames.forEach(p=>{const h=(0,t.Nw)(p);f.push(h)}),u({...x.dx,snapshot:f,file:m.file},o)})}}},90374:(q,j,e)=>{"use strict";e.d(j,{BI:()=>f,TO:()=>m,iB:()=>D,kl:()=>C,w7:()=>p,wU:()=>v});var t=e(74848),n=e(2543),r=e.n(n),a=e(96540),i=e(32370),x=e(48583),s=e(79172),c=e(60641),d=e(60484),u=e(34128),g=e(44826),o=e(36745),E=e(57903);const m=[{value:E.U3.Range,label:"Range",description:"Run query over a range of time."},{value:E.U3.Instant,label:"Instant",description:'Run query against a single point in time. For this query, the "To" time is used.'}],f=[{value:E.ti.Backward,label:"Backward",description:"Search in backward direction."},{value:E.ti.Forward,label:"Forward",description:"Search in forward direction."}];i.$.featureToggles.lokiShardSplitting&&f.push({value:E.ti.Scan,label:"Scan",description:"Experimental. Split the query into smaller units and stop at the requested log line limit.",icon:"exclamation-triangle"});function p(y){return f.find(P=>P.value===y)?.label??"Unknown"}i.$.featureToggles.lokiExperimentalStreaming&&m.push({value:E.U3.Stream,label:"Stream",description:"Run a query and keep sending results on an interval"});const D=[{value:1,label:"1/1"}].concat((0,n.map)([2,3,4,5,10],y=>({value:y,label:"1/"+y})));function C(y){const{lineLimitValue:P,resolution:b,onRunQuery:S,runOnBlur:M,onChange:O}=y,R=y.query??{},L=(0,o.Io)(R);function B(A){const N={...R,maxLines:v(A)};O(N)}function F(A){const{instant:N,range:K,...V}=R;O({...V,queryType:A})}function I(A){R.maxLines!==v(A.currentTarget.value)&&B(A.currentTarget.value)}function U(A){A.key==="Enter"&&S()}function W(A){const N={...R,resolution:A.value};O(N)}return(0,t.jsxs)(x.B,{alignItems:"flex-start",gap:.5,"aria-label":"Loki extra field",children:[(0,t.jsxs)(x.B,{wrap:"nowrap",gap:0,"data-testid":"queryTypeField","aria-label":"Query type field",children:[(0,t.jsx)(s.I,{width:"auto",children:"Query type"}),(0,t.jsx)(c.z,{options:m,value:L,onChange:A=>{F(A),M&&S()}})]}),(0,t.jsxs)(x.B,{wrap:"nowrap",gap:0,"data-testid":"lineLimitField","aria-label":"Line limit field",children:[(0,t.jsx)(d.I,{label:"Line limit",tooltip:"Upper limit for number of log lines returned by query.",children:(0,t.jsx)(u.p,{className:"width-4",placeholder:"auto",type:"number",min:0,onChange:I,onKeyDown:U,value:P,onBlur:()=>{M&&S()}})}),(0,t.jsx)(d.I,{label:"Resolution",tooltip:"Resolution 1/1 sets step parameter of Loki metrics range queries such that each pixel corresponds to one data point. For better performance, lower resolutions can be picked. 1/2 only retrieves a data point for every other pixel, and 1/10 retrieves one data point per 10 pixels.",children:(0,t.jsx)(g.l6,{isSearchable:!1,onChange:W,options:D,value:b,"aria-label":"Select resolution"})})]})]})}var l=(0,a.memo)(C);function v(y){const P=parseInt(y,10);if(!(isNaN(P)||P<0))return P}},30215:(q,j,e)=>{"use strict";e.d(j,{W:()=>s});var t=e(74848),n=e(96540),r=e(91529);const a=(0,n.lazy)(()=>e.e(1952).then(e.bind(e,17290))),i=c=>(0,t.jsx)(n.Suspense,{fallback:null,children:(0,t.jsx)(a,{...c})}),x=c=>{const d=(0,n.useRef)(null),{onRunQuery:u,onChange:g,...o}=c,E=f=>{d.current=f,g(f),u()},m=f=>{g(f)};return(0,t.jsx)(i,{onRunQuery:E,onBlur:m,onChange:g,...o})};class s extends n.PureComponent{constructor(d){super(d),this._isMounted=!1,this.onChangeQuery=(u,g)=>{const{query:o,onChange:E,onRunQuery:m}=this.props;if(E){const f={...o,expr:u};E(f),g&&m&&m()}},this.state={labelsLoaded:!1}}async componentDidMount(){this._isMounted=!0,await this.props.datasource.languageProvider.start(this.props.range),this._isMounted&&this.setState({labelsLoaded:!0})}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(d){const{range:u,datasource:{languageProvider:g}}=this.props;(0,r.WV)(u,d.range)&&g.fetchLabels({timeRange:u})}render(){const{ExtraFieldElement:d,query:u,datasource:g,history:o,onRunQuery:E,range:m}=this.props,f=this.props.placeholder??"Enter a Loki query (run with Shift+Enter)";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:(0,t.jsx)("div",{className:"gf-form--grow flex-shrink-1 min-width-15",children:(0,t.jsx)(x,{datasource:g,history:o??[],onChange:this.onChangeQuery,onRunQuery:E,initialValue:u.expr??"",placeholder:f,timeRange:m})})}),d]})}}},35747:(q,j,e)=>{"use strict";e.d(j,{B:()=>n,a:()=>x});var t=e(31451);function n(s,c,d,u){if(!s)return!1;const g=r(c,u);if(!g.length)return!1;let o=g;if(s!==c){const E=r(s,u);o=g.flatMap(m=>E.filter(f=>m.text===f.text)||m)}return o.map(E=>a(s,d,E)).filter(i)}function r(s,c){const d=[];return c.parse(s).iterate({enter:g=>{if(g.type.id===t.Ql){const o=g.node;d.push({node:o,text:s.substring(o.from,o.to)})}}}),d}function a(s,c,d){if(c.length===1){const o=d.node.from===d.node.to,E=o&&d.node.parent?d.node.parent:d.node,m=o?s.substring(E.from,E.to):d.text;return{startLineNumber:1,startColumn:E.from+1,endLineNumber:1,endColumn:E.to+1,error:m}}let u=0,g=0;for(let o=0;o<c.length;o++){if(g=u+c[o].length,d.node.from>g){u+=c[o].length+1;continue}return{startLineNumber:o+1,startColumn:d.node.from-u+1,endLineNumber:o+1,endColumn:d.node.to-u+1,error:d.text}}return null}function i(s){return s!==null}const x={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}}},24694:(q,j,e)=>{"use strict";e.d(j,{Q$:()=>r,U3:()=>n,ti:()=>a});var t=(i=>(i.Builder="builder",i.Code="code",i))(t||{}),n=(i=>(i.Instant="instant",i.Range="range",i.Stream="stream",i))(n||{}),r=(i=>(i.DataSample="dataSample",i.InfiniteScroll="infiniteScroll",i.LogsSample="logsSample",i.LogsVolume="logsVolume",i))(r||{}),a=(i=>(i.Backward="backward",i.Forward="forward",i.Scan="scan",i))(a||{})},38275:(q,j,e)=>{"use strict";e.d(j,{we:()=>Et,VQ:()=>ms,lb:()=>Wt,Gf:()=>gt,M1:()=>Vt,ow:()=>dn,mL:()=>Ft,In:()=>ts});var t=e(2543),n=e(13288),r=e(44240),a=e(62467),i=e(75505),x=e(81160),s=e(66847),c=e(59099),d=e(63720),u=e(59577),g=e(8392),o=e(18163),E=e(16753),m=e(93407),f=e(94626),p=e(52733),h=e(36195),D=e(65502),C=e(39736),l=e(32370),v=e(16910),y=e(59303),P=e(29997),b=e(55801),S=e(91529),M=e(36745),O=e(3152),R=e(45331),L=e(57903);const B=1e6,F="{}",I=["__aggregrated_metric__","__tenant_id__","__stream_shard__"];class U extends P.Is{constructor(ot,ct){super(),this.started=!1,this.seriesCache=new y.q({max:10}),this.labelsCache=new y.q({max:10}),this.detectedFieldValuesCache=new y.q({max:10}),this.labelsPromisesCache=new y.q({max:10}),this.detectedLabelValuesPromisesCache=new y.q({max:10}),this.request=async(ft,vt,Kt,Zt)=>{try{return await this.datasource.metadataRequest(ft,vt,Zt)}catch(tn){if(Kt)throw tn;console.error(tn)}},this.start=ft=>{const vt=ft??this.getDefaultTimeRange(),Kt=this.datasource.getTimeRangeParams(vt),Zt=this.startedTimeRange?this.datasource.getTimeRangeParams(this.startedTimeRange):null;return(!this.startTask||!Zt||Kt.start!==Zt.start||Kt.end!==Zt.end)&&(this.startedTimeRange=vt,this.startTask=this.fetchLabels({timeRange:vt}).then(()=>(this.started=!0,[]))),this.startTask},this.fetchSeriesLabels=async(ft,vt)=>{const Kt=this.datasource.interpolateString(ft),Zt="series",tn=vt?.timeRange??this.getDefaultTimeRange(),{start:En,end:Ln}=this.datasource.getTimeRangeParams(tn),Gn=this.generateCacheKey(Zt,En,Ln,Kt);let Hn=this.seriesCache.get(Gn);if(!Hn){const Qn={"match[]":Kt,start:En,end:Ln},cs=await this.request(Zt,Qn);if(!Array.isArray(cs))return{};const{values:vs}=(0,S.P7)(cs);Hn=vs,this.seriesCache.set(Gn,Hn)}return Hn},this.fetchSeries=async(ft,vt)=>{const Kt="series",Zt=vt?.timeRange??this.getDefaultTimeRange(),{start:tn,end:En}=this.datasource.getTimeRangeParams(Zt),Ln={"match[]":ft,start:tn,end:En};return await this.request(Kt,Ln)},this.datasource=ot,this.labelKeys=[],Object.assign(this,ct)}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(ot){return{refId:ot.refId,expr:(0,S.tt)(ot),queryType:L.U3.Range}}exportToAbstractQuery(ot){if(!ot.expr||ot.expr.length===0)return{refId:ot.refId,labelMatchers:[]};const ft=(0,M.pk)(ot.expr).map(vt=>(0,O.u_)(vt).query.labels.map(tn=>({name:tn.label,value:tn.value,operator:S.sM[tn.op]})));return{refId:ot.refId,labelMatchers:(0,t.flatten)(ft)}}async fetchLabels(ot){if(l.$.featureToggles.lokiLabelNamesQueryApi||!ot?.streamSelector)return this.fetchLabelsByLabelsEndpoint(ot);{const ct=await this.fetchSeriesLabels(ot.streamSelector,{timeRange:ot.timeRange});return Object.keys(ct??{})}}async fetchLabelsByLabelsEndpoint(ot){const ct="labels",ft=ot?.timeRange??this.getDefaultTimeRange(),{start:vt,end:Kt}=this.datasource.getTimeRangeParams(ft),Zt={start:vt,end:Kt};ot?.streamSelector&&ot?.streamSelector!==F&&(Zt.query=ot.streamSelector);const tn=await this.request(ct,Zt);if(Array.isArray(tn)){const En=Array.from(new Set(tn)).slice().sort().filter(Ln=>I.includes(Ln)===!1);return this.labelKeys=En,this.labelKeys}return[]}generateCacheKey(ot,ct,ft,vt){return[ot,this.roundTime(ct),this.roundTime(ft),vt].join()}roundTime(ot){return ot?Math.floor(ot/B/1e3/60/5):0}async fetchDetectedFields(ot,ct){const ft=ot.expr&&ot.expr!==F?this.datasource.interpolateString(ot.expr,ot.scopedVars):void 0;if(!ft)throw new Error("fetchDetectedFields requires query expression");const vt="detected_fields",Kt=ot?.timeRange??this.getDefaultTimeRange(),Zt=this.datasource.getTimeRangeParams(Kt),{start:tn,end:En}=Zt,Ln={start:tn,end:En,limit:ot?.limit??1e3};return Ln.query=ft,new Promise(async(Gn,Hn)=>{try{const Qn=await this.request(vt,Ln,!0,ct);Gn(Qn)}catch(Qn){console.error("error",Qn),Hn(Qn)}})}async fetchDetectedFieldValues(ot,ct,ft){return this.fetchDetectedLabelValues(ot,ct,ft)}async fetchDetectedLabelValues(ot,ct,ft){const vt=encodeURIComponent(this.datasource.interpolateString(ot)),Kt=ct?.expr&&ct.expr!==F?this.datasource.interpolateString(ct.expr,ct.scopedVars):void 0,Zt=`detected_field/${vt}/values`,tn=ct?.timeRange??this.getDefaultTimeRange(),En=this.datasource.getTimeRangeParams(tn),{start:Ln,end:Gn}=En,Hn={start:Ln,end:Gn,limit:ct?.limit??1e3};let Qn=vt;Kt&&(Hn.query=Kt,Qn+=Kt);const cs=this.generateCacheKey(Zt,Ln,Gn,Qn),vs=this.detectedFieldValuesCache.get(cs);if(vs)return vs;let hs=this.detectedLabelValuesPromisesCache.get(cs);return hs||(hs=new Promise(async(Vs,As)=>{try{const Ys=await this.request(Zt,Hn,ct?.throwError,ft);if(Array.isArray(Ys)){const ha=Ys.slice().sort();this.detectedFieldValuesCache.set(cs,ha),this.detectedLabelValuesPromisesCache.delete(cs),Vs(ha)}}catch(Ys){ct?.throwError?As(Ys):(console.error(Ys),Vs([]))}}),this.detectedLabelValuesPromisesCache.set(cs,hs),hs)}async fetchLabelValues(ot,ct){const ft=encodeURIComponent(this.datasource.interpolateString(ot)),vt=ct?.streamSelector&&ct.streamSelector!==F?this.datasource.interpolateString(ct.streamSelector):void 0,Kt=`label/${ft}/values`,Zt=ct?.timeRange??this.getDefaultTimeRange(),tn=this.datasource.getTimeRangeParams(Zt),{start:En,end:Ln}=tn,Gn={start:En,end:Ln};let Hn=ft;vt&&(Gn.query=vt,Hn+=vt);const Qn=this.generateCacheKey(Kt,En,Ln,Hn),cs=this.labelsCache.get(Qn);if(cs)return cs;let vs=this.labelsPromisesCache.get(Qn);return vs||(vs=new Promise(async hs=>{try{const Vs=await this.request(Kt,Gn);if(Array.isArray(Vs)){const As=Vs.slice().sort();this.labelsCache.set(Qn,As),this.labelsPromisesCache.delete(Qn),hs(As)}}catch(Vs){console.error(Vs),hs([])}}),this.labelsPromisesCache.set(Qn,vs),vs)}async getParserAndLabelKeys(ot,ct){const ft={extractedLabelKeys:[],structuredMetadataKeys:[],unwrapLabelKeys:[],hasJSON:!1,hasLogfmt:!1,hasPack:!1};if(!l.$.featureToggles.lokiQueryHints)return ft;const vt=await this.datasource.getDataSamples({expr:ot,refId:"data-samples",maxLines:ct?.maxLines||Et},ct?.timeRange??this.getDefaultTimeRange());if(!vt.length)return ft;const{hasLogfmt:Kt,hasJSON:Zt,hasPack:tn}=(0,R.YB)(vt[0]);return{extractedLabelKeys:[...(0,R.fV)(vt[0],L.HD.Indexed),...(0,R.fV)(vt[0],L.HD.Parsed)],structuredMetadataKeys:(0,R.fV)(vt[0],L.HD.StructuredMetadata),unwrapLabelKeys:(0,R.aN)(vt[0]),hasJSON:Zt,hasPack:tn,hasLogfmt:Kt}}getDefaultTimeRange(){return(0,b.E2)()}}var W=e(39697),A=e(37748),N=e(69862),K=e(69850),V=e(21281),T=e(24616),z=e(63739),w=e(60126);const H="6ec946da-0f49-47a8-983a-1d76d17e7c92";function G(Yt,ot){const ct=Yt.streams;if(!ct||!ct.length)return;const ft=ot.fields[0],vt=ot.fields[1],Kt=ot.fields[2],Zt={};for(const tn of ct){const En=Object.entries(tn.stream).map(([Ln,Gn])=>`${Ln}="${Gn}"`).sort().join("");for(const[Ln,Gn]of tn.values)ft.values.push(new Date(parseInt(Ln.slice(0,-6),10)).toISOString()),vt.values.push(Gn),Kt.values.push(X(Ln,En,Gn,Zt,ot.refId))}}function X(Yt,ot,ct,ft,vt){let Kt=(0,w.Ay)(`${Yt}_${ot}_${ct}`,H);if(Kt in ft){const Zt=ft[Kt]+1;ft[Kt]=Zt,Kt=`${Kt}_${Zt}`}else ft[Kt]=0;return vt?`${vt}_${Kt}`:Kt}class k{constructor(){this.streams={}}getStream(ot,ct=5e3){let ft=this.streams[ot.url];if(ft)return ft;const vt=new T.x({capacity:ot.size});return vt.addField({name:"Time",type:z.PU.time,config:{}}),vt.addField({name:"Line",type:z.PU.string}),vt.addField({name:"id",type:z.PU.string}),vt.meta={...vt.meta,preferredVisualisationType:"logs"},vt.refId=ot.refId,ft=(0,V.K)(ot.url).pipe((0,x.T)(Kt=>(G(Kt,vt),[vt])),(0,A.l)(Kt=>Kt.pipe((0,N.Z)((Zt,tn)=>{const En=tn+1;return Zt.code===1006&&En<30?(En>10&&console.warn(`Websocket connection is being disrupted. We keep reconnecting but consider starting new live tailing again. Error: ${Zt.reason}`),(0,W.O)(ct)):(0,n.$)(Zt)}))),(0,K.j)(()=>{delete this.streams[ot.url]})),this.streams[ot.url]=ft,ft}}var _=e(3202),ee=e(38790),J=e(74848),Z=e(22803),te=e(96540),ae=e(16817),re=e(60997),ne=e(54078),ce=e(56276),le=e(29675),he=e(37e3),oe=e(6736),de=e(54594),me=e(43192),Pe=e(79784),Ee=e(20968),be=e(40271),Se=e(44826),Xe=e(77222),Qe=e(60484),we=e(15600),$e=e(29010),Fe=e(14191);function Te(Yt){return{labels:(0,Z.css)({display:"flex",gap:Yt.spacing(.5)}),wrapper:(0,Z.css)({display:"flex",flexDirection:"column",flex:1,gap:Yt.spacing(.5),position:"relative"}),textWrapper:(0,Z.css)({display:"flex",alignItems:"center"}),hidden:(0,Z.css)({visibility:"hidden"}),label:(0,Z.css)({maxWidth:"100%","&:first-of-type":{marginBottom:Yt.spacing(2)},"&:not(:first-of-type)":{margin:Yt.spacing(2,0)}}),rawQueryContainer:(0,Z.css)({textAlign:"start",lineBreak:"anywhere",marginTop:Yt.spacing(-.25),marginRight:Yt.spacing(6),minHeight:Yt.spacing(4)}),ui:(0,Z.css)({backgroundColor:Yt.colors.background.secondary,padding:Yt.spacing(2)}),notification:(0,Z.css)({position:"absolute",zIndex:Yt.zIndex.portal,top:0,right:0}),rawQuery:(0,Z.css)({display:"inline"}),queryDescription:(0,Z.css)({marginLeft:Yt.spacing(.5)}),iconButton:(0,Z.css)({position:"absolute",top:Yt.spacing(1),right:Yt.spacing(1),zIndex:Yt.zIndex.navbarFixed}),operationsToggle:(0,Z.css)({margin:Yt.spacing(1,0,-1,0),"& > div":{margin:0,"& > label":{padding:0}}})}}const Le="isLogContextQueryUiOpen";function Ge(Yt){const{row:ot,logContextProvider:ct,updateFilter:ft,onClose:vt,origQuery:Kt,runContextQuery:Zt}=Yt,tn=(0,le.of)(Te),[En,Ln]=(0,te.useState)([]),[Gn,Hn]=(0,te.useState)(!1),[Qn,cs]=(0,te.useState)(!1),[vs,hs]=(0,te.useState)(!1),[Vs,As]=(0,te.useState)(window.localStorage.getItem(Le)==="true"),[Ys,ha]=(0,te.useState)(window.localStorage.getItem(ve)==="true"),Da=(0,te.useRef)(),Sa=(0,te.useRef)(!1),na=(0,te.useRef)([]),Zs=(0,te.useMemo)(()=>!(Qn&&En.some(pt=>pt.nonIndexed===pt.enabled)||Ys&&ct.queryContainsValidPipelineStages(Kt)),[En,Ys,Qn,ct,Kt]);(0,te.useEffect)(()=>{if(Qn){if(!Sa.current){Sa.current=Qn;return}if(En.filter(({enabled:pt,nonIndexed:Xt})=>pt&&!Xt).length===0){Ln(na.current);return}return na.current=structuredClone(En),Da.current&&clearTimeout(Da.current),hs(!0),Da.current=window.setTimeout(()=>{ft(En.filter(({enabled:Xt})=>Xt));const pt={removedLabels:[],selectedExtractedLabels:[]};En.forEach(({enabled:Xt,nonIndexed:hn,label:Sn})=>{!Xt&&!hn&&pt.removedLabels.push(Sn),Xt&&hn&&pt.selectedExtractedLabels.push(Sn)}),window.localStorage.setItem(ie,JSON.stringify(pt)),hs(!1)},1500),()=>{clearTimeout(Da.current)}}},[En,Qn]),(0,te.useEffect)(()=>()=>{clearTimeout(Da.current),vt()},[vt]),(0,ae.A)(async()=>{hs(!0);const pt=await ct.getInitContextFilters(ot,Kt,{from:(0,_.KQ)(ot.timeEpochMs),to:(0,_.KQ)(ot.timeEpochMs),raw:{from:(0,_.KQ)(ot.timeEpochMs),to:(0,_.KQ)(ot.timeEpochMs)}});Ln(pt.contextFilters),Hn(pt.preservedFiltersApplied),cs(!0),hs(!1)}),(0,te.useEffect)(()=>{Gn&&setTimeout(()=>{Hn(!1)},2e3)},[Gn]),(0,te.useEffect)(()=>((0,ce.rR)("grafana_explore_logs_loki_log_context_loaded",{logRowUid:ot.uid,type:"load"}),()=>{(0,ce.rR)("grafana_explore_logs_loki_log_context_loaded",{logRowUid:ot.uid,type:"unload"})}),[ot.uid]);const sa=En.filter(({nonIndexed:pt})=>!pt),Ha=sa.filter(({enabled:pt})=>pt),Ma=En.filter(({nonIndexed:pt})=>pt),fa=Ma.filter(({enabled:pt})=>pt),Rs=(0,te.useCallback)(pt=>({label:`${pt.label}="${(0,S.Bb)(pt.value)}"`,value:pt.label}),[]),xa=Ma.length>0;let fr=ct.prepareExpression(En.filter(({enabled:pt})=>pt),Kt);return(0,J.jsxs)("div",{className:tn.wrapper,children:[Gn&&(0,J.jsx)(he.F,{className:tn.notification,title:"Previously used filters have been applied.",severity:"info",elevated:!0}),(0,J.jsx)(oe.m,{content:"Revert to initial log context query.",children:(0,J.jsx)("div",{className:tn.iconButton,children:(0,J.jsx)(de.$n,{"data-testid":"revert-button",icon:"history-alt",variant:"secondary",disabled:Zs,onClick:pt=>{(0,ce.rR)("grafana_explore_logs_loki_log_context_reverted",{logRowUid:ot.uid}),Ln(Xt=>Xt.map(hn=>({...hn,enabled:!hn.nonIndexed}))),window.localStorage.removeItem(ie),window.localStorage.removeItem(ve),ha(!1)}})})}),(0,J.jsx)(me.S,{collapsible:!0,isOpen:Vs,onToggle:()=>{window.localStorage.setItem(Le,(!Vs).toString()),As(pt=>!pt),(0,ce.rR)("grafana_explore_logs_loki_log_context_toggled",{logRowUid:ot.uid,action:Vs?"close":"open"})},label:(0,J.jsx)("div",{className:tn.rawQueryContainer,children:Qn?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ne.Z,{language:{grammar:Fe.vB,name:"loki"},query:fr,className:tn.rawQuery}),(0,J.jsx)(oe.m,{content:"The initial log context query is created from all labels defining the stream for the selected log line. Use the editor below to customize the log context query.",children:(0,J.jsx)(Pe.I,{name:"info-circle",size:"sm",className:tn.queryDescription})})]}):(0,J.jsx)(Ee.y,{})}),children:(0,J.jsxs)("div",{className:tn.ui,children:[(0,J.jsx)(be.J,{className:tn.label,description:"The initial log context query is created from all labels defining the stream for the selected log line. You can broaden your search by removing one or more of the label filters.",children:"Widen the search"}),(0,J.jsx)(Se.KF,{isLoading:vs,options:sa.map(Rs),value:Ha.map(Rs),closeMenuOnSelect:!0,maxMenuHeight:200,noOptionsMessage:"No further labels available",onChange:(pt,Xt)=>(Xt.action==="select-option"&&(0,ce.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:ot.uid,type:"label",action:"select"}),Xt.action==="remove-value"&&(0,ce.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:ot.uid,type:"label",action:"remove"}),Ln(En.map(hn=>(hn.nonIndexed||(hn.enabled=pt.some(Sn=>Sn.value===hn.label)),hn))))}),xa&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(be.J,{className:tn.label,description:"By using a parser in your original query, you can use filters for extracted labels. Refine your search by applying extracted labels created from the selected log line.",children:"Refine the search"}),(0,J.jsx)(Se.KF,{isLoading:vs,options:Ma.map(Rs),value:fa.map(Rs),closeMenuOnSelect:!0,maxMenuHeight:200,noOptionsMessage:"No further labels available",isClearable:!0,onChange:(pt,Xt)=>{Xt.action==="select-option"&&(0,ce.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:ot.uid,type:"parsed_label",action:"select"}),Xt.action==="remove-value"&&(0,ce.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:ot.uid,type:"parsed_label",action:"remove"}),Ln(En.map(hn=>(hn.nonIndexed&&(hn.enabled=pt.some(Sn=>Sn.value===hn.label)),hn)))}})]}),ct.queryContainsValidPipelineStages(Kt)&&(0,J.jsx)(Xe.C,{className:tn.operationsToggle,children:(0,J.jsx)(Qe.I,{label:"Include LogQL pipeline operations",tooltip:(0,J.jsx)(we.I,{content:(0,re.G)("This will include LogQL operations such as `line_format` or `label_format`. It won't include line or label filter operations.")}),children:(0,J.jsx)($e.K,{value:Ys,showLabel:!0,transparent:!0,onChange:pt=>{(0,ce.rR)("grafana_explore_logs_loki_log_context_pipeline_toggled",{logRowUid:ot.uid,action:pt.currentTarget.checked?"enable":"disable"}),window.localStorage.setItem(ve,pt.currentTarget.checked.toString()),ha(pt.currentTarget.checked),Zt&&Zt()}})})})]})})]})}var Me=e(98388),De=(Yt=>(Yt[Yt.Ascending=0]="Ascending",Yt[Yt.Descending=1]="Descending",Yt))(De||{});function Ke(Yt,ot){const ct=Yt.values,{nanos:ft}=Yt,vt=Array(ct.length);for(let Zt=0;Zt<vt.length;Zt++)vt[Zt]=Zt;const Kt=ot===0;return vt.sort((Zt,tn)=>{const En=ct[Zt],Ln=ct[tn];if(En<Ln)return Kt?-1:1;if(En>Ln)return Kt?1:-1;if(ft===void 0)return 0;const Gn=ft[Zt],Hn=ft[tn];return Gn<Hn?Kt?-1:1:Gn>Hn?Kt?1:-1:0}),vt}function Ie(Yt,ot){const{fields:ct,...ft}=Yt,vt=ct.find(Zt=>Zt.type===z.PU.time);if(vt===void 0)throw new Error("missing timestamp field. should never happen");const Kt=Ke(vt,ot);return{...ft,fields:ct.map(Zt=>({...Zt,values:Ne(Zt.values,Kt),nanos:Zt.nanos===void 0?void 0:Ne(Zt.nanos,Kt)}))}}function Ne(Yt,ot){return Yt.map((ct,ft)=>Yt[ot[ft]])}const ie="lokiLogContextPreservedLabels",ve="lokiLogContextShouldIncludePipelineOperations";class fe{constructor(ot){this.getLogRowContextQuery=async(ct,ft,vt,Kt=!0)=>{vt&&ft?.scopedVars&&(vt=this.datasource.applyTemplateVariables(vt,ft?.scopedVars));const{query:Zt}=await this.getQueryAndRange(ct,ft,vt,Kt);return Kt||(this.cachedContextFilters=[]),Zt},this.getLogRowContext=async(ct,ft,vt)=>{vt&&ft?.scopedVars&&(vt=this.datasource.applyTemplateVariables(vt,ft?.scopedVars));const Kt=ft&&ft.direction||o.ZF.Backward,{query:Zt,range:tn}=await this.getQueryAndRange(ct,ft,vt),En=Gn=>{const Qn=Gn.data.map(cs=>Ie(cs,De.Descending));return{...Gn,data:Qn}},Ln=E.Jk.Explore;return(0,i.s)(this.datasource.query(ts(Zt,tn,Ln,`${Vt}${Kt}`)).pipe((0,s.W)(Gn=>{throw{message:"Error during context query. Please check JS console logs.",status:Gn.status,statusText:Gn.statusText}}),(0,d.n)(Gn=>(0,a.of)(En(Gn)))))},this.processContextFiltersToExpr=(ct,ft)=>{let Kt=`{${ct.map(Zt=>!Zt.nonIndexed&&Zt.enabled?`${Zt.label}="${(0,S.Qn)(Zt.value)}"`:"").filter(Zt=>!!Zt).join(",")}}`;if(ft){let Zt=!1;if((0,M.MX)(ft.expr).parserCount===1){Zt=!0;const En=(0,M.aw)(ft.expr);En&&(Kt=(0,Me.aH)(Kt,En))}const tn=ct.filter(En=>En.nonIndexed&&En.enabled);for(const En of tn)En.enabled&&(Kt=(0,Me.tE)(Kt,En.label,"=",En.value,Zt?L.HD.Parsed:L.HD.StructuredMetadata))}return Kt},this.processPipelineStagesToExpr=(ct,ft)=>{let vt=ct;const Kt=ft?.expr??"";if((0,M.MX)(Kt).parserCount>1)return vt;const Zt=(0,M.TQ)(Kt,[h.t3,h.iT,h.c$,h.LM,h.CX,h.bY]),tn=Zt.filter(Ln=>Ln.type?.id===h.t3),En=Zt.filter(Ln=>Ln.type?.id!==h.t3);for(const Ln of tn)En.some(Gn=>Ln.contains(Gn))||(vt+=` ${Ln.getExpression(Kt)}`);return vt},this.queryContainsValidPipelineStages=ct=>{const ft=ct?.expr??"",vt=(0,M.TQ)(ft,[h.t3,h.iT,h.CX,h.bY]),Kt=vt.filter(tn=>tn.type?.id===h.t3),Zt=vt.filter(tn=>tn.type?.id!==h.t3);return Kt.some(tn=>Zt.every(En=>tn.contains(En)===!1))},this.getInitContextFilters=async(ct,ft,vt)=>{let Kt=!1;if(!ft||(0,t.isEmpty)(ct.labels))return{contextFilters:[],preservedFiltersApplied:Kt};const Zt=ct.labels;let tn=[];if(!(0,M.MX)(ft.expr).queryWithParser)await this.datasource.languageProvider.start(vt),tn=this.datasource.languageProvider.getLabelKeys();else{const Hn=(0,M.pk)(ft.expr);tn=await this.datasource.languageProvider.fetchLabels({streamSelector:Hn[0],timeRange:vt})}const En=[];Object.entries(Zt).forEach(([Hn,Qn])=>{const cs=(0,S.Ed)(Hn,ct.dataFrame,ct.rowIndex),vs={label:Hn,value:Qn,enabled:tn.includes(Hn),nonIndexed:cs!==null&&cs!==L.HD.Indexed};En.push(vs)});let Ln;const Gn=window.localStorage.getItem(ie);if(Gn)try{Ln=JSON.parse(Gn)}catch{}if(Ln){let Hn=!1;const Qn=En.map(vs=>Ln.removedLabels.includes(vs.label)?(Hn=!0,{...vs,enabled:!1}):Ln.selectedExtractedLabels.includes(vs.label)?(Hn=!0,{...vs,enabled:!0}):{...vs});return Qn.some(({enabled:vs,nonIndexed:hs})=>vs&&!hs)?(Hn&&(Kt=!0),{contextFilters:Qn,preservedFiltersApplied:Kt}):{contextFilters:En,preservedFiltersApplied:Kt}}else return{contextFilters:En,preservedFiltersApplied:Kt}},this.datasource=ot,this.cachedContextFilters=[]}async getQueryAndRange(ot,ct,ft,vt=!0){const Kt=ct&&ct.direction||o.ZF.Backward,Zt=ct&&ct.limit||this.datasource.maxLines;if(this.cachedContextFilters.length===0||!vt){const tn=(await this.getInitContextFilters(ot,ft,{from:(0,_.KQ)(ot.timeEpochMs),to:(0,_.KQ)(ot.timeEpochMs),raw:{from:(0,_.KQ)(ot.timeEpochMs),to:(0,_.KQ)(ot.timeEpochMs)}})).contextFilters.filter(En=>En.enabled);this.cachedContextFilters=tn}return await this.prepareLogRowContextQueryTarget(ot,Zt,Kt,ft)}async prepareLogRowContextQueryTarget(ot,ct,ft,vt){const Kt=this.prepareExpression(this.cachedContextFilters,vt),Zt=2*60*60*1e3,tn=ft===o.ZF.Forward?L.ti.Forward:L.ti.Backward,En={expr:Kt,queryType:L.U3.Range,refId:`${Vt}_${Math.random().toString()}`,maxLines:ct,direction:tn,datasource:{uid:this.datasource.uid,type:this.datasource.type}},Gn=new ee.L(ot.dataFrame).getFirstFieldOfType(z.PU.time);if(Gn===void 0)throw new Error("loki: data frame missing time-field, should never happen");const Hn=Gn.values[ot.rowIndex],Qn=(0,_.yT)(Hn),cs=tn===L.ti.Forward?{from:Qn,to:(0,_.yT)(ot.timeEpochMs+Zt)}:{from:(0,_.yT)(ot.timeEpochMs-Zt),to:Qn};return{query:En,range:{from:cs.from,to:cs.to,raw:cs}}}getLogRowContextUi(ot,ct,ft,vt){ft&&vt&&(ft=this.datasource.applyTemplateVariables(ft,vt));const Kt=Zt=>{this.cachedContextFilters=Zt,ct&&ct()};return this.onContextClose=this.onContextClose??(()=>{this.cachedContextFilters=[]}),Ge({row:ot,origQuery:ft,updateFilter:Kt,onClose:this.onContextClose,logContextProvider:this,runContextQuery:ct})}prepareExpression(ot,ct){let ft=this.processContextFiltersToExpr(ot,ct);return window.localStorage.getItem(ve)==="true"&&(ft=this.processPipelineStagesToExpr(ft,ct)),ft}}var ge=e(65474),xe=e(50471),je=e(84596),Ve=e(34128);const ke=/^label_names\(\)\s*$/,Oe=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/;function nt(Yt){if(typeof Yt!="string")return Yt;const ot={refId:"LokiVariableQueryEditor-VariableQuery",type:L.ie.LabelNames};if(Yt.match(ke))return{...ot,type:L.ie.LabelNames};const ft=Yt.match(Oe);return ft?{...ot,type:L.ie.LabelValues,label:ft[2]?ft[2]:ft[1],stream:ft[2]?ft[1]:void 0}:ot}const Je=[{label:"Label names",value:L.ie.LabelNames},{label:"Label values",value:L.ie.LabelValues}],Be="LokiVariableQueryEditor-VariableQuery",Ze=({onChange:Yt,query:ot,datasource:ct,range:ft})=>{const[vt,Kt]=(0,te.useState)(void 0),[Zt,tn]=(0,te.useState)(""),[En,Ln]=(0,te.useState)([]),[Gn,Hn]=(0,te.useState)(""),Qn=(0,je.A)(vt);(0,te.useEffect)(()=>{if(!ot)return;const As=typeof ot=="string"?nt(ot):ot;Kt(As.type),tn(As.label||""),Hn(As.stream||"")},[ot]),(0,te.useEffect)(()=>{vt!==L.ie.LabelValues||Qn===vt||ct.languageProvider.fetchLabels({timeRange:ft}).then(As=>{Ln(As.map(Ys=>({label:Ys,value:Ys})))})},[ct,vt,ft,Qn]);const cs=As=>{Kt(As.value),As.value!==void 0&&Yt({type:As.value,label:Zt,stream:Gn,refId:Be})},vs=As=>{tn(As.value||"")},hs=As=>{Hn(As.currentTarget.value)},Vs=()=>{vt!==void 0&&Yt({type:vt,label:Zt,stream:Gn,refId:"LokiVariableQueryEditor-VariableQuery"})};return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(Xe.C,{children:[(0,J.jsx)(Qe.I,{label:"Query type",labelWidth:20,children:(0,J.jsx)(Se.l6,{"aria-label":"Query type",onChange:cs,onBlur:Vs,value:vt,options:Je,width:16})}),vt===L.ie.LabelValues&&(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Qe.I,{label:"Label",labelWidth:20,children:(0,J.jsx)(Se.l6,{"aria-label":"Label",onChange:vs,onBlur:Vs,value:{label:Zt,value:Zt},options:En,width:16,allowCustomValue:!0})})})]}),vt===L.ie.LabelValues&&(0,J.jsx)(Xe.C,{children:(0,J.jsx)(Qe.I,{label:"Stream selector",labelWidth:20,grow:!0,tooltip:(0,J.jsx)("div",{children:'Optional. If defined, a list of values for the specified log stream selector is returned. For example: {label="value"} or {label="$variable"}'}),children:(0,J.jsx)(Ve.p,{type:"text","aria-label":"Stream selector",placeholder:"Optional stream selector",value:Gn,onChange:hs,onBlur:Vs})})})]})};class tt extends xe.f5{constructor(ot){super(),this.datasource=ot,this.editor=Ze}async execute(ot,ct,ft){return this.datasource.metricFindQuery(ot,{scopedVars:ct,range:ft})}query(ot){const ct=this.execute(ot.targets[0],ot.scopedVars,ot.range);return(0,ge.H)(ct).pipe((0,x.T)(ft=>({data:ft})))}}var Re=e(4038),at=e(98437);function yt(Yt,ot){if(!ot.length)return[];const ct=(0,t.groupBy)(ot,"name"),ft=Object.values(ct).map(ze),vt=Yt.fields.find(Zt=>Zt.type===z.PU.string);if(vt===void 0)throw new Error("invalid logs-dataframe, string-field missing");const Kt=Yt.fields.find(Zt=>Zt.type===z.PU.other&&Zt.name==="labels");for(let Zt=0;Zt<vt.values.length;Zt++)for(const tn of ft)if(ct[tn.name][0].matcherType==="label"&&Kt){const En=Kt.values[Zt];if(En){const Ln=Object.keys(En).find(Gn=>new RegExp(ct[tn.name][0].matcherRegex).test(Gn));if(Ln){tn.values.push(En[Ln]);continue}}tn.values.push(null)}else if(ct[tn.name][0].matcherType==="regex"||ct[tn.name][0].matcherType===void 0){const Ln=vt.values[Zt].match(ct[tn.name][0].matcherRegex);if(Ln&&Ln[1]){tn.values.push(Ln[1]);continue}tn.values.push(null)}else tn.values.push(null);return ft}function ze(Yt){const ot=(0,at.l)(),ct=Yt.reduce((ft,vt)=>{if(vt.datasourceUid){const Kt=ot.getInstanceSettings(vt.datasourceUid),Zt=tn=>{switch(tn){case"tempo":return"traceql";case"grafana-x-ray-datasource":return"getTrace";default:return}};ft.push({title:vt.urlDisplayLabel||"",url:"",internal:{query:{query:vt.url,queryType:Zt(Kt?.type)},datasourceUid:vt.datasourceUid,datasourceName:Kt?.name??"Data source not found"},targetBlank:vt.targetBlank})}else vt.url&&ft.push({title:vt.urlDisplayLabel||"",url:vt.url,targetBlank:vt.targetBlank});return ft},[]);return{name:Yt[0].name,type:z.PU.string,config:{links:ct},values:[]}}function st(Yt){const ot=Yt.filter(ft=>ft.refId!==void 0),ct=(0,t.groupBy)(ot,ft=>ft.refId);return Object.entries(ct).map(([ft,vt])=>ht(vt,ft))}function ht(Yt,ot){const ct={name:"Time",config:{},values:[],type:z.PU.time},ft={name:`Value #${ot}`,config:{},values:[],type:z.PU.number},vt=new Set(Yt.map(tn=>tn.fields.map(En=>Object.keys(En.labels??{})).flat()).flat()),Zt=Array.from(vt).sort().map(tn=>({name:tn,config:{filterable:!0},values:[],type:z.PU.string}));return Yt.forEach(tn=>{const En=tn.fields.find(cs=>cs.type===z.PU.time),Ln=tn.fields.find(cs=>cs.type===z.PU.number);if(En==null||Ln==null)return;const Gn=En.values,Hn=Ln.values;for(let cs of Gn)ct.values.push(cs);for(let cs of Hn)ft.values.push(cs);const Qn=Ln.labels??{};for(let cs of Zt){const vs=Qn[cs.name]??"";for(let hs=0;hs<Hn.length;hs++)cs.values.push(vs)}}),{fields:[ct,...Zt,ft],refId:ot,meta:{preferredVisualisationType:"table"},length:ct.values.length}}function It(Yt){return Yt.fields.every(ot=>ot.type===z.PU.time||ot.type===z.PU.number)}function Gt(Yt,ot){const{meta:ct,...ft}=Yt,vt={...ct,...ot};return{...ft,meta:vt}}function un(Yt,ot,ct){const ft={...Yt.meta?.custom,lokiQueryStatKey:"Summary: total bytes processed"};(0,R.nE)(Yt)&&(ft.error="Error when parsing some of the logs");const vt={preferredVisualisationType:"logs",limit:ot?.maxLines,searchWords:ot?(0,M.H0)(ot.expr):void 0,custom:ft},Kt=Gt(Yt,vt),Zt=yt(Kt,ct);return{...Kt,fields:[...Kt.fields,...Zt]}}function vn(Yt,ot,ct){return Yt.map(ft=>{const vt=ft.refId!==void 0?ot.get(ft.refId):void 0;return un(ft,vt,ct)})}function pn(Yt){return Yt.length>0?st(Yt):[]}function xn(Yt){const ot={preferredVisualisationType:"graph"};return Yt.map(ct=>Gt(ct,ot))}function cn(Yt,ot){const ct=[],ft=[],vt=[];return Yt.forEach(Kt=>{It(Kt)?Kt.refId!=null&&ot.get(Kt.refId)?.queryType===L.U3.Instant?ft.push(Kt):vt.push(Kt):ct.push(Kt)}),{streamsFrames:ct,metricInstantFrames:ft,metricRangeFrames:vt}}function jn(Yt,ot){if(Yt===void 0)return Yt;const{refId:ct,message:ft}=Yt;if(ct===void 0||ft===void 0)return Yt;const vt=ot.get(ct);return vt===void 0?Yt:ft.includes("escape")&&vt.expr.includes("\\")?{...Yt,message:`${ft}. Make sure that all special characters are escaped with \\. For more information on escaping of special characters visit LogQL documentation at https://grafana.com/docs/loki/latest/logql/.`}:Yt}function _n(Yt,ot,ct){const{data:ft,error:vt,...Kt}=Yt,Zt=ft.map(Hn=>{if(!(0,Re.ci)(Hn))throw new Error("transformation only supports dataframe responses");return Hn}),tn=new Map(ot.map(Hn=>{const Qn=Yt.data.find(vs=>vs.refId===Hn.refId)?.meta.executedQueryString,cs={...Hn,expr:Qn?(0,M.mW)(Qn):Hn.expr};return[Hn.refId,cs]})),{streamsFrames:En,metricInstantFrames:Ln,metricRangeFrames:Gn}=cn(Zt,tn);return{...Kt,error:jn(vt,tn),data:[...xn(Gn),...pn(Ln),...vn(En,tn,ct)]}}var Ot=e(32300),Rt=e(30048),Ye=e(48583),dt=e(90374),lt=e(30215);const Pt=(0,te.memo)(function(ot){const{annotation:ct,onAnnotationChange:ft,history:vt}=ot;if(ct===void 0||ft===void 0)return null;const Kt=tn=>{const En=(0,M.vV)(tn).queryType===L.U3.Instant;ft({...ct,expr:tn.expr,maxLines:tn.maxLines,instant:En})},Zt={refId:"",expr:ct.expr,maxLines:ct.maxLines,instant:ct.instant,queryType:ct.queryType};return(0,J.jsxs)(Ye.B,{gap:5,direction:"column",children:[(0,J.jsx)(Ye.B,{gap:0,direction:"column",children:(0,J.jsx)(lt.W,{datasource:ot.datasource,query:Zt,onChange:Kt,onRunQuery:()=>{},history:vt,ExtraFieldElement:(0,J.jsx)(dt.kl,{lineLimitValue:Zt?.maxLines?.toString()||"",resolution:Zt.resolution||1,query:Zt,onRunQuery:()=>{},onChange:Kt})})}),(0,J.jsxs)(Ot.U,{children:[(0,J.jsx)(Rt.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,J.jsx)(Ve.p,{type:"text",placeholder:"alertname",value:ct.titleFormat,onChange:tn=>{ft({...ct,titleFormat:tn.currentTarget.value})}})}),(0,J.jsx)(Rt.c,{label:"Tags",children:(0,J.jsx)(Ve.p,{type:"text",placeholder:"label1,label2",value:ct.tagKeys,onChange:tn=>{ft({...ct,tagKeys:tn.currentTarget.value})}})}),(0,J.jsx)(Rt.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,J.jsx)(Ve.p,{type:"text",placeholder:"instance",value:ct.textFormat,onChange:tn=>{ft({...ct,textFormat:tn.currentTarget.value})}})})]})]})});var Bt=e(35747);function Jt(Yt,ot){if(ot.length===0)return[];const ct=[],{queryWithParser:ft,parserCount:vt}=(0,M.MX)(Yt);if(!ft){const{hasLogfmt:tn,hasJSON:En,hasPack:Ln}=(0,R.YB)(ot[0]);En&&(Ln?ct.push({type:"ADD_UNPACK_PARSER",label:"Selected log stream selector has packed logs.",fix:{title:"add unpack parser",label:"Consider using unpack parser.",action:{type:"ADD_UNPACK_PARSER",query:Yt}}}):ct.push({type:"ADD_JSON_PARSER",label:"Selected log stream selector has JSON formatted logs.",fix:{title:"add json parser",label:"Consider using JSON parser.",action:{type:"ADD_JSON_PARSER",query:Yt}}})),tn&&ct.push({type:"ADD_LOGFMT_PARSER",label:"Selected log stream selector has logfmt formatted logs.",fix:{title:"add logfmt parser",label:"Consider using logfmt parser to turn key-value pairs in your log lines to labels.",action:{type:"ADD_LOGFMT_PARSER",query:Yt}}})}if(ft){if(vt===1){const En=(0,M.d_)(Yt);(0,R.db)(ot[0])&&!En&&ct.push({type:"ADD_NO_PIPELINE_ERROR",label:"Some logs in your selected log streams have parsing error.",fix:{title:"remove pipeline errors",label:"Consider filtering out logs with parsing errors.",action:{type:"ADD_NO_PIPELINE_ERROR",query:Yt}}})}(0,M.pS)(Yt)||ct.push({type:"ADD_LABEL_FILTER",label:"Consider filtering logs by their label and value.",fix:{title:"add label filter",label:"",action:{type:"ADD_LABEL_FILTER",query:Yt}}})}if(!(0,M._i)(Yt)){const tn=(0,R.Ac)(ot[0]),En=(0,R.sz)(ot[0]);!tn&&En&&ct.push({type:"ADD_LEVEL_LABEL_FORMAT",label:`Some logs in your selected log stream have "${En}" label.`,fix:{title:"add label level format",label:`If ${En} label has level values, consider using label_format to rename it to "level". Level label can be then visualized in log volumes.`,action:{type:"ADD_LEVEL_LABEL_FORMAT",query:Yt,options:{renameTo:"level",originalLabel:En}}}})}return(0,M.Rn)(Yt)||ct.push({type:"ADD_LINE_FILTER",label:"Consider filtering logs for specific string.",fix:{title:"add line filter",label:"",action:{type:"ADD_LINE_FILTER",query:Yt}}}),ct}var qt=e(94088),gn=e(31451),On=e(88483),Tn=e(24726),wn=e(6e3);function ps(Yt,ot){const ct=Yt.interpolateVariablesInQueries(ot.targets,ot.scopedVars).filter(ft=>ft.expr).filter(ft=>!ft.hide);return es(Yt,ot,ct)}function es(Yt,ot,ct){let ft=!1,vt={data:[],state:g.Gu.Streaming,key:(0,Tn.A)()},Kt=null,Zt=new Map,tn=null;const En=(Gn,Hn,Qn)=>{let cs=Qn[Hn].groupSize;const{shards:vs,groupSize:hs,cycle:Vs}=Qn[Hn];let As=!1;Kt!=null&&(Kt.unsubscribe(),Kt=null);const Ys=()=>{vt.state=ft?g.Gu.Error:g.Gu.Done,Gn.next(vt),Gn.complete()};if(ft){Ys();return}const ha=()=>{const sa=Qn[Hn+1]&&Lt(Qn[Hn+1])?Qn[Hn+1]:Qn.find(Ha=>Lt(Ha));if(sa===void 0){Ys();return}Qn[Hn].groupSize=cs,En(Gn,Qn.indexOf(sa),Qn)},Da=sa=>{try{if(sa&&!(0,R.BY)(sa))return!1}catch(fa){return console.error(fa),ft=!0,!1}if(hs!==void 0&&hs>1)return Qn[Hn].groupSize=Math.floor(Math.sqrt(hs)),Yn(`Possible time out, new group size ${Qn[Hn].groupSize}`),As=!0,En(Gn,Hn,Qn),!0;const Ha=`${Hn}_${Vs}`,Ma=Zt.get(Ha)??0;return Ma>1?(ft=!0,!1):(Zt.set(Ha,Ma+1),tn=setTimeout(()=>{console.warn(`Retrying ${Hn} ${Vs} (${Ma+1})`),En(Gn,Hn,Qn),tn=null},1500*Math.pow(2,Ma)),As=!0,!0)},Sa=(0,qt.gn)(Qn[Hn].targets,vt);if(!Sa.length){ha();return}const na=vs&&Vs!==void 0&&hs?on(vs,Vs,hs):[],Zs={...ot,targets:(0,M.Bg)(Sa,na)};ot.requestId&&(Zs.requestId=na.length>0?`${ot.requestId}_shard_${Hn}_${Vs}_${hs}`:ot.requestId),Yn(na.length?`Querying ${na.join(", ")}`:"Running regular query"),Kt=(0,qt.K9)(Yt,Zs,{skipPartialUpdates:!0,disableRetry:!0}).subscribe({next:sa=>{((sa.errors??[]).length>0||sa.error!=null)&&Da(sa)||(hs&&Vs!==void 0&&vs!==void 0&&(cs=nn(Vs+hs,$t(sa,Qn[Hn]),vs.length),cs!==hs&&Yn(`New group size ${cs}`)),vt=na.length>0?(0,wn.Wn)(vt,sa):(0,wn.Df)(vt,sa),na.length===0&&Gn.next(vt))},complete:()=>{As||(Gn.next(vt),ha())},error:sa=>{console.error(sa,{msg:"failed to shard"}),Gn.next(vt),!Da()&&ha()}})};return new On.c(Gn=>(ls(ct,Yt,ot).then(Hn=>{En(Gn,0,Hn)}),()=>{ft=!0,tn&&clearTimeout(tn),Kt!=null&&(Kt.unsubscribe(),Kt=null)}))}async function ls(Yt,ot,ct){const[ft,vt]=(0,t.partition)(Yt,tn=>(0,M.E2)([tn])),Kt=[];vt.length&&Kt.push({targets:vt});const Zt=(0,t.groupBy)(ft,tn=>(0,M.tO)(tn.expr));for(const tn in Zt)try{const Ln=(await ot.languageProvider.fetchLabelValues("__stream_shard__",{timeRange:ct.range,streamSelector:tn})).map(Gn=>parseInt(Gn,10));Ln&&(Ln.sort((Gn,Hn)=>Hn-Gn),Yn(`Querying ${tn} with shards ${Ln.join(", ")}`)),Kt.push({targets:Zt[tn],shards:Ln.length?Ln:void 0,groupSize:Ln.length?bn(Ln):void 0,cycle:0})}catch(En){console.error(En,{msg:"failed to fetch label values for __stream_shard__"}),Kt.push({targets:Zt[tn]})}return Kt}function Lt(Yt){if(Yt.cycle===void 0||!Yt.groupSize||!Yt.shards)return!1;const{cycle:ot,groupSize:ct,shards:ft}=Yt,vt=Math.min(ot+ct,ft.length);return Yt.cycle=vt,ot<ft.length&&vt<=ft.length}function $t(Yt,ot){const{groupSize:ct}=ot;if(!ct)return 1;if(!Yt.data.length)return ct+1;const ft=Yt.data[0].meta?.stats?.find(vt=>vt.displayName==="Summary: exec time");if(ft){const vt=Math.round(ft.value);return Yn(`${ft.value}`),vt<=1?Math.floor(ct*1.5):vt<6?Math.ceil(ct*1.1):ct===1?ct:vt<20?Math.ceil(ct*.9):Math.floor(ct/2)}return ct}function nn(Yt,ot,ct){return Math.min(ot,Math.max(Math.floor((ct-Yt)*.7),1))}function on(Yt,ot,ct){return ot===Yt.length?[-1]:Yt.slice(ot,ot+ct)}function bn(Yt){return Math.floor(Math.sqrt(Yt.length))}const In=!!localStorage.getItem("loki.sharding_debug_enabled");function Yn(Yt){In&&console.log(Yt)}var zn=e(72316),St=e(59765),zt=e(17162),Qt=e(37633);async function an(Yt){const ot=JSON.stringify({expr:Yt.expr}),ct=new TextEncoder().encode(ot),ft=await crypto.subtle.digest("SHA-1",ct);return Array.from(new Uint8Array(ft.slice(0,8))).map(Kt=>Kt.toString(16).padStart(2,"0")).join("")}function mn(Yt,ot,ct){const ft=ct.range,vt=ft.to.valueOf()-ft.from.valueOf()+1e3;let Kt=ct.maxDataPoints??1e3;Kt>100&&(Kt*=2);let Zt;const tn=En=>{if("message"in En&&En.message){const Ln=En.message;Zt?Zt.push(Ln):Zt=St.k9.fromDataFrameJSON(Ln,{maxLength:Kt,maxDelta:vt,displayNameFormat:Yt.legendFormat})}return Zt};return(0,zn.v)(()=>an(Yt)).pipe((0,N.Z)(En=>(0,Qt.oF)().getStream({scope:zt.qD.DataSource,namespace:ot.uid,path:`tail/${En}`,data:{...Yt,timeRange:{from:ft.from.valueOf().toString(),to:ft.to.valueOf().toString()}}}).pipe((0,x.T)(Ln=>{const Gn=tn(Ln);return{data:Gn?[Gn]:[],state:g.Gu.Streaming}}))))}const yn=Yt=>{let ct=`${window.location.protocol==="https:"?"wss://":"ws://"}${window.location.host}${l.$.appSubUrl}`;return ct.endsWith("/")&&(ct=ct.slice(0,-1)),`${ct}${Yt}`};var Ct=e(63609);const ut=1e3,Et=10,Ut="/loki/api/v1",Wt="loki-data-samples",gt="annotation-",Vt="log-row-context-query-",Ft="log-volume-",dn="log-sample-",Cn="log-stats-",Un=1e6;function ts(Yt,ot,ct,ft,vt){const Kt=u.calculateInterval(ot,1);return{targets:[Yt],requestId:ft,interval:Kt.interval,intervalMs:Kt.intervalMs,range:ot,scopedVars:{},timezone:"UTC",app:ct,startTime:Date.now(),hideFromInspector:vt}}class ms extends D.iy{constructor(ot,ct=(0,C.w)()){super(ot),this.instanceSettings=ot,this.templateSrv=ct,this.streams=new k,this.runLiveQuery=(vt,Kt)=>{const Zt=this.createLiveTarget(vt,Kt);return this.streams.getStream(Zt).pipe((0,x.T)(tn=>({data:tn||[],key:`loki-${Zt.refId}`,state:g.Gu.Streaming})),(0,s.W)(tn=>(0,n.$)(()=>`Live tailing was stopped due to following error: ${tn.reason}`)))},this.getLogRowContext=async(vt,Kt,Zt)=>await this.logContextProvider.getLogRowContext(vt,Kt,(0,M.sc)(Zt)),this.getLogRowContextQuery=async(vt,Kt,Zt,tn)=>await this.logContextProvider.getLogRowContextQuery(vt,Kt,(0,M.sc)(Zt),tn),this.languageProvider=new U(this);const ft=ot.jsonData||{};this.maxLines=parseInt(ft.maxLines??"0",10)||ut,this.predefinedOperations=ft.predefinedOperations??"",this.annotations={QueryEditor:Pt},this.variables=new tt(this),this.logContextProvider=new fe(this)}getSupplementaryRequest(ot,ct,ft){switch(ot){case o.cF.LogsVolume:const vt=ft?.type===o.cF.LogsVolume?ft:{type:ot};return this.getLogsVolumeDataProvider(ct,vt);case o.cF.LogsSample:const Kt=ft?.type===o.cF.LogsSample?ft:{type:ot};return this.getLogsSampleDataProvider(ct,Kt);default:return}}getSupportedSupplementaryQueryTypes(){return[o.cF.LogsVolume,o.cF.LogsSample]}getSupplementaryQuery(ot,ct){if(ct.hide)return;const ft=(0,M.vV)(ct);let vt=(0,Me.Lv)(ft.expr),Kt=!1;switch(ot.type){case o.cF.LogsVolume:if(Kt=!!(vt&&(0,M.sI)(vt)&&ft.queryType===L.U3.Range),!Kt)return;const Zt=`${vt} | drop __error__`,tn=ot.field||"level, detected_level";return(0,M.FV)(this.interpolateString(Zt,Bt.a))===!1&&(vt=Zt),{...ft,refId:`${Ft}${ft.refId}`,queryType:L.U3.Range,supportingQueryType:L.Q$.LogsVolume,expr:`sum by (${tn}) (count_over_time(${vt}[$__auto]))`};case o.cF.LogsSample:return Kt=!!(vt&&!(0,M.sI)(vt)),Kt?{...ft,queryType:L.U3.Range,refId:`${dn}${ft.refId}`,expr:(0,M.OT)(vt),maxLines:Number.isNaN(Number(ot.limit))?this.maxLines:Number(ot.limit),supportingQueryType:L.Q$.LogsSample}:void 0;default:return}}getLogsVolumeDataProvider(ot,ct){const ft=(0,t.cloneDeep)(ot),vt=ft.targets.map(Kt=>this.getSupplementaryQuery(ct,Kt)).filter(Kt=>!!Kt);if(vt.length)return{...ft,targets:vt}}getLogsSampleDataProvider(ot,ct){const ft=(0,t.cloneDeep)(ot),vt=ft.targets.map(Kt=>this.getSupplementaryQuery({type:o.cF.LogsSample,limit:100},Kt)).filter(Kt=>!!Kt);if(vt.length)return{...ft,targets:vt}}getQueryHeaders(ot){const ct={};if(!l.$.featureToggles.lokiSendDashboardPanelNames||[E.Jk.Dashboard.toString(),E.Jk.PanelEditor.toString(),E.Jk.PanelViewer.toString()].includes(ot.app)===!1)return ct;const ft=(0,v.UA)().getCurrent(),vt=ft?.title,Kt=ft?.panels.find(Zt=>Zt.id===ot?.panelId)?.title;return vt&&(ct["X-Dashboard-Title"]=vt),Kt&&(ct["X-Panel-Title"]=Kt),ct}query(ot){const ct=ot.targets.map(M.vV).map(Zt=>({...Zt,maxLines:Zt.maxLines??this.maxLines})),ft={...ot,targets:ct};ft.headers=this.getQueryHeaders(ot);const vt=ft.targets.filter(Zt=>Zt.queryType===L.U3.Stream);if(l.$.featureToggles.lokiExperimentalStreaming&&vt.length>0&&ft.rangeRaw?.to==="now"){const Zt={...ft,targets:vt};return(0,r.h)(...vt.map(tn=>mn(this.applyTemplateVariables(tn,ot.scopedVars,ot.filters),this,Zt)))}if(ft.liveStreaming)return this.runLiveQueryThroughBackend(ft);if(l.$.featureToggles.lokiShardSplitting&&(0,M.E2)(ft.targets))return ps(this,ft);if(l.$.featureToggles.lokiQuerySplitting&&(0,M.gy)(ft.targets))return(0,qt.K9)(this,ft);const Kt=new Date;return this.runQuery(ft).pipe((0,c.M)(Zt=>(0,Ct.Ex)(Zt,ft,Kt,{predefinedOperations:this.predefinedOperations})))}runQuery(ot){return super.query(ot).pipe((0,x.T)(ct=>_n(ct,ot.targets,this.instanceSettings.jsonData.derivedFields??[])))}runLiveQueryThroughBackend(ot){const ct=ot.targets.filter(vt=>vt.expr!==""&&(0,M.sI)(vt.expr));if(ct.length===0)return(0,a.of)({data:[],state:g.Gu.Done});const ft=ct.map(vt=>{const Kt=this.applyTemplateVariables(vt,ot.scopedVars,ot.filters),Zt=Kt.maxLines||this.maxLines;return this.runLiveQuery(Kt,Zt)});return(0,r.h)(...ft)}createLiveTarget(ot,ct){const ft=ot.expr,vt=this.instanceSettings.url,Kt=m.kM.serializeParams({query:ft});return{query:ft,url:yn(`${vt}/loki/api/v1/tail?${Kt}`),refId:ot.refId,size:ct}}interpolateVariablesInQueries(ot,ct,ft){let vt=ot;return ot&&ot.length&&(vt=ot.map(Kt=>({...Kt,datasource:this.getRef(),expr:this.addAdHocFilters(this.templateSrv.replace(Kt.expr,ct,this.interpolateQueryExpr),ft)}))),vt}getQueryDisplayText(ot){return ot.expr}getTimeRangeParams(ot){return{start:ot.from.valueOf()*Un,end:ot.to.valueOf()*Un}}async importFromAbstractQueries(ot){await this.languageProvider.start();const ct=this.languageProvider.labelKeys;return ct&&ct.length&&(ot=ot.map(ft=>(ft.labelMatchers=ft.labelMatchers.filter(vt=>ct.includes(vt.name)),ft))),ot.map(ft=>this.languageProvider.importFromAbstractQuery(ft))}async exportToAbstractQueries(ot){return ot.map(ct=>this.languageProvider.exportToAbstractQuery(ct))}async metadataRequest(ot,ct,ft){if(ot.startsWith("/"))throw new Error(`invalid metadata request url: ${ot}`);const vt=await this.getResource(ot,ct,ft);return!vt.data&&vt.values?vt.values??[]:!vt.data&&vt.fields?vt.fields??[]:vt.data??[]}async statsMetadataRequest(ot,ct,ft){if(ot.startsWith("/"))throw new Error(`invalid metadata request url: ${ot}`);return await this.getResource(ot,ct,ft)}async getQueryStats(ot,ct){if((0,M.FV)(this.interpolateString(ot.expr,Bt.a)))return;const ft=(0,M.pk)(ot.expr);let vt={streams:0,chunks:0,bytes:0,entries:0};for(const Kt in ft){const{start:Zt,end:tn}=this.getStatsTimeRange(ot,Number(Kt),ct);if(Zt===void 0||tn===void 0)return{streams:0,chunks:0,bytes:0,entries:0,message:"Query size estimate not available."};try{const En=await this.statsMetadataRequest("index/stats",{query:ft[Kt],start:Zt,end:tn},{showErrorAlert:!1,requestId:`${Cn}${ot.refId}`});vt={streams:vt.streams+En.streams,chunks:vt.chunks+En.chunks,bytes:vt.bytes+En.bytes,entries:vt.entries+En.entries}}catch{break}}return vt}getStatsTimeRange(ot,ct,ft){let vt,Kt;const En=(0,M.QH)(ot.expr,[h.dw]).map(Ln=>ot.expr.substring(Ln.from,Ln.to));return(0,M.sI)(ot.expr)?ot.queryType===L.U3.Instant?{start:void 0,end:void 0}:this.getTimeRangeParams(ft):ot.queryType===L.U3.Instant?En[ct]?(Kt=this.getTimeRangeParams(ft).end,vt=Kt-u.intervalToMs(En[ct])*1e6,{start:vt,end:Kt}):/(\$__auto|\$__range)/.test(ot.expr)?this.getTimeRangeParams(ft):{start:void 0,end:void 0}:this.getTimeRangeParams(ft)}async getStats(ot,ct){if(!ot.expr)return null;const ft=await this.getQueryStats(ot,ct);return ft?Object.values(ft).every(vt=>vt===0)?null:ft:null}async metricFindQuery(ot,ct){if(!ot)return Promise.resolve([]);let ft;return typeof ot=="string"?ft=this.parseStringToVariableQuery(this.interpolateString(ot,ct?.scopedVars)):ft={...ot,label:this.interpolateString(ot.label||"",ct?.scopedVars),stream:this.interpolateString(ot.stream||"",ct?.scopedVars)},ft?await this.processMetricFindQuery(ft,ct?.range):Promise.resolve([])}async processMetricFindQuery(ot,ct){return ot.type===L.ie.LabelNames?(await this.languageProvider.fetchLabels({timeRange:ct})).map(Kt=>({text:Kt})):ot.label?(await this.languageProvider.fetchLabelValues(ot.label,{streamSelector:ot.stream,timeRange:ct})).map(vt=>({text:vt})):[]}parseStringToVariableQuery(ot){const ct="LokiVariableQueryEditor-VariableQuery";if(ot.match(ke))return{type:L.ie.LabelNames,refId:ct};const vt=ot.match(Oe);if(vt)return{type:L.ie.LabelValues,label:vt[2],stream:vt[1],refId:ct}}async getDataSamples(ot,ct){if(!(0,M.sI)(ot.expr)||(0,M.FV)(this.interpolateString(ot.expr,Bt.a)))return[];const ft={expr:ot.expr,queryType:L.U3.Range,refId:Wt,maxLines:ot.maxLines||Et,supportingQueryType:L.Q$.DataSample},vt=ts(ft,ct,E.Jk.Unknown,Wt,!0);return await(0,i.s)(this.query(vt).pipe((0,d.n)(Kt=>(0,a.of)(Kt.data))))}async getTagKeys(ot){let ct="{}";for(const vt of ot?.filters??[])ct=(0,Me.tE)(ct,vt.key,vt.operator,vt.value);return(await this.languageProvider.fetchLabels({timeRange:ot?.timeRange,streamSelector:ct})).map(vt=>({text:vt}))}async getTagValues(ot){let ct="{}";for(const vt of ot?.filters??[])ct=(0,Me.tE)(ct,vt.key,vt.operator,vt.value);return(await this.languageProvider.fetchLabelValues(ot.key,{timeRange:ot.timeRange,streamSelector:ct})).map(vt=>({text:vt}))}interpolateQueryExpr(ot,ct){return!ct.multi&&!ct.includeAll?ot:typeof ot=="string"?us(ot):(0,t.map)(ot,us).join("|")}toggleQueryFilter(ot,ct){let ft=ot.expr??"";const vt=(0,S.Ed)(ct.options.key,ct.frame,0);switch(ct.type){case"FILTER_FOR":{if(ct.options?.key&&ct.options?.value){const Kt=(0,S.Bb)(ct.options.value);ft=(0,Me.je)(ft,ct.options.key,"=",Kt)?(0,Me.FN)(ft,ct.options.key,"=",Kt):(0,Me.tE)(ft,ct.options.key,"=",Kt,vt)}break}case"FILTER_OUT":{if(ct.options?.key&&ct.options?.value){const Kt=(0,S.Bb)(ct.options.value);(0,Me.je)(ft,ct.options.key,"=",Kt)&&(ft=(0,Me.FN)(ft,ct.options.key,"=",Kt)),ft=(0,Me.tE)(ft,ct.options.key,"!=",Kt,vt)}break}default:break}return{...ot,expr:ft}}queryHasFilter(ot,ct){let ft=ot.expr??"";return(0,Me.je)(ft,ct.key,"=",ct.value)}modifyQuery(ot,ct){let ft=ot.expr??"";switch(ct.type){case"ADD_FILTER":{if(ct.options?.key&&ct.options?.value){const vt=(0,S.Ed)(ct.options.key,ct.frame,0),Kt=(0,S.Bb)(ct.options.value);ft=(0,Me.tE)(ft,ct.options.key,"=",Kt,vt)}break}case"ADD_FILTER_OUT":{if(ct.options?.key&&ct.options?.value){const vt=(0,S.Ed)(ct.options.key,ct.frame,0),Kt=(0,S.Bb)(ct.options.value);ft=(0,Me.tE)(ft,ct.options.key,"!=",Kt,vt)}break}case"ADD_LOGFMT_PARSER":{ft=(0,Me.aH)(ft,"logfmt");break}case"ADD_JSON_PARSER":{ft=(0,Me.aH)(ft,"json");break}case"ADD_UNPACK_PARSER":{ft=(0,Me.aH)(ft,"unpack");break}case"ADD_NO_PIPELINE_ERROR":{ft=(0,Me.yI)(ft);break}case"ADD_LEVEL_LABEL_FORMAT":{ct.options?.originalLabel&&ct.options?.renameTo&&(ft=(0,Me.o9)(ft,{renameTo:ct.options.renameTo,originalLabel:ct.options.originalLabel}));break}case"ADD_LABEL_FILTER":{const vt=(0,Me.cH)(ot.expr),Kt=(0,Me.lN)(ot.expr),Zt=(0,Me.lq)([...vt,...Kt]),tn=(0,Me.i6)("","","=");ft=(0,Me.cQ)(ft,[Zt],tn);break}case"ADD_STRING_FILTER":case"ADD_LINE_FILTER":{ft=(0,Me.OS)(ft,ct.options?.value);break}case"ADD_STRING_FILTER_OUT":case"ADD_LINE_FILTER_OUT":{ft=(0,Me.OS)(ft,ct.options?.value,"!=");break}default:break}return{...ot,expr:ft}}getSupportedQueryModifications(){return["ADD_FILTER","ADD_FILTER_OUT","ADD_LOGFMT_PARSER","ADD_JSON_PARSER","ADD_UNPACK_PARSER","ADD_NO_PIPELINE_ERROR","ADD_LEVEL_LABEL_FORMAT","ADD_LABEL_FILTER","ADD_STRING_FILTER","ADD_STRING_FILTER_OUT"]}getLogRowContextUi(ot,ct,ft,vt){return this.logContextProvider.getLogRowContextUi(ot,ct,(0,M.sc)(ft),vt)}async annotationQuery(ot){const{expr:ct,maxLines:ft,instant:vt,tagKeys:Kt="",titleFormat:Zt="",textFormat:tn=""}=ot.annotation;if(!ct)return[];const En=`${gt}${ot.annotation.name}`,Ln={refId:En,expr:ct,maxLines:ft,instant:vt,queryType:vt?L.U3.Instant:L.U3.Range},Gn=ts(Ln,ot.range,E.Jk.Dashboard,En),{data:Hn}=await(0,i.s)(this.query(Gn)),Qn=[],cs=Kt.split(",").filter(hs=>hs!==""),vs=l.$.featureToggles.lokiLogsDataplane;for(const hs of Hn)new f.R(hs).forEach(As=>{const{labels:Ys}=As,ha=Object.entries(Ys).map(([na,Zs])=>[na,Zs.trim()]).filter(([na,Zs])=>!(Zs===""||cs.length&&!cs.includes(na))).map(([na,Zs])=>Zs),Da=Array.from(new Set(ha)),Sa=vs?As.body:As.Line;Qn.push({time:vs?new Date(As.timestamp).valueOf():new Date(As.Time).valueOf(),title:(0,p.j)(Zt,Ys),text:(0,p.j)(tn,Ys)||Sa,tags:Da})});return Qn}addAdHocFilters(ot,ct){if(!ct?.length)return ot;let ft=(0,gn.qk)(ot);return ft=ct.reduce((vt,Kt)=>{const{key:Zt,operator:tn}=Kt;let{value:En}=Kt;return(0,S.N4)(tn)||(En=(0,S.Bb)(En,tn)),(0,Me.tE)(vt,Zt,tn,En)},ft),(0,gn.If)(ft)}filterQuery(ot){return!(ot.hide||ot.expr==="")}applyTemplateVariables(ot,ct,ft){const{__auto:vt,__interval:Kt,__interval_ms:Zt,__range:tn,__range_s:En,__range_ms:Ln,...Gn}=ct||{},Hn={...Gn,__interval:{value:"$__interval"},__interval_ms:{value:"$__interval_ms"}},Qn=this.addAdHocFilters(this.templateSrv.replace(ot.expr,Hn,this.interpolateQueryExpr),ft),cs=this.templateSrv.replace(ot.step,Hn),vs=this.templateSrv.replace(ot.legendFormat,Hn);return{...ot,expr:Qn,step:cs,legendFormat:vs}}interpolateString(ot,ct){return this.templateSrv.replace(ot,ct,this.interpolateQueryExpr)}getVariables(){return this.templateSrv.getVariables().map(ot=>`$${ot.name}`)}getQueryHints(ot,ct){return Jt(ot.expr,ct)}getDefaultQuery(ot){const ct={refId:"A",expr:""};return ot===E.Jk.UnifiedAlerting?{...ct,queryType:L.U3.Instant}:{...ct,queryType:L.U3.Range}}}function us(Yt){return typeof Yt=="string"?Yt.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]+?.()|]/g,"\\\\$&"):Yt}},91529:(q,j,e)=>{"use strict";e.d(j,{Bb:()=>E,Cs:()=>o,Ed:()=>p,N4:()=>m,P7:()=>l,Qn:()=>u,WV:()=>s,qv:()=>g,sM:()=>D,tY:()=>f,tt:()=>C});var t=e(2543),n=e.n(t),r=e(58462),a=e(57903);function i(P){return x(P/1e3)}function x(P){return Math.floor(P/60)}function s(P,b){if(P&&b){const S=i(P.from.valueOf())===i(b.from.valueOf()),M=i(P.to.valueOf())===i(b.to.valueOf());return!(S&&M)}return!1}const c=/[*+?()|\\.\[\]{}^$]/g;function d(P){return P.replace(c,"\\$&")}function u(P){return P.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function g(P){return P.replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}function o(P){return u(d(P))}function E(P,b){return m(b)?o(P):u(P)}function m(P){return!!(P&&(P.includes("=~")||P.includes("!~")))}function f(P){const b=["b","kib","Kib","kb","KB","mib","Mib","mb","MB","gib","Gib","gb","GB","tib","Tib","tb","TB","pib","Pib","pb","PB","eib","Eib","eb","EB"],S=new RegExp(`^(?:-?\\d+(?:\\.\\d+)?)(?:${b.join("|")})$`);return!!P.match(S)}function p(P,b,S){if(!b||S===void 0)return null;const M=b.fields.find(O=>O.name==="labelTypes")?.values[S];if(!M)return null;switch(M[P]){case"I":return a.HD.Indexed;case"S":return a.HD.StructuredMetadata;case"P":return a.HD.Parsed;default:return null}}const h={[r.D_.Equal]:"=",[r.D_.NotEqual]:"!=",[r.D_.EqualRegEx]:"=~",[r.D_.NotEqualRegEx]:"!~"},D=(0,t.invert)(h);function C(P){const b=P.labelMatchers.map(S=>{const M=h[S.operator];return M?`${S.name}${M}"${S.value}"`:""}).filter(S=>S!=="").join(", ");return b?`{${b}}`:""}function l(P){const b={};P.forEach(M=>{Object.keys(M).forEach(O=>{b[O]||(b[O]=new Set),b[O].has(M[O])||b[O].add(M[O])})});const S={};return y(Object.keys(b)).forEach(M=>{S[M]=y(Array.from(b[M]))}),{values:S,keys:Object.keys(S)}}const v=1e4;function y(P){return P.slice(0,v)}},6e3:(q,j,e)=>{"use strict";e.d(j,{Df:()=>c,Wn:()=>s});var t=e(8392),n=e(63739),r=e(59765),a=e(2049),i=e(47370),x=e(94088);function s(l,v){if(!l)return h(v);v.data.forEach(S=>{const M=l.data.find(O=>C(O,S));if(!M){l.data.push(D(S));return}d(M,S)});const y=[...l.errors??[],...v.errors??[]];y.length>0&&(l.errors=y);const P=l.error??v.error;P!=null&&(l.error=P);const b=[...l.traceIds??[],...v.traceIds??[]];return b.length>0&&(l.traceIds=b),l}function c(l,v){if(!l)return h(v);v.data.forEach(S=>{const M=l.data.findIndex(O=>C(O,S));if(M<0){l.data.push(D(S));return}l.data[M]=S}),v.state===t.Gu.Done&&(l.data=l.data.filter(S=>S.name!==x.NW));const y=[...l.errors??[],...v.errors??[]];y.length>0&&(l.errors=y);const P=l.error??v.error;P!=null&&(l.error=P);const b=[...l.traceIds??[],...v.traceIds??[]];return b.length>0&&(l.traceIds=b),l}function d(l,v){const y=l.fields.find(R=>R.type===n.PU.time),P=l.fields.find(R=>R.type===n.PU.string&&R.name==="id"),b=v.fields.find(R=>R.type===n.PU.time),S=v.fields.find(R=>R.type===n.PU.string&&R.name==="id");if(!y||!b){console.error(new Error("Time fields not found in the data frames"));return}const M=b?.values.slice(0)??[],O=Math.max(l.fields.length,v.fields.length);for(let R=0;R<M.length;R++){const L=u(y,b,R),B=g(y,P,L,b,S,R);for(let F=0;F<O;F++){if(!l.fields[F])continue;const I=E(l.fields[F],v.fields,F);if(I)if(B){if(l.fields[F].type===n.PU.time)continue;l.fields[F].type===n.PU.number?l.fields[F].values[L]=(l.fields[F].values[L]??0)+I.values[R]:l.fields[F].type===n.PU.other?typeof I.values[R]=="object"?l.fields[F].values[L]={...l.fields[F].values[L],...I.values[R]}:I.values[R]&&(l.fields[F].values[L]=I.values[R]):l.fields[F].values[L]=I.values[R]}else I.values[R]!==void 0&&(l.fields[F].values.splice(L,0,I.values[R]),I.nanos?(l.fields[F].nanos=l.fields[F].nanos??new Array(l.fields[F].values.length-1).fill(0),l.fields[F].nanos?.splice(L,0,I.nanos[R])):l.fields[F].nanos&&l.fields[F].nanos?.splice(L,0,0))}}l.length=l.fields[0].values.length,l.meta={...l.meta,stats:p(l.meta?.stats??[],v.meta?.stats??[])}}function u(l,v,y){const P=(0,r.Ls)(v.values[y],l.values);return P<0?0:v.values[y]===l.values[P]&&v.nanos&&l.nanos?v.nanos[y]>l.nanos[P]?P+1:P:v.values[y]>l.values[P]?P+1:P}function g(l,v,y,P,b,S){return o(l,y,P,S)?!v||!b?!0:v.values[y]!==void 0&&v.values[y]===b.values[S]:!1}function o(l,v,y,P){return l.nanos&&y.nanos?l.values[v]!==void 0&&l.values[v]===y.values[P]&&l.nanos[v]!==void 0&&l.nanos[v]===y.nanos[P]:l.values[v]!==void 0&&l.values[v]===y.values[P]}function E(l,v,y){const P=v.filter(b=>b.name===l.name);return P.length===1?P[0]:l.labels?P.find(b=>(0,a.ab)(l.labels??{},b.labels??{})):v[y]}const m="Summary: total bytes processed",f="Summary: exec time";function p(l,v){const y=[];for(const P of[m,f]){const b=l.find(O=>O.displayName===P),S=v.find(O=>O.displayName===P);if(S!=null&&b!=null){y.push({value:S.value+b.value,displayName:P,unit:b.unit});continue}const M=S??b;M!=null&&y.push(M)}return y}function h(l){return{...l,data:l.data.map(D)}}function D(l){return{...l,fields:l.fields.map(v=>({...v,values:v.values}))}}function C(l,v){if(l.refId!==v.refId||l.name!==v.name)return!1;const y=l.meta?.type,P=v.meta?.type;if(y!==P)return!1;if(y===i.m.TimeSeriesMulti){const M=l.fields.find(R=>R.type===n.PU.number),O=v.fields.find(R=>R.type===n.PU.number);return M===void 0||O===void 0?!1:(0,a.ab)(M.labels??{},O.labels??{})}const b=l.meta?.custom?.frameType,S=v.meta?.custom?.frameType;return b==="LabeledTimeValues"&&S==="LabeledTimeValues"?!0:b===S}},98388:(q,j,e)=>{"use strict";e.d(j,{Ch:()=>d,FN:()=>g,Gk:()=>D,Lv:()=>y,OS:()=>I,aH:()=>h,cH:()=>b,cQ:()=>B,i6:()=>R,je:()=>u,lN:()=>S,lq:()=>A,o9:()=>v,tE:()=>f,yB:()=>P,yI:()=>l});var t=e(2543),n=e.n(t),r=e(36195),a=e(91529),i=e(36745),x=e(24271),s=e(3152),c=e(57903);class d{constructor(w,H,G){this.from=w,this.to=H,this.type=G}static fromNode(w){return new d(w.from,w.to,w.type)}contains(w){return this.from<=w.from&&this.to>=w.to}getExpression(w){return w.substring(this.from,this.to)}}function u(z,w,H,G){return m(z,w,H,G).length>0}function g(z,w,H,G){const X=m(z,w,H,G);for(const k of X)z=k.parent?.type.id===r.bY?o(z,k):E(z,k);return z}function o(z,w){const H=w.parent?.parent;return!H||H.type.id!==r.t3?z:(z.substring(0,H.from)+z.substring(H.to)).trim()}function E(z,w){let H=w;do H=H.parent;while(H&&H.type.id!==r.MD);const G=w.getChild(r.gw);if(!H||!G)return z;const X=z.substring(G.from,G.to),k=z.substring(0,H.from),_=z.substring(H.to),ee=(0,s.u_)(z.substring(H.from,H.to));return ee.query.labels=ee.query.labels.filter(J=>J.label!==X),k+x.y.renderQuery(ee.query)+_}function m(z,w,H,G){const X=r.K3.parse(z),k=[];return X.iterate({enter:({type:_,node:ee})=>{_.id===r.g$&&k.push(ee)}}),k.filter(_=>{const ee=_.getChild(r.gw),J=ee?.nextSibling,Z=_.getChild(r.Qf);if(!ee||!J||!Z||z.substring(ee.from,ee.to)!==w)return!1;const ae=z.substring(Z.from,Z.to);return!((0,s.w4)(ae)!==(0,a.qv)(G)||z.substring(J.from,J.to)!==H)})}function f(z,w,H,G,X){if(!w)throw new Error("Need label to add to query.");const k=P(z);if(!k.length)return z;const _=b(z),ee=S(z),J=V(z),Z=(0,i.TQ)(z,[r.J_]);X||T(z).map(ce=>ce.getExpression(z)).includes(w)&&(X=c.HD.Indexed);const te=k.every(re=>J.some(ne=>ne.from>=re.from&&ne.to<=re.to)),ae=R(w,G,H);if(X===c.HD.Parsed||X===c.HD.StructuredMetadata){const re=p(z,[...k,...ee,..._,...Z]);return B(z,re,ae)}else{if(X===c.HD.Indexed)return L(z,k,ae);if(_.length===0||te===!1)return L(z,k,ae);{const re=p(z,[..._,...ee,...Z]);return B(z,re,ae)}}}function p(z,w){const H=N((0,i.TQ)(z,[r.GN])),G=[...w];return H.map(k=>A(G.filter(_=>k.contains(_))))}function h(z,w){const H=M(z);if(H.length)return C(z,H,w);{const G=P(z);return G.length?C(z,G,w):z}}function D(z,w){const H=M(z);if(H.length)return C(z,H,`drop ${w.join(", ")}`);{const G=P(z);return G.length?C(z,G,`drop ${w.join(", ")}`):z}}function C(z,w,H){let G="",X=0;for(let k=0;k<w.length;k++){const _=w[k],ee=k===w.length-1,J=z.substring(X,_.to),Z=ee?z.substring(_.to):"";G+=J+` | ${H}`+Z,X=_.to}return G}function l(z){const w=b(z);if(!w.length)return z;const H=R("__error__","","=");return B(z,w,H)}function v(z,w){const H=O(z);return F(z,H,w)}function y(z){const w=U(z);if(!w.length)return z;let H="",G=0;for(let X of w)H=H+z.substring(G,X.from),G=X.to;return H=H+z.substring(G),H}function P(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({type:G,node:X})=>{if(G.id===r.MD)return H.push(d.fromNode(X)),!1}}),H}function b(z){const w=r.K3.parse(z),H=[],G=[r.iT,r.eF,r.Zj,r.Tz];return w.iterate({enter:({type:X,node:k})=>{if(G.includes(X.id))return H.push(d.fromNode(k)),!1}}),H}function S(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({type:G,node:X})=>{if(G.id===r.bY)return H.push(d.fromNode(X)),!1}}),H}function M(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({type:G,node:X})=>{if(G.id===r.CX)return H.push(d.fromNode(X)),!1}}),H}function O(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({type:G,node:X})=>{if(G.id===r.UK)return H.push(d.fromNode(X)),!1;if(G.id===r.xo){const k=[],_=X.getChild(r.MD);_&&k.push(d.fromNode(_));const ee=X.getChild(r.AL);ee&&k.push(d.fromNode(ee));const J=X.getChild(r.HV);J&&k.push(d.fromNode(J));const Z=(0,t.sortBy)(k,te=>te.to);return H.push(new d(Z[0].from,Z[Z.length-1].to)),!1}}}),H}function R(z,w,H){return{label:z,op:H,value:w}}function L(z,w,H){let G="",X=0;for(let k=0;k<w.length;k++){const _=w[k],ee=k===w.length-1,J=z.substring(X,_.from),Z=ee?z.substring(_.to):"",te=(0,s.u_)(z.substring(_.from,_.to));W(te.query.labels,H)||te.query.labels.push(H);const ae=x.y.renderQuery(te.query);G+=J+ae+Z,X=_.to}return G}function B(z,w,H){let G="",X=0;for(let k=0;k<w.length;k++){const _=w[k],ee=k===w.length-1,J=z.substring(X,_.to),Z=ee?z.substring(_.to):"";let te="";!Number.isNaN(Number(H.value))&&(H.op==="<"||H.op===">")?te=` | ${H.label}${H.op}${Number(H.value)}`:te=` | ${H.label}${H.op}\`${(0,a.qv)(H.value)}\``,G+=J+te+Z,X=_.to}return G}function F(z,w,H){let G="",X=0;for(let k=0;k<w.length;k++){const _=w[k],ee=k===w.length-1,J=z.substring(X,_.to),Z=ee?z.substring(_.to):"",te=` | label_format ${H.renameTo}=${H.originalLabel}`;G+=J+te+Z,X=_.to}return G}function I(z,w="",H="|="){const G=P(z);if(!G.length)return z;const X=G[0].to;return z.slice(0,X)+` ${H} \`${w}\``+z.slice(X)}function U(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({type:G,from:X,to:k})=>{if(G.id===r.uk)return H.push(new d(X,k,G)),!1}}),H}function W(z,w){return z.find(H=>H.label===w.label&&H.value===w.value)}function A(z){return z.length?z.reduce((w,H)=>w.to>H.to?w:H):new d(0,0)}function N(z){return z.filter(w=>z.every(H=>w.contains(H)===!1||w===H))}function K(z,w){if(z.type.id===w)return[d.fromNode(z)];const H=[];let G=0,X=z.childAfter(G);for(;X;)H.push(...K(X,w)),G=X.to,X=z.childAfter(G);return H}function V(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({node:G})=>{G.type.id===r.MD&&H.push(...K(G,r.g$))}}),H}function T(z){const w=r.K3.parse(z),H=[];return w.iterate({enter:({node:G})=>{G.type.id===r.MD&&H.push(...K(G,r.gw))}}),H}},94088:(q,j,e)=>{"use strict";e.d(j,{NW:()=>v,gn:()=>C,K9:()=>S});var t=e(2543),n=e(88483),r=e(59099),a=e(24726),i=e(3202),x=e(8392),s=e(75906),c=e(7500),d=e(66102),u=e(59577);function g(O,R,L){if(R-O<=L)return[[O,R]];const B=[];for(let F=R;F>O;F-=L){const I=Math.max(F-L,O);B.push([I,F])}return B.reverse(),B}var o=e(6e3);function E(O,R,L,B){if(B<L)return[[O,R]];const F=Math.trunc(B/L)*L,I=O-O%L,U=[];for(let W=I;W<R;W+=F){const A=Math.min(W+F-L,R);U.push([W,A])}return U}var m=e(36745),f=e(45331),p=e(63609),h=e(57903);function D(O,R,L,B){const F=R.from.toDate().getTime(),I=R.to.toDate().getTime();return(O?g(F,I,B):E(F,I,L,B)).map(([W,A])=>{const N=(0,i.KQ)(W),K=(0,i.KQ)(A);return{from:N,to:K,raw:{from:N,to:K}}})}function C(O,R){return R?O.map(L=>{if(!L.maxLines||!(0,m.sI)(L.expr))return L;const B=R.data.find(I=>I.refId===L.refId);if(!B)return L;const F=L.maxLines-B.length;return{...L,maxLines:F<0?0:F}}).filter(L=>L.maxLines===void 0||L.maxLines>0):O}function l(O,R,L={}){const B=R.length?R[0].request.queryGroupId:(0,a.A)();let F={data:[],state:x.Gu.Streaming,key:B};const I=Math.max(...R.map(({partition:z})=>z.length)),U=R.filter(({partition:z})=>z.length===I)[0].partition;let W=!1,A=null,N=new Map,K=null;const V=(z,w,H)=>{let G=!1;if(A!=null&&(A.unsubscribe(),A=null),W){z.complete();return}const X=()=>{F.state=x.Gu.Done,z.next(F),z.complete()},k=()=>{const{nextRequestN:ae,nextRequestGroup:re}=P(R,H,w);if(ae>0&&re>=0){V(z,ae,re);return}X()},_=ae=>{if(L.disableRetry)return!1;try{if(ae&&!(0,f.BY)(ae))return!1}catch(ce){return console.error(ce),W=!0,!1}const re=`${w}-${H}`,ne=N.get(re)??0;return ne>0?!1:(N.set(re,ne+1),K=setTimeout(()=>{V(z,w,H)},1500*Math.pow(2,ne)),G=!0,!0)},ee=R[H],J=ee.partition[w-1],Z=C(ee.request.targets,F);if(!Z.length){k();return}const te={...R[H].request,range:J,targets:Z};ee.request.requestId&&(te.requestId=`${ee.request.requestId}_${w}`),A=O.runQuery(te).subscribe({next:ae=>{if((ae.errors??[]).length>0||ae.error!=null){if(_(ae))return;W=!0}F=(0,o.Wn)(F,ae),L.skipPartialUpdates||(F=y(F,te,U,w))},complete:()=>{G||(L.skipPartialUpdates||z.next(F),k())},error:ae=>{z.error(ae),_()}})};return new n.c(z=>(V(z,I,0),()=>{W=!0,K&&(clearTimeout(K),K=null),A!=null&&(A.unsubscribe(),A=null)}))}const v="loki-splitting-progress";function y(O,R,L,B){if((0,m.sI)(R.targets[0].expr)||(O.data=O.data.filter(I=>I.name!==v),B<=1))return O;const F=(0,s.I)([{time:L[0].from.valueOf(),timeEnd:L[B-2].to.valueOf(),isRegion:!0,color:"rgba(120, 120, 120, 0.1)"}]);return F.name=v,F.meta={dataTopic:c.QR.Annotations},O.data.push(F),O}function P(O,R,L){for(let B=R+1;B<O.length;B++)if(O[B].partition[L-1])return{nextRequestGroup:B,nextRequestN:L};return{nextRequestGroup:O.findIndex(B=>B?.partition[L-1]!==void 0),nextRequestN:L-1}}function b(O){return O.queryType!==h.U3.Instant&&!(0,m.Cg)(O.expr)}function S(O,R,L={}){const B=R.targets.filter(z=>!z.hide).filter(z=>z.expr),[F,I]=(0,t.partition)(B,z=>!b(z)),[U,W]=(0,t.partition)(I,z=>(0,m.sI)(z.expr));R.queryGroupId=(0,a.A)();const A=24*60*60*1e3,N=(0,t.groupBy)(U,z=>z.direction===h.ti.Forward?h.ti.Forward:h.ti.Backward),K=[];for(const z in N){const w=(0,t.groupBy)(N[z],H=>H.splitDuration?(0,d.WT)((0,d.E9)(H.splitDuration)):A);for(const[H,G]of Object.entries(w)){const X=(0,t.groupBy)(G,k=>k.resolution||1);for(const k in X){const _={request:{...R,targets:X[k]},partition:D(!0,R.range,R.intervalMs,Number(H))};z===h.ti.Forward&&_.partition.reverse(),K.push(_)}}}const V=(0,t.groupBy)(W,z=>z.splitDuration?(0,d.WT)((0,d.E9)(z.splitDuration)):A);for(const[z,w]of Object.entries(V)){const H=(0,t.groupBy)(w,G=>M(R.intervalMs,R.range,G.resolution||1,G.step));for(const G in H){const X=H[G].map(k=>{const{maxLines:_,...ee}=k;return ee});K.push({request:{...R,targets:X},partition:D(!1,R.range,Number(G),Number(z))})}}F.length&&K.push({request:{...R,targets:F},partition:[R.range]});const T=new Date;return l(O,K,L).pipe((0,r.M)(z=>{z.state===x.Gu.Done&&(0,p.uJ)(z,K,R,T,{predefinedOperations:O.predefinedOperations})}))}function M(O,R,L,B){const F=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/;if(B?.match(F))return u.intervalToMs(B)*L;const I=O*L,U=Math.round((R.to.valueOf()-R.from.valueOf())/11e3);return Math.max(I,U)}},36745:(q,j,e)=>{"use strict";e.d(j,{$F:()=>m,Bg:()=>V,Cg:()=>B,E2:()=>U,FV:()=>l,H0:()=>s,Io:()=>g,MX:()=>y,OT:()=>M,QH:()=>h,Rn:()=>L,TQ:()=>D,_i:()=>S,aw:()=>P,d_:()=>b,g5:()=>O,gy:()=>I,kr:()=>N,mW:()=>c,pS:()=>R,pk:()=>F,sI:()=>v,sc:()=>K,tO:()=>z,vV:()=>u});var t=e(2543),n=e.n(t),r=e(36195),a=e(98388),i=e(31451),x=e(57903);function s(w=""){const H=[],G=h(w,[r.PN]);for(const X of G){const k=X.getChild(r.dJ)?.getChild(r.Sg),_=X.getChild(r.dJ)?.getChild(r.q5),ee=d(X);if(!(!k&&!_||!ee.length))for(const J of ee){const Z=w.substring(J.from,J.to).trim(),te=Z[0]==="`",ae=Z.substring(1,Z.length-1);if(!ae)continue;let re="";_?re=te?ae:ae.replace(/\\\\/g,"\\"):re=(0,t.escapeRegExp)(ae),re&&H.push(re)}}return H}function c(w){return w.replace("Expr: ","")}function d(w){const H=[];let G=w;do{const X=G.getChild(r.Qf);X&&!G.getChild(r.w7)&&H.push(X),G=G.getChild(r.ih)}while(G!=null);return H}function u(w){let H=g(w);const{instant:G,range:X,...k}=w;try{v(w.expr)&&H===x.U3.Instant&&(H=x.U3.Range)}catch{}return{...k,queryType:H}}function g(w){const{queryType:H}=w;return H===x.U3.Range||H===x.U3.Instant||H===x.U3.Stream?H:w.instant===!0?x.U3.Instant:x.U3.Range}const o=["String","Identifier","LineComment","Number"],E=["__error__","__interval","__interval_ms","__auto"];function m(w){let H=w;return r.K3.parse(w).iterate({enter:({name:X,from:k,to:_})=>{const ee=w.substring(k,_);o.includes(X)&&!E.includes(ee)&&(H=H.replace(ee,X))}}),H}function f(w){const H=[];return parser.parse(w).iterate({enter:({name:X})=>{H.push(X)}}),H}function p(w,H){let G=!1;return r.K3.parse(w).iterate({enter:({type:k})=>{if(k.id===H)return G=!0,!1}}),G}function h(w,H){const G=[];return r.K3.parse(w).iterate({enter:k=>{(H===void 0||H.includes(k.type.id))&&G.push(k.node)}}),G}function D(w,H){const G=[];return r.K3.parse(w).iterate({enter:k=>{(H===void 0||H.includes(k.type.id))&&G.push(a.Ch.fromNode(k.node))}}),G}function C(w,H){const G=h(w,[H]);return G.length>0?G[0]:void 0}function l(w){return p(w,i.Ql)}function v(w){return w.trim().length>2&&!p(w,r.Yw)}function y(w){const G=h(w,[r.iT,r.eF,r.c$]).length;return{queryWithParser:G>0,parserCount:G}}function P(w){const H=h(w,[r.iT,r.LM,r.c$]);return H.length>0?w.substring(H[0].from,H[0].to).trim():void 0}function b(w){const H=h(w,[r.bY]);for(const G of H){const X=G.getChild(r.g$)?.getChild(r.gw);if(X&&w.substring(X.from,X.to)==="__error__")return!0}return!1}function S(w){return p(w,r.J_)}function M(w){if(v(w))return w;const H=C(w,r.MD);if(!H)return"";const G=w.substring(H.from,H.to),X=C(w,r.AL),k=X?w.substring(X.from,X.to):"";return`${G} ${k}`.trim()}function O(w,H){if(v(w))return w;const G=h(w,[r.Yw]).reverse().find(X=>X.from<=H&&X.to>=H);return G?M(w.substring(G.from,G.to)):""}function R(w){return p(w,r.bY)}function L(w){return p(w,r.PN)}function B(w){const H=h(w,[r.Q6]);for(const G of H)if(w.substring(G.from,G.to).match(/\[\$__range(_s|_ms)?/))return!0;return!1}function F(w){return(0,a.yB)(w).map(X=>w.slice(X.from,X.to))}function I(w){return w.filter(G=>!G.hide).filter(G=>!G.refId.includes("do-not-chunk")).filter(G=>G.expr).length>0}function U(w){return w.filter(G=>!G.hide).filter(G=>G.queryType!==x.U3.Instant).filter(G=>!G.refId.includes("do-not-shard")).filter(G=>G.expr).filter(G=>G.direction===x.ti.Scan&&v(G.expr)||W(G.expr)).length>0}function W(w){if(v(w)||(w=w.trim().toLowerCase(),h(w,[r.MK]).length>0))return!1;const G=h(w,[r.ZQ]),X=G.filter(Z=>A(w,Z)==="sum"),k=G.filter(Z=>A(w,Z)!=="sum"),_=X.filter(Z=>k.every(te=>Z.from<te.from));if(k.length>0)return _.length>0;const ee=h(w,[r.lo]),J=["count_over_time","sum_over_time","bytes_over_time"];for(const Z of ee)if(!J.includes(A(w,Z)))return _.length>0;return!0}function A(w,H){return w.substring(H.from,H.to)}const N=w=>w?"expr"in w&&w.expr!==void 0:!1,K=w=>{if(!(!w||!N(w)))return w},V=(w,H)=>{if(H.length===0)return w;let G=H.join("|");return G==="-1"||H.length===1?(G=G==="-1"?"":G,w.map(X=>({...X,expr:T(X.expr,"=",G)}))):w.map(X=>({...X,expr:T(X.expr,"=~",G)}))};function T(w,H,G){const X=(0,a.tE)(w,"__stream_shard__",H,G,x.HD.Indexed);return v(w)?X:(0,a.Gk)(X,["__stream_shard__"])}const z=w=>{const H=h(w,[r.MD]);return H.length>0?w.substring(H[0].from,H[0].to):""}},24271:(q,j,e)=>{"use strict";e.d(j,{y:()=>i});var t=e(30028),n=e(54042),r=e(9505);class a extends t.Y{constructor(){super(n.sp,"<expr>"),this.setOperationCategories([r.Ln.Aggregations,r.Ln.RangeFunctions,r.Ln.Formats,r.Ln.BinaryOps,r.Ln.LabelFilters,r.Ln.LineFilters])}renderOperations(s,c){for(const d of c){if(d.disabled)continue;const u=this.operationsRegistry.getIfExists(d.id);if(!u){console.error(`Could not find operation ${d.id} in the registry`);continue}s=u.renderer(d,u,s)}return s}renderBinaryQueries(s,c){if(c)for(const d of c)s=`${this.renderBinaryQuery(s,d)}`;return s}renderBinaryQuery(s,c){let d=s+` ${c.operator} `;return c.vectorMatches&&(d+=`${c.vectorMatchesType}(${c.vectorMatches}) `),d+this.renderQuery(c.query,!0)}renderLabels(s){if(s.length===0)return"{}";let c="{";for(const d of s)c!=="{"&&(c+=", "),c+=`${d.label}${d.op}"${d.value}"`;return c+"}"}renderQuery(s,c){let d=this.renderLabels(s.labels);return d=this.renderOperations(d,s.operations),!c&&this.hasBinaryOp(s)&&s.binaryQueries?.length&&(d=`(${d})`),d=this.renderBinaryQueries(d,s.binaryQueries),d}getQueryPatterns(){return[{name:"Parse log lines with logfmt parser",type:r.IQ.Log,operations:[{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]}]},{name:"Parse log lines with JSON parser",type:r.IQ.Log,operations:[{id:r.EF.Json,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]}]},{name:"Filter log line and parse with logfmt parser",type:r.IQ.Log,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]}]},{name:"Filter log lines and parse with json parser",type:r.IQ.Log,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Json,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]}]},{name:"Parse log line with logfmt parser and use label filter",type:r.IQ.Log,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.LabelFilter,params:["label","=","value"]}]},{name:"Parse log lines with nested json",type:r.IQ.Log,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Json,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.LineFormat,params:["{{.message}}"]},{id:r.EF.Json,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]}]},{name:"Reformat log lines",type:r.IQ.Log,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.LineFormat,params:["{{.message}}"]}]},{name:"Rename lvl label to level",type:r.IQ.Log,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.LabelFormat,params:["lvl","level"]}]},{name:"Query on value inside a log line",type:r.IQ.Metric,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.Unwrap,params:[""]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.SumOverTime,params:["$__auto"]},{id:r.EF.Sum,params:[]}]},{name:"Total requests per label of streams",type:r.IQ.Metric,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.CountOverTime,params:["$__auto"]},{id:r.EF.Sum,params:[]}]},{name:"Total requests per parsed label or label of streams",type:r.IQ.Metric,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.CountOverTime,params:["$__auto"]},{id:r.EF.Sum,params:[]}]},{name:"Bytes used by a log stream",type:r.IQ.Metric,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.BytesOverTime,params:["$__auto"]}]},{name:"Count of log lines per stream",type:r.IQ.Metric,operations:[{id:r.EF.LineContains,params:[""]},{id:r.EF.CountOverTime,params:["$__auto"]}]},{name:"Top N results by label or parsed label",type:r.IQ.Metric,operations:[{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.CountOverTime,params:["$__auto"]},{id:r.EF.Sum,params:[]},{id:r.EF.TopK,params:[10]}]},{name:"Extracted quantile",type:r.IQ.Metric,operations:[{id:r.EF.Logfmt,params:[]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.Unwrap,params:["latency"]},{id:r.EF.LabelFilterNoErrors,params:[]},{id:r.EF.QuantileOverTime,params:["$__auto",.5]},{id:r.EF.Sum,params:[]}]}]}}const i=new a},32305:(q,j,e)=>{"use strict";e.d(j,{C:()=>r,I:()=>a});var t=e(94509),n=e(9505);const r=[{id:n.EF.Addition,name:"Add scalar",sign:"+"},{id:n.EF.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.EF.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.EF.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.EF.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.EF.Exponent,name:"Exponent",sign:"^"},{id:n.EF.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.EF.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.EF.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.EF.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.EF.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.EF.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],a=r.map(x=>{const s=[{name:"Value",type:"number"}];let c=[2];return x.comparison&&(s.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),c=[2,!1]),{id:x.id,name:x.name,params:s,defaultParams:c,toggleable:!0,alternativesKey:"binary scalar operations",category:n.Ln.BinaryOps,renderer:i(x.sign),addOperationHandler:t.iZ}});function i(x){return function(c,d,u){let g=c.params[0],o="";return c.params.length===2&&(o=c.params[1]?" bool":""),`${u} ${x}${o} ${g}`}}},94509:(q,j,e)=>{"use strict";e.d(j,{af:()=>y,VR:()=>P,G3:()=>I,jC:()=>K,fu:()=>E,yD:()=>m,iZ:()=>F,UF:()=>b,OS:()=>M,hh:()=>D,sn:()=>h,EP:()=>C});var t=e(2543),n=e(55127),r=e.n(n),a=e(91529),i=e(14191),x=e(74848),s=e(96540),c=e(44826);const d=({onChange:T,index:z,operationId:w,value:H,query:G,datasource:X,queryModeller:k})=>{const[_,ee]=(0,s.useState)({});return(0,x.jsx)(c.l6,{inputId:M(w,z),autoFocus:H==="",openMenuOnFocus:!0,onOpenMenu:async()=>{ee({isLoading:!0});const J=await u(G,X,k);ee({options:J,isLoading:void 0})},isLoading:_.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:_.options,value:g(H),onChange:J=>T(z,J.value)})};async function u(T,z,w){let H=T.labels;const G=w.renderLabels(H);return(await z.languageProvider.fetchLabels({streamSelector:G})).map(k=>({label:k,value:k}))}const g=T=>({label:T?.toString(),value:T});var o=e(9505);function E(T,z){const w=[S()],H=["$__auto"];let G;return T===o.EF.QuantileOverTime&&(H.push("0.95"),w.push({name:"Quantile",type:"number"})),z&&(w.push({name:"By label",type:"string",restParam:!0,optional:!0}),G=O(`__${T}_by`)),{id:T,name:B(T),params:w,defaultParams:H,toggleable:!0,alternativesKey:"range function",category:o.Ln.RangeFunctions,orderRank:o.h5.RangeVectorFunction,renderer:p,addOperationHandler:y,paramChangedHandler:G,explainHandler:(X,k)=>{let _=i.AW.find(ee=>ee.insertText===X.id)?.documentation??"";return X.params[0]==="$__auto"?`${_} \`$__auto\` is a variable that will be replaced with the [value of step](https://grafana.com/docs/grafana/next/datasources/loki/query-editor/#options) for range queries and with the value of the selected time range (calculated to - from) for instant queries.`:`${_} The [range vector](https://grafana.com/docs/loki/latest/logql/metric_queries/#range-vector-aggregation) is set to \`${X.params[0]}\`.`}}}function m(T){const z=E(T,!0),w=z.params.slice(0,-1);return[z,{id:`__${T}_by`,name:`${B(T)} by`,params:[...w,{name:"Label",type:"string",restParam:!0,optional:!0,editor:d}],defaultParams:[...z.defaultParams,""],toggleable:!0,alternativesKey:"range function with grouping",category:o.Ln.RangeFunctions,renderer:f(T,"by"),paramChangedHandler:L(T),explainHandler:R(T,"by"),addOperationHandler:y,hideFromList:!0},{id:`__${T}_without`,name:`${B(T)} without`,params:[...w,{name:"Label",type:"string",restParam:!0,optional:!0,editor:d}],defaultParams:[...z.defaultParams,""],alternativesKey:"range function with grouping",category:o.Ln.RangeFunctions,renderer:f(T,"without"),paramChangedHandler:L(T),explainHandler:R(T,"without"),addOperationHandler:y,hideFromList:!0}]}function f(T,z){return function(H,G,X){const k=G.params.findIndex(J=>J.restParam),_=H.params.slice(0,k),ee=H.params.slice(k);return _.length===2&&T===o.EF.QuantileOverTime?`${T}(${_[1]}, ${X} [${_[0]}]) ${z} (${ee.join(", ")})`:`${T}(${X} [${_[0]}]) ${z} (${ee.join(", ")})`}}function p(T,z,w){const H=T.params??[],G=H[0]??"$__auto";if(H.length===2&&T.id===o.EF.QuantileOverTime){const X=H[1];return`${T.id}(${X}, ${w} [${G}])`}return`${T.id}(${w} [${H[0]??"$__auto"}])`}function h(T,z,w){return["<","<=",">",">="].includes(String(T.params[1]))?`${w} | ${T.params[0]} ${T.params[1]} ${T.params[2]}`:`${w} | ${T.params[0]} ${T.params[1]} \`${T.params[2]}\``}function D(T,z){if(!T)return!1;const w=T.params[1].toString().startsWith("!");return z.filter(X=>X.id===o.EF.LabelFilter&&X.params[0]===T.params[0]&&X.params[2]===T.params[2]).some(X=>!!(w&&X.params[1].toString().startsWith("!")===!1||w===!1&&X.params[1].toString().startsWith("!")))}function C(T,z,w){switch(T.id){case o.EF.Logfmt:const[H=!1,G=!1,...X]=T.params;return`${w} | logfmt${H?" --strict":""}${G?" --keep-empty":""} ${X.filter(k=>k).join(", ")}`.trim();case o.EF.Json:return`${w} | json ${T.params.filter(k=>k).join(", ")}`.trim();case o.EF.Drop:return`${w} | drop ${T.params.filter(k=>k).join(", ")}`.trim();case o.EF.Keep:return`${w} | keep ${T.params.filter(k=>k).join(", ")}`.trim();default:return`${w} | ${T.id}`}}function l(T){return T.category===o.Ln.RangeFunctions}function v(T,z,w){const H=T.findIndex(G=>{const X=z.getOperationDefinition(G.id);return X?w(X):!1});return H===-1?T.length:H}function y(T,z,w){const H={id:T.id,params:T.defaultParams},G=[...z.operations],X=G.find(k=>{const _=w.getOperationDefinition(k.id);return _?l(_):!1});switch(T.category){case o.Ln.Aggregations:case o.Ln.Functions:if(!X){const _=v(G,w,ee=>ee.category===o.Ln.Functions);G.splice(_,0,{id:o.EF.Rate,params:["$__auto"]})}G.push(H);break;case o.Ln.RangeFunctions:if(X){const _=G.indexOf(X);G[_]=H;break}default:const k=v(G,w,_=>(T.orderRank??100)<(_.orderRank??100));G.splice(k,0,H);break}return{...z,operations:G}}function P(T,z){return{...z,binaryQueries:[...z.binaryQueries??[],{operator:"/",query:z}]}}function b(T,z){return function(H,G,X){const k=H.params.some(J=>typeof J=="string"&&J.includes("`")),_=k?'"':"`";let ee;return k?ee=H.params.map(J=>typeof J=="string"?(0,a.Qn)(J):J):ee=H.params,z?`${X} ${T} ${_}(?i)${ee.join(`${_} or ${_}(?i)`)}${_}`:`${X} ${T} ${_}${ee.join(`${_} or ${_}`)}${_}`}}function S(){return{name:"Range",type:"string",options:["$__auto","1m","5m","10m","1h","24h"]}}function M(T,z){return`operations.${T}.param.${z}`}function O(T){return function(w,H,G){return H.params.length===G.params.length?{...H,id:T}:H}}function R(T,z){return function(H){const G=H.params.map(k=>`\`${k}\``).join(" and "),X=r()("label",H.params.length);switch(z){case"by":return`Calculates ${T} over dimensions while preserving ${X} ${G}.`;case"without":return`Calculates ${T} over the dimensions ${G}. All other labels are preserved.`;default:return`Calculates ${T} over the dimensions.`}}}function L(T){return function(w,H,G){return H.params.length<G.params.length?{...H,id:T}:H}}function B(T){return(0,t.capitalize)(T.replace(/_/g," "))}function F(T,z){const w={id:T.id,params:T.defaultParams};return{...z,operations:[...z.operations,w]}}function I(T,z={}){return[{id:T,name:B(T),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],toggleable:!0,alternativesKey:"plain aggregations",category:o.Ln.Aggregations,renderer:W,paramChangedHandler:O(`__${T}_by`),explainHandler:R(T,""),addOperationHandler:F,...z},{id:`__${T}_by`,name:`${B(T)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:d}],defaultParams:[""],alternativesKey:"aggregations by",category:o.Ln.Aggregations,renderer:N(T),paramChangedHandler:L(T),explainHandler:R(T,"by"),addOperationHandler:F,hideFromList:!0,...z},{id:`__${T}_without`,name:`${B(T)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:d}],defaultParams:[""],alternativesKey:"aggregations by",category:o.Ln.Aggregations,renderer:U(T),paramChangedHandler:L(T),explainHandler:R(T,"without"),addOperationHandler:F,hideFromList:!0,...z}]}function U(T){return function(w,H,G){return`${T} without(${w.params.join(", ")}) (${G})`}}function W(T,z,w){const H=A(T,z,w),G=T.id+"(";return w&&H.push(w),G+H.join(", ")+")"}function A(T,z,w){return(T.params??[]).map((H,G)=>z.params[G].type==="string"?'"'+H+'"':H)}function N(T){return function(w,H,G){return`${T} by(${w.params.join(", ")}) (${G})`}}function K(T,z,w={}){const H=I(T,w);return H[0].params.unshift(...z.params),H[1].params.unshift(...z.params),H[2].params.unshift(...z.params),H[0].defaultParams=z.defaultParams,H[1].defaultParams=[...z.defaultParams,""],H[2].defaultParams=[...z.defaultParams,""],H[1].renderer=V(T),H[2].renderer=V(T),H}function V(T){return function(w,H,G){const X=H.params.findIndex(ee=>ee.restParam),k=w.params.slice(0,X),_=w.params.slice(X);return`${T} by(${_.join(", ")}) (${k.map((ee,J)=>H.params[J].type==="string"?`"${ee}"`:ee).join(", ")}, ${G})`}}},54042:(q,j,e)=>{"use strict";e.d(j,{VI:()=>l,y6:()=>D,mD:()=>C,sp:()=>h});var t=e(32305),n=e(74848),r=e(96540),a=e(35095),i=e(55801),x=e(32370),s=e(44826),c=e(35747),d=e(38275),u=e(36745),g=e(45331),o=e(94509);function E({onChange:v,index:y,operationId:P,value:b,query:S,datasource:M,timeRange:O,queryModeller:R}){const[L,B]=(0,r.useState)({});return(0,n.jsx)(s.l6,{inputId:(0,o.OS)(P,y),onOpenMenu:async()=>{if(M instanceof d.VQ&&x.$.featureToggles.lokiQueryHints){B({isLoading:!0});const F=await m(S,M,R,O);B({options:F,isLoading:void 0})}},isLoading:L.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:L.options,value:b?(0,a.z)(b.toString()):null,onChange:F=>{F.value&&v(y,F.value)}})}async function m(v,y,P,b=(0,i.E2)()){const S=P.renderQuery(v),M=(0,u.OT)(S);if((0,u.FV)(y.interpolateString(M,c.a)))return[];const O=await y.getDataSamples({expr:M,refId:"unwrap_samples"},b);return(0,g.aN)(O[0]).map(B=>({label:B,value:B}))}var f=e(9505);function p(){const v=[f.EF.Sum,f.EF.Min,f.EF.Max,f.EF.Avg,f.EF.Stddev,f.EF.Stdvar,f.EF.Count].flatMap(M=>(0,o.G3)(M,{addOperationHandler:o.af,orderRank:f.h5.Last})),y=[f.EF.TopK,f.EF.BottomK].flatMap(M=>(0,o.jC)(M,{params:[{name:"K-value",type:"number"}],defaultParams:[5]},{addOperationHandler:o.af,orderRank:f.h5.Last})),P=[(0,o.fu)(f.EF.Rate),(0,o.fu)(f.EF.RateCounter),(0,o.fu)(f.EF.CountOverTime),(0,o.fu)(f.EF.SumOverTime),(0,o.fu)(f.EF.BytesRate),(0,o.fu)(f.EF.BytesOverTime),(0,o.fu)(f.EF.AbsentOverTime)],b=[...(0,o.yD)(f.EF.AvgOverTime),...(0,o.yD)(f.EF.MaxOverTime),...(0,o.yD)(f.EF.MinOverTime),...(0,o.yD)(f.EF.FirstOverTime),...(0,o.yD)(f.EF.LastOverTime),...(0,o.yD)(f.EF.StdvarOverTime),...(0,o.yD)(f.EF.StddevOverTime),...(0,o.yD)(f.EF.QuantileOverTime)];return[...v,...y,...P,...b,{id:f.EF.Json,name:"Json",params:[{name:"Expression",type:"string",restParam:!0,optional:!0,minWidth:18,placeholder:'server="servers[0]"',description:"Using expressions with your json parser will extract only the specified json fields to labels. You can specify one or more expressions in this way. All expressions must be quoted."}],defaultParams:[],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.Parsers,renderer:o.EP,addOperationHandler:o.af,explainHandler:()=>"This will extract keys and values from a [json](https://grafana.com/docs/loki/latest/logql/log_queries/#json) formatted log line as labels. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:f.EF.Logfmt,name:"Logfmt",params:[{name:"Strict",type:"boolean",optional:!0,description:"With strict parsing enabled, the logfmt parser immediately stops scanning the log line and returns early with an error when it encounters any poorly formatted key/value pair."},{name:"Keep empty",type:"boolean",optional:!0,description:"The logfmt parser retains standalone keys (keys without a value) as labels with its value set to empty string. "},{name:"Expression",type:"string",optional:!0,restParam:!0,minWidth:18,placeholder:"field_name",description:"Using expressions with your logfmt parser will extract and rename (if provided) only the specified fields to labels. You can specify one or more expressions in this way."}],defaultParams:[!1,!1],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.Parsers,renderer:o.EP,addOperationHandler:o.af,explainHandler:()=>"This will extract all keys and values from a [logfmt](https://grafana.com/docs/loki/latest/logql/log_queries/#logfmt) formatted log line as labels. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:f.EF.Regexp,name:"Regexp",params:[{name:"String",type:"string",hideName:!0,placeholder:"<re>",description:"The regexp expression that matches the structure of a log line.",minWidth:20}],defaultParams:[""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.Parsers,renderer:(M,O,R)=>`${R} | regexp \`${M.params[0]}\``,addOperationHandler:o.af,explainHandler:()=>'The [regexp parser](https://grafana.com/docs/loki/latest/logql/log_queries/#regular-expression) takes a single parameter | regexp "<re>" which is the regular expression using the Golang RE2 syntax. The regular expression must contain a least one named sub-match (e.g (?P<name>re)), each sub-match will extract a different label. The expression matches the structure of a log line. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.'},{id:f.EF.Pattern,name:"Pattern",params:[{name:"String",type:"string",hideName:!0,placeholder:"<pattern-expression>",description:"The expression that matches the structure of a log line.",minWidth:20}],defaultParams:[""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.Parsers,renderer:(M,O,R)=>`${R} | pattern \`${M.params[0]}\``,addOperationHandler:o.af,explainHandler:()=>"The [pattern parser](https://grafana.com/docs/loki/latest/logql/log_queries/#pattern) allows the explicit extraction of fields from log lines by defining a pattern expression (| pattern `<pattern-expression>`). The expression matches the structure of a log line. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:f.EF.Unpack,name:"Unpack",params:[],defaultParams:[],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.Parsers,renderer:o.EP,addOperationHandler:o.af,explainHandler:()=>"This will extract all keys and values from a JSON log line, [unpacking](https://grafana.com/docs/loki/latest/logql/log_queries/#unpack) all embedded labels in the pack stage. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:f.EF.LineFormat,name:"Line format",params:[{name:"String",type:"string",hideName:!0,placeholder:"{{.status_code}}",description:"A line template that can refer to stream labels and extracted labels.",minWidth:20}],defaultParams:[""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.PipeOperations,renderer:(M,O,R)=>`${R} | line_format \`${M.params[0]}\``,addOperationHandler:o.af,explainHandler:()=>`This will replace log line using a specified template. The template can refer to stream labels and extracted labels.

Example: \`{{.status_code}} - {{.message}}\`

[Read the docs](https://grafana.com/docs/loki/latest/logql/log_queries/#line-format-expression) for more.
        `},{id:f.EF.LabelFormat,name:"Label format",params:[{name:"Label",type:"string"},{name:"Rename to",type:"string"}],defaultParams:["",""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.PipeOperations,renderer:(M,O,R)=>`${R} | label_format ${M.params[1]}=${M.params[0]}`,addOperationHandler:o.af,explainHandler:()=>'This will change name of label to desired new label. In the example below, label "error_level" will be renamed to "level".\n\nExample: ``error_level=`level` ``\n\n[Read the docs](https://grafana.com/docs/loki/latest/logql/log_queries/#labels-format-expression) for more.\n        '},{id:f.EF.LineContains,name:"Line contains",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to find",description:"Find log lines that contains this text",minWidth:20,runQueryOnEnter:!0}],defaultParams:[""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(0,o.UF)("|="),addOperationHandler:o.af,explainHandler:M=>`Return log lines that contain string \`${M.params?.join("`, or `")}\`.`},{id:f.EF.LineContainsNot,name:"Line does not contain",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to exclude",description:"Find log lines that does not contain this text",minWidth:26,runQueryOnEnter:!0}],defaultParams:[""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(0,o.UF)("!="),addOperationHandler:o.af,explainHandler:M=>`Return log lines that does not contain string \`${M.params?.join("`, or `")}\`.`},{id:f.EF.LineContainsCaseInsensitive,name:"Line contains case insensitive",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to find",description:"Find log lines that contains this text",minWidth:33,runQueryOnEnter:!0}],defaultParams:[""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(0,o.UF)("|~",!0),addOperationHandler:o.af,explainHandler:M=>`Return log lines that match regex \`(?i)${M.params?.join("`, or `(?i)")}\`.`},{id:f.EF.LineContainsNotCaseInsensitive,name:"Line does not contain case insensitive",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to exclude",description:"Find log lines that does not contain this text",minWidth:40,runQueryOnEnter:!0}],defaultParams:[""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(0,o.UF)("!~",!0),addOperationHandler:o.af,explainHandler:M=>`Return log lines that does not match regex \`(?i)${M.params?.join("`, or `(?i)")}\`.`},{id:f.EF.LineMatchesRegex,name:"Line contains regex match",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Pattern to match",description:"Find log lines that match this regex pattern",minWidth:30,runQueryOnEnter:!0}],defaultParams:[""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(0,o.UF)("|~"),addOperationHandler:o.af,explainHandler:M=>`Return log lines that match a \`RE2\` regex pattern. \`${M.params?.join("`, or `")}\`.`},{id:f.EF.LineMatchesRegexNot,name:"Line does not match regex",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Pattern to exclude",description:"Find log lines that does not match this regex pattern",minWidth:30,runQueryOnEnter:!0}],defaultParams:[""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(0,o.UF)("!~"),addOperationHandler:o.af,explainHandler:M=>`Return log lines that doesn't match a \`RE2\` regex pattern. \`${M.params?.join("`, or `")}\`.`},{id:f.EF.LineFilterIpMatches,name:"IP line filter expression",params:[{name:"Operator",type:"string",minWidth:16,options:[f.NS.contains,f.NS.doesNotContain]},{name:"Pattern",type:"string",placeholder:"<pattern>",minWidth:16,runQueryOnEnter:!0}],defaultParams:["|=",""],toggleable:!0,alternativesKey:"line filter",category:f.Ln.LineFilters,orderRank:f.h5.LineFilters,renderer:(M,O,R)=>`${R} ${M.params[0]} ip(\`${M.params[1]}\`)`,addOperationHandler:o.af,explainHandler:M=>`Return log lines using IP matching of \`${M.params[1]}\``},{id:f.EF.LabelFilter,name:"Label filter expression",params:[{name:"Label",type:"string",minWidth:14},{name:"Operator",type:"string",minWidth:14,options:[f.NS.equals,f.NS.doesNotEqual,f.NS.matchesRegex,f.NS.doesNotMatchRegex,f.NS.greaterThan,f.NS.lessThan,f.NS.greaterThanOrEqual,f.NS.lessThanOrEqual]},{name:"Value",type:"string",minWidth:14}],defaultParams:["","=",""],toggleable:!0,alternativesKey:"label filter",category:f.Ln.LabelFilters,orderRank:f.h5.PipeOperations,renderer:o.sn,addOperationHandler:o.af,explainHandler:()=>"Label expression filter allows filtering using original and extracted labels."},{id:f.EF.LabelFilterIpMatches,name:"IP label filter expression",params:[{name:"Label",type:"string",minWidth:14},{name:"Operator",type:"string",minWidth:14,options:[f.NS.equals,f.NS.doesNotEqual]},{name:"Value",type:"string",minWidth:14}],defaultParams:["","=",""],toggleable:!0,alternativesKey:"label filter",category:f.Ln.LabelFilters,orderRank:f.h5.PipeOperations,renderer:(M,O,R)=>`${R} | ${M.params[0]} ${M.params[1]} ip(\`${M.params[2]}\`)`,addOperationHandler:o.af,explainHandler:M=>`Return log lines using IP matching of \`${M.params[2]}\` for \`${M.params[0]}\` label`},{id:f.EF.LabelFilterNoErrors,name:"No pipeline errors",params:[],defaultParams:[],toggleable:!0,alternativesKey:"label filter",category:f.Ln.LabelFilters,orderRank:f.h5.NoErrors,renderer:(M,O,R)=>`${R} | __error__=\`\``,addOperationHandler:o.af,explainHandler:()=>"Filter out all formatting and parsing errors."},{id:f.EF.Unwrap,name:"Unwrap",params:[{name:"Identifier",type:"string",hideName:!0,minWidth:16,placeholder:"Label key",editor:E},{name:"Conversion function",hideName:!0,type:"string",options:["duration","duration_seconds","bytes"],optional:!0}],defaultParams:["",""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.Unwrap,renderer:(M,O,R)=>`${R} | unwrap ${M.params[1]?`${M.params[1]}(${M.params[0]})`:M.params[0]}`,addOperationHandler:o.af,explainHandler:M=>{let O=String(M.params[0]).length>0?M.params[0]:"<label>";return`Use the extracted label \`${O}\` as sample values instead of log lines for the subsequent range aggregation.${M.params[1]?` Conversion function \`${M.params[1]}\` wrapping \`${O}\` will attempt to convert this label from a specific format (e.g. 3k, 500ms).`:""}`}},{id:f.EF.Decolorize,name:"Decolorize",params:[],defaultParams:[],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.PipeOperations,renderer:(M,O,R)=>`${R} | decolorize`,addOperationHandler:o.af,explainHandler:()=>"This will remove ANSI color codes from log lines."},{id:f.EF.Drop,name:"Drop",params:[{name:"Label",type:"string",restParam:!0,optional:!0,minWidth:18,placeholder:'job="grafana"',description:"Specify labels or expressions to drop."}],defaultParams:[""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.PipeOperations,renderer:o.EP,addOperationHandler:o.af,explainHandler:()=>"The drop expression will drop the given labels in the pipeline."},{id:f.EF.Keep,name:"Keep",params:[{name:"Label",type:"string",restParam:!0,optional:!0,minWidth:18,placeholder:'job="grafana"',description:"Specify labels or expressions to keep."}],defaultParams:[""],toggleable:!0,alternativesKey:"format",category:f.Ln.Formats,orderRank:f.h5.PipeOperations,renderer:o.EP,addOperationHandler:o.af,explainHandler:()=>"The keep expression will keep only the specified labels in the pipeline and drop all the other labels."},...t.I,{id:f.EF.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],toggleable:!0,category:f.Ln.BinaryOps,renderer:(M,O,R)=>R,addOperationHandler:o.VR}]}const h=p();function D(v){return(h.find(b=>b.id===v)?.explainHandler?.({id:"",params:["<value>"]})||"").replace(/\[(.*)\]\(.*\)/g,"$1")}function C(v){return h.find(y=>y.id===v)}function l(v,y){return!(y.length<v.params.filter(P=>!P.optional).length)}},3152:(q,j,e)=>{"use strict";e.d(j,{u_:()=>x,w4:()=>b});var t=e(36195),n=e(32305),r=e(54042),a=e(31451),i=e(9505);function x(B){const F=(0,a.qk)(B),U=t.K3.parse(F).topNode,A={query:{labels:[],operations:[]},errors:[]};try{s(F,U,A)}catch(N){console.error(N),N instanceof Error&&A.errors.push({text:N.message})}return O(A.query)&&(A.errors=[]),A}function s(B,F,I){const U=I.query;switch(F.type.id){case t.g$:{U.labels.push(c(B,F));const W=F.getChild(a.Ql);W&&I.errors.push((0,a.xz)(B,W));break}case t.PN:{const{operation:W,error:A}=d(B,F);W&&U.operations.push(W),A&&I.errors.push(M(B,F,A));break}case t.iT:{U.operations.push(u(B,F));break}case t.bY:{const{operation:W,error:A}=E(B,F);W&&U.operations.push(W),A&&I.errors.push(M(B,F,A));break}case t.eF:{U.operations.push(g(B,F));break}case t.Zj:case t.Tz:{const{operation:W,error:A}=o(B,F);W&&U.operations.push(W),A&&I.errors.push(M(B,F,A));break}case t.pH:{U.operations.push(m(B,F));break}case t.e_:{U.operations.push(f(B,F));break}case t.HV:{const{operation:W,error:A}=h(B,F,I);W&&U.operations.push(W),A&&I.errors.push(M(B,F,A));break}case t.Zg:{U.operations.push(p());break}case t.h1:{U.operations.push(D(B,F,I));break}case t.Rh:{U.operations.push(C(B,F,I));break}case t.MK:{v(B,F,I);break}case a.Ql:{if(P(F))break;I.errors.push((0,a.xz)(B,F));break}case t.i8:{U.operations.push(R(B,F,I));break}case t.UP:{U.operations.push(L(B,F,I));break}default:{let W=F.firstChild;for(;W;)s(B,W,I),W=W.nextSibling}}}function c(B,F){const I=F.getChild(t.gw),U=(0,a.AA)(B,I),W=(0,a.AA)(B,I?.nextSibling);let A=(0,a.AA)(B,F.getChild(t.Qf));return A=A.substring(1,A.length-1),{label:U,op:W,value:A}}function d(B,F){const I=(0,a.AA)(B,F.getChild(t.dJ)),U=b((0,a.AA)(B,F.getChild(t.Qf)));if(F.getChild(t.w7)?.getChild(t.Ip))return{operation:{id:i.EF.LineFilterIpMatches,params:[I,U]}};const A=[U];let N=F.getChild(t.ih);for(;N;)A.push(b((0,a.AA)(B,N.getChild(t.Qf)))),N=N.getChild(t.ih);return{operation:{id:{"|=":i.EF.LineContains,"!=":i.EF.LineContainsNot,"|~":i.EF.LineMatchesRegex,"!~":i.EF.LineMatchesRegexNot}[I],params:A}}}function u(B,F){const I=F.firstChild,U=(0,a.AA)(B,I),W=b((0,a.AA)(B,F.getChild(t.Qf)));let A=W?[W]:[];const N=(0,r.mD)(U);return N&&!(0,r.VI)(N,A)&&(A=N?.defaultParams||[]),{id:U,params:A}}function g(B,F){const I=F.getChild(t.LM),U=(0,a.AA)(B,I),W=[...(0,a.R1)(B,F,t.Gn)];return{id:U,params:W}}function o(B,F){const I=[],U=[];let W;const A=F.from;return F.toTree().iterate({enter:K=>{K.type.id===t.ov?I.push(B.substring(K.from+A,K.to+A)):K.type.id===t.Gn?U.push(B.substring(K.from+A,K.to+A)):K.type.id===a.Ql&&(W=`Unexpected string "${B.substring(K.from+A,K.to+A)}"`)}}),{operation:{id:i.EF.Logfmt,params:[I.includes("--strict"),I.includes("--keep-empty"),...U]},error:W}}function E(B,F){if(F.getChild(t.Or)||F.getChild(t.KD)||F.getChild("Comma"))return{error:'Label filter with comma, "and", "or" not supported in query builder'};if(F.firstChild.type.id===t.GA){const V=F.firstChild,T=V?.getChild(t.gw),z=T?.nextSibling,w=V?.getChild(t.Qf),H=b((0,a.AA)(B,w));return{operation:{id:i.EF.LabelFilterIpMatches,params:[(0,a.AA)(B,T),(0,a.AA)(B,z),H]}}}const I=i.EF.LabelFilter;if(F.firstChild.type.id===t.Jq){const T=F.firstChild.firstChild.firstChild,z=T.nextSibling,w=z.nextSibling,H=b((0,a.AA)(B,w));return{operation:{id:I,params:[(0,a.AA)(B,T),(0,a.AA)(B,z),H]}}}const W=F.firstChild.firstChild,A=W.nextSibling,N=A.nextSibling,K=[(0,a.AA)(B,W),(0,a.AA)(B,A),b((0,a.AA)(B,N))];return K.join("")==="__error__="?{operation:{id:i.EF.LabelFilterNoErrors,params:[]}}:{operation:{id:I,params:K}}}function m(B,F){const I=i.EF.LineFormat,U=b((0,a.AA)(B,F.getChild(t.Qf)));return{id:I,params:[U]}}function f(B,F){const I=i.EF.LabelFormat,U=F.getChild(t.gw),A=U.nextSibling.nextSibling;return{id:I,params:[(0,a.AA)(B,A),b((0,a.AA)(B,U))]}}function p(){return{id:i.EF.Decolorize,params:[]}}function h(B,F,I){const U=F.getChild(t.HV),W=F.getChild(t.bY),A=F.getChild(t.sK);if(U&&s(B,U,I),W&&s(B,W,I),A){if(A.nextSibling?.type.id===t.yW){const N=A.nextSibling,K=N.nextSibling;return{operation:{id:i.EF.Unwrap,params:[(0,a.AA)(B,K),(0,a.AA)(B,N)]}}}return{operation:{id:i.EF.Unwrap,params:[(0,a.AA)(B,A?.nextSibling),""]}}}return{}}function D(B,F,I){const U=F.getChild(t.lo),W=(0,a.AA)(B,U),A=F.getChild(t.wN),N=F.getChild(t.xo),K=A!=null?[(0,a.AA)(B,A)]:[],V=N?.getChild(t.Q6),T=V?(0,a.AA)(B,V):null,z=F.getChild(t.aU);T&&K.unshift(T.substring(1,T.length-1)),z&&K.push(...(0,a.R1)(B,z,t.gw));const w={id:W,params:K};return N&&s(B,N,I),w}function C(B,F,I){const U=F.getChild(t.ZQ);let W=(0,a.AA)(B,U);const A=F.getChild(t.aU),N=[],K=F.getChild(t.wN);K&&N.push(Number((0,a.AA)(B,K))),A&&(A.getChild(t.By)&&W&&(W=`__${W}_by`),A.getChild(t.xB)&&(W=`__${W}_without`),N.push(...(0,a.R1)(B,A,t.gw)));const V=F.getChild(t.Yw),T={id:W,params:N};return V&&(V.firstChild?.type.id===t.MK&&I.errors.push({text:"Query parsing is ambiguous.",from:V.firstChild.from,to:V.firstChild?.to}),s(B,V,I)),T}const l=n.C.reduce((B,F)=>(B[F.sign]={id:F.id,comparison:F.comparison},B),{});function v(B,F,I){const U=I.query,W=F.firstChild,A=(0,a.AA)(B,W.nextSibling),N=y(B,F.getChild(t.o5)),K=F.lastChild,V=l[A],T=S(W,"MetricExpr.LiteralExpr.Number"),z=S(K,"MetricExpr.LiteralExpr.Number"),w=K.getChild(t.MK);if(T||s(B,W,I),z)U.operations.push((0,a.rq)(V,B,K,!!N?.isBool));else if(w){const H=(0,a.z9)(K);H?.type.id===t.wN&&U.operations.push((0,a.rq)(V,B,H,!!N?.isBool)),s(B,K,I)}else{U.binaryQueries=U.binaryQueries||[];const H={operator:A,query:{labels:[],operations:[]}};N?.isMatcher&&(H.vectorMatchesType=N.matchType,H.vectorMatches=N.matches),U.binaryQueries.push(H),s(B,K,{query:H.query,errors:I.errors})}}function y(B,F){if(!F)return;const I=F.getChild(t.wT),U=F.getChild(t.x);if(!I&&U)return{isBool:!0,isMatcher:!1};{if(!I)return;const W=(0,a.AA)(B,I.getChild(t.x$)?.getChild(t.qJ));return{isMatcher:!0,isBool:!!U,matches:W,matchType:I.getChild(t.On)?"on":"ignoring"}}}function P(B){return B?.parent?.type.id===t.Q6}function b(B){return B[0]==='"'&&B[B.length-1]==='"'?B.substring(1,B.length-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"):B.replace(/`/g,"")}function S(B,F){let I=B;const U=F.split(".");for(const W of U)if(I=I.getChild(W),!I)return null;return I}function M(B,F,I){const U=(0,a.xz)(B,F);return U.text=`${I}: ${U.text}`,U}function O(B){return B.labels.length===0&&B.operations.length===0}function R(B,F,I){const U=[];let W=F.getChild(t.LQ);for(;W;){const A=(0,a.AA)(B,W.getChild(t.yj));A&&U.push(A),W=W?.getChild(t.LQ)}return U.reverse(),{id:i.EF.Drop,params:U}}function L(B,F,I){const U=[];let W=F.getChild(t.J3);for(;W;){const A=(0,a.AA)(B,W.getChild(t.UM));A&&U.push(A),W=W?.getChild(t.J3)}return U.reverse(),{id:i.EF.Keep,params:U}}},31451:(q,j,e)=>{"use strict";e.d(j,{AA:()=>c,If:()=>s,Ql:()=>t,R1:()=>u,SY:()=>a,qk:()=>i,rq:()=>d,xz:()=>r,z9:()=>n});const t=0;function n(o){return o.firstChild?n(o.firstChild):o}function r(o,E){return{text:c(o,E),from:E.from,to:E.to,parentType:E.parent?.name}}const a=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function i(o){return o.replace(a,(E,m,f,p,h,D,C)=>{const l=p||C;let v=m,y="0";return f&&(v=f,y="1"),h&&(v=h,y="2"),`__V_${y}__`+v+"__V__"+(l?"__F__"+l+"__F__":"")})}const x=[(o,E)=>`$${o}`,(o,E)=>`[[${o}${E?`:${E}`:""}]]`,(o,E)=>`\${${o}${E?`:${E}`:""}}`];function s(o){return o.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(E,m,f,p)=>x[parseInt(m,10)](f,p))}function c(o,E){return E?s(o.substring(E.from,E.to)):""}function d(o,E,m,f){const p=[parseFloat(c(E,m))];return o.comparison&&p.push(f),{id:o.id,params:p}}function u(o,E,m){if(E.type.id===m||E.name===m)return[c(o,E)];const f=[];let p=0,h=E.childAfter(p);for(;h;)f.push(...u(o,h,m)),p=h.to,h=E.childAfter(p);return f}const g=o=>o.split(" ").map(m=>`${m}.*`).join("")},9505:(q,j,e)=>{"use strict";e.d(j,{EF:()=>a,IQ:()=>n,Ln:()=>r,NS:()=>x,h5:()=>i});var t=e(55060),n=(s=>(s.Log="log",s.Metric="metric",s))(n||{}),r=(s=>(s.Aggregations="Aggregations",s.RangeFunctions="Range functions",s.Functions="Functions",s.Formats="Formats",s.LineFilters="Line filters",s.LabelFilters="Label filters",s.BinaryOps=`${t.T}`,s))(r||{}),a=(s=>(s.Json="json",s.Logfmt="logfmt",s.Regexp="regexp",s.Pattern="pattern",s.Unpack="unpack",s.LineFormat="line_format",s.LabelFormat="label_format",s.Decolorize="decolorize",s.Drop="drop",s.Keep="keep",s.Rate="rate",s.RateCounter="rate_counter",s.CountOverTime="count_over_time",s.SumOverTime="sum_over_time",s.AvgOverTime="avg_over_time",s.MaxOverTime="max_over_time",s.MinOverTime="min_over_time",s.FirstOverTime="first_over_time",s.LastOverTime="last_over_time",s.StdvarOverTime="stdvar_over_time",s.StddevOverTime="stddev_over_time",s.QuantileOverTime="quantile_over_time",s.BytesRate="bytes_rate",s.BytesOverTime="bytes_over_time",s.AbsentOverTime="absent_over_time",s.Sum="sum",s.Avg="avg",s.Min="min",s.Max="max",s.Stddev="stddev",s.Stdvar="stdvar",s.Count="count",s.TopK="topk",s.BottomK="bottomk",s.LineContains="__line_contains",s.LineContainsNot="__line_contains_not",s.LineContainsCaseInsensitive="__line_contains_case_insensitive",s.LineContainsNotCaseInsensitive="__line_contains_not_case_insensitive",s.LineMatchesRegex="__line_matches_regex",s.LineMatchesRegexNot="__line_matches_regex_not",s.LineFilterIpMatches="__line_filter_ip_matches",s.LabelFilter="__label_filter",s.LabelFilterNoErrors="__label_filter_no_errors",s.LabelFilterIpMatches="__label_filter_ip_marches",s.Unwrap="unwrap",s.SumBy="__sum_by",s.SumWithout="__sum_without",s.Addition="__addition",s.Subtraction="__subtraction",s.MultiplyBy="__multiply_by",s.DivideBy="__divide_by",s.Modulo="__modulo",s.Exponent="__exponent",s.NestedQuery="__nested_query",s.EqualTo="__equal_to",s.NotEqualTo="__not_equal_to",s.GreaterThan="__greater_than",s.LessThan="__less_than",s.GreaterOrEqual="__greater_or_equal",s.LessOrEqual="__less_or_equal",s))(a||{}),i=(s=>(s[s.LineFilters=1]="LineFilters",s[s.Parsers=2]="Parsers",s[s.PipeOperations=3]="PipeOperations",s[s.Unwrap=4]="Unwrap",s[s.NoErrors=5]="NoErrors",s[s.RangeVectorFunction=5]="RangeVectorFunction",s[s.Last=6]="Last",s))(i||{});const x={equals:{label:"=",value:"=",description:"Equals",isMultiValue:!1},doesNotEqual:{label:"!=",value:"!=",description:"Does not equal",isMultiValue:!1},matchesRegex:{label:"=~",value:"=~",description:"Matches regex",isMultiValue:!0},doesNotMatchRegex:{label:"!~",value:"!~",description:"Does not match regex",isMultiValue:!0},greaterThan:{label:">",value:">",description:"Greater than",isMultiValue:!1},greaterThanOrEqual:{label:">=",value:">=",description:"Greater than or equal to",isMultiValue:!1},lessThan:{label:"<",value:"<",description:"Less than",isMultiValue:!1},lessThanOrEqual:{label:"<=",value:"<=",description:"Less than or equal to",isMultiValue:!1},contains:{label:"|=",value:"|=",description:"Contains",isMultiValue:!1},doesNotContain:{label:"!=",value:"!=",description:"Does not contain",isMultiValue:!1}}},45331:(q,j,e)=>{"use strict";e.d(j,{Ac:()=>u,nE:()=>d,db:()=>m,fV:()=>o,sz:()=>f,YB:()=>g,aN:()=>E,BY:()=>p});var t=e(63739),n=e(66102),r=e(91529);function a(h){let D;try{D=JSON.parse(h)}catch{}return typeof D=="object"}const i=/(?:^|\s)([\w\(\)\[\]\{\}]+)=(""|(?:".*?[^\\]"|[^"\s]\S*))/;function x(h){return i.test(h)}function s(h){let D;try{return D=JSON.parse(h),D.hasOwnProperty("_entry")}catch{return!1}}var c=e(57903);function d(h){return(h.fields.find(C=>C.name==="labels")?.values??[]).some(C=>C.__error__!==void 0)}function u(h){return(h.fields.find(C=>C.name==="labels")?.values??[]).some(C=>C.level!==void 0)}function g(h){const D=h.fields.find(P=>P.type===t.PU.string);if(D==null)return{hasJSON:!1,hasLogfmt:!1,hasPack:!1};const C=D.values;let l=!1,v=!1,y=!1;return C.forEach(P=>{a(P)&&(l=!0,y=s(P)),x(P)&&(v=!0)}),{hasLogfmt:v,hasJSON:l,hasPack:y}}function o(h,D=c.HD.Indexed){const C=h?.fields?.find(y=>y.name==="labels")?.values??[],l=h?.fields?.find(y=>y.name==="labelTypes")?.values??[];if(!C?.length)return[];if(!l?.length){if(D===c.HD.Indexed){const{keys:y}=(0,r.P7)(C);return y}return[]}let v=new Set;for(let y=0;y<C.length;y++){const P=C[y],b=l[y],S=Object.keys(P).filter(M=>b[M]===D);v=new Set([...v,...S])}return Array.from(v)}function E(h){const D=h?.fields?.find(l=>l.name==="labels")?.values??[];return D?.length?Object.keys(D[0]).filter(l=>{const v=D[0][l];return v?!isNaN(Number(v))||(0,n.pp)(v)||(0,r.tY)(v):!1}).filter(l=>D.every(v=>v[l])):[]}function m(h){const D=h.fields.find(l=>l.name==="labels"&&l.type===t.PU.other);return D==null?!1:D.values.some(l=>l.__error__)}function f(h){const D=h.fields.find(v=>v.name==="labels"&&v.type===t.PU.other);if(D==null)return null;const C=D.values.slice(0,2);let l=null;for(let v of C){const y=Object.keys(v).find(P=>P==="level"||P==="detected_level"||P==="lvl"||P.includes("level"));if(y){l=y;break}}return l}function p(h){const D=h.errors?(h.errors[0].message??"").toLowerCase():h.error?.message??"";if(D.includes("timeout"))return!0;if(h.data.length>0&&h.data[0].fields.length>0)return!1;throw new Error(D)}},14191:(q,j,e)=>{"use strict";e.d(j,{AW:()=>x,Ay:()=>c,RQ:()=>a,dZ:()=>t,fV:()=>i,vB:()=>s});const t=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],n=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],r=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],a=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],i=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],x=[...t,...a,...i],s={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...n,...r].map(d=>d.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${x.map(d=>d.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},c=s},63609:(q,j,e)=>{"use strict";e.d(j,{Ex:()=>h,jg:()=>u,uJ:()=>D});var t=e(16753),n=e(55060),r=e(56276),a=e(32370),i=e(38275),x=e(51814),s=e(36745),c=e(31451),d=e(57903);const u=({payload:{dashboardId:C,orgId:l,grafanaVersion:v,queries:y}})=>{try{const P=y[x.id]?.filter(A=>!A.hide)?.map(A=>(0,s.vV)(A));if(!P?.length)return;const b=P.filter(A=>(0,s.sI)(A.expr)),S=P.filter(A=>!(0,s.sI)(A.expr)),M=P.filter(A=>A.queryType===d.U3.Instant),O=P.filter(A=>A.queryType===d.U3.Range),R=P.filter(A=>A.editorMode===n.f.Builder),L=P.filter(A=>A.editorMode===n.f.Code),B=P.filter(g),F=P.filter(o),I=P.filter(E),U=P.filter(m),W={grafana_version:v,dashboard_id:C,org_id:l,queries_count:P.length,logs_queries_count:b.length,metric_queries_count:S.length,instant_queries_count:M.length,range_queries_count:O.length,builder_mode_queries_count:R.length,code_mode_queries_count:L.length,queries_with_template_variables_count:B.length,queries_with_changed_resolution_count:F.length,queries_with_changed_line_limit_count:I.length,queries_with_changed_legend_count:U.length};(0,r.rR)("grafana_loki_dashboard_loaded",W)}catch(P){console.error("error in loki tracking handler",P)}},g=C=>c.SY.test(C.expr),o=C=>C.resolution?C.resolution!==1:!1,E=C=>C.maxLines!==null&&C.maxLines!==void 0,m=C=>C.legendFormat?C.legendFormat!=="":!1,f=C=>!![i.Gf,i.M1,i.mL,i.ow,i.lb].some(v=>C.startsWith(v)),p=C=>{let l=0;for(const v of C.data){const y=v.meta?.custom?.lokiQueryStatKey;y&&(l+=v.meta?.stats?.find(P=>P.displayName===y)?.value??0)}return l};function h(C,l,v,y={},P={}){const{app:b,targets:S}=l;if(b!==t.Jk.Explore)return;let M=p(C);for(const O of S){if(f(O.refId))return;(0,r.rR)("grafana_explore_loki_query_executed",{grafana_version:a.$.buildInfo.version,editor_mode:O.editorMode,has_data:C.data.some(R=>R.length>0),has_error:C.error!==void 0,legend:O.legendFormat,line_limit:O.maxLines,obfuscated_query:(0,s.$F)(O.expr),query_type:(0,s.sI)(O.expr)?"logs":"metric",query_vector_type:O.queryType,resolution:O.resolution,simultaneously_executed_query_count:S.filter(R=>!R.hide).length,simultaneously_hidden_query_count:S.filter(R=>R.hide).length,time_range_from:l?.range?.from?.toISOString(),time_range_to:l?.range?.to?.toISOString(),time_taken:Date.now()-v.getTime(),bytes_processed:M,is_split:!1,predefined_operations_applied:y.predefinedOperations?O.expr.includes(y.predefinedOperations):"n/a",...P})}}function D(C,l,v,y,P={}){const b={split_query_group_count:l.length,split_query_largest_partition_size:Math.max(...l.map(({partition:S})=>S.length)),split_query_total_request_count:l.reduce((S,{partition:M})=>S+M.length,0),is_split:!0,simultaneously_executed_query_count:v.targets.filter(S=>!S.hide).length,simultaneously_hidden_query_count:v.targets.filter(S=>S.hide).length};for(const S of l){const M=S.partition.length;h(C,S.request,y,P,{...b,split_query_partition_size:M})}}},57903:(q,j,e)=>{"use strict";e.d(j,{HD:()=>r,Q$:()=>t.Q$,U3:()=>t.U3,ie:()=>a,ti:()=>t.ti});var t=e(24694),n=(i=>(i.Stream="streams",i.Vector="vector",i.Matrix="matrix",i))(n||{}),r=(i=>(i.Indexed="I",i.StructuredMetadata="S",i.Parsed="P",i))(r||{}),a=(i=>(i[i.LabelNames=0]="LabelNames",i[i.LabelValues=1]="LabelValues",i))(a||{})},5956:(q,j,e)=>{"use strict";e.d(j,{N8:()=>v,bG:()=>C,qM:()=>l,uv:()=>D});var t=e(2543),n=e.n(t),r=e(62467),a=e(65474),i=e(45650),x=e(69862),s=e(81160),c=e(9084),d=e(66847),u=e(93031),g=e(71030),o=e(29997),E=e(8392),m=e(39736),f=e(98437),p=e(64121),h=e(11747);const D="-- Mixed --",C="mixed-",l=(P,b)=>`${C}${P}-${b||""}`;class v extends o.mA{constructor(b){super(b)}query(b){const S=b.targets.filter(R=>R.datasource?.uid!==D);if(!S.length)return(0,r.of)({data:[]});const M=(0,t.groupBy)(S,"datasource.uid"),O=[];for(const R in M)R===h.K?M[R].forEach(L=>{O.push(...this.getBatchesForQueries([L],b))}):O.push(...this.getBatchesForQueries(M[R],b));return O.length?this.batchQueries(O,b):(0,r.of)({data:[]})}getBatchesForQueries(b,S){const M=b[0].datasource,O=[],R=(0,m.w)().replace(M?.uid,S.scopedVars,(L,B)=>{if(!Array.isArray(L))return L;for(const F of L){if(F==="default")continue;const I=(0,f.l)().getInstanceSettings(F);O.push({datasource:(0,f.l)().get(F),queries:(0,t.cloneDeep)(b),scopedVars:{...S.scopedVars,[B.name]:{value:F,text:I?.name}}})}return""});return R!==""&&O.push({datasource:(0,f.l)().get(R),queries:(0,t.cloneDeep)(b),scopedVars:{...S.scopedVars}}),O}batchQueries(b,S){const M=b.filter(this.isQueryable).map((O,R)=>(0,a.H)(O.datasource).pipe((0,x.Z)(L=>{const B=(0,t.cloneDeep)(S);return B.requestId=l(R,B.requestId),B.targets=O.queries,B.scopedVars=O.scopedVars,(0,a.H)(L.query(B)).pipe((0,s.T)(F=>({...F,data:F.data||[],state:E.Gu.Loading,key:l(R,F.key)})),(0,c.$)(),(0,d.W)(F=>(F=(0,p.u)(F),F.message=`${L.name}: ${F.message}`,(0,r.of)([{data:[],state:E.Gu.Error,error:F,key:l(R,B.requestId)}]))))})));return(0,i.p)(M).pipe(y(),(0,s.T)(this.finalizeResponses),(0,u.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(b){return b&&Array.isArray(b.queries)&&b.queries.length>0}finalizeResponses(b){const{length:S}=b;if(S===0)return b;const M=b.find(O=>O.state===E.Gu.Error);return M?b.push(M):b[S-1].state=E.Gu.Done,b}}function y(){return(0,g.T)((P,b)=>b.reduce((S,M)=>(S.push.apply(S,M),S),P),[])}},341:(q,j,e)=>{"use strict";e.d(j,{cd:()=>y,xw:()=>f});var t=e(36669),n=e(63739);const r={filters:[],groupBy:[]};var a=(A=>(A.Instant="instant",A.Range="range",A))(a||{}),i=(A=>(A.Done="done",A.Error="error",A.Pending="pending",A.Streaming="streaming",A))(i||{}),x=(A=>(A.Raw="raw",A.Spans="spans",A.Traces="traces",A))(x||{}),s=(A=>(A.Event="event",A.Instrumentation="instrumentation",A.Intrinsic="intrinsic",A.Link="link",A.Resource="resource",A.Span="span",A.Unscoped="unscoped",A))(s||{});function c(A){if(A.stringValue)return A.stringValue;if(A.boolValue!==void 0)return!!A.boolValue;if(A.intValue!==void 0)return Number.parseInt(String(A.intValue),10);if(A.doubleValue)return Number.parseFloat(String(A.doubleValue));if(A.arrayValue){const N=[];for(const K of A.arrayValue.values)N.push(c(K));return N}return""}function d(A){const N=[];let K="OTLPResourceNoServiceName";if(!A)return{serviceName:K,serviceTags:N};for(const V of A.attributes)V.key===SemanticResourceAttributes.SERVICE_NAME&&(K=V.value.stringValue||K),N.push({key:V.key,value:c(V.value)});return{serviceName:K,serviceTags:N}}function u(A){const N=[];if(A.attributes)for(const K of A.attributes)N.push({key:K.key,value:c(K.value)});return N}function g(A){let N;if(A.kind){const K=A.kind.toString().toLowerCase().split("_");N=K.length?K[K.length-1]:A.kind.toString()}return N}function o(A){const N=[];if(A.links)for(const K of A.links){const{traceId:V,spanId:T}=K,z=[];if(K.attributes)for(const w of K.attributes)z.push({key:w.key,value:c(w.value)});N.push({traceID:V,spanID:T,tags:z})}return N}function E(A){const N=[];if(A.events)for(const K of A.events){const V=[];if(K.attributes)for(const T of K.attributes)V.push({key:T.key,value:c(T.value)});N.push({fields:V,timestamp:K.timeUnixNano/1e6,name:K.name})}return N}function m(A,N=!1){const K=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const T of A){const{serviceName:z,serviceTags:w}=d(T.resource);for(const H of T.instrumentationLibrarySpans)for(const G of H.spans)K.add({traceID:G.traceId.length>16?G.traceId.slice(16):G.traceId,spanID:G.spanId,parentSpanID:G.parentSpanId||"",operationName:G.name||"",serviceName:z,kind:g(G),statusCode:G.status?.code,statusMessage:G.status?.message,instrumentationLibraryName:H.instrumentationLibrary?.name,instrumentationLibraryVersion:H.instrumentationLibrary?.version,traceState:G.traceState,serviceTags:w,startTime:G.startTimeUnixNano/1e6,duration:(G.endTimeUnixNano-G.startTimeUnixNano)/1e6,tags:u(G),logs:E(G),references:o(G)})}}catch(T){return console.error(T),{error:{message:"JSON is not valid OpenTelemetry format: "+T},data:[]}}let V=[K];return N&&V.push(...createNodeGraphFrames(K)),{data:V}}function f(A){let N={batches:[]},K={};for(let V=0;V<A.length;V++){const T=A.get(V);K[T.serviceName]||(K[T.serviceName]=N.batches.length,N.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let z=K[T.serviceName];N.batches[z].resource.attributes.length===0&&(N.batches[z].resource.attributes=h(T.serviceTags)),N.batches[z].instrumentationLibrarySpans[0].instrumentationLibrary||T.instrumentationLibraryName&&(N.batches[z].instrumentationLibrarySpans[0].instrumentationLibrary={name:T.instrumentationLibraryName,version:T.instrumentationLibraryVersion?T.instrumentationLibraryVersion:""}),N.batches[z].instrumentationLibrarySpans[0].spans.push({traceId:T.traceID.padStart(32,"0"),spanId:T.spanID,parentSpanId:T.parentSpanID||"",traceState:T.traceState||"",name:T.operationName,kind:p(T.kind),startTimeUnixNano:T.startTime*1e6,endTimeUnixNano:(T.startTime+T.duration)*1e6,attributes:T.tags?h(T.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:C(T),events:l(T.logs),links:v(T.references)})}return N}function p(A){let N;if(A)switch(A){case"server":N="SPAN_KIND_SERVER";break;case"client":N="SPAN_KIND_CLIENT";break;case"producer":N="SPAN_KIND_PRODUCER";break;case"consumer":N="SPAN_KIND_CONSUMER";break;case"internal":N="SPAN_KIND_INTERNAL";break}return N}function h(A){return A.reduce((N,K)=>[...N,{key:K.key,value:D(K)}],[])}function D(A){if(typeof A.value=="string")return{stringValue:A.value};if(typeof A.value=="boolean")return{boolValue:A.value};if(typeof A.value=="number")return A.value%1===0?{intValue:A.value}:{doubleValue:A.value};if(typeof A.value=="object"&&Array.isArray(A.value)){const N=[];for(const K of A.value)N.push(D(K));return{arrayValue:{values:N}}}return{stringValue:A.value}}function C(A){let N;return A.statusCode!==void 0&&(N={code:A.statusCode,message:A.statusMessage?A.statusMessage:""}),N}function l(A){if(!A||!A.length)return;let N=[];for(const K of A){let V={timeUnixNano:K.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:K.name||""};for(const T of K.fields)V.attributes.push({key:T.key,value:D(T)});N.push(V)}return N}function v(A){if(!A||!A.length)return;let N=[];for(const K of A){let V={traceId:K.traceID,spanId:K.spanID,attributes:[],droppedAttributesCount:0};if(K.tags?.length)for(const T of K.tags)V.attributes?.push({key:T.key,value:D(T)});N.push(V)}return N}const y="Related profiles";function P(A,N,K=!1){const V=A.data[0];if(!V)return W;const z=N?.jsonData?.tracesToProfiles;let w;if(z?.datasourceUid&&(w=getDataSourceSrv().getInstanceSettings(z.datasourceUid)),z&&w){const G=z.customQuery?z.query:void 0,X={title:y,url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:{labelSelector:G||"{${__tags}}",groupBy:[],profileTypeId:z.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};V.fields.forEach(k=>{k.name==="tags"&&(k.config.links=[X])})}let H=[...A.data];return K&&H.push(...createNodeGraphFrames(toDataFrame(V))),{...A,data:H}}function b(A){return{traceID:A.traceID,startTime:parseInt(A.startTimeUnixNano,10)/1e6,traceDuration:A.durationMs,traceService:A.rootServiceName||"",traceName:A.rootTraceName||""}}function S(A,N){return A.data?.filter(K=>K.name==="exemplar"&&K.meta?.dataTopic==="annotations").map(K=>{const V=K.fields.find(T=>T.name==="traceId");if(V){const T=M(N);V.config.links=V.config.links?.length?[...V.config.links,...T]:T}return K}),A}function M(A){const N=[];return A.uid&&N.push({title:"View trace",url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:A.uid,datasourceName:A?.name??"Data source not found"}}),N}function O(A,N,K){switch(K){case SearchTableType.Spans:return B(A,N);case SearchTableType.Raw:return R(A);default:return L(A,N)}}function R(A){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(A,null,2)]}]})]}function L(A,N){const K=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return A?.length?(K.length=A.length,A.sort((V,T)=>parseInt(T?.startTimeUnixNano,10)/1e6-parseInt(V?.startTimeUnixNano,10)/1e6).forEach(V=>{const T=b(V);K.fields[0].values.push(T.traceID),K.fields[1].values.push(T.startTime),K.fields[2].values.push(T.traceService),K.fields[3].values.push(T.traceName),K.fields[4].values.push(T.traceDuration?T.traceDuration:"<1ms"),V.spanSets?K.fields[5].values.push(V.spanSets.map(z=>I(V,z,N))):V.spanSet&&K.fields[5].values.push([I(V,V.spanSet,N)])}),[K]):[K]}function B(A,N){const K={};let V=!1;A?.forEach(z=>F(z).forEach(w=>{w.attributes?.forEach(H=>{K[H.key]={name:H.key,type:FieldType.string,config:{displayNameFromDS:H.key}}}),w.spans.forEach(H=>{H.name&&(V=!0),H.attributes?.forEach(G=>{K[G.key]={name:G.key,type:FieldType.string,config:{displayNameFromDS:G.key}}})})}));const T=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!V}}},...Object.values(K).sort((z,w)=>z.name.localeCompare(w.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!A||!A.length?[T]:(A.sort((z,w)=>parseInt(w?.startTimeUnixNano,10)/1e6-parseInt(z?.startTimeUnixNano,10)/1e6).forEach(z=>{F(z).forEach(w=>{w.spans.forEach(H=>{T.add(U(H,w,z))})})}),[T])}const F=A=>A.spanSets||(A.spanSet?[A.spanSet]:[]),I=(A,N,K)=>{const V={};let T=!1;N.attributes?.map(H=>{V[H.key]={name:H.key,type:FieldType.string,config:{displayNameFromDS:H.key},values:[]}}),N.spans.forEach(H=>{H.name&&(T=!0),H.attributes?.forEach(G=>{V[G.key]={name:G.key,type:FieldType.string,config:{displayNameFromDS:G.key},values:[]}})});const z=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:K.uid,datasourceName:K.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!T}}},...Object.values(V).sort((H,G)=>H.name.localeCompare(G.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),w=createTheme();for(const H of z.fields)H.display=getDisplayProcessor({field:H,theme:w});return N.spans.forEach(H=>{z.add(U(H,N,A))}),z};function U(A,N,K){const V=parseInt(A.startTimeUnixNano,10)/1e6,T={traceIdHidden:K.traceID,traceService:K.rootServiceName||"",traceName:K.rootTraceName||"",spanID:A.spanID,time:V,duration:parseInt(A.durationNanos,10),name:A.name};let z=[];return N.attributes&&(z=z.concat(N.attributes)),A.attributes&&(z=z.concat(A.attributes)),z.forEach(w=>{(w.value.boolValue||w.value.Value?.bool_value)&&(T[w.key]=w.value.boolValue||w.value.Value?.bool_value),(w.value.doubleValue||w.value.Value?.double_value)&&(T[w.key]=w.value.doubleValue||w.value.Value?.double_value),(w.value.intValue||w.value.Value?.int_value)&&(T[w.key]=w.value.intValue||w.value.Value?.int_value),(w.value.stringValue||w.value.Value?.string_value)&&(T[w.key]=w.value.stringValue||w.value.Value?.string_value)}),T}const W={data:[new t.k({fields:[{name:"trace",type:n.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},2255:(q,j,e)=>{"use strict";e.d(j,{nE:()=>r,r6:()=>n,xB:()=>t});var t=(a=>(a[a.AlphaAsc=1]="AlphaAsc",a[a.AlphaDesc=2]="AlphaDesc",a[a.Importance=3]="Importance",a[a.TimeAsc=4]="TimeAsc",a[a.TimeDesc=5]="TimeDesc",a))(t||{}),n=(a=>(a.Default="default",a.Custom="custom",a))(n||{}),r=(a=>(a.List="list",a.Stat="stat",a))(r||{})},52180:(q,j,e)=>{"use strict";e.d(j,{d:()=>l,l:()=>v});var t=e(74848),n=e(2543),r=e(96540),a=e(21288),i=e(49973),x=e(7500),s=e(22662),c=e(63006),d=e(85832),u=e(53633),g=e(88023),o=e(23570),E=e(63739),m=e(18752),f=e(29675),p=e(43987),h=e(7257);const D=(0,r.memo)(({data:y,placement:P,calcs:b,displayMode:S,...M})=>{const O=(0,f.$j)();let R=[];return(0,o.Fm)(y),y.forEach((L,B)=>{L.fields.forEach((F,I)=>{const U=I+1;if(F.type===E.PU.time||F.config.custom?.hideFrom?.legend)return;const W=F.state?.displayName??F.name,A=(0,m.lz)(F,O).color,N={label:W.toString(),color:A,yAxis:F.config.custom?.axisPlacement===x.vM.Right?2:1,disabled:F.state?.hideFrom?.viz,getDisplayValues:()=>(0,h.UO)(b,F,O),getItemKey:()=>`${W}-${B}-${U}`};R.push(N)})}),(0,t.jsx)(d.KU.Legend,{placement:P,...M,children:(0,t.jsx)(p.t,{placement:P,items:R,displayMode:S,sortBy:M.sortBy,sortDesc:M.sortDesc,isSortable:!0})})});D.displayName="BarGaugeLegend";var C=e(25238);class l extends r.PureComponent{constructor(){super(...arguments),this.renderComponent=(P,b)=>{const{options:S,fieldConfig:M}=this.props,{value:O,alignmentFactors:R,orientation:L,width:B,height:F,count:I}=P,{field:U,display:W,view:A,colIndex:N}=O,{openMenu:K,targetClassName:V}=b,T=this.getItemSpacing(),z=(F+T)*I-T>this.props.height;let w;return A&&(0,n.isNumber)(N)&&(w=A.getFieldDisplayProcessor(N)),(0,t.jsx)(s.xE,{value:v(I,M.defaults,W),width:B,height:F,orientation:L,field:U,text:S.text,display:w,theme:g.$W.theme2,itemSpacing:T,displayMode:S.displayMode,onClick:K,className:V,alignmentFactors:I>1?R:void 0,showUnfilled:S.showUnfilled,valueDisplayMode:S.valueMode,namePlacement:S.namePlacement,isOverflow:z})},this.renderValue=P=>{const{value:b,orientation:S}=P,{hasLinks:M,getLinks:O}=b;return M&&O?(0,t.jsx)("div",{style:{width:"100%",display:S===a.wV.Vertical?"flex":"initial"},children:(0,t.jsx)(c.e,{style:{height:"100%"},links:O,children:R=>this.renderComponent(P,R)})}):this.renderComponent(P,{})},this.getValues=()=>{const{data:P,options:b,replaceVariables:S,fieldConfig:M,timeZone:O}=this.props;return(0,i.PI)({fieldConfig:M,reduceOptions:b.reduceOptions,replaceVariables:S,theme:g.$W.theme2,data:P.series,timeZone:O})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:P,width:b,height:S}=this.props,{orientation:M}=P;return M===a.wV.Auto?b>S?a.wV.Vertical:a.wV.Horizontal:M}calcBarSize(){const{options:P}=this.props,b=this.getOrientation(),S=P.sizing===x.T6.Manual,M=b===a.wV.Vertical,O=b===a.wV.Horizontal,R=S&&M?P.minVizWidth:C.K.minVizWidth,L=S&&O?P.minVizHeight:C.K.minVizHeight,B=S&&O?P.maxVizHeight:C.K.maxVizHeight;return{minVizWidth:R,minVizHeight:L,maxVizHeight:B}}getLegend(){const{options:P,data:b}=this.props,{legend:S}=P;return S.showLegend&&b&&b.series.length>0?(0,t.jsx)(D,{data:b.series,...S}):null}render(){const{height:P,width:b,options:S,data:M,renderCounter:O}=this.props,{minVizWidth:R,minVizHeight:L,maxVizHeight:B}=this.calcBarSize();return(0,t.jsx)(d.KU,{width:b,height:P,legend:this.getLegend(),children:(F,I)=>(0,t.jsx)(u.S,{source:M,getAlignmentFactors:i.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:O,width:F,height:I,maxVizHeight:B,minVizWidth:R,minVizHeight:L,itemSpacing:this.getItemSpacing(),orientation:S.orientation})})}}function v(y,P,b){return y===1&&!P.displayName?{...b,title:void 0}:b}},25238:(q,j,e)=>{"use strict";e.d(j,{K:()=>n});var t=e(7500);const n={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},87714:(q,j,e)=>{"use strict";e.r(j),e.d(j,{plugin:()=>y});var t=e(68256),n=e(7500),r=e(46824),a=e(55025),i=e(37256);const x=P=>(0,i._$)(P),s=(P,b,S)=>{const M=(0,i.gl)(P,b,S);if(b==="singlestat"&&S.angular){const O=S.angular.gauge;O&&(M.showThresholdMarkers=O.thresholdMarkers,M.showThresholdLabels=O.thresholdLabels)}return M};var c=e(74848),d=e(96540),u=e(16869),g=e(49973),o=e(39841),E=e(63006),m=e(53633),f=e(88023),p=e(52180);const h={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto};class D extends d.PureComponent{constructor(){super(...arguments),this.renderComponent=(b,S)=>{const{options:M,fieldConfig:O}=this.props,{width:R,height:L,count:B,value:F}=b,{field:I,display:U}=F,{openMenu:W,targetClassName:A}=S;return(0,c.jsx)(o._,{value:(0,p.l)(B,O.defaults,U),width:R,height:L,field:I,text:M.text,showThresholdLabels:M.showThresholdLabels,showThresholdMarkers:M.showThresholdMarkers,theme:f.$W.theme2,onClick:W,className:A,orientation:M.orientation})},this.renderValue=b=>{const{value:S}=b,{getLinks:M,hasLinks:O}=S;return O&&M?(0,c.jsx)(E.e,{links:M,style:{flexGrow:1},children:R=>this.renderComponent(b,R)}):this.renderComponent(b,{})},this.getValues=()=>{const{data:b,options:S,replaceVariables:M,fieldConfig:O,timeZone:R}=this.props;for(let L of b.series)for(let B of L.fields)if(B.config.unit==="percent"||B.config.unit==="percentunit"){const F=B.config.min??0,I=B.config.max??(B.config.unit==="percent"?100:1);B.state=B.state??{},B.state.range={min:F,max:I,delta:I-F},B.display=(0,u.J)({field:B,theme:f.$W.theme2})}return(0,g.PI)({fieldConfig:O,reduceOptions:S.reduceOptions,replaceVariables:M,theme:f.$W.theme2,data:b.series,timeZone:R})},this.calculateGaugeSize=()=>{const{options:b}=this.props,S=b.orientation,M=b.sizing===n.T6.Manual,O=S===n.wV.Vertical,R=S===n.wV.Horizontal,L=M&&O?b.minVizWidth:h.minVizWidth,B=M&&R?b.minVizHeight:h.minVizHeight;return{minVizWidth:L,minVizHeight:B}}}render(){const{height:b,width:S,data:M,renderCounter:O,options:R}=this.props,{minVizHeight:L,minVizWidth:B}=this.calculateGaugeSize();return(0,c.jsx)(m.S,{getValues:this.getValues,renderValue:this.renderValue,width:S,height:b,source:M,autoGrid:!0,renderCounter:O,orientation:R.orientation,minVizHeight:L,minVizWidth:B})}}var C=e(99116),l=e(18550);class v{getSuggestionsForData(b){const{dataSummary:S}=b;if(!S.hasData||!S.hasNumberField||S.numberFieldCount>=50)return;const M=b.getListAppender({name:l.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:C.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:O=>{O.options.reduceOptions.values&&(O.options.reduceOptions.limit=2)}}});S.hasStringField&&S.frameCount===1&&S.rowCountTotal<10?(M.append({name:l.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),M.append({name:l.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(M.append({name:l.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),M.append({name:l.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const y=new t.m(D).useFieldConfig({useCustomConfig:P=>{P.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(P=>{(0,a.L)(P),(0,a.h)(P),P.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:h.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:h.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:n.T6.Auto,label:"Auto"},{value:n.T6.Manual,label:"Manual"}]},defaultValue:h.sizing,showIf:b=>b.orientation!==n.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:h.minVizWidth,settings:{min:0,max:600,step:1},showIf:b=>b.sizing===n.T6.Manual&&b.orientation===n.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:h.minVizHeight,settings:{min:0,max:600,step:1},showIf:b=>b.sizing===n.T6.Manual&&b.orientation===n.wV.Horizontal}),r.I(P)}).setPanelChangeHandler(s).setSuggestionsSupplier(new v).setMigrationHandler(x)},1561:(q,j,e)=>{"use strict";e.d(j,{M:()=>x,x:()=>i});var t=e(74848),n=e(96540),r=e(38075),a=e(97062);const i=({value:s,context:c,onChange:d})=>{const u=(0,n.useCallback)(g=>{d(g?.length?{id:r.jR.byRefId,options:g}:void 0)},[d]);return(0,t.jsx)(a.XL,{value:s?.options,onChange:u,data:c.data,placeholder:"Change filter"})},x=({value:s,context:c,onChange:d})=>{const u=(0,n.useCallback)(g=>{d(g?.length?{id:r.jR.byRefId,options:(0,a.h)(g)}:void 0)},[d]);return(0,t.jsx)(a.gK,{value:s?.options,onChange:u,data:c.data,placeholder:"Change filter"})}},90086:(q,j,e)=>{"use strict";e.d(j,{KQ:()=>i,P7:()=>n,iS:()=>a,uM:()=>r});var t=e(7500),n=(x=>(x.Opacity="opacity",x.Scheme="scheme",x))(n||{}),r=(x=>(x.Exponential="exponential",x.Linear="linear",x))(r||{}),a=(x=>(x.X="x",x.Xy="xy",x.Y="y",x))(a||{});const i={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},36492:(q,j,e)=>{"use strict";e.d(j,{K:()=>u});var t=e(74848),n=e(22803),r=e(70255),a=e(84099),i=e(88090),x=e(29675),s=e(71815);function c({width:o,showImage:E,data:m,index:f}){const p=(0,x.of)(g),h=o>600,D=m.get(f),C=encodeURI(D.title);return(0,t.jsxs)("article",{"aria-labelledby":C,className:(0,n.cx)(p.item,h&&p.itemWide),children:[E&&D.ogImage&&(0,t.jsx)("a",{tabIndex:-1,href:a.sQ.sanitizeUrl(D.link),target:"_blank",rel:"noopener noreferrer",className:(0,n.cx)(p.socialImage,h&&p.socialImageWide),"aria-hidden":!0,children:(0,t.jsx)("img",{src:D.ogImage,alt:D.title})}),(0,t.jsxs)("div",{className:p.body,children:[(0,t.jsxs)("time",{className:p.date,dateTime:(0,i.LE)(D.date,{format:"MMM DD"}),children:[(0,i.LE)(D.date,{format:"MMM DD"})," "]}),(0,t.jsx)("a",{className:p.link,href:a.sQ.sanitizeUrl(D.link),target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)("h3",{className:p.title,id:C,children:D.title})}),(0,t.jsx)("div",{className:p.content,dangerouslySetInnerHTML:{__html:a.sQ.sanitize(D.content)}})]})]})}const d=({width:o,showImage:E,rootProps:m})=>{const f=(0,x.of)(g),p=o>600;return(0,t.jsxs)("div",{className:(0,n.cx)(f.item,p&&f.itemWide),...m,children:[E&&(0,t.jsx)(r.A,{containerClassName:(0,n.cx)(f.socialImage,p&&f.socialImageWide),width:p?"250px":"100%",height:p?"150px":o*.5}),(0,t.jsxs)("div",{className:f.body,children:[(0,t.jsx)(r.A,{containerClassName:f.date,width:60}),(0,t.jsx)(r.A,{containerClassName:f.title,width:250}),(0,t.jsx)(r.A,{containerClassName:f.content,width:"100%",count:6})]})]})},u=(0,s.j)(c,d),g=o=>({container:(0,n.css)({height:"100%"}),item:(0,n.css)({display:"flex",padding:o.spacing(1),position:"relative",marginBottom:o.spacing(.5),marginRight:o.spacing(1),borderBottom:`2px solid ${o.colors.border.weak}`,background:o.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,n.css)({flexDirection:"row"}),body:(0,n.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,n.css)({display:"flex",alignItems:"center",marginBottom:o.spacing(1),"> img":{width:"100%",borderRadius:`${o.shape.radius.default} ${o.shape.radius.default} 0 0`}}),socialImageWide:(0,n.css)({marginRight:o.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:o.shape.radius.default}}),link:(0,n.css)({color:o.colors.text.link,display:"inline-block","&:hover":{color:o.colors.text.link,textDecoration:"underline"}}),title:(0,n.css)({fontSize:"16px",marginBottom:o.spacing(.5)}),content:(0,n.css)({p:{marginBottom:o.spacing(.5),color:o.colors.text.primary}}),date:(0,n.css)({marginBottom:o.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${o.shape.radius.default}`,color:o.colors.text.secondary})})},60938:(q,j,e)=>{"use strict";e.d(j,{$:()=>t});const t="https://grafana.com/blog/news.xml"},87518:(q,j,e)=>{"use strict";e.d(j,{n:()=>o});var t=e(41053),n=e(94626);function r(E){const f=new DOMParser().parseFromString(E,"text/xml");return{items:Array.from(f.querySelectorAll("entry")).map(h=>({title:s(h,"title"),link:h.querySelector("link")?.getAttribute("href")??"",content:s(h,"content"),pubDate:s(h,"published"),ogImage:h.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function a(E){const f=new DOMParser().parseFromString(E,"text/xml");return{items:Array.from(f.querySelectorAll("item")).map(h=>({title:s(h,"title"),link:s(h,"link"),content:s(h,"description"),pubDate:s(h,"pubDate"),ogImage:h.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function i(E){return await(await fetch(E)).text()}function x(E){return new DOMParser().parseFromString(E,"text/xml").querySelector("feed")!==null}function s(E,m){return E.querySelector(m)?.textContent??""}async function c(E){const m=await i(E);return x(m)?r(m):a(m)}var d=e(3202),u=e(63739);function g(E){const m=[],f=[],p=[],h=[],D=[];for(const C of E.items){const l=(0,d.KQ)(C.pubDate);try{if(m.push(l.valueOf()),f.push(C.title),p.push(C.link),D.push(C.ogImage),C.content){const v=C.content.replace(/<\/?[^>]+(>|$)/g,"");h.push(v)}}catch(v){console.warn("Error reading news item:",v,C)}}return{fields:[{name:"date",type:u.PU.time,config:{displayName:"Date"},values:m},{name:"title",type:u.PU.string,config:{},values:f},{name:"link",type:u.PU.string,config:{},values:p},{name:"content",type:u.PU.string,config:{},values:h},{name:"ogImage",type:u.PU.string,config:{},values:D}],length:m.length}}function o(E){const[m,f]=(0,t.A)(async()=>{const p=await c(E),h=g(p);return new n.R(h)},[E],{loading:!0});return{state:m,getNews:f}}},55025:(q,j,e)=>{"use strict";e.d(j,{L:()=>x,h:()=>s});var t=e(79488),n=e(91357),r=e(23570),a=e(67793),i=e(7500);function x(c,d=!0){const u=["Value options"];c.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:u,defaultValue:!1}),c.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:u,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:g=>g.reduceOptions.values===!0}),c.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:u,editor:t.D.get("stats-picker").editor,defaultValue:[n.gy.lastNotNull],showIf:g=>g.reduceOptions.values===!1}),d&&c.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:u,settings:{allowCustomValue:!0,options:[],getOptions:async g=>{const o=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(g&&g.data)for(const E of g.data)for(const m of E.fields){const f=(0,r.Ct)(m,E,g.data),p=`/^${(0,a.jD)(f)}$/`;o.push({value:p,label:f})}return Promise.resolve(o)}},defaultValue:""})}function s(c,d){c.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:d,settings:{options:[{value:i.wV.Auto,label:"Auto"},{value:i.wV.Horizontal,label:"Horizontal"},{value:i.wV.Vertical,label:"Vertical"}]},defaultValue:i.wV.Auto})}},3917:(q,j,e)=>{"use strict";e.r(j),e.d(j,{plugin:()=>y});var t=e(68256),n=e(7500),r=e(46824),a=e(37256),i=e(62931);const x=(P,b,S)=>{const M=(0,a.gl)(P,b,S);if(S.angular&&(b==="singlestat"||b==="grafana-singlestat-panel")){const O=S.angular;if(M.graphMode=n.$p.None,O.sparkline&&O.sparkline.show&&(M.graphMode=n.$p.Area),O.colorBackground)M.colorMode=n.yp.Background;else if(O.colorValue)M.colorMode=n.yp.Value;else if(M.colorMode=n.yp.None,O.sparkline?.lineColor&&M.graphMode===n.$p.Area){const R=P.fieldConfig??{};R.defaults.color={mode:i.Y.Fixed,fixedColor:O.sparkline.lineColor},P.fieldConfig=R}O.valueName==="name"&&(M.textMode=n.SV.Name)}return M};var s=e(74848),c=e(2543),d=e(96540),u=e(63739),g=e(49973),o=e(47286),E=e(5958),m=e(63006),f=e(53633),p=e(88023);class h extends d.PureComponent{constructor(){super(...arguments),this.renderComponent=(b,S)=>{const{timeRange:M,options:O}=this.props,{value:R,alignmentFactors:L,width:B,height:F,count:I}=b,{openMenu:U,targetClassName:W}=S;let A=R.sparkline;return A&&(A.timeRange=M),(0,s.jsx)(E.yV,{value:R.display,count:I,sparkline:A,colorMode:O.colorMode,graphMode:O.graphMode,justifyMode:O.justifyMode,textMode:this.getTextMode(),alignmentFactors:L,text:O.text,width:B,height:F,theme:p.$W.theme2,onClick:U,className:W,disableWideLayout:!O.wideLayout,percentChangeColorMode:O.percentChangeColorMode})},this.renderValue=b=>{const{value:S}=b,{getLinks:M,hasLinks:O}=S;return O&&M?(0,s.jsx)(m.e,{links:M,children:R=>this.renderComponent(b,R)}):this.renderComponent(b,{})},this.getValues=()=>{const{data:b,options:S,replaceVariables:M,fieldConfig:O,timeZone:R}=this.props;let L;for(let B of b.series)for(let F of B.fields){let{config:I}=F;if(F.type===u.PU.number){if(F.state?.range)continue;!L&&(!(0,c.isNumber)(I.min)||!(0,c.isNumber)(I.max))&&(L=(0,o.nJ)(b.series));const U=I.min??L.min,W=I.max??L.max;F.state=F.state??{},F.state.range={min:U,max:W,delta:W-U}}}return(0,g.PI)({fieldConfig:O,reduceOptions:S.reduceOptions,replaceVariables:M,theme:p.$W.theme2,data:b.series,sparkline:S.graphMode!==n.$p.None,percentChange:S.showPercentChange,timeZone:R})}}getTextMode(){const{options:b,fieldConfig:S,title:M}=this.props;return b.textMode===n.SV.Auto&&(S.defaults.displayName||!M)?n.SV.ValueAndName:b.textMode}render(){const{height:b,options:S,width:M,data:O,renderCounter:R}=this.props;return(0,s.jsx)(f.S,{getValues:this.getValues,getAlignmentFactors:g.XS,renderValue:this.renderValue,width:M,height:b,source:O,itemSpacing:3,renderCounter:R,autoGrid:!0,orientation:S.orientation})}}var D=e(55025);const C={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0};var l=e(18550);class v{getSuggestionsForData(b){const{dataSummary:S}=b;if(!S.hasData)return;const M=b.getListAppender({name:l.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:O=>{O.options.reduceOptions.values&&(O.options.reduceOptions.limit=1)}}});S.hasStringField&&S.hasNumberField&&S.frameCount===1&&S.rowCountTotal<10&&(M.append({name:l.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),M.append({name:l.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.Background}})),S.stringFieldCount===1&&S.frameCount===1&&S.rowCountTotal<10&&S.fieldCount===1&&M.append({name:l.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.None}}),S.hasNumberField&&S.hasTimeField&&(M.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),M.append({name:l.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:n.$p.None,colorMode:n.yp.Background}}))}}const y=new t.m(h).useFieldConfig().setPanelOptions(P=>{const b=["Stat styles"];(0,D.L)(P),(0,D.h)(P,b),r.I(P),P.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:b,settings:{options:[{value:n.SV.Auto,label:"Auto"},{value:n.SV.Value,label:"Value"},{value:n.SV.ValueAndName,label:"Value and name"},{value:n.SV.Name,label:"Name"},{value:n.SV.None,label:"None"}]},defaultValue:C.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:b,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:C.wideLayout,showIf:S=>S.textMode===n.SV.ValueAndName}),P.addSelect({path:"colorMode",name:"Color mode",defaultValue:n.yp.Value,category:b,settings:{options:[{value:n.yp.None,label:"None"},{value:n.yp.Value,label:"Value"},{value:n.yp.Background,label:"Background Gradient"},{value:n.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:b,defaultValue:C.graphMode,settings:{options:[{value:n.$p.None,label:"None"},{value:n.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:C.justifyMode,category:b,settings:{options:[{value:n.F8.Auto,label:"Auto"},{value:n.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:C.showPercentChange,category:b,showIf:S=>!S.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:C.percentChangeColorMode,category:b,settings:{options:[{value:n.CD.Standard,label:"Standard"},{value:n.CD.Inverted,label:"Inverted"},{value:n.CD.SameAsValue,label:"Same as Value"}]},showIf:S=>S.showPercentChange})}).setNoPadding().setPanelChangeHandler(x).setSuggestionsSupplier(new v).setMigrationHandler(a._$)},58016:(q,j,e)=>{"use strict";e.d(j,{Z:()=>x});var t=e(74848),n=e(19550),r=e(60641),a=e(4405);const i=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],x=({value:s,onChange:c,item:d})=>{const u=typeof s=="number";return i[1].value=u?s:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(r.z,{value:s,options:i,onChange:c}),u&&(0,t.jsx)(a.g,{value:s,onChange:c,inputPrefix:a.F.GreaterThan,isTime:d.settings?.isTime??!1})]})}},63286:(q,j,e)=>{"use strict";e.d(j,{F:()=>u});var t=e(74848),n=e(96540),r=e(19550),a=e(60641),i=e(44826),x=e(99764);const s=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],c=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(o=>({label:o,value:o})),d=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(o=>({label:o,value:o})),u=({value:o,onChange:E})=>{const m=(0,n.useMemo)(()=>o?.fill==="dash"?c:d,[o]),f=(0,n.useMemo)(()=>{if(!o?.dash?.length)return m[0];const p=o.dash?.join(", "),h=m.find(D=>D.value===p);return h||{label:p,value:p}},[o,m]);return(0,t.jsxs)(r.Gy,{children:[(0,t.jsx)(a.z,{value:o?.fill||"solid",options:s,onChange:p=>{let h;p==="dot"?h=g(d[0].value):p==="dash"&&(h=g(c[0].value)),E({...o,fill:p,dash:h})}}),o?.fill&&o?.fill!=="solid"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.l6,{allowCustomValue:!0,options:m,value:f,width:20,onChange:p=>{E({...o,dash:g(p.value??"")})},formatCreateLabel:p=>`Segments: ${g(p).join(", ")}`}),(0,t.jsxs)("div",{children:["\xA0",(0,t.jsx)("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,t.jsx)(x.K,{name:"question-circle",tooltip:"Help"})})]})]})]})};function g(o){const E=[];for(const m of o.split(/(?:,| )+/)){const f=Number.parseInt(m,10);isNaN(f)||E.push(f)}return E}},4405:(q,j,e)=>{"use strict";e.d(j,{F:()=>a,g:()=>i});var t=e(74848),n=e(59577),r=e(34128),a=(x=>(x.LessThan="lessthan",x.GreaterThan="greaterthan",x))(a||{});const i=({value:x,onChange:s,inputPrefix:c,isTime:d})=>{let u=n.secondsToHms(x/1e3);d||(u="10");const g=f=>{let p=!1;if(f)try{d&&n.isValidTimeSpan(f)?p=n.intervalToMs(f):p=Number(f)}catch(h){console.warn("ERROR",h)}s(p)},o=f=>{f.key==="Enter"&&g(f.currentTarget.value)},E=f=>{g(f.currentTarget.value)},m=c==="greaterthan"?(0,t.jsx)("div",{children:">"}):c==="lessthan"?(0,t.jsx)("div",{children:"<"}):null;return(0,t.jsx)(r.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:u,onKeyDown:o,onBlur:E,prefix:m,spellCheck:!1})}},75029:(q,j,e)=>{"use strict";e.d(j,{e:()=>x});var t=e(74848),n=e(19550),r=e(60641),a=e(4405);const i=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],x=({value:s,onChange:c,item:d})=>{const u=typeof s=="number";return i[2].value=u?s:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(r.z,{value:s,options:i,onChange:c}),u&&(0,t.jsx)(a.g,{value:s,onChange:c,inputPrefix:a.F.LessThan,isTime:d.settings?.isTime??!1})]})}},88376:(q,j,e)=>{"use strict";e.d(j,{D:()=>a});var t=e(74848),n=e(96540),r=e(44826);const a=({item:i,value:x,onChange:s,id:c})=>{const d=(0,n.useCallback)(u=>{s({mode:u.value})},[s]);return(0,t.jsx)(r.l6,{inputId:c,value:x.mode,options:i.settings?.options??[],onChange:d})}},38928:(q,j,e)=>{"use strict";e.d(j,{S:()=>m,V:()=>p});var t=e(62321),n=e(62931),r=e(63739),a=e(49448),i=e(7500),x=e(97988),s=e(10925),c=e(59698),d=e(95118),u=e(58016),g=e(63286),o=e(75029),E=e(88376);const m={drawStyle:i.GR.Line,lineInterpolation:i.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:i.on.None,barAlignment:i.Nj.Center,barWidthFactor:.6,stacking:{mode:i.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},f=["Graph styles"];function p(h,D=!0){return{standardOptions:{[t.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:n.Y.PaletteClassic}},[t.uo.Links]:{settings:{showOneClick:!0}},[t.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:C=>{C.addRadio({path:"drawStyle",name:"Style",category:f,defaultValue:h.drawStyle,settings:{options:x.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:f,defaultValue:h.lineInterpolation,settings:{options:x.t.lineInterpolation},showIf:l=>l.drawStyle===i.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:f,defaultValue:h.barAlignment,settings:{options:x.t.barAlignment},showIf:l=>l.drawStyle===i.GR.Bars}).addSliderInput({path:"barWidthFactor",name:"Bar width factor",category:f,defaultValue:h.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:"Bar width factor"},showIf:l=>l.drawStyle===i.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:f,defaultValue:h.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:l=>l.drawStyle!==i.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:f,defaultValue:h.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:l=>l.drawStyle!==i.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:f,defaultValue:x.t.fillGradient[0].value,settings:{options:x.t.fillGradient},showIf:l=>l.drawStyle!==i.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:f,hideFromDefaults:!0,settings:{filter:l=>l.type===r.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:f,showIf:l=>l.drawStyle===i.GR.Line,editor:g.F,override:g.F,process:a.hS,shouldApply:l=>l.type===r.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:f,defaultValue:!1,editor:o.e,override:o.e,showIf:l=>l.drawStyle===i.GR.Line,shouldApply:l=>l.type!==r.PU.time,process:a.hS,settings:{isTime:D}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:f,defaultValue:!1,editor:u.Z,override:u.Z,showIf:l=>l.drawStyle===i.GR.Line,shouldApply:l=>l.type!==r.PU.time,process:a.hS,settings:{isTime:D}}).addRadio({path:"showPoints",name:"Show points",category:f,defaultValue:x.t.showPoints[0].value,settings:{options:x.t.showPoints},showIf:l=>l.drawStyle!==i.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:f,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:l=>l.showPoints!==i.yL.Never||l.drawStyle===i.GR.Points}),s.I(C,h.stacking,f),C.addSelect({category:f,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:i.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:i.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),c.rg(C,h),d.e(C),C.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:i.Ly.Off},settings:{options:x.t.thresholdsDisplayModes},editor:E.D,override:E.D,process:a.hS,shouldApply:()=>!0})}}}},83394:(q,j,e)=>{"use strict";e.d(j,{Gu:()=>a,JD:()=>i,M_:()=>n,k3:()=>r});var t=e(5636);let n;function r(x){n=x}function a(){return!n||!n.getState?{templating:{...t.L1,lastKey:"key"}}:n.getState()}function i(x){if(!(!n||!n.getState))return n.dispatch(x)}},18550:(q,j,e)=>{"use strict";e.d(j,{m:()=>t});var t=(n=>(n.LineChart="Line chart",n.LineChartSmooth="Line chart smooth",n.LineChartGradientColorScheme="Line chart with gradient color scheme",n.AreaChart="Area chart",n.AreaChartStacked="Area chart stacked",n.AreaChartStackedPercent="Area chart 100% stacked",n.BarChart="Bar chart",n.BarChartGradientColorScheme="Bar chart with gradient color scheme",n.BarChartStacked="Bar chart stacked",n.BarChartStackedPercent="Bar chart 100% stacked",n.BarChartHorizontal="Bar chart horizontal",n.BarChartHorizontalStacked="Bar chart horizontal stacked",n.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",n.Candlestick="Candlestick",n.PieChart="Pie chart",n.PieChartDonut="Pie chart donut",n.Stat="Stat",n.StatColoredBackground="Stat colored background",n.Gauge="Gauge",n.GaugeNoThresholds="Gauge no thresholds",n.BarGaugeBasic="Bar gauge basic",n.BarGaugeLCD="Bar gauge LCD",n.Table="Table",n.StateTimeline="State timeline",n.StatusHistory="Status history",n.TextPanel="Text",n.DashboardList="Dashboard list",n.Logs="Logs",n.FlameGraph="Flame graph",n.Trace="Trace",n.NodeGraph="Node graph",n))(t||{})},51876:(q,j,e)=>{"use strict";e.d(j,{$k:()=>x,Gi:()=>n,JS:()=>c,N1:()=>d,Q8:()=>u,Si:()=>r,cF:()=>t,lh:()=>s,qr:()=>i,s1:()=>a});var t=(g=>(g.Firing="firing",g.Inactive="inactive",g.Pending="pending",g))(t||{}),n=(g=>(g.Normal="Normal",g.Alerting="Alerting",g.Pending="Pending",g.NoData="NoData",g.Error="Error",g))(n||{});function r(g){return Object.values(t).includes(g)}function a(g){return Object.values(n).some(o=>o===g)}function i(g){const o=Object.values(t);return g!=null&&!o.includes(g)}function x(g){const o=g.match(/\((.*?)\)/);return o?o[1]:""}function s(g){return i(g)?g.split(" ")[0]:g}var c=(g=>(g.Alerting="alerting",g.Recording="recording",g))(c||{}),d=(g=>(g.Cortex="Cortex",g.Mimir="Mimir",g.Prometheus="Prometheus",g.Thanos="Thanos",g))(d||{}),u=(g=>(g.Alerting="Alerting",g.NoData="NoData",g.KeepLast="KeepLast",g.OK="OK",g.Error="Error",g))(u||{})},35004:(q,j,e)=>{"use strict";e.d(j,{$7:()=>a,SA:()=>n,l$:()=>i});var t=e(51876);function n(x,s){return(0,t.lh)(x.state)===s}var r=(x=>(x.Firing="firing",x))(r||{}),a=(x=>(x.Alerting="alerting",x.Pending="pending",x.Normal="inactive",x.NoData="nodata",x.Error="error",x))(a||{});const i=Symbol("grafana")},82013:()=>{(function(q){var j={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(t){var n={x:-1,y:-1,locked:!1};t.setCrosshair=function(x){if(!x)n.x=-1;else{var s=t.p2c(x);n.x=Math.max(0,Math.min(s.left,t.width())),n.y=Math.max(0,Math.min(s.top,t.height()))}t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(x){x&&t.setCrosshair(x),n.locked=!0},t.unlockCrosshair=function(){n.locked=!1};function r(i){n.locked||n.x!=-1&&(n.x=-1,t.triggerRedrawOverlay())}function a(i){if(!n.locked){if(t.getSelection&&t.getSelection()){n.x=-1;return}var x=t.offset();n.x=Math.max(0,Math.min(i.pageX-x.left,t.width())),n.y=Math.max(0,Math.min(i.pageY-x.top,t.height())),t.triggerRedrawOverlay()}}t.hooks.bindEvents.push(function(i,x){i.getOptions().crosshair.mode&&(x.mouseout(r),x.mousemove(a))}),t.hooks.drawOverlay.push(function(i,x){var s=i.getOptions().crosshair;if(s.mode){var c=i.getPlotOffset();if(x.save(),x.translate(c.left,c.top),n.x!=-1){var d=i.getOptions().crosshair.lineWidth%2?.5:0;if(x.strokeStyle=s.color,x.lineWidth=s.lineWidth,x.lineJoin="round",x.beginPath(),s.mode.indexOf("x")!=-1){var u=Math.floor(n.x)+d;x.moveTo(u,0),x.lineTo(u,i.height())}if(s.mode.indexOf("y")!=-1){var g=Math.floor(n.y)+d;x.moveTo(0,g),x.lineTo(i.width(),g)}x.stroke()}x.restore()}}),t.hooks.shutdown.push(function(i,x){x.unbind("mouseout",r),x.unbind("mousemove",a)})}q.plot.plugins.push({init:e,options:j,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(q){function j(e){e.hooks.processDatapoints.push(function(t,n,r){n.dashes.show&&t.hooks.draw.push(function(a,i){var x=a.getPlotOffset(),s=n.xaxis,c=n.yaxis;function d(E,m){var f=r.points,p=r.pointsize,h=null,D=null,C=0,l=!0,v,y;n.dashes.dashLength[0]?(v=n.dashes.dashLength[0],n.dashes.dashLength[1]?y=n.dashes.dashLength[1]:y=v):y=v=n.dashes.dashLength,i.beginPath();for(var P=p;P<f.length;P+=p){let W=function(A){var N=Math.sqrt(Math.pow(B-R,2)+Math.pow(F-L,2));if(N<=A)return{deltaX:B-R,deltaY:F-L,distance:N,remainder:A-N};var K=B>R?1:-1,V=F>L?1:-1;return{deltaX:K*Math.sqrt(Math.pow(A,2)/(1+Math.pow((F-L)/(B-R),2))),deltaY:V*Math.sqrt(Math.pow(A,2)-Math.pow(A,2)/(1+Math.pow((F-L)/(B-R),2))),distance:A,remainder:0}};var U=W,b=f[P-p],S=f[P-p+1],M=f[P],O=f[P+1];if(!(b==null||M==null)){if(S<=O&&S<c.min){if(O<c.min)continue;b=(c.min-S)/(O-S)*(M-b)+b,S=c.min}else if(O<=S&&O<c.min){if(S<c.min)continue;M=(c.min-S)/(O-S)*(M-b)+b,O=c.min}if(S>=O&&S>c.max){if(O>c.max)continue;b=(c.max-S)/(O-S)*(M-b)+b,S=c.max}else if(O>=S&&O>c.max){if(S>c.max)continue;M=(c.max-S)/(O-S)*(M-b)+b,O=c.max}if(b<=M&&b<s.min){if(M<s.min)continue;S=(s.min-b)/(M-b)*(O-S)+S,b=s.min}else if(M<=b&&M<s.min){if(b<s.min)continue;O=(s.min-b)/(M-b)*(O-S)+S,M=s.min}if(b>=M&&b>s.max){if(M>s.max)continue;S=(s.max-b)/(M-b)*(O-S)+S,b=s.max}else if(M>=b&&M>s.max){if(b>s.max)continue;O=(s.max-b)/(M-b)*(O-S)+S,M=s.max}(b!=h||S!=D)&&i.moveTo(s.p2c(b)+E,c.p2c(S)+m);var R=s.p2c(b)+E,L=c.p2c(S)+m,B=s.p2c(M)+E,F=c.p2c(O)+m,I;do I=W(C>0?C:l?v:y),(I.deltaX!=0||I.deltaY!=0)&&(l?i.lineTo(R+I.deltaX,L+I.deltaY):i.moveTo(R+I.deltaX,L+I.deltaY)),l=!l,C=I.remainder,R+=I.deltaX,L+=I.deltaY;while(I.distance>0);h=M,D=O}}i.stroke()}i.save(),i.translate(x.left,x.top),i.lineJoin="round";var u=n.dashes.lineWidth,g=n.shadowSize;if(u>0&&g>0){i.lineWidth=g,i.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;d(Math.sin(o)*(u/2+g/2),Math.cos(o)*(u/2+g/2)),i.lineWidth=g/2,d(Math.sin(o)*(u/2+g/4),Math.cos(o)*(u/2+g/4))}i.lineWidth=u,i.strokeStyle=n.color,u>0&&d(0,0),i.restore()})})}q.plot.plugins.push({init:j,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(q){"use strict";var j={series:{fillBelowTo:null}};function e(t){function n(i,x){var s;for(s=0;s<x.length;++s)if(x[s].id===i.fillBelowTo)return x[s];return null}function r(i,x,s,c,d,u,g,o){var E,m,f,p,h,D;return E=s-i,m=c-x,f=g-d,p=o-u,h=(-m*(i-d)+E*(x-u))/(-f*m+E*p),D=(f*(x-u)-p*(i-d))/(-f*m+E*p),h>=0&&h<=1&&D>=0&&D<=1?[i+D*E,x+D*m]:null}function a(i,x,s){if(s.fillBelowTo===null)return;var c,d,u,g,o,E,m;function f(y,P){x.beginPath(),x.moveTo(s.xaxis.p2c(y)+E.left,s.yaxis.p2c(P)+E.top)}function p(){x.closePath(),x.fill()}function h(){if(u.length/d!==o.length/g)return console.error("Refusing to graph inconsistent number of points"),!1;var y;for(y=0;y<u.length/d;y++)if(u[y*d]!==null&&o[y*g]!==null&&u[y*d]!==o[y*g])return console.error("Refusing to graph points without matching value"),!1;return!0}function D(y,P){console.assert(P>y,"expects the end index to be greater than the start index");var b=y===0||u[y-1]===null||o[y-1]===null,S=!1,M,O;for(M=y;M<P;M++)if(u[M*d+1]===null||o[M*d+1]===null)S=!1,b=!0;else if(u[M*d+1]===o[M*g+1])S=!0,b=!1;else if(u[M*d+1]>o[M*g+1]){b?f(u[M*d],u[M*d+1]):S?f(u[(M-1)*d],u[(M-1)*d+1]):(O=C(M),f(O[0],O[1])),v(M,P);return}else b=!1,S=!1}function C(y){console.assert(y>0,"expects the second point in the series line segment");var P,b;for(P=1;P<o.length/g;P++)if(b=r(u[(y-1)*d],u[(y-1)*d+1],u[y*d],u[y*d+1],o[(P-1)*g],o[(P-1)*g+1],o[P*g],o[P*g+1]),b!==null)return b;console.error("intersectionPoint() should only be called when an intersection happens")}function l(y,P){console.assert(y>=P,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var b;for(b=y;b>=P;b--)x.lineTo(c.xaxis.p2c(o[b*g])+E.left,c.yaxis.p2c(o[b*g+1])+E.top);p()}function v(y,P){console.assert(y<=P,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var b,S;for(b=y;b<P;b++)if(u[b*d+1]===null&&b>y){l(b-1,y),D(b,P);return}else if(u[b*d+1]===o[b*g+1]){l(b,y),D(b,P);return}else if(u[b*d+1]<o[b*g+1]){S=C(b),x.lineTo(s.xaxis.p2c(S[0])+E.left,s.yaxis.p2c(S[1])+E.top),l(b,y),D(b,P);return}else x.lineTo(s.xaxis.p2c(u[b*d])+E.left,s.yaxis.p2c(u[b*d+1])+E.top);l(P,y)}c=n(s,i.getData()),c&&(d=s.datapoints.pointsize,u=s.datapoints.points,g=c.datapoints.pointsize,o=c.datapoints.points,E=i.getPlotOffset(),h()&&(m=q.color.parse(s.color),m.a=.4,m.normalize(),x.fillStyle=m.toString(),D(0,u.length/d)))}t.hooks.drawSeries.push(a)}q.plot.plugins.push({init:e,options:j,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(q){var j=function(){var s,c,d,u,g,o,E=function(y,P){s=P,c=y.getPlaceholder(),d=y.getOptions(),u=d.series.gauges,g=y.getData(),o=e(u.debug)};E.prototype.calculateLayout=function(){var y=c.width(),P=c.height(),b=Math.min(g.length,u.layout.columns),S=Math.ceil(g.length/b),M=u.layout.margin,O=u.layout.hMargin,R=u.layout.vMargin,L=(y-M*2-O*(b-1))/b,B=(P-M*2-R*(S-1))/S;if(u.layout.square){var F=Math.min(L,B);L=F,B=F}m(u,L);var I=u.cell.margin,U=0,W=0;u.label.show&&(U=u.label.margin,W=u.label.font.size);var A=0,N=0;u.value.show&&(A=u.value.margin,N=u.value.font.size);var K=0;u.threshold.show&&(K=u.threshold.width);var V=0,T=0;u.threshold.label.show&&(V=u.threshold.label.margin,T=u.threshold.label.font.size);for(var z=L/2-I-K-V*2-T,w=u.gauge.startAngle,H=u.gauge.endAngle,G=(H-w)/100,X=-1,k=w;k<H;k+=G)X=Math.max(X,Math.sin(r(k)));X=Math.max(X,Math.sin(r(H)));var _=(B-I*2-U*2-W)/(1+X);_*X<A+N/2&&(_=B-I*2-U*2-W-A-N/2);var ee=_-V*2-T-K,J=Math.min(z,ee),Z=u.gauge.width;Z>=J&&(Z=Math.max(3,J/3));var te=V*2+T+K+J,ae=Math.max(te*(1+X),te+A+N/2);return{canvasWidth:y,canvasHeight:P,margin:M,hMargin:O,vMargin:R,columns:b,rows:S,cellWidth:L,cellHeight:B,cellMargin:I,labelMargin:U,labelFontSize:W,valueMargin:A,valueFontSize:N,width:Z,radius:J,thresholdWidth:K,thresholdLabelMargin:V,thresholdLabelFontSize:T,gaugeOuterHeight:ae}};function m(y,P){y.gauge.width==="auto"&&(y.gauge.width=Math.max(5,P/8)),y.label.margin==="auto"&&(y.label.margin=Math.max(1,P/20)),y.label.font.size==="auto"&&(y.label.font.size=Math.max(5,P/8)),y.value.margin==="auto"&&(y.value.margin=Math.max(1,P/30)),y.value.font.size==="auto"&&(y.value.font.size=Math.max(5,P/9)),y.threshold.width==="auto"&&(y.threshold.width=Math.max(3,P/100)),y.threshold.label.margin==="auto"&&(y.threshold.label.margin=Math.max(3,P/40)),y.threshold.label.font.size==="auto"&&(y.threshold.label.font.size=Math.max(5,P/15))}E.prototype.calculateAutoValues=m,E.prototype.calculateCellLayout=function(y,P,b){var S=t(P.columns,b),M=n(P.columns,b),O=P.margin+(P.cellWidth+P.hMargin)*S,R=P.margin+(P.cellHeight+P.vMargin)*M,L=O+P.cellWidth/2,B=R+P.cellMargin+P.labelMargin*2+P.labelFontSize+P.thresholdWidth+P.thresholdLabelFontSize+P.thresholdLabelMargin*2+P.radius,F=P.cellHeight-P.cellMargin*2-P.labelMargin*2-P.labelFontSize-P.gaugeOuterHeight,I=0;return y.cell.vAlign==="middle"?I=F/2:y.cell.vAlign==="bottom"&&(I=F),B+=I,{col:S,row:M,x:O,y:R,offsetY:I,cellWidth:P.cellWidth,cellHeight:P.cellHeight,cellMargin:P.cellMargin,cx:L,cy:B}},E.prototype.drawBackground=function(y){u.frame.show&&(s.save(),s.strokeStyle=d.grid.borderColor,s.lineWidth=d.grid.borderWidth,s.strokeRect(0,0,y.canvasWidth,y.canvasHeight),d.grid.backgroundColor&&(s.fillStyle=d.grid.backgroundColor,s.fillRect(0,0,y.canvasWidth,y.canvasHeight)),s.restore())},E.prototype.drawCellBackground=function(y,P){s.save(),y.cell.border&&y.cell.border.show&&y.cell.border.color&&y.cell.border.width&&(s.strokeStyle=y.cell.border.color,s.lineWidth=y.cell.border.width,s.strokeRect(P.x,P.y,P.cellWidth,P.cellHeight)),y.cell.background&&y.cell.background.color&&(s.fillStyle=y.cell.background.color,s.fillRect(P.x,P.y,P.cellWidth,P.cellHeight)),s.restore()},E.prototype.drawGauge=function(y,P,b,S,M){var O=y.gauge.shadow.show?y.gauge.shadow.blur:0,R=h(y,M),L=f(y,P,M);C(b.cx,b.cy,P.radius,P.width,r(y.gauge.startAngle),r(y.gauge.endAngle),y.gauge.border.color,y.gauge.border.width,y.gauge.background.color,O),C(b.cx,b.cy,P.radius-1,P.width-2,r(L.a1),r(L.a2),R,1,R,O),y.gauge.neutralValue!=null&&p(y,P,b,R)};function f(y,P,b){let S={};var M=y.gauge.neutralValue;return M!=null?b<M?(S.a1=D(y,P,b),S.a2=D(y,P,M)):(S.a1=D(y,P,M),S.a2=D(y,P,b)):(S.a1=y.gauge.startAngle,S.a2=D(y,P,b)),S}function p(y,P,b,S){var M=(y.gauge.max-y.gauge.min)/600;a(s,b.cx,b.cy,P.radius-2,P.width-4,r(D(y,P,y.gauge.neutralValue-M)),r(D(y,P,y.gauge.neutralValue+M)),S,2,y.gauge.background.color)}function h(y,P){for(var b,S=0;S<y.threshold.values.length;S++){var M=y.threshold.values[S];if(b=M.color,P<M.value)break}return b}function D(y,P,b){var S=y.gauge.startAngle+(y.gauge.endAngle-y.gauge.startAngle)*((b-y.gauge.min)/(y.gauge.max-y.gauge.min));return S<y.gauge.startAngle?S=y.gauge.startAngle:S>y.gauge.endAngle&&(S=y.gauge.endAngle),S}E.prototype.drawThreshold=function(y,P,b){for(var S=y.gauge.startAngle,M=0;M<y.threshold.values.length;M++){var O=y.threshold.values[M];c1=O.color,a2=D(y,P,O.value),a(s,b.cx,b.cy,P.radius+P.thresholdWidth,P.thresholdWidth-2,r(S),r(a2),c1,1,c1),S=a2}};function C(y,P,b,S,M,O,R,L,B,F){M!==O&&(s.save(),a(s,y,P,b,S,M,O,R,L,B),F&&(a(s,y,P,b,S,M,O),s.clip(),s.shadowOffsetX=0,s.shadowOffsetY=0,s.shadowBlur=10,s.shadowColor="gray",a(s,y,P,b+1,S+2,M,O,R,1)),s.restore())}E.prototype.drawLable=function(y,P,b,S,M){v(b.cx,b.y+b.cellMargin+P.labelMargin+b.offsetY,"flotGaugeLabel"+S,y.label.formatter?y.label.formatter(M.label,M.data[0][1]):text,y.label)},E.prototype.drawValue=function(y,P,b,S,M){v(b.cx,b.cy-y.value.font.size/2,"flotGaugeValue"+S,y.value.formatter?y.value.formatter(M.label,M.data[0][1]):text,y.value)},E.prototype.drawThresholdValues=function(y,P,b,S){l(y,P,b,"Min"+S,y.gauge.min,y.gauge.startAngle),l(y,P,b,"Max"+S,y.gauge.max,y.gauge.endAngle);for(var M=0;M<y.threshold.values.length;M++){var O=y.threshold.values[M];if(O.value>y.gauge.min&&O.value<y.gauge.max){var R=D(y,P,O.value);l(y,P,b,S+"_"+M,O.value,R)}}var L=y.gauge.neutralValue;L!=null&&L>y.gauge.min&&L<y.gauge.max&&l(y,P,b,"Neutral"+S,L,D(y,P,L))};function l(y,P,b,S,M,O){v(b.cx+(P.thresholdLabelMargin+P.thresholdLabelFontSize/2+P.radius)*Math.cos(r(O)),b.cy+(P.thresholdLabelMargin+P.thresholdLabelFontSize/2+P.radius)*Math.sin(r(O)),"flotGaugeThresholdValue"+S,y.threshold.label.formatter?y.threshold.label.formatter(M):M,y.threshold.label,O)}function v(y,P,b,S,M,O){var R=q(c).find("#"+b),L=R.length;L||(R=q("<span></span>"),R.attr("id",b),R.attr("class","flot-temp-elem"),c.append(R)),R.css("position","absolute"),R.css("top",P+"px"),R.css("white-space","nowrap"),M.font.size&&R.css("font-size",M.font.size+"px"),M.font.family&&R.css("font-family",M.font.family),M.color&&R.css("color",M.color),M.background.color&&R.css("background-color",M.background.color),M.background.opacity&&R.css("opacity",M.background.opacity),R.text(S),R.css("left",y+"px"),R.css("left",parseInt(R.css("left"))-R.width()/2+"px"),!L&&O&&(R.css("top",parseInt(R.css("top"))-R.height()/2+"px"),R.css("transform","rotate("+(180*O+90)+"deg)"))}return E}();function e(s){return typeof Logger<"u"?new Logger(s):null}function t(s,c){return c%s}function n(s,c){return Math.floor(c/s)}function r(s){return s*Math.PI}function a(s,c,d,u,g,o,E,m,f,p){if(o!==E){var h=!1;s.save(),s.beginPath(),s.arc(c,d,u,o,E,h),s.lineTo(c+(u-g)*Math.cos(E),d+(u-g)*Math.sin(E)),s.arc(c,d,u-g,E,o,!h),s.closePath(),f&&(s.lineWidth=f),m&&(s.strokeStyle=m,s.stroke()),p&&(s.fillStyle=p,s.fill()),s.restore()}}function i(s){s.hooks.processOptions.push(function(c,d){var u=e(d.series.gauges.debug);d.series.gauges.show&&(d.grid.show=!1,d.legend.show=!1);var g=d.series.gauges.threshold.values;g.sort(function(o,E){return o.value<E.value?-1:o.value>E.value?1:0})}),s.hooks.draw.push(function(c,d){var u=c.getOptions(),g=u.series.gauges,o=e(g.debug);if(g.show){var E=c.getData();if(!(!E||!E.length)){var m=new j(c,d),f=m.calculateLayout();g.debug.layout,m.drawBackground(f);for(var p=0;p<E.length;p++){var h=E[p],D=q.extend({},g,h.gauges);h.gauges&&m.calculateAutoValues(D,f.cellWidth);var C=m.calculateCellLayout(D,f,p);m.drawCellBackground(D,C),D.debug.layout,D.label.show&&m.drawLable(D,f,C,p,h),m.drawGauge(D,f,C,h.label,h.data[0][1]),D.threshold.show&&m.drawThreshold(D,f,C),D.threshold.label.show&&m.drawThresholdValues(D,f,C,p),D.value.show&&m.drawValue(D,f,C,p,h)}}}})}var x={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(s,c){return s}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(s,c){return parseInt(c)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(s){return s}},values:[]}}}};q.plot.plugins.push({init:i,options:x,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(q){q.color={},q.color.make=function(e,t,n,r){var a={};return a.r=e||0,a.g=t||0,a.b=n||0,a.a=r??1,a.add=function(i,x){for(var s=0;s<i.length;++s)a[i.charAt(s)]+=x;return a.normalize()},a.scale=function(i,x){for(var s=0;s<i.length;++s)a[i.charAt(s)]*=x;return a.normalize()},a.toString=function(){return a.a>=1?"rgb("+[a.r,a.g,a.b].join(",")+")":"rgba("+[a.r,a.g,a.b,a.a].join(",")+")"},a.normalize=function(){function i(x,s,c){return s<x?x:s>c?c:s}return a.r=i(0,parseInt(a.r),255),a.g=i(0,parseInt(a.g),255),a.b=i(0,parseInt(a.b),255),a.a=i(0,a.a,1),a},a.clone=function(){return q.color.make(a.r,a.b,a.g,a.a)},a.normalize()},q.color.extract=function(e,t){var n;do{if(n=e.css(t).toLowerCase(),n!=""&&n!="transparent")break;e=e.parent()}while(e.length&&!q.nodeName(e.get(0),"body"));return n=="rgba(0, 0, 0, 0)"&&(n="transparent"),q.color.parse(n)},q.color.parse=function(e){var t,n=q.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var r=q.trim(e).toLowerCase();return r=="transparent"?n(255,255,255,0):(t=j[r]||[0,0,0],n(t[0],t[1],t[2]))};var j={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(q){var j=Object.prototype.hasOwnProperty;q.fn.detach||(q.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(r,a){var i=a.children("."+r)[0];if(i==null&&(i=document.createElement("canvas"),i.className=r,q(i).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(a),!i.getContext))if(window.G_vmlCanvasManager)i=window.G_vmlCanvasManager.initElement(i);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=i;var x=this.context=i.getContext("2d"),s=window.devicePixelRatio||1,c=x.webkitBackingStorePixelRatio||x.mozBackingStorePixelRatio||x.msBackingStorePixelRatio||x.oBackingStorePixelRatio||x.backingStorePixelRatio||1;this.pixelRatio=s/c,this.resize(a.width(),a.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(r,a){if(r<=0||a<=0)throw new Error("Invalid dimensions for plot, width = "+r+", height = "+a);var i=this.element,x=this.context,s=this.pixelRatio;this.width!=r&&(i.width=r*s,i.style.width=r+"px",this.width=r),this.height!=a&&(i.height=a*s,i.style.height=a+"px",this.height=a),x.restore(),x.save(),x.scale(s,s)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var r=this._textCache;for(var a in r)if(j.call(r,a)){var i=this.getTextLayer(a),x=r[a];i.hide();for(var s in x)if(j.call(x,s)){var c=x[s];for(var d in c)if(j.call(c,d)){for(var u=c[d].positions,g=0,o;o=u[g];g++)o.active?o.rendered||(i.append(o.element),o.rendered=!0):(u.splice(g--,1),o.rendered&&o.element.detach());u.length==0&&delete c[d]}}i.show()}},e.prototype.getTextLayer=function(r){var a=this.text[r];return a==null&&(this.textContainer==null&&(this.textContainer=q("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),a=this.text[r]=q("<div></div>").addClass(r).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),a},e.prototype.getTextInfo=function(r,a,i,x,s){var c,d,u,g;if(a=""+a,typeof i=="object"?c=i.style+" "+i.variant+" "+i.weight+" "+i.size+"px/"+i.lineHeight+"px "+i.family:c=i,d=this._textCache[r],d==null&&(d=this._textCache[r]={}),u=d[c],u==null&&(u=d[c]={}),g=u[a],g==null){var o=q("<div></div>").html(a).css({position:"absolute","max-width":s,top:-9999}).appendTo(this.getTextLayer(r));typeof i=="object"?o.css({font:c,color:i.color}):typeof i=="string"&&o.addClass(i),g=u[a]={element:o,positions:[]};var E=this._textSizeCache[a];E?(g.width=E.width,g.height=E.height):(g.width=o.outerWidth(!0),g.height=o.outerHeight(!0),this._textSizeCache[a]={width:g.width,height:g.height}),o.detach()}return g},e.prototype.addText=function(r,a,i,x,s,c,d,u,g){var o=this.getTextInfo(r,x,s,c,d),E=o.positions;u=="center"?a-=o.width/2:u=="right"&&(a-=o.width),g=="middle"?i-=o.height/2:g=="bottom"&&(i-=o.height);for(var m=0,f;f=E[m];m++)if(f.x==a&&f.y==i){f.active=!0;return}f={active:!0,rendered:!1,element:E.length?o.element.clone():o.element,x:a,y:i},E.push(f),f.element.css({top:Math.round(i),left:Math.round(a),"text-align":u})},e.prototype.removeText=function(r,a,i,x,s,c){if(x==null){var d=this._textCache[r];if(d!=null){for(var u in d)if(j.call(d,u)){var g=d[u];for(var o in g)if(j.call(g,o))for(var E=g[o].positions,m=0,f;f=E[m];m++)f.active=!1}}}else for(var E=this.getTextInfo(r,x,s,c).positions,m=0,f;f=E[m];m++)f.x==a&&f.y==i&&(f.active=!1)};function t(r,a,i,x){var s=[],c={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},d=null,u=null,g=null,o=null,E=null,m=[],f=[],p={left:0,right:0,top:0,bottom:0},h=0,D=0,C={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},l=this;l.setData=b,l.setupGrid=w,l.draw=ee,l.getPlaceholder=function(){return r},l.getCanvas=function(){return d.element},l.getPlotOffset=function(){return p},l.width=function(){return h},l.height=function(){return D},l.offset=function(){var ie=g.offset();return ie.left+=p.left,ie.top+=p.top,ie},l.getData=function(){return s},l.getAxes=function(){var ie={},ve;return q.each(m.concat(f),function(fe,ge){ge&&(ie[ge.direction+(ge.n!=1?ge.n:"")+"axis"]=ge)}),ie},l.getXAxes=function(){return m},l.getYAxes=function(){return f},l.c2p=R,l.p2c=L,l.getOptions=function(){return c},l.highlight=Ge,l.unhighlight=Me,l.triggerRedrawOverlay=Te,l.pointOffset=function(ie){return{left:parseInt(m[M(ie,"x")-1].p2c(+ie.x)+p.left,10),top:parseInt(f[M(ie,"y")-1].p2c(+ie.y)+p.top,10)}},l.shutdown=A,l.destroy=function(){A(),r.removeData("plot").empty(),s=[],c=null,d=null,u=null,g=null,o=null,E=null,m=[],f=[],C=null,Pe=[],l=null},l.resize=function(){var ie=r.width(),ve=r.height();d.resize(ie,ve),u.resize(ie,ve)},l.hooks=C,y(l),P(i),U(),b(a),w(),ee(),W();function v(ie,ve){ve=[l].concat(ve);for(var fe=0;fe<ie.length;++fe)ie[fe].apply(this,ve)}function y(){for(var ie={Canvas:e},ve=0;ve<x.length;++ve){var fe=x[ve];fe.init(l,ie),fe.options&&q.extend(!0,c,fe.options)}}function P(ie){q.extend(!0,c,ie),ie&&ie.colors&&(c.colors=ie.colors),c.xaxis.color==null&&(c.xaxis.color=q.color.parse(c.grid.color).scale("a",.22).toString()),c.yaxis.color==null&&(c.yaxis.color=q.color.parse(c.grid.color).scale("a",.22).toString()),c.xaxis.tickColor==null&&(c.xaxis.tickColor=c.grid.tickColor||c.xaxis.color),c.yaxis.tickColor==null&&(c.yaxis.tickColor=c.grid.tickColor||c.yaxis.color),c.grid.borderColor==null&&(c.grid.borderColor=c.grid.color),c.grid.tickColor==null&&(c.grid.tickColor=q.color.parse(c.grid.color).scale("a",.22).toString());var ve,fe,ge,xe=r.css("font-size"),je=xe?+xe.replace("px",""):13,Ve={style:r.css("font-style"),size:Math.round(.8*je),variant:r.css("font-variant"),weight:r.css("font-weight"),family:r.css("font-family")};for(ge=c.xaxes.length||1,ve=0;ve<ge;++ve)fe=c.xaxes[ve],fe&&!fe.tickColor&&(fe.tickColor=fe.color),fe=q.extend(!0,{},c.xaxis,fe),c.xaxes[ve]=fe,fe.font&&(fe.font=q.extend({},Ve,fe.font),fe.font.color||(fe.font.color=fe.color),fe.font.lineHeight||(fe.font.lineHeight=Math.round(fe.font.size*1.15)));for(ge=c.yaxes.length||1,ve=0;ve<ge;++ve)fe=c.yaxes[ve],fe&&!fe.tickColor&&(fe.tickColor=fe.color),fe=q.extend(!0,{},c.yaxis,fe),c.yaxes[ve]=fe,fe.font&&(fe.font=q.extend({},Ve,fe.font),fe.font.color||(fe.font.color=fe.color),fe.font.lineHeight||(fe.font.lineHeight=Math.round(fe.font.size*1.15)));for(c.xaxis.noTicks&&c.xaxis.ticks==null&&(c.xaxis.ticks=c.xaxis.noTicks),c.yaxis.noTicks&&c.yaxis.ticks==null&&(c.yaxis.ticks=c.yaxis.noTicks),c.x2axis&&(c.xaxes[1]=q.extend(!0,{},c.xaxis,c.x2axis),c.xaxes[1].position="top",c.x2axis.min==null&&(c.xaxes[1].min=null),c.x2axis.max==null&&(c.xaxes[1].max=null)),c.y2axis&&(c.yaxes[1]=q.extend(!0,{},c.yaxis,c.y2axis),c.yaxes[1].position="right",c.y2axis.min==null&&(c.yaxes[1].min=null),c.y2axis.max==null&&(c.yaxes[1].max=null)),c.grid.coloredAreas&&(c.grid.markings=c.grid.coloredAreas),c.grid.coloredAreasColor&&(c.grid.markingsColor=c.grid.coloredAreasColor),c.lines&&q.extend(!0,c.series.lines,c.lines),c.points&&q.extend(!0,c.series.points,c.points),c.bars&&q.extend(!0,c.series.bars,c.bars),c.shadowSize!=null&&(c.series.shadowSize=c.shadowSize),c.highlightColor!=null&&(c.series.highlightColor=c.highlightColor),ve=0;ve<c.xaxes.length;++ve)B(m,ve+1).options=c.xaxes[ve];for(ve=0;ve<c.yaxes.length;++ve)B(f,ve+1).options=c.yaxes[ve];for(var ke in C)c.hooks[ke]&&c.hooks[ke].length&&(C[ke]=C[ke].concat(c.hooks[ke]));v(C.processOptions,[c])}function b(ie){s=S(ie),F(),I()}function S(ie){for(var ve=[],fe=0;fe<ie.length;++fe){var ge=q.extend(!0,{},c.series);ie[fe].data!=null?(ge.data=ie[fe].data,delete ie[fe].data,q.extend(!0,ge,ie[fe]),ie[fe].data=ge.data):ge.data=ie[fe],ve.push(ge)}return ve}function M(ie,ve){var fe=ie[ve+"axis"];return typeof fe=="object"&&(fe=fe.n),typeof fe!="number"&&(fe=1),fe}function O(){return q.grep(m.concat(f),function(ie){return ie})}function R(ie){var ve={},fe,ge;for(fe=0;fe<m.length;++fe)ge=m[fe],ge&&(ve["x"+ge.n]=ge.c2p(ie.left));for(fe=0;fe<f.length;++fe)ge=f[fe],ge&&(ve["y"+ge.n]=ge.c2p(ie.top));return ve.x1!==void 0&&(ve.x=ve.x1),ve.y1!==void 0&&(ve.y=ve.y1),ve}function L(ie){var ve={},fe,ge,xe;for(fe=0;fe<m.length;++fe)if(ge=m[fe],ge&&ge.used&&(xe="x"+ge.n,ie[xe]==null&&ge.n==1&&(xe="x"),ie[xe]!=null)){ve.left=ge.p2c(ie[xe]);break}for(fe=0;fe<f.length;++fe)if(ge=f[fe],ge&&ge.used&&(xe="y"+ge.n,ie[xe]==null&&ge.n==1&&(xe="y"),ie[xe]!=null)){ve.top=ge.p2c(ie[xe]);break}return ve}function B(ie,ve){return ie[ve-1]||(ie[ve-1]={n:ve,direction:ie==m?"x":"y",options:q.extend(!0,{},ie==m?c.xaxis:c.yaxis)}),ie[ve-1]}function F(){var ie=s.length,ve=-1,fe;for(fe=0;fe<s.length;++fe){var ge=s[fe].color;ge!=null&&(ie--,typeof ge=="number"&&ge>ve&&(ve=ge))}ie<=ve&&(ie=ve+1);var xe,je=[],Ve=c.colors,ke=Ve.length,Oe=0;for(fe=0;fe<ie;fe++)xe=q.color.parse(Ve[fe%ke]||"#666"),fe%ke==0&&fe&&(Oe>=0?Oe<.5?Oe=-Oe-.2:Oe=0:Oe=-Oe),je[fe]=xe.scale("rgb",1+Oe);var nt=0,Je;for(fe=0;fe<s.length;++fe){if(Je=s[fe],Je.color==null?(Je.color=je[nt].toString(),++nt):typeof Je.color=="number"&&(Je.color=je[Je.color].toString()),Je.lines.show==null){var Be,Ze=!0;for(Be in Je)if(Je[Be]&&Je[Be].show){Ze=!1;break}Ze&&(Je.lines.show=!0)}Je.lines.zero==null&&(Je.lines.zero=!!Je.lines.fill),Je.xaxis=B(m,M(Je,"x")),Je.yaxis=B(f,M(Je,"y"))}}function I(){var ie=Number.POSITIVE_INFINITY,ve=Number.NEGATIVE_INFINITY,fe=Number.MAX_VALUE,ge,xe,je,Ve,ke,Oe,nt,Je,Be,Ze,tt,Re,at,yt,ze,st;function ht(_n,Ot,Rt){Ot<_n.datamin&&Ot!=-fe&&(_n.datamin=Ot),Rt>_n.datamax&&Rt!=fe&&(_n.datamax=Rt)}for(q.each(O(),function(_n,Ot){Ot.datamin=ie,Ot.datamax=ve,Ot.used=!1}),ge=0;ge<s.length;++ge)Oe=s[ge],Oe.datapoints={points:[]},v(C.processRawData,[Oe,Oe.data,Oe.datapoints]);for(ge=0;ge<s.length;++ge){if(Oe=s[ge],ze=Oe.data,st=Oe.datapoints.format,!st){if(st=[],st.push({x:!0,number:!0,required:!0}),st.push({y:!0,number:!0,required:!0}),Oe.stack||Oe.bars.show||Oe.lines.show&&Oe.lines.fill){var It=!!(Oe.bars.show&&Oe.bars.zero||Oe.lines.show&&Oe.lines.zero);st.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:It}),Oe.bars.horizontal&&(delete st[st.length-1].y,st[st.length-1].x=!0)}Oe.datapoints.format=st}if(Oe.datapoints.pointsize==null){Oe.datapoints.pointsize=st.length,Je=Oe.datapoints.pointsize,nt=Oe.datapoints.points;var Gt=Oe.lines.show&&Oe.lines.steps;for(Oe.xaxis.used=Oe.yaxis.used=!0,xe=je=0;xe<ze.length;++xe,je+=Je){yt=ze[xe];var un=yt==null;if(!un)for(Ve=0;Ve<Je;++Ve)Re=yt[Ve],at=st[Ve],at&&(at.number&&Re!=null&&(Re=+Re,isNaN(Re)?Re=null:Re==1/0?Re=fe:Re==-1/0&&(Re=-fe)),Re==null&&(at.required&&(un=!0),at.defaultValue!=null&&(Re=at.defaultValue))),nt[je+Ve]=Re;if(un)for(Ve=0;Ve<Je;++Ve)Re=nt[je+Ve],Re!=null&&(at=st[Ve],at.autoscale!==!1&&(at.x&&ht(Oe.xaxis,Re,Re),at.y&&ht(Oe.yaxis,Re,Re))),nt[je+Ve]=null;if(Gt&&je>0&&(!un||nt[je-Je]!=null)){for(Ve=0;Ve<Je;++Ve)nt[je+Je+Ve]=nt[je+Ve];nt[je+1]=nt[je-Je+1]||0,un&&(nt[je]=yt[0]),je+=Je}}}}for(ge=0;ge<s.length;++ge){if(Oe=s[ge],nt=Oe.datapoints.points,Je=Oe.datapoints.pointsize,Oe.transform==="negative-Y")for(xe=0;xe<nt.length;xe+=Je)nt[xe]!=null&&(Re=nt[xe+1],nt[xe+1]=-Re);v(C.processDatapoints,[Oe,Oe.datapoints])}for(ge=0;ge<s.length;++ge){Oe=s[ge],nt=Oe.datapoints.points,Je=Oe.datapoints.pointsize,st=Oe.datapoints.format;var vn=ie,pn=ie,xn=ve,cn=ve;for(xe=0;xe<nt.length;xe+=Je)if(nt[xe]!=null)for(Ve=0;Ve<Je;++Ve)Re=nt[xe+Ve],at=st[Ve],!(!at||at.autoscale===!1||Re==fe||Re==-fe)&&(at.x&&(Re<vn&&(vn=Re),Re>xn&&(xn=Re)),at.y&&(Re<pn&&(pn=Re),Re>cn&&(cn=Re)));if(Oe.bars.show){var jn;switch(Oe.bars.align){case"left":jn=0;break;case"right":jn=-Oe.bars.barWidth;break;default:jn=-Oe.bars.barWidth/2}Oe.bars.horizontal?(pn+=jn,cn+=jn+Oe.bars.barWidth):(vn+=jn,xn+=jn+Oe.bars.barWidth)}ht(Oe.xaxis,vn,xn),ht(Oe.yaxis,pn,cn)}q.each(O(),function(_n,Ot){Ot.datamin==ie&&(Ot.datamin=null),Ot.datamax==ve&&(Ot.datamax=null)})}function U(){r.find(".flot-temp-elem").remove(),r.css("position")=="static"&&r.css("position","relative"),d=new e("flot-base",r),u=new e("flot-overlay",r),o=d.context,E=u.context,g=q(u.element).unbind();var ie=r.data("plot");ie&&(ie.shutdown(),u.clear()),r.data("plot",l)}function W(){c.grid.hoverable&&(g.mousemove(Se),g.bind("mouseleave",Xe),q(document).bind("touchend",we)),c.grid.clickable&&g.click(Qe),v(C.bindEvents,[g])}function A(){Ee&&clearTimeout(Ee),g.unbind("mousemove",Se),g.unbind("mouseleave",Xe),g.unbind("click",Qe),q(document).unbind("touchend",we),v(C.shutdown,[g])}function N(ie){function ve(Ve){return Ve}var fe,ge,xe=ie.options.transform||ve,je=ie.options.inverseTransform;ie.direction=="x"?(fe=ie.scale=h/Math.abs(xe(ie.max)-xe(ie.min)),ge=Math.min(xe(ie.max),xe(ie.min))):(fe=ie.scale=D/Math.abs(xe(ie.max)-xe(ie.min)),fe=-fe,ge=Math.max(xe(ie.max),xe(ie.min))),xe==ve?ie.p2c=function(Ve){return(Ve-ge)*fe}:ie.p2c=function(Ve){return(xe(Ve)-ge)*fe},je?ie.c2p=function(Ve){return je(ge+Ve/fe)}:ie.c2p=function(Ve){return ge+Ve/fe}}function K(ie){for(var ve=ie.options,fe=ie.ticks||[],ge=ve.labelWidth||0,xe=ve.labelHeight||0,je=ge||(ie.direction=="x"?Math.floor(d.width/(fe.length||1)):null),Ve=ie.direction+"Axis "+ie.direction+ie.n+"Axis",ke="flot-"+ie.direction+"-axis flot-"+ie.direction+ie.n+"-axis "+Ve,Oe=ve.font||"flot-tick-label tickLabel",nt=0;nt<fe.length;++nt){var Je=fe[nt];if(Je.label){var Be=d.getTextInfo(ke,Je.label,Oe,null,je);ge=Math.max(ge,Be.width+1),xe=Math.max(xe,Be.height)}}ie.labelWidth=ve.labelWidth||ge,ie.labelHeight=ve.labelHeight||xe}function V(ie){var ve=ie.labelWidth,fe=ie.labelHeight,ge=ie.options.position,xe=ie.direction==="x",je=ie.options.tickLength,Ve=c.grid.axisMargin,ke=c.grid.labelMargin,Oe=c.grid.eventSectionHeight,nt=!0,Je=!0,Be=!0,Ze=!1;q.each(xe?m:f,function(tt,Re){Re&&(Re.show||Re.reserveSpace)&&(Re===ie?Ze=!0:Re.options.position===ge&&(Ze?Je=!1:nt=!1),Ze||(Be=!1))}),Je&&(Ve=0),je==null&&(je=Be?"full":5),isNaN(+je)||(ke+=+je),xe?(fe+=ke,fe+=Oe,ge=="bottom"?(p.bottom+=fe+Ve,ie.box={top:d.height-p.bottom,height:fe}):(ie.box={top:p.top+Ve,height:fe},p.top+=fe+Ve)):(ve+=ke,ge=="left"?(ie.box={left:p.left+Ve,width:ve},p.left+=ve+Ve):(p.right+=ve+Ve,ie.box={left:d.width-p.right,width:ve})),ie.position=ge,ie.tickLength=je,ie.box.padding=ke,ie.box.eventSectionPadding=Oe,ie.innermost=nt}function T(ie){ie.direction=="x"?(ie.box.left=p.left-ie.labelWidth/2,ie.box.width=d.width-p.left-p.right+ie.labelWidth):(ie.box.top=p.top-ie.labelHeight/2,ie.box.height=d.height-p.bottom-p.top+ie.labelHeight)}function z(){var ie=c.grid.minBorderMargin,ve,fe;if(ie==null)for(ie=0,fe=0;fe<s.length;++fe)ie=Math.max(ie,2*(s[fe].points.radius+s[fe].points.lineWidth/2));var ge={left:ie,right:ie,top:ie,bottom:ie};q.each(O(),function(xe,je){je.reserveSpace&&je.ticks&&je.ticks.length&&(je.direction==="x"?(ge.left=Math.max(ge.left,je.labelWidth/2),ge.right=Math.max(ge.right,je.labelWidth/2)):(ge.bottom=Math.max(ge.bottom,je.labelHeight/2),ge.top=Math.max(ge.top,je.labelHeight/2)))}),p.left=Math.ceil(Math.max(ge.left,p.left)),p.right=Math.ceil(Math.max(ge.right,p.right)),p.top=Math.ceil(Math.max(ge.top,p.top)),p.bottom=Math.ceil(Math.max(ge.bottom,p.bottom))}function w(){var ie,ve=O(),fe=c.grid.show;for(var ge in p){var xe=c.grid.margin||0;p[ge]=typeof xe=="number"?xe:xe[ge]||0}v(C.processOffset,[p]);for(var ge in p)typeof c.grid.borderWidth=="object"?p[ge]+=fe?c.grid.borderWidth[ge]:0:p[ge]+=fe?c.grid.borderWidth:0;if(q.each(ve,function(ke,Oe){var nt=Oe.options;Oe.show=nt.show==null?Oe.used:nt.show,Oe.reserveSpace=nt.reserveSpace==null?Oe.show:nt.reserveSpace,H(Oe)}),v(C.processRange,[]),fe){for(var je=q.grep(ve,function(ke){return ke.show||ke.reserveSpace}),Ve=!1,ie=0;ie<2&&(q.each(je,function(Oe,nt){X(nt),k(nt),Ve=_(nt,nt.ticks)||Ve,K(nt)}),Ve&&C.processRange.length>0);ie++)v(C.processRange,[]),Ve=!1;for(ie=je.length-1;ie>=0;--ie)V(je[ie]);z(),q.each(je,function(ke,Oe){T(Oe)})}h=d.width-p.left-p.right,D=d.height-p.bottom-p.top,q.each(ve,function(ke,Oe){N(Oe)}),fe&&ae(),me()}function H(ie){var ve=ie.options,fe=+(ve.min!=null?ve.min:ie.datamin),ge=+(ve.max!=null?ve.max:ie.datamax),xe=ge-fe;if(xe==0){var je=.25,Ve=Math.abs(ge==0?1:ge*je);ve.min==null&&(fe-=Ve),(ve.max==null||ve.min!=null)&&(ge+=Ve)}else{var ke=ve.autoscaleMargin;ke!=null&&(ve.min==null&&(fe-=xe*ke,fe<0&&ie.datamin!=null&&ie.datamin>=0&&(fe=0)),ve.max==null&&(ge+=xe*ke,ge>0&&ie.datamax!=null&&ie.datamax<=0&&(ge=0)))}ie.min=fe,ie.max=ge}function G(ie){if(ie=Math.abs(String(ie).replace(".","")),ie==0)return 0;for(;ie!=0&&ie%10==0;)ie/=10;return Math.floor(Math.log(ie)/Math.LN10)+1}function X(ie){var ve=ie.options,fe;typeof ve.ticks=="number"&&ve.ticks>0?fe=ve.ticks:fe=.3*Math.sqrt(ie.direction=="x"?d.width:d.height);var ge=(ie.max-ie.min)/fe,xe=-Math.floor(Math.log(ge)/Math.LN10),je=ve.tickDecimals;je!=null&&xe>je&&(xe=je);var Ve=Math.pow(10,-xe),ke=ge/Ve,Oe;if(ke<1.5?Oe=1:ke<3?(Oe=2,ke>2.25&&(je==null||xe+1<=je)&&(Oe=2.5,++xe)):ke<7.5?Oe=5:Oe=10,Oe*=Ve,ve.minTickSize!=null&&Oe<ve.minTickSize&&(Oe=ve.minTickSize),ie.delta=ge,ie.tickDecimals=Math.max(0,je??xe),ie.tickSize=ve.tickSize||Oe,ve.mode=="time"&&!ie.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(ie.tickGenerator||(ie.tickGenerator=function(tt){var Re=[],at=n(tt.min,tt.tickSize),yt=0,ze=Number.NaN,st;do st=ze,ze=at+yt*tt.tickSize,Re.push(ze),++yt;while(ze<tt.max&&ze!=st);return Re},ie.tickFormatter=function(tt,Re){var at=Re.tickDecimals?Math.pow(10,Re.tickDecimals):1,yt=""+Math.round(tt*at)/at;if(Re.tickDecimals!=null){var ze=yt.indexOf("."),st=ze==-1?0:yt.length-ze-1;if(st<Re.tickDecimals)return(st?yt:yt+".")+(""+at).substr(1,Re.tickDecimals-st)}return yt}),q.isFunction(ve.tickFormatter)&&(ie.tickFormatter=function(tt,Re){return""+ve.tickFormatter(tt,Re)}),ve.alignTicksWithAxis!=null){var nt=(ie.direction=="x"?m:f)[ve.alignTicksWithAxis-1];if(nt&&nt.used&&nt!=ie){var Je=ie.tickGenerator(ie);if(Je.length>0&&(ve.min==null&&(ie.min=Math.min(ie.min,Je[0])),ve.max==null&&Je.length>1&&(ie.max=Math.max(ie.max,Je[Je.length-1]))),ie.tickGenerator=function(tt){var Re=[],at,yt;for(yt=0;yt<nt.ticks.length;++yt)at=(nt.ticks[yt].v-nt.min)/(nt.max-nt.min),at=tt.min+at*(tt.max-tt.min),Re.push(at);return Re},!ie.mode&&ve.tickDecimals==null){var Be=Math.max(0,-Math.floor(Math.log(ie.delta)/Math.LN10)+1),Ze=ie.tickGenerator(ie);Ze.length>1&&/\..*0$/.test((Ze[1]-Ze[0]).toFixed(Be))||(ie.tickDecimals=Be)}}}}function k(ie){var ve=ie.options.ticks,fe=[];ve==null||typeof ve=="number"&&ve>0?fe=ie.tickGenerator(ie):ve&&(q.isFunction(ve)?fe=ve(ie):fe=ve);var ge,xe;for(ie.ticks=[],ge=0;ge<fe.length;++ge){var je=null,Ve=fe[ge];typeof Ve=="object"?(xe=+Ve[0],Ve.length>1&&(je=Ve[1])):xe=+Ve,je==null&&(je=ie.tickFormatter(xe,ie)),isNaN(xe)||ie.ticks.push({v:xe,label:je})}}function _(ie,ve){var fe=!1;return ie.options.autoscaleMargin&&ve.length>0&&(ie.options.min==null&&(ie.min=Math.min(ie.min,ve[0].v),fe=!0),ie.options.max==null&&ve.length>1&&(ie.max=Math.max(ie.max,ve[ve.length-1].v),fe=!0)),fe}function ee(){d.clear(),v(C.drawBackground,[o]);var ie=c.grid;ie.show&&ie.backgroundColor&&Z(),ie.show&&!ie.aboveData&&te();for(var ve=0;ve<s.length;++ve)v(C.drawSeries,[o,s[ve]]),ne(s[ve]);v(C.draw,[o]),ie.show&&ie.aboveData&&te(),d.render(),Te()}function J(ie,ve){for(var fe,ge,xe,je,Ve=O(),ke=0;ke<Ve.length;++ke)if(fe=Ve[ke],fe.direction==ve&&(je=ve+fe.n+"axis",!ie[je]&&fe.n==1&&(je=ve+"axis"),ie[je])){ge=ie[je].from,xe=ie[je].to;break}if(ie[je]||(fe=ve=="x"?m[0]:f[0],ge=ie[ve+"1"],xe=ie[ve+"2"]),ge!=null&&xe!=null&&ge>xe){var Oe=ge;ge=xe,xe=Oe}return{from:ge,to:xe,axis:fe}}function Z(){o.save(),o.translate(p.left,p.top),o.fillStyle=Ne(c.grid.backgroundColor,D,0,"rgba(255, 255, 255, 0)"),o.fillRect(0,0,h,D),o.restore()}function te(){var ie,ve,fe,ge;o.save(),o.translate(p.left,p.top);var xe=c.grid.markings;if(xe)for(q.isFunction(xe)&&(ve=l.getAxes(),ve.xmin=ve.xaxis.min,ve.xmax=ve.xaxis.max,ve.ymin=ve.yaxis.min,ve.ymax=ve.yaxis.max,xe=xe(ve)),ie=0;ie<xe.length;++ie){var je=xe[ie],Ve=J(je,"x"),ke=J(je,"y");if(Ve.from==null&&(Ve.from=Ve.axis.min),Ve.to==null&&(Ve.to=Ve.axis.max),ke.from==null&&(ke.from=ke.axis.min),ke.to==null&&(ke.to=ke.axis.max),!(Ve.to<Ve.axis.min||Ve.from>Ve.axis.max||ke.to<ke.axis.min||ke.from>ke.axis.max)){Ve.from=Math.max(Ve.from,Ve.axis.min),Ve.to=Math.min(Ve.to,Ve.axis.max),ke.from=Math.max(ke.from,ke.axis.min),ke.to=Math.min(ke.to,ke.axis.max);var Oe=Ve.from===Ve.to,nt=ke.from===ke.to;if(!(Oe&&nt))if(Ve.from=Math.floor(Ve.axis.p2c(Ve.from)),Ve.to=Math.floor(Ve.axis.p2c(Ve.to)),ke.from=Math.floor(ke.axis.p2c(ke.from)),ke.to=Math.floor(ke.axis.p2c(ke.to)),Oe||nt){var Je=je.lineWidth||c.grid.markingsLineWidth,Be=Je%2?.5:0;o.beginPath(),o.strokeStyle=je.color||c.grid.markingsColor,o.lineWidth=Je,Oe?(o.moveTo(Ve.to+Be,ke.from),o.lineTo(Ve.to+Be,ke.to)):(o.moveTo(Ve.from,ke.to+Be),o.lineTo(Ve.to,ke.to+Be)),o.stroke()}else o.fillStyle=je.color||c.grid.markingsColor,o.fillRect(Ve.from,ke.to,Ve.to-Ve.from,ke.from-ke.to)}}ve=O(),fe=c.grid.borderWidth;for(var Ze=0;Ze<ve.length;++Ze){var tt=ve[Ze],Re=tt.box,at=tt.tickLength,yt,ze,st,ht;if(!(!tt.show||tt.ticks.length==0)){for(o.lineWidth=1,tt.direction=="x"?(yt=0,at=="full"?ze=tt.position=="top"?0:D:ze=Re.top-p.top+(tt.position=="top"?Re.height:0)):(ze=0,at=="full"?yt=tt.position=="left"?0:h:yt=Re.left-p.left+(tt.position=="left"?Re.width:0)),tt.innermost||(o.strokeStyle=tt.options.color,o.beginPath(),st=ht=0,tt.direction=="x"?st=h+1:ht=D+1,o.lineWidth==1&&(tt.direction=="x"?ze=Math.floor(ze)+.5:yt=Math.floor(yt)+.5),o.moveTo(yt,ze),o.lineTo(yt+st,ze+ht),o.stroke()),o.strokeStyle=tt.options.tickColor,o.beginPath(),ie=0;ie<tt.ticks.length;++ie){var It=tt.ticks[ie].v;st=ht=0,!(isNaN(It)||It<tt.min||It>tt.max||at=="full"&&(typeof fe=="object"&&fe[tt.position]>0||fe>0)&&(It==tt.min||It==tt.max))&&(tt.direction=="x"?(yt=tt.p2c(It),ht=at=="full"?-D:at,tt.position=="top"&&(ht=-ht)):(ze=tt.p2c(It),st=at=="full"?-h:at,tt.position=="left"&&(st=-st)),o.lineWidth==1&&(tt.direction=="x"?yt=Math.floor(yt)+.5:ze=Math.floor(ze)+.5),o.moveTo(yt,ze),o.lineTo(yt+st,ze+ht))}o.stroke()}}fe&&(ge=c.grid.borderColor,typeof fe=="object"||typeof ge=="object"?(typeof fe!="object"&&(fe={top:fe,right:fe,bottom:fe,left:fe}),typeof ge!="object"&&(ge={top:ge,right:ge,bottom:ge,left:ge}),fe.top>0&&(o.strokeStyle=ge.top,o.lineWidth=fe.top,o.beginPath(),o.moveTo(0-fe.left,0-fe.top/2),o.lineTo(h,0-fe.top/2),o.stroke()),fe.right>0&&(o.strokeStyle=ge.right,o.lineWidth=fe.right,o.beginPath(),o.moveTo(h+fe.right/2,0-fe.top),o.lineTo(h+fe.right/2,D),o.stroke()),fe.bottom>0&&(o.strokeStyle=ge.bottom,o.lineWidth=fe.bottom,o.beginPath(),o.moveTo(h+fe.right,D+fe.bottom/2),o.lineTo(0,D+fe.bottom/2),o.stroke()),fe.left>0&&(o.strokeStyle=ge.left,o.lineWidth=fe.left,o.beginPath(),o.moveTo(0-fe.left/2,D+fe.bottom),o.lineTo(0-fe.left/2,0),o.stroke())):(o.lineWidth=fe,o.strokeStyle=c.grid.borderColor,o.strokeRect(-fe/2,-fe/2,h+fe,D+fe))),o.restore()}function ae(){q.each(O(),function(ie,ve){var fe=ve.box,ge=ve.direction+"Axis "+ve.direction+ve.n+"Axis",xe="flot-"+ve.direction+"-axis flot-"+ve.direction+ve.n+"-axis "+ge,je=ve.options.font||"flot-tick-label tickLabel",Ve,ke,Oe,nt,Je;if(d.removeText(xe),!(!ve.show||ve.ticks.length==0))for(var Be=0;Be<ve.ticks.length;++Be)Ve=ve.ticks[Be],!(!Ve.label||Ve.v<ve.min||Ve.v>ve.max)&&(ve.direction=="x"?(nt="center",ke=p.left+ve.p2c(Ve.v),ve.position=="bottom"?Oe=fe.top+fe.padding+fe.eventSectionPadding:(Oe=fe.top+fe.height-fe.padding,Je="bottom")):(Je="middle",Oe=p.top+ve.p2c(Ve.v),ve.position=="left"?(ke=fe.left+fe.width-fe.padding,nt="right"):ke=fe.left+fe.padding),d.addText(xe,ke,Oe,Ve.label,je,null,null,nt,Je))})}function re(ie){for(var ve=[],fe=null,ge=null,xe=ie.datapoints,je=[],Ve=0;Ve<xe.pointsize-2;Ve++)je.push(0);for(var ke=0;ke<xe.points.length;ke+=xe.pointsize){var Oe=xe.points[ke],nt=xe.points[ke+1];ke===xe.points.length-xe.pointsize?ge=null:ge=xe.points[ke+xe.pointsize],Oe!==null&&nt!==null&&fe===null&&ge===null&&(ve.push(Oe),ve.push(nt),ve.push.apply(ve,je)),fe=Oe}var Je=xe.points;xe.points=ve,ie.points.radius=ie.lines.lineWidth/2,le(ie),xe.points=Je}function ne(ie){ie.lines.show&&(ce(ie),!ie.points.show&&!ie.bars.show&&re(ie)),ie.bars.show&&oe(ie),ie.points.show&&le(ie)}function ce(ie){function ve(ke,Oe,nt,Je,Be){var Ze=ke.points,tt=ke.pointsize,Re=null,at=null;o.beginPath();for(var yt=tt;yt<Ze.length;yt+=tt){var ze=Ze[yt-tt],st=Ze[yt-tt+1],ht=Ze[yt],It=Ze[yt+1];if(!(ze==null||ht==null)){if(st<=It&&st<Be.min){if(It<Be.min)continue;ze=(Be.min-st)/(It-st)*(ht-ze)+ze,st=Be.min}else if(It<=st&&It<Be.min){if(st<Be.min)continue;ht=(Be.min-st)/(It-st)*(ht-ze)+ze,It=Be.min}if(st>=It&&st>Be.max){if(It>Be.max)continue;ze=(Be.max-st)/(It-st)*(ht-ze)+ze,st=Be.max}else if(It>=st&&It>Be.max){if(st>Be.max)continue;ht=(Be.max-st)/(It-st)*(ht-ze)+ze,It=Be.max}if(ze<=ht&&ze<Je.min){if(ht<Je.min)continue;st=(Je.min-ze)/(ht-ze)*(It-st)+st,ze=Je.min}else if(ht<=ze&&ht<Je.min){if(ze<Je.min)continue;It=(Je.min-ze)/(ht-ze)*(It-st)+st,ht=Je.min}if(ze>=ht&&ze>Je.max){if(ht>Je.max)continue;st=(Je.max-ze)/(ht-ze)*(It-st)+st,ze=Je.max}else if(ht>=ze&&ht>Je.max){if(ze>Je.max)continue;It=(Je.max-ze)/(ht-ze)*(It-st)+st,ht=Je.max}(ze!=Re||st!=at)&&o.moveTo(Je.p2c(ze)+Oe,Be.p2c(st)+nt),Re=ht,at=It,o.lineTo(Je.p2c(ht)+Oe,Be.p2c(It)+nt)}}o.stroke()}function fe(ke,Oe,nt){for(var Je=ke.points,Be=ke.pointsize,Ze=Math.min(Math.max(0,nt.min),nt.max),tt=0,Re,at=!1,yt=1,ze=0,st=0;!(Be>0&&tt>Je.length+Be);){tt+=Be;var ht=Je[tt-Be],It=Je[tt-Be+yt],Gt=Je[tt],un=Je[tt+yt];if(at){if(Be>0&&ht!=null&&Gt==null){st=tt,Be=-Be,yt=2;continue}if(Be<0&&tt==ze+Be){o.fill(),at=!1,Be=-Be,yt=1,tt=ze=st+Be;continue}}if(!(ht==null||Gt==null)){if(ht<=Gt&&ht<Oe.min){if(Gt<Oe.min)continue;It=(Oe.min-ht)/(Gt-ht)*(un-It)+It,ht=Oe.min}else if(Gt<=ht&&Gt<Oe.min){if(ht<Oe.min)continue;un=(Oe.min-ht)/(Gt-ht)*(un-It)+It,Gt=Oe.min}if(ht>=Gt&&ht>Oe.max){if(Gt>Oe.max)continue;It=(Oe.max-ht)/(Gt-ht)*(un-It)+It,ht=Oe.max}else if(Gt>=ht&&Gt>Oe.max){if(ht>Oe.max)continue;un=(Oe.max-ht)/(Gt-ht)*(un-It)+It,Gt=Oe.max}if(at||(o.beginPath(),o.moveTo(Oe.p2c(ht),nt.p2c(Ze)),at=!0),It>=nt.max&&un>=nt.max){o.lineTo(Oe.p2c(ht),nt.p2c(nt.max)),o.lineTo(Oe.p2c(Gt),nt.p2c(nt.max));continue}else if(It<=nt.min&&un<=nt.min){o.lineTo(Oe.p2c(ht),nt.p2c(nt.min)),o.lineTo(Oe.p2c(Gt),nt.p2c(nt.min));continue}var vn=ht,pn=Gt;It<=un&&It<nt.min&&un>=nt.min?(ht=(nt.min-It)/(un-It)*(Gt-ht)+ht,It=nt.min):un<=It&&un<nt.min&&It>=nt.min&&(Gt=(nt.min-It)/(un-It)*(Gt-ht)+ht,un=nt.min),It>=un&&It>nt.max&&un<=nt.max?(ht=(nt.max-It)/(un-It)*(Gt-ht)+ht,It=nt.max):un>=It&&un>nt.max&&It<=nt.max&&(Gt=(nt.max-It)/(un-It)*(Gt-ht)+ht,un=nt.max),ht!=vn&&o.lineTo(Oe.p2c(vn),nt.p2c(It)),o.lineTo(Oe.p2c(ht),nt.p2c(It)),o.lineTo(Oe.p2c(Gt),nt.p2c(un)),Gt!=pn&&(o.lineTo(Oe.p2c(Gt),nt.p2c(un)),o.lineTo(Oe.p2c(pn),nt.p2c(un)))}}}o.save(),o.translate(p.left,p.top),o.lineJoin="round";var ge=ie.lines.lineWidth,xe=ie.shadowSize;if(ge>0&&xe>0){o.lineWidth=xe,o.strokeStyle="rgba(0,0,0,0.1)";var je=Math.PI/18;ve(ie.datapoints,Math.sin(je)*(ge/2+xe/2),Math.cos(je)*(ge/2+xe/2),ie.xaxis,ie.yaxis),o.lineWidth=xe/2,ve(ie.datapoints,Math.sin(je)*(ge/2+xe/4),Math.cos(je)*(ge/2+xe/4),ie.xaxis,ie.yaxis)}o.lineWidth=ge,o.strokeStyle=ie.color;var Ve=de(ie.lines,ie.color,0,D);Ve&&(o.fillStyle=Ve,fe(ie.datapoints,ie.xaxis,ie.yaxis)),ge>0&&ve(ie.datapoints,0,0,ie.xaxis,ie.yaxis),o.restore()}function le(ie){function ve(ke,Oe,nt,Je,Be,Ze,tt,Re){for(var at=ke.points,yt=ke.pointsize,ze=0;ze<at.length;ze+=yt){var st=at[ze],ht=at[ze+1];st==null||st<Ze.min||st>Ze.max||ht<tt.min||ht>tt.max||(o.beginPath(),st=Ze.p2c(st),ht=tt.p2c(ht)+Je,Re=="circle"?o.arc(st,ht,Oe,0,Be?Math.PI:Math.PI*2,!1):Re(o,st,ht,Oe,Be),o.closePath(),nt&&(o.fillStyle=nt,o.fill()),o.stroke())}}o.save(),o.translate(p.left,p.top);var fe=ie.points.lineWidth,ge=ie.shadowSize,xe=ie.points.radius,je=ie.points.symbol;if(fe==0&&(fe=1e-4),fe>0&&ge>0){var Ve=ge/2;o.lineWidth=Ve,o.strokeStyle="rgba(0,0,0,0.1)",ve(ie.datapoints,xe,null,Ve+Ve/2,!0,ie.xaxis,ie.yaxis,je),o.strokeStyle="rgba(0,0,0,0.2)",ve(ie.datapoints,xe,null,Ve/2,!0,ie.xaxis,ie.yaxis,je)}o.lineWidth=fe,o.strokeStyle=ie.color,ve(ie.datapoints,xe,de(ie.points,ie.color),0,!1,ie.xaxis,ie.yaxis,je),o.restore()}function he(ie,ve,fe,ge,xe,je,Ve,ke,Oe,nt,Je){var Be,Ze,tt,Re,at,yt,ze,st,ht;nt?(st=yt=ze=!0,at=!1,Be=fe,Ze=ie,Re=ve+ge,tt=ve+xe,Ze<Be&&(ht=Ze,Ze=Be,Be=ht,at=!0,yt=!1)):(at=yt=ze=!0,st=!1,Be=ie+ge,Ze=ie+xe,tt=fe,Re=ve,Re<tt&&(ht=Re,Re=tt,tt=ht,st=!0,ze=!1)),!(Ze<Ve.min||Be>Ve.max||Re<ke.min||tt>ke.max)&&(Be<Ve.min&&(Be=Ve.min,at=!1),Ze>Ve.max&&(Ze=Ve.max,yt=!1),tt<ke.min&&(tt=ke.min,st=!1),Re>ke.max&&(Re=ke.max,ze=!1),Be=Ve.p2c(Be),tt=ke.p2c(tt),Ze=Ve.p2c(Ze),Re=ke.p2c(Re),je&&(Oe.fillStyle=je(tt,Re),Oe.fillRect(Be,Re,Ze-Be,tt-Re)),Je>0&&(at||yt||ze||st)&&(Oe.beginPath(),Oe.moveTo(Be,tt),at?Oe.lineTo(Be,Re):Oe.moveTo(Be,Re),ze?Oe.lineTo(Ze,Re):Oe.moveTo(Ze,Re),yt?Oe.lineTo(Ze,tt):Oe.moveTo(Ze,tt),st?Oe.lineTo(Be,tt):Oe.moveTo(Be,tt),Oe.stroke()))}function oe(ie){function ve(xe,je,Ve,ke,Oe,nt){for(var Je=xe.points,Be=xe.pointsize,Ze=0;Ze<Je.length;Ze+=Be)Je[Ze]!=null&&he(Je[Ze],Je[Ze+1],Je[Ze+2],je,Ve,ke,Oe,nt,o,ie.bars.horizontal,ie.bars.lineWidth)}o.save(),o.translate(p.left,p.top),o.lineWidth=ie.bars.lineWidth,o.strokeStyle=ie.color;var fe;switch(ie.bars.align){case"left":fe=0;break;case"right":fe=-ie.bars.barWidth;break;default:fe=-ie.bars.barWidth/2}var ge=ie.bars.fill?function(xe,je){return de(ie.bars,ie.color,xe,je)}:null;ve(ie.datapoints,fe,fe+ie.bars.barWidth,ge,ie.xaxis,ie.yaxis),o.restore()}function de(ie,ve,fe,ge){var xe=ie.fill;if(!xe)return null;if(ie.fillColor)return Ne(ie.fillColor,fe,ge,ve);var je=q.color.parse(ve);return je.a=typeof xe=="number"?xe:.4,je.normalize(),je.toString()}function me(){if(c.legend.container!=null?q.find(c.legend.container).html(""):r.find(".legend").remove(),!!c.legend.show){for(var ie=[],ve=[],fe=!1,ge=c.legend.labelFormatter,xe,je,Ve=0;Ve<s.length;++Ve)xe=s[Ve],xe.label&&(je=ge?ge(xe.label,xe):xe.label,je&&ve.push({label:je,color:xe.color}));if(c.legend.sorted)if(q.isFunction(c.legend.sorted))ve.sort(c.legend.sorted);else if(c.legend.sorted=="reverse")ve.reverse();else{var ke=c.legend.sorted!="descending";ve.sort(function(yt,ze){return yt.label==ze.label?0:yt.label<ze.label!=ke?1:-1})}for(var Ve=0;Ve<ve.length;++Ve){var Oe=ve[Ve];Ve%c.legend.noColumns==0&&(fe&&ie.push("</tr>"),ie.push("<tr>"),fe=!0),ie.push('<td class="legendColorBox"><div style="border:1px solid '+c.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+Oe.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+Oe.label+"</td>")}if(fe&&ie.push("</tr>"),ie.length!=0){var nt='<table style="font-size:smaller;color:'+c.grid.color+'">'+ie.join("")+"</table>";if(c.legend.container!=null)q(c.legend.container).html(nt);else{var Je="",Be=c.legend.position,Ze=c.legend.margin;Ze[0]==null&&(Ze=[Ze,Ze]),Be.charAt(0)=="n"?Je+="top:"+(Ze[1]+p.top)+"px;":Be.charAt(0)=="s"&&(Je+="bottom:"+(Ze[1]+p.bottom)+"px;"),Be.charAt(1)=="e"?Je+="right:"+(Ze[0]+p.right)+"px;":Be.charAt(1)=="w"&&(Je+="left:"+(Ze[0]+p.left)+"px;");var tt=q('<div class="legend">'+nt.replace('style="','style="position:absolute;'+Je+";")+"</div>").appendTo(r);if(c.legend.backgroundOpacity!=0){var Re=c.legend.backgroundColor;Re==null&&(Re=c.grid.backgroundColor,Re&&typeof Re=="string"?Re=q.color.parse(Re):Re=q.color.extract(tt,"background-color"),Re.a=1,Re=Re.toString());var at=tt.children();q('<div style="position:absolute;width:'+at.width()+"px;height:"+at.height()+"px;"+Je+"background-color:"+Re+';"> </div>').prependTo(tt).css("opacity",c.legend.backgroundOpacity)}}}}}var Pe=[],Ee=null;function be(ie,ve,fe){var ge=c.grid.mouseActiveRadius,xe=ge*ge+1,je=null,Ve=!1,ke,Oe,nt;for(ke=s.length-1;ke>=0;--ke)if(fe(s[ke])){var Je=s[ke],Be=Je.xaxis,Ze=Je.yaxis,tt=Je.datapoints.points,Re=Be.c2p(ie),at=Ze.c2p(ve),yt=ge/Be.scale,ze=ge/Ze.scale;if(nt=Je.datapoints.pointsize,Be.options.inverseTransform&&(yt=Number.MAX_VALUE),Ze.options.inverseTransform&&(ze=Number.MAX_VALUE),Je.lines.show||Je.points.show)for(Oe=0;Oe<tt.length;Oe+=nt){var st=tt[Oe],ht=tt[Oe+1];if(st!=null&&!(st-Re>yt||st-Re<-yt||ht-at>ze||ht-at<-ze)){var It=Math.abs(Be.p2c(st)-ie),Gt=Math.abs(Ze.p2c(ht)-ve),un=It*It+Gt*Gt;un<xe&&(xe=un,je=[ke,Oe/nt])}}if(Je.bars.show&&!je){var vn,pn;switch(Je.bars.align){case"left":vn=0;break;case"right":vn=-Je.bars.barWidth;break;default:vn=-Je.bars.barWidth/2}for(pn=vn+Je.bars.barWidth,Oe=0;Oe<tt.length;Oe+=nt){var st=tt[Oe],ht=tt[Oe+1],xn=tt[Oe+2];st!=null&&(s[ke].bars.horizontal?Re<=Math.max(xn,st)&&Re>=Math.min(xn,st)&&at>=ht+vn&&at<=ht+pn:Re>=st+vn&&Re<=st+pn&&at>=Math.min(xn,ht)&&at<=Math.max(xn,ht))&&(je=[ke,Oe/nt])}}}return je?(ke=je[0],Oe=je[1],nt=s[ke].datapoints.pointsize,{datapoint:s[ke].datapoints.points.slice(Oe*nt,(Oe+1)*nt),dataIndex:Oe,series:s[ke],seriesIndex:ke}):null}function Se(ie){c.grid.hoverable&&Fe("plothover",ie,function(ve){return ve.hoverable!=!1})}function Xe(ie){c.grid.hoverable&&Fe("plothover",ie,function(ve){return!1})}function Qe(ie){l.isSelecting||Fe("plotclick",ie,function(ve){return ve.clickable!=!1})}function we(ie){if(ie.cancelable){if(!g.is(ie.target)&&g.has(ie.target).length===0){Fe("plotleave",ie,function(ve){});return}Se($e(ie)),ie.preventDefault()}}function $e(ie){if(!ie||!ie.originalEvent||ie.pageX&&ie.pageY)return ie;var ve=ie.originalEvent;if(ve.changedTouches.length===0)return ie;var fe=ve.changedTouches[0];return ie.pageX=fe.pageX,ie.pageY=fe.pageY,ie}function Fe(ie,ve,fe){var ge=g.offset(),xe=ve.pageX-ge.left-p.left,je=ve.pageY-ge.top-p.top,Ve=R({left:xe,top:je});Ve.pageX=ve.pageX,Ve.pageY=ve.pageY,Ve.ctrlKey=ve.ctrlKey,Ve.metaKey=ve.metaKey;var ke=be(xe,je,fe);if(ke&&(ke.pageX=parseInt(ke.series.xaxis.p2c(ke.datapoint[0])+ge.left+p.left,10),ke.pageY=parseInt(ke.series.yaxis.p2c(ke.datapoint[1])+ge.top+p.top,10)),c.grid.autoHighlight){for(var Oe=0;Oe<Pe.length;++Oe){var nt=Pe[Oe];nt.auto==ie&&!(ke&&nt.series==ke.series&&nt.point[0]==ke.datapoint[0]&&nt.point[1]==ke.datapoint[1])&&Me(nt.series,nt.point)}ke&&Ge(ke.series,ke.datapoint,ie)}r.trigger(ie,[Ve,ke])}function Te(){var ie=c.interaction.redrawOverlayInterval;if(ie==-1){Le();return}Ee||(Ee=setTimeout(Le,ie))}function Le(){Ee=null,E.save(),u.clear(),E.translate(p.left,p.top);var ie,ve;for(ie=0;ie<Pe.length;++ie)ve=Pe[ie],ve.series.bars.show?Ie(ve.series,ve.point):Ke(ve.series,ve.point);E.restore(),v(C.drawOverlay,[E])}function Ge(ie,ve,fe){if(typeof ie=="number"&&(ie=s[ie]),typeof ve=="number"){var ge=ie.datapoints.pointsize;ve=ie.datapoints.points.slice(ge*ve,ge*(ve+1))}var xe=De(ie,ve);xe==-1?(Pe.push({series:ie,point:ve,auto:fe}),Te()):fe||(Pe[xe].auto=!1)}function Me(ie,ve){if(ie==null&&ve==null){Pe=[],Te();return}if(typeof ie=="number"&&(ie=s[ie]),typeof ve=="number"){var fe=ie.datapoints.pointsize;ve=ie.datapoints.points.slice(fe*ve,fe*(ve+1))}var ge=De(ie,ve);ge!=-1&&(Pe.splice(ge,1),Te())}function De(ie,ve){for(var fe=0;fe<Pe.length;++fe){var ge=Pe[fe];if(ge.series==ie&&ge.point[0]==ve[0]&&ge.point[1]==ve[1])return fe}return-1}function Ke(ie,ve){var fe=ve[0],ge=ve[1],xe=ie.xaxis,je=ie.yaxis,Ve=typeof ie.highlightColor=="string"?ie.highlightColor:q.color.parse(ie.color).scale("a",.5).toString();if(!(fe<xe.min||fe>xe.max||ge<je.min||ge>je.max)){var ke=ie.points.radius+ie.points.lineWidth/2;E.lineWidth=ke,E.strokeStyle=Ve;var Oe=1.5*ke;fe=xe.p2c(fe),ge=je.p2c(ge),E.beginPath(),ie.points.symbol=="circle"?E.arc(fe,ge,Oe,0,2*Math.PI,!1):ie.points.symbol(E,fe,ge,Oe,!1),E.closePath(),E.stroke()}}function Ie(ie,ve){var fe=typeof ie.highlightColor=="string"?ie.highlightColor:q.color.parse(ie.color).scale("a",.5).toString(),ge=fe,xe;switch(ie.bars.align){case"left":xe=0;break;case"right":xe=-ie.bars.barWidth;break;default:xe=-ie.bars.barWidth/2}E.lineWidth=ie.bars.lineWidth,E.strokeStyle=fe,he(ve[0],ve[1],ve[2]||0,xe,xe+ie.bars.barWidth,function(){return ge},ie.xaxis,ie.yaxis,E,ie.bars.horizontal,ie.bars.lineWidth)}function Ne(ie,ve,fe,ge){if(typeof ie=="string")return ie;for(var xe=o.createLinearGradient(0,fe,0,ve),je=0,Ve=ie.colors.length;je<Ve;++je){var ke=ie.colors[je];if(typeof ke!="string"){var Oe=q.color.parse(ge);ke.brightness!=null&&(Oe=Oe.scale("rgb",ke.brightness)),ke.opacity!=null&&(Oe.a*=ke.opacity),ke=Oe.toString()}xe.addColorStop(je/(Ve-1),ke)}return xe}}q.plot=function(r,a,i){var x=new t(q(r),a,i,q.plot.plugins);return x},q.plot.version="0.8.3",q.plot.plugins=[],q.fn.plot=function(r,a){return this.each(function(){q.plot(this,r,a)})};function n(r,a){return a*Math.floor(r/a)}}(jQuery)},80851:()=>{(function(q){function j(e){var t={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},r=null;function a(p){t.active&&(g(p),e.getPlaceholder().trigger("plotselecting",[s()]))}function i(p){p.which==1&&(document.body.focus(),document.onselectstart!==void 0&&n.onselectstart==null&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&n.ondrag==null&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),u(t.first,p),t.active=!0,r=function(h){x(h)},q(document).one("mouseup",r))}function x(p){return r=null,document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag),t.active=!1,g(p),f()?c(p):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function s(){if(!f()||!t.show)return null;var p={},h=t.first,D=t.second,C=e.getAxes(),l=!0;return q.each(C,function(v,y){y.used&&(anyUsed=!1)}),q.each(C,function(v,y){if(y.used||l){var P=y.c2p(h[y.direction]),b=y.c2p(D[y.direction]);p[v]={from:Math.min(P,b),to:Math.max(P,b)}}}),p}function c(p){var h=s();h.ctrlKey=p.ctrlKey,h.metaKey=p.metaKey,e.getPlaceholder().trigger("plotselected",[h]),h.xaxis&&h.yaxis&&e.getPlaceholder().trigger("selected",[{x1:h.xaxis.from,y1:h.yaxis.from,x2:h.xaxis.to,y2:h.yaxis.to}])}function d(p,h,D){return h<p?p:h>D?D:h}function u(p,h){var D=e.getOptions(),C=e.getPlaceholder().offset(),l=e.getPlotOffset();p.x=d(0,h.pageX-C.left-l.left,e.width()),p.y=d(0,h.pageY-C.top-l.top,e.height()),D.selection.mode=="y"&&(p.x=p==t.first?0:e.width()),D.selection.mode=="x"&&(p.y=p==t.first?0:e.height())}function g(p){p.pageX!=null&&(u(t.second,p),f()?(e.isSelecting=!0,t.show=!0,e.triggerRedrawOverlay()):o(!0))}function o(p){t.show&&(t.show=!1,e.triggerRedrawOverlay(),p||e.getPlaceholder().trigger("plotunselected",[]))}function E(p,h){var D,C,l,v,y=e.getAxes();for(var P in y)if(D=y[P],D.direction==h&&(v=h+D.n+"axis",!p[v]&&D.n==1&&(v=h+"axis"),p[v])){C=p[v].from,l=p[v].to;break}if(p[v]||(D=h=="x"?e.getXAxes()[0]:e.getYAxes()[0],C=p[h+"1"],l=p[h+"2"]),C!=null&&l!=null&&C>l){var b=C;C=l,l=b}return{from:C,to:l,axis:D}}function m(p,h){var D,C,l=e.getOptions();l.selection.mode=="y"?(t.first.x=0,t.second.x=e.width()):(C=E(p,"x"),t.first.x=C.axis.p2c(C.from),t.second.x=C.axis.p2c(C.to)),l.selection.mode=="x"?(t.first.y=0,t.second.y=e.height()):(C=E(p,"y"),t.first.y=C.axis.p2c(C.from),t.second.y=C.axis.p2c(C.to)),t.show=!0,e.triggerRedrawOverlay(),!h&&f()&&c()}function f(){var p=e.getOptions().selection.minSize;return Math.abs(t.second.x-t.first.x)>=p&&Math.abs(t.second.y-t.first.y)>=p}e.clearSelection=o,e.setSelection=m,e.getSelection=s,e.hooks.bindEvents.push(function(p,h){var D=p.getOptions();D.selection.mode!=null&&(h.mousemove(a),h.mousedown(i))}),e.hooks.drawOverlay.push(function(p,h){if(t.show&&f()){var D=p.getPlotOffset(),C=p.getOptions();h.save(),h.translate(D.left,D.top);var l=q.color.parse(C.selection.color);h.strokeStyle=l.scale("a",.8).toString(),h.lineWidth=1,h.lineJoin=C.selection.shape,h.fillStyle=l.scale("a",.4).toString();var v=Math.min(t.first.x,t.second.x)+.5,y=Math.min(t.first.y,t.second.y)+.5,P=Math.abs(t.second.x-t.first.x)-1,b=Math.abs(t.second.y-t.first.y)-1;h.fillRect(v,y,P,b),h.strokeRect(v,y,P,b),h.restore()}}),e.hooks.shutdown.push(function(p,h){h.unbind("mousemove",a),h.unbind("mousedown",i),r&&(q(document).unbind("mouseup",r),document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag))})}q.plot.plugins.push({init:j,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(q){var j={series:{stack:null}};function e(t){function n(a,i){for(var x=null,s=0;s<i.length&&a!=i[s];++s)i[s].stack==a.stack&&(x=i[s]);return x}function r(a,i,x){if(!(i.stack==null||i.stack===!1)){var s=n(i,a.getData());if(s){for(var c=x.pointsize,d=x.points,u=s.datapoints.pointsize,g=s.datapoints.points,o=[],E,m,f,p,h,D,C=i.lines.show,l=i.bars.horizontal,v=c>2&&(l?x.format[2].x:x.format[2].y),y=C&&i.lines.steps,P=l?1:0,b=l?0:1,S=0,M=0,O,R;!(S>=d.length&&M>=g.length);){if(O=o.length,S<d.length&&d[S]==null){for(R=0;R<c;++R)o.push(d[S+R]);S+=c}else if(S>=d.length){for(R=0;R<c;++R)o.push(g[M+R]);v&&(o[O+2]=g[M+b]),M+=u}else if(M>=g.length){for(R=0;R<c;++R)o.push(d[S+R]);S+=c}else if(M<g.length&&g[M]==null)M+=u;else{if(E=d[S+P],m=d[S+b],p=g[M+P],h=g[M+b],D=0,E==p){for(R=0;R<c;++R)o.push(d[S+R]);o[O+b]+=h,D=h,S+=c,M+=u}else if(E>p){if(S==0){for(R=0;R<c;++R)o.push(g[M+R]);D=h}if(S>0&&d[S-c]!=null){for(f=0,o.push(p),o.push(f+h),R=2;R<c;++R)o.push(d[S+R]);D=h}M+=u}else{for(R=0;R<c;++R)o.push(d[S+R]);M>0&&g[M-u]!=null&&(D=0),o[O+b]+=D,S+=c}fromgap=!1,O!=o.length&&v&&(o[O+2]=D)}if(y&&O!=o.length&&O>0&&o[O]!=null&&o[O]!=o[O-c]&&o[O+1]!=o[O-c+1]){for(R=0;R<c;++R)o[O+c+R]=o[O+R];o[O+1]=o[O-c+1]}}x.points=o}}}t.hooks.processDatapoints.push(r)}q.plot.plugins.push({init:e,options:j,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(q){var j={series:{stackpercent:null}};function e(t){var n={},r=!1,a={};function i(c,d,u,g){if(r||(r=!0,a=x(c.getData())),d.stackpercent==!0){var o=u.length;d.percents=[];var E=0,m=1;d.bars&&d.bars.horizontal&&d.bars.horizontal===!0&&(E=1,m=0);for(var f=0;f<o;f++){var p=a[u[f][E]+""];p>0?d.percents.push(u[f][m]*100/p):d.percents.push(0)}}}function x(c){var d=c.length,u={};if(d>0){for(var g=0;g<d;g++)if(c[g].stackpercent){var o=0,E=1;c[g].bars&&c[g].bars.horizontal&&c[g].bars.horizontal===!0&&(o=1,E=0);for(var m=c[g].data.length,f=0;f<m;f++){var p=0;c[g].data[f][1]!=null&&(p=c[g].data[f][E]),u[c[g].data[f][o]+""]?u[c[g].data[f][o]+""]+=p:u[c[g].data[f][o]+""]=p}}}return u}function s(c,d,u){if(d.stackpercent){r||(a=x(c.getData()));var g=[],o=0,E=1;d.bars&&d.bars.horizontal&&d.bars.horizontal===!0&&(o=1,E=0);for(var m=0;m<u.points.length;m+=3)n[u.points[m+o]]||(n[u.points[m+o]]=0),g[m+o]=u.points[m+o],g[m+E]=u.points[m+E]+n[u.points[m+o]],g[m+2]=n[u.points[m+o]],n[u.points[m+o]]+=u.points[m+E],a[g[m+o]+""]>0?(g[m+E]=g[m+E]*100/a[g[m+o]+""],g[m+2]=g[m+2]*100/a[g[m+o]+""]):(g[m+E]=0,g[m+2]=0);u.points=g}}t.hooks.processRawData.push(i),t.hooks.processDatapoints.push(s)}q.plot.plugins.push({init:e,options:j,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(q){var j={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(d,u){return u*Math.floor(d/u)}function t(d,u,g,o){if(typeof d.strftime=="function")return d.strftime(u);var E=function(v,y){return v=""+v,y=""+(y??"0"),v.length==1?y+v:v},m=[],f=!1,p=d.getHours(),h=p<12;g==null&&(g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),o==null&&(o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var D;p>12?D=p-12:p==0?D=12:D=p;for(var C=0;C<u.length;++C){var l=u.charAt(C);if(f){switch(l){case"a":l=""+o[d.getDay()];break;case"b":l=""+g[d.getMonth()];break;case"d":l=E(d.getDate(),"");break;case"e":l=E(d.getDate()," ");break;case"h":case"H":l=E(p);break;case"I":l=E(D);break;case"l":l=E(D," ");break;case"m":l=E(d.getMonth()+1,"");break;case"M":l=E(d.getMinutes());break;case"q":l=""+(Math.floor(d.getMonth()/3)+1);break;case"S":l=E(d.getSeconds());break;case"y":l=E(d.getFullYear()%100);break;case"Y":l=""+d.getFullYear();break;case"p":l=h?"am":"pm";break;case"P":l=h?"AM":"PM";break;case"w":l=""+d.getDay();break}m.push(l),f=!1}else l=="%"?f=!0:m.push(l)}return m.join("")}function n(d){function u(m,f,p,h){m[f]=function(){return p[h].apply(p,arguments)}}var g={date:d};d.strftime!=null&&u(g,"strftime",d,"strftime"),u(g,"getTime",d,"getTime"),u(g,"setTime",d,"setTime");for(var o=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],E=0;E<o.length;E++)u(g,"get"+o[E],d,"getUTC"+o[E]),u(g,"set"+o[E],d,"setUTC"+o[E]);return g}function r(d,u){if(u.timezone=="browser")return new Date(d);if(!u.timezone||u.timezone=="utc")return n(new Date(d));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var g=new timezoneJS.Date;return g.setTimezone(u.timezone),g.setTime(d),g}else return n(new Date(d))}var a={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},i=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],x=i.concat([[3,"month"],[6,"month"],[1,"year"]]),s=i.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function c(d){d.hooks.processOptions.push(function(u,g){q.each(u.getAxes(),function(o,E){var m=E.options;m.mode=="time"&&(E.tickGenerator=function(f){var p=[],h=r(f.min,m),D=0,C=m.tickSize&&m.tickSize[1]==="quarter"||m.minTickSize&&m.minTickSize[1]==="quarter"?s:x;m.minTickSize!=null&&(typeof m.tickSize=="number"?D=m.tickSize:D=m.minTickSize[0]*a[m.minTickSize[1]]);for(var l=0;l<C.length-1&&!(f.delta<(C[l][0]*a[C[l][1]]+C[l+1][0]*a[C[l+1][1]])/2&&C[l][0]*a[C[l][1]]>=D);++l);var v=C[l][0],y=C[l][1];if(y=="year"){if(m.minTickSize!=null&&m.minTickSize[1]=="year")v=Math.floor(m.minTickSize[0]);else{var P=Math.pow(10,Math.floor(Math.log(f.delta/a.year)/Math.LN10)),b=f.delta/a.year/P;b<1.5?v=1:b<3?v=2:b<7.5?v=5:v=10,v*=P}v<1&&(v=1)}f.tickSize=m.tickSize||[v,y];var S=f.tickSize[0];y=f.tickSize[1];var M=S*a[y];y=="second"?h.setSeconds(e(h.getSeconds(),S)):y=="minute"?h.setMinutes(e(h.getMinutes(),S)):y=="hour"?h.setHours(e(h.getHours(),S)):y=="month"?h.setMonth(e(h.getMonth(),S)):y=="quarter"?h.setMonth(3*e(h.getMonth()/3,S)):y=="year"&&h.setFullYear(e(h.getFullYear(),S)),h.setMilliseconds(0),M>=a.minute&&h.setSeconds(0),M>=a.hour&&h.setMinutes(0),M>=a.day&&h.setHours(0),M>=a.day*4&&h.setDate(1),M>=a.month*2&&h.setMonth(e(h.getMonth(),3)),M>=a.quarter*2&&h.setMonth(e(h.getMonth(),6)),M>=a.year&&h.setMonth(0);var O=0,R=Number.NaN,L;do if(L=R,R=h.getTime(),p.push(R),y=="month"||y=="quarter")if(S<1){h.setDate(1);var B=h.getTime();h.setMonth(h.getMonth()+(y=="quarter"?3:1));var F=h.getTime();h.setTime(R+O*a.hour+(F-B)*S),O=h.getHours(),h.setHours(0)}else h.setMonth(h.getMonth()+S*(y=="quarter"?3:1));else y=="year"?h.setFullYear(h.getFullYear()+S):h.setTime(R+M);while(R<f.max&&R!=L);return p},E.tickFormatter=function(f,p){var h=r(f,p.options);if(m.timeformat!=null)return t(h,m.timeformat,m.monthNames,m.dayNames);var D=p.options.tickSize&&p.options.tickSize[1]=="quarter"||p.options.minTickSize&&p.options.minTickSize[1]=="quarter",C=p.tickSize[0]*a[p.tickSize[1]],l=p.max-p.min,v=m.twelveHourClock?" %p":"",y=m.twelveHourClock?"%I":"%H",P;C<a.minute?P=y+":%M:%S"+v:C<a.day?l<2*a.day?P=y+":%M"+v:P="%b %d "+y+":%M"+v:C<a.month?P="%b %d":D&&C<a.quarter||!D&&C<a.year?l<a.year?P="%b":P="%b %Y":D&&C<a.year?l<a.year?P="Q%q":P="Q%q %Y":P="%Y";var b=t(h,P,m.monthNames,m.dayNames);return b})})})}q.plot.plugins.push({init:c,options:j,name:"time",version:"1.0"}),q.plot.formatDate=t})(jQuery)}}]);

//# sourceMappingURL=5892.a7c1fbb1b910caefc804.js.map